{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///webpack/bootstrap 8c203dff91ed0db6a962?4506","webpack:///./~/babel-runtime/helpers/toConsumableArray.js?1825","webpack:///./~/babel-runtime/core-js/array/from.js?efc2","webpack:///./~/babel-runtime/~/core-js/library/fn/array/from.js?56e0","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.string.iterator.js?ae27","webpack:///./~/babel-runtime/~/core-js/library/modules/_string-at.js?8678","webpack:///./~/babel-runtime/~/core-js/library/modules/_to-integer.js?09ce","webpack:///./~/babel-runtime/~/core-js/library/modules/_defined.js?932b","webpack:///./~/babel-runtime/~/core-js/library/modules/_iter-define.js?4272","webpack:///./~/babel-runtime/~/core-js/library/modules/_library.js?08a9","webpack:///./~/babel-runtime/~/core-js/library/modules/_export.js?8e40","webpack:///./~/babel-runtime/~/core-js/library/modules/_global.js?3c52","webpack:///./~/babel-runtime/~/core-js/library/modules/_core.js?d611","webpack:///./~/babel-runtime/~/core-js/library/modules/_ctx.js?4e59","webpack:///./~/babel-runtime/~/core-js/library/modules/_a-function.js?0699","webpack:///./~/babel-runtime/~/core-js/library/modules/_hide.js?0d2e","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-dp.js?5986","webpack:///./~/babel-runtime/~/core-js/library/modules/_an-object.js?3af2","webpack:///./~/babel-runtime/~/core-js/library/modules/_is-object.js?cfda","webpack:///./~/babel-runtime/~/core-js/library/modules/_ie8-dom-define.js?b102","webpack:///./~/babel-runtime/~/core-js/library/modules/_descriptors.js?c0f5","webpack:///./~/babel-runtime/~/core-js/library/modules/_fails.js?c6dd","webpack:///./~/babel-runtime/~/core-js/library/modules/_dom-create.js?612f","webpack:///./~/babel-runtime/~/core-js/library/modules/_to-primitive.js?1a65","webpack:///./~/babel-runtime/~/core-js/library/modules/_property-desc.js?256b","webpack:///./~/babel-runtime/~/core-js/library/modules/_redefine.js?350a","webpack:///./~/babel-runtime/~/core-js/library/modules/_has.js?ddd0","webpack:///./~/babel-runtime/~/core-js/library/modules/_iterators.js?f3f3","webpack:///./~/babel-runtime/~/core-js/library/modules/_iter-create.js?0359","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-create.js?9175","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-dps.js?73bc","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-keys.js?5d2e","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-keys-internal.js?6fa8","webpack:///./~/babel-runtime/~/core-js/library/modules/_to-iobject.js?527c","webpack:///./~/babel-runtime/~/core-js/library/modules/_iobject.js?34ed","webpack:///./~/babel-runtime/~/core-js/library/modules/_cof.js?7381","webpack:///./~/babel-runtime/~/core-js/library/modules/_array-includes.js?3a79","webpack:///./~/babel-runtime/~/core-js/library/modules/_to-length.js?f510","webpack:///./~/babel-runtime/~/core-js/library/modules/_to-index.js?7bea","webpack:///./~/babel-runtime/~/core-js/library/modules/_shared-key.js?5602","webpack:///./~/babel-runtime/~/core-js/library/modules/_shared.js?f1ee","webpack:///./~/babel-runtime/~/core-js/library/modules/_uid.js?c10a","webpack:///./~/babel-runtime/~/core-js/library/modules/_enum-bug-keys.js?3254","webpack:///./~/babel-runtime/~/core-js/library/modules/_html.js?8916","webpack:///./~/babel-runtime/~/core-js/library/modules/_set-to-string-tag.js?57a7","webpack:///./~/babel-runtime/~/core-js/library/modules/_wks.js?2014","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-gpo.js?5ec8","webpack:///./~/babel-runtime/~/core-js/library/modules/_to-object.js?ca4f","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.array.from.js?f8ab","webpack:///./~/babel-runtime/~/core-js/library/modules/_iter-call.js?45cd","webpack:///./~/babel-runtime/~/core-js/library/modules/_is-array-iter.js?a9d0","webpack:///./~/babel-runtime/~/core-js/library/modules/_create-property.js?f892","webpack:///./~/babel-runtime/~/core-js/library/modules/core.get-iterator-method.js?8a45","webpack:///./~/babel-runtime/~/core-js/library/modules/_classof.js?4e04","webpack:///./~/babel-runtime/~/core-js/library/modules/_iter-detect.js?e400","webpack:///./~/babel-runtime/core-js/object/assign.js?e6ca","webpack:///./~/babel-runtime/~/core-js/library/fn/object/assign.js?2fc7","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.assign.js?07f0","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-assign.js?82ff","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-gops.js?a865","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-pie.js?a26b","webpack:///./~/three/three.extra.js?aa63","webpack:///./~/three/three.js?3099","webpack:///./~/rollbar-browser/dist/rollbar.umd.nojson.min.js?ca28","webpack:///./~/immutable/dist/immutable.js?1793","webpack:///./~/snabbdom/snabbdom.js?1b22","webpack:///./~/snabbdom/vnode.js?cf2a","webpack:///./~/snabbdom/is.js?0f2c","webpack:///./~/snabbdom/h.js?4f9e","webpack:///./~/snabbdom/modules/class.js?ac56","webpack:///./~/snabbdom/modules/props.js?aff6","webpack:///./~/snabbdom/modules/attributes.js?2f27","webpack:///./~/snabbdom/modules/style.js?6625","webpack:///./~/snabbdom/modules/eventlisteners.js?e19c","webpack:///./src/utils/eventEmitter.js?70ad","webpack:///./vendor/ramda.js?febc","webpack:///./src/store/api.js?bd93","webpack:///./src/store/apiBase.js?3626","webpack:///./~/babel-runtime/core-js/promise.js?13dc","webpack:///./~/babel-runtime/~/core-js/library/fn/promise.js?ad40","webpack:///./~/babel-runtime/~/core-js/library/modules/web.dom.iterable.js?7e82","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.array.iterator.js?8359","webpack:///./~/babel-runtime/~/core-js/library/modules/_add-to-unscopables.js?7da3","webpack:///./~/babel-runtime/~/core-js/library/modules/_iter-step.js?8944","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.promise.js?f1a9","webpack:///./~/babel-runtime/~/core-js/library/modules/_an-instance.js?7934","webpack:///./~/babel-runtime/~/core-js/library/modules/_for-of.js?43c1","webpack:///./~/babel-runtime/~/core-js/library/modules/_species-constructor.js?eaeb","webpack:///./~/babel-runtime/~/core-js/library/modules/_task.js?ca41","webpack:///./~/babel-runtime/~/core-js/library/modules/_invoke.js?4421","webpack:///./~/babel-runtime/~/core-js/library/modules/_microtask.js?6899","webpack:///./~/babel-runtime/~/core-js/library/modules/_redefine-all.js?f586","webpack:///./~/babel-runtime/~/core-js/library/modules/_set-species.js?396a","webpack:///./~/babel-runtime/helpers/slicedToArray.js?39c4","webpack:///./~/babel-runtime/core-js/is-iterable.js?350e","webpack:///./~/babel-runtime/~/core-js/library/fn/is-iterable.js?f64a","webpack:///./~/babel-runtime/~/core-js/library/modules/core.is-iterable.js?be30","webpack:///./~/babel-runtime/core-js/get-iterator.js?1b08","webpack:///./~/babel-runtime/~/core-js/library/fn/get-iterator.js?cf7c","webpack:///./~/babel-runtime/~/core-js/library/modules/core.get-iterator.js?74ea","webpack:///./src/store/utils/lzmaDecompressor.js?0487","webpack:///./vendor/lzma.js?a987","webpack:///./~/rsvp/dist/rsvp.js?85a4","webpack:///./~/process/browser.js?82e4","webpack:///./~/timers-browserify/main.js?b088","webpack:///vertx (ignored)?3e5a","webpack:///./src/store/clientMiddleware.js?03cb","webpack:///./src/store/isPromise.js?a1f5","webpack:///./~/babel-runtime/helpers/typeof.js?f4bd","webpack:///./~/babel-runtime/core-js/symbol/iterator.js?d16b","webpack:///./~/babel-runtime/~/core-js/library/fn/symbol/iterator.js?cb1a","webpack:///./~/babel-runtime/~/core-js/library/modules/_wks-ext.js?c7f7","webpack:///./~/babel-runtime/core-js/symbol.js?a70d","webpack:///./~/babel-runtime/~/core-js/library/fn/symbol/index.js?8500","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.symbol.js?d467","webpack:///./~/babel-runtime/~/core-js/library/modules/_meta.js?3397","webpack:///./~/babel-runtime/~/core-js/library/modules/_wks-define.js?19d1","webpack:///./~/babel-runtime/~/core-js/library/modules/_keyof.js?eda4","webpack:///./~/babel-runtime/~/core-js/library/modules/_enum-keys.js?a137","webpack:///./~/babel-runtime/~/core-js/library/modules/_is-array.js?91c9","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-gopn-ext.js?6174","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-gopn.js?ebaf","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-gopd.js?1f7d","webpack:///./~/babel-runtime/~/core-js/library/modules/es7.symbol.async-iterator.js?3d3e","webpack:///./~/babel-runtime/~/core-js/library/modules/es7.symbol.observable.js?cfd3","webpack:///./src/store/isPlainObject.js?26c7","webpack:///./~/babel-runtime/core-js/object/get-prototype-of.js?b265","webpack:///./~/babel-runtime/~/core-js/library/fn/object/get-prototype-of.js?e51c","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.get-prototype-of.js?6fd6","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-sap.js?2605","webpack:///./src/modules/animation.js?5751","webpack:///./~/babel-runtime/core-js/object/keys.js?fe06","webpack:///./~/babel-runtime/~/core-js/library/fn/object/keys.js?0e2b","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.keys.js?dfa4","webpack:///./~/babel-runtime/helpers/defineProperty.js?172e","webpack:///./~/babel-runtime/core-js/object/define-property.js?5f70","webpack:///./~/babel-runtime/~/core-js/library/fn/object/define-property.js?4d33","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.define-property.js?8bde","webpack:///./~/cuid/dist/browser-cuid.js?62c5","webpack:///./src/modules/utils/createReducer.js?14d5","webpack:///./src/modules/sceneGraph.js?341b","webpack:///./~/node-uuid/uuid.js?bf97","webpack:///./~/buffer/index.js?1a55","webpack:///./~/base64-js/index.js?2add","webpack:///./~/ieee754/index.js?70fe","webpack:///./~/buffer/~/isarray/index.js?1483","webpack:///./~/crypto-browserify/index.js?b47b","webpack:///./~/crypto-browserify/rng.js?d47f","webpack:///./~/crypto-browserify/create-hash.js?25e7","webpack:///./~/sha.js/index.js?98ec","webpack:///./~/sha.js/hash.js?240c","webpack:///./~/sha.js/sha1.js?5c70","webpack:///./~/util/util.js?1e30","webpack:///./~/util/support/isBufferBrowser.js?8596","webpack:///./~/inherits/inherits_browser.js?7d48","webpack:///./~/sha.js/sha256.js?582c","webpack:///./~/sha.js/sha512.js?4b63","webpack:///./~/crypto-browserify/md5.js?b9ed","webpack:///./~/crypto-browserify/helpers.js?2604","webpack:///./~/ripemd160/lib/ripemd160.js?3769","webpack:///./~/crypto-browserify/create-hmac.js?7298","webpack:///./~/crypto-browserify/pbkdf2.js?d3d0","webpack:///./~/pbkdf2-compat/pbkdf2.js?fd83","webpack:///./src/modules/assets.js?b2d5","webpack:///./~/babel-runtime/core-js/json/stringify.js?4574","webpack:///./~/babel-runtime/~/core-js/library/fn/json/stringify.js?834a","webpack:///./src/modules/scene.js?9e4b","webpack:///./src/modules/utils/selectors.js?3813","webpack:///./src/operators/nonImmutable.js?bffb","webpack:///./src/operators/makeAllOperatorsNonImmutable.js?ea56","webpack:///./src/operators/schemaTypes.js?d9e1","webpack:///./~/babel-runtime/core-js/number/is-integer.js?14ca","webpack:///./~/babel-runtime/~/core-js/library/fn/number/is-integer.js?17db","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.number.is-integer.js?a48c","webpack:///./~/babel-runtime/~/core-js/library/modules/_is-integer.js?9053","webpack:///./src/operators/Annotation.js?7799","webpack:///./src/operators/BinMesh.js?949c","webpack:///./src/translators/bingeom.js?2483","webpack:///./src/polyMesh/index.js?cd1b","webpack:///./src/polyMesh/three/ThreeInstanceScalarSize.js?5eac","webpack:///./src/polyMesh/generic/utility/polyfill.js?d285","webpack:///./src/polyMesh/geometric/tool/Importer.js?e3a1","webpack:///./src/polyMesh/generic/container/ObjectArrayView.js?bfdf","webpack:///./~/babel-runtime/core-js/object/create.js?aa4b","webpack:///./~/babel-runtime/~/core-js/library/fn/object/create.js?895a","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.create.js?b4fb","webpack:///./src/polyMesh/generic/utility/Arrays.js?24e4","webpack:///./~/babel-runtime/core-js/object/freeze.js?80a0","webpack:///./~/babel-runtime/~/core-js/library/fn/object/freeze.js?95fd","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.freeze.js?cbe2","webpack:///./src/polyMesh/generic/utility/Orders.js?b467","webpack:///./src/polyMesh/generic/container/FlatArrayView.js?642e","webpack:///./src/polyMesh/generic/container/ObjectBuffer.js?d3c7","webpack:///./src/polyMesh/generic/container/BlockBuffer.js?f3b2","webpack:///./src/polyMesh/generic/container/ScalarArrayView.js?6232","webpack:///./src/polyMesh/generic/container/ScalarBuffer.js?5eb0","webpack:///./src/polyMesh/geometric/model/PolyMaps.js?bf93","webpack:///./src/polyMesh/generic/container/ObjectsByName.js?79c0","webpack:///./src/polyMesh/geometric/model/PolyMap.js?06d1","webpack:///./src/polyMesh/generic/algorithm/IndexMappings.js?114e","webpack:///./src/polyMesh/geometric/model/adjacency/EdgeVertexAdjacency.js?4a34","webpack:///./src/polyMesh/generic/algorithm/MergeSort.js?db60","webpack:///./src/polyMesh/geometric/model/adjacency/FaceEdgeAdjacency.js?3616","webpack:///./src/polyMesh/geometric/model/adjacency/ValueAdjacency.js?650e","webpack:///./src/polyMesh/geometric/model/adjacency/FaceFaceAdjacency.js?ca70","webpack:///./src/polyMesh/geometric/model/PolyMesh.js?6641","webpack:///./src/polyMesh/geometric/model/Skinning.js?775e","webpack:///./src/polyMesh/geometric/algorithm/ImportConversions.js?508e","webpack:///./src/polyMesh/generic/algorithm/GlobalCompaction.js?e352","webpack:///./src/polyMesh/generic/container/BitSet.js?76d7","webpack:///./src/polyMesh/geometric/transient/Selection.js?1bfe","webpack:///./src/polyMesh/three/ThreeExport.js?8f73","webpack:///./src/polyMesh/geometric/tool/Exporter.js?8850","webpack:///./src/polyMesh/geometric/algorithm/RenderIndexing.js?44a9","webpack:///./src/polyMesh/geometric/algorithm/SimpleFanTriangulation.js?5f18","webpack:///./src/operators/PolyMesh/MeshSmooth.js?8aea","webpack:///./src/polyMesh/geometric/operator/subdivision.js?bd8d","webpack:///./src/polyMesh/geometric/operator/polyMeshValidation.js?511b","webpack:///./src/polyMesh/geometric/operator/removeDuplicateNormals.js?1956","webpack:///./src/operators/Camera.js?54c5","webpack:///./src/operators/Environment.js?cfe9","webpack:///./src/operators/GeneralRenderer.js?e7e9","webpack:///./src/operators/Image.js?5b3d","webpack:///./src/translators/asset.js?96f8","webpack:///./src/operators/Light.js?cba7","webpack:///./src/operators/Material.js?a8fa","webpack:///./src/operators/Pass.js?3ebe","webpack:///./src/operators/Player.js?f5ff","webpack:///./src/operators/PolyMesh/index.js?387a","webpack:///./src/operators/PolyMesh/Mesh.js?1423","webpack:///./src/operators/PolyMesh/TransformVertices.js?6335","webpack:///./src/operators/PolyMesh/UVMap.js?0912","webpack:///./src/operators/PolyMesh/UVTransform.js?6d37","webpack:///./src/operators/PolyMesh/Skin.js?035a","webpack:///./src/operators/PolyMesh/Box.js?c10b","webpack:///./src/polyMesh/geometric/primitives/Box.js?6ea0","webpack:///./src/polyMesh/geometric/operator/removeDuplicateValues.js?0f51","webpack:///./~/babel-runtime/core-js/map.js?f6ea","webpack:///./~/babel-runtime/~/core-js/library/fn/map.js?ead9","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.map.js?ca2c","webpack:///./~/babel-runtime/~/core-js/library/modules/_collection-strong.js?3117","webpack:///./~/babel-runtime/~/core-js/library/modules/_collection.js?edf7","webpack:///./~/babel-runtime/~/core-js/library/modules/_array-methods.js?0eca","webpack:///./~/babel-runtime/~/core-js/library/modules/_array-species-create.js?f465","webpack:///./~/babel-runtime/~/core-js/library/modules/_array-species-constructor.js?0581","webpack:///./~/babel-runtime/~/core-js/library/modules/es7.map.to-json.js?7b58","webpack:///./~/babel-runtime/~/core-js/library/modules/_collection-to-json.js?3ee2","webpack:///./~/babel-runtime/~/core-js/library/modules/_array-from-iterable.js?fcd9","webpack:///./src/operators/PolyMesh/Sphere.js?9a67","webpack:///./src/polyMesh/geometric/primitives/Sphere.js?3872","webpack:///./src/polyMesh/geometric/primitives/Lathe.js?9cad","webpack:///./src/polyMesh/geometric/operator/cleanPolyMesh.js?fcc0","webpack:///./src/polyMesh/geometric/operator/removeDuplicateIndices.js?503d","webpack:///./src/polyMesh/geometric/operator/removeInvalidSurfaces.js?1216","webpack:///./src/polyMesh/geometric/operator/removeUnusedValues.js?0cdc","webpack:///./src/polyMesh/geometric/operator/applyFunctionToPolyMap.js?b10e","webpack:///./src/operators/PolyMesh/Cone.js?98ae","webpack:///./src/polyMesh/geometric/primitives/Cone.js?7901","webpack:///./src/operators/PolyMesh/Capsule.js?14b3","webpack:///./src/polyMesh/geometric/primitives/Capsule.js?eb9c","webpack:///./src/operators/PolyMesh/Cylinder.js?fa0a","webpack:///./src/polyMesh/geometric/primitives/Cylinder.js?85e7","webpack:///./src/operators/PolyMesh/Plane.js?56d1","webpack:///./src/polyMesh/geometric/primitives/Plane.js?3203","webpack:///./src/operators/PolyMesh/Torus.js?3947","webpack:///./src/polyMesh/geometric/primitives/Torus.js?b243","webpack:///./src/operators/PolyMesh/Disk.js?01e9","webpack:///./src/polyMesh/geometric/primitives/Disk.js?4a7d","webpack:///./src/operators/PolyMesh/ProxyMesh.js?cd56","webpack:///./src/operators/PolyMesh/Instance.js?c1ca","webpack:///./src/operators/PolyMesh/SortFacesByAxis.js?2ba6","webpack:///./src/polyMesh/geometric/operator/sortFacesByAxis.js?0966","webpack:///./src/operators/Properties.js?3d9d","webpack:///./src/operators/Renderer.js?81e0","webpack:///./src/operators/Transform.js?1f35","webpack:///./src/modules/actionTypes.js?75b5","webpack:///./src/modules/utils/evalSceneGraph.js?1c2e","webpack:///./src/modules/sceneIO.js?58c6","webpack:///./src/store/createStore.js?0fef","webpack:///./~/babel-runtime/core-js/set-immediate.js?5326","webpack:///./~/babel-runtime/~/core-js/library/fn/set-immediate.js?ec09","webpack:///./~/babel-runtime/~/core-js/library/modules/web.immediate.js?893a","webpack:///./src/store/transitImmutable.js?98dd","webpack:///./vendor/transit-0.8.837-min.js?883d","webpack:///./src/modules/utils/tweenFunctions.js?1780","webpack:///./src/modules/utils/physics.js?3968","webpack:///./src/modules/utils/physicsConstants.js?4dc5","webpack:///./src/polyMesh/geometric/operator/triangulateMesh.js?d787","webpack:///./src/modules/annotations.js?f98e","webpack:///./src/modules/player.js?aad7","webpack:///./src/translators/utils/updateCameraLookAtTarget.js?f0a2","webpack:///./src/translators/utils/calculateBoundingBox.js?2be1","webpack:///./src/translators/camera.js?e708","webpack:///./src/translators/utils/getTargetWorldMatrix.js?10a7","webpack:///./src/translators/utils/clamp.js?84d4","webpack:///./src/translators/utils/setMatrixOnNode.js?79db","webpack:///./src/translators/utils/decompose.js?54b0","webpack:///./src/translators/tools/orbit.js?ad93","webpack:///./src/translators/tools/zoom.js?8a53","webpack:///./src/modules/commands.js?1894","webpack:///./~/babel-runtime/core-js/object/values.js?64a5","webpack:///./~/babel-runtime/~/core-js/library/fn/object/values.js?2d6c","webpack:///./~/babel-runtime/~/core-js/library/modules/es7.object.values.js?4cb8","webpack:///./~/babel-runtime/~/core-js/library/modules/_object-to-array.js?205b","webpack:///./src/modules/plugins.js?0b43","webpack:///./src/modules/configuration.js?432f","webpack:///./src/modules/selection.js?357e","webpack:///./src/operators/index.js?4b0b","webpack:///./src/operators/makeAllOperators.js?8eb6","webpack:///./~/babel-runtime/helpers/classCallCheck.js?21af","webpack:///./~/babel-runtime/helpers/createClass.js?1dfe","webpack:///./~/babel-runtime/helpers/possibleConstructorReturn.js?aad9","webpack:///./~/babel-runtime/helpers/get.js?a320","webpack:///./~/babel-runtime/core-js/object/get-own-property-descriptor.js?3223","webpack:///./~/babel-runtime/~/core-js/library/fn/object/get-own-property-descriptor.js?e4a9","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.get-own-property-descriptor.js?f155","webpack:///./~/babel-runtime/helpers/inherits.js?0578","webpack:///./~/babel-runtime/core-js/object/set-prototype-of.js?bb00","webpack:///./~/babel-runtime/~/core-js/library/fn/object/set-prototype-of.js?f176","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.set-prototype-of.js?537f","webpack:///./~/babel-runtime/~/core-js/library/modules/_set-proto.js?b48c","webpack:///./src/operators/minimal.js?f0f7","webpack:///./src/operators/primitives.js?86fa","webpack:///./src/store/index.js?21c9","webpack:///./src/store/createReducer.js?3cf3","webpack:///./src/store/applyMiddleware.js?0e88","webpack:///./src/store/bindActionCreatorsAndSelectors.js?e82d","webpack:///./src/components/styles.js?0d2a","webpack:///./src/components/error.js?1fa9","webpack:///./src/components/progress.js?b1fa","webpack:///./~/babel-runtime/helpers/extends.js?b889","webpack:///./src/components/canvas.js?acc1","webpack:///./src/components/annotation.js?6264","webpack:///./src/components/manipulatorTools.js?0128","webpack:///./src/components/icons.js?5e4c","webpack:///./src/components/timeline.js?e424","webpack:///./src/components/marker.js?6c4e","webpack:///./src/translators/tools/index.js?02d3","webpack:///./src/translators/tools/pan.js?7a34","webpack:///./src/translators/utils/getProjectionMatrix.js?ea93","webpack:///./src/translators/tools/nodeMove.js?4829","webpack:///./src/translators/tools/gizmos.js?2dfd","webpack:///./src/translators/tools/utils/getProjectedPoint.js?9b31","webpack:///./src/translators/tools/nodeRotate.js?6c6d","webpack:///./src/translators/tools/utils/getBoundingRadius.js?75a5","webpack:///./src/translators/tools/nodeScale.js?dcdb","webpack:///./src/translators/tools/select.js?1a1f","webpack:///./src/translators/tools/fullscreen.js?e146","webpack:///./src/translators/tools/home.js?cab3","webpack:///./src/translators/tools/vrMode.js?4bc8","webpack:///./~/webvr-polyfill/build/webvr-polyfill.js?ff8c","webpack:///./src/translators/utils/vrEffect.js?c85b","webpack:///./src/translators/utils/viveController.js?da0f","webpack:///./src/translators/utils/objLoader.js?1514","webpack:///./src/translators/utils/reticle.js?94be","webpack:///./src/translators/utils/vrControls.js?e7a8","webpack:///./src/translators/tools/firstPersonMode.js?071d","webpack:///./src/translators/three.js?4804","webpack:///./src/translators/translator.js?245a","webpack:///./src/translators/materials.js?1f16","webpack:///./src/translators/polyMesh.js?fc12","webpack:///./src/translators/light.js?898c","webpack:///./src/translators/transform.js?7434","webpack:///./src/translators/manipulators.js?aabf","webpack:///./vendor/flyd.js?7290","webpack:///./src/translators/annotation.js?1f7e","webpack:///./src/translators/utils/outlinePass.js?288c","webpack:///./src/translators/utils/FXAAShader.js?51b8","webpack:///./src/translators/utils/parallaxBarrierEffect.js?d6ff","webpack:///./src/autoRotate.js?2cf6","webpack:///./src/player.js","webpack:///./~/es6-promise/auto.js","webpack:///./~/es6-promise/dist/es6-promise.js","webpack:///./src/components/player.js"],"names":["eventEmitter","e","on","name","callback","context","push","fn","ctx","once","listener","off","apply","arguments","_","emit","data","slice","call","evtArr","i","len","length","evts","liveEvents","fetchNext","url","urls","success","failure","contentType","method","body","tryNext","err","img","Image","crossOrigin","addEventListener","src","Error","request","XMLHttpRequest","requestMethod","withCredentials","open","setRequestHeader","responseType","onload","xhr","response","status","JSON","parse","onerror","send","callApi","apiBase","apiCache","fetchingCache","store","types","fireAndForget","payload","queryKey","requestPayload","cache","files","decompress","Array","isArray","requestType","successType","failureType","resolve","dispatch","type","Promise","reject","promise","meta","onFailure","error","workerMeta","onSuccessEnd","buffer","sucess","onSuccess","lzmaDecompressor","LZMARaw","LZMAWorker","workerQueue","workerPool","workerBlob","Blob","window","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","append","blob","getBlob","workerLimit","__BROWSER__","Math","max","navigator","hardwareConcurrency","requeueWorker","idx","toBeDecompressed","shift","postMessage","freeWorkerIndex","lzmaWorkerObj","worker","numWorkers","Worker","lzmaWorker","URL","createObjectURL","index","onmessage","event","inStream","Uint8Array","offset","readByte","outStream","writeByte","val","decompressFile","uintGeomArray","promiseMiddleware","PENDING","FULFILLED","REJECTED","isAction","action","next","then","result","isPromise","value","isPlainObject","fnToString","Function","prototype","toString","objStringValue","Object","obj","proto","constructor","setFrameTime","getTime","setTime","isPlaying","startPlaying","incrementTime","stopPlaying","queueClip","queueAnimation","findAnimationIndex","removeAnimation","addClip","getClips","getTimelineAnimation","SET_TIME","SET_FRAME_TIME","START_PLAYING","STOP_PLAYING","UPDATE_TRACK","UPDATE_ANIMATION","REMOVE_ANIMATION","QUEUE_ANIMATION","QUEUE_TIMELINE_ANIMATION","ADD_CLIP","INIT_PHYSICS","newInitialState","time","startTime","playing","autoplay","frameTime","animations","clips","timelineAnimationIndex","dynamicsWorld","dynamicBodies","kinematicBodies","reducer","INIT","state","set","currentFrameTime","get","merge","path","attrs","anim","getIn","track","tracks","newState","deleteIn","animation","updateIn","list","size","clip","id","setIn","mergeIn","initialState","Date","delta","forEach","animIdx","updateAnimation","getKeyframeValueFor","t","keyframes","tween","currentValue","vs","ts","kt","v","getKeyframeValue","keys","animationIdx","first","iterations","duration","easingFn","easingDuration","playSpeed","easingTime","animationStart","start","trackSet","animationTime","isEasing","reverse","inProgress","ops","s","trackIdx","end","endValue","startValue","op","onEnd","options","Ammo","getLastKeyframeTime","lastTime","times","formatTrack","sceneTime","console","log","getTweenFunction","easing","clipId","toJS","useTimeline","trackList","lastEnd","findIndex","tweenFn","b","c","d","key","publicApi","actions","selectors","createReducer","handlers","allState","createEvent","hasOwnProperty","initNode","addNode","setVRCamera","deleteNode","addOperator","getVRCamera","replace","multi","touch","reparent","findParent","findRoot","clone","oldNodeJSON","exportJSON","updateNodeTransform","getEvalSceneGraph","THREE","SET","MERGE","REPLACE","MULTI","REPARENT","ADD_OPERATOR","TOUCH","virtualCameraId","vrCameraId","virtualTargetId","convertFromImmutable","scene","map","node","warnings","toArray","plugs","plug","operator","opjs","init","toObject","nodeJS","_v","plugName","initNodes","nodes","records","createOperator","OperatorRecord","props","Op","checkNode","buildNode","children","parent","initPlugs","opdata","newChildren","errorNode","initializeVirtualNodes","force","Camera","Transform","Properties","fieldOfView","translation","x","y","z","fileReferences","to","from","nodeReferences","evaluatedNodes","loaded","_ev","setReducer","nodeId","join","sceneReducer","k","originalNode","parentNode","indexOf","deleteNodesFromState","childId","references","refKey","splice","opId","parentId","childIds","newParentNode","warn","childNode","childParentId","prevParentNode","sceneJS","opIdx","cameraId","camNode","copyNode","newPlugs","v4","concat","camId","sceneGraph","remote","ids","nodeMap","cloneDependencies","acc","assets","checkDependency","referenceKeys","refId","fileReferenceKeys","assetId","updateDependencies","resultNode","newRef","oldNode","newNode","nodeParent","firstNodeRootId","asset","operators","export","_id","rootNode","newTransform","parentNodeId","parentWorldTransform","position","Vector3","quaternion","Quaternion","scale","tempTransform","Matrix4","copy","invParentWorldTransform","getInverse","multiplyMatrices","decompose","euler","Euler","setFromQuaternion","radToDeg","sceneId","addFile","removeFile","isLoading","getImage","getOrFetchImage","getOrFetchBinary","getHash","getUrl","fetchText","fetchTransit","find","filter","getActiveAssets","importImage","importFile","ADD_FILE","REMOVE_FILE","IMPORTING_FILE","IMPORTED_FILE","IMPORT_FILE_ERROR","saveFile","delete","urlsFor","file","host","images","lzmaFile","hash","uuid","json","logBase","base","ceilPower2","pow","ceil","clamp","min","computeNewSize","imgInfo","maxSize","newSize","width","height","resizeImage","maxWidth","maxHeight","document","createElement","reader","FileReader","target","canvas","getContext","drawImage","ctx2","toDataURL","readAsDataURL","MAX_IMG_SIZE","NULL_SCENE_ID","fetchAsset","importImageURL","resizeTo","image","content","addImageAsset","createImageNode","imageAsset","glBitmapFile","glOption","imageNodeId","imageSize","originalWidth","originalHeight","catch","errMessage","_getHash","getAll","getEval","getWorldTransform","getRelativeTransform","getLocalTransform","setAll","getWarnings","pruneAssets","getNodeBoundingBox","getCurrentPass","query","onlyNode","queryObj","foundNode","child","shallow","all","rootId","includeParent","matchSceneNode","fromId","fromNode","undefined","evalNode","evalPlug","paths","transform","localTransform","parentTransform","multiply","rotation","rotateOrder","preRotation","rotatePivotOffset","localRotatePivot","scalePivotOffset","localScalePivot","shear","zero","matrixStack","translationM","makeTranslation","rotatePivotOffestM","equals","localRotatePivotM","invLocalRotatePivotM","localRotatePivotFlag","preRotationM","localRotationRadians","multiplyScalar","PI","makeRotationFromEuler","rotationRadians","rotationM","scalePivotOffsetM","localScalePivotM","invLocalScalePivotM","localScalePivotFlag","sX","sY","sZ","shearM","scaleM","makeScale","matrixAccumulation","nodeIds","warningNodes","newVRCamera","fromSceneId","toSceneId","fromObjectsId","toObjectsId","nullNode","withNull","Null","nullNodeId","cloneMap","usedAssets","storeFileRefs","translator","getTranslator","Box3","optionalPassName","currPassID","property","currPass","_sceneId","nodeTypes","BinMesh","PolyMesh","Light","Model","Material","Pass","Renderer","Bone","Annotation","toPlugs","plugType","operatorType","isUuid","buildQueryObject","getMatch","matchChildren","findChild","uuidRegex","test","pathToRegExp","RegExp","re","bareName","queryRegex","queryRegexNoName","attrsRegex","parseOperatorAttributes","attrsString","items","match","properties","exec","split","buildQueryObjectFromString","quotedIdx","quotedName","matches","names","nodeMatch","getNodeMatch","matchInside","hasPlug","operatorIndex","propKeys","parentNodeToMatch","results","parentMatch","lookupOperator","NoOp","schema","Mixer","Action","Timeline","Viewport","Environment","GeneralRenderer","Player","withNone","None","makeAllOperators","hierarchy","makeOperator","nodeReferenceKeys","nodeReferenceListKeys","plugReferences","info","prop","isFileReference","isNodeReference","isPlugReference","isReferenceList","environment","getProperties","typeOf","newVal","isChanged","primitive","initAttrs","update","newPrimitive","initVector3","isVector3","initVector2","isVector2","initColor","r","g","schemaTypes","Boolean","defaultValue","Label","Number","minValue","maxValue","num","isNaN","round","Integer","Plug","Options","Binary","File","val1","val2","String","str","Node","NodeList","Vec2","Color","Vec3","useText","label","animatable","text","limitVisilibility","visibilityAngle","step","directionMode","labels","values","directionAxis","directionTarget","ProxyMesh","binary","reducedBinary","operatorDisplay","nbLevel","level0","level1","level2","level3","level4","previousResult","visible","fetch","prefetch","bingeom","hasApi","mesh","previousMesh","Instance","geometry","MeshSmooth","validatePolymeshData","checkGeometryCache","cacheGeometry","convertToPolyMesh","convertToBingeom","convertToCNSPolyMesh","validateAndRetype","Uint32Array","ArrayBuffer","Buffer","extractFooter","jsonLength","charData","byteLength","subarray","fromCharCode","validateDataInfo","dataInfo","o","l","jsonData","faceCount","faces","positions","assert","truthy","message","RawUintByteSize","RawUint8","arr","RawUint16","Uint16Array","RawUint32","RawFloat32","Float32Array","readArray","dataType","typeinfo","noTriangulation","faceSize","staticTriangulation","trianglePerFace","nbFaces","newFaces","inn","out","il","second","j","dynamicTriangulation","fl","f","geometryCache","binaryData","fc","triangulationFunction","normalMap","uvs","uvMaps","attr","BIN_VERSION","polyMesh","jsonFooter","blendShapes","colorMaps","buffers","bufferFooters","extract","typedArray","footer","readInto","sourceBuf","buf","overBytes","padBytes","paddedBuf","reuseFooter","equalsArrayBuffers","bytesPerElement","BYTES_PER_ELEMENT","a","offsetsSum","offsets","faceValueIndices","faceRangeOffsets","namesByIndex","uvName","uvMap","byName","edgeCreaseWeights","skinning","positionSkinRange","skinWeights","poseSkinToPoseBoneTransform","skinBoneIndices","jsonFooterString","currentByte","charCodeAt","currentDWord","newBytes32","polyMeshCaches","importer","defaultFaceArity","setFaceArities","collapsePositions","collapseMapValues","positionFaceIndices","positionValues","positionsId","TypePosition","setMapIndices","setMapValues","normalFaceIndices","normalValues","normalsId","TypeNormal","uvFaceIndices","uvValues","uvsId","TypeUV","setSkinning","setCreases","creases","weights","edges","edgeVertexIndices","materialIds","setMaterialIds","toMeshAndClear","Importer","PolyMap","PolyMaps","Selection","ThreeExport","Vector2","InstanceScalarSize","Vector4","Matrix3","Int32Array","Int8Array","cls","fill","defineProperty","finalIdx","count","n","faceArities","mapIds","mapValues","mapIndices","array","optionalNumberOfElements","optionalOffset","optionalStride","mapId","checkId","getTypeInfo","getAnchorName","ElementType","mapValueData","mapIndexData","positionMapId","IdPositions","positionIndices","nFaceVertices","faceOffsets","fixedArity","nFaces","accumulate","mapIndexView","forceRepack","indices","repack","fromData","mapValueView","polyMap","collapseMapVertexValues","compactValues","assignMap","edgeVertexAdjacency","edgeWeights","getNumEdges","findEdgeId","ObjectArrayView","optionalArrayOrType","elementSize","stride","arrayLength","existingArrayOrType","maybeCreate","tempBuffer","getAt","optionalValue","fromArray","setAt","addAt","multiplyScalarAt","scalar","newCompatibleView","arrayOrType","optionalLength","newCompatibleBuffer","fromObjects","objects","optionalArrayType","copyObjects","Arrays","Empty","Float64Array","rangeCopy","srcOffset","dst","dstOffset","rangeEquals","aStart","bStart","stridedCopy","srcStride","dstStride","elementLength","numElements","optionalTo","binarySearch","elem","optionalBegin","optionalUntil","left","right","rightBound","mid","midVal","sort","optionalOrder","Numeric","unique","sortedArray","writeIndex","prevValue","compare","optionallyBuiltMap","requiredLength","validLength","nObjects","object","Orders","Natural","derefedNumbersIn","derefedTuplesIn","derefNumbersIn","offsetA","offsetB","derefedNumbersStableIn","derefedTuplesStableIn","derefNumbersStableIn","FlatArrayView","newRangeArray","rangeToArray","optionalArray","optionalWriteOffset","elemSize","writeOffset","arrayToRange","optionalReadOffset","readOffset","minimumLength","dataEnd","readView","currentArrayType","requestedArrayType","newCompareAtIndices","newCompareAtIndicesStable","ObjectBuffer","optionalElementSize","toObjectArrayViewAndClear","toArrayAndClear","blockIndex","intraBlockIndexBits","blockOffset","intraBlockIndexMask","blocks","block","lastBlock","blockSize","arrayType","BlockBuffer","nIntraBlockIndexBits","nBits","clear","pushArrayRange","minArraySize","nFullBlocks","lastBlockUse","ScalarArrayView","offsetLength","minArrayLength","ScalarBuffer","TypeTangent","TypeColor","typeId","anchorName","TypeInfo","AnchorName","mapName","getMapName","typeInfo","dot","entry","resolveMap","maps","Iterator","reset","Type","IdNormals","IdTangents","_super","optionalMesh","getId","tangentMap","element","ObjectsByName","optionalContainer","container","add","shallowClone","that","newMap","valueFaceIndices","valueFaceIndexOffsets","_edgeVertexAdjacency","_faceEdgeAdjacency","_valueAdjacency","_valueValueAdjacency","_faceFaceAdjacency","identity","isPolyMap","findValueIndexOffset","faceIndex","valueIndex","begin","until","faceEdgeAdjacency","valueAdjacency","valueValueAdjacency","ValueValueAdjacency","faceFaceAdjacency","updateInverseIndex","nextFaceStart","writeOffsets","_updateValueFaceIndexOffsets","nDestOffsets","nFaceIndices","faceIndices","byteOffset","nValues","histogramArea","histogram","sourceToTargetMap","nCompactValues","_compactFaceIndexOffsets","_compactData","_compactIndices","outSourceToTargetMap","faceIndexOffsets","nextOffset","bufferView","newValues","nextWriteIndex","nIndices","newIndices","IndexMappings","identityForReading","_identityProto","inverse","source","optionalDestination","EdgeVertexAdjacency","edgeHighVertexIndices","edgePivotRangeOffsets","edgeVertices","_compactEdgeLowToHighMap","_buildEdgeLowToHighMap","_inverseMapping","faceValueIndexA","faceValueIndexB","loVertex","hiVertex","rangeOffsets","getVerticesForEdge","edgeId","vNext","numEdges","v0","edgeBegin","edgeEnd","v1","valueIndices","faceBegin","maxEdgesSharingPivot","faceUntil","vertexA","vertexB","nEdges","sorter","nOffsets","rangeUntil","rangeBegin","sortRange","prevElement","MergeSort","maxRangeLength","ping","pong","_handleShortRange","read","readBegin","readUntil","write","blockPairSize","run","nMerges","endR","last","endL","valL","valR","writeOffsetTemp","valA","valB","valC","tmp","valD","FaceEdgeAdjacency","faceEdgeIndices","edgeFaceCounts","edgeFaceIndices","_compute","getEdgeIdFromFaceValueIndex","faceValueIndex","getNumFacesForEdgeId","edgeID","getFaceForEdgeId","faceOffset","checkValidity","invalidSurface","numFaceValues","fv","ValueAdjacency","getNumEdgesForVertex","valueBegin","valueEdgeOffsets","valueUntil","numValueEdges","getEdgeForVertexId","edgeOffset","valueEdgeIndices","getAdjacentValues","adjacentValues","edge","adjacentValue","getAdjacentFaceValuesIndicesOnFace","face","adjacentValuesOnFace","faceEnd","prev","getNumFacesForVertex","valueFaceOffsets","numValueFace","getFaceForVertexId","valueFaceCount","valueEdgeCount","edgeUnique","faceSum","edgeSum","FaceFaceAdjacency","faceFaceCounts","faceFaceIndices","getAdjacentFaces","numAdjacentFaces","adjacentFaces","adjacentFacesOnVertex","valuesIndex","numFaces","adjacentFaceIndex","getNumFaces","getNumFaceVertices","getNumVertices","getMapById","topologyChanged","optionalIndices","optionalMaterialIds","Skinning","applyTransforms","skinToWorldTransform","boneWorldTransforms","rootBoneIndex","deform","createFinalTransforms","worldToSkinTransform","finalTransforms","rootToWorldTransform","worldToRootTransform","poseRootToSkinTransform","boneToRootTransform","boneToSkinTransform","finalTransform","boneToWorldTransform","deformedPositions","applyMatrix4","addVectors","ImportConversions","compaction","compactPositions","compactedValues","transcribeIndices","indexRanges","currFaceIndex","positionIndex","currValueIndex","currValueOffset","facesStart","facesUntil","valueIndexOffset","GlobalCompaction","ttsOnly","tupleOrder","nUnique","prevUniqueAt","minValueIndex","targetToSourceMap","includeFromArray","toIndexArray","reusableMemory","sparseCompaction","nCompact","elementData","BitSet","byteView","wordIndexBegin","wordIndexUntil","maskBegin","maskUntil","include","exclude","contains","swap","wordIndexI","maskI","wordIndexJ","maskJ","stateI","stateJ","testAndInclude","wordIndex","mask","unchangedWord","containsAnyIn","countSetBits","countSetBitsInShortRange","lut","_ByteBitCount","here","word","optionalKnownLength","baseIndex","m","meaning","optionalMapId","Faces","Vertices","Edges","getIndices","convTab","ConversionTable","convFunc","newRandomSelection","seed","density","getNumElements","nPopulation","bits","prng","optionalSelectionOrMapId","optionalSelection","selection","convFacesToVertices","mapOut","mapValueIndices","convFacesToEdges","convVerticesToFaces","allVerticesFound","convVerticesToVertices","mapIdIn","mapIdOut","mapOutValueIndices","mapIn","mapInValueIndex","facesBegin","vertexOffset","convVerticesToEdges","lastSelected","prevSelected","selected","convEdgesToFaces","convEdgesToVertices","convEdgesToVerticesOfSameMap","convEdgesToEdges","updateEdgeMap","edgeRangeOffsets","highVertexIndices","searchResult","NoIndices","SimpleIndices","CompactIndices","exportBufferGeometry","indicesMode","interleaved","exportTangents","oldMesh","prevTriangulation","prevIndexing","prevValueMap","BufferGeometry","exportSpec","_prepare","exporter","triangulationChanged","valueMap","getTriangulatingIndices","getMapIndices","setIndex","BufferAttribute","attrSpec","triangulateValues","oldMap","getUnindexedMapValues","getMapValues","addAttribute","threeName","itemSize","normalized","nValuess","getNumMapValues","InterleavedBuffer","InterleavedBufferAttribute","groups","getGroups","groupCounts","addGroup","groupStarts","triangulation","renderIndexing","outSpec","mapsToExport","retriangulate","reIndex","mapOffset","iter","reindexForRendering","triangulate","Exporter","optionalMapIdWhitelist","optionalTriangulationType","triangulationType","numTriangles","numVertices","getFaceArities","prevOffset","getMaterialIds","materialIDs","translateMaterialIds","_offsetObjects","renderIndices","translateIndices","allowTriangulation","valueType","temp","translateToUnindexedValues","identityMap","offsetView","RenderIndexing","mapStates","facesOffset","nMaps","nVertices","pivotState","pivotFaces","mapScanStart","reusePossible","reuseFromFace","mapState","firstFaceIndex","pivotFaceIdxPos","pivotFaceIndex","pivotFaceGood","faceIdxPos","candidate","positionMap","faceVertexIndex","reuseIndex","targetView","mapIndex","viOffset","viStride","SimpleFanTriangulation","nTriangles","maxNumVerticesPerFace","startFaceIndices","getStartFaceIndices","positionsPolyMap","faceEdgeSign","dPrev","dNext","dTemp","pPrev","p","pNext","pNextNext","pTemp","cpTemp","cp","cpNext","numFaceVertices","vPrev","vNextNext","sub","cross","sign","signNext","inputArray","outputView","outputArray","polygonOrder","groupMin","groupMax","numPolygons","numMaterials","polygonIndex","startOffset","startIndex","endIndex","polygonLength","materialId","writeUntil","inputView","subdivisions","smoothByMaterialIds","subdivision","subdividePolyMap","newFaceRangeOffsets","faceEdgeCreases","faceValueCorners","numValues","numNewFaces","vertexCorners","numNewFaceValueIndices","newFaceValueIndices","numNewValues","valueEdgeValence","valueFaceValence","edgeFaceValence","tempFaceCentroid","tempValue","tempNextValue","tempEdgeCentroid","tempConnectedValue","tempConnectedFace","nf","edgeCreases","valueCreases","eNext","numNeighbors","edgeFaceCount","ef","useBoundaryValues","boundaryValue","numConnectedValues","ve","vOther","valueBeginF","valueUntilF","numValueFacesF","numConnectedFaces","vf","pm","fe","edgeIndex","getFaceEdgeCreases","getValueCorners","allOnes","valueCreaseEdgeCount","edgeProcessed","polyMeshValidation","isVec3NaN","isVec3Zero","isVec2NaN","validateValues","polyMapName","validationFunc","replacement","removeDuplicateNormals","removeUnusedValues","withLogging","ru","normalFaceValueIndices","duplicatesFound","n1","n2","valuesToIndices","normals","newNormalValuesBuffer","isUsed","newNormalsCount","newNormalValues","newNormals","resultMesh","filmSizes","viewType","targeted","focalDepthEnabled","focalDepth","hidden","axisDirection","zoomAxis","projection","viewCtrl","focalLength","filmSizeBox","customFilmSize","fStop","filmOffset","aspectRatio","nearClip","farClip","orthoZoom","targetDistance","showFrustum","frustumColor","showClipping","showTarget","keepKeys","box","filmSize","parseFloat","backgroundStyle","ambientLight","environmentMap","backgroundColor","backgroundOpacity","background","cubeMapBlurring","cubeMap","RES_LIST","res","res_w","isInteger","res_h","output_dir","curPass","frm_start","frm_last","frm_by","ren_start","ren_by","frm_pad","NearestFilter","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearFilter","LinearMipMapNearestFilter","LinearMipMapLinearFilter","Linear","sRGB","RGBE","LogLUV","RGBM7","RGBM16","renderType","Original","WebGL","renderTypes","wrapType","sampleFilter","encodingType","originalBitmapFile","rendererBitmapFile","hdrBitmapFile","renderOption","uOffset","vOffset","uTile","vTile","wrapU","wrapV","invert","gainPivot","gain","brightness","magFilter","minFilter","generateMipMaps","hdrEncoding","hdr","preferHDR","Canvas","color","opacity","ctxWidth","ctxHeight","parseInt","fillStyle","fillRect","canvasOperations","CanvasLinearGradient","startIs","initialValue","startColor","startOpacity","endColor","endOpacity","xOffset","yOffset","composition","canvasContext","grd","createLinearGradient","addColorStop","globalCompositeOperation","CanvasFill","CanvasComposite","sourceImage","overrideSize","overrideWidth","overrideHeight","textureImage","imgCanvas","imgCanvasContext","getAssetIdFromImage","getImageFromNode","fetchTextureImage","ref","DirectionalLight","lightType","intensity","SpotLight","PointLight","HemisphereLight","gndColor","AreaLight","Physical","baseMap","baseMapTransparent","baseColor","baseFalloff","baseFalloffMap","baseFalloffColor","opacityMap","opacityFactor","opacityFalloffMap","opacityFalloffFactor","depthWrite","depthTest","specularMap","specularColor","roughness","roughnessMap","metallic","metallicMap","clearCoat","clearCoatRoughness","lightMap","ambientColor2","emissiveMap","emissiveColor","emissiveScale","emissiveLabel","align","translucencyColor","translucencyMap","translucencyNormalAlpha","translucencyNormalPower","translucencyViewAlpha","translucencyViewPower","bumpMap","bumpFactor","normalFactor","normalRedFlip","normalGreenFlip","anisotropyLabel","anisotropyMap","anisotropy","anisotropyRotationMap","anisotropyRotation","overrideEnvironment","MaterialReference","defaultColor","reference","Reference","EnvironmentMap","thumbnailImage","irradianceCubeMap","specularCubeMap","CubeMap","map0","map1","map2","map3","map4","map5","ProxyReference","webgl","vray","Standard","diffuseColor","MultiID","material0","material1","material2","material3","material4","material5","material6","material7","material8","material9","material10","material11","material12","material13","material14","material15","material16","material17","material18","material19","material20","material21","material22","material23","material24","material25","material26","material27","material28","material29","multiID","VRmat","visMatZipFile","viewColor","targetCam","targetRen","activated","filename","fileFormat","over_res","over_res_x","over_res_y","render_cam","render_red","autoRotate","autoRotateNode","autoRotateSpeed","autoRotateDirection","camera","constraintCameraY","orbitTarget","orbitMode","toneMapStyle","toneMapExposureGain","toneMapWhitePoint","dofPass","dofMaxBlur","saoPass","saoIntensity","saoScale","bloomPass","bloomThreshold","reflectiveFloor","reflectiveFloorWidth","reflectiveFloorRoughness","reflectiveFloorMetallic","reflectiveFloorFade","reflectiveFloorHeight","reflectiveFloorOpacity","reflectiveFloorFresnel","reflectiveFloorExcludeServer","configurator","gravity","Mesh","Skin","TransformVertices","UVMap","UVTransform","Box","Sphere","Cone","Capsule","Cylinder","Plane","Torus","Disk","SortFacesByAxis","geom","stringIndicesToArray","outIndices","updateNormals","vertexIndices","random","newMesh","newPolyMap","newMapValues","nonuniform","mWidth","mHeight","mLength","center","uvProjectionMode","display","xAxis","autoFit","autoAlign","autoFitAlign","autoCenter","resetUVs","alignmentAxis","mapChannel","uvMapChannel","applyUVMap","uvMapOptions","matrixRotation","setFromVector3","matrixRotationInv","uvFaceValueIndices","vertex1","vertex2","faceNormal","newUV","uvValueCounter","normalize","planarUVMap","boxUVMap","cylindricalUVMap","sphericalUVMap","newUVMap","vertex","normal","uv","nx","abs","ny","nz","planeAxis","u","cylinderAxis","lon","xyz_to_longitude","sphereAxis","lonlat","lat","xyz_to_longitudelatitude","atan2","lo","la","h","sqrt","ScaleMode","Scale","Tiling","scaleMode","tiling","pivotCenter","uvVec3","uvTransform","getUVTransform","useScale","makeRotationZ","degToRad","safeInverse","boneNodeList","optionalRootBone","isBone","skinWorldTransform","nodeList","rootBone","boneNode","skin","newPositions","depth","depthSegments","i18n","en","xn","hn","widthSegments","heightSegments","floor","segment_width","segment_height","segment_depth","width_half","height_half","depth_half","ix","iy","iz","indOffset","newValue","newNormal","indLengthMarker","pushInd","valLengthMarker","pushVal","uv_normLengthMarker","push_uv_norm","norm","positionsMap","uvMapsByName","removeDuplicateValues","valueMappings","newValuesLength","newIndex","keyValue","boundingBox","setFromArray","boundingBoxDiagonalWithShift","getSize","subVectors","has","newValuesArray","radius","phiStart","phiLength","thetaStart","thetaLength","inverseHeightSegments","points","norms","pt","theta","sin","cos","Lathe","segments","positionCounter","indCounter","uvCounter","inversePointLength","inverseSegments","faceCounter","tempUV","rotationMatrix4","rotationMatrix","phi","makeRotationY","getNormalMatrix","jl","applyMatrix3","np","cleanPolyMesh","removeDuplicateIndices","uvMapNames","uvMapsNewIndices","newIndicesMarker","previousFaceIndex","currentFaceIndex","currentFaceSize","newFaceSize","uniqueIndicesMap","entries","newNormalIndices","removeInvalidSurfaces","removeInvalidSurfacesFromMap","additionalArguments","newFacesMarker","resultMap","args","applyFunctionToPolyMap","applyToPolyMapFunction","radiusSegments","openEnded","segmentLength","heightSegmentLength","normPt","latheSegments","radialSegments","halfHeight","inverseRadialSegments","radiusTop","radiusBottom","slope","radialSegmentsLengthTop","radialSegmentsLengthBottom","tube","tubularSegments","thetalength","inverseTubularSegments","removeDuplicate","axis","sortFacesByAxis","reorderFacesOnPolymap","reMapping","newFaceValueIndicesMarker","faceDistances","centroid","faceStart","newFace","PolyMeshProperties","MaterialProperties","ImageProperties","Default","motionTypes","shapeValues","shapeLabels","RigidBodyProperties","collisionShape","motionType","mass","linearDamping","angularDamping","linearFactor","angularFactor","linearVelocity","angularVelocity","linearSleepingThreshold","angularSleepingThreshold","friction","rollingFriction","restitution","WebGLRenderer","format","v2renderer","LookAt","orientation","lookAtAxis","flipLookAtAxis","upAxis","flipUpAxis","BoneTransform","rotateAxis","preRotationRadians","lPreRotationM","rotateAxisRadians","lPostRotationM","LOAD_SCENE","ADD_NODE","ADD_VR_CAMERA","SET_VR_CAMERA","DELETE_NODE","LOADING_FILE","LOADED_FILE","LOADING_FILE_ERROR","CLEAR_SCENE","updateReferenceList","updateReference","evaluateSceneGraph","doLog","refs","existingRefs","existingRefId","refPlug","existingRef","sceneNodeIds","evaluatedNodeIds","transitionToLoaded","worldTransforms","toUpdate","toDelete","updating","nodeUpdates","getEvaluated","updateNode","updatePlug","nodeEvaluatedVersion","doUpdatePlug","previousVersion","reduce","needsUpdateReference","fromPlug","reportError","useScene","getSceneId","loadScene","errorLoadingScene","markRenderingScene","markRenderedScene","savePublished","fetchAndUse","loadingProgress","areAssetsLoaded","areAssetsPreloaded","isSceneLoaded","isSceneRendered","markPreloaded","preloadCommand","markLoaded","markLoadingFile","markLoadedFile","convertFromJSON","writeScene","numErrors","getErrors","getScenePhase","clearScene","USE_SCENE","LOADING_SCENEGRAPH","LOADED_SCENEGRAPH","ERROR_LOADING_SCENEGRAPH","RENDERING_SCENE","RENDERED_SCENE","PRELOADING_SCENE","PRELOADED_SCENE","LOADED_SCENE","SCENE_ERROR","PRELOAD_COMMAND","SCENE_PHASES","FAILED","UNKNOWN","RENDERING","PRELOADING","PRELOADED","LOADED","RENDERED","errors","phase","progress","loadingFiles","loadedFiles","preloadCommands","setProgress","totalFiles","hasActiveScene","msg","statusText","apiRoot","__URLROOT__","transitString","loadTime","logPageView","LOAD_SLOW_THRESHOLD","LOAD_FAIL_THRESHOLD","wait","waitForPublish","slowLoadTimeout","setTimeout","loadFailureTimeout","transit","clearTimeout","stack","convertPlugs","plugArray","convertNode","sceneJSON","convertFiles","createStore","raf","rafContext","setRequestAnimationFrame","newRequestAnimationFrame","requestAnimationFrame","ActionTypes","enhancer","transitInstance","currentReducer","currentState","listeners","events","isDispatching","rollbar","currentTranslator","currentNavigator","apiFunction","getState","setTranslator","setApi","api","encodeURI","location","hostname","title","addRecords","newRecords","initTransit","fromJSON","toJSON","useRollbar","rb","subscribe","isSubscribed","unsubscribe","batchNotify","notifying","requestNotify","notify","evs","notifyListenersBatched","replaceReducer","nextReducer","withFilter","withRecords","createReader","recordMap","defaultRecord","mapBuilder","finalize","iM","Map","iL","List","iR","Record","writer","createWriter","predicate","filteredWriter","RecordType","rec","_name","recordWriter","recordReader","makeWriteHandler","tag","rep","makeRecordHandler","is","tweenFunctions","linear","_c","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","_ref","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeInElastic","asin","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInBounce","easeOutBounce","easeInOutBounce","initPhysics","updatePhysics","initWorld","collisionConfiguration","btDefaultCollisionConfiguration","dispatcher","btCollisionDispatcher","overlappingPairCache","btDbvtBroadphase","solver","btSequentialImpulseConstraintSolver","btDiscreteDynamicsWorld","setGravity","btVector3","createConvexHullFromPolyMesh","shape","btConvexHullShape","verts","tmpVec3","addPoint","createCollisionMeshFromPolyMesh","threeMesh","getThreeObject","triMesh","userData","btTriangleMesh","tmpVec3a","tmpVec3b","tmpVec3c","ptA","ptB","ptC","addTriangle","btBvhTriangleMeshShape","createBoundingBoxShapeFromNode","nodeID","bbox","halfExtents","btBoxShape","createBodyWithProps","isKinematic","isStatic","colShape","shapeLocalTransform","worldTransformV2","shapeType","setLocalScaling","bbCenter","nodeName","btSphereShape","startTransform","btTransform","setIdentity","setOrigin","setRotation","btQuaternion","w","isDynamic","localInertia","calculateLocalInertia","myMotionState","btDefaultMotionState","rbInfo","btRigidBodyConstructionInfo","m_linearDamping","m_angularDamping","m_friction","m_rollingFriction","m_linearSleepingThreshold","m_angularSleepingThreshold","m_restitution","btRigidBody","setCollisionFlags","getCollisionFlags","BODYFLAG_KINEMATIC_OBJECT","setActivationState","BODYSTATE_DISABLE_DEACTIVATION","addRigidBody","physicsNodes","cleanupPhysics","internalSimulationInterval","maxSubsteps","globalTime","stepSimulation","trans","rotationPhysics","translationPhysics","threeQuat","premultiply","motionState","getMotionState","worldTransformPhysics","setX","setY","setZ","setW","setWorldTransform","getOrigin","getRotation","RAD2DEG","CONSTANTS","BODYTYPE_STATIC","BODYTYPE_DYNAMIC","BODYTYPE_KINEMATIC","BODYFLAG_STATIC_OBJECT","BODYFLAG_NORESPONSE_OBJECT","BODYSTATE_ACTIVE_TAG","BODYSTATE_ISLAND_SLEEPING","BODYSTATE_WANTS_DEACTIVATION","BODYSTATE_DISABLE_SIMULATION","BODYGROUP_NONE","BODYGROUP_DEFAULT","BODYGROUP_DYNAMIC","BODYGROUP_STATIC","BODYGROUP_KINEMATIC","BODYGROUP_ENGINE_1","BODYGROUP_TRIGGER","BODYGROUP_ENGINE_2","BODYGROUP_ENGINE_3","BODYGROUP_USER_1","BODYGROUP_USER_2","BODYGROUP_USER_3","BODYGROUP_USER_4","BODYGROUP_USER_5","BODYGROUP_USER_6","BODYGROUP_USER_7","BODYGROUP_USER_8","BODYMASK_NONE","BODYMASK_ALL","BODYMASK_STATIC","BODYMASK_NOT_STATIC","BODYMASK_NOT_STATIC_KINEMATIC","triangulateMesh","triangulateMap","setAnnotationProperties","openAnnotation","closeAnnotation","useCustomAnnotationFunction","getCustomAnnotationFunction","SET_ANNOTATION_PROPERTIES","USE_CUSTOM_ANNOTATION_FUNCTION","customAnnotationFn","annotationFn","pinned","useManipulator","getActiveManipulator","addTool","removeTool","showTool","hideTool","updateToolOptions","getRect","setRect","setCameraAttrs","getCameraAttrs","getCameraWorldTransform","useCamera","useVrCamera","setCamera","setThreeScene","getThreeScene","getThreeCamera","getBoundingBox","getCamera","getTools","setCameraPosition","getInitialCameraPosition","requestFullscreen","exitFullscreen","toggleFullscreen","isFullscreen","setFullscreen","getRenderingMode","isNormalRenderingMode","isVRMode","isLenticularMode","activateTool","isToolActive","getActiveTools","requestLenticularMode","requestNormalMode","getPrevCamera","setRenderMode","toggleLenticularMode","enableDeviceTracking","disableDeviceTracking","toggleDeviceTracking","isDeviceTracking","setPlayerElement","setActiveColor","setHoverColor","setFullscreenBGColor","getActiveColor","getHoverColor","getFullscreenBGColor","animateCameraTo","resize","filterNodesFromPosition","setCameraRadiusConstraint","getCanvasElement","getCameraRadiusConstraint","displayThumbnail","shouldDisplayThumbnail","RENDER_MODES","vr","lenticular","manipulators","orbit","pan","zoom","nodeRotate","nodeMove","nodeScale","USE_MANIPULATOR","SET_CAMERA","SET_PREV_CAMERA","SET_CAMERA_ATTRS","SET_CAMERA_POSITION","SET_RECT","DISPLAY_THUMBNAIL","SET_ACTIVE_COLOR","SET_HOVER_COLOR","SET_PLAYER_ELEMENT","REQUEST_FULL_SCREEN","EXIT_FULL_SCREEN","SET_FULL_SCREEN","SET_RENDER_MODE","REQUEST_NORMAL_MODE","REQUEST_LENTICULAR_MODE","SET_DEVICE_TRACKING","SET_BACKGROUND_COLOR","REQUEST_STEREO_MODE","REQUEST_PARALLAX_MODE","EXIT_STEREOPARALLAX_MODE","SET_CONSTRAIN_CAMERA_RADIUS","SET_THREE_SCENE","activeColor","hoverColor","fullscreenBackgroundColor","activeManipulator","fullScreen","renderingMode","deviceTracking","polarAngle","azimuthAngle","boundingRadius","rect","initialCameraWorldMatrix","initialTargetWorldMatrix","cameraWorldMatrix","playerElement","canvasElement","activeCamera","vrCamera","threeScene","prevCamera","orientationHandler","constrainCameraRadius","manipulator","prevCameraId","playerEl","canvasEl","mode","trackDevice","tool","enabled","playerTools","UPDATE_COMMAND_OPTIONS","switchToVR","oldCamData","oldCameraTransform","targetWorldMatrix","newCamData","toolName","isActive","_isToolActive","slerpTween","startMatrix","endMatrix","startPosition","startQuaternion","endPosition","endQuaternion","matrix","lerpVectors","slerp","compose","prep","camTarget","targetingDisabled","currentCameraTransform","newCameraTransform","actualDuration","_path","raycastSelect","clientX","clientY","hits","hit","cameraData","radiusConstraint","newRadiusConstraint","updateCameraLookAtTarget","targetPosition","cameraPosition","targetUp","lookAtMatrix","lookAtPosition","lookAtScale","lookAtRotation","cameraScale","cameraRotation","upPosition","setFromMatrixPosition","lookAt","calculateBoundingBox","objectsRoot","makeEmpty","updateMatrixWorld","traverse","computeBoundingBox","isEmpty","matrixWorld","union","resizeCamera","updateLookatTarget","initCamera","initCameraRadiusConstraint","tan","atan","acos","t_cameraPosition","t_oldTargetPosition","t_targetPosition","t_sphericalCamera","Spherical","t_sphericalTarget","t_invTargetWorldMatrix","t_invPivotMatrix","t_changeQuaternion","transformData","playerData","transformDirection","setFromUnitVectors","applyQuaternion","pivotMatrix","setPosition","fromCameraId","toCameraId","fromRect","toId","fromCameraData","toCameraData","pivotPosition","cameraViewPlane","projectPoint","pivY","elements","adjustAngleAndRadius","outerRadius","initCameraWorldMatrix","initTargetWorldMatrix","minBoundingSphere","getBoundingSphere","maxBoundingSphere","targetToCamera","thirdVector","crossVectors","newTargetPosition","clampPoint","newCameraPosition","newTargetToCamera","initialMinPolarAngle","initialMaxPolarAngle","minPolarAngle","maxPolarAngle","fixRadius","Infinity","makeSafe","setFromSpherical","getTargetWorldMatrix","initCameraTransform","cameraTransform","lookAtTarget","setMatrixOnNode","matrix4","rotQuat","updateSphericalRotation","mouseDelta","updateFns","trackball","trackballUpdate","firstPerson","firstPersonUpdate","updateFn","gyroscopeUpdate","active","drag","ev","which","metaKey","momentum","handle","deltaX","deltaY","sphericalCamera","sphericalTarget","invTargetWorldMatrix","invPivotMatrix","cameraSpherical","azimuthalAngle","camToTarg","containsPoint","backwardRay","Ray","newPosition","intersectSphere","addScaledVector","forwardRay","relativeDelta","camNorm","scaleFactor","lengthSq","rotationalAxis","rotationalAngle","angleTo","rotationalQuaternion","setFromAxisAngle","posChange","targetSpherical","updateZoom","EPS","zoomBy","ctrlKey","newEv","pinch","scroll","deltaZoom","decayZoomFactor","targetToCameraDistance","newTargetToCameraDistance","camToTargetBackward","camToTargetForward","lowerBound","upperBound","minZoom","maxZoom","addCommand","removeCommand","updateCommand","setCommandOptions","getCommands","isCommandActive","getActiveCommandsWithWidgets","activateCommand","deactivateCommand","runCommand","updateCommands","MOUSE_CONTROLS","ADD_COMMAND","REMOVE_COMMAND","UPDATE_COMMAND","FAIL_COMMAND","FINISH_COMMAND","RUN_COMMAND","defaultCommand","isEnabled","command","isVisible","widget","makeCommand","allCommands","tools","activeCommand","initCommand","cmd","commands","commandName","idx2","opts","displayLocation","cmds","_isCommandActive","activate","deactivate","execute","commandList","getSetupCommand","SET_API","LOAD_PLUGIN","LOADING_PLUGIN","LOADED_PLUGIN","SET_PLUGIN","LOADING_PLUGIN_ERROR","plugins","loading","plugin","initPlugin","buildPluginFn","loadFromServer","loadPlugin","pluginName","setupData","show","hide","setMaterial","mate","setImage","setDefaultColor","moveCamera","materialName","matId","cloned","targetNode","translationOnly","targetTranslation","parentTranslation","diff","selectNode","isSelected","lastSelectedNode","getSelectedNodes","deselectAll","setHighlighting","isHighlighting","SELECT_NODE","DESELECT_ALL","SET_HIGHLIGHTING","highlightNodes","includes","highlight","defaults","isReference","Operator","mergeInto","FileReference","NodeReference","PlugReference","OperatorReference","buildStore","reducers","operatorRecords","primitives","middleware","defaultState","previousStateForKey","nextStateForKey","applyMiddleware","middlewares","chain","middlewareAPI","getDerived","bindActionCreatorsAndSelectors","bindActionCreators","actionCreators","actionCreator","bindSelectors","selector","modules","module","headerFont","bodyFont","colors","gray","black","lightBg","border","white","root","fontSize","fontFamily","top","bottom","absoluteMaxCentered","alignItems","justifyContent","header","flex","margin","mainRow","commandsRow","statsRow","padding","player","maxRow","leftCol","overflow","centerCol","rightCol","explorerSelected","explorerNotSelected","cursor","style","stats","statsReporter","pageLoadTime","toRenderedTime","performace","pct","performance","timing","navigationStart","spinnerColor","circleDiv","PIR2","outer","cx","cy","stroke","inner","transition","svg","viewport","viewBox","degrees","boxSizing","attachTranslator","attach","elm","onResize","ignoreRightClick","preventDefault","rendered","annotations","getAnnotations","callCustomAnnotationFn","vnode","annotation","pointerEvents","hook","insert","contextmenu","getAnnotationProperties","compact","alpha","tb","lr","side","click","mouseover","mouseout","textCss","borderRadius","lineHeight","popupCsses","arrows","visibility","imgStyle","initialAnnotationState","bs","bi","arrowCss","borderTop","borderLeft","borderRight","borderBottom","tl","marginTop","bl","tr","br","popupCss","textAlign","webkitTransition","delayed","remove","hoverStyle","manipulatorTools","svgIcons","isTouch","msMaxTouchPoints","innerHTML","what","focus","toolChildren","listStyleType","zIndex","glowFilter","activeLabel","svgIcon","icon","iconChildren","float","tLine","flexWrap","home","fullscreen","vrMode","lenticularMode","pause","play","select","blurColor","panViewBox","in","stdDeviation","dx","dy","in2","timeline","dragHandler","timeoutHandler","timelineStyle","rulerStyle","iconAttrs","iconOptions","timeAnimation","played","playedStyle","buttonStyle","verticalAlign","createHandleDrag","evX","touches","pageX","percentTime","handleClick","removeEventListener","endDrag","rectElement","className","getBoundingClientRect","clickAction","mousedown","touchstart","marker","percentPlayed","markerStyle","toolTipStyle","fontWeight","innerStyle","textDecoration","boxShadow","userSelect","WebkitUserSelect","MozUserSelect","arrowStyle","marginLeft","borderWidth","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","borderStyle","stopEvent","stopPropagation","toFixed","firstPersonMode","cameraProjectMatrix","cameraUnprojectMatrix","ndcReferencePoint","worldRelative","deltaReferencePoint","referencePoint","translationMatrix","move","updatePan","shiftKey","swipe","projectionMatrix","divide","invCameraWorldMatrix","directionNorm","camRay","targRay","targHit","inCamHit","outCamHit","moveLength","getProjectionMatrix","makeOrthographic","ymax","DEG2RAD","ymin","xmin","xmax","makePerspective","inverseParent","activeAxis","displayGizmo","plane","constant","hover","self","moveNodeOnPlane","moveNodeOnObjects","moveNodeFree","draw","manipulatorsObject","selectedNodes","manipId","worldTransform","restrictToAxis","nodeMatrix","parentMatrix","nodePosition","projVector","targToCam","origin","setFromCoplanarPoints","projectOnPlane","camToMove","projectOnVector","beta","gamma","upVector","stripParentTransform","newLocalTransform","invParentTransform","setNodePosition","scaleNode","rotateNode","setFromEuler","getNodeNdc","oldPosition","inverseCameraMatrix","newQuaternion","ndc","nodeChildren","nodeHit","foundIndex","point","moveOnPlane","moveOnNormal","oldNdc","ray","getCameraMouseRay","intersectsPlane","intersectPlane","getViewScale","drawMoveGizmo","drawRotateGizmo","drawScaleGizmo","highlightAxis","axisColors","materials","MeshStandardMaterial","lineRadius","cancelAxis","needsUpdate","resetMaterials","viewRect","posObj","inverseProjectionMatrix","matrixWorldInverse","coneRadius","cone","ConeGeometry","yArrow","CylinderGeometry","cone2","translate","rotateX","zArrow","xArrow","yMesh","zMesh","rotateZ","xMesh","moveGizmo","Object3D","xRotation","TorusGeometry","yRotation","zRotation","rotateY","rotateGizmo","boxWidth","BoxGeometry","scaleGizmo","postTranslate","getProjectedPoint","parentInvMatrix","nodeRotationQuaternion","nodeRotationEuler","nodeTransform","objNormal","modifyQuaternion","toVector3","getBoundingRadius","boundingVector","boundingSphere","nodeGraphScale","oldScale","setLength","projectedMouse","vrEffect","vrDisplay","vrReticle","vrFloor","vrControls","hasExternalDisplay","controller1","controller2","viveHandler","mobileNavHandler","threeVrCamera","prevMoveMode","vrCapable","getVRDisplays","displays","capabilities","canPresent","viveNavHandle","armObject","pos","getReticlePosition","vrdpPos","setOffset","navHandle","updateMatrix","planeEnabled","cbgeometry","PlaneGeometry","mat","MeshBasicMaterial","transparent","Reticle","addCollider","ViveController","standingMatrix","getStandingMatrix","loader","OBJLoader","setPath","load","TextureLoader","controller","material","matchToCamera","VREffect","renderer","externals","requestPresent","movementMode","standing","resetPose","exitPresent","removeCollider","setScissorTest","floorGrid","LineBasicMaterial","linewidth","lineGeometry","LineSegments","threeCamera","camData","onError","isWebVR1","eyeTranslationL","eyeTranslationR","renderRectL","renderRectR","eyeFOVL","eyeFOVR","isPresenting","scope","rendererSize","rendererPixelRatio","getPixelRatio","getVRDisplay","setSize","eyeParamsL","getEyeParameters","setPixelRatio","renderWidth","renderHeight","renderRect","domElement","fullscreenElement","leftBounds","rightBounds","onFullscreenChange","wasPresenting","HTMLElement","eyeWidth","eyeHeight","getLayers","layers","mozRequestFullScreen","setFullScreen","boolean","cancelAnimationFrame","submitFrame","autoSubmitFrame","cameraL","PerspectiveCamera","enable","cameraR","render","renderTarget","forceClear","autoUpdate","eyeParamsR","eyeTranslation","recommendedFieldOfView","setRenderTarget","scissorTest","autoClear","fovToProjection","near","far","translateOnAxis","scissor","setViewport","setScissor","fovToNDCScaleOffset","fov","pxscale","leftTan","rightTan","pxoffset","pyscale","upTan","downTan","pyoffset","fovPortToProjection","rightHanded","zNear","zFar","handednessScale","mobj","scaleAndOffset","transpose","fovPort","upDegrees","downDegrees","leftDegrees","rightDegrees","gamepad","axes","thumbpadIsPressed","triggerIsPressed","gripsArePressed","menuIsPressed","findGamepad","gamepads","getGamepads","matrixAutoUpdate","getGamepad","getButtonState","button","pose","matrixWorldNeedsUpdate","dispatchEvent","buttons","pressed","Event","manager","DefaultLoadingManager","regexp","vertex_pattern","normal_pattern","uv_pattern","face_vertex","face_vertex_uv","face_vertex_uv_normal","face_vertex_normal","object_pattern","smoothing_pattern","material_library_pattern","material_use_pattern","onLoad","onProgress","XHRLoader","setMaterials","_createParserState","vertices","materialLibraries","startObject","fromDeclaration","_finalize","previousMaterial","currentMaterial","smooth","startMaterial","libraries","previous","inherited","groupCount","mtllib","groupStart","groupEnd","lastMultiMaterial","declared","parseVertexIndex","parseNormalIndex","parseUVIndex","addVertex","addVertexLine","addNormal","addUV","addUVLine","addFace","ua","ub","uc","ud","na","nb","nc","nd","vLen","ia","ib","ic","uvLen","nLen","addLineGeometry","vi","uvi","lines","line","lineFirstChar","lineSecondChar","lineLength","trimLeft","trim","charAt","lineParts","substring","lineVertices","lineUVs","li","llen","parts","substr","toLowerCase","Group","isLine","buffergeometry","computeVertexNormals","createdMaterials","mi","miLen","sourceMaterial","create","materialLine","MeshPhongMaterial","shading","SmoothShading","FlatShading","multiMaterial","MultiMaterial","timeEnd","reticle","reticleObject","intersection","colliders","defaultMaterial","hitMaterial","createDefaultObject","isDot","defaultGeometry","SphereGeometry","defaultObject","startClock","remvoeFromList","object_in","list_in","threeObject","camDirection","getWorldDirection","Raycaster","intersects","intersectObjects","clock","Clock","VRControls","vrDisplays","gotVRDisplays","VRDisplay","PositionSensorVRDevice","getVRDevices","userHeight","getPose","stageParameters","sittingToStandingTransform","applyMatrix","resetSensor","zeroSensor","dispose","directionKeys","ArrowUp","ArrowLeft","ArrowDown","ArrowRight","directions","FORWARD","BACKWARD","LEFT","RIGHT","SPEED","oldOrbitMode","velocity","setVelocity","factor","keyboardEnabled","heldKeys","keydown","direction","keyup","keyheld","firstKey","movement","firstPersonMovement","UP_POSITION","forward","threeTranslator","BACKGROUND_STYLE_DEFAULT","BACKGROUND_STYLE_COLOR","BACKGROUND_STYLE_IMAGE","BACKGROUND_STYLE_CUBEMAP","BACKGROUND_STYLE_ENVIRONMENT","initTranslator","Scene","rendererAttrs","antialias","precision","preserveDrawingBuffer","isIOS","isAndroid","isMSPhone","isMobile","setClearColor","autoResizeTextures","gammaInput","gammaOutput","toneMapping","ReinhardToneMapping","physicallyCorrectLights","pixelRatio","devicePixelRatio","userAgent","el","translated","interactionHandler","translatedCameraId","pivotId","reflectiveFloorMaterial","reflectiveFloorMesh","translatorState","serverRenderingMode","composer","EffectComposer","clearPass","ClearPass","addPass","texturePass","TexturePass","cubeTexturePass","CubeTexturePass","ssaaRenderPass","SSAARenderPass","sampleLevel","unbiased","renderPass","RenderPass","fullWidth","innerWidth","fullHeight","innerHeight","effectFXAA","ShaderPass","uniforms","SAOPass","downSamplingRatio","occlusionSphereWorldRadius","blurEnabled","manualCompositing","blurKernelSize","DofPass","UnrealBloomPass","outlinePass","edgeStrength","edgeGlow","edgeThickness","pulsePeriod","visibleEdgeColor","hiddenEdgeColor","copyPass","CopyShader","renderToScreen","stereoEffect","elRect","aspect","updateProjectionMatrix","insertBefore","firstChild","tabIndex","parentElement","orientHandle","deviceTrackingTransition","handleStateChanges","stateChange","handler","highlightSelection","rootNodeId","selectedObjects","renderDisplaySceneTimeout","lastRenderStartTime","lastRenderDeltaTime","updateRenderTime","currentRenderStartTime","now","playerCameraId","updateTools","updateWidgets","distanceFade","metalness","fresnelStrength","reflectivity","clearColor","clearAlpha","initWidgets","rootName","widgets","removeWidgets","activeCommandsWithWidgets","getCenter","addToParent","skipReplace","indexingMode","extensions","bufferInfo","PrefetchMaterialNull","cubeMapNode","environmentMapBlurring","envMap","envMapIntensity","cameraNode","copiedNode","styleToToneMapping","LinearToneMapping","Reinhard","Cineon","CineonToneMapping","Filmic","Uncharted2ToneMapping","toneMappingExposure","toneMappingWhitePoint","threshold","mirrorGeo","PlaneBufferGeometry","GlossyMirror","clipBias","textureWidth","textureHeight","localMirrorNormal","CameraTransform","nodeData","calcDirection","order","Objects","MaterialLibrary","Renderers","Passes","forceDeps","processPlugs","translateAnyway","plugFunction","nextPlug","plugData","annoObj","setFromCamera","mousePosition","inter","intersectObject","distance","getObjectRoot","toScreenPosition","vector","widthHalf","heightHalf","project","createTranslator","defaultNodeFilter","defaultFns","nodeFilter","view","translatedSceneId","translatedVersion","translatedNodes","translateNodes","newTranslatedNodes","numUpdated","translateNode","doUpdate","scenePhase","rendering","preloaded","getCubeMapTexture","getTextureImage","assignTexture","primitiveToMaterial","textures","checkTextureCache","cachedImage","cacheTexture","textureCubeOnly","texture","textureCube","CubeTexture","flipY","encoding","pmremGenerator","PMREMGenerator","cubeLods","pmremCubeUVPacker","PMREMCubeUVPacker","CubeUVRenderTarget","optionalThreemap","slot","uvOptions","Texture","ok","save","ret","restore","textureWraps","ClampToEdgeWrapping","RepeatWrapping","MirroredRepeatWrapping","wrapS","wrapT","sRGBEncoding","nearestPowerOfTwo","uvOffset","uvRepeat","texelTransform","texelInvert","texelScale","texelOffset","initialStandardDefaults","emissive","ambient","vertexColors","specular","normalScale","combine","metal","gloss","refractionRatio","shininess","MeshPhysicalMaterial","mats","propertyMap","bumpScale","falloff","falloffColor","falloffOpacity","imageMaps","metalnessMap","alphaMap","falloffMap","falloffAlphaMap","updateTexture","MaterialMap","blending","NormalBlending","premultipliedAlpha","DoubleSide","polyMeshToBufferGeometry","flattenBuffer","klass","elementBuffer","numElementsPerValue","indicesBuffer","flattenedBuffer","sourceIndex","destIndex","uvNames","createLight","updateLight","initialLightDefaults","castShadow","shadowBias","shadowCameraSize","shadowDarkness","shadowFarClip","shadowFrustumColor","shadowNearClip","shadowSize","showShadowCamera","light","getHex","setMatrixOn","rotationFactor","setTRS","object3d","setTRSDegrees","initManipulators","mapStream","eventName","stream","transduceStream","transduce","isSingleTouch","isDoubleTouch","addMomentum","toStream","endStream","momentumStream","decay","timer","every","momentumStart","momentumDecay","exp","hasEvents","dragging","lastMousedown","newRect","playerRect","touchLastMove","lastMove","callTool","findFirst","doAll","toCoords","movementX","movementY","originalEvent","altKey","toMouseEvent","srcElement","keysdown","kd","setInterval","ku","clearInterval","clickStream","mousedownStream","mousemoveStream","mouseupStream","moveStream","dragStream","touchstartStream","touchendStream","md","toDeltaCoords","toDelta","newE","endingStream","mu","muX","muY","scrollHandler","wheelDelta","extractTouches","flatMap","pinchX","pinchY","dragX","dragY","endsOn","newCommands","dur","own","getScreenPositionNormalAlpha","getScreenPositionNormal","nodeWorldMatrix","cameraProjection","localDirection","cameraInverseWorldMatrix","combinedCameraSpaceMatrix","combinedProjectionMatrix","nodeLocalPosition","nodeLocalDirectionOffset","nodeCameraPosition","nodeCameraDirectionOffset","nodeCameraNormal","nodeScreenPosition","addScalar","nodeWorldTransform","cameraPlug","cameraWorldTransform","positionNormal","getDirection","cameraWorldDirection","dotResult","currentTransform","currentPosition","inverseWorldMatrix","OutlinePass","resolution","renderScene","renderCamera","usePatternTexture","downSampleRatio","BlurDirectionX","BlurDirectionY","pars","RGBAFormat","resx","resy","maskBufferMaterial","renderTargetMaskBuffer","WebGLRenderTarget","generateMipmaps","depthMaterial","MeshDepthMaterial","depthPacking","RGBADepthPacking","NoBlending","prepareMaskMaterial","getPrepareMaskMaterial","renderTargetDepthBuffer","renderTargetMaskDownSampleBuffer","renderTargetBlurBuffer1","renderTargetBlurBuffer2","edgeDetectionMaterial","getEdgeDetectionMaterial","renderTargetEdgeBuffer1","renderTargetEdgeBuffer2","MAX_EDGE_THICKNESS","MAX_EDGE_GLOW","separableBlurMaterial1","getSeperableBlurMaterial","separableBlurMaterial2","overlayMaterial","getOverlayMaterial","copyShader","copyUniforms","UniformsUtils","materialCopy","ShaderMaterial","vertexShader","fragmentShader","needsSwap","oldClearColor","oldClearAlpha","OrthographicCamera","quad","tempPulseColor1","tempPulseColor2","textureMatrix","changeVisibilityOfSelectedObjects","bVisible","gatherSelectedMeshesCallBack","selectedObject","changeVisibilityOfNonSelectedObjects","selectedMeshes","VisibilityChangeCallBack","bFound","selectedObjectId","updateTextureMatrix","writeBuffer","readBuffer","maskActive","getClearColor","getClearAlpha","oldAutoClear","disable","STENCIL_TEST","overrideMaterial","patternTexture","maxRadius","defines","AdditiveBlending","FXAAShader","ParallaxBarrierEffect","_camera","_scene","_stereo","StereoCamera","_params","_renderTargetL","_renderTargetR","_material","startAutoRotate","stopAutoRotate","autoRotateTool","increment","startingTimeout","timeout","stop","mouseup","mapObjIndexed","WebVRConfig","CARDBOARD_UI_DISABLED","ROTATE_INSTRUCTIONS_DISABLED","BUFFER_SCALE","sceneIO","patch","deps","immutable","ramda","claraplayer","elOrId","initializationFn","Rollbar","__ROLLBAR_TOKEN__","accessToken","verbose","captureUncaught","devMode","parentEl","getElementById","appendChild","bind","configuration","three","_store","version","parentStyle","getComputedStyle","isFlex","isRelative","autoRotateToolObj","hasWebGL","exports","brokenThumbnails","hideThumbnail","cssStyle","playerStyles","backgroundImage","backgroundRepeat","backgroundSize","backgroundPosition","attachFullscreenHandlers"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtCA;;AAEA;;AAEA;;AAEA;;AAEA,uCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA,8CAA6C,gBAAgB;AAC7D;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA,G;;;;;;;;;ACpBA,mBAAkB,4F;;;;;;;;;ACAlB;AACA;AACA,gF;;;;;;;;;ACFA;AACA;;AAEA;AACA;AACA,8BAA6B;AAC7B,eAAc;AACd;AACA,EAAC;AACD;AACA;AACA;AACA,gCAA+B;AAC/B;AACA;AACA,WAAU;AACV,EAAC,E;;;;;;;;;AChBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACLA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6BAA4B,aAAa;;AAEzC;AACA;AACA;AACA;AACA;AACA,yCAAwC,oCAAoC;AAC5E,6CAA4C,oCAAoC;AAChF,MAAK,2BAA2B,oCAAoC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,mBAAmB;AACnC;AACA;AACA,kCAAiC,2BAA2B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,G;;;;;;;;;ACrEA,uB;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAmE;AACnE;AACA,sFAAqF;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,UAAS;AACT;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd,eAAc;AACd,eAAc;AACd,eAAc;AACd,gBAAe;AACf,gBAAe;AACf,gBAAe;AACf,iBAAgB;AAChB,0B;;;;;;;;;AC5DA;AACA;AACA;AACA,wCAAuC,gC;;;;;;;;;ACHvC,8BAA6B;AAC7B,sCAAqC,gC;;;;;;;;;ACDrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACnBA;AACA;AACA;AACA,G;;;;;;;;;ACHA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,G;;;;;;;;;ACPA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG,UAAU;AACb;AACA;AACA;AACA,G;;;;;;;;;ACfA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA,G;;;;;;;;;ACFA;AACA,2FAAsE,gBAAgB,UAAU,GAAG;AACnG,EAAC,E;;;;;;;;;ACFD;AACA;AACA,kCAAiC,QAAQ,gBAAgB,UAAU,GAAG;AACtE,EAAC,E;;;;;;;;;ACHD;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,G;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACPA,yD;;;;;;;;;ACAA,wBAAuB;AACvB;AACA;AACA,G;;;;;;;;;ACHA,qB;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA;AACA,yHAAgF,aAAa,EAAE;;AAE/F;AACA,sDAAqD,0BAA0B;AAC/E;AACA,G;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;;;;;;;;;ACxCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACZA;AACA;AACA;;AAEA;AACA;AACA,G;;;;;;;;;ACNA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACLA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA,kBAAiB;;AAEjB;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,WAAW,eAAe;AAC/B;AACA,MAAK;AACL;AACA,G;;;;;;;;;ACpBA;AACA;AACA;AACA;AACA,4DAA2D;AAC3D,G;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACNA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA,oDAAmD;AACnD;AACA,wCAAuC;AACvC,G;;;;;;;;;ACLA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA;AACA,c;;;;;;;;;ACHA,gG;;;;;;;;;ACAA;AACA;AACA;;AAEA;AACA,mEAAkE,+BAA+B;AACjG,G;;;;;;;;;ACNA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,wB;;;;;;;;;ACVA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;;;;ACZA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+FAA0E,kBAAkB,EAAE;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAoD,gCAAgC;AACpF;AACA;AACA,MAAK;AACL;AACA,kCAAiC,gBAAgB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;;;;;;;;ACpCD;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,G;;;;;;;;;ACXA;AACA;AACA;AACA;;AAEA;AACA;AACA,G;;;;;;;;;ACPA;AACA;AACA;;AAEA;AACA;AACA;AACA,G;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACPA;AACA;AACA;AACA;AACA,0BAAyB,kBAAkB,EAAE;;AAE7C;AACA;AACA;AACA;AACA,IAAG,UAAU;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACtBA;AACA;;AAEA;AACA;AACA,gCAA+B,qBAAqB;AACpD,gCAA+B,SAAS,EAAE;AAC1C,EAAC,UAAU;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,SAAS,mBAAmB;AACvD,gCAA+B,aAAa;AAC5C;AACA,IAAG,UAAU;AACb;AACA,G;;;;;;;;;ACpBA,mBAAkB,gG;;;;;;;;;ACAlB;AACA,mF;;;;;;;;;ACDA;AACA;;AAEA,2CAA0C,wDAAoC,E;;;;;;;;;ACH9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,UAAU,EAAE;AAC9C,oBAAmB,sCAAsC;AACzD,EAAC,oCAAoC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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A;AACA;AACA;;AAEA;AACA,qDAAoD;;AAEpD;AACA;;AAEA;AACA;AACA,sDAAqD;AACrD;;AAEA;AACA;AACA,8CAA6C;AAC7C;AACA;AACA;;AAEA;AACA;AACA,0DAAyD;AACzD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA,MAAK,yFAAyF;AAC9F;AACA,OAAM,yFAAyF;AAC/F;AACA,MAAK,yFAAyF;AAC9F;AACA,MAAK,yFAAyF;AAC9F;AACA,MAAK,yFAAyF;AAC9F;AACA,MAAK,yFAAyF;AAC9F;AACA,MAAK,yFAAyF;AAC9F;AACA,MAAK,yFAAyF;AAC9F;;AAEA;;AAEA;AACA,MAAK,2FAA2F;AAChG;AACA,MAAK,2FAA2F;;AAEhG;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,uEAAsE;;AAEtE;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,iGAAgG;;AAEhG;AACA;AACA;;AAEA,oFAAmF;;AAEnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8FAA6F;;AAE7F;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA,sBAAqB,cAAc;AACnC,8BAA6B,cAAc;AAC3C,6BAA4B,cAAc;AAC1C,8BAA6B,cAAc;AAC3C,6BAA4B,cAAc;AAC1C,qBAAoB,uCAAuC;AAC3D,wBAAuB,uCAAuC;AAC9D,KAAI;;AAEJ;AACA,uBAAsB;AACtB,kBAAiB;AACjB,eAAc;AACd,+EAA8E;AAC9E,MAAK;;AAEL;AACA;AACA;AACA,sBAAqB;AACrB,oCAAmC;AACnC,4CAA2C;AAC3C,2CAA0C;AAC1C,4CAA2C;AAC3C,2CAA0C;AAC1C,0BAAyB;AACzB,gCAA+B;AAC/B;AACA;AACA,MAAK;AACL,wBAAuB;AACvB,kDAAiD;AACjD,kDAAiD;AACjD,mDAAkD;AAClD,mDAAkD;AAClD;AACA,6BAA4B;AAC5B,iFAAgF;AAChF,4FAA2F;AAC3F;AACA,eAAc;AACd,4FAA2F;AAC3F,gGAA+F;AAC/F,wEAAuE;AACvE,4FAA2F;AAC3F,gGAA+F;AAC/F,wEAAuE;AACvE,4FAA2F;AAC3F,gGAA+F;AAC/F,wEAAuE;AACvE,4FAA2F;AAC3F,gGAA+F;AAC/F,wEAAuE;AACvE;AACA,4BAA2B;AAC3B,sFAAqF;AACrF,+FAA8F;AAC9F,wEAAuE;AACvE,+FAA8F;AAC9F,wEAAuE;AACvE,+FAA8F;AAC9F,wEAAuE;AACvE,+FAA8F;AAC9F,wEAAuE;AACvE;AACA,gCAA+B;AAC/B,6BAA4B;AAC5B,wDAAuD;AACvD,mEAAkE;AAClE,2BAA0B;AAC1B,mDAAkD;AAClD,mEAAkE;AAClE,2BAA0B;AAC1B,mDAAkD;AAClD,mEAAkE;AAClE,2BAA0B;AAC1B,mDAAkD;AAClD,mEAAkE;AAClE,2BAA0B;AAC1B,6BAA4B;AAC5B,yCAAwC;AACxC,MAAK;AACL,IAAG;AACH;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,uBAAsB;AACtB;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAkC;AAClC;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA,MAAK,0HAA0H;AAC/H;AACA,MAAK,gIAAgI;;AAErI;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA,mBAAkB,0BAA0B;;AAE5C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,EAAC;;AAED;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA,kCAAiC;AACjC;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,EAAC;;AAED;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,EAAC;;AAED;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,cAAa;;AAEb;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,OAAM,yFAAyF;AAC/F;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA,4HAA2H,EAAE;;AAE7H;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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;AAGA;AACA;AACA,qBAAoB;AACpB;;AAEA;AACA,gBAAe,mBAAmB;;AAElC;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gBAAe;AACf;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;;;AAGA;AACA,iBAAgB,mBAAmB;AACnC,iBAAgB;AAChB;AACA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA,kBAAiB,mBAAmB;AACpC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;AAIA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA2E,kBAAkB;;AAE7F;AACA;;AAEA;;AAEA;;AAEA;AACA,oBAAmB;;AAEnB;AACA;;AAEA;AACA,2CAA0C;AAC1C;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,QAAO,2FAA2F;AAClG;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;AAEF;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,qBAAoB,QAAQ;;AAE5B;;AAEA;;AAEA,OAAM;;AAEN;;AAEA,OAAM;;AAEN;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,4BAA2B;AAC3B,4BAA2B;AAC3B;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA,KAAI;;AAEJ;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,uCAAsC,sBAAsB;;AAE5D;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,4BAA2B;;;AAG3B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;;AAGA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,MAAK;;AAEL;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,MAAK;;AAEL;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,wCAAuC;;AAEvC;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA,yBAAwB,kBAAkB;;AAE1C,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,QAAO;;AAEP;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,QAAO;;AAEP;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,4BAA2B;AAC3B,4BAA2B;AAC3B,4BAA2B;AAC3B,4BAA2B;AAC3B;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,kBAAiB;;AAEjB;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,OAAM;;AAEN;AACA;AACA;;AAEA;;AAEA,MAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;;AAEA,OAAM;;AAEN;AACA;AACA;;AAEA;;AAEA,MAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;;AAEA,OAAM;;AAEN;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,iBAAgB;;AAEhB;;AAEA;;AAEA;AACA;AACA,uDAAsD;;AAEtD;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA,yBAAwB,kBAAkB;;AAE1C;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,2BAA0B;AAC1B;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,OAAM;;AAEN;;AAEA;;AAEA,MAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,4BAA2B;AAC3B,4BAA2B;AAC3B,4BAA2B;AAC3B;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,kBAAiB,eAAe,eAAe;AAC/C,kBAAiB,eA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6S,8EAA8E;;AAE74C,iEAAgE,4KAA4K,2HAA2H,0PAA0P,8LAA8L,kDAAkD;;AAEj1B,kNAAiN,+HAA+H,yQAAyQ,kVAAkV,sYAAsY,uBAAuB;;AAEx0C,0CAAyC,0BAA0B,ySAAyS,wFAAwF,mDAAmD,4LAA4L,+DAA+D,+JAA+J;;AAEj5B,wCAAuC,wBAAwB,kMAAkM,0LAA0L,uCAAuC,oKAAoK;;AAEtoB,2CAA0C,+LAA+L,qFAAqF,SAAS;;AAEvU,0EAAyE,0IAA0I;;AAEnN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AAC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G;;AAEH;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,oBAAmB,OAAO;;AAE1B;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA,oBAAmB,OAAO;;AAE1B;;AAEA;;AAEA;;AAEA;;AA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ACA;;AAEA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;;AAEA,MAAK;;AAEL;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;A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;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;AACA;;AA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;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,qBAAoB;AACpB;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,oBAAmB,8BAA8B;;AAEjD;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAC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;;AAEA;;AAEA;AACA;AACA;;AAEA,MAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,MAAK;;AAEL;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,MAAK;;AAEL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA,MAAK;;AAEL;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,MAAK;;AAEL;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,MAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,MAAK;;AAEL;;AAEA;;AAEA;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;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A;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,gBAAe,qBAAqB;;AAEpC;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,gBAAe,qBAAqB;;AAEpC;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,gBAAe,sBAAsB;;AAErC,iBAAgB,qBAAqB;;AAErC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,gBAAe,sBAAsB;;AAErC,iBAAgB,qBAAqB;;AAErC;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,eAAc,sBAAsB;;AAEpC;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,gBAAe,qBAAqB;;AAEpC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,eAAc,sBAAsB;;AAEpC,gBAAe,qBAAqB;;AAEpC;AACA;AACA;AACA;AACA;;AAEA;AACA,oCAAmC;AACnC,oCAAmC;AACnC,oCAAmC;;AAEnC;AACA,oCAAmC;AACnC,oCAAmC;AACnC,oCAAmC;;AAEnC;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,eAAc,qBAAqB;;AAEnC,gBAAe,sBAAsB;;AAErC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,eAAc,qBAAqB;;AAEnC,gBAAe,sBAAsB;;AAErC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,+BAA8B,OAAO;;AAErC;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA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EA,mCAAkC,eAAe;;AAEjD;;AAEA;AACA;;AAEA,yBAAwB;;AAExB;AACA;;AAEA;;AAEA;;AAEA,mBAAkB,eAAe;;AAEjC;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA,0CAAyC,OAAO;;AAEhD;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,oBAAmB,2BAA2B;;AAE9C;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,mBAAkB;;AAElB;;AAEA,sCAAqC;AACrC;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;;AAEA;;AAEA,mBAAkB;;AAElB;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,mBAAkB;;AAElB;;AAEA,2BAA0B;;AAE1B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;;AAEA;;AAEA,mBAAkB;;AAElB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAqC;AACrC;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,mBAAkB;;AAElB;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAqC;;AAErC;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;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A;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,wCAAuC,SAAS;;AAEhD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,GAAE;;AAEF;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,oBAAmB,sBAAsB;;AAEzC;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,OAAM;;AAEN;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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AAEA;AACA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA;AACA,GAAE;;AAEF;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA,KAAI;AACJ;;AAEA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;;AAEA,KAAI;AACJ;;AAEA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;AACA;;AAEA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA;AACA,GAAE;;AAEF;;AAEA;AACA;;AAEA;;AAEA,KAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;;AAEA;AACA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;AACH;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA,IAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gDAA+C,cAAc;;AAE7D,EAAC;;;;;;;;;;ACxx1CD,gBAAe,2BAAwE,2DAA2D,KAAK,UAAU,6DAA6D,iBAAiB,mBAAmB,cAAc,4BAA4B,YAAY,UAAU,iBAAiB,gEAAgE,SAAS,+BAA+B,kBAAkB,eAAe,iBAAiB,aAAa,aAAa,iCAAiC,MAAM,eAAe,kBAAkB,IAAI,4GAA4G,yGAAyG,iBAAiB,aAAa,kBAAkB,wJAAwJ,gBAAgB,2DAA2D,yBAAyB,mCAAmC,4BAA4B,4BAA4B,sCAAsC,oCAAoC,+BAA+B,iCAAiC,SAAS,qBAAqB,eAAe,qCAAqC,MAAM,gKAAgK,8CAA8C,UAAU,gdAAgd,QAAQ,WAAW,oEAAoE,mNAAmN,sCAAsC,0DAA0D,oHAAoH,YAAY,iCAAiC,iBAAiB,aAAa,cAAc,mBAAmB,gBAAgB,kBAAkB,cAAc,IAAI,4BAA4B,SAAS,gCAAgC,aAAa,yBAAyB,aAAa,SAAS,cAAc,UAAU,oCAAoC,cAAc,sOAAsO,oCAAoC,iGAAiG,cAAc,wCAAwC,cAAc,oBAAoB,kCAAkC,6GAA6G,EAAE,gBAAgB,2BAA2B,OAAO,QAAQ,0BAA0B,MAAM,WAAW,kBAAkB,4DAA4D,WAAW,sBAAsB,iEAAiE,oBAAoB,oBAAoB,iBAAiB,oBAAoB,oIAAoI,gKAAgK,0GAA0G,6CAA6C,MAAM,SAAS,qBAAqB,aAAa,MAAM,IAAI,KAAK,sCAAsC,MAAM,QAAQ,UAAU,cAAc,0EAA0E,wBAAwB,oBAAoB,uGAAuG,qCAAqC,cAAc,sCAAsC,uPAAuP,WAAW,yFAAyF,kDAAkD,uBAAuB,KAAK,iCAAiC,GAAG,sEAAsE,8bAA8b,4CAA4C,6GAA6G,oGAAoG,oBAAoB,0BAA0B,0EAA0E,WAAW,kQAAkQ,yBAAyB,iBAAiB,6CAA6C,sBAAsB,4DAA4D,iDAAiD,iCAAiC,2BAA2B,YAAY,mKAAmK,qCAAqC,mEAAmE,mCAAmC,yDAAyD,uEAAuE,OAAO,iKAAiK,kFAAkF,SAAS,gHAAgH,4HAA4H,sDAAsD,oCAAoC,UAAU,WAAW,uDAAuD,sBAAsB,OAAO,+BAA+B,6BAA6B,8BAA8B,MAAM,2BAA2B,iCAAiC,0BAA0B,uDAAuD,QAAQ,IAAI,mBAAmB,sCAAsC,EAAE,uBAAuB,4BAA4B,sBAAsB,wBAAwB,qBAAqB,cAAc,MAAM,gCAAgC,WAAW,wBAAwB,SAAS,gBAAgB,MAAM,QAAQ,WAAW,qBAAqB,cAAc,MAAM,SAAS,gBAAgB,aAAa,oBAAoB,kGAAkG,yBAAyB,oCAAoC,mBAAmB,WAAW,kFAAkF,SAAS,yCAAyC,mBAAmB,WAAW,uGAAuG,SAAS,iCAAiC,wBAAwB,IAAI,sGAAsG,eAAe,qCAAqC,IAAI,KAAK,6DAA6D,QAAQ,IAAI,kDAAkD,SAAS,uBAAuB,mBAAmB,iIAAiI,SAAS,iCAAiC,sBAAsB,IAAI,iEAAiE,yIAAyI,mBAAmB,8CAA8C,MAAM,SAAS,gBAAgB,qBAAqB,gIAAgI,SAAS,qCAAqC,OAAO,2FAA2F,cAAc,MAAM,+QAA+Q,QAAQ,cAAc,6BAA6B,IAAI,oDAAoD,IAAI,kGAAkG,SAAS,gBAAgB,iBAAiB,kHAAkH,0DAA0D,yBAAyB,2CAA2C,8CAA8C,+BAA+B,8BAA8B,2EAA2E,IAAI,uEAAuE,SAAS,gBAAgB,eAAe,8GAA8G,4BAA4B,wCAAwC,oEAAoE,gBAAgB,2CAA2C,8CAA8C,yCAAyC,SAAS,SAAS,SAAS,gCAAgC,WAAW,SAAS,gFAAgF,iBAAiB,SAAS,oHAAoH,2CAA2C,kEAAkE,8KAA8K,yGAAyG,+FAA+F,OAAO,kBAAkB,iFAAiF,OAAO,8HAA8H,sEAAsE,uEAAuE,uCAAuC,+GAA+G,aAAa,kGAAkG,+FAA+F,OAAO,eAAe,iFAAiF,OAAO,uGAAuG,sEAAsE,kFAAkF,yBAAyB,QAAQ,OAAO,2EAA2E,iGAAiG,8BAA8B,aAAa,IAAI,oCAAoC,wBAAwB,kBAAkB,mCAAmC,uBAAuB,IAAI,MAAM,yCAAyC,aAAa,kCAAkC,sBAAsB,gBAAgB,sBAAsB,IAAI,+BAA+B,SAAS,6GAA6G,gFAAgF,uBAAuB,yDAAyD,kBAAkB,SAAS,UAAU,uBAAuB,wFAAwF,+BAA+B,4BAA4B,mCAAmC,WAAW,2CAA2C,eAAe,aAAa,gFAAgF,qFAAqF,eAAe,8CAA8C,wHAAwH,kCAAkC,MAAM,YAAY,0CAA0C,uBAAuB,2DAA2D,+CAA+C,gEAAgE,EAAE,IAAI,6HAA6H,iDAAiD,UAAU,iBAAiB,aAAa,aAAa,SAAS,aAAa,YAAY,cAAc,SAAS,oJAAoJ,cAAc,aAAa,SAAS,IAAI,aAAa,SAAS,KAAK,iBAAiB,WAAW,wBAAwB,SAAS,OAAO,yCAAyC,cAAc,gBAAgB,cAAc,yEAAyE,+BAA+B,+GAA+G,2FAA2F,WAAW,+EAA+E,iBAAiB,UAAU,eAAe,aAAa,gFAAgF,kBAAkB,aAAa,kBAAkB,4DAA4D,kCAAkC,WAAW,wBAAwB,SAAS,kBAAkB,kEAAkE,iBAAiB,WAAW,iCAAiC,SAAS,2FAA2F,OAAO,kBAAkB,wGAAwG,wDAAwD,0CAA0C,mDAAmD,6BAA6B,iCAAiC,qEAAqE,uCAAuC,cAAc,wBAAwB,6BAA6B,yBAAyB,wCAAwC,mBAAmB,OAAO,uBAAuB,wGAAwG,+JAA+J,uCAAuC,OAAO,6BAA6B,wCAAwC,kBAAkB,OAAO,uBAAuB,+JAA+J,uEAAuE,0CAA0C,OAAO,wBAAwB,oLAAoL,yBAAyB,0FAA0F,IAAI,MAAM,mBAAmB,4DAA4D,SAAS,0BAA0B,sHAAsH,IAAI,MAAM,mBAAmB,gEAAgE,SAAS,0BAA0B,wCAAwC,kDAAkD,OAAO,uBAAuB,0JAA0J,oEAAoE,sEAAsE,mCAAmC,SAAS,EAAE,iBAAiB,UAAU,eAAe,aAAa,4EAA4E,iBAAiB,aAAa,cAAc,yCAAyC,wBAAwB,oMAAoM,oBAAoB,2BAA2B,yBAAyB,6BAA6B,4BAA4B,oBAAoB,iBAAiB,qBAAqB,qGAAqG,YAAY,wBAAwB,qBAAqB,yBAAyB,wBAAwB,0BAA0B,uBAAuB,2BAA2B,6DAA6D,0BAA0B,4BAA4B,yBAAyB,6BAA6B,+DAA+D,4BAA4B,sBAAsB,mBAAmB,uBAAuB,sBAAsB,qBAAqB,gCAAgC,UAAU,0MAA0M,kBAAkB,GAAG,EAAE,iBAAiB,aAAa,cAAc,QAAQ,0DAA0D,gBAAgB,gBAAgB,cAAc,4DAA4D,kEAAkE,MAAM,IAAI,sBAAsB,qBAAqB,iDAAiD,sBAAsB,IAAI,cAAc,WAAW,4FAA4F,gBAAgB,8CAA8C,+CAA+C,kBAAkB,WAAW,cAAc,QAAQ,WAAW,8EAA8E,SAAS,cAAc,mDAAmD,aAAa,gGAAgG,gCAAgC,yDAAyD,EAAE,SAAS,KAAK,OAAO,wJAAwJ,mDAAmD,SAAS,2VAA2V,IAAI,4FAA4F,YAAY,eAAe,aAAa,aAAa,wBAAwB,4BAA4B,eAAe,4OAA4O,UAAU,gBAAgB,KAAK,UAAU,gBAAgB,yCAAyC,iBAAiB,aAAa,cAAc,IAAI,cAAc,yEAAyE,kBAAkB,qEAAqE,OAAO,6BAA6B,0BAA0B,YAAY,2CAA2C,YAAY,2CAA2C,YAAY,8CAA8C,iCAAiC,2CAA2C,QAAQ,IAAI,QAAQ,SAAS,MAAM,UAAU,SAAS,wBAAwB,uEAAuE,mCAAmC,8BAA8B,SAAS,IAAI,iBAAiB,IAAI,wBAAwB,SAAS,8BAA8B,iPAAiP,SAAS,MAAM,mCAAmC,gLAAgL,SAAS,uCAAuC,qGAAqG,iBAAiB,8BAA8B,cAAc,qCAAqC,cAAc,iCAAiC,8CAA8C,sEAAsE,SAAS,QAAQ,WAAW,qCAAqC,GAAG,E;;;;;;;;;ACAl3wB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAC,oBAAoB,cAAc;;AAEnC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,iBAAgB;AAChB;AACA;;AAEA;AACA;AACA;;AAEA;AACA,wBAAuB;AACvB,oBAAmB;;AAEnB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAoB,UAAU;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA,8CAA6C,wBAAwB;AACrE;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA,aAAY;AACZ;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oCAAmC,KAAK;AACxC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;;AAEA;;AAEA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;;;;AAKA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA,wCAAuC,SAAS;AAChD;AACA;;AAEA;AACA;AACA,oFAAmF,yCAAyC;AAC5H;AACA;AACA,kFAAiF,yCAAyC;AAC1H;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C;AAC7C;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA,4DAA2D;AAC3D;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;;AAGA,4CAA2C;;AAE3C,8CAA6C;;AAE7C,0CAAyC;;;AAGzC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAgB;AAChB,iBAAgB;AAChB;AACA;AACA;AACA,8EAA6E;AAC7E;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,oBAAoB;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,+BAA8B,SAAS;AACvC;AACA,MAAK;AACL;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,qBAAqB;AAC7D,UAAS;AACT;;AAEA,0BAAyB;AACzB;AACA,wBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA,oCAAmC,KAAK;AACxC;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,2DAA0D,SAAS;AACnE;;AAEA;AACA;AACA;;AAEA;AACA,kDAAiD,eAAe;AAChE;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,iDAAgD;AAChD;AACA;;AAEA,gDAA+C;AAC/C;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qDAAoD;AACpD;AACA;;AAEA,oDAAmD;AACnD;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,sDAAqD;AACrD;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;;;;AAIA;AACA;AACA;AACA;;AAEA;AACA;AACA,6CAA4C,UAAU;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,qCAAoC,WAAW;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,gBAAe;AACf;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,6CAA4C,UAAU;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qCAAoC,WAAW;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,gBAAe;AACf;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA,oDAAmD,gBAAgB;AACnE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kDAAiD,gBAAgB;AACjE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAoB,qBAAqB;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kDAAiD,UAAU;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA,uCAAsC,iBAAiB;AACvD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAuC,oBAAoB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,UAAS;AACT;AACA;AACA;AACA,uBAAsB,mBAAmB;AACzC;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,sBAAsB;AAC5D,QAAO;AACP;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAwB,oBAAoB;AAC5C;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAwB,oBAAoB;AAC5C;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,kDAAiD;AACjD;AACA;;AAEA;AACA;AACA;;AAEA,sDAAqD;AACrD;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iCAAgC,eAAe;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,iBAAiB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,qBAAqB;AAC7D,UAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA,2CAA0C,KAAK;AAC/C;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,6DAA4D;AAC5D;AACA,2BAA0B,+CAA+C;AACzE;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA,sDAAqD,wCAAwC;AAC7F,6DAA4D,gBAAgB;AAC5E;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qDAAoD;AACpD;AACA;AACA,kDAAiD;AACjD;AACA;AACA;;AAEA,gEAA+D;AAC/D;AACA;AACA,gDAA+C;AAC/C;AACA;AACA;;AAEA,kEAAiE;AACjE;AACA;AACA;AACA,4BAA2B,wBAAwB;AACnD;AACA,2BAA0B,4CAA4C;AACtE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,oEAAmE;AACnE;AACA,iDAAgD,mCAAmC;AACnF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gEAA+D;AAC/D,iDAAgD,wBAAwB;AACxE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,sEAAqE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,sCAAqC;AACrC;AACA,2DAA0D;AAC1D,4CAA2C;AAC3C;AACA;AACA,wCAAuC;AACvC,6CAA4C;AAC5C;AACA,8DAA6D;AAC7D,kDAAiD,kCAAkC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,gEAA+D;AAC/D;AACA,6BAA4B,8DAA8D;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,6CAA4C;AAC5C;AACA;AACA;AACA,6CAA4C;AAC5C;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP,mDAAkD;AAClD;AACA,0DAAyD;AACzD,kDAAiD,wBAAwB;AACzE;AACA;AACA,iCAAgC;AAChC;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA,MAAK;AACL;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA,MAAK;AACL;AACA,uCAAsC,oCAAoC;AAC1E;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;;AAEA;AACA;;;AAGA;AACA;AACA,6DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,gEAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;;AAGA;AACA;AACA,8DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,gEAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK,uBAAuB,oBAAoB;;AAEhD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,8CAA6C;AAC7C;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;;AAGA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;;;AAGA;AACA;AACA;AACA,mEAAkE;AAClE;AACA;AACA,UAAS;AACT,+CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA,mCAAkC,6CAA6C;AAC/E;AACA,wBAAuB,uBAAuB,EAAE;AAChD,wBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,mCAAmC;AACjE,kCAAiC,kDAAkD;AACnF;AACA,MAAK;AACL,+CAA8C,4CAA4C;AAC1F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,8DAA6D,cAAc;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,gBAAgB;AAC9D,6CAA4C,cAAc;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAqD,eAAe;AACpE;AACA,QAAO;AACP;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,oDAAmD,KAAK;AACxD;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,4DAA2D;AAC3D,sEAAqE,qBAAqB;AAC1F;;AAEA,yDAAwD;AACxD,sEAAqE,qBAAqB;AAC1F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,kBAAkB;AACvD,UAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oCAAmC,KAAK;AACxC;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,uCAAsC;AACtC,0CAAyC,oBAAoB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,mBAAmB;AAC3C,4DAA2D,sBAAsB;AACjF;AACA,QAAO;AACP;;AAEA,2CAA0C;AAC1C;AACA;AACA;AACA,0CAAyC,yBAAyB;AAClE;AACA;AACA;AACA,6CAA4C,4BAA4B;AACxE;AACA;AACA,UAAS;AACT,QAAO;AACP;;AAEA,0CAAyC;AACzC;AACA;AACA;AACA,0CAAyC,yBAAyB;AAClE;AACA;AACA;AACA,2CAA0C,4BAA4B;AACtE;AACA;AACA,UAAS;AACT,QAAO;AACP;;AAEA;AACA;AACA;;AAEA,iDAAgD;AAChD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,sDAAqD;AACrD,mDAAkD,wBAAwB;AAC1E;;AAEA;AACA,6CAA4C,SAAS;AACrD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,kBAAkB;AACvD,UAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,2CAA0C,KAAK;AAC/C;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;;AAGA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAoC,oCAAoC;AACxE;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,kDAAiD,cAAc,EAAE;AACjE;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,2BAA0B;AAC1B;AACA,MAAK;;AAEL;AACA;AACA,2BAA0B;AAC1B;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,uCAAsC,eAAe,EAAE;AACvD;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;;AAGL;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,MAAK;;;AAGL;;AAEA,yBAAwB;AACxB;AACA,MAAK;;AAEL;AACA,0CAAyC,8BAA8B;AACvE,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;;AAGL;;AAEA;AACA;AACA,MAAK;;AAEL;AACA,kFAAiF,YAAY;AAC7F,MAAK;;AAEL;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD;AAClD;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA,2CAA0C,0BAA0B;AACpE,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,2CAA0C,4BAA4B;AACtE,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA,6CAA4C,8BAA8B;AAC1E,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;;AAGL;;AAEA;AACA;AACA;;;AAGA;;AAEA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C,wBAAwB;AACnE;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,MAAK;;AAEL,4CAA2C;AAC3C;AACA;AACA;AACA,4BAA2B;AAC3B;AACA;AACA,MAAK;;AAEL,yCAAwC;AACxC;AACA;AACA,4BAA2B;AAC3B;AACA;AACA;;AAEA,IAAG;;AAEH;AACA;AACA;AACA;AACA,8DAA6D;;;;AAI7D;;AAEA;;AAEA;AACA;AACA,MAAK;;;AAGL;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;;AAGL;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,sCAAqC,qBAAqB;AAC1D,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA,IAAG;;AAEH;AACA;;;;AAIA;;AAEA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;;AAGL;;AAEA;AACA;AACA;;AAEA,IAAG;;AAEH;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,8CAA8C,EAAE;AAC3E,4BAA2B,yCAAyC,EAAE;AACtE;AACA,yBAAwB,0BAA0B,EAAE;AACpD,yBAAwB,qBAAqB;AAC7C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yDAAwD;AACxD;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,EAAC,G;;;;;;;;;ACl3JD;AACA;AACA;;AAEA;AACA;;AAEA,sBAAqB,wBAAwB;AAC7C,oBAAmB,wBAAwB;;AAE3C;AACA,+BAA8B;AAC9B;;AAEA,6BAA4B;;AAE5B;AACA;AACA;;AAEA;AACA,kBAAiB;AACjB,qBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,cAAa,kBAAkB;AAC/B;AACA,gBAAe,oBAAoB;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,qBAAqB;AACxC;AACA;AACA,QAAO;AACP;AACA;AACA,kBAAiB,uBAAuB;AACxC,2BAA0B;AAC1B;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,WAAU,oBAAoB;AAC9B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,wBAAwB;AACzC;AACA,oBAAmB,2BAA2B;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAU,oBAAoB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,uBAAuB;AAC5C;AACA;AACA,YAAW;AACX;AACA;AACA,UAAS,OAAO;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,8CAA6C;AAC7C,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO,kDAAkD;AACzD;AACA;AACA;AACA;AACA,QAAO,kDAAkD;AACzD;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,iCAAgC;AAChC;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,oBAAoB;AACnC;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,gBAAe,+BAA+B;AAC9C;AACA;AACA,gBAAe,qBAAqB;AACpC;AACA;AACA;;AAEA,mBAAkB;;;;;;;;;;ACxOlB;AACA;AACA,WAAU;AACV;AACA;;;;;;;;;;ACJA;AACA;AACA,2BAA0B,uDAAuD,EAAE;AACnF;;;;;;;;;;ACHA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;;AAEA;AACA,gBAAe;AACf;AACA;AACA,uBAAsB,cAAc;AACpC,gCAA+B,UAAU;AACzC,IAAG;AACH,uBAAsB,cAAc;AACpC,gCAA+B,UAAU;AACzC,WAAU,UAAU;AACpB;AACA;AACA,gBAAe,qBAAqB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AChCA;AACA;AACA,2CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mBAAkB;;;;;;;;;;ACZlB;AACA;AACA,2CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mBAAkB;;;;;;;;;;ACZlB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAuC,SAAS;AAChD;AACA;;AAEA;AACA;AACA,2CAA0C;;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mBAAkB;;;;;;;;;;ACtClB;AACA,+BAA8B,iBAAiB,SAAS,EAAE,EAAE;;AAE5D;AACA,yBAAwB,iBAAiB,EAAE;AAC3C;;AAEA;AACA;AACA,2CAA0C;AAC1C,qCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA,mBAAkB;;;;;;;;;;AC1DlB;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAuB,UAAU;AACjC;;AAEA;AACA;AACA,qCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,gBAAe;AACf;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,sBAAqB,gBAAgB;AACrC;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA,mBAAkB;;;;;;;;;;;;;;;mBCjCMA,Y;AAPxB;;AAEA;;;;;AAKe,UAASA,YAAT,GAAwB;AACrC,OAAMC,IAAI,EAAV;;AAEA;;;;;;;;;;;AAWA,YAASC,EAAT,CAAYC,IAAZ,EAAkBC,QAAlB,EAA4BC,OAA5B,EAAqC;AACnC,MAACJ,EAAEE,IAAF,MAAYF,EAAEE,IAAF,IAAU,EAAtB,CAAD,EAA4BG,IAA5B,CAAiC;AAC/BC,WAAIH,QAD2B;AAE/BI,YAAKH;AAF0B,MAAjC;AAIA,YAAO,IAAP;AACD;;AAED;;;;;;;;;;;AAWA,YAASI,IAAT,CAAcN,IAAd,EAAoBC,QAApB,EAA8BC,OAA9B,EAAuC;AACrC,cAASK,QAAT,GAAoB;AAClBC,WAAIR,IAAJ,EAAUO,QAAV;AACAN,gBAASQ,KAAT,CAAeP,OAAf,EAAwBQ,SAAxB;AACD;;AAEDH,cAASI,CAAT,GAAaV,QAAb;;AAEA,YAAOF,GAAGC,IAAH,EAASO,QAAT,EAAmBL,OAAnB,CAAP;AACD;;AAED;;;;;;;;;;AAUA,YAASU,IAAT,CAAcZ,IAAd,EAAoB;AAClB,SAAMa,OAAO,GAAGC,KAAH,CAASC,IAAT,CAAcL,SAAd,EAAyB,CAAzB,CAAb;AACA,SAAMM,SAAS,CAAClB,EAAEE,IAAF,KAAW,EAAZ,EAAgBc,KAAhB,EAAf;AACA,SAAIG,IAAI,CAAR;AACA,SAAMC,MAAMF,OAAOG,MAAnB;;AAEA,UAAKF,CAAL,EAAQA,IAAIC,GAAZ,EAAiBD,GAAjB,EAAsB;AACpBD,cAAOC,CAAP,EAAUb,EAAV,CAAaK,KAAb,CAAmBO,OAAOC,CAAP,EAAUZ,GAA7B,EAAkCQ,IAAlC;AACD;;AAED,YAAO,IAAP;AACD;;AAED;;;;;;;;;;AAUA,YAASL,GAAT,CAAaR,IAAb,EAAmBC,QAAnB,EAA6B;AAC3B,SAAMmB,OAAOtB,EAAEE,IAAF,CAAb;AACA,SAAMqB,aAAa,EAAnB;;AAEA,SAAID,QAAQnB,QAAZ,EAAsB;AACpB,YAAK,IAAIgB,IAAI,CAAR,EAAWC,MAAME,KAAKD,MAA3B,EAAmCF,IAAIC,GAAvC,EAA4CD,GAA5C,EAAiD;AAC/C,aAAIG,KAAKH,CAAL,EAAQb,EAAR,KAAeH,QAAf,IAA2BmB,KAAKH,CAAL,EAAQb,EAAR,CAAWO,CAAX,KAAiBV,QAAhD,EACEoB,WAAWlB,IAAX,CAAgBiB,KAAKH,CAAL,CAAhB;AACH;AACF;;AAEAI,gBAAWF,MAAZ,GACIrB,EAAEE,IAAF,IAAUqB,UADd,GAEI,OAAOvB,EAAEE,IAAF,CAFX;;AAIA,YAAO,IAAP;AACD;;AAED,UAAO,EAAED,MAAF,EAAMO,UAAN,EAAYM,UAAZ,EAAkBJ,QAAlB,EAAP;AACD,E;;;;;;;;;ACvGD,EAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAe,gBAAgB;AAC/B,gBAAe,gBAAgB;AAC/B,iBAAgB,MAAM;AACtB;AACA;AACA,2CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAe,EAAE;AACjB,iBAAgB,QAAQ;AACxB;AACA;AACA,0BAAyB;AACzB,4BAA2B;AAC3B,wBAAuB,EAAE;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAe,gBAAgB;AAC/B,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,iBAAgB,MAAM;AACtB;AACA;AACA,2CAA0C;AAC1C;AACA;AACA;AACA;AACA,wCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,OAAO;AACtB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA;AACA;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,MAAM;AACrB,gBAAe,SAAS;AACxB,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,SAAS;AACxB,gBAAe,SAAS;AACxB,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,MAAM;AACrB,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC,sCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,EAAE;AAC3B,gBAAe,SAAS;AACxB,gBAAe,OAAO;AACtB,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,SAAS;AACxB,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,MAAM;AACrB,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;AACA,4CAA2C;AAC3C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA,gBAAe,MAAM;AACrB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA,wBAAuB,KAAK,GAAG,KAAK,GAAG,KAAK;AAC5C,0CAAyC,OAAO;AAChD,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA,gBAAe,MAAM;AACrB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA,wBAAuB,KAAK,GAAG,KAAK,GAAG,KAAK;AAC5C,+CAA8C;AAC9C,+CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,MAAM;AACrB,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA,kDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,EAAE;AACjB,gBAAe,EAAE;AACjB,iBAAgB;AAChB;AACA;AACA;AACA,+BAA8B;AAC9B,+BAA8B;AAC9B,iCAAgC;AAChC,iCAAgC;AAChC,gCAA+B;AAC/B,mCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,EAAE;AACrB,gBAAe,OAAO;AACtB,gBAAe,EAAE;AACjB,iBAAgB;AAChB;AACA;AACA,4BAA2B,EAAE;AAC7B,6BAA4B;AAC5B,6BAA4B;AAC5B,+BAA8B;AAC9B,0CAAyC;AACzC,0CAAyC;AACzC,+BAA8B;AAC9B,4BAA2B,EAAE;AAC7B;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,EAAE;AACjB,iBAAgB,QAAQ,yEAAyE;AACjG;AACA;AACA,+BAA8B;AAC9B,iCAAgC;AAChC,6BAA4B,EAAE;AAC9B,4BAA2B,WAAW,EAAE;AACxC,4BAA2B,iCAAiC,EAAE;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,KAAK;AAClB,gBAAe,OAAO;AACtB,iBAAgB,MAAM;AACtB;AACA;AACA,qBAAoB,iBAAiB,EAAE;AACvC;AACA;AACA;AACA;AACA,4BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,KAAK,KAAK;AAC9B,gBAAe,MAAM;AACrB,gBAAe,OAAO;AACtB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA,iCAAgC,uBAAuB,EAAE,OAAO;AAChE,sCAAqC,uBAAuB,EAAE,OAAO;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,KAAK,KAAK;AAC5C,gBAAe,SAAS;AACxB;AACA,gBAAe,OAAO;AACtB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA,oCAAmC,uBAAuB,EAAE,OAAO;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,KAAK;AACvB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,iBAAgB,EAAE;AAClB;AACA;AACA,0BAAyB,OAAO,EAAE;AAClC,2BAA0B,EAAE;AAC5B;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,KAAK;AACzB,gBAAe,MAAM;AACrB,gBAAe,OAAO;AACtB,iBAAgB,MAAM;AACtB;AACA;AACA,kCAAiC,WAAW,EAAE;AAC9C,uCAAsC,WAAW,EAAE;AACnD;AACA;AACA,uBAAsB,6CAA6C,EAAE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,aAAa;AAC5B,iBAAgB;AAChB;AACA;AACA,kCAAiC;AACjC,+BAA8B;AAC9B,4BAA2B;AAC3B,2BAA0B;AAC1B;AACA,8BAA6B;AAC7B,6BAA4B;AAC5B,4BAA2B;AAC3B,2BAA0B;AAC1B;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,EAAE;AACjB,iBAAgB;AAChB;AACA;AACA,iDAAgD;AAChD,wDAAuD;AACvD,kDAAiD;AACjD,mDAAkD;AAClD,oCAAmC;AACnC;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,EAAE;AACjB,iBAAgB;AAChB;AACA;AACA;AACA,+BAA8B;AAC9B,4BAA2B;AAC3B,yBAAwB;AACxB,wBAAuB;AACvB;AACA,2BAA0B;AAC1B,0BAAyB;AACzB,yBAAwB;AACxB,wBAAuB;AACvB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,EAAE;AACrB,gBAAe,EAAE;AACjB,iBAAgB;AAChB;AACA;AACA,sBAAqB,EAAE;AACvB,uBAAsB;AACtB,2BAA0B;AAC1B,yBAAwB;AACxB,0BAAyB;AACzB,wBAAuB;AACvB,6BAA4B;AAC5B;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,KAAK;AAClB,gBAAe,OAAO;AACtB,iBAAgB,MAAM;AACtB;AACA;AACA,uBAAsB,iBAAiB,EAAE;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,EAAE;AACjB,gBAAe,EAAE;AACjB,iBAAgB;AAChB;AACA;AACA,4BAA2B;AAC3B,8BAA6B;AAC7B,4CAA2C;AAC3C;AACA,wBAAuB;AACvB,wBAAuB;AACvB,4BAA2B;AAC3B;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,MAAM;AACrB,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,MAAM;AACrB,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC;AACA,4BAA2B,iBAAiB,EAAE,OAAO;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,cAAa,IAAI;AACjB;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,KAAK,WAAW,KAAK,KAAK;AAC9C,gBAAe,SAAS;AACxB;AACA,gBAAe,OAAO;AACtB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA,2BAA0B;AAC1B;AACA;AACA,0DAAyD,OAAO;AAChE;AACA;AACA;AACA;AACA;AACA,UAAS,IAAI;AACb,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA,gBAAe,EAAE;AACjB,gBAAe,MAAM;AACrB,iBAAgB,EAAE;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC;AACvC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,MAAM;AACrB,iBAAgB;AAChB;AACA;AACA;AACA,2CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,YAAY;AAC3B,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,YAAY;AAC3B,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,MAAM;AACrB,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA,sCAAqC;AACrC,sCAAqC;AACrC,sCAAqC;AACrC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,UAAU,KAAK;AACxC,gBAAe,MAAM;AACrB,gBAAe,OAAO;AACtB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA,iCAAgC,uBAAuB,EAAE,OAAO;AAChE;AACA;AACA;AACA;AACA;AACA;AAC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,EAAaA,QAAQyD,MAAR;AACbX,iBAAQW,MAAR;AACD;;AAED,gBAASE,SAAT,CAAmBrC,QAAnB,EAA6B;AAC3B,aAAIkB,UAAJ,EAAgB;AACd,mDAAiBlB,QAAjB,EAA2B8B,IAA3B,EAAiCI,YAAjC,EAA+CH,SAA/C;AACD,UAFD,MAEO;AACLG,wBAAalC,QAAb;AACD;AACF;;AAEDzB,iBAAUE,KAAK,CAAL,CAAV,EAAmBA,KAAKV,KAAL,CAAW,CAAX,CAAnB,EAAkCsE,SAAlC,EAA6CN,SAA7C,EAAwD,EAAEnD,wBAAF,EAAeC,cAAf,EAAuBC,UAAvB,EAA6BmC,YAA7B,EAAxD;AACD,MArDa,CAAd;;AAuDA,YAAOL,gBAAgB,IAAhB,GAAuBiB,OAA9B;AACD,IArFD;AAsFD,E;;;;;;;;;AC/FD,mBAAkB,0F;;;;;;;;;ACAlB;AACA;AACA;AACA;AACA,0E;;;;;;;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;;AAEA,yGAAwG,OAAO;AAC/G;AACA;AACA;AACA;AACA;AACA,E;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iCAAgC;AAChC,eAAc;AACd,kBAAiB;AACjB;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;;AAEA;AACA;AACA,6B;;;;;;;;;ACjCA,6BAA4B,e;;;;;;;;;ACA5B;AACA,WAAU;AACV,G;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC;AACpC;;AAEA;AACA;AACA;AACA;AACA,gDAA+C,qEAAiD,oBAAoB;AACpH;AACA;AACA,IAAG,UAAU;AACb,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA,YAAW;AACX,UAAS;AACT,QAAO;AACP;AACA;AACA;AACA,4CAA2C;AAC3C;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,oBAAmB,gCAAgC;AACnD,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,gBAAe,qCAAqC;AACpD;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,mCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC;AAClC;AACA;AACA;AACA;AACA,wBAAuB,wBAAwB;AAC/C;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA;AACA;AACA,IAAG;AACH,mBAAkB,uBAAuB,KAAK;AAC9C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,kBAAiB;AACjB,yBAAwB;AACxB,iBAAgB;AAChB,qBAAoB;AACpB,yBAAwB;AACxB,iBAAgB;AAChB,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2DAA0D,kBAAkB;AAC5E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,QAAO;AACP;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA;AACA,EAAC,E;;;;;;;;;AC1SD;AACA;AACA;AACA,IAAG;AACH,G;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,iBAAiB,EAAE;AACxD;AACA;AACA;AACA;AACA;AACA,iEAAgE,gBAAgB;AAChF;AACA;AACA,IAAG,2CAA2C,gCAAgC;AAC9E;AACA;AACA;AACA;AACA;AACA,yB;;;;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;;;;ACfA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AA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;;;;;;;;;ACtrBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,SAAQ,wBAAwB;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,SAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAQ,mCAAmC;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,YAAW;AACX;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;aCjjBA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4CAA2C;AAC3C,EAAC,4BAA4B;;AAE7B;AACA,wCAAuC,OAAO;AAC9C;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,kCAAiC,gBAAgB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,yBAAwB;AACxB;AACA,8BAA6B;AAC7B;AACA;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,6BAA4B,cAAc;AAC1C;AACA;AACA;AACA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,EAAE;AACd;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,sBAAsB;AAC3C;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,qDAAoD;AACpD;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,oBAAmB,kBAAkB;AACrC;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,EAAE;AACP;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA,WAAU,EAAE;AACZ,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,kBAAiB,wBAAwB;AACzC;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAiB,0CAA0C;AAC3D;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,QAAO;AACP;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA,WAAU,MAAM;AAChB,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAU,MAAM;AAChB,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAiB,kDAAkD;AACnE;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA,WAAU,EAAE;AACZ,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;;AAEA;AACA,WAAU,SAAS;AACnB,WAAU,OAAO;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,0BAAyB;AACzB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA,YAAW;AACX,UAAS;AACT;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB,aAAY,OAAO;AACnB;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA,aAAY,SAAS;AACrB,aAAY,OAAO;AACnB;AACA,cAAa;AACb;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B;AAC1B,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA,aAAY,SAAS;AACrB,aAAY,OAAO;AACnB;AACA,cAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAiB,YAAY;AAC7B;AACA;;AAEA,kBAAiB,0BAA0B;AAC3C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,kBAAiB,YAAY;AAC7B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,iCAAgC;;AAEhC,kCAAiC,eAAe;AAChD;AACA,IAAG;AACH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,eAAc,MAAM;AACpB;AACA,iBAAgB,MAAM;AACtB;AACA,MAAK;AACL,IAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,WAAU,SAAS;AACnB;AACA;AACA,2DAA0D,EAAE;AAC5D,WAAU,cAAc;AACxB;AACA;AACA;AACA;AACA;AACA,YAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB,OAAO;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,qCAAoC,sDAAsD,oEAAoE,4EAA4E;AAC1O;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAU,MAAM;AAChB,WAAU,OAAO;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAU,+BAA+B;AACzC,WAAU,mCAAmC;AAC7C,WAAU;AACV;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,WAAU,MAAM;AAChB,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAU,MAAM;AAChB,WAAU,OAAO;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA,kBAAiB,0CAA0C;AAC3D;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA4C;AAC5C;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,WAAU,OAAO;AACjB,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB,+BAA+B;AACpD,wBAAuB,+BAA+B;AACtD,yBAAwB,+BAA+B;AACvD,wBAAuB;AACvB;AACA,IAAG;AACH;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAkC,+BAA+B;AACjE,mCAAkC,mCAAmC;AACrE,mCAAkC,mCAAmC;AACrE;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB;AACnB;AACA;AACA,6CAA4C;AAC5C;AACA,IAAG;AACH;;AAEA;AACA;AACA,WAAU,OAAO;AACjB,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA,WAAU,OAAO;AACjB;AACA,YAAW;AACX;AACA;AACA,mBAAkB;;AAElB;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,WAAU,MAAM;AAChB,WAAU,SAAS;AACnB,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,oBAAmB,YAAY;AAC/B;AACA;;AAEA;AACA,IAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAU,EAAE;AACZ,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAU,EAAE;AACZ,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;;AAEA,gBAAe;AACf,gBAAe;AACf;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,WAAU,MAAM;AAChB,WAAU,SAAS;AACnB;AACA,WAAU,OAAO;AACjB;AACA,YAAW;AACX;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,oBAAmB,YAAY;AAC/B;AACA;;AAEA;AACA;AACA;;AAEA,sBAAqB,YAAY;AACjC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,MAAK;AACL,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kFAAiF;;AAEjF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA0B,sBAAsB;;AAEhD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kBAAiB,SAAS;AAC1B;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA,EAAC;AACD;AACA,EAAC;AACD;AACA,EAAC;AACD;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,EAAC;AACD;AACA,IAAG;AACH;AACA;;AAEA;;AAEA,4CAA2C,kBAAkB,kCAAkC,qEAAqE,EAAE,EAAE,OAAO,kBAAkB,EAAE,YAAY;;AAE/M;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+CAA8C,cAAc;;AAE5D,EAAC;AACD,8B;;;;;;;;;;ACn8EA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,4BAA2B;AAC3B;AACA;AACA;AACA,6BAA4B,UAAU;;;;;;;;;;ACnLtC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C,iBAAiB;;AAE5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;AACA,G;;;;;;;;;;AC3EA,gB;;;;;;;;;;;;;;mBCWwBoI,iB;;AAXxB;;;;AACA;;;;;;AAEA,KAAMC,UAAU,SAAhB;AACA,KAAMC,YAAY,WAAlB;AACA,KAAMC,WAAW,UAAjB;;AAEA,UAASC,QAAT,CAAkBC,MAAlB,EAA0B;AACxB,UAAO,6BAAcA,MAAd,KAAyB,OAAOA,OAAO9D,IAAd,KAAuB,WAAvD;AACD;;AAEc,UAASyD,iBAAT,CAA2BzE,KAA3B,EAAkC;AAAA,OACvCe,QADuC,GAC1Bf,KAD0B,CACvCe,QADuC;;;AAG/C,UAAO;AAAA,YAAQ,kBAAU;AACvB,WAAI,OAAO+D,MAAP,KAAkB,UAAtB,EAAkC,OAAOA,OAAO9E,KAAP,CAAP;;AAElC,WAAI,CAAC6E,SAASC,MAAT,CAAD,IAAqB,CAAC,yBAAUA,OAAO3E,OAAjB,CAAtB,IAAmD2E,OAAOxD,KAA9D,EAAqE;AACnE,gBAAOyD,KAAKD,MAAL,CAAP;AACD;;AALsB,WAOf9D,IAPe,GAOS8D,MAPT,CAOf9D,IAPe;AAAA,WAOTb,OAPS,GAOS2E,MAPT,CAOT3E,OAPS;AAAA,WAOAiB,IAPA,GAOS0D,MAPT,CAOA1D,IAPA;;;AASvBL,gBAAS,EAAEC,MAASA,IAAT,SAAiB0D,OAAnB,EAA8BtD,UAA9B,EAAT;;AAEA,cAAOjB,QAAQ6E,IAAR,CACL;AAAA,gBAAUjE,SAAS,EAAEC,MAASA,IAAT,SAAiB2D,SAAnB,EAAgCxE,SAAS8E,MAAzC,EAAiD7D,UAAjD,EAAT,CAAV;AAAA,QADK,EAEL;AAAA,gBAASL,SAAS,EAAEC,MAASA,IAAT,SAAiB4D,QAAnB,EAA+BzE,gBAA/B,EAAwCmB,YAAxC,EAAgDF,UAAhD,EAAT,CAAT;AAAA,QAFK,CAAP;AAID,MAfM;AAAA,IAAP;AAgBD,G;;;;;;;;;;;;;;;;;;;mBC9BuB8D,S;;;;AAAT,UAASA,SAAT,CAAmBC,KAAnB,EAA0B;AACvC,OAAIA,UAAU,IAAV,IAAkB,QAAOA,KAAP,uDAAOA,KAAP,OAAiB,QAAvC,EAAiD;AAC/C,YAAO,OAAOA,MAAMH,IAAb,KAAsB,UAA7B;AACD;AACF,E;;;;;;;;;ACJD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,kHAAiH,mBAAmB,EAAE,mBAAmB,4JAA4J;;AAErT,uCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA,EAAC;AACD;AACA,G;;;;;;;;;ACpBA,mBAAkB,mG;;;;;;;;;ACAlB;AACA;AACA,uF;;;;;;;;;ACFA,mD;;;;;;;;;ACAA,mBAAkB,0F;;;;;;;;;ACAlB;AACA;AACA;AACA;AACA,4E;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAsB;AACtB,qBAAoB,uBAAuB,SAAS,IAAI;AACxD,IAAG;AACH,EAAC;AACD;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAAyD;AACzD;AACA,MAAK;AACL;AACA,uBAAsB,iCAAiC;AACvD,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA8D,8BAA8B;AAC5F;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,2DAA0D,gBAAgB;;AAE1E;AACA;AACA;AACA,qBAAoB,oBAAoB;;AAExC,2CAA0C,oBAAoB;;AAE9D;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH,yBAAwB,eAAe,EAAE;AACzC,yBAAwB,gBAAgB;AACxC,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,qDAAoD,KAAK,QAAQ,iCAAiC;AAClG,EAAC;AACD;AACA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2C;;;;;;;;;AC1OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD;AACjD,EAAC;AACD;AACA,sBAAqB;AACrB;AACA,UAAS;AACT,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA0D,sBAAsB;AAChF,iFAAgF,sBAAsB;AACtG,G;;;;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;;;;ACdA;AACA;AACA;AACA;AACA,G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CAAY,CAAC,SAAD,EAAY,IAAZ,CAAZ,CAAhB,CAPuC,CAOS;AAChD;AACA,2CAAmB7I,KAAnB,EAA0BoX,OAA1B,EAAmC3C,UAAnC;AACA,UAAOA,UAAP;AACD;;AAED,KAAMjH,YAAY;AAChBrF,mBADgB;AAEhBsF,YAAS,EAAEnF,QAAF,EAAOG,YAAP,EAAc8F,YAAd,EAAqBN,gBAArB,EAA8BE,sBAA9B,EAA0CM,kBAA1C,EAAoDG,YAApD,EAA2DV,wBAA3D,EAAwEE,wBAAxE,EAFO;AAGhBV,cAAW,EAAElF,QAAF,EAAOsG,sBAAP,EAAmBT,wBAAnB;AAHK,EAAlB;mBAKeb,S;SAGMiC,e,GAAnBA,e;SACcC,U,GAAdA,U;SACmBC,e,GAAnBA,e;;;;;;;;;mCC93BF;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,QAAQ;AAClC,kCAAiC,iCAAiC;AAClE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C;AAC7C;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,SAAS;AAC1B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,uCAAsC,EAAE;AACxC,qBAAoB;AACpB;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,sCAAqC;AACrC;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAsB,SAAS;AAC/B;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,mDAAuB,aAAa;;;AAGpC,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAC;;;;;;;;;;;AC/QD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB,mDAAmD;AACxE;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,YAAY;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,wCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;AACA,cAAa,iBAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,SAAS;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iDAAgD,EAAE;AAClD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,kBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAwB,eAAe;AACvC;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,yBAAwB,QAAQ;AAChC;AACA,sBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,sBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,sBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,sBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,oBAAmB,cAAc;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wDAAuD,OAAO;AAC9D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,wDAAuD,OAAO;AAC9D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAqB,QAAQ;AAC7B;AACA;AACA,IAAG;AACH;AACA,gBAAe,SAAS;AACxB;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,gBAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAiB,YAAY;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,kBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,gBAAgB;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;AC5vDA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mCAAkC,SAAS;AAC3C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2CAA0C,UAAU;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;;;;;;;;ACjHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,SAAQ,WAAW;;AAEnB;AACA;AACA;AACA,SAAQ,WAAW;;AAEnB;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA,SAAQ,WAAW;;AAEnB;AACA;AACA,SAAQ,UAAU;;AAElB;AACA;;;;;;;;;;ACnFA,kBAAiB;;AAEjB;AACA;AACA;;;;;;;;;;ACJA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK,cAAc;AACnB,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;;;;;;;;;ACpDD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;;;;;;;;;;;;;;ACzBD;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;AC7BA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;;;;;;;;ACXA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,sBAAqB,QAAQ;AAC7B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,mBAAkB,QAAQ;AAC1B;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;ACzIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,wBAAuB,SAAS;AAChC;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6CAA4C,KAAK;;AAEjD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA,oCAAmC,OAAO;AAC1C;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;;AAGA;AACA;AACA,0DAAyD;AACzD;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,UAAS;AACT;AACA;AACA,YAAW;AACX;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,SAAS;AACpB;AACA,YAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;ACzkBA;AACA;AACA;AACA;AACA;AACA,E;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB,QAAQ;AAC3B;AACA;AACA;;AAEA;;AAEA;AACA,aAAY,OAAO,OAAO,YAAY,OAAO,OAAO,OAAO;AAC3D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;;;;;;;;;AClJA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB,QAAQ;AAC3B;;AAEA;;AAEA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;;;;;;;;;ACnPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAgB,cAAc;AAC9B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;AC1JA;AACA,sCAAqC;AACrC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mBAAkB;;;;;;;;;;;;AChClB;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,kdAAid,+BAA+B;AAChf;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,yBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kBAAiB,QAAQ;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,QAAQ;AACzB;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK,OAAO;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK,OAAO;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAgB,YAAY;AAC5B;AACA;;AAEA;AACA,kBAAiB,OAAO;AACxB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;AC1MA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA,iBAAgB,eAAe;AAC/B;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;ACzCA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA,MAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oBAAmB,QAAQ;AAC3B;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,sBAAqB,gBAAgB;AACrC;;AAEA,wBAAuB,UAAU;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SC1CgB0H,O,GAAAA,O;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AAC/B7kC,uBAAkBvB,SAASuB,gBADI;AAE/BD,uBAAkBA,gBAFa;AAG/B3G,aAAQmuC;AAHuB,IAAZ,CAArB;;AAMA,OAAM7Z,aAAa,uBAAajvB,QAAb,CAAnB;AACAivB,cAAWvxB,SAAX,GAAuB0oC,YAAvB;;AAEAnX,cAAWvU,eAAX;AACA,UAAOuU,UAAP;AACD,G;;;;;;;;;ACpED,mBAAkB,uF;;;;;;;;;ACAlB;AACA;AACA;AACA;AACA;AACA,sE;;;;;;;;;ACLA;AACA;;AAEA;AACA;AACA,yBAAwB,mEAAmE;AAC3F,EAAC;AACD;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,EAAC,gB;;;;;;;;;AChBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAsB,OAAO;AAC7B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B,2BAA0B;AAC1B,2BAA0B;AAC1B,sBAAqB;AACrB;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,8DAA6D,OAAO;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;AACrB,2BAA0B;AAC1B,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,G;;;;;;;;;AC7IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA,G;;;;;;;;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS,eAAe;AACxB;AACA;AACA;AACA,uCAAsC;AACtC;AACA,+BAA8B;AAC9B,8BAA6B;AAC7B,gCAA+B;AAC/B,oCAAmC;AACnC,UAAS,+BAA+B;AACxC;AACA;AACA;AACA;AACA,G;;;;;;;;;AC3CA;AACA;;AAEA;AACA;AACA,G;;;;;;;;;ACLA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;;;;ACfA;AACA;;AAEA,wCAAuC,qEAAgD,E;;;;;;;;;ACHvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACRA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACLA;;;;;;AAEA,KAAMuR,SAAS;AACbpqC,WAAQ;AACN2yC,aAAQ,EAAE5uC,OAAO,QAAT,EAAmBznB,MAAM,QAAzB,EAAmCkmB,cAAc,GAAjD,EAAsDG,UAAU,GAAhE,EAAqEyB,MAAM,GAA3E,EAAgFJ,YAAY,IAA5F,EADF;AAENusC,oBAAe,EAAExsC,OAAO,uBAAT,EAAkCznB,MAAM,SAAxC,EAAmDkmB,cAAc,EAAjE,EAAqEG,UAAU,CAA/E,EA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tC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAkB,oBAAoB;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,EAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAuE,QAAQ;AAC/E;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAuE,QAAQ;AAC/E;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAqB,OAAO;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0DAAyD,SAAS,eAAe;AACjF;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,EAAC,EAAE,kCAAkC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,4BAA2B;AAC3B,4BAA2B;;AAE3B,2BAA0B;;AAE1B,wCAAuC;;AAEvC,iBAAgB;AAChB,2DAA0D;AAC1D,4DAA2D;AAC3D,+CAA8C;AAC9C,KAAI;AACJ;;AAEA;AACA,4BAA2B;AAC3B,8BAA6B;;AAE7B,2BAA0B;;AAE1B,iBAAgB;AAChB,mDAAkD;AAClD,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,4BAA2B,4CAA4C;AACvE;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,4BAA2B,2CAA2C;;AAEtE;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+CAA8C;AAC9C,iDAAgD;AAChD,wCAAuC;AACvC,qDAAoD;AACpD,qDAAoD;AACpD;AACA;AACA;;AAEA;AACA;AACA,gDAA+C;AAC/C,kDAAiD;AACjD,yCAAwC;AACxC,sDAAqD;AACrD,sDAAqD;AACrD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,+CAA8C;AAC9C,+CAA8C;AAC9C,+CAA8C;AAC9C,+CAA8C;;AAE9C;AACA,gDAA+C;AAC/C,gDAA+C;AAC/C,gDAA+C;AAC/C,gDAA+C;AAC/C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yBAAwB,yCAAyC;AACjE,0BAAyB,0CAA0C;AACnE,sBAAqB,qCAAqC;AAC1D,4BAA2B,4CAA4C;AACvE,4BAA2B,4CAA4C;AACvE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yBAAwB,wCAAwC;AAChE,0BAAyB,yCAAyC;AAClE,sBAAqB,oCAAoC;AACzD,4BAA2B,2CAA2C;AACtE,4BAA2B,2CAA2C;;AAEtE;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,OAAO;AACxB,oBAAmB,YAAY;AAC/B,sBAAqB,WAAW;AAChC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2DAA0D;AAC1D;;AAEA,sCAAqC;AACrC,sCAAqC;AACrC,sCAAqC;AACrC,sCAAqC;AACrC,sCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,OAAO;AACxB,oBAAmB,YAAY;AAC/B,sBAAqB,WAAW;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,EAAC,EAAE,uEAAuE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,4BAA2B;;AAE3B,+BAA8B;;AAE9B,iBAAgB;AAChB,gEAA+D;AAC/D,KAAI;AACJ;;AAEA;AACA,4BAA2B;;AAE3B,uBAAsB;;AAEtB,iBAAgB;AAChB,2BAA0B;AAC1B,KAAI;AACJ;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB,QAAQ;AAC3B;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,EAAC,EAAE,iDAAiD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAAyD,QAAQ;;AAEjE;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA,EAAC,EAAE,4NAA4N;AAC/N;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,kBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;;AAGA,4BAA2B;AAC3B,6BAA4B;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,EAAC,EAAE,kEAAkE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB,qFAAqF;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gCAA+B,gEAAgE;AAC/F,sCAAqC,iGAAiG;AACtI;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;;AAGA,EAAC,EAAE,cAAc;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,aAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,aAAY,OAAO;AACnB;AACA;AACA;AACA;AACA,kBAAiB,8BAA8B;AAC/C;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,WAAW;AAC5B,wBAAuB,OAAO;AAC9B;AACA,0BAAyB,OAAO;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,sBAAqB,QAAQ;AAC7B;AACA,wBAAuB,OAAO;AAC9B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,qBAAqB;AAClC;AACA,gBAAe,qBAAqB;AACpC;AACA,kBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,qBAAqB;AAClC;AACA,gBAAe,gBAAgB;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,qBAAqB;AAClC;AACA;AACA;;AAEA,cAAa,gBAAgB;AAC7B;AACA;AACA;AACA,gBAAe,qBAAqB;AACpC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,EAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO,6BAA6B;AACpC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,+BAA+B;AACtC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,+BAA+B;AACtC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,+BAA+B;AACtC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,+BAA+B;AACtC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,6BAA6B;AACpC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,6BAA6B;AACpC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,8BAA8B;AACrC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,yCAAyC;AAChD,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,oCAAoC;AAC3C,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,8BAA8B;AACrC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,kCAAkC;AACzC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,kCAAkC;AACzC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,0BAA0B;AACjC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,kCAAkC;AACzC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,yCAAyC;AAChD,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,gCAAgC;AACvC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,kCAAkC;AACzC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,yCAAyC;AAChD,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,qCAAqC;AAC5C,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,2BAA2B;AAClC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,2BAA2B;AAClC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,2BAA2B;AAClC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,2BAA2B;AAClC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,4BAA4B;AACnC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,6CAA6C;AACpD,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,6BAA6B;AACpC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,QAAO,iCAAiC;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,iBAAgB,sBAAsB;AACtC;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,iBAAgB,sBAAsB;AACtC;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,iBAAgB,uBAAuB;AACvC;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,iBAAgB,uBAAuB;AACvC;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,iBAAgB,uBAAuB;AACvC;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,iBAAgB,uBAAuB;AACvC;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,iBAAgB,wBAAwB;AACxC;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,iBAAgB,wBAAwB;AACxC;AACA;AACA;AACA;AACA;;AAEA;;AAEA,EAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oBAAmB,yBAAyB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,8BAA6B,6CAA6C;AAC1E;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAC,EAAE,qCAAqC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,sBAAsB;AACvC;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;;AAEA,EAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;;AAEA,EAAC,EAAE,wCAAwC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;;AAEA,EAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAwB;AACxB;AACA,IAAG,4BAA4B;AAC/B;AACA,IAAG,4BAA4B;AAC/B;AACA,IAAG,4BAA4B;AAC/B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,EAAC,EAAE,iDAAiD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,EAAC,EAAE,eAAe;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA,EAAC,EAAE,6DAA6D;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,EAAC,EAAE,qHAAqH;AACxH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;;AAEA,EAAC,EAAE,qBAAqB;AACxB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,EAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,EAAC,EAAE,mCAAmC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA,iCAAgC;AAChC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAe,k7DAAk7D;AACj8D;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,kBAAiB,YAAY,YAAY;AACzC,kBAAiB,YAAY,YAAY;AACzC,kBAAiB,YAAY,aAAa;;AAE1C,oBAAmB,cAAc,cAAc;AAC/C,oBAAmB,cAAc,cAAc;AAC/C,oBAAmB,cAAc,eAAe;;AAEhD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAC;;AAED;;AAEA,EAAC,EAAE,kBAAkB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,EAAC,EAAE,sDAAsD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA,EAAC,EAAE,eAAe;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;;AAEA;AACA;AACA,4BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;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ED;AACA;AACA,0CAAyC,sBAAsB,EAAE;AACjE;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAe,sBAAsB;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,sBAAsB;AACnC;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAQ,mBAAmB;AAC3B;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C;AAC3C,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,kBAAkB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,kBAAiB,iBAAiB;AAClC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB,aAAa;;AAEhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAY;AACZ,cAAa,oBAAoB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;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;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA,EAAC;AACD;AACA,EAAC;AACD;AACA,EAAC;AACD;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA,WAAU,IAAI;AACd;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,kBAAiB,wBAAwB;AACzC;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,kBAAiB,uCAAuC;AACxD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,QAAO;AACP;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA,WAAU,MAAM;AAChB,WAAU,OAAO;AACjB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAU,MAAM;AAChB;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA,sBAAqB,YAAY;AACjC;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;AACA,WAAU,IAAI;AACd;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;;AAEA;AACA,WAAU,SAAS;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA,YAAW;AACX,UAAS;AACT;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA,aAAY,SAAS;AACrB;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,EAAC;AACD,qC;;;;;;;;;;;;;;;;;;;;;;;;;mBCznCwBjlC,M;;AAXxB;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAEA,KAAMymC,mBAAmB,EAAzB;;AAEe,UAASzmC,MAAT,CAAgBtwF,KAAhB,QAAyD;AAAA,OAAhC02H,MAAgC,QAAhCA,MAAgC;AAAA,OAAxBC,UAAwB,QAAxBA,UAAwB;AAAA,OAAZX,QAAY,QAAZA,QAAY;;AACtE,OAAMnjC,WAAW,8BAAgB7yF,KAAhB,CAAjB;;AAEA,OAAIoX,UAAUpX,MAAM6I,KAAN,CAAY,CAAC,SAAD,EAAY,IAAZ,CAAZ,CAAd;AACA,OAAMmuH,gBAAgBnkC,YAAY,CAACz7E,OAAb,IAAwB,CAAC,oCAAuBpX,KAAvB,CAA/C;;AAEA,OAAMi3H,+KAAN;AASA,OAAI7lH,WAAW,CAAC,iBAAE,OAAF,EAAW,EAAEJ,OAAO,EAAE8kF,WAAWmhC,QAAb,EAAT,EAAX,CAAD,CAAf;;AAEA,OAAMp8C,4BAA4B76E,MAAM6I,KAAN,CAAY,CAAC,QAAD,EAAW,2BAAX,CAAZ,CAAlC;AACA,OAAMquH,eAAgB,sBAAc,EAAd,EAAkB,iBAAO5mC,MAAzB,EAAiC;AACrD6mC,sBAAiBH,gBAAgB,EAAhB,YAA4B,8BAA5B,oBAAsD5/G,OAAtD,kBADoC;AAErDggH,uBAAkB,WAFmC;AAGrDC,qBAAgB,WAHqC;AAIrDC,yBAAoB,QAJiC;AAKrDlhH,eAAWsgH,UAAUC,UAAX,GAAyB,UAAzB,GAAsC,UALK;AAMrDrkC,gBAAW,YAN0C;AAOrD/yC,sBAAiB,0BAAav/C,KAAb,IAAuB66E,yBAAvB,GAAmD,aAPf;AAQrD4V,eAAU;AAR2C,IAAjC,CAAtB;;AAWA,OAAI,wBAAUzwF,KAAV,CAAJ,EAAsB;AACpBoR,cAAS1U,IAAT,CAAc,qBAAMsD,KAAN,CAAd;AACD,IAFD,MAEO;AACLoR,cAAS1U,IAAT,CAAc,sBAAOsD,KAAP,EAAc,QAAd,CAAd;AACA,SAAI6yF,QAAJ,EAAczhF,SAAS1U,IAAT,CAAc,gCAAiBsD,KAAjB,CAAd,EAAd,KACKoR,SAAS1U,IAAT,CAAc,wBAASsD,KAAT,CAAd;AACN;;AAED,UAAO,iBAAE,iBAAF,EAAqB,EAAE+wF,OAAOmmC,YAAT,EAAuB9jC,MAAM;AACvDC,eAAQkkC,yBAAyBv3H,KAAzB;AAD+C,MAA7B,EAArB,EAEDoR,QAFC,CAAP;AAGD;;AAED,UAASmmH,wBAAT,CAAkCv3H,KAAlC,EAAyC;AACvC,UAAO,YAAM;AACX,MAAE;AACA,MAAC,wBAAD,EAA2B,oBAA3B,CADF,EAEE,CAAC,qBAAD,EAAwB,eAAxB,CAFF,EAGE,CAAC,oBAAD,EAAuB,qBAAvB,CAHF,EAIE6J,OAJF,CAIU,UAAU6b,IAAV,EAAgB;AACxBvL,gBAASzb,gBAAT,CAA0BgnB,KAAK,CAAL,CAA1B,EAAmC,YAAM;AACvC;AACA1lB,eAAMe,QAAN,CAAe,2BAAc,CAAC,CAACoZ,SAASuL,KAAK,CAAL,CAAT,CAAhB,CAAf;AACD,QAHD;AAID,MATD;AAUD,IAXD;AAYD;;AAGD","file":"claraplayer-2.2.23.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"claraplayer\"] = factory();\n\telse\n\t\troot[\"claraplayer\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/js/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8c203dff91ed0db6a962","\"use strict\";\n\nexports.__esModule = true;\n\nvar _from = require(\"../core-js/array/from\");\n\nvar _from2 = _interopRequireDefault(_from);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return (0, _from2.default)(arr);\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/toConsumableArray.js\n// module id = 2\n// module chunks = 0 1 2","module.exports = { \"default\": require(\"core-js/library/fn/array/from\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/array/from.js\n// module id = 3\n// module chunks = 0 1 2","require('../../modules/es6.string.iterator');\nrequire('../../modules/es6.array.from');\nmodule.exports = require('../../modules/_core').Array.from;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/array/from.js\n// module id = 4\n// module chunks = 0 1 2","'use strict';\nvar $at  = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function(iterated){\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , index = this._i\n    , point;\n  if(index >= O.length)return {value: undefined, done: true};\n  point = $at(O, index);\n  this._i += point.length;\n  return {value: point, done: false};\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.string.iterator.js\n// module id = 5\n// module chunks = 0 1 2","var toInteger = require('./_to-integer')\n  , defined   = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function(TO_STRING){\n  return function(that, pos){\n    var s = String(defined(that))\n      , i = toInteger(pos)\n      , l = s.length\n      , a, b;\n    if(i < 0 || i >= l)return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_string-at.js\n// module id = 6\n// module chunks = 0 1 2","// 7.1.4 ToInteger\nvar ceil  = Math.ceil\n  , floor = Math.floor;\nmodule.exports = function(it){\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_to-integer.js\n// module id = 7\n// module chunks = 0 1 2","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function(it){\n  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_defined.js\n// module id = 8\n// module chunks = 0 1 2","'use strict';\nvar LIBRARY        = require('./_library')\n  , $export        = require('./_export')\n  , redefine       = require('./_redefine')\n  , hide           = require('./_hide')\n  , has            = require('./_has')\n  , Iterators      = require('./_iterators')\n  , $iterCreate    = require('./_iter-create')\n  , setToStringTag = require('./_set-to-string-tag')\n  , getPrototypeOf = require('./_object-gpo')\n  , ITERATOR       = require('./_wks')('iterator')\n  , BUGGY          = !([].keys && 'next' in [].keys()) // Safari has buggy iterators w/o `next`\n  , FF_ITERATOR    = '@@iterator'\n  , KEYS           = 'keys'\n  , VALUES         = 'values';\n\nvar returnThis = function(){ return this; };\n\nmodule.exports = function(Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED){\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function(kind){\n    if(!BUGGY && kind in proto)return proto[kind];\n    switch(kind){\n      case KEYS: return function keys(){ return new Constructor(this, kind); };\n      case VALUES: return function values(){ return new Constructor(this, kind); };\n    } return function entries(){ return new Constructor(this, kind); };\n  };\n  var TAG        = NAME + ' Iterator'\n    , DEF_VALUES = DEFAULT == VALUES\n    , VALUES_BUG = false\n    , proto      = Base.prototype\n    , $native    = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT]\n    , $default   = $native || getMethod(DEFAULT)\n    , $entries   = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined\n    , $anyNative = NAME == 'Array' ? proto.entries || $native : $native\n    , methods, key, IteratorPrototype;\n  // Fix native\n  if($anyNative){\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base));\n    if(IteratorPrototype !== Object.prototype){\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if(!LIBRARY && !has(IteratorPrototype, ITERATOR))hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if(DEF_VALUES && $native && $native.name !== VALUES){\n    VALUES_BUG = true;\n    $default = function values(){ return $native.call(this); };\n  }\n  // Define iterator\n  if((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])){\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG]  = returnThis;\n  if(DEFAULT){\n    methods = {\n      values:  DEF_VALUES ? $default : getMethod(VALUES),\n      keys:    IS_SET     ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if(FORCED)for(key in methods){\n      if(!(key in proto))redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_iter-define.js\n// module id = 9\n// module chunks = 0 1 2","module.exports = true;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_library.js\n// module id = 10\n// module chunks = 0 1 2","var global    = require('./_global')\n  , core      = require('./_core')\n  , ctx       = require('./_ctx')\n  , hide      = require('./_hide')\n  , PROTOTYPE = 'prototype';\n\nvar $export = function(type, name, source){\n  var IS_FORCED = type & $export.F\n    , IS_GLOBAL = type & $export.G\n    , IS_STATIC = type & $export.S\n    , IS_PROTO  = type & $export.P\n    , IS_BIND   = type & $export.B\n    , IS_WRAP   = type & $export.W\n    , exports   = IS_GLOBAL ? core : core[name] || (core[name] = {})\n    , expProto  = exports[PROTOTYPE]\n    , target    = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE]\n    , key, own, out;\n  if(IS_GLOBAL)source = name;\n  for(key in source){\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if(own && key in exports)continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function(C){\n      var F = function(a, b, c){\n        if(this instanceof C){\n          switch(arguments.length){\n            case 0: return new C;\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if(IS_PROTO){\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if(type & $export.R && expProto && !expProto[key])hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library` \nmodule.exports = $export;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_export.js\n// module id = 11\n// module chunks = 0 1 2","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\nif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_global.js\n// module id = 12\n// module chunks = 0 1 2","var core = module.exports = {version: '2.4.0'};\nif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_core.js\n// module id = 13\n// module chunks = 0 1 2","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function(fn, that, length){\n  aFunction(fn);\n  if(that === undefined)return fn;\n  switch(length){\n    case 1: return function(a){\n      return fn.call(that, a);\n    };\n    case 2: return function(a, b){\n      return fn.call(that, a, b);\n    };\n    case 3: return function(a, b, c){\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function(/* ...args */){\n    return fn.apply(that, arguments);\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_ctx.js\n// module id = 14\n// module chunks = 0 1 2","module.exports = function(it){\n  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n  return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_a-function.js\n// module id = 15\n// module chunks = 0 1 2","var dP         = require('./_object-dp')\n  , createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function(object, key, value){\n  return dP.f(object, key, createDesc(1, value));\n} : function(object, key, value){\n  object[key] = value;\n  return object;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_hide.js\n// module id = 16\n// module chunks = 0 1 2","var anObject       = require('./_an-object')\n  , IE8_DOM_DEFINE = require('./_ie8-dom-define')\n  , toPrimitive    = require('./_to-primitive')\n  , dP             = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes){\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if(IE8_DOM_DEFINE)try {\n    return dP(O, P, Attributes);\n  } catch(e){ /* empty */ }\n  if('get' in Attributes || 'set' in Attributes)throw TypeError('Accessors not supported!');\n  if('value' in Attributes)O[P] = Attributes.value;\n  return O;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-dp.js\n// module id = 17\n// module chunks = 0 1 2","var isObject = require('./_is-object');\nmodule.exports = function(it){\n  if(!isObject(it))throw TypeError(it + ' is not an object!');\n  return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_an-object.js\n// module id = 18\n// module chunks = 0 1 2","module.exports = function(it){\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_is-object.js\n// module id = 19\n// module chunks = 0 1 2","module.exports = !require('./_descriptors') && !require('./_fails')(function(){\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', {get: function(){ return 7; }}).a != 7;\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_ie8-dom-define.js\n// module id = 20\n// module chunks = 0 1 2","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function(){\n  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_descriptors.js\n// module id = 21\n// module chunks = 0 1 2","module.exports = function(exec){\n  try {\n    return !!exec();\n  } catch(e){\n    return true;\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_fails.js\n// module id = 22\n// module chunks = 0 1 2","var isObject = require('./_is-object')\n  , document = require('./_global').document\n  // in old IE typeof document.createElement is 'object'\n  , is = isObject(document) && isObject(document.createElement);\nmodule.exports = function(it){\n  return is ? document.createElement(it) : {};\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_dom-create.js\n// module id = 23\n// module chunks = 0 1 2","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function(it, S){\n  if(!isObject(it))return it;\n  var fn, val;\n  if(S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_to-primitive.js\n// module id = 24\n// module chunks = 0 1 2","module.exports = function(bitmap, value){\n  return {\n    enumerable  : !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable    : !(bitmap & 4),\n    value       : value\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_property-desc.js\n// module id = 25\n// module chunks = 0 1 2","module.exports = require('./_hide');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_redefine.js\n// module id = 26\n// module chunks = 0 1 2","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function(it, key){\n  return hasOwnProperty.call(it, key);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_has.js\n// module id = 27\n// module chunks = 0 1 2","module.exports = {};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_iterators.js\n// module id = 28\n// module chunks = 0 1 2","'use strict';\nvar create         = require('./_object-create')\n  , descriptor     = require('./_property-desc')\n  , setToStringTag = require('./_set-to-string-tag')\n  , IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function(){ return this; });\n\nmodule.exports = function(Constructor, NAME, next){\n  Constructor.prototype = create(IteratorPrototype, {next: descriptor(1, next)});\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_iter-create.js\n// module id = 29\n// module chunks = 0 1 2","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject    = require('./_an-object')\n  , dPs         = require('./_object-dps')\n  , enumBugKeys = require('./_enum-bug-keys')\n  , IE_PROTO    = require('./_shared-key')('IE_PROTO')\n  , Empty       = function(){ /* empty */ }\n  , PROTOTYPE   = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function(){\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe')\n    , i      = enumBugKeys.length\n    , lt     = '<'\n    , gt     = '>'\n    , iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while(i--)delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties){\n  var result;\n  if(O !== null){\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty;\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-create.js\n// module id = 30\n// module chunks = 0 1 2","var dP       = require('./_object-dp')\n  , anObject = require('./_an-object')\n  , getKeys  = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties){\n  anObject(O);\n  var keys   = getKeys(Properties)\n    , length = keys.length\n    , i = 0\n    , P;\n  while(length > i)dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-dps.js\n// module id = 31\n// module chunks = 0 1 2","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys       = require('./_object-keys-internal')\n  , enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O){\n  return $keys(O, enumBugKeys);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-keys.js\n// module id = 32\n// module chunks = 0 1 2","var has          = require('./_has')\n  , toIObject    = require('./_to-iobject')\n  , arrayIndexOf = require('./_array-includes')(false)\n  , IE_PROTO     = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function(object, names){\n  var O      = toIObject(object)\n    , i      = 0\n    , result = []\n    , key;\n  for(key in O)if(key != IE_PROTO)has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while(names.length > i)if(has(O, key = names[i++])){\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-keys-internal.js\n// module id = 33\n// module chunks = 0 1 2","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject')\n  , defined = require('./_defined');\nmodule.exports = function(it){\n  return IObject(defined(it));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_to-iobject.js\n// module id = 34\n// module chunks = 0 1 2","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function(it){\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_iobject.js\n// module id = 35\n// module chunks = 0 1 2","var toString = {}.toString;\n\nmodule.exports = function(it){\n  return toString.call(it).slice(8, -1);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_cof.js\n// module id = 36\n// module chunks = 0 1 2","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject')\n  , toLength  = require('./_to-length')\n  , toIndex   = require('./_to-index');\nmodule.exports = function(IS_INCLUDES){\n  return function($this, el, fromIndex){\n    var O      = toIObject($this)\n      , length = toLength(O.length)\n      , index  = toIndex(fromIndex, length)\n      , value;\n    // Array#includes uses SameValueZero equality algorithm\n    if(IS_INCLUDES && el != el)while(length > index){\n      value = O[index++];\n      if(value != value)return true;\n    // Array#toIndex ignores holes, Array#includes - not\n    } else for(;length > index; index++)if(IS_INCLUDES || index in O){\n      if(O[index] === el)return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_array-includes.js\n// module id = 37\n// module chunks = 0 1 2","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer')\n  , min       = Math.min;\nmodule.exports = function(it){\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_to-length.js\n// module id = 38\n// module chunks = 0 1 2","var toInteger = require('./_to-integer')\n  , max       = Math.max\n  , min       = Math.min;\nmodule.exports = function(index, length){\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_to-index.js\n// module id = 39\n// module chunks = 0 1 2","var shared = require('./_shared')('keys')\n  , uid    = require('./_uid');\nmodule.exports = function(key){\n  return shared[key] || (shared[key] = uid(key));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_shared-key.js\n// module id = 40\n// module chunks = 0 1 2","var global = require('./_global')\n  , SHARED = '__core-js_shared__'\n  , store  = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function(key){\n  return store[key] || (store[key] = {});\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_shared.js\n// module id = 41\n// module chunks = 0 1 2","var id = 0\n  , px = Math.random();\nmodule.exports = function(key){\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_uid.js\n// module id = 42\n// module chunks = 0 1 2","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_enum-bug-keys.js\n// module id = 43\n// module chunks = 0 1 2","module.exports = require('./_global').document && document.documentElement;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_html.js\n// module id = 44\n// module chunks = 0 1 2","var def = require('./_object-dp').f\n  , has = require('./_has')\n  , TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function(it, tag, stat){\n  if(it && !has(it = stat ? it : it.prototype, TAG))def(it, TAG, {configurable: true, value: tag});\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_set-to-string-tag.js\n// module id = 45\n// module chunks = 0 1 2","var store      = require('./_shared')('wks')\n  , uid        = require('./_uid')\n  , Symbol     = require('./_global').Symbol\n  , USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function(name){\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_wks.js\n// module id = 46\n// module chunks = 0 1 2","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has         = require('./_has')\n  , toObject    = require('./_to-object')\n  , IE_PROTO    = require('./_shared-key')('IE_PROTO')\n  , ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function(O){\n  O = toObject(O);\n  if(has(O, IE_PROTO))return O[IE_PROTO];\n  if(typeof O.constructor == 'function' && O instanceof O.constructor){\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-gpo.js\n// module id = 47\n// module chunks = 0 1 2","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function(it){\n  return Object(defined(it));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_to-object.js\n// module id = 48\n// module chunks = 0 1 2","'use strict';\nvar ctx            = require('./_ctx')\n  , $export        = require('./_export')\n  , toObject       = require('./_to-object')\n  , call           = require('./_iter-call')\n  , isArrayIter    = require('./_is-array-iter')\n  , toLength       = require('./_to-length')\n  , createProperty = require('./_create-property')\n  , getIterFn      = require('./core.get-iterator-method');\n\n$export($export.S + $export.F * !require('./_iter-detect')(function(iter){ Array.from(iter); }), 'Array', {\n  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n  from: function from(arrayLike/*, mapfn = undefined, thisArg = undefined*/){\n    var O       = toObject(arrayLike)\n      , C       = typeof this == 'function' ? this : Array\n      , aLen    = arguments.length\n      , mapfn   = aLen > 1 ? arguments[1] : undefined\n      , mapping = mapfn !== undefined\n      , index   = 0\n      , iterFn  = getIterFn(O)\n      , length, result, step, iterator;\n    if(mapping)mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);\n    // if object isn't iterable or it's array with default iterator - use simple case\n    if(iterFn != undefined && !(C == Array && isArrayIter(iterFn))){\n      for(iterator = iterFn.call(O), result = new C; !(step = iterator.next()).done; index++){\n        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);\n      }\n    } else {\n      length = toLength(O.length);\n      for(result = new C(length); length > index; index++){\n        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);\n      }\n    }\n    result.length = index;\n    return result;\n  }\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.array.from.js\n// module id = 49\n// module chunks = 0 1 2","// call something on iterator step with safe closing on error\nvar anObject = require('./_an-object');\nmodule.exports = function(iterator, fn, value, entries){\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch(e){\n    var ret = iterator['return'];\n    if(ret !== undefined)anObject(ret.call(iterator));\n    throw e;\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_iter-call.js\n// module id = 50\n// module chunks = 0 1 2","// check on default Array iterator\nvar Iterators  = require('./_iterators')\n  , ITERATOR   = require('./_wks')('iterator')\n  , ArrayProto = Array.prototype;\n\nmodule.exports = function(it){\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_is-array-iter.js\n// module id = 51\n// module chunks = 0 1 2","'use strict';\nvar $defineProperty = require('./_object-dp')\n  , createDesc      = require('./_property-desc');\n\nmodule.exports = function(object, index, value){\n  if(index in object)$defineProperty.f(object, index, createDesc(0, value));\n  else object[index] = value;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_create-property.js\n// module id = 52\n// module chunks = 0 1 2","var classof   = require('./_classof')\n  , ITERATOR  = require('./_wks')('iterator')\n  , Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function(it){\n  if(it != undefined)return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/core.get-iterator-method.js\n// module id = 53\n// module chunks = 0 1 2","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof')\n  , TAG = require('./_wks')('toStringTag')\n  // ES3 wrong here\n  , ARG = cof(function(){ return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function(it, key){\n  try {\n    return it[key];\n  } catch(e){ /* empty */ }\n};\n\nmodule.exports = function(it){\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_classof.js\n// module id = 54\n// module chunks = 0 1 2","var ITERATOR     = require('./_wks')('iterator')\n  , SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function(){ SAFE_CLOSING = true; };\n  Array.from(riter, function(){ throw 2; });\n} catch(e){ /* empty */ }\n\nmodule.exports = function(exec, skipClosing){\n  if(!skipClosing && !SAFE_CLOSING)return false;\n  var safe = false;\n  try {\n    var arr  = [7]\n      , iter = arr[ITERATOR]();\n    iter.next = function(){ return {done: safe = true}; };\n    arr[ITERATOR] = function(){ return iter; };\n    exec(arr);\n  } catch(e){ /* empty */ }\n  return safe;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_iter-detect.js\n// module id = 55\n// module chunks = 0 1 2","module.exports = { \"default\": require(\"core-js/library/fn/object/assign\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/assign.js\n// module id = 56\n// module chunks = 0 1 2","require('../../modules/es6.object.assign');\nmodule.exports = require('../../modules/_core').Object.assign;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/object/assign.js\n// module id = 57\n// module chunks = 0 1 2","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', {assign: require('./_object-assign')});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.object.assign.js\n// module id = 58\n// module chunks = 0 1 2","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar getKeys  = require('./_object-keys')\n  , gOPS     = require('./_object-gops')\n  , pIE      = require('./_object-pie')\n  , toObject = require('./_to-object')\n  , IObject  = require('./_iobject')\n  , $assign  = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function(){\n  var A = {}\n    , B = {}\n    , S = Symbol()\n    , K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function(k){ B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source){ // eslint-disable-line no-unused-vars\n  var T     = toObject(target)\n    , aLen  = arguments.length\n    , index = 1\n    , getSymbols = gOPS.f\n    , isEnum     = pIE.f;\n  while(aLen > index){\n    var S      = IObject(arguments[index++])\n      , keys   = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S)\n      , length = keys.length\n      , j      = 0\n      , key;\n    while(length > j)if(isEnum.call(S, key = keys[j++]))T[key] = S[key];\n  } return T;\n} : $assign;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-assign.js\n// module id = 59\n// module chunks = 0 1 2","exports.f = Object.getOwnPropertySymbols;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-gops.js\n// module id = 60\n// module chunks = 0 1 2","exports.f = {}.propertyIsEnumerable;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-pie.js\n// module id = 61\n// module chunks = 0 1 2","var THREE = require('./three');\n// File:examples/js/pmrem/PMREMGenerator.js\n\n/**\n * @author Prashant Sharma / spidersharma03\n * @author Ben Houston / bhouston, https://clara.io\n *\n * To avoid cube map seams, I create an extra pixel around each face. This way when the cube map is\n * sampled by an application later(with a little care by sampling the centre of the texel), the extra 1 border\n *\tof pixels makes sure that there is no seams artifacts present. This works perfectly for cubeUV format as\n *\twell where the 6 faces can be arranged in any manner whatsoever.\n * Code in the beginning of fragment shader's main function does this job for a given resolution.\n *\tRun Scene_PMREM_Test.html in the examples directory to see the sampling from the cube lods generated\n *\tby this class.\n */\n\nTHREE.PMREMGenerator = function( sourceTexture, samplesPerLevel, resolution ) {\n\n\tthis.sourceTexture = sourceTexture;\n\tthis.resolution = ( resolution !== undefined ) ? resolution : 256; // NODE: 256 is currently hard coded in the glsl code for performance reasons\n\tthis.samplesPerLevel = ( samplesPerLevel !== undefined ) ? samplesPerLevel : 16;\n\n\tvar monotonicEncoding = ( sourceTexture.encoding === THREE.LinearEncoding ) ||\n\t\t( sourceTexture.encoding === THREE.GammaEncoding ) || ( sourceTexture.encoding === THREE.sRGBEncoding );\n\n\tthis.sourceTexture.minFilter = ( monotonicEncoding ) ? THREE.LinearFilter : THREE.NearestFilter;\n\tthis.sourceTexture.magFilter = ( monotonicEncoding ) ? THREE.LinearFilter : THREE.NearestFilter;\n\tthis.sourceTexture.generateMipmaps = this.sourceTexture.generateMipmaps && monotonicEncoding;\n\n\tthis.cubeLods = [];\n\n\tvar size = this.resolution;\n\tvar params = {\t\tformat: this.sourceTexture.format,\n\t\tmagFilter: this.sourceTexture.magFilter,\n\t\tminFilter: this.sourceTexture.minFilter,\n\t\ttype: this.sourceTexture.type,\n\t\tgenerateMipmaps: this.sourceTexture.generateMipmaps,\n\t\tanisotropy: this.sourceTexture.anisotropy,\n\t\tencoding: this.sourceTexture.encoding\n\t };\n\n\t// how many LODs fit in the given CubeUV Texture.\n\tthis.numLods = Math.log( size ) / Math.log( 2 ) - 2;  // IE11 doesn't support Math.log2\n\n\tfor ( var i = 0; i < this.numLods; i ++ ) {\n\n\t\tvar renderTarget = new THREE.WebGLRenderTargetCube( size, size, params );\n\t\trenderTarget.texture.name = \"PMREMGenerator.cube\" + i;\n\t\tthis.cubeLods.push( renderTarget );\n\t\tsize = Math.max( 16, size / 2 );\n\n\t}\n\n\tthis.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0.0, 1000 );\n\n\tthis.shader = this.getShader();\n\tthis.shader.defines['SAMPLES_PER_LEVEL'] = this.samplesPerLevel;\n\tthis.planeMesh = new THREE.Mesh( new THREE.PlaneGeometry( 2, 2, 0 ), this.shader );\n\tthis.planeMesh.material.side = THREE.DoubleSide;\n\tthis.scene = new THREE.Scene();\n\tthis.scene.add( this.planeMesh );\n\tthis.scene.add( this.camera );\n\n\tthis.shader.uniforms[ 'envMap' ].value = this.sourceTexture;\n\tthis.shader.envMap = this.sourceTexture;\n\n};\n\nTHREE.PMREMGenerator.prototype = {\n\n\tconstructor : THREE.PMREMGenerator,\n\n\t/*\n\t * Prashant Sharma / spidersharma03: More thought and work is needed here.\n\t * Right now it's a kind of a hack to use the previously convolved map to convolve the current one.\n\t * I tried to use the original map to convolve all the lods, but for many textures(specially the high frequency)\n\t * even a high number of samples(1024) dosen't lead to satisfactory results.\n\t * By using the previous convolved maps, a lower number of samples are generally sufficient(right now 32, which\n\t * gives okay results unless we see the reflection very carefully, or zoom in too much), however the math\n\t * goes wrong as the distribution function tries to sample a larger area than what it should be. So I simply scaled\n\t * the roughness by 0.9(totally empirical) to try to visually match the original result.\n\t * The condition \"if(i <5)\" is also an attemt to make the result match the original result.\n\t * This method requires the most amount of thinking I guess. Here is a paper which we could try to implement in future::\n\t * http://http.developer.nvidia.com/GPUGems3/gpugems3_ch20.html\n\t */\n\tupdate: function( renderer ) {\n\n\t\tthis.shader.uniforms[ 'envMap' ].value = this.sourceTexture;\n\t\tthis.shader.envMap = this.sourceTexture;\n\n\t\tvar gammaInput = renderer.gammaInput;\n\t\tvar gammaOutput = renderer.gammaOutput;\n\t\tvar toneMapping = renderer.toneMapping;\n\t\tvar toneMappingExposure = renderer.toneMappingExposure;\n\n\t\trenderer.toneMapping = THREE.LinearToneMapping;\n\t\trenderer.toneMappingExposure = 1.0;\n\t\trenderer.gammaInput = false;\n\t\trenderer.gammaOutput = false;\n\n\t\tfor ( var i = 0; i < this.numLods; i ++ ) {\n\n\t\t\tvar r = i / ( this.numLods - 1 );\n\t\t\tthis.shader.uniforms[ 'roughness' ].value = r * 0.9; // see comment above, pragmatic choice\n\t\t\tthis.shader.uniforms[ 'queryScale' ].value.x = ( i == 0 ) ? -1 : 1;\n\t\t\tvar size = this.cubeLods[ i ].width;\n\t\t\tthis.shader.uniforms[ 'mapSize' ].value = size;\n\t\t\tthis.renderToCubeMapTarget( renderer, this.cubeLods[ i ] );\n\n\t\t\tif ( i < 5 ) this.shader.uniforms[ 'envMap' ].value = this.cubeLods[ i ].texture;\n\n\t\t}\n\n\t\trenderer.toneMapping = toneMapping;\n\t\trenderer.toneMappingExposure = toneMappingExposure;\n\t\trenderer.gammaInput = gammaInput;\n\t\trenderer.gammaOutput = gammaOutput;\n\n\t},\n\n\trenderToCubeMapTarget: function( renderer, renderTarget ) {\n\n\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\tthis.renderToCubeMapTargetFace( renderer, renderTarget, i )\n\n\t\t}\n\n\t},\n\n\trenderToCubeMapTargetFace: function( renderer, renderTarget, faceIndex ) {\n\n\t\trenderTarget.activeCubeFace = faceIndex;\n\t\tthis.shader.uniforms[ 'faceIndex' ].value = faceIndex;\n\t\trenderer.render( this.scene, this.camera, renderTarget, true );\n\n\t},\n\n\tgetShader: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tdefines: {\n\t\t\t\t\"SAMPLES_PER_LEVEL\": 20,\n\t\t\t},\n\n\t\t\tuniforms: {\n\t\t\t\t\"faceIndex\": { value: 0 },\n\t\t\t\t\"roughness\": { value: 0.5 },\n\t\t\t\t\"mapSize\": { value: 0.5 },\n\t\t\t\t\"envMap\": { value: null },\n\t\t\t\t\"queryScale\": { value: new THREE.Vector3( 1, 1, 1 ) },\n\t\t\t\t\"testColor\": { value: new THREE.Vector3( 1, 1, 1 ) },\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\n\\\n\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\tuniform int faceIndex;\\n\\\n\t\t\t\tuniform float roughness;\\n\\\n\t\t\t\tuniform samplerCube envMap;\\n\\\n\t\t\t\tuniform float mapSize;\\n\\\n\t\t\t\tuniform vec3 testColor;\\n\\\n\t\t\t\tuniform vec3 queryScale;\\n\\\n\t\t\t\t\\n\\\n\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\\n\\\n\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\\n\\\n\t\t\t\t\ta *= a;\\n\\\n\t\t\t\t\treturn ( 2.0 / a - 2.0 );\\n\\\n\t\t\t\t}\\n\\\n\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\\n\\\n\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\\n\\\n\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\\n\\\n\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\\n\\\n\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\\n\\\n\t\t\t\t\treturn vecSpace * sampleDir;\\n\\\n\t\t\t\t}\\n\\\n\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\\n\\\n\t\t\t\t{\\n\\\n\t\t\t\t\tfloat a = Roughness * Roughness;\\n\\\n\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\\n\\\n\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\\n\\\n\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\\n\\\n\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\\n\\\n\t\t\t\t}\\n\\\n\t\t\t\tmat3 matrixFromVector(vec3 n) {\\n\\\n\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\\n\\\n\t\t\t\t\tfloat b = -n.x * n.y * a;\\n\\\n\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\\n\\\n\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\\n\\\n\t\t\t\t\treturn mat3(b1, b2, n);\\n\\\n\t\t\t\t}\\n\\\n\t\t\t\t\\n\\\n\t\t\t\tvec4 testColorMap(float Roughness) {\\n\\\n\t\t\t\t\tvec4 color;\\n\\\n\t\t\t\t\tif(faceIndex == 0)\\n\\\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\\n\\\n\t\t\t\t\telse if(faceIndex == 1)\\n\\\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\\n\\\n\t\t\t\t\telse if(faceIndex == 2)\\n\\\n\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\\n\\\n\t\t\t\t\telse if(faceIndex == 3)\\n\\\n\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\\n\\\n\t\t\t\t\telse if(faceIndex == 4)\\n\\\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\\n\\\n\t\t\t\t\telse\\n\\\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\\n\\\n\t\t\t\t\tcolor *= ( 1.0 - Roughness );\\n\\\n\t\t\t\t\treturn color;\\n\\\n\t\t\t\t}\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvec3 sampleDirection;\\n\\\n\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\\n\\\n\t\t\t\t\tfloat offset = -1.0/mapSize;\\n\\\n\t\t\t\t\tconst float a = -1.0;\\n\\\n\t\t\t\t\tconst float b = 1.0;\\n\\\n\t\t\t\t\tfloat c = -1.0 + offset;\\n\\\n\t\t\t\t\tfloat d = 1.0 - offset;\\n\\\n\t\t\t\t\tfloat bminusa = b - a;\\n\\\n\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\\n\\\n\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\\n\\\n\t\t\t\t\tif (faceIndex==0) {\\n\\\n\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\\n\\\n\t\t\t\t\t} else if (faceIndex==1) {\\n\\\n\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\\n\\\n\t\t\t\t\t} else if (faceIndex==2) {\\n\\\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\\n\\\n\t\t\t\t\t} else if (faceIndex==3) {\\n\\\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\\n\\\n\t\t\t\t\t} else if (faceIndex==4) {\\n\\\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\\n\\\n\t\t\t\t\t} else {\\n\\\n\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\\n\\\n\t\t\t\t\t}\\n\\\n\t\t\t\t\tmat3 vecSpace = matrixFromVector(normalize(sampleDirection * queryScale));\\n\\\n\t\t\t\t\tvec3 rgbColor = vec3(0.0);\\n\\\n\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\\n\\\n\t\t\t\t\tvec3 vect;\\n\\\n\t\t\t\t\tfloat weight = 0.0;\\n\\\n\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\\n\\\n\t\t\t\t\t\tfloat sini = sin(float(i));\\n\\\n\t\t\t\t\t\tfloat cosi = cos(float(i));\\n\\\n\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\\n\\\n\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\\n\\\n\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\\n\\\n\t\t\t\t\t\tweight += dotProd;\\n\\\n\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap,vect)).rgb;\\n\\\n\t\t\t\t\t\trgbColor.rgb += color;\\n\\\n\t\t\t\t\t}\\n\\\n\t\t\t\t\trgbColor /= float(NumSamples);\\n\\\n\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\\n\\\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\\n\\\n\t\t\t\t}\",\n\t\t\tblending: THREE.CustomBlending,\n\t\t\tblendSrc: THREE.OneFactor,\n\t\t\tblendDst: THREE.ZeroFactor,\n\t\t\tblendSrcAlpha: THREE.OneFactor,\n\t\t\tblendDstAlpha: THREE.ZeroFactor,\n\t\t\tblendEquation: THREE.AddEquation\n\t\t} );\n\n\t}\n\n};\n\n// File:examples/js/pmrem/PMREMCubeUVPacker.js\n\n/**\n * @author Prashant Sharma / spidersharma03\n * @author Ben Houston / bhouston, https://clara.io\n *\n * This class takes the cube lods(corresponding to different roughness values), and creates a single cubeUV\n * Texture. The format for a given roughness set of faces is simply::\n * +X+Y+Z\n * -X-Y-Z\n * For every roughness a mip map chain is also saved, which is essential to remove the texture artifacts due to\n * minification.\n * Right now for every face a PlaneMesh is drawn, which leads to a lot of geometry draw calls, but can be replaced\n * later by drawing a single buffer and by sending the appropriate faceIndex via vertex attributes.\n * The arrangement of the faces is fixed, as assuming this arrangement, the sampling function has been written.\n */\n\n\nTHREE.PMREMCubeUVPacker = function( cubeTextureLods, numLods ) {\n\n\tthis.cubeLods = cubeTextureLods;\n\tthis.numLods = numLods;\n\tvar size = cubeTextureLods[ 0 ].width * 4;\n\n\tvar sourceTexture = cubeTextureLods[ 0 ].texture;\n\tvar params = {\n\t\tformat: sourceTexture.format,\n\t\tmagFilter: sourceTexture.magFilter,\n\t\tminFilter: sourceTexture.minFilter,\n\t\ttype: sourceTexture.type,\n\t\tgenerateMipmaps: sourceTexture.generateMipmaps,\n\t\tanisotropy: sourceTexture.anisotropy,\n\t\tencoding: sourceTexture.encoding\n\t};\n\n\tif( sourceTexture.encoding === THREE.RGBM16Encoding ) {\n\t\tparams.magFilter = THREE.LinearFilter;\n\t\tparams.minFilter = THREE.LinearFilter;\n\t}\n\n\tthis.CubeUVRenderTarget = new THREE.WebGLRenderTarget( size, size, params );\n\tthis.CubeUVRenderTarget.texture.name = \"PMREMCubeUVPacker.cubeUv\";\n\tthis.CubeUVRenderTarget.texture.mapping = THREE.CubeUVReflectionMapping;\n\tthis.camera = new THREE.OrthographicCamera( - size * 0.5, size * 0.5, - size * 0.5, size * 0.5, 0.0, 1000 );\n\n\tthis.scene = new THREE.Scene();\n\tthis.scene.add( this.camera );\n\n\tthis.objects = [];\n\tvar xOffset = 0;\n\tvar faceOffsets = [];\n\tfaceOffsets.push( new THREE.Vector2( 0, 0 ) );\n\tfaceOffsets.push( new THREE.Vector2( 1, 0 ) );\n\tfaceOffsets.push( new THREE.Vector2( 2, 0 ) );\n\tfaceOffsets.push( new THREE.Vector2( 0, 1 ) );\n\tfaceOffsets.push( new THREE.Vector2( 1, 1 ) );\n\tfaceOffsets.push( new THREE.Vector2( 2, 1 ) );\n\tvar yOffset = 0;\n\tvar textureResolution = size;\n\tsize = cubeTextureLods[ 0 ].width;\n\n\tvar offset2 = 0;\n\tvar c = 4.0;\n\tthis.numLods = Math.log( cubeTextureLods[ 0 ].width ) / Math.log( 2 ) - 2; // IE11 doesn't support Math.log2\n\tfor ( var i = 0; i < this.numLods; i ++ ) {\n\n\t\tvar offset1 = ( textureResolution - textureResolution / c ) * 0.5;\n\t\tif ( size > 16 )\n\t\tc *= 2;\n\t\tvar nMips = size > 16 ? 6 : 1;\n\t\tvar mipOffsetX = 0;\n\t\tvar mipOffsetY = 0;\n\t\tvar mipSize = size;\n\n\t\tfor ( var j = 0; j < nMips; j ++ ) {\n\n\t\t\t// Mip Maps\n\t\t\tfor ( var k = 0; k < 6; k ++ ) {\n\n\t\t\t\t// 6 Cube Faces\n\t\t\t\tvar material = this.getShader();\n\t\t\t\tmaterial.uniforms[ 'envMap' ].value = this.cubeLods[ i ].texture;\n\t\t\t\tmaterial.envMap = this.cubeLods[ i ].texture;\n\t\t\t\tmaterial.uniforms[ 'faceIndex' ].value = k;\n\t\t\t\tmaterial.uniforms[ 'mapSize' ].value = mipSize;\n\t\t\t\tvar color = material.uniforms[ 'testColor' ].value;\n\t\t\t\t//color.copy(testColor[j]);\n\t\t\t\tvar planeMesh = new THREE.Mesh(\n\t\t\t\tnew THREE.PlaneGeometry( mipSize, mipSize, 0 ),\n\t\t\t\tmaterial );\n\t\t\t\tplaneMesh.position.x = faceOffsets[ k ].x * mipSize - offset1 + mipOffsetX;\n\t\t\t\tplaneMesh.position.y = faceOffsets[ k ].y * mipSize - offset1 + offset2 + mipOffsetY;\n\t\t\t\tplaneMesh.material.side = THREE.DoubleSide;\n\t\t\t\tthis.scene.add( planeMesh );\n\t\t\t\tthis.objects.push( planeMesh );\n\n\t\t\t}\n\t\t\tmipOffsetY += 1.75 * mipSize;\n\t\t\tmipOffsetX += 1.25 * mipSize;\n\t\t\tmipSize /= 2;\n\n\t\t}\n\t\toffset2 += 2 * size;\n\t\tif ( size > 16 )\n\t\tsize /= 2;\n\n\t}\n\n};\n\nTHREE.PMREMCubeUVPacker.prototype = {\n\n\tconstructor : THREE.PMREMCubeUVPacker,\n\n\tupdate: function( renderer ) {\n\n\t\tvar gammaInput = renderer.gammaInput;\n\t\tvar gammaOutput = renderer.gammaOutput;\n\t\tvar toneMapping = renderer.toneMapping;\n\t\tvar toneMappingExposure = renderer.toneMappingExposure;\n\t\trenderer.gammaInput = false;\n\t\trenderer.gammaOutput = false;\n\t\trenderer.toneMapping = THREE.LinearToneMapping;\n\t\trenderer.toneMappingExposure = 1.0;\n\t\trenderer.render( this.scene, this.camera, this.CubeUVRenderTarget, false );\n\n\t\trenderer.toneMapping = toneMapping;\n\t\trenderer.toneMappingExposure = toneMappingExposure;\n\t\trenderer.gammaInput = gammaInput;\n\t\trenderer.gammaOutput = gammaOutput;\n\n\t},\n\n\tgetShader: function() {\n\n\t\tvar shaderMaterial = new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"faceIndex\": { value: 0 },\n\t\t\t\t\"mapSize\": { value: 0 },\n\t\t\t\t\"envMap\": { value: null },\n\t\t\t\t\"testColor\": { value: new THREE.Vector3( 1, 1, 1 ) }\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"precision highp float;\\\n\t\t\t\tvarying vec2 vUv;\\\n\t\t\t\tvoid main() {\\\n\t\t\t\t\tvUv = uv;\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"precision highp float;\\\n\t\t\t\tvarying vec2 vUv;\\\n\t\t\t\tuniform samplerCube envMap;\\\n\t\t\t\tuniform float mapSize;\\\n\t\t\t\tuniform vec3 testColor;\\\n\t\t\t\tuniform int faceIndex;\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\\n\t\t\t\t\tvec3 sampleDirection;\\\n\t\t\t\t\tvec2 uv = vUv;\\\n\t\t\t\t\tuv = uv * 2.0 - 1.0;\\\n\t\t\t\t\tuv.y *= -1.0;\\\n\t\t\t\t\tif(faceIndex == 0) {\\\n\t\t\t\t\t\tsampleDirection = normalize(vec3(1.0, uv.y, -uv.x));\\\n\t\t\t\t\t} else if(faceIndex == 1) {\\\n\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, 1.0, uv.y));\\\n\t\t\t\t\t} else if(faceIndex == 2) {\\\n\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, uv.y, 1.0));\\\n\t\t\t\t\t} else if(faceIndex == 3) {\\\n\t\t\t\t\t\tsampleDirection = normalize(vec3(-1.0, uv.y, uv.x));\\\n\t\t\t\t\t} else if(faceIndex == 4) {\\\n\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));\\\n\t\t\t\t\t} else {\\\n\t\t\t\t\t\tsampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));\\\n\t\t\t\t\t}\\\n\t\t\t\t\tvec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );\\\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( color );\\\n\t\t\t\t}\",\n\n\t\t\tblending: THREE.CustomBlending,\n\t\t\tpremultipliedAlpha: false,\n\t\t\tblendSrc: THREE.OneFactor,\n\t\t\tblendDst: THREE.ZeroFactor,\n\t\t\tblendSrcAlpha: THREE.OneFactor,\n\t\t\tblendDstAlpha: THREE.ZeroFactor,\n\t\t\tblendEquation: THREE.AddEquation\n\n\t\t} );\n\n\t\treturn shaderMaterial;\n\n\t}\n\n};\n\n// File:examples/js/shaders/CopyShader.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Full-screen textured quad shader\n */\n\nTHREE.CopyShader = {\n\n\tuniforms: {\n\n\t\t\"tDiffuse\": { value: null },\n\t\t\"opacity\":  { value: 1.0 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform float opacity;\",\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec4 texel = texture2D( tDiffuse, vUv );\",\n\t\t\t\"gl_FragColor = opacity * texel;\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\n// File:examples/js/shaders/CompositeShader.js\n\n/**\n * @author bhouston / http://clara.io\n *\n * Various composite operations\n */\n\nTHREE.CompositeShader = {\n\n  defines: {\n\n\t\t\"BLENDING\": THREE.NoBlending\n\n  },\n\n\tuniforms: {\n\n    \"tSource\": { type: \"t\", value: null },\n    \"opacitySource\": { type: \"f\", value: 1.0 },\n\n\t\t\"tDestination\": { type: \"t\", value: null },\n    \"opacityDestination\": { type: \"f\", value: 1.0 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n    \"uniform sampler2D tSource;\",\n    \"uniform float opacitySource;\",\n\n\t\t\"uniform sampler2D tDestination;\",\n    \"uniform float opacityDestination;\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec4 d = opacityDestination * texture2D( tDestination, vUv );\",\n\t\t\t\"vec4 s = opacitySource * texture2D( tSource, vUv );\",\n\n      // all blending modes are implemented assuming premultiplied values\n\n      \"#if (BLENDING == \" + THREE.NormalBlending + \")\",\n\n        \"gl_FragColor = d * ( 1.0 - s.a ) + s;\",\n\n      \"#elif (BLENDING == \" + THREE.AdditiveBlending + \")\",\n\n        \"gl_FragColor = d + s;\",\n\n      \"#elif (BLENDING == \" + THREE.SubtractiveBlending + \")\",\n\n        \"gl_FragColor = d - s;\",\n\n      \"#elif (BLENDING == \" + THREE.MultiplyBlending + \")\",\n\n        \"gl_FragColor = d * s;\",\n\n      \"#else\", // THREE.NoBlending\n\n        \"gl_FragColor = s;\",\n\n      \"#endif\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\n// File:examples/js/shaders/GlossyMirrorShader.js\n\nTHREE.GlossyMirrorShader = {\n\n\tdefines: {\n\t\t\"SPECULAR_MAP\": 0,\n\t\t\"ROUGHNESS_MAP\": 0,\n\t\t\"GLOSSY_REFLECTIONS\": 1,\n\t\t\"REFLECTION_LOD_LEVELS\": 4,\n\t\t\"PERSPECTIVE_CAMERA\": 1\n\t},\n\n\tuniforms: {\n\n\t \t\"metalness\": { type: \"f\", value: 0.0 },\n\n\t \t\"specularColor\": { type: \"c\", value: new THREE.Color( 0xffffff ) },\n\t\t\"tSpecular\": { type: \"t\", value: null },\n\n\t\t\"tReflection\": { type: \"t\", value: null },\n\t\t\"tReflection1\": { type: \"t\", value: null },\n\t\t\"tReflection2\": { type: \"t\", value: null },\n\t\t\"tReflection3\": { type: \"t\", value: null },\n\t\t\"tReflection4\": { type: \"t\", value: null },\n\t\t\"tReflectionDepth\": { type: \"t\", value: null },\n\n\t\t\"roughness\": { type: \"f\", value: 0.0 },\n\t \t\"distanceFade\": { type: \"f\", value: 0.01 },\n\t \t\"fresnelStrength\": { type: \"f\", value: 1.0 },\n\n\t\t\"reflectionTextureMatrix\" : { type: \"m4\", value: new THREE.Matrix4() },\n\t\t\"mirrorCameraWorldMatrix\": { type: \"m4\", value: new THREE.Matrix4() },\n\t\t\"mirrorCameraProjectionMatrix\": { type: \"m4\", value: new THREE.Matrix4() },\n\t\t\"mirrorCameraInverseProjectionMatrix\": { type: \"m4\", value: new THREE.Matrix4() },\n\t\t\"mirrorCameraNear\": { type: \"f\", value: 0 },\n\t\t\"mirrorCameraFar\": { type: \"f\", value: 0 },\n\t\t\"screenSize\": { type: \"v2\", value: new THREE.Vector2() },\n\t\t\"mirrorNormal\": { type: \"v3\", value: new THREE.Vector3() },\n\t\t\"mirrorWorldPosition\": { type: \"v3\", value: new THREE.Vector3() }\n\t},\n\n\tvertexShader: [\n\n\t\t\"uniform mat4 reflectionTextureMatrix;\",\n\n\t\t\"varying vec4 mirrorCoord;\",\n\t\t\"varying vec3 vecPosition;\",\n\t\t\"varying vec3 worldNormal;\",\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\t\t\t\"vUv = uv;\",\n\t\t\t\"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\n\t\t\t\"vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\",\n\t\t\t\"vecPosition = cameraPosition - worldPosition.xyz;\",\n\t\t\t\"worldNormal = (modelMatrix * vec4(normal,0.0)).xyz;\",\n\t\t\t\"mirrorCoord = reflectionTextureMatrix * worldPosition;\",\n\n\t\t\t\"gl_Position = projectionMatrix * mvPosition;\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tblending: THREE.NormalBlending,\n\ttransparent: true,\n\n\tfragmentShader: [\n\n\t\t\"#include <common>\",\n\t\t\"#include <packing>\",\n\t\t\"#include <bsdfs>\",\n\n\t\t\"uniform float roughness;\",\n\t\t\"#if ROUGHNESS_MAP == 1\",\n\t\t\t\"uniform sampler2D tRoughness;\",\n\t\t\"#endif\",\n\n\t\t\"uniform float metalness;\",\n\t\t\"uniform float distanceFade;\",\n\t\t\"uniform float fresnelStrength;\",\n\n\t\t\"uniform vec3 specularColor;\",\n\t\t\"#if SPECULAR_MAP == 1\",\n\t\t\t\"uniform sampler2D tSpecular;\",\n\t\t\"#endif\",\n\n\t\t\"uniform sampler2D tReflection;\",\n\t\t\"#if GLOSSY_REFLECTIONS == 1\",\n\t\t\t\"uniform sampler2D tReflection1;\",\n\t\t\t\"uniform sampler2D tReflection2;\",\n\t\t\t\"uniform sampler2D tReflection3;\",\n\t\t\t\"uniform sampler2D tReflection4;\",\n\t\t\t\"uniform sampler2D tReflectionDepth;\",\n\t\t\"#endif\",\n\n\t\t\"varying vec3 vecPosition;\",\n\t\t\"varying vec3 worldNormal;\",\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"varying vec4 mirrorCoord;\",\n\t\t\"uniform mat4 mirrorCameraProjectionMatrix;\",\n \t\t\"uniform mat4 mirrorCameraInverseProjectionMatrix;\",\n\t\t\"uniform mat4 mirrorCameraWorldMatrix;\",\n\t\t\"uniform float mirrorCameraNear;\",\n\t\t\"uniform float mirrorCameraFar;\",\n\t\t\"uniform vec2 screenSize;\",\n\t\t\"uniform vec3 mirrorNormal;\",\n\t\t\"uniform vec3 mirrorWorldPosition;\",\n\n\t\t\"#if GLOSSY_REFLECTIONS == 1\",\n\n\t\t\t\"float getReflectionDepth() {\",\n\n\t\t\t\t\"return unpackRGBAToDepth( texture2DProj( tReflectionDepth, mirrorCoord ) );\",\n\n\t \t\t\"}\",\n\n\t\t\t\"float getReflectionViewZ( const in float reflectionDepth ) {\",\n\t\t\t\t\"#if PERSPECTIVE_CAMERA == 1\",\n\t \t\t\t\t\"return perspectiveDepthToViewZ( reflectionDepth, mirrorCameraNear, mirrorCameraFar );\",\n\t\t\t\t\"#else\",\n\t\t\t\t\t\"return orthographicDepthToViewZ( reflectionDepth, mirrorCameraNear, mirrorCameraFar );\",\n\t\t\t\t\"#endif\",\n\t \t\t\"}\",\n\n\t \t\t\"vec3 getReflectionViewPosition( const in vec2 screenPosition, const in float reflectionDepth, const in float reflectionViewZ ) {\",\n\n\t \t\t\t\"float clipW = mirrorCameraProjectionMatrix[2][3] * reflectionViewZ + mirrorCameraProjectionMatrix[3][3];\",\n\t \t\t\t\"vec4 clipPosition = vec4( ( vec3( screenPosition, reflectionDepth ) - 0.5 ) * 2.0, 1.0 );\",\n\t \t\t\t\"clipPosition *= clipW;\", // unprojection.\n\t\t\t\t\"return ( mirrorCameraInverseProjectionMatrix * clipPosition ).xyz;\",\n\n\t \t\t\"}\",\n\n\t\t\"#endif\",\n\n\t\t\"vec4 getReflection( const in vec4 mirrorCoord, const in float lodLevel ) {\",\n\n\t\t\t\"#if GLOSSY_REFLECTIONS == 0\",\n\n\t\t\t\t\"return texture2DProj( tReflection, mirrorCoord );\",\n\n\t\t\t\"#else\",\n\n\t\t\t\t\"vec4 color0, color1;\",\n\t\t\t\t\"float alpha;\",\n\n\t\t\t\t\"if( lodLevel < 1.0 ) {\",\n\t\t\t\t\t\"color0 = texture2DProj( tReflection, mirrorCoord );\",\n\t\t\t\t\t\"color1 = texture2DProj( tReflection1, mirrorCoord );\",\n\t\t\t\t\t\"alpha = lodLevel;\",\n\t\t\t\t\"}\",\n\t\t\t\t\"else if( lodLevel < 2.0) {\",\n\t\t\t\t\t\"color0 = texture2DProj( tReflection1, mirrorCoord );\",\n\t\t\t\t\t\"color1 = texture2DProj( tReflection2, mirrorCoord );\",\n\t\t\t\t\t\"alpha = lodLevel - 1.0;\",\n\t\t\t\t\"}\",\n\t\t\t\t\"else if( lodLevel < 3.0 ) {\",\n\t\t\t\t\t\"color0 = texture2DProj( tReflection2, mirrorCoord );\",\n\t\t\t\t\t\"color1 = texture2DProj( tReflection3, mirrorCoord );\",\n\t\t\t\t\t\"alpha = lodLevel - 2.0;\",\n\t\t\t\t\"}\",\n\t\t\t\t\"else {\",\n\t\t\t\t\t\"color0 = texture2DProj( tReflection3, mirrorCoord );\",\n\t\t\t\t\t\"color1 = color0;\",\n\t\t\t\t\t\"alpha = 0.0;\",\n\t\t\t\t\"}\",\n\n\t\t\t\t\"return mix( color0, color1, alpha );\",\n\n\t\t\t\"#endif\",\n\n\t\t\"}\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec3 specular = specularColor;\",\n\t\t\t\"#if SPECULAR_MAP == 1\",\n\t\t\t\t\"specular *= texture2D( tSpecular, vUv );\",\n\t\t\t\"#endif\",\n\n\t\t\t\"float fade = 1.0;\",\n\n\t\t\t\"#if GLOSSY_REFLECTIONS == 1\",\n\n\t\t\t\t\"float localRoughness = roughness;\",\n\t\t\t\t\"#if ROUGHNESS_MAP == 1\",\n\t\t\t\t\t\"localRoughness *= texture2D( tRoughness, vUv ).r;\",\n\t\t\t\t\"#endif\",\n\n\t\t\t\t\"vec2 screenPosition = gl_FragCoord.xy / screenSize;\",\n\t\t\t\t\"float reflectionDepth = getReflectionDepth();\",\n\t\t\t\t\"float reflectionViewZ = getReflectionViewZ( reflectionDepth );\",\n\n\t\t\t\t\"vec3 reflectionViewPosition = getReflectionViewPosition( screenPosition, reflectionDepth, reflectionViewZ );\",\t\t\t\n\t\t\t\t\"vec3 reflectionWorldPosition = ( mirrorCameraWorldMatrix * vec4( reflectionViewPosition, 1.0 ) ).xyz;\",\n\n\t\t\t\t\"vec3 closestPointOnMirror = projectOnPlane( reflectionWorldPosition, mirrorWorldPosition, mirrorNormal );\",\n\n\t\t\t\t\"vec3 pointOnMirror = linePlaneIntersect( cameraPosition, normalize( reflectionWorldPosition - cameraPosition ), mirrorWorldPosition, mirrorNormal );\",\n\t\t\t\t\"float distance = length( closestPointOnMirror - reflectionWorldPosition );\",\n\t\t\t\n\t\t\t\t\"localRoughness = localRoughness * distance * 0.2;\",\n\t\t\t\t\"float lodLevel = localRoughness;\",\n\n\t\t\t\t\"fade = 1.0 - smoothstep( 0.0, 1.0, distanceFade * distance * 0.2 );\",\n\t\t\t\"#else\",\n\n\t\t\t\t\"float lodLevel = 0.0;\",\n\n\t\t\t\"#endif\",\n\n\t\t\t\"vec4 reflection = getReflection( mirrorCoord, lodLevel );\",\n\n\t\t\t// apply dieletric-conductor model parameterized by metalness parameter.\n\t\t\t\"float dotNV = clamp( dot( normalize( worldNormal ), normalize( vecPosition ) ), EPSILON, 1.0 );\",\n\t\t\t\"specular = mix( vec3( 0.05 ), specular, metalness );\",\n\t\t\t// TODO: Invert fresnel.\n\t\t\t\"vec3 fresnel;\",\n\t\t\t\"if( fresnelStrength < 0.0 ) {\",\n\t\t\t\t\"fresnel = mix( specular, specular * pow( dotNV, 2.0 ), -fresnelStrength ) * pow( 1.0 - roughness, 2.0 );\",\n\t\t\t\"} else {\",\n\t\t\t\t\"fresnel = mix( specular, F_Schlick( specular, dotNV ), fresnelStrength ) * pow( 1.0 - roughness, 2.0 );\",\n\t\t\t\"}\",\n\t\t\t\"gl_FragColor = vec4( reflection.rgb, fresnel * fade * reflection.a );\", // fresnel controls alpha\n\n\n\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n};\n\n// File:examples/js/shaders/SAOShader.js\n\n/**\n * @author bhouston / http://clara.io/\n *\n * Scalable Ambient Occlusion\n *\n */\n\nTHREE.ShaderChunk['sao'] = [\n\n\"#include <packing>\",\n\n\"float getDepth( const in vec2 screenPosition ) {\",\n\n\t\"#if DEPTH_PACKING == 1\",\n\t\t\"return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\",\n\t\"#else\",\n\t\t\"return texture2D( tDepth, screenPosition ).x;\",\n\t\"#endif\",\n\n\"}\",\n\n\"vec4 setDepth( const in float depth ) {\",\n\n\t\"#if DEPTH_PACKING == 1\",\n\t\t\"return packDepthToRGBA( depth );\",\n\t\"#else\",\n\t\t\"return vec4( depth, 0, 0, 0 );\",\n\t\"#endif\",\n\n\"}\",\n\n\"float getViewZ( const in float depth ) {\",\n\n\t\"#if PERSPECTIVE_CAMERA == 1\",\n\t\t\"return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\",\n\t\"#else\",\n\t\t\"return orthographicDepthToViewZ( depth, cameraNear, cameraFar );\",\n\t\"#endif\",\n\n\"}\"\n\n].join( \"\\n\" );\n\nTHREE.SAOShader = {\n\n\tblending: THREE.NoBlending,\n\n\tdefines: {\n\t\t'NUM_SAMPLES': 13,\n\t\t'NUM_RINGS': 7,\n\t\t\"NORMAL_TEXTURE\": 0,\n\t\t\"DIFFUSE_TEXTURE\": 1,\n\t\t\"DEPTH_PACKING\": 1,\n\t\t\"DEPTH_MIPS\": 0,\n\t\t\"PERSPECTIVE_CAMERA\": 1\n\t},\n\n\textensions: {\n\t\t'derivatives': true\n\t},\n\n\tuniforms: {\n\n\t\t\"tDepth\":       { type: \"t\", value: null },\n\t\t\"tDepth1\":       { type: \"t\", value: null },\n\t\t\"tDepth2\":       { type: \"t\", value: null },\n\t\t\"tDepth3\":       { type: \"t\", value: null },\n\n\t\t\"tDiffuse\":     { type: \"t\", value: null },\n\t\t\"tNormal\":      { type: \"t\", value: null },\n\t\t\"size\":         { type: \"v2\", value: new THREE.Vector2( 512, 512 ) },\n\n\t\t\"cameraNear\":   { type: \"f\", value: 1 },\n\t\t\"cameraFar\":    { type: \"f\", value: 100 },\n\t\t\"cameraProjectionMatrix\": { type: \"m4\", value: new THREE.Matrix4() },\n\t\t\"cameraInverseProjectionMatrix\": { type: \"m4\", value: new THREE.Matrix4() },\n\n\t\t\"intensity\":    { type: \"f\", value: 0.1 },\n\n\t\t\"occlusionSphereWorldRadius\": { type: \"f\", value: 100.0 },\n\t\t\"worldToScreenRatio\": { type: \"v2\", value: new THREE.Vector2( 1, 1 ) },\n\t\t\"randomSeed\":   { type: \"f\", value: 0.0 }\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\n\t\t\"#include <common>\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"#if DIFFUSE_TEXTURE == 1\",\n\t\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\"#endif\",\n\n\t\t\"#define MAX_MIP_LEVEL 3\",\n\n\t\t\"uniform sampler2D tDepth;\",\n\n\t\t\"#if DEPTH_MIPS == 1\",\n\t\t\t\"uniform sampler2D tDepth1;\",\n\t\t\t\"uniform sampler2D tDepth2;\",\n\t\t\t\"uniform sampler2D tDepth3;\",\n\t\t\"#endif\",\n\n\t\t\"#if NORMAL_TEXTURE == 1\",\n\t\t\t\"uniform sampler2D tNormal;\",\n\t\t\"#endif\",\n\n\t\t\"uniform float cameraNear;\",\n\t\t\"uniform float cameraFar;\",\n\t\t\"uniform mat4 cameraProjectionMatrix;\",\n\t\t\"uniform mat4 cameraInverseProjectionMatrix;\",\n\n\t\t\"uniform float intensity;\",\n\t\t\"uniform float occlusionSphereWorldRadius;\",\n\t\t\"uniform vec2 size;\",\n\t\t\"uniform vec2 worldToScreenRatio;\",\n\t\t\"uniform float randomSeed;\",\n\n\n\t\t\"#include <sao>\",\n\n\t\t\"vec4 getDefaultColor( const in vec2 screenPosition ) {\",\n\n\t\t\t\"#if DIFFUSE_TEXTURE == 1\",\n\t\t\t\t\"return texture2D( tDiffuse, vUv );\",\n\t\t\t\"#else\",\n\t\t\t\t\"return vec4( 1.0 );\",\n\t\t\t\"#endif\",\n\n\t\t\"}\",\n\n\t\t\"vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {\",\n\n\t\t\t\"float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\",\n\t\t\t\"vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );\",\n\t\t\t\"clipPosition *= clipW;\", // unprojection.\n\t\t\t\"return ( cameraInverseProjectionMatrix * clipPosition ).xyz;\",\n\n\t\t\"}\",\n\n\t\t\"vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {\",\n\n\t\t\t\"#if NORMAL_TEXTURE == 1\",\n\t\t\t\t\"return -unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );\",\n\t\t\t\"#else\",\n\t\t\t\t\"return normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );\",\n\t\t\t\"#endif\",\n\n\t\t\"}\",\n\n\t\t\"float getDepthMIP( const in vec2 screenPosition, const int mipLevel ) {\",\n\n\t\t\t\"vec4 rawDepth;\",\n\t\t\t\"#if DEPTH_MIPS == 0\",\n\t\t\t\t\"rawDepth = texture2D( tDepth, screenPosition );\",\n\t\t\t\"#else\",\n\t\t\t\t\"if( mipLevel == 0 ) {\",\n\t\t\t\t\t\"rawDepth = texture2D( tDepth, screenPosition );\",\n\t\t\t\t\"}\",\n\t\t\t\t\"else if( mipLevel == 1 ) {\",\n\t\t\t\t\t\"rawDepth = texture2D( tDepth1, screenPosition );\",\n\t\t\t\t\"}\",\n\t\t\t\t\"else if( mipLevel == 2 ) {\",\n\t\t\t\t\t\"rawDepth = texture2D( tDepth2, screenPosition );\",\n\t\t\t\t\"}\",\n\t\t\t\t\"else {\",\n\t\t\t\t\t\"rawDepth = texture2D( tDepth3, screenPosition );\",\n\t\t\t\t\"}\",\n\t\t\t\"#endif\",\n\n\t\t\t\"#if DEPTH_PACKING == 1\",\n\t\t\t\t\"return unpackRGBAToDepth( rawDepth );\",\n\t\t\t\"#else\",\n\t\t\t\t\"return rawDepth.x;\",\n\t\t\t\"#endif\",\n\n\t\t\"}\",\n\n\t\t\"float scaleDividedByCameraFar;\",\n\t\t\"float minResolutionMultipliedByCameraFar;\",\n\t\t\"float errorCorrectionFactor;\",\n\n\t\t\"float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {\",\n\n\t\t\t\"vec3 viewDelta = sampleViewPosition - centerViewPosition;\",\n\t\t\t\"float viewDistance2 = dot( viewDelta, viewDelta );\",\n\n\t\t\t\"return max( ( dot( centerViewNormal, viewDelta ) + centerViewPosition.z * 0.001 ) / ( viewDistance2 + 0.0001 ), 0.0 );// * smoothstep( pow2( occlusionSphereWorldRadius ), 0.0, viewDistance2 );\",\n\n\t\t\"}\",\n\n\t\t/*\n\t\t\"float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {\",\n\n\t\t\t\"vec3 viewDelta = sampleViewPosition - centerViewPosition;\",\n\t\t\t\"float viewDistance2 = dot( viewDelta, viewDelta );\",\n\n\t\t\t\"return max( pow3( pow2( occlusionSphereWorldRadius ) - viewDistance2 ), 0.0 ) *\",\n\t\t\t\t\"max( ( dot( centerViewNormal, viewDelta ) - 0.01 * occlusionSphereWorldRadius ) / ( viewDistance2 + 0.0001 ), 0.0 );\",\n\n\t\t\"}\",*/\n\n\t\t//\"const float maximumScreenRadius = 10.0;\",\n\n\t\t\"int getMipLevel( const in vec2 occlusionSphereScreenRadius ) {\",\n    \t\t\"return int( clamp( floor( log2( length( occlusionSphereScreenRadius * size ) ) - 4.0 ), 0.0, 3.0 ) );\",\n\t\t\"}\",\n\n\t\t// moving costly divides into consts\n\t\t\"const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );\",\n\t\t\"const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );\",\n\n\t\t\"float getAmbientOcclusion( const in vec3 centerViewPosition ) {\",\n\n\t\t\t// precompute some variables require in getOcclusion.\n\t\t\t\"vec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );\",\n\n\t\t\t\"vec2 invSize = 1.0 / size;\",\n\n\t\t\t\"vec2 occlusionSphereScreenRadius = occlusionSphereWorldRadius * worldToScreenRatio / centerViewPosition.z;\",\n\n\t\t\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/\n\t\t\t\"float random = rand( vUv + randomSeed );\",\n\t\t\t\"float angle = random * PI2;\",\n\t\t\t\"float radiusStep = INV_NUM_SAMPLES;\",\n\t\t\t\"float radius = radiusStep * ( 0.5 + random );\",\n\n\t\t\t\"float occlusionSum = 0.0;\",\n\n\t\t\t\"for( int i = 0; i < NUM_SAMPLES; i ++ ) {\",\n\t\t\t\t\"radius = (float(i) + 0.5) * radiusStep;\",\n\t\t\t\t\"vec2 sampleUvOffset = vec2( cos( angle ), sin( angle ) ) * radius * occlusionSphereScreenRadius * 1.0;\",\n\n\t\t\t\t// round to nearest true sample to avoid misalignments between viewZ and normals, etc.\n\t\t\t\t\"sampleUvOffset = floor( sampleUvOffset * size + vec2( 0.5 ) ) * invSize;\",\n\t\t\t\t\"if( sampleUvOffset.x == 0.0 && sampleUvOffset.y == 0.0 ) continue;\",\n\n\t\t\t\t\"angle += ANGLE_STEP;\",\n\n\t\t\t\t\"vec2 sampleUv = vUv + sampleUvOffset;\",\n\n\t\t\t\t\"if( sampleUv.x <= 0.0 || sampleUv.y <= 0.0 || sampleUv.x >= 1.0 || sampleUv.y >= 1.0 ) continue;\", // skip points outside of texture.\n\n\t\t\t\t//\"int depthMipLevel = getMipLevel( radius * occlusionSphereScreenRadius );\",\n\t\t\t\t\"float sampleDepth = getDepthMIP( sampleUv, int( 4.0 * radius ) );\",\n\t\t\t\t\"if( sampleDepth >= ( 1.0 - EPSILON ) ) {\",\n\t\t\t\t\t\"continue;\",\n\t\t\t\t\"}\",\n\n\t\t\t\t\"float sampleViewZ = getViewZ( sampleDepth );\",\n\t\t\t\t\"vec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );\",\n\t\t\t\t\"occlusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );\",\n\n\t\t\t\"}\",\n\n\t\t\t\"return occlusionSum * intensity * 2.0 * occlusionSphereWorldRadius / ( float( NUM_SAMPLES ) );\",\n\t\t\t//\"return occlusionSum * intensity * 5.0 / ( float( NUM_SAMPLES ) * pow( occlusionSphereWorldRadius, 6.0 ) );\",\n\n\t\t\"}\",\n\n\n\t\t\"void main() {\",\n\n\t\t\t\"float centerDepth = getDepth( vUv );\",\n\t\t\t\"if( centerDepth >= ( 1.0 - EPSILON ) ) {\",\n\t\t\t\t\"discard;\",\n\t\t\t\"}\",\n\n\t\t/*\t\"float mipDepth = unpackRGBAToDepth( texture2D( tDepth3, vUv ) );\",\n\t\t\t\"gl_FragColor.xyz = vec3( (centerDepth - mipDepth) * 50.0 + 0.5 );\",\n\t\t\t\"gl_FragColor.a = 1.0;\",\n\t\t\t\"return;\",*/\n\n\t\t\t\"float centerViewZ = getViewZ( centerDepth );\",\n\t\t\t\"vec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );\",\n\n\t\t\t\"float ambientOcclusion = getAmbientOcclusion( viewPosition );\",\n\n\t\t\t//\"gl_FragColor = getDefaultColor( vUv );\",\n\n\t\t\t\"gl_FragColor = packDepthToRGBA( centerDepth );\",\n\t\t\t\"gl_FragColor.x = max( 1.0 - ambientOcclusion, 0.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\n// source: http://g3d.cs.williams.edu/websvn/filedetails.php?repname=g3d&path=%2FG3D10%2Fdata-files%2Fshader%2FAmbientOcclusion%2FAmbientOcclusion_minify.pix\nTHREE.SAODepthMinifyShader = {\n\n\tblending: THREE.NoBlending,\n\n\tdefines: {\n\t\t\"DEPTH_PACKING\": 1,\n\t//\t\"JITTERED_SAMPLING\": 1\n\t},\n\n\tuniforms: {\n\n\t\t\"tDepth\":\t{ type: \"t\", value: null },\n\t\t\"cameraNear\":   { type: \"f\", value: 1 },\n\t\t\"cameraFar\":    { type: \"f\", value: 100 },\n\t\t\"size\": { type: \"v2\", value: new THREE.Vector2( 256, 256 ) },\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\n\t\t\"#include <common>\",\n\t\t\"#include <packing>\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"uniform sampler2D tDepth;\",\n\t\t\"uniform vec2 size;\",\n\t\t\"uniform float cameraNear;\",\n\t\t\"uniform float cameraFar;\",\n\n\t\t\"void main() {\",\n\n/*\t\tg3d_FragColor.mask = texelFetch(\n\t\t\tCSZ_buffer,\n\t\t\tclamp(\n\t\t\t\tssP * 2 + ivec2(ssP.y & 1, ssP.x & 1),\n\t\t\t\tivec2(0),\n\t\t\t\ttextureSize(CSZ_buffer, previousMIPNumber) - ivec2(1)),\n\t\t\tpreviousMIPNumber).mask;\n\n\t }*/\n\n\t \t\t\"vec2 uv = vUv;\",\n\n\t\t//\t\"uv += ( round( vec2( rand( vUv * size ), rand( vUv * size + vec2( 0.333, 2.0 ) ) ) ) - 0.5 ) / size;\",\n\t\t\t\"vec2 invSize = 0.5 / size;\",\n\n\t\t\t// NOTE: no need for depth decoding if nearest interpolation is used.\n\t\t/*\t\"float viewZ = 1.0 / perspectiveDepthToViewZ( unpackRGBAToDepth( texture2D( tDepth, vUv + invSize * vec2( -1.0, -1.0 ) ) ), cameraNear, cameraFar );\",\n\t\t\t\"viewZ += 1.0 / perspectiveDepthToViewZ( unpackRGBAToDepth( texture2D( tDepth, vUv + invSize * vec2( 1.0, 1.0 ) ) ), cameraNear, cameraFar );\",\n\t\t\t\"viewZ += 1.0 / perspectiveDepthToViewZ( unpackRGBAToDepth( texture2D( tDepth, vUv + invSize * vec2( -1.0, 1.0 ) ) ), cameraNear, cameraFar );\",\n\t\t\t\"viewZ += 1.0 / perspectiveDepthToViewZ( unpackRGBAToDepth( texture2D( tDepth, vUv + invSize * vec2( 1.0, -1.0 ) ) ), cameraNear, cameraFar );\",\n\t\t\t\"viewZ *= 0.25;\",\n\t\t\t\"gl_FragColor = packDepthToRGBA( viewZToPerspectiveDepth( 1.0 / viewZ, cameraNear, cameraFar ) );\",*/\n\t\t\t\"float depth = unpackRGBAToDepth( texture2D( tDepth, vUv + invSize * vec2( -1.0, -1.0 ) ) );\",\n\t\t\t\"depth += unpackRGBAToDepth( texture2D( tDepth, vUv + invSize * vec2( 1.0, 1.0 ) ) );\",\n\t\t\t\"depth += unpackRGBAToDepth( texture2D( tDepth, vUv + invSize * vec2( -1.0, 1.0 ) ) );\",\n\t\t\t\"depth += unpackRGBAToDepth( texture2D( tDepth, vUv + invSize * vec2( 1.0, -1.0 ) ) );\",\n\t\t\t\"depth *= 0.25;\",\n\t\t\t\"gl_FragColor = packDepthToRGBA( depth );\",\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\nTHREE.SAOBilaterialFilterShader = {\n\n\tblending: THREE.NoBlending,\n\n\tdefines: {\n\t\t\"PERSPECTIVE_CAMERA\": 1,\n\t\t\"KERNEL_SAMPLE_RADIUS\": 4,\n\t},\n\n\tuniforms: {\n\n\t\t\"tAODepth\":\t{ type: \"t\", value: null },\n\t\t\"tAONormal\":\t{ type: \"t\", value: null },\n\t\t\"size\": { type: \"v2\", value: new THREE.Vector2( 256, 256 ) },\n\n\t\t\"kernelDirection\": { type: \"v2\", value: new THREE.Vector2( 1, 0 ) },\n\n\t\t\"cameraNear\":   { type: \"f\", value: 1 },\n\t\t\"cameraFar\":    { type: \"f\", value: 100 },\n\t\t\"edgeSharpness\":    { type: \"f\", value: 3 },\n\t\t\"packOutput\":    { type: \"f\", value: 1 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"#include <common>\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"uniform sampler2D tAODepth;\",\n\t\t\"uniform sampler2D tAONormal;\",\n\t\t\"uniform vec2 size;\",\n\n\t\t\"uniform float cameraNear;\",\n\t\t\"uniform float cameraFar;\",\n\t\t\"uniform float edgeSharpness;\",\n\t\t\"uniform int packOutput;\",\n\n\t\t\"uniform vec2 kernelDirection;\",\n\n\t\t\"#include <packing>\",\n\n\t\t\"float getViewZ( const in float depth ) {\",\n\n\t\t\t\"#if PERSPECTIVE_CAMERA == 1\",\n\t\t\t\t\"return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\",\n\t\t\t\"#else\",\n\t\t\t\t\"return orthographicDepthToViewZ( depth, cameraNear, cameraFar );\",\n\t\t\t\"#endif\",\n\n\t\t\"}\",\n\n\t\t\"void addTapInfluence( const in vec2 tapUv, const in vec3 centerNormal, const in float centerViewZ, const in float kernelWeight, inout float aoSum, inout float weightSum ) {\",\n\n\t\t\t\"vec4 depthTexel = texture2D( tAODepth, tapUv );\",\n\t\t\t\"float ao = depthTexel.r;\",\n\t\t\t\"depthTexel.r = 1.0;\",\n\t\t\t\"float depth = unpackRGBAToDepth( depthTexel );\",\n\n\t\t\t\"if( depth >= ( 1.0 - EPSILON ) ) {\",\n\t\t\t\t\"return;\",\n\t\t\t\"}\",\n\n\t\t\t\"float tapViewZ = -getViewZ( depth );\",\n\t\t\t\"float depthWeight = max(0.0, 1.0 - (edgeSharpness * 20.0) * abs(tapViewZ - centerViewZ));\",\n\n\t\t\t\"vec3 normal = unpackRGBToNormal(texture2D(tAONormal, tapUv).rgb);\",\n\t\t\t\"float normalCloseness = dot(normal, centerNormal);\",\n\t\t\t\"float k_normal = 4.0;\",\n\t\t\t\"float normalError = (1.0 - pow4( normalCloseness )) * k_normal;\",\n\t\t\t\"float normalWeight = max((1.0 - edgeSharpness * normalError), 0.00);\",\n\n\t\t\t\"float tapWeight = kernelWeight * ( depthWeight + normalWeight );\",\n\n\t\t\t\"aoSum += ao * tapWeight;\",\n\t\t\t\"weightSum += tapWeight;\",\n\t\t\"}\",\n\n\t\t\"float normpdf(in float x, in float sigma) {\",\n\t\t\t\"return 0.39894*exp(-0.5*x*x/(sigma*sigma))/sigma;\",\n\t\t\"}\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec4 depthTexel = texture2D( tAODepth, vUv );\",\n\t\t\t\"float ao = depthTexel.r;\",\n\t\t\t\"depthTexel.r = 1.0;\",\n\t\t\t\"float depth = unpackRGBAToDepth( depthTexel );\",\n\t\t\t\"if( depth >= ( 1.0 - EPSILON ) ) {\",\n\t\t\t\t\"discard;\",\n\t\t\t\"}\",\n\n\t\t\t\"float centerViewZ = -getViewZ( depth );\",\n\n\t\t\t\"float weightSum = normpdf(0.0, 5.0) + 0.1;\",\n\t\t\t\"float aoSum = ao * weightSum;\",\n\n\t\t\t\"vec2 uvIncrement = ( kernelDirection / size );\",\n\n\t\t\t\"vec2 rTapUv = vUv, lTapUv = vUv;\",\n\t\t\t\"vec3 normalCenter = unpackRGBToNormal(texture2D(tAONormal, vUv).rgb);\",\n\n\t\t\t\"for( int i = 1; i <= KERNEL_SAMPLE_RADIUS; i ++ ) {\",\n\n\t\t\t\t\"float kernelWeight = normpdf(float(i), 5.0) + 0.1;\",\n\n\t\t\t\t\"rTapUv += uvIncrement;\",\n\t\t\t\t\"addTapInfluence( rTapUv, normalCenter, centerViewZ, kernelWeight, aoSum, weightSum );\",\n\n\t\t\t\t\"lTapUv -= uvIncrement;\",\n\t\t\t\t\"addTapInfluence( lTapUv, normalCenter, centerViewZ, kernelWeight, aoSum, weightSum );\",\n\n\t\t\t\"}\",\n\n\t\t\t\"ao = aoSum / weightSum;\",\n\t\t\t\"if( packOutput == 1 ) {\",\n\t\t\t\t\"gl_FragColor = depthTexel;\",\n\t\t\t\t\"gl_FragColor.r = ao;\",\n\t\t\t\"}\",\n\t\t\t\"else {\",\n\t\t\t\t\"gl_FragColor = vec4( vec3( ao ), 1.0 );\",\n\t\t\t\"}\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\n// File:examples/js/shaders/BlurShader.js\n\n/**\n * @author bhouston / http://clara.io\n *\n * For a horizontal blur, use X_STEP 1, Y_STEP 0\n * For a vertical blur, use X_STEP 0, Y_STEP 1\n *\n */\n\nTHREE.BlurShader = {\n\n\tdefines: {\n\n\t\t\"KERNEL_RADIUS\": 4\n\n\t},\n\n\tuniforms: {\n\n\t\t\"tDiffuse\":         { type: \"t\", value: null },\n\t\t\"size\":             { type: \"v2\", value: new THREE.Vector2( 512, 512 ) },\n\t\t\"sampleUvOffsets\":  { type: \"v2v\", value: [ new THREE.Vector2( 0, 0 ) ] },\n\t\t\"sampleWeights\":    { type: \"1fv\", value: [ 1.0 ] },\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"#include <common>\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\"uniform vec2 size;\",\n\n\t\t\"uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];\",\n\t\t\"uniform float sampleWeights[ KERNEL_RADIUS + 1 ];\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec2 invSize = 1.0 / size;\",\n\n\t\t\t\"float weightSum = sampleWeights[0];\",\n\t\t\t\"vec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;\",\n\n\t\t\t\"for( int i = 1; i <= KERNEL_RADIUS; i ++ ) {\",\n\n\t\t\t\t\"float weight = sampleWeights[i];\",\n\t\t\t\t\"vec2 sampleUvOffset = sampleUvOffsets[i] * invSize;\",\n\t\t\t\t\"diffuseSum += ( texture2D( tDiffuse, vUv + sampleUvOffset ) + texture2D( tDiffuse, vUv - sampleUvOffset ) ) * weight;\",\n\t\t\t\t\"weightSum += 2.0 * weight;\",\n\n\t\t\t\"}\",\n\n\t\t\t\"gl_FragColor =diffuseSum / weightSum;\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\n\nTHREE.BlurShaderUtils = {\n\n\tcreateSampleWeights: function( kernelRadius, stdDev ) {\n\n\t\tvar gaussian = function( x, stdDev ) {\n\t\t\treturn Math.exp( - ( x*x ) / ( 2.0 * ( stdDev * stdDev ) ) ) / ( Math.sqrt( 2.0 * Math.PI ) * stdDev );\n\t\t};\n\n\t\tvar weights = [];\n\n\t\tfor( var i = 0; i <= kernelRadius; i ++ ) {\n\t\t\tweights.push( gaussian( i, stdDev ) );\n\t\t}\n\n\t\treturn weights;\n\t},\n\n\tcreateSampleOffsets: function( kernelRadius, uvIncrement ) {\n\n\t\tvar offsets = [];\n\n\t\tfor( var i = 0; i <= kernelRadius; i ++ ) {\n\t\t\toffsets.push( uvIncrement.clone().multiplyScalar( i ) );\n\t\t}\n\n\t\treturn offsets;\n\n\t},\n\n\tconfigure: function( material, kernelRadius, stdDev, uvIncrement ) {\n\n\t\tkernelRadius = kernelRadius | 0;\n\n\t\tif( ( material.defines[ 'KERNEL_RADIUS' ] !== kernelRadius ) || ( material.stdDev != stdDev ) ) {\n\n\t\t\tmaterial.defines[ 'KERNEL_RADIUS' ] = kernelRadius;\n\t\t\tmaterial.uniforms[ 'sampleUvOffsets' ].value = THREE.BlurShaderUtils.createSampleOffsets( kernelRadius, uvIncrement );\n\t\t\tmaterial.uniforms[ 'sampleWeights' ].value = THREE.BlurShaderUtils.createSampleWeights( kernelRadius, stdDev );\n\n\t\t\tmaterial.uvIncrement = uvIncrement;\n\t\t\tmaterial.stdDev = stdDev;\n\n\t\t\tmaterial.needsUpdate = true;\n\t\t}\n\n\t}\n\n};\n\n// File:examples/js/shaders/LuminosityHighPassShader.js\n\n/**\n * @author bhouston / http://clara.io/\n *\n * Luminosity\n * http://en.wikipedia.org/wiki/Luminosity\n */\n\nTHREE.LuminosityHighPassShader = {\n\n  shaderID: \"luminosityHighPass\",\n\n\tuniforms: {\n\n\t\t\"tDiffuse\": { type: \"t\", value: null },\n\t\t\"luminosityThreshold\": { type: \"f\", value: 1.0 },\n\t\t\"smoothWidth\": { type: \"f\", value: 1.0 },\n\t\t\"defaultColor\": { type: \"c\", value: new THREE.Color( 0x000000 ) },\n\t\t\"defaultOpacity\":  { type: \"f\", value: 0.0 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join(\"\\n\"),\n\n\tfragmentShader: [\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\"uniform vec3 defaultColor;\",\n\t\t\"uniform float defaultOpacity;\",\n\t\t\"uniform float luminosityThreshold;\",\n\t\t\"uniform float smoothWidth;\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec4 texel = texture2D( tDiffuse, vUv );\",\n\n\t\t\t\"vec3 luma = vec3( 0.299, 0.587, 0.114 );\",\n\n\t\t\t\"float v = dot( texel.xyz, luma );\",\n\n\t\t\t\"vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\",\n\n\t\t\t\"float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\",\n\n\t\t\t\"gl_FragColor = mix( outputColor, texel, alpha );\",\n\n\t\t\"}\"\n\n\t].join(\"\\n\")\n\n};\n\n// File:examples/js/postprocessing/EffectComposer.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.EffectComposer = function ( renderer, renderTarget ) {\n\n\tthis.renderer = renderer;\n\n\tif ( renderTarget === undefined ) {\n\n\t\tvar parameters = {\n\t\t\tminFilter: THREE.LinearFilter,\n\t\t\tmagFilter: THREE.LinearFilter,\n\t\t\tformat: THREE.RGBAFormat,\n\t\t\tstencilBuffer: false\n\t\t};\n\t\tvar size = renderer.getSize();\n\t\trenderTarget = new THREE.WebGLRenderTarget( size.width, size.height, parameters );\n\t\trenderTarget.texture.name = \"EffectComposer.rt1\";\n\t}\n\n\tthis.renderTarget1 = renderTarget;\n\tthis.renderTarget2 = renderTarget.clone();\n\tthis.renderTarget2.texture.name = \"EffectComposer.rt2\";\n\n\tthis.writeBuffer = this.renderTarget1;\n\tthis.readBuffer = this.renderTarget2;\n\n\tthis.passes = [];\n\n\tif ( THREE.CopyShader === undefined )\n\t\tconsole.error( \"THREE.EffectComposer relies on THREE.CopyShader\" );\n\n\tthis.copyPass = new THREE.ShaderPass( THREE.CopyShader );\n\n};\n\nObject.assign( THREE.EffectComposer.prototype, {\n\n\tswapBuffers: function() {\n\n\t\tvar tmp = this.readBuffer;\n\t\tthis.readBuffer = this.writeBuffer;\n\t\tthis.writeBuffer = tmp;\n\n\t},\n\n\taddPass: function ( pass ) {\n\n\t\tthis.passes.push( pass );\n\n\t\tvar size = this.renderer.getSize();\n\t\tpass.setSize( size.width, size.height );\n\n\t},\n\n\tinsertPass: function ( pass, index ) {\n\n\t\tthis.passes.splice( index, 0, pass );\n\n\t},\n\n\trender: function ( delta ) {\n\n\t\tvar maskActive = false;\n\n\t\tvar pass, i, il = this.passes.length;\n\n\t\tfor ( i = 0; i < il; i ++ ) {\n\n\t\t\tpass = this.passes[ i ];\n\n\t\t\tif ( pass.enabled === false ) continue;\n\n\t\t\tpass.render( this.renderer, this.writeBuffer, this.readBuffer, delta, maskActive );\n\n\t\t\tif ( pass.needsSwap ) {\n\n\t\t\t\tif ( maskActive ) {\n\n\t\t\t\t\tvar context = this.renderer.context;\n\n\t\t\t\t\tcontext.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );\n\n\t\t\t\t\tthis.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, delta );\n\n\t\t\t\t\tcontext.stencilFunc( context.EQUAL, 1, 0xffffffff );\n\n\t\t\t\t}\n\n\t\t\t\tthis.swapBuffers();\n\n\t\t\t}\n\n\t\t\tif ( THREE.MaskPass !== undefined ) {\n\n\t\t\t\tif ( pass instanceof THREE.MaskPass ) {\n\n\t\t\t\t\tmaskActive = true;\n\n\t\t\t\t} else if ( pass instanceof THREE.ClearMaskPass ) {\n\n\t\t\t\t\tmaskActive = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\treset: function ( renderTarget ) {\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tvar size = this.renderer.getSize();\n\n\t\t\trenderTarget = this.renderTarget1.clone();\n\t\t\trenderTarget.setSize( size.width, size.height );\n\n\t\t}\n\n\t\tthis.renderTarget1.dispose();\n\t\tthis.renderTarget2.dispose();\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tthis.renderTarget1.setSize( width, height );\n\t\tthis.renderTarget2.setSize( width, height );\n\n\t\tfor ( var i = 0; i < this.passes.length; i ++ ) {\n\n\t\t\tthis.passes[i].setSize( width, height );\n\n\t\t}\n\n\t}\n\n} );\n\n\nTHREE.Pass = function () {\n\n\t// if set to true, the pass is processed by the composer\n\tthis.enabled = true;\n\n\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\tthis.needsSwap = true;\n\n\t// if set to true, the pass clears its buffer before rendering\n\tthis.clear = false;\n\n\t// if set to true, the result of the pass is rendered to screen\n\tthis.renderToScreen = false;\n\n};\n\nObject.assign( THREE.Pass.prototype, {\n\n\tsetSize: function( width, height ) {},\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tconsole.error( \"THREE.Pass: .render() must be implemented in derived pass.\" );\n\n\t}\n\n} );\n\n// File:examples/js/postprocessing/RenderPass.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.RenderPass = function ( scene, camera, overrideMaterial, clearColor, clearAlpha ) {\n\n\tTHREE.Pass.call( this );\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.overrideMaterial = overrideMaterial;\n\n\tthis.clearColor = clearColor;\n\tthis.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;\n\n\tthis.clear = true;\n\tthis.clearDepth = false;\n\tthis.needsSwap = false;\n\n};\n\nTHREE.RenderPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: THREE.RenderPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tvar oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tthis.scene.overrideMaterial = this.overrideMaterial;\n\n\t\tvar oldClearColor, oldClearAlpha;\n\n\t\tif ( this.clearColor !== undefined ) {\n\n\t\t\toldClearColor = renderer.getClearColor();\n\t\t\toldClearAlpha = renderer.getClearAlpha();\n\n\t\t\trenderer.setClearColor( this.clearColor, this.clearAlpha );\n\n\t\t}\n\n\t\tif ( this.clearDepth ) {\n\n\t\t\trenderer.clearDepth();\n\n\t\t}\n\n\t\trenderer.renderOverride( this.overrideMaterial, this.scene, this.camera, this.renderToScreen ? null : readBuffer, this.clear );\n\n\t\tif ( this.clearColor ) {\n\n\t\t\trenderer.setClearColor( oldClearColor, oldClearAlpha );\n\n\t\t}\n\n\t\tthis.scene.overrideMaterial = null;\n\t\trenderer.autoClear = oldAutoClear;\n\n\t}\n\n} );\n\n// File:examples/js/postprocessing/MaskPass.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.MaskPass = function ( scene, camera ) {\n\n\tTHREE.Pass.call( this );\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.clear = true;\n\tthis.needsSwap = false;\n\n\tthis.inverse = false;\n\n};\n\nTHREE.MaskPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: THREE.MaskPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tvar context = renderer.context;\n\t\tvar state = renderer.state;\n\n\t\t// don't update color or depth\n\n\t\tstate.buffers.color.setMask( false );\n\t\tstate.buffers.depth.setMask( false );\n\n\t\t// lock buffers\n\n\t\tstate.buffers.color.setLocked( true );\n\t\tstate.buffers.depth.setLocked( true );\n\n\t\t// set up stencil\n\n\t\tvar writeValue, clearValue;\n\n\t\tif ( this.inverse ) {\n\n\t\t\twriteValue = 0;\n\t\t\tclearValue = 1;\n\n\t\t} else {\n\n\t\t\twriteValue = 1;\n\t\t\tclearValue = 0;\n\n\t\t}\n\n\t\tstate.buffers.stencil.setTest( true );\n\t\tstate.buffers.stencil.setOp( context.REPLACE, context.REPLACE, context.REPLACE );\n\t\tstate.buffers.stencil.setFunc( context.ALWAYS, writeValue, 0xffffffff );\n\t\tstate.buffers.stencil.setClear( clearValue );\n\n\t\t// draw into the stencil buffer\n\n\t\trenderer.render( this.scene, this.camera, readBuffer, this.clear );\n\t\trenderer.render( this.scene, this.camera, writeBuffer, this.clear );\n\n\t\t// unlock color and depth buffer for subsequent rendering\n\n\t\tstate.buffers.color.setLocked( false );\n\t\tstate.buffers.depth.setLocked( false );\n\n\t\t// only render where stencil is set to 1\n\n\t\tstate.buffers.stencil.setFunc( context.EQUAL, 1, 0xffffffff );  // draw if == 1\n\t\tstate.buffers.stencil.setOp( context.KEEP, context.KEEP, context.KEEP );\n\n\t}\n\n} );\n\n\nTHREE.ClearMaskPass = function () {\n\n\tTHREE.Pass.call( this );\n\n\tthis.needsSwap = false;\n\n};\n\nTHREE.ClearMaskPass.prototype = Object.create( THREE.Pass.prototype );\n\nObject.assign( THREE.ClearMaskPass.prototype, {\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\trenderer.state.buffers.stencil.setTest( false );\n\n\t}\n\n} );\n\n// File:examples/js/postprocessing/ShaderPass.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.ShaderPass = function ( shader, textureID ) {\n\n\tTHREE.Pass.call( this );\n\n\tthis.textureID = ( textureID !== undefined ) ? textureID : \"tDiffuse\";\n\n\tif ( shader instanceof THREE.ShaderMaterial ) {\n\n\t\tthis.uniforms = shader.uniforms;\n\n\t\tthis.material = shader;\n\n\t} else if ( shader ) {\n\n\t\tthis.uniforms = THREE.UniformsUtils.clone( shader.uniforms );\n\n\t\tthis.material = new THREE.ShaderMaterial( {\n\n\t\t\tdefines: shader.defines || {},\n\t\t\tuniforms: this.uniforms,\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader\n\n\t\t} );\n\n\t}\n\n\tthis.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tthis.scene = new THREE.Scene();\n\n\tthis.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );\n\tthis.quad.frustumCulled = false; // Avoid getting clipped\n\tthis.scene.add( this.quad );\n\n};\n\nTHREE.ShaderPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: THREE.ShaderPass,\n\n\trender: function( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tif ( this.uniforms[ this.textureID ] ) {\n\n\t\t\tthis.uniforms[ this.textureID ].value = readBuffer.texture;\n\n\t\t}\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.renderPass( this.material );\n\n\t\t} else {\n\n\t\t\trenderer.renderPass( this.material, writeBuffer, this.clear );\n\n\t\t}\n\n\t}\n\n} );\n\n// File:examples/js/postprocessing/SAOPass.js\n\n/**\n*\n* Scalable Ambient Occlusion\n*\n* @author bhouston / http://clara.io/\n*\n*\n*/\n\nTHREE.SAOPass = function ( scene, camera ) {\n\n\tTHREE.Pass.call( this );\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.intensity = 0.5;\n\tthis.implicitNormals = false; // explicit normals requires or there are artifacts on mobile.\n\tthis.occlusionSphereWorldRadius = 20;\n\tthis.blurEnabled = true;\n\tthis.outputOverride = null; // 'beauty', 'depth', 'sao'\n\tthis.depthMIPs = false;\n\tthis.downSamplingRatio = 2;\n\tthis.blurKernelSize = (this.downSamplingRatio === 1) ? 8 : 6;\n\tthis.edgeSharpness = 1;\n\n\t/*\n\tif ( false && renderer.extensions.get('WEBGL_depth_texture') ) {\n\n\t\tconsole.log( \"using depth extension\");\n\n\t\tthis.depthTexture = optionalBuffers.depthTexture || new THREE.DepthTexture();\n\t\tthis.depthTexture.type = isWebGL2 ? THREE.FloatType : THREE.UnsignedShortType;\n\t\tthis.depthTexture.minFilter = THREE.NearestFilter;\n\t\tthis.depthTexture.maxFilter = THREE.NearestFilter;\n\n\t\tthis.beautyRenderTarget.depthBuffer = true;\n\t\tthis.beautyRenderTarget.depthTexture = this.depthTexture;\n\n\t}*/\n\n\tthis.depthMaterial = new THREE.MeshDepthMaterial();\n\tthis.depthMaterial.depthPacking = THREE.RGBADepthPacking;\n\tthis.depthMaterial.blending = THREE.NoBlending;\n\tthis.depthMaterial.side = THREE.DoubleSide;\n\n\tthis.normalMaterial = new THREE.MeshNormalMaterial();\n\tthis.normalMaterial.side = this.depthMaterial.side; // both normal and depth materials bot need to render with the same sidedness\n\n\tif ( THREE.SAOShader === undefined )\tconsole.error( \"THREE.SAOPass relies on THREE.SAOShader\" );\n\tif ( THREE.CopyShader === undefined )\tconsole.error( \"THREE.SAOPass relies on THREE.CopyShader\" );\n\n\tthis.depthMinifyMaterial = new THREE.ShaderMaterial( THREE.SAODepthMinifyShader );\n\tthis.depthMinifyMaterial.uniforms = THREE.UniformsUtils.clone( this.depthMinifyMaterial.uniforms );\n\tthis.depthMinifyMaterial.defines = Object.assign( {}, this.depthMinifyMaterial.defines );\n\tthis.depthMinifyMaterial.blending = THREE.NoBlending;\n\n\tthis.saoMaterial = new THREE.ShaderMaterial( THREE.SAOShader );\n\tthis.saoMaterial.uniforms = THREE.UniformsUtils.clone( this.saoMaterial.uniforms );\n\tthis.saoMaterial.defines = Object.assign( {}, this.saoMaterial.defines );\n\tthis.saoMaterial.defines[ 'DIFFUSE_TEXTURE' ] = 0;\n\tthis.saoMaterial.defines[ 'NORMAL_TEXTURE' ] = this.implicitNormals ? 0 : 1;\n\tthis.saoMaterial.defines[ 'MODE' ] = 2;\n\n\tthis.bilateralFilterMaterial = new THREE.ShaderMaterial( THREE.SAOBilaterialFilterShader );\n\tthis.bilateralFilterMaterial.uniforms = THREE.UniformsUtils.clone( this.bilateralFilterMaterial.uniforms );\n\tthis.bilateralFilterMaterial.defines = Object.assign( {}, this.bilateralFilterMaterial.defines );\n\tthis.bilateralFilterMaterial.blending = THREE.NoBlending;\n\tthis.bilateralFilterMaterial.premultipliedAlpha = true;\n\n\tthis.bilateralUpsamplerMaterial = this.getBilateralUpsamplerMaterial();\n\n\tthis.copyMaterial = new THREE.ShaderMaterial( THREE.CopyShader );\n\tthis.copyMaterial.uniforms = THREE.UniformsUtils.clone( this.copyMaterial.uniforms );\n\tthis.copyMaterial.uniforms['opacity'].value = 1.0;\n\tthis.copyMaterial.blending = THREE.NoBlending;\n\tthis.copyMaterial.premultipliedAlpha = true;\n\tthis.copyMaterial.transparent = true;\n\tthis.copyMaterial.depthTest = false;\n\tthis.copyMaterial.depthWrite = false;\n\n};\n\nTHREE.SAOPass.prototype = {\n\n\tdispose: function() {\n\n\t\tif( this.saoRenderTarget ) {\n\t\t\tthis.saoRenderTarget.dispose();\n\t\t\tthis.saoRenderTarget = null;\n\t\t}\n\t\tif( this.blurIntermediateRenderTarget ) {\n\t\t\tthis.blurIntermediateRenderTarget.dispose();\n\t\t\tthis.blurIntermediateRenderTarget = null;\n\t\t}\n\t\tif( this.depthRenderTarget ) {\n\t\t\tthis.depthRenderTarget.dispose();\n\t\t\tthis.depthRenderTarget = null;\n\t\t}\n\t\tif( this.depth1RenderTarget ) {\n\t\t\tthis.depth1RenderTarget.dispose();\n\t\t\tthis.depth1RenderTarget = null;\n\t\t}\n\t\tif( this.depth2RenderTarget ) {\n\t\t\tthis.depth2RenderTarget.dispose();\n\t\t\tthis.depth2RenderTarget = null;\n\t\t}\n\t\tif( this.depth3RenderTarget ) {\n\t\t\tthis.depth3RenderTarget.dispose();\n\t\t\tthis.depth3RenderTarget = null;\n\t\t}\n\t\tif( this.normalRenderTarget ) {\n\t\t\tthis.normalRenderTarget.dispose();\n\t\t\tthis.normalRenderTarget = null;\n\t\t}\n\t\tif( this.normalRenderTargetFullRes ) {\n\t\t\tthis.normalRenderTargetFullRes.dispose();\n\t\t\tthis.normalRenderTargetFullRes = null;\n\t\t}\n\t\tif( this.depthRenderTargetFullRes ) {\n\t\t\tthis.depthRenderTargetFullRes.dispose();\n\t\t\tthis.depthRenderTargetFullRes = null;\n\t\t}\n\t\tif( this.saoRenderTargetFullRes ) {\n\t\t\tthis.saoRenderTargetFullRes.dispose();\n\t\t\tthis.saoRenderTargetFullRes = null;\n\t\t}\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tif( this.saoRenderTargetFullRes ) this.saoRenderTargetFullRes.setSize( width, height );\n\t\tif( this.depthRenderTargetFullRes ) this.depthRenderTargetFullRes.setSize( width, height );\n\t\tif( this.normalRenderTargetFullRes ) this.normalRenderTargetFullRes.setSize( width, height );\n\t\twidth = Math.ceil( width / this.downSamplingRatio );\n\t\theight = Math.ceil( height / this.downSamplingRatio );\n\t\tif( this.saoRenderTarget ) this.saoRenderTarget.setSize( width, height );\n\t\tif( this.blurIntermediateRenderTarget ) this.blurIntermediateRenderTarget.setSize( width, height );\n\t\tif( this.depthRenderTarget ) this.depthRenderTarget.setSize( width, height );\n\t\tif( this.depth1RenderTarget ) this.depth1RenderTarget.setSize( Math.ceil( width / 2 ), Math.ceil( height / 2 ) );\n\t\tif( this.depth2RenderTarget ) this.depth2RenderTarget.setSize( Math.ceil( width / 4 ), Math.ceil( height / 4 ) );\n\t\tif( this.depth3RenderTarget ) this.depth3RenderTarget.setSize( Math.ceil( width / 8 ), Math.ceil( height / 8 ) );\n\t\tif( this.normalRenderTarget ) this.normalRenderTarget.setSize( width, height );\n\n\t\tthis.saoMaterial.uniforms[ 'size' ].value.set( width, height );\n\t\tthis.bilateralFilterMaterial.uniforms[ 'size' ].value.set( width, height );\n\t\t//console.log( 'downsampledsize: ', width, height );\n\t},\n\n\tupdateParameters: function( camera ) {\n\n\t\tvar vSizeAt1M = 1 / ( Math.tan( THREE.Math.DEG2RAD * camera.fov * 0.5 ) * 2 );\n\t\tvar sizeAt1M = new THREE.Vector2( vSizeAt1M / camera.aspect, vSizeAt1M );\n\n\t\tthis.saoMaterial.uniforms['worldToScreenRatio'].value = sizeAt1M;\n\t\tthis.saoMaterial.uniforms['intensity'].value = this.intensity;\n\t\tthis.saoMaterial.uniforms['occlusionSphereWorldRadius'].value = this.occlusionSphereWorldRadius;\n\n\t\tthis.depthMinifyMaterial.uniforms[ 'cameraNear' ].value = camera.near;\n\t\tthis.depthMinifyMaterial.uniforms[ 'cameraFar' ].value = camera.far;\n\n\t\tthis.saoMaterial.uniforms[ 'cameraNear' ].value = camera.near;\n\t\tthis.saoMaterial.uniforms[ 'cameraFar' ].value = camera.far;\n\t\tthis.saoMaterial.uniforms[ 'cameraProjectionMatrix' ].value = camera.projectionMatrix;\n\t\tthis.saoMaterial.uniforms[ 'cameraInverseProjectionMatrix' ].value.getInverse( camera.projectionMatrix );\n\n\t\tthis.bilateralFilterMaterial.uniforms[ \"cameraNear\" ].value = camera.near;\n\t\tthis.bilateralFilterMaterial.uniforms[ \"cameraFar\" ].value = camera.far;\n\t},\n\n\trender: function( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tvar width = readBuffer.width, height = readBuffer.height;\n\n\t\twidth = Math.ceil( width / this.downSamplingRatio );\n\t\theight = Math.ceil( height / this.downSamplingRatio );\n\n\t\tvar depthTexture = ( readBuffer.depthBuffer && readBuffer.depthTexture ) ? readBuffer.depthTexture : null;\n\n\t\tif ( ! this.saoRenderTarget ) {\n\n\t\t\tthis.saoRenderTarget = new THREE.WebGLRenderTarget( width, height,\n\t\t\t\t{ minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat } );\n\t\t\tthis.saoRenderTargetFullRes = new THREE.WebGLRenderTarget( readBuffer.width, readBuffer.height,\n\t\t\t\t\t{ minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat } );\n\t\t\tthis.blurIntermediateRenderTarget = new THREE.WebGLRenderTarget( width, height,\n\t\t\t\t{ minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat } );\n\t\t\tthis.depth1RenderTarget = new THREE.WebGLRenderTarget( Math.ceil( width / 2 ), Math.ceil( height / 2 ),\n\t\t\t\t{ minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat } );\n\t\t\tthis.depth2RenderTarget = new THREE.WebGLRenderTarget( Math.ceil( width / 4 ), Math.ceil( height / 4 ),\n\t\t\t\t{ minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat } );\n\t\t\tthis.depth3RenderTarget = new THREE.WebGLRenderTarget( Math.ceil( width / 8 ), Math.ceil( height / 8 ),\n\t\t\t\t{ minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat } );\n\t\t\tthis.normalRenderTarget = new THREE.WebGLRenderTarget( width, height,\n\t\t\t\t{ minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat } );\n\t\t\tthis.normalRenderTargetFullRes = new THREE.WebGLRenderTarget( readBuffer.width, readBuffer.height,\n\t\t\t\t{ minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat } );\n\t\t}\n\n\t\tif( ! depthTexture && ! this.depthRenderTarget ) {\n\n\t\t\tthis.depthRenderTarget = new THREE.WebGLRenderTarget( width, height,\n\t\t\t\t{ minFilter: THREE.NearestFilter, magFilter: THREE.NearestFilter, format: THREE.RGBAFormat } );\n\t\t\tthis.depthRenderTargetFullRes = new THREE.WebGLRenderTarget( readBuffer.width, readBuffer.height,\n\t\t\t\t{ minFilter: THREE.NearestFilter, magFilter: THREE.NearestFilter, format: THREE.RGBAFormat } );\n\n\t\t}\n\n\t\tthis.updateParameters( this.camera );\n\n\t\tvar clearColor = renderer.getClearColor(), clearAlpha = renderer.getClearAlpha(), autoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tif( ! this.renderToScreen ) {\n\n\t\t\tthis.copyMaterial.uniforms[ 'tDiffuse' ].value = readBuffer.texture;\n\t\t\tthis.copyMaterial.blending = THREE.NoBlending;\n\n\t\t\trenderer.renderPass( this.copyMaterial, writeBuffer, true );\n\n\t\t}\n\n\t\tvar depthPackingMode = 0;\n\n\t\tif( ! depthTexture ) {\n\n\t\t\tvar oldClearColor = renderer.getClearColor(), oldClearAlpha = renderer.getClearAlpha();\n\t\t\trenderer.setClearColor( 0xffffff, 1.0 );\n\n\t\t\trenderer.renderOverride( this.depthMaterial, this.scene, this.camera, this.depthRenderTarget, true );\n\n\t\t\trenderer.setClearColor( 0xffffff, 1.0 );\n\n\t\t\tif( this.downSamplingRatio !== 1.0 ) {\n\n\t\t\t\trenderer.renderOverride( this.depthMaterial, this.scene, this.camera, this.depthRenderTargetFullRes, true );\n\n\t\t\t\trenderer.setClearColor( oldClearColor, oldClearAlpha );\n\n\t\t\t}\n\t\t\tdepthTexture = this.depthRenderTarget.texture;\n\t\t\tdepthPackingMode = 1;\n\n\t\t}\n\n\t\tif( this.depthMIPs ) {\n\n\t\t\tthis.depthMinifyMaterial.uniforms['tDepth'].value = depthTexture;\n\t\t\tthis.depthMinifyMaterial.uniforms['size'].value.set( width, height );\n\t\t\trenderer.renderPass( this.depthMinifyMaterial, this.depth1RenderTarget, true );\n\n\t\t\tthis.depthMinifyMaterial.uniforms['tDepth'].value = this.depth1RenderTarget.texture;\n\t\t\tthis.depthMinifyMaterial.uniforms['size'].value.set( Math.ceil( width / 2 ), Math.ceil( height / 2 ) );\n\t\t\trenderer.renderPass( this.depthMinifyMaterial, this.depth2RenderTarget, true );\n\n\t\t\tthis.depthMinifyMaterial.uniforms['tDepth'].value = this.depth2RenderTarget.texture;\n\t\t\tthis.depthMinifyMaterial.uniforms['size'].value.set( Math.ceil( width / 4 ), Math.ceil( height / 4 ) );\n\t\t\trenderer.renderPass( this.depthMinifyMaterial, this.depth3RenderTarget, true );\n\n\t\t}\n\n\t\tif( this.outputOverride === \"depth\" ) {\n\n\t\t\tthis.copyMaterial.uniforms[ 'tDiffuse' ].value = depthTexture;\n\t\t\tthis.copyMaterial.blending = THREE.NoBlending;\n\n\t\t\trenderer.renderPass( this.copyMaterial, this.renderToScreen ? null : writeBuffer, true );\n\t\t\treturn;\n\n\t\t}\n\t\tif( this.outputOverride === \"depth1\" ) {\n\n\t\t\tthis.copyMaterial.uniforms[ 'tDiffuse' ].value = this.depth1RenderTarget.texture;\n\t\t\tthis.copyMaterial.blending = THREE.NoBlending;\n\n\t\t\trenderer.renderPass( this.copyMaterial, this.renderToScreen ? null : writeBuffer, true );\n\t\t\treturn;\n\n\t\t}\n\t\tif( this.outputOverride === \"depth2\" ) {\n\n\t\t\tthis.copyMaterial.uniforms[ 'tDiffuse' ].value = this.depth2RenderTarget.texture;\n\t\t\tthis.copyMaterial.blending = THREE.NoBlending;\n\n\t\t\trenderer.renderPass( this.copyMaterial, this.renderToScreen ? null : writeBuffer, true );\n\t\t\treturn;\n\n\t\t}\n\t\tif( this.outputOverride === \"depth3\" ) {\n\n\t\t\tthis.copyMaterial.uniforms[ 'tDiffuse' ].value = this.depth3RenderTarget.texture;\n\t\t\tthis.copyMaterial.blending = THREE.NoBlending;\n\n\t\t\trenderer.renderPass( this.copyMaterial, this.renderToScreen ? null : writeBuffer, true );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif( ! this.implicitNormals ) {\n\n\t\t\tvar oldClearColor = renderer.getClearColor(), oldClearAlpha = renderer.getClearAlpha();\n\t\t\trenderer.setClearColor( new THREE.Color( 0.5, 0.5, 1.0 ), 1.0 );\n\n\t\t\trenderer.renderOverride( this.normalMaterial, this.scene, this.camera, this.normalRenderTarget, true );\n\n\t\t\tif( this.downSamplingRatio !== 1.0 ) {\n\n\t\t\t\t\trenderer.setClearColor( new THREE.Color( 0.5, 0.5, 1.0 ), 1.0 );\n\n\t\t\t\t\trenderer.renderOverride( this.normalMaterial, this.scene, this.camera, this.normalRenderTargetFullRes, true );\n\n\t\t\t}\n\n\t\t\trenderer.setClearColor( oldClearColor, oldClearAlpha );\n\n\t\t}\n\n\t\tif( this.outputOverride === \"normal\" ) {\n\n\t\t\tthis.copyMaterial.uniforms[ 'tDiffuse' ].value = this.normalRenderTarget.texture;\n\t\t\tthis.copyMaterial.blending = THREE.NoBlending;\n\n\t\t\trenderer.renderPass( this.copyMaterial, this.renderToScreen ? null : this.renderToScreen ? null : writeBuffer, true );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.saoMaterial.defines[ 'DEPTH_PACKING' ] = depthPackingMode;\n\t\tthis.saoMaterial.defines[ 'DEPTH_MIPS' ] = this.depthMIPs ? 1 : 0;\n\t\tthis.saoMaterial.uniforms[ \"tNormal\" ].value = this.normalRenderTarget.texture;\n\t\tthis.saoMaterial.uniforms[ \"tDepth\" ].value = depthTexture;\n\t\tif( this.depthMIPs ) {\n\n\t\t\tthis.saoMaterial.uniforms[ \"tDepth1\" ].value = this.depth1RenderTarget.texture;\n\t\t\tthis.saoMaterial.uniforms[ \"tDepth2\" ].value = this.depth2RenderTarget.texture;\n\t\t\tthis.saoMaterial.uniforms[ \"tDepth3\" ].value = this.depth3RenderTarget.texture;\n\t\t}\n\n\t\tvar oldClearColor = renderer.getClearColor(), oldClearAlpha = renderer.getClearAlpha();\n\t\trenderer.setClearColor( 0xffffff, 1.0 );\n\n\t\trenderer.renderPass( this.saoMaterial, this.saoRenderTarget, true ); // , 0xffffff, 0.0, \"sao\"\n\n\t\tif( this.blurEnabled ) {\n\n\t\t\tthis.bilateralFilterMaterial.defines[ 'KERNEL_SAMPLE_RADIUS' ] = this.blurKernelSize;\n\t\t\tthis.bilateralFilterMaterial.uniforms[ \"tAODepth\" ].value = this.saoRenderTarget.texture;\n\t\t\tthis.bilateralFilterMaterial.uniforms[ \"tAONormal\" ].value = this.normalRenderTarget.texture;\n\t\t\tthis.bilateralFilterMaterial.uniforms[ \"kernelDirection\" ].value = new THREE.Vector2( 1, 0 );\n\t\t\tthis.bilateralFilterMaterial.uniforms[ \"packOutput\" ].value = 1;\n\t\t\tthis.bilateralFilterMaterial.uniforms[ 'edgeSharpness' ].value = this.edgeSharpness;\n\n\t\t\trenderer.renderPass( this.bilateralFilterMaterial, this.blurIntermediateRenderTarget, true ); // , 0xffffff, 0.0, \"sao vBlur\"\n\n\t\t\tthis.bilateralFilterMaterial.uniforms[ \"tAODepth\" ].value = this.blurIntermediateRenderTarget.texture;\n\t\t\tthis.bilateralFilterMaterial.uniforms[ \"kernelDirection\" ].value = new THREE.Vector2( 0, 1 );\n\t\t\tthis.bilateralFilterMaterial.uniforms[ \"packOutput\" ].value = 0;\n\n\t\t\trenderer.renderPass( this.bilateralFilterMaterial, this.saoRenderTarget, true ); // 0xffffff, 0.0, \"sao hBlur\"\n\n\t\t}\n\t\tif(this.downSamplingRatio > 1.0)\n\t\t{\n\t\t\t//Bilateral Up sampler\n\t\t\tthis.bilateralUpsamplerMaterial.uniforms[\"inputTexture\"].value = this.saoRenderTarget.texture;\n\t\t\tthis.bilateralUpsamplerMaterial.uniforms[\"NormalTextureFullRes\"].value = this.normalRenderTargetFullRes.texture;\n\t\t\tthis.bilateralUpsamplerMaterial.uniforms[\"DepthTextureFullRes\"].value = this.depthRenderTargetFullRes.texture;\n\t\t\tthis.bilateralUpsamplerMaterial.uniforms[\"NormalTextureHalfRes\"].value = this.normalRenderTarget.texture;\n\t\t\tthis.bilateralUpsamplerMaterial.uniforms[\"DepthTextureHalfRes\"].value = this.depthRenderTarget.texture;\n\t\t\tthis.bilateralUpsamplerMaterial.uniforms[\"texSize\"].value = new THREE.Vector2(this.saoRenderTarget.width, this.saoRenderTarget.height);\n\t\t\tthis.bilateralUpsamplerMaterial.uniforms[\"cameraNearFar\"].value = new THREE.Vector2(this.camera.near, this.camera.far);\n\t\t\trenderer.renderPass( this.bilateralUpsamplerMaterial, this.saoRenderTargetFullRes, true ); // 0xffffff, 0.0, \"sao hBlur\"\n\n\t\t}\n\t\trenderer.setClearColor( oldClearColor, oldClearAlpha );\n\n\t\tif( this.outputOverride === \"sao\" ) {\n\n\t\t\tthis.copyMaterial.uniforms[ 'tDiffuse' ].value = this.downSamplingRatio > 1.0 ? this.saoRenderTargetFullRes.texture\n\t\t\t: this.saoRenderTarget.texture;\n\t\t\tthis.copyMaterial.blending = THREE.NoBlending;\n\n\t\t\trenderer.renderPass( this.copyMaterial, this.renderToScreen ? null : writeBuffer, true );\n\t\t\treturn;\n\n\t\t}\n\n\t\trenderer.autoClear = false;\n\n\t\tthis.copyMaterial.uniforms[ 'tDiffuse' ].value = this.downSamplingRatio > 1.0 ? this.saoRenderTargetFullRes.texture\n\t\t: this.saoRenderTarget.texture;\n\t\tthis.copyMaterial.blending = THREE.MultiplyBlending;\n\t\tthis.copyMaterial.premultipliedAlpha = true;\n\n\t\trenderer.renderPass( this.copyMaterial, this.renderToScreen ? null : writeBuffer, false );\n\n\t\trenderer.autoClear = autoClear;\n\t\trenderer.setClearColor( clearColor );\n\t\trenderer.setClearAlpha( clearAlpha );\n\n\t},\n\n\tgetBilateralUpsamplerMaterial: function(kernelRadius) {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"inputTexture\": { value: null },\n\t\t\t\t\"NormalTextureFullRes\": { value: null },\n\t\t\t\t\"DepthTextureFullRes\": { value: null },\n\t\t\t\t\"NormalTextureHalfRes\": { value: null },\n\t\t\t\t\"DepthTextureHalfRes\": { value: null },\n\t\t\t\t\"texSize\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"cameraNearFar\": \t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\n\\\n\t\t\t\t#include <packing>\\n\\\n\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\tuniform sampler2D inputTexture;\\n\\\n\t\t\t\tuniform sampler2D NormalTextureFullRes;\\n\\\n\t\t\t\tuniform sampler2D DepthTextureFullRes;\\n\\\n\t\t\t\tuniform sampler2D NormalTextureHalfRes;\\n\\\n\t\t\t\tuniform sampler2D DepthTextureHalfRes;\\n\\\n\t\t\t\tuniform vec2 texSize;\\\n\t\t\t\tuniform vec2 cameraNearFar;\\\n\t\t\t\t\\\n\t\t\t\tvoid main()\\\n\t\t\t\t{\\\n\t\t\t\t\tvec2 uvOffsets[4];\\\n\t\t\t\t\tuvOffsets[0] = vUv + vec2(0.0, 1.0)/texSize;\\\n\t\t\t\t\tuvOffsets[1] = vUv + vec2(1.0, 0.0)/texSize;\\\n\t\t\t\t\tuvOffsets[2] = vUv + vec2(-1.0, 0.0)/texSize;\\\n\t\t\t\t\tuvOffsets[3] = vUv + vec2(0.0, -1.0)/texSize;\\\n\t\t\t\t\t\\\n\t\t\t\t\tfloat depth_weights[4];\\\n\t\t\t\t\tfloat depth_hires = unpackRGBAToDepth(texture2D(DepthTextureFullRes, vUv));\\\n\t\t\t\t\tdepth_hires = -perspectiveDepthToViewZ(depth_hires, cameraNearFar.x, cameraNearFar.y);\\\n\t\t\t\t\tif(depth_hires == 1.0)\\\n\t\t\t\t\t\tdiscard;\\\n\t\t\t\t\tfloat depth_coarse1 = unpackRGBAToDepth(texture2D(DepthTextureHalfRes, uvOffsets[0]));\\\n\t\t\t\t\tdepth_coarse1 = -perspectiveDepthToViewZ(depth_coarse1, cameraNearFar.x, cameraNearFar.y);\\\n\t\t\t\t\tdepth_weights[0] = 1.0 / (0.001 + abs(depth_hires-depth_coarse1));\\\n\t\t\t\t\tfloat depth_coarse2 = unpackRGBAToDepth(texture2D(DepthTextureHalfRes, uvOffsets[1]));\\\n\t\t\t\t\tdepth_coarse2 = -perspectiveDepthToViewZ(depth_coarse2, cameraNearFar.x, cameraNearFar.y);\\\n\t\t\t\t\tdepth_weights[1] = 1.0 / (0.001 + abs(depth_hires-depth_coarse2));\\\n\t\t\t\t\tfloat depth_coarse3 = unpackRGBAToDepth(texture2D(DepthTextureHalfRes, uvOffsets[2]));\\\n\t\t\t\t\tdepth_coarse3 = -perspectiveDepthToViewZ(depth_coarse3, cameraNearFar.x, cameraNearFar.y);\\\n\t\t\t\t\tdepth_weights[2] = 1.0 / (0.001 + abs(depth_hires-depth_coarse3));\\\n\t\t\t\t\tfloat depth_coarse4 = unpackRGBAToDepth(texture2D(DepthTextureHalfRes, uvOffsets[3]));\\\n\t\t\t\t\tdepth_coarse4 = -perspectiveDepthToViewZ(depth_coarse4, cameraNearFar.x, cameraNearFar.y);\\\n\t\t\t\t\tdepth_weights[3] = 1.0 / (0.001 + abs(depth_hires-depth_coarse4));\\\n\t\t\t\t\t\\\n\t\t\t\t\tfloat norm_weights[4];\\\n\t\t\t\t\tvec3 norm_fullRes = unpackRGBToNormal(texture2D(NormalTextureFullRes, vUv).rgb);\\\n\t\t\t\t\tvec3 norm_coarse1 = unpackRGBToNormal(texture2D(NormalTextureHalfRes, uvOffsets[0]).rgb);\\\n\t\t\t\t\tnorm_weights[0] = pow(abs(dot(norm_coarse1, norm_fullRes)), 32.0);\\\n\t\t\t\t\tvec3 norm_coarse2 = unpackRGBToNormal(texture2D(NormalTextureHalfRes, uvOffsets[1]).rgb);\\\n\t\t\t\t\tnorm_weights[1] = pow(abs(dot(norm_coarse2, norm_fullRes)), 32.0);\\\n\t\t\t\t\tvec3 norm_coarse3 = unpackRGBToNormal(texture2D(NormalTextureHalfRes, uvOffsets[2]).rgb);\\\n\t\t\t\t\tnorm_weights[2] = pow(abs(dot(norm_coarse3, norm_fullRes)), 32.0);\\\n\t\t\t\t\tvec3 norm_coarse4 = unpackRGBToNormal(texture2D(NormalTextureHalfRes, uvOffsets[3]).rgb);\\\n\t\t\t\t\tnorm_weights[3] = pow(abs(dot(norm_coarse4, norm_fullRes)), 32.0);\\\n\t\t\t\t\t\\\n\t\t\t\t\tvec3 colorOut = vec3(0.0);\\\n\t\t\t\t\tfloat weight_sum = 0.0;\\\n\t\t\t\t\tfloat weight = norm_weights[0] * depth_weights[0];\\\n\t\t\t\t\tcolorOut += texture2D(inputTexture, uvOffsets[0]).rgb*weight;\\\n\t\t\t\t\tweight_sum += weight;\\\n\t\t\t\t  weight = norm_weights[1] * depth_weights[1];\\\n\t\t\t\t\tcolorOut += texture2D(inputTexture, uvOffsets[1]).rgb*weight;\\\n\t\t\t\t\tweight_sum += weight;\\\n\t\t\t\t  weight = norm_weights[2] * depth_weights[2];\\\n\t\t\t\t\tcolorOut += texture2D(inputTexture, uvOffsets[2]).rgb*weight;\\\n\t\t\t\t\tweight_sum += weight;\\\n\t\t\t\t  weight = norm_weights[3] * depth_weights[3];\\\n\t\t\t\t\tcolorOut += texture2D(inputTexture, uvOffsets[3]).rgb*weight;\\\n\t\t\t\t\tweight_sum += weight;\\\n\t\t\t\t\tcolorOut /= weight_sum;\\\n\t\t\t\t\tgl_FragColor = vec4(colorOut, 1.0);\\\n\t\t\t\t}\"\n\t\t} );\n\t}\n\n};\n\n// File:examples/js/postprocessing/SSAARenderPass.js\n\n/**\n*\n* Supersample Anti-Aliasing Render Pass\n*\n* @author bhouston / http://clara.io/\n*\n* This manual approach to SSAA re-renders the scene ones for each sample with camera jitter and accumulates the results.\n*\n* References: https://en.wikipedia.org/wiki/Supersampling\n*\n*/\n\nTHREE.SSAARenderPass = function ( scene, camera, clearColor, clearAlpha ) {\n\n\tTHREE.Pass.call( this );\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.sampleLevel = 4; // specified as n, where the number of samples is 2^n, so sampleLevel = 4, is 2^4 samples, 16.\n\tthis.unbiased = true;\n\n\tthis.needsSwap = false;\n\n\t// as we need to clear the buffer in this pass, clearColor must be set to something, defaults to black.\n\tthis.clearColor = ( clearColor !== undefined ) ? clearColor : 0x000000;\n\tthis.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;\n\n\tif ( THREE.CopyShader === undefined ) console.error( \"THREE.SSAARenderPass relies on THREE.CopyShader\" );\n\n\tthis.overMaterial = new THREE.ShaderMaterial( THREE.CopyShader );\n\tthis.overMaterial.uniforms = THREE.UniformsUtils.clone( this.overMaterial.uniforms );\n\tthis.overMaterial.blending = THREE.NormalBlending;\n\tthis.overMaterial.premultipliedAlpha = true;\n\tthis.overMaterial.transparent = true;\n\tthis.overMaterial.depthTest = false;\n\tthis.overMaterial.depthWrite = false;\n\n\tthis.addMaterial = new THREE.ShaderMaterial( THREE.CopyShader );\n\tthis.addMaterial.uniforms = THREE.UniformsUtils.clone( this.addMaterial.uniforms );\n\tthis.addMaterial.blending = THREE.AdditiveBlending;\n\tthis.addMaterial.premultipliedAlpha = true;\n\tthis.addMaterial.transparent = true;\n\tthis.addMaterial.depthTest = false;\n\tthis.addMaterial.depthWrite = false;\n\n\tthis.camera2 = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tthis.scene2\t= new THREE.Scene();\n\tthis.quad2 = new THREE.Mesh( new THREE.PlaneGeometry( 2, 2 ), this.copyMaterial );\n\tthis.quad2.frustumCulled = false; // Avoid getting clipped\n\tthis.scene2.add( this.quad2 );\n\n};\n\nTHREE.SSAARenderPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: THREE.SSAARenderPass,\n\n\tdispose: function() {\n\n\t\tif ( this.sampleRenderTarget ) {\n\t\t\tthis.sampleRenderTarget.dispose();\n\t\t\tthis.sampleRenderTarget = null;\n\t\t}\n\t\tif ( this.accumulateRenderTarget ) {\n\t\t\tthis.accumulateRenderTarget.dispose();\n\t\t\tthis.accumulateRenderTarget = null;\n\t\t}\n\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tif ( this.sampleRenderTarget ) this.sampleRenderTarget.setSize( width, height );\n\t\tif ( this.accumulateRenderTarget ) this.accumulateRenderTarget.setSize( width, height );\n\n\t},\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tif ( ! this.sampleRenderTarget ) {\n\n\t\t\tthis.sampleRenderTarget = new THREE.WebGLRenderTarget( readBuffer.width, readBuffer.height,\n\t\t\t\t{ minFilter: THREE.NearestFilter, magFilter: THREE.NearestFilter, format: THREE.RGBAFormat, name: \"SSAARenderPass.sample\" } );\n\t\t\tthis.accumulateRenderTarget = new THREE.WebGLRenderTarget( readBuffer.width, readBuffer.height,\n\t\t\t\t{ minFilter: THREE.NearestFilter, magFilter: THREE.NearestFilter, format: THREE.RGBAFormat, name: \"SSAARenderPass.accumulation\" } );\n\n\t\t}\n\n\t\tvar jitterOffsets = THREE.SSAARenderPass.JitterVectors[ Math.max( 0, Math.min( this.sampleLevel, 5 ) ) ];\n\n\t\tvar autoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tvar oldClearColor = renderer.getClearColor().getHex();\n\t\tvar oldClearAlpha = renderer.getClearAlpha();\n\n\t\tvar baseSampleWeight = 1.0 / jitterOffsets.length;\n\t\tvar roundingRange = 1 / 32;\n\n\t\tthis.addMaterial.uniforms[ \"tDiffuse\" ].value = this.sampleRenderTarget.texture;\n\n\n\t\tvar width = readBuffer.width, height = readBuffer.height;\n\n\t\trenderer.setClearColor( 0x000000, 0 );\n\n\t\t// render the scene multiple times, each slightly jitter offset from the last and accumulate the results.\n\t\tfor ( var i = 0; i < jitterOffsets.length; i ++ ) {\n\n\t\t\tvar jitterOffset = jitterOffsets[i];\n\t\t\tif ( this.camera.setViewOffset ) {\n\t\t\t\tthis.camera.setViewOffset( width, height,\n\t\t\t\t\tjitterOffset[ 0 ] * 0.0625, jitterOffset[ 1 ] * 0.0625,   // 0.0625 = 1 / 16\n\t\t\t\t\twidth, height );\n\t\t\t}\n\n\t\t\tvar sampleWeight = baseSampleWeight;\n\t\t\tif( this.unbiased ) {\n\t\t\t\t// the theory is that equal weights for each sample lead to an accumulation of rounding errors.\n\t\t\t\t// The following equation varies the sampleWeight per sample so that it is uniformly distributed\n\t\t\t\t// across a range of values whose rounding errors cancel each other out.\n\t\t\t\tvar uniformCenteredDistribution = ( -0.5 + ( i + 0.5 ) / jitterOffsets.length );\n\t\t\t\tsampleWeight += roundingRange * uniformCenteredDistribution;\n\t\t\t}\n\n\t\t\tthis.addMaterial.uniforms[ \"opacity\" ].value = sampleWeight;\n\t\t\trenderer.render( this.scene, this.camera, this.sampleRenderTarget, true );\n\t\t\trenderer.renderPass( this.addMaterial, this.accumulateRenderTarget, ( i === 0 ) );\n\t\t}\n\n\t\tif ( this.camera.clearViewOffset ) this.camera.clearViewOffset();\n\n\t\tthis.overMaterial.uniforms[ \"tDiffuse\" ].value = this.accumulateRenderTarget.texture;\n\n\t\trenderer.setClearColor( this.clearColor, this.clearAlpha );\n\t\trenderer.renderPass( this.overMaterial, this.renderToScreen ? null : readBuffer, this.clear );\n\n\t\trenderer.autoClear = autoClear;\n\t\trenderer.setClearColor( oldClearColor, oldClearAlpha );\n\t}\n\n} );\n\n// These jitter vectors are specified in integers because it is easier.\n// I am assuming a [-8,8) integer grid, but it needs to be mapped onto [-0.5,0.5)\n// before being used, thus these integers need to be scaled by 1/16.\n//\n// Sample patterns reference: https://msdn.microsoft.com/en-us/library/windows/desktop/ff476218%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396\nTHREE.SSAARenderPass.JitterVectors = [\n\t[\n\t\t[ 0, 0 ]\n\t],\n\t[\n\t\t[ 4, 4 ], [ - 4, - 4 ]\n\t],\n\t[\n\t\t[ - 2, - 6 ], [ 6, - 2 ], [ - 6, 2 ], [ 2, 6 ]\n\t],\n\t[\n\t\t[ 1, - 3 ], [ - 1, 3 ], [ 5, 1 ], [ - 3, - 5 ],\n\t\t[ - 5, 5 ], [ - 7, - 1 ], [ 3, 7 ], [ 7, - 7 ]\n\t],\n\t[\n\t\t[ 1, 1 ], [ - 1, - 3 ], [ - 3, 2 ], [ 4, - 1 ],\n\t\t[ - 5, - 2 ], [ 2, 5 ], [ 5, 3 ], [ 3, - 5 ],\n\t\t[ - 2, 6 ], [ 0, - 7 ], [ - 4, - 6 ], [ - 6, 4 ],\n\t\t[ - 8, 0 ], [ 7, - 4 ], [ 6, 7 ], [ - 7, - 8 ]\n\t],\n\t[\n\t\t[ - 4, - 7 ], [ - 7, - 5 ], [ - 3, - 5 ], [ - 5, - 4 ],\n\t\t[ - 1, - 4 ], [ - 2, - 2 ], [ - 6, - 1 ], [ - 4, 0 ],\n\t\t[ - 7, 1 ], [ - 1, 2 ], [ - 6, 3 ], [ - 3, 3 ],\n\t\t[ - 7, 6 ], [ - 3, 6 ], [ - 5, 7 ], [ - 1, 7 ],\n\t\t[ 5, - 7 ], [ 1, - 6 ], [ 6, - 5 ], [ 4, - 4 ],\n\t\t[ 2, - 3 ], [ 7, - 2 ], [ 1, - 1 ], [ 4, - 1 ],\n\t\t[ 2, 1 ], [ 6, 2 ], [ 0, 4 ], [ 4, 4 ],\n\t\t[ 2, 5 ], [ 7, 5 ], [ 5, 6 ], [ 3, 7 ]\n\t]\n];\n\n// File:examples/js/postprocessing/ClearPass.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.ClearPass = function ( clearColor, clearAlpha ) {\n\n\tTHREE.Pass.call( this );\n\n\tthis.needsSwap = false;\n\n\tthis.clearColor = ( clearColor !== undefined ) ? clearColor : 0x000000;\n\tthis.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;\n\n};\n\nTHREE.ClearPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: THREE.ClearPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tvar oldClearColor, oldClearAlpha;\n\n\t\tif ( this.clearColor !== undefined ) {\n\n\t\t\toldClearColor = renderer.getClearColor().getHex();\n\t\t\toldClearAlpha = renderer.getClearAlpha();\n\n\t\t\trenderer.setClearColor( this.clearColor, this.clearAlpha );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( this.renderToScreen ? null : readBuffer );\n\t\trenderer.clear();\n\n\t\tif ( this.clearColor ) {\n\n\t\t\trenderer.setClearColor( oldClearColor, oldClearAlpha );\n\n\t\t}\n\n\t}\n\n} );\n\n// File:examples/js/postprocessing/TexturePass.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.TexturePass = function ( map, opacity ) {\n\n\tTHREE.Pass.call( this );\n\n\tif ( THREE.CopyShader === undefined )\n\t\tconsole.error( \"THREE.TexturePass relies on THREE.CopyShader\" );\n\n\tvar shader = THREE.CopyShader;\n\n\tthis.map = map;\n\tthis.opacity = ( opacity !== undefined ) ? opacity : 1.0;\n\n\tthis.uniforms = THREE.UniformsUtils.clone( shader.uniforms );\n\n\tthis.material = new THREE.ShaderMaterial( {\n\n\t\tuniforms: this.uniforms,\n\t\tvertexShader: shader.vertexShader,\n\t\tfragmentShader: shader.fragmentShader,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n\tthis.needsSwap = false;\n\n\tthis.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tthis.scene  = new THREE.Scene();\n\n\tthis.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );\n\tthis.quad.frustumCulled = false; // Avoid getting clipped\n\tthis.scene.add( this.quad );\n\n};\n\nTHREE.TexturePass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: THREE.TexturePass,\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tvar oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tthis.quad.material = this.material;\n\n\t\tthis.uniforms[ \"opacity\" ].value = this.opacity;\n\t\tthis.uniforms[ \"tDiffuse\" ].value = this.map;\n\t\tthis.material.transparent = ( this.opacity < 1.0 );\n\n\t\trenderer.render( this.scene, this.camera, this.renderToScreen ? null : readBuffer, this.clear );\n\n\t\trenderer.autoClear = oldAutoClear;\n\t}\n\n} );\n\n// File:examples/js/postprocessing/CubeTexturePass.js\n\n/**\n * @author bhouston / http://clara.io/\n */\n\nTHREE.CubeTexturePass = function ( camera, envMap, opacity ) {\n\n\tTHREE.Pass.call( this );\n\n\tthis.camera = camera;\n\n\tthis.needsSwap = false;\n\n\tthis.cubeMaterial = new THREE.MeshCubeMaterial();\n\n\tthis.cubeMesh = new THREE.Mesh(\n\t\tnew THREE.BoxBufferGeometry( 10, 10, 10 ),\n\t\tthis.cubeMaterial\n\t);\n\n\tthis.envMap = envMap;\n\tthis.envMapIntensity = 1.0;\n\tthis.opacity = ( opacity !== undefined ) ? opacity : 1.0;\n\tthis.roughness = 0.0;\n\n\tthis.cubeScene = new THREE.Scene();\n\tthis.cubeCamera = new THREE.PerspectiveCamera();\n\tthis.cubeScene.add( this.cubeMesh );\n\n};\n\nTHREE.CubeTexturePass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: THREE.CubeTexturePass,\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tvar oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tthis.cubeCamera.projectionMatrix.copy( this.camera.projectionMatrix );\n\t\tthis.cubeCamera.quaternion.setFromRotationMatrix( this.camera.matrixWorld );\n\n\t\tif( this.cubeMaterial.envMap != this.envMap ) {\n\t\t\tthis.cubeMaterial.envMap = this.envMap;\n\t\t\tthis.cubeMaterial.needsUpdate = true;\n\t\t}\n\t\tthis.cubeMaterial.envMapIntensity = this.envMapIntensity;\n\t\tthis.cubeMaterial.roughness = this.roughness;\n\t\tthis.cubeMaterial.opacity = this.opacity;\n\t\tthis.cubeMaterial.transparent = ( this.opacity < 1.0 );\n\n\t\trenderer.render( this.cubeScene, this.cubeCamera, this.renderToScreen ? null : readBuffer, this.clear );\n\n\t\trenderer.autoClear = oldAutoClear;\n\n\t}\n\n} );\n\n// File:examples/js/postprocessing/DofPass.js\n\n/**\n * @author spidersharma03 / http://eduperiment.com/\n */\n\nTHREE.DofPass = function (resolution, renderScene, renderCamera) {\n\n\tTHREE.Pass.call( this );\n\n\tvar resolution = ( resolution !== undefined ) ? resolution : new THREE.Vector2(256, 256);\n\t// render targets\n\tthis.downSampleRes = new THREE.Vector2(Math.round(resolution.x/2), Math.round(resolution.y/2));\n\n\tvar pars = { minFilter: THREE.NearestFilter, magFilter: THREE.NearestFilter, type: THREE.HalfFloatType, format: THREE.RGBAFormat };\n\n\tthis.renderTargetColorDownSample = new THREE.WebGLRenderTarget( this.downSampleRes.x, this.downSampleRes.y, pars );\n\tthis.renderTargetColorDownSample.texture.generateMipmaps = false;\n\n\tthis.renderTargetCoCDownSample = new THREE.WebGLRenderTarget( this.downSampleRes.x, this.downSampleRes.y, pars );\n\tthis.renderTargetCoCDownSample.texture.generateMipmaps = false;\n\n\tthis.renderTargetBlurTemp = new THREE.WebGLRenderTarget( this.downSampleRes.x, this.downSampleRes.y, pars );\n\tthis.renderTargetBlurTemp.texture.generateMipmaps = false;\n\n\tvar pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat };\n\n\tthis.renderTargetDofBlur = new THREE.WebGLRenderTarget( this.downSampleRes.x, this.downSampleRes.y, pars );\n\tthis.renderTargetDofBlur.texture.generateMipmaps = false;\n\tthis.renderTargetDofBlurTemp = new THREE.WebGLRenderTarget( this.downSampleRes.x, this.downSampleRes.y, pars );\n\tthis.renderTargetDofBlurTemp.texture.generateMipmaps = false;\n\n\tthis.renderTargetDofCombine = new THREE.WebGLRenderTarget( resolution.x, resolution.y, pars );\n\tthis.renderTargetDofCombine.texture.generateMipmaps = false;\n\n\tthis.needsSwap = false;\n\tthis.oldClearColor = new THREE.Color();\n\tthis.oldClearAlpha = 1;\n\n\tthis.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tthis.scene  = new THREE.Scene();\n\n\tthis.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );\n\tthis.scene.add( this.quad );\n\n\tthis.focalDistance = 10.0;\n\tthis.cameraNear = 0.1;\n\tthis.cameraFar = 100;\n\tthis.NearFarBlurScale = new THREE.Vector2(0.1, 0.5);\n\n\tthis.downSamplingMaterial = this.getColorDownSamplingMaterial();\n\n\tthis.cocMaterial = this.getCoCMaterial();\n\tthis.cocMaterial.uniforms[ \"NearFarBlurScale\" ].value = this.NearFarBlurScale;\n\tthis.cocMaterial.uniforms[ \"cameraNearFar\" ].value = new THREE.Vector2(renderCamera.near, renderCamera.far);\n\tthis.cocMaterial.uniforms[ \"focalDistance\" ].value = this.focalDistance;\n\n\tthis.dilateNearCocMaterial = this.getDilateNearCocMaterial();\n\tthis.dilateNearCocMaterial.uniforms[ \"NearFarBlurScale\" ].value = this.NearFarBlurScale;\n\n\tthis.dofBlurType = 1;\n\tthis.dofBlurMaterial = (this.dofBlurType === 0) ? this.getDofBlurCircularMaterial() : this.getDofBlurSeperableMaterial();\n\n\n\tthis.dofCombineMaterial = this.getDofCombineMaterial();\n\tthis.dofCombineMaterial.uniforms[ \"NearFarBlurScale\" ].value = this.NearFarBlurScale;\n\tthis.dofCombineMaterial.uniforms[ \"cameraNearFar\" ].value = new THREE.Vector2(renderCamera.near, renderCamera.far);\n\tthis.dofCombineMaterial.uniforms[ \"focalDistance\" ].value = this.focalDistance;\n\n\tif ( THREE.CopyShader === undefined )\n\t\tconsole.error( \"THREE.DofPass relies on THREE.CopyShader\" );\n\n\tvar copyShader = THREE.CopyShader;\n\n\tthis.copyUniforms = THREE.UniformsUtils.clone( copyShader.uniforms );\n\tthis.materialCopy = new THREE.ShaderMaterial( {\n\n\t\tuniforms: this.copyUniforms,\n\t\tvertexShader: copyShader.vertexShader,\n\t\tfragmentShader: copyShader.fragmentShader,\n\t} );\n\n\tthis.depthMaterial = new THREE.MeshDepthMaterial();\n\tthis.depthMaterial.side = THREE.DoubleSide;\n\tthis.depthMaterial.depthPacking = THREE.RGBADepthPacking;\n\tthis.depthMaterial.blending = THREE.NoBlending;\n\tthis.depthRenderTarget = new THREE.WebGLRenderTarget( resolution.x, resolution.y,\n\t\t\t\t\t{ minFilter: THREE.NearesFilter, magFilter: THREE.NearesFilter, format: THREE.RGBAFormat } );\n\tthis.renderScene = renderScene;\n\tthis.renderCamera = renderCamera;\n};\n\nTHREE.DofPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: THREE.DofPass,\n\n\tsetSize: function(width, height) {\n\t\tthis.downSampleRes = new THREE.Vector2(Math.round(width/2), Math.round(height/2));\n\n\n\t\tvar resx = this.downSampleRes.x;\n\t\tvar resy = this.downSampleRes.y;\n\n\t\tthis.renderTargetColorDownSample.setSize( resx, resy );\n\t\tthis.renderTargetCoCDownSample.setSize( resx, resy );\n\t\tthis.renderTargetBlurTemp.setSize( resx, resy );\n\t\tthis.renderTargetDofBlur.setSize( resx, resy );\n\t\tthis.renderTargetDofBlurTemp.setSize( resx, resy );\n\t\tthis.renderTargetDofCombine.setSize( width, height );\n\t\tthis.depthRenderTarget.setSize( width, height );\n\t},\n\n\tchangeBlurType: function(blurType) {\n\t\tthis.dofBlurType = blurType;\n\t\tthis.dofBlurMaterial = (this.dofBlurType === 0) ? this.getDofBlurCircularMaterial() : this.getDofBlurSeperableMaterial();\t},\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\n\t\tthis.dilateNearCocMaterial.uniforms[ \"texSize\" ].value = this.downSampleRes;\n\t\tthis.dofBlurMaterial.uniforms[ \"texSize\" ].value = this.downSampleRes;\n\t\tthis.dofCombineMaterial.uniforms[ \"texSize\" ].value = this.downSampleRes;\n\n\t\tthis.cocMaterial.uniforms[ \"focalDistance\" ].value = this.focalDistance;\n\t\tthis.cocMaterial.uniforms[ \"cameraNearFar\" ].value.x = this.cameraNear;\n\t\tthis.cocMaterial.uniforms[ \"cameraNearFar\" ].value.y = this.cameraFar;\n\n\t\tthis.dofCombineMaterial.uniforms[ \"focalDistance\" ].value = this.focalDistance;\n\t\tthis.dofCombineMaterial.uniforms[ \"cameraNearFar\" ].value.x = this.cameraNear;\n\t\tthis.dofCombineMaterial.uniforms[ \"cameraNearFar\" ].value.y = this.cameraFar;\n\n\n\t\tthis.oldClearColor.copy( renderer.getClearColor() );\n\t\tthis.oldClearAlpha = renderer.getClearAlpha();\n\t\tvar oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = true;\n\n\t\tif ( maskActive ) renderer.context.disable( renderer.context.STENCIL_TEST );\n\n\t\t// Render Scene into depth buffer. This is temporary and should not be done here.\n\t\tthis.renderScene.overrideMaterial = this.depthMaterial;\n\t\trenderer.setClearColor(0xffffff, 1);\n\t\trenderer.render( this.renderScene, this.renderCamera, this.depthRenderTarget );\n\t\tthis.renderScene.overrideMaterial = null;\n\n\t\t// 1. Downsample the Original texture, and store coc in the alpha channel\n\t\tthis.quad.material = this.downSamplingMaterial;\n\t\tthis.downSamplingMaterial.uniforms[ \"colorTexture\" ].value = readBuffer.texture;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetColorDownSample );\n\n\t\tthis.quad.material = this.cocMaterial;\n\t\tthis.cocMaterial.uniforms[ \"depthTexture\" ].value = this.depthRenderTarget.texture;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetCoCDownSample );\n\n\t\t// 2. Dilate/Blur Near field coc\n\t\tthis.quad.material = this.dilateNearCocMaterial;\n\t\tthis.dilateNearCocMaterial.uniforms[ \"cocTexture\" ].value = this.renderTargetCoCDownSample.texture;\n\t\tthis.dilateNearCocMaterial.uniforms[ \"depthTexture\" ].value = this.depthRenderTarget.texture;\n\t\tthis.dilateNearCocMaterial.uniforms[ \"direction\" ].value = new THREE.Vector2(1, 0);\n\t\trenderer.render( this.scene, this.camera, this.renderTargetBlurTemp );\n\t\tthis.dilateNearCocMaterial.uniforms[ \"cocTexture\" ].value = this.renderTargetBlurTemp.texture;\n\t\tthis.dilateNearCocMaterial.uniforms[ \"direction\" ].value = new THREE.Vector2(0, 1);\n\t\trenderer.render( this.scene, this.camera, this.renderTargetCoCDownSample );\n\n\t\t// 3. Blur Dof\n\t\tif( this.dofBlurType === 0 ){\n\t\t\tthis.quad.material = this.dofBlurMaterial;\n\t\t\tthis.dofBlurMaterial.uniforms[ \"cocTexture\" ].value = this.renderTargetCoCDownSample.texture;\n\t\t\tthis.dofBlurMaterial.uniforms[ \"colorTexture\" ].value = this.renderTargetDownSample.texture;\n\t\t\tthis.dofBlurMaterial.uniforms[ \"depthTexture\" ].value = this.depthRenderTarget.texture;\n\t\t\trenderer.render( this.scene, this.camera, this.renderTargetDofBlurTemp );\n\t\t}\n\t\telse {\n\t\t\tthis.quad.material = this.dofBlurMaterial;\n\t\t\tthis.dofBlurMaterial.uniforms[ \"cocTexture\" ].value = this.renderTargetCoCDownSample.texture;\n\t\t\tthis.dofBlurMaterial.uniforms[ \"colorTexture\" ].value = this.renderTargetColorDownSample.texture;\n\t\t\tthis.dofBlurMaterial.uniforms[ \"direction\" ].value = new THREE.Vector2(1, 0);\n\t\t\trenderer.render( this.scene, this.camera, this.renderTargetDofBlur );\n\t\t\tthis.dofBlurMaterial.uniforms[ \"colorTexture\" ].value = this.renderTargetDofBlur.texture;\n\t\t\tthis.dofBlurMaterial.uniforms[ \"direction\" ].value = new THREE.Vector2(0, 1);\n\t\t\trenderer.render( this.scene, this.camera, this.renderTargetDofBlurTemp );\n\t\t}\n\t\t// 4. Dof Combine\n\t\tthis.quad.material = this.dofCombineMaterial;\n\t\tthis.dofCombineMaterial.uniforms[ \"cocTexture\" ].value = this.renderTargetCoCDownSample.texture;\n\t\tthis.dofCombineMaterial.uniforms[ \"colorTexture\" ].value = readBuffer.texture;\n\t\tthis.dofCombineMaterial.uniforms[ \"depthTexture\" ].value = this.depthRenderTarget.texture;\n\t\tthis.dofCombineMaterial.uniforms[ \"blurTexture\" ].value = this.renderTargetDofBlurTemp.texture;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetDofCombine );\n\n\t\t// Copy Pass\n\t\tthis.quad.material = this.materialCopy;\n\t\tthis.copyUniforms[ \"tDiffuse\" ].value = this.renderTargetDofCombine.texture;\n\n\t\tif ( maskActive ) renderer.context.enable( renderer.context.STENCIL_TEST );\n\t\trenderer.render( this.scene, this.camera, readBuffer );\n\n\t\trenderer.setClearColor( this.oldClearColor, this.oldClearAlpha );\n\t\trenderer.autoClear = oldAutoClear;\n\t},\n\n\tgetColorDownSamplingMaterial: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"colorTexture\": { value: null },\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\n\\\n\t\t\t\t#include <packing>\\n\\\n\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\tuniform sampler2D colorTexture;\\n\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tgl_FragColor = texture2D(colorTexture, vUv);\\n\\\n\t\t\t\t}\"\n\t\t} );\n\t},\n\n\tgetCoCMaterial: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"depthTexture\": { value: null },\n\t\t\t\t\"NearFarBlurScale\": { value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"cameraNearFar\": { value: new THREE.Vector2( 0.1, 100 ) },\n\t\t\t\t\"focalDistance\": { value: 1.0 }\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\n\\\n\t\t\t\t#include <packing>\\n\\\n\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\tuniform sampler2D depthTexture;\\n\\\n\t\t\t\tuniform vec2 NearFarBlurScale;\\\n\t\t\t\tuniform vec2 cameraNearFar;\\\n\t\t\t\tuniform float focalDistance;\\\n\t\t\t\tconst float MAXIMUM_BLUR_SIZE = 8.0;\\\n\t\t\t\t\\\n\t\t\t\tfloat computeCoc() {\\\n\t\t\t\t\tvec4 packDepth = texture2D(depthTexture, vUv).rgba;\\\n\t\t\t\t\tif(packDepth.x == 1.0) return max(NearFarBlurScale.x, NearFarBlurScale.y);\\\n\t\t\t\t\t\tfloat depth = unpackRGBAToDepth(packDepth);\\\n\t\t\t\t\t\tdepth = -perspectiveDepthToViewZ(depth, cameraNearFar.x, cameraNearFar.y);\\\n\t\t\t\t\t\tfloat coc = (depth - focalDistance)/depth;\\\n\t\t\t\t\treturn (coc > 0.0 ? coc * NearFarBlurScale.y : coc * NearFarBlurScale.x);\\\n\t\t\t\t}\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, computeCoc());\\n\\\n\t\t\t\t}\"\n\t\t} );\n\t},\n\n\n\tgetDilateNearCocMaterial: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"cocTexture\": { value: null },\n\t\t\t\t\"depthTexture\": { value: null },\n\t\t\t\t\"NearFarBlurScale\": { value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"texSize\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"direction\": \t\t\t\t{ value: new THREE.Vector2( 1, 0 ) },\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\n\\\n\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\tuniform sampler2D cocTexture;\\n\\\n\t\t\t\tuniform sampler2D depthTexture;\\n\\\n\t\t\t\tuniform vec2 direction;\\\n\t\t\t\tuniform vec2 texSize;\\\n\t\t\t\tuniform vec2 NearFarBlurScale;\\\n\t\t\t\tconst float MAXIMUM_BLUR_SIZE = 8.0;\\\n\t\t\t\t\\\n\t\t\t\tfloat expandNear(const in vec2 offset, const in bool isBackground) {\\\n\t\t\t\t\tfloat coc = 0.0;\\\n\t\t\t\t\tvec2 sampleOffsets = MAXIMUM_BLUR_SIZE * offset / 5.0;\\\n\t\t\t\t\tfloat coc0 = texture2D(cocTexture, vUv).a;\\\n\t\t\t\t\tfloat coc1 = texture2D(cocTexture, vUv - 5.0 * sampleOffsets).a;\\\n\t\t\t\t\tfloat coc2 = texture2D(cocTexture, vUv - 4.0 * sampleOffsets).a;\\\n\t\t\t\t\tfloat coc3 = texture2D(cocTexture, vUv - 3.0 * sampleOffsets).a;\\\n\t\t\t\t\tfloat coc4 = texture2D(cocTexture, vUv - 2.0 * sampleOffsets).a;\\\n\t\t\t\t\tfloat coc5 = texture2D(cocTexture, vUv - 1.0 * sampleOffsets).a;\\\n\t\t\t\t\tfloat coc6 = texture2D(cocTexture, vUv + 1.0 * sampleOffsets).a;\\\n\t\t\t\t\tfloat coc7 = texture2D(cocTexture, vUv + 2.0 * sampleOffsets).a;\\\n\t\t\t\t\tfloat coc8 = texture2D(cocTexture, vUv + 3.0 * sampleOffsets).a;\\\n\t\t\t\t\tfloat coc9 = texture2D(cocTexture, vUv + 4.0 * sampleOffsets).a;\\\n\t\t\t\t\tfloat coc10 = texture2D(cocTexture, vUv + 5.0 * sampleOffsets).a;\\\n\t\t\t\t\t\t\\\n\t\t\t\t\tif(isBackground){\\\n\t\t\t\t\t\tcoc = abs(coc0) * 0.095474 + \\\n\t\t\t\t\t\t(abs(coc1) + abs(coc10)) * 0.084264 + \\\n\t\t\t\t\t\t(abs(coc2) + abs(coc9)) * 0.088139 + \\\n\t\t\t\t\t\t(abs(coc3) + abs(coc8)) * 0.091276 + \\\n\t\t\t\t\t\t(abs(coc4) + abs(coc7)) * 0.093585 + \\\n\t\t\t\t\t\t(abs(coc5) + abs(coc6)) * 0.094998;\\\n\t\t\t\t\t} else {\\\n\t\t\t\t\t\tcoc = min(coc0, 0.0);\\\n\t\t\t\t\t\tcoc = min(coc1 * 0.3, coc);\\\n\t\t\t\t\t\tcoc = min(coc2 * 0.5, coc);\\\n\t\t\t\t\t\tcoc = min(coc3 * 0.75, coc);\\\n\t\t\t\t\t\tcoc = min(coc4 * 0.8, coc);\\\n\t\t\t\t\t\tcoc = min(coc5 * 0.95, coc);\\\n\t\t\t\t\t\tcoc = min(coc6 * 0.95, coc);\\\n\t\t\t\t\t\tcoc = min(coc7 * 0.8, coc);\\\n\t\t\t\t\t\tcoc = min(coc8 * 0.75, coc);\\\n\t\t\t\t\t\tcoc = min(coc9 * 0.5, coc);\\\n\t\t\t\t\t\tcoc = min(coc10 * 0.3, coc);\\\n\t\t\t\t\t\tif(abs(coc0) > abs(coc))\\\n\t\t\t\t\t\t\tcoc = coc0;\\\n\t\t\t\t\t}\\\n\t\t\t\t\treturn coc;\\\n\t\t\t\t}\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvec2 offset = direction/texSize;\\\n\t\t\t\t\tfloat coc = expandNear(offset, texture2D(depthTexture, vUv).x == 1.0);\\\n\t\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, coc);\\n\\\n\t\t\t\t}\"\n\t\t} );\n\t},\n\n\tgetDofBlurCircularMaterial: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"colorTexture\": { value: null },\n\t\t\t\t\"cocTexture\": { value: null },\n\t\t\t\t\"depthTexture\": { value: null },\n\t\t\t\t\"texSize\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\n\\\n\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\tuniform sampler2D colorTexture;\\n\\\n\t\t\t\tuniform sampler2D cocTexture;\\n\\\n\t\t\t\tuniform sampler2D depthTexture;\\n\\\n\t\t\t\tuniform vec2 texSize;\\\n\t\t\t\tconst float MAXIMUM_BLUR_SIZE = 8.0;\\\n\t\t\t\t\\\n\t\t\t\tvec4 CircularBlur() {\\\n\t\t\t\t\t\\\n\t\t\t\t\tconst int NUM_SAMPLES = 16;\\\n\t\t\t\t\tvec2 poisson_disk_samples[NUM_SAMPLES];\\\n\t\t\t\t\tpoisson_disk_samples[0] = vec2(-0.399691779231, 0.728591545584);\\\n\t\t\t\t\tpoisson_disk_samples[1] = vec2(-0.48622557676, -0.84016533712);\\\n\t\t\t\t\tpoisson_disk_samples[2] = vec2(0.770309468987, -0.24906070432);\\\n\t\t\t\t\tpoisson_disk_samples[3] = vec2(0.556596796154, 0.820359876432);\\\n\t\t\t\t\tpoisson_disk_samples[4] = vec2(-0.933902004071, 0.0600539051593);\\\n\t\t\t\t\tpoisson_disk_samples[5] = vec2(0.330144964342, 0.207477293384);\\\n\t\t\t\t\tpoisson_disk_samples[6] = vec2(0.289013230975, -0.686749271417);\\\n\t\t\t\t\tpoisson_disk_samples[7] = vec2(-0.0832470893559, -0.187351643125);\\\n\t\t\t\t\tpoisson_disk_samples[8] = vec2(-0.296314525615, 0.254474834305);\\\n\t\t\t\t\tpoisson_disk_samples[9] = vec2(-0.850977666059, 0.484642744689);\\\n\t\t\t\t\tpoisson_disk_samples[10] = vec2(0.829287915319, 0.2345063545);\\\n\t\t\t\t\tpoisson_disk_samples[11] = vec2(-0.773042143899, -0.543741521254);\\\n\t\t\t\t\tpoisson_disk_samples[12] = vec2(0.0561133030864, 0.928419742597);\\\n\t\t\t\t\tpoisson_disk_samples[13] = vec2(-0.205799249508, -0.562072714492);\\\n\t\t\t\t\tpoisson_disk_samples[14] = vec2(-0.526991665882, -0.193690188118);\\\n\t\t\t\t\tpoisson_disk_samples[15] = vec2(-0.051789270667, -0.935374050821);\\\n\t\t\t\t\t\t\\\n\t\t\t\t\tvec4 cocr = texture2D(cocTexture, vUv);\\\n\t\t\t\t\t\t\\\n\t\t\t\t\tfloat blurDist = MAXIMUM_BLUR_SIZE * coc.a;\\\n\t\t\t\t\t\t\\\n\t\t\t\t\tfloat rnd = PI2 * rand( vUv );\\\n\t\t\t\t\tfloat costheta = cos(rnd);\\\n\t\t\t\t\tfloat sintheta = sin(rnd);\\\n\t\t\t\t\tvec4 rotationMatrix = vec4(costheta, -sintheta, sintheta, costheta);\\\n\t\t\t\t\t\t\\\n\t\t\t\t\tvec3 colorSum = vec3(0.0);\\\n\t\t\t\t\tfloat weightSum = 0.0;\\\n\t\t\t\t\t\t\\\n\t\t\t\t\tfor (int i = 0; i < NUM_SAMPLES; i++) {\\\n\t\t\t\t\t\tvec2 ofs = poisson_disk_samples[i];\\\n\t\t\t\t\t\tofs = vec2(dot(ofs, rotationMatrix.xy), dot(ofs, rotationMatrix.zw) );\\\n\t\t\t\t\t\tvec2 texcoord = vUv + blurDist * ofs / texSize.xy;\\\n\t\t\t\t\t\tvec4 sample = texture2D(colorTexture, texcoord);\\\n\t\t\t\t\t\tfloat cocWeight = abs(sample.a);\\\n\t\t\t\t\t\tcocWeight *= cocWeight * cocWeight;\\\n\t\t\t\t\t\tcolorSum += sample.rgb * cocWeight;\\\n\t\t\t\t\t\tweightSum += cocWeight;\\\n\t\t\t\t\t}\\\n\t\t\t\t\t\t\\\n\t\t\t\t\tcolorSum /= weightSum;\\\n\t\t\t\t\t\t\\\n\t\t\t\t\treturn vec4(colorSum, 1.0);\\\n\t\t\t\t}\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tgl_FragColor = CircularBlur();\\n\\\n\t\t\t\t}\"\n\t\t} );\n\t},\n\n\tgetDofBlurSeperableMaterial: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"cocTexture\":   { value: null },\n\t\t\t\t\"colorTexture\": { value: null },\n\t\t\t\t\"texSize\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"direction\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\n\\\n\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\tuniform sampler2D cocTexture;\\n\\\n\t\t\t\tuniform sampler2D colorTexture;\\n\\\n\t\t\t\tuniform vec2 texSize;\\\n\t\t\t\tuniform vec2 direction;\\\n\t\t\t\tconst float MAXIMUM_BLUR_SIZE = 8.0;\\\n\t\t\t\t\\\n\t\t\t\tconst float SIGMA = 5.0;\\\n\t\t\t\tconst int NUM_SAMPLES = 4;\\\n\t\t\t\tfloat normpdf(in float x, in float sigma)\\\n\t\t\t\t{\\\n\t\t\t\t\treturn 0.39894*exp(-0.5*x*x/(sigma*sigma))/sigma;\\\n\t\t\t\t}\\\n\t\t\t\t\\\n\t\t\t\tvec4 weightedBlur() { \\\n\t\t\t\t\tfloat cocIn = texture2D(cocTexture, vUv).a;\\\n\t\t\t\t\tfloat kernelRadius = MAXIMUM_BLUR_SIZE * cocIn;\\\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\\\n\t\t\t\t\tcocIn *= cocIn * cocIn;\\\n\t\t\t\t\tfloat centreSpaceWeight = normpdf(0.0, SIGMA) * abs(cocIn);\\\n\t\t\t\t\tfloat weightSum = centreSpaceWeight;\\\n\t\t\t\t\tvec4 centreSample = texture2D(colorTexture, vUv);\\\n\t\t\t\t\tvec4 diffuseSum = centreSample * weightSum;\\\n\t\t\t\t\tvec2 delta = invSize * kernelRadius/float(NUM_SAMPLES);\\\n\t\t\t\t\tfor( int i = 1; i <= NUM_SAMPLES; i ++ ) {\\\n\t\t\t\t\t\t\tfloat spaceWeight = normpdf(float(i), SIGMA);\\\n\t\t\t\t\t\t\tvec2 texcoord = direction * delta * float(i);\\\n\t\t\t\t\t\t\tvec4 rightSample = texture2D( colorTexture, vUv + texcoord);\\\n\t\t\t\t\t\t\tvec4 leftSample = texture2D( colorTexture, vUv - texcoord);\\\n\t\t\t\t\t\t\tfloat leftCocWeight = abs(texture2D( cocTexture, vUv - texcoord).a);\\\n\t\t\t\t\t\t\tfloat rightCocWeight = abs(texture2D( cocTexture, vUv + texcoord).a);\\\n\t\t\t\t\t\t\tleftCocWeight *= leftCocWeight * leftCocWeight;\\\n\t\t\t\t\t\t\trightCocWeight *= rightCocWeight * rightCocWeight;\\\n\t\t\t\t\t\t\tdiffuseSum += ( (leftSample * leftCocWeight) + (rightSample * rightCocWeight) ) * spaceWeight;\\\n\t\t\t\t\t\t\tweightSum += (spaceWeight * (leftCocWeight + rightCocWeight));\\\n\t\t\t\t\t}\\\n\t\t\t\t  return diffuseSum/weightSum;\\\n\t\t\t\t}\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tgl_FragColor = weightedBlur();\\n\\\n\t\t\t\t}\"\n\t\t} );\n\t},\n\n\tgetDofCombineMaterial: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"colorTexture\": { value: null },\n\t\t\t\t\"blurTexture\": { value: null },\n\t\t\t\t\"cocTexture\": { value: null },\n\t\t\t\t\"depthTexture\": { value: null },\n\t\t\t\t\"NearFarBlurScale\": { value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"texSize\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"cameraNearFar\": { value: new THREE.Vector2( 0.1, 100 ) },\n\t\t\t\t\"focalDistance\" : {value: 20.0 }\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\n\\\n\t\t\t\t#include <packing>\\n\\\n\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\tuniform sampler2D colorTexture;\\n\\\n\t\t\t\tuniform sampler2D blurTexture;\\n\\\n\t\t\t\tuniform sampler2D cocTexture;\\n\\\n\t\t\t\tuniform sampler2D depthTexture;\\n\\\n\t\t\t\tuniform vec2 texSize;\\\n\t\t\t\tuniform vec2 NearFarBlurScale;\\\n\t\t\t\tuniform vec2 cameraNearFar;\\\n\t\t\t\tuniform float focalDistance;\\\n\t\t\t\t\\\n\t\t\t\tfloat computeCoc() {\\\n\t\t\t\t\tvec4 packedDepth = texture2D(depthTexture, vUv);\\\n\t\t\t\t\tif(packedDepth.x == 1.0) return max(NearFarBlurScale.x, NearFarBlurScale.y);\\\n\t\t\t\t\t\tfloat depth = unpackRGBAToDepth(packedDepth);\\\n\t\t\t\t\t\tdepth = -perspectiveDepthToViewZ(depth, cameraNearFar.x, cameraNearFar.y);\\\n\t\t\t\t\t\tfloat coc = (depth - focalDistance)/depth;\\\n\t\t\t\t\treturn (coc > 0.0 ? coc * NearFarBlurScale.y : coc * NearFarBlurScale.x);\\\n\t\t\t\t}\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvec4 blur = texture2D(blurTexture, vUv);\\\n\t\t\t\t\tblur += texture2D(blurTexture, vUv + vec2(1.5, 0.5) / texSize);\\\n\t\t\t\t\tblur += texture2D(blurTexture, vUv + vec2(-0.5, 1.5) / texSize);\\\n\t\t\t\t\tblur += texture2D(blurTexture, vUv + vec2(-1.5, -0.5) / texSize);\\\n\t\t\t\t\tblur += texture2D(blurTexture, vUv + vec2(0.5, -1.5) / texSize);\\\n\t\t\t\t\tblur /= 5.0;\\\n\t\t\t\t\tfloat coc = abs(min(texture2D(cocTexture, vUv).a, computeCoc()));\\\n\t\t\t\t\tcoc = clamp(coc * coc * 8.0, 0.0, 1.0);\\\n\t\t\t\t\tvec4 color = mix(texture2D(colorTexture, vUv), blur, vec4(coc));\\\n\t\t\t\t\tgl_FragColor = color;\\n\\\n\t\t\t\t}\"\n\t\t} );\n\t}\n\n});\n\n// File:examples/js/postprocessing/UnrealBloomPass.js\n\n/**\n * @author spidersharma / http://eduperiment.com/\n Inspired from Unreal Engine::\n https://docs.unrealengine.com/latest/INT/Engine/Rendering/PostProcessEffects/Bloom/\n */\n\nTHREE.UnrealBloomPass = function ( resolution, strength, radius, threshold ) {\n\n\tTHREE.Pass.call( this );\n\n\tthis.strength = ( strength !== undefined ) ? strength : 1;\n\tthis.radius = radius;\n\tthis.threshold = threshold;\n\tthis.resolution = ( resolution !== undefined ) ? new THREE.Vector2(resolution.x, resolution.y) : new THREE.Vector2(256, 256);\n\n\t// render targets\n\tvar pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat };\n\tthis.renderTargetsHorizontal = [];\n\tthis.renderTargetsVertical = [];\n\tthis.nMips = 5;\n\tvar resx = Math.round(this.resolution.x/2);\n\tvar resy = Math.round(this.resolution.y/2);\n\n\tthis.renderTargetBright = new THREE.WebGLRenderTarget( resx, resy, pars );\n\tthis.renderTargetBright.texture.name = \"UnrealBloomPass.bright\";\n\tthis.renderTargetBright.texture.generateMipmaps = false;\n\n\tfor( var i=0; i<this.nMips; i++) {\n\n\t\tvar renderTarget = new THREE.WebGLRenderTarget( resx, resy, pars );\n\n\t\trenderTarget.texture.name = \"UnrealBloomPass.h\" + i;\n\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\tthis.renderTargetsHorizontal.push(renderTarget);\n\n\t\tvar renderTarget = new THREE.WebGLRenderTarget( resx, resy, pars );\n\n\t\trenderTarget.texture.name = \"UnrealBloomPass.v\" + i;\n\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\tthis.renderTargetsVertical.push(renderTarget);\n\n\t\tresx = Math.round(resx/2);\n\n\t\tresy = Math.round(resy/2);\n\t}\n\n\t// luminosity high pass material\n\n\tif ( THREE.LuminosityHighPassShader === undefined )\n\t\tconsole.error( \"THREE.UnrealBloomPass relies on THREE.LuminosityHighPassShader\" );\n\n\tvar highPassShader = THREE.LuminosityHighPassShader;\n\tthis.highPassUniforms = THREE.UniformsUtils.clone( highPassShader.uniforms );\n\n\tthis.highPassUniforms[ \"luminosityThreshold\" ].value = threshold;\n\tthis.highPassUniforms[ \"smoothWidth\" ].value = 0.05;\n\n\tthis.materialHighPassFilter = new THREE.ShaderMaterial( {\n\t\tuniforms: this.highPassUniforms,\n\t\tvertexShader:  highPassShader.vertexShader,\n\t\tfragmentShader: highPassShader.fragmentShader,\n\t\tdefines: {}\n\t} );\n\n\t// Gaussian Blur Materials\n\tthis.separableBlurMaterials = [];\n\tvar kernelSizeArray = [3, 5, 7, 9, 11];\n\tvar resx = Math.round(this.resolution.x/2);\n\tvar resy = Math.round(this.resolution.y/2);\n\n\tfor( var i=0; i<this.nMips; i++) {\n\n\t\tthis.separableBlurMaterials.push(this.getSeperableBlurMaterial(kernelSizeArray[i]));\n\n\t\tthis.separableBlurMaterials[i].uniforms[ \"texSize\" ].value = new THREE.Vector2(resx, resy);\n\n\t\tresx = Math.round(resx/2);\n\n\t\tresy = Math.round(resy/2);\n\t}\n\n\t// Composite material\n\tthis.compositeMaterial = this.getCompositeMaterial(this.nMips);\n\tthis.compositeMaterial.uniforms[\"blurTexture1\"].value = this.renderTargetsVertical[0].texture;\n\tthis.compositeMaterial.uniforms[\"blurTexture2\"].value = this.renderTargetsVertical[1].texture;\n\tthis.compositeMaterial.uniforms[\"blurTexture3\"].value = this.renderTargetsVertical[2].texture;\n\tthis.compositeMaterial.uniforms[\"blurTexture4\"].value = this.renderTargetsVertical[3].texture;\n\tthis.compositeMaterial.uniforms[\"blurTexture5\"].value = this.renderTargetsVertical[4].texture;\n\tthis.compositeMaterial.uniforms[\"bloomStrength\"].value = strength;\n\tthis.compositeMaterial.uniforms[\"bloomRadius\"].value = 0.1;\n\tthis.compositeMaterial.needsUpdate = true;\n\n\tvar bloomFactors = [1.0, 0.8, 0.6, 0.4, 0.2];\n\tthis.compositeMaterial.uniforms[\"bloomFactors\"].value = bloomFactors;\n\tthis.bloomTintColors = [new THREE.Vector3(1,1,1), new THREE.Vector3(1,1,1), new THREE.Vector3(1,1,1)\n\t\t\t\t\t\t\t\t\t\t\t\t,new THREE.Vector3(1,1,1), new THREE.Vector3(1,1,1)];\n\tthis.compositeMaterial.uniforms[\"bloomTintColors\"].value = this.bloomTintColors;\n\n\t// copy material\n\tif ( THREE.CopyShader === undefined )\n\t\tconsole.error( \"THREE.BloomPass relies on THREE.CopyShader\" );\n\n\tvar copyShader = THREE.CopyShader;\n\n\tthis.copyUniforms = THREE.UniformsUtils.clone( copyShader.uniforms );\n\tthis.copyUniforms[ \"opacity\" ].value = 1.0;\n\n\tthis.materialCopy = new THREE.ShaderMaterial( {\n\t\tuniforms: this.copyUniforms,\n\t\tvertexShader: copyShader.vertexShader,\n\t\tfragmentShader: copyShader.fragmentShader,\n\t\tblending: THREE.AdditiveBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true\n\t} );\n\n\tthis.enabled = true;\n\tthis.needsSwap = false;\n\n\tthis.oldClearColor = new THREE.Color();\n\tthis.oldClearAlpha = 1;\n\n\tthis.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tthis.scene  = new THREE.Scene();\n\n\tthis.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );\n\tthis.quad.frustumCulled = false; // Avoid getting clipped\n\tthis.scene.add( this.quad );\n\n};\n\nTHREE.UnrealBloomPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: THREE.UnrealBloomPass,\n\n\tdispose: function() {\n\t\tfor( var i=0; i< this.renderTargetsHorizontal.length(); i++) {\n\t\t\tthis.renderTargetsHorizontal[i].dispose();\n\t\t}\n\t\tfor( var i=0; i< this.renderTargetsVertical.length(); i++) {\n\t\t\tthis.renderTargetsVertical[i].dispose();\n\t\t}\n\t\tthis.renderTargetBright.dispose();\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tvar resx = Math.round(width/2);\n\t\tvar resy = Math.round(height/2);\n\n\t\tthis.renderTargetBright.setSize(resx, resy);\n\n\t\tfor( var i=0; i<this.nMips; i++) {\n\n\t\t\tthis.renderTargetsHorizontal[i].setSize(resx, resy);\n\t\t\tthis.renderTargetsVertical[i].setSize(resx, resy);\n\n\t\t\tthis.separableBlurMaterials[i].uniforms[ \"texSize\" ].value = new THREE.Vector2(resx, resy);\n\n\t\t\tresx = Math.round(resx/2);\n\t\t\tresy = Math.round(resy/2);\n\t\t}\n\t},\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tthis.oldClearColor.copy( renderer.getClearColor() );\n\t\tthis.oldClearAlpha = renderer.getClearAlpha();\n\t\tvar oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\trenderer.setClearColor( new THREE.Color( 0, 0, 0 ), 0 );\n\n\t\tif ( maskActive ) renderer.context.disable( renderer.context.STENCIL_TEST );\n\n\t\t// 1. Extract Bright Areas\n\t\tthis.highPassUniforms[ \"tDiffuse\" ].value = readBuffer.texture;\n\t\tthis.highPassUniforms[ \"luminosityThreshold\" ].value = this.threshold;\n\t\tthis.quad.material = this.materialHighPassFilter;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetBright, true );\n\n\t\t// 2. Blur All the mips progressively\n\t\tvar inputRenderTarget = this.renderTargetBright;\n\n\t\tfor(var i=0; i<this.nMips; i++) {\n\n\t\t\tthis.quad.material = this.separableBlurMaterials[i];\n\n\t\t\tthis.separableBlurMaterials[i].uniforms[ \"colorTexture\" ].value = inputRenderTarget.texture;\n\n\t\t\tthis.separableBlurMaterials[i].uniforms[ \"direction\" ].value = THREE.UnrealBloomPass.BlurDirectionX;\n\n\t\t\trenderer.render( this.scene, this.camera, this.renderTargetsHorizontal[i], true );\n\n\t\t\tthis.separableBlurMaterials[i].uniforms[ \"colorTexture\" ].value = this.renderTargetsHorizontal[i].texture;\n\n\t\t\tthis.separableBlurMaterials[i].uniforms[ \"direction\" ].value = THREE.UnrealBloomPass.BlurDirectionY;\n\n\t\t\trenderer.render( this.scene, this.camera, this.renderTargetsVertical[i], true );\n\n\t\t\tinputRenderTarget = this.renderTargetsVertical[i];\n\t\t}\n\n\t\t// Composite All the mips\n\t\tthis.quad.material = this.compositeMaterial;\n\t\tthis.compositeMaterial.uniforms[\"bloomStrength\"].value = this.strength;\n\t\tthis.compositeMaterial.uniforms[\"bloomRadius\"].value = this.radius;\n\t\tthis.compositeMaterial.uniforms[\"bloomTintColors\"].value = this.bloomTintColors;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetsHorizontal[0], true );\n\n\t\t// Blend it additively over the input texture\n\t\tthis.quad.material = this.materialCopy;\n\t\tthis.copyUniforms[ \"tDiffuse\" ].value = this.renderTargetsHorizontal[0].texture;\n\n\t\tif ( maskActive ) renderer.context.enable( renderer.context.STENCIL_TEST );\n\n\t\trenderer.render( this.scene, this.camera, readBuffer );\n\n\t\trenderer.setClearColor( this.oldClearColor, this.oldClearAlpha );\n\t\trenderer.autoClear = oldAutoClear;\n\t},\n\n\tgetSeperableBlurMaterial: function(kernelRadius) {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tdefines: {\n\t\t\t\t\"KERNEL_RADIUS\" : kernelRadius,\n\t\t\t\t\"SIGMA\" : kernelRadius\n\t\t\t},\n\n\t\t\tuniforms: {\n\t\t\t\t\"colorTexture\": { value: null },\n\t\t\t\t\"texSize\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"direction\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) }\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\\n\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\tuniform sampler2D colorTexture;\\n\\\n\t\t\t\tuniform vec2 texSize;\\\n\t\t\t\tuniform vec2 direction;\\\n\t\t\t\t\\\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\\\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\\\n\t\t\t\t}\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\\\n\t\t\t\t\tfloat fSigma = float(SIGMA);\\\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\\\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\\\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\\\n\t\t\t\t\t\tfloat x = float(i);\\\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\\\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\\\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\\\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\\\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\\\n\t\t\t\t\t\tweightSum += 2.0 * w;\\\n\t\t\t\t\t}\\\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\\n\\\n\t\t\t\t}\"\n\t\t} );\n\t},\n\n\tgetCompositeMaterial: function(nMips) {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tdefines:{\n\t\t\t\t\"NUM_MIPS\" : nMips\n\t\t\t},\n\n\t\t\tuniforms: {\n\t\t\t\t\"blurTexture1\": { value: null },\n\t\t\t\t\"blurTexture2\": { value: null },\n\t\t\t\t\"blurTexture3\": { value: null },\n\t\t\t\t\"blurTexture4\": { value: null },\n\t\t\t\t\"blurTexture5\": { value: null },\n\t\t\t\t\"dirtTexture\": { value: null },\n\t\t\t\t\"bloomStrength\" : { value: 1.0 },\n\t\t\t\t\"bloomFactors\" : { value: null },\n\t\t\t\t\"bloomTintColors\" : { value: null },\n\t\t\t\t\"bloomRadius\" : { value: 0.0 }\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"varying vec2 vUv;\\\n\t\t\t\tuniform sampler2D blurTexture1;\\\n\t\t\t\tuniform sampler2D blurTexture2;\\\n\t\t\t\tuniform sampler2D blurTexture3;\\\n\t\t\t\tuniform sampler2D blurTexture4;\\\n\t\t\t\tuniform sampler2D blurTexture5;\\\n\t\t\t\tuniform sampler2D dirtTexture;\\\n\t\t\t\tuniform float bloomStrength;\\\n\t\t\t\tuniform float bloomRadius;\\\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\\\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\\\n\t\t\t\t\\\n\t\t\t\tfloat lerpBloomFactor(const in float factor) { \\\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\\\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\\\n\t\t\t\t}\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \\\n\t\t\t\t\t \t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \\\n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \\\n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \\\n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\\\n\t\t\t\t}\"\n\t\t} );\n\t}\n\n} );\n\nTHREE.UnrealBloomPass.BlurDirectionX = new THREE.Vector2( 1.0, 0.0 );\nTHREE.UnrealBloomPass.BlurDirectionY = new THREE.Vector2( 0.0, 1.0 );\n\n// File:examples/js/GlossyMirror.js\n\n/**\n * @author spidersharma03\n * @author bhouston / Ben Houston / ben@clara.io\n */\n\nTHREE.MirrorHelper = function(mirror) {\n  this.scene = new THREE.Scene();\n  this.cameraOrtho = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);\n  this.quad = new THREE.Mesh(new THREE.PlaneGeometry(2, 2), null);\n  this.scene.add(this.quad);\n  this.mirror = mirror;\n  this.numMipMaps = 4;\n\n\n  this.mirrorTextureMipMaps = [];\n  this.tempRenderTargets = [];\n  var parameters = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat, stencilBuffer: false };\n  var mirrorTexture = mirror.mirrorRenderTarget;\n\n  var width = mirrorTexture.width/2, height = mirrorTexture.height/2;\n  for( var i=0; i<this.numMipMaps; i++) {\n\n    var mirrorRenderTarget = new THREE.WebGLRenderTarget( width, height, parameters );\n    mirrorRenderTarget.texture.generateMipmaps = false;\n    this.mirrorTextureMipMaps.push(mirrorRenderTarget);\n\n    var tempRenderTarget = new THREE.WebGLRenderTarget( width, height, parameters );\n    tempRenderTarget.texture.generateMipmaps = false;\n    this.tempRenderTargets.push(tempRenderTarget);\n\n    width /= 2; height /= 2;\n  }\n\n  this.vBlurMaterial = new THREE.ShaderMaterial( THREE.BlurShader );\n  this.vBlurMaterial.side = THREE.DoubleSide;\n  this.vBlurMaterial.uniforms[ 'size' ].value.set( mirrorTexture.width/2, mirrorTexture.height/2 );\n  this.vBlurMaterial.blending = THREE.NoBlending;\n  THREE.BlurShaderUtils.configure( this.vBlurMaterial, 5, 3.0, new THREE.Vector2( 0, 1 ) );\n\n  this.hBlurMaterial = this.vBlurMaterial.clone();\n  this.hBlurMaterial.side = THREE.DoubleSide;\n  this.hBlurMaterial.uniforms[ 'size' ].value.set( mirrorTexture.width/2, mirrorTexture.height/2 );\n  this.hBlurMaterial.blending = THREE.NoBlending;\n  THREE.BlurShaderUtils.configure( this.hBlurMaterial, 5, 3.0, new THREE.Vector2( 1, 0 ) );\n}\n\n\nTHREE.MirrorHelper.prototype = {\n\n  constructor: THREE.MirrorHelper,\n\n\n  setSize: function( width, height ) {\n\t  for( var i=0; i<this.numMipMaps; i++) {\n\t    width /= 2; height /= 2;\n\t    this.mirrorTextureMipMaps[i].setSize( width, height );\n\t    this.tempRenderTargets[i].setSize( width, height );\n\t  }\n  },\n\n  update: function(renderer) {\n\n    var textureIn = this.mirror.mirrorRenderTarget;\n    for( var i=0; i<this.numMipMaps; i++) {\n      var renderTarget = this.mirrorTextureMipMaps[i];\n   \t  var tempRenderTarget = this.tempRenderTargets[i];\n   \n      this.hBlurMaterial.uniforms[ 'size' ].value.set( textureIn.width, textureIn.height );\n      this.hBlurMaterial.uniforms[ \"tDiffuse\" ].value = textureIn.texture;\n      this.quad.material = this.hBlurMaterial;\n      renderer.render(this.scene, this.cameraOrtho, tempRenderTarget, true);\n\n      this.vBlurMaterial.uniforms[ 'size' ].value.set( tempRenderTarget.width, tempRenderTarget.height );\n      this.vBlurMaterial.uniforms[ \"tDiffuse\" ].value = tempRenderTarget.texture;\n      this.quad.material = this.vBlurMaterial;\n      renderer.render(this.scene, this.cameraOrtho, renderTarget, true);\n\n      textureIn = renderTarget;\n    }\n  }\n}\n\n\n\nTHREE.GlossyMirror = function ( options ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.name = 'mirror_' + this.id;\n\n\toptions = options || {};\n\n\tthis.matrixNeedsUpdate = true;\n\n\tvar width = options.textureWidth !== undefined ? options.textureWidth : 512;\n\tvar height = options.textureHeight !== undefined ? options.textureHeight : 512;\n\n\tthis.size = new THREE.Vector3( width, height );\n\n\tthis.localMirrorNormal = options.localMirrorNormal !== undefined ? options.localMirrorNormal : new THREE.Vector3( 0, 0, 1 );\n\n\tthis.distanceFade = 0.1;\n\tthis.metalness = 0.0;\n\tthis.specularColor = new THREE.Color( 0xffffff );\n\tthis.roughness = 0.0;\n\tthis.fresnelStrength = 1.0;\n\n\tthis.mirrorPlane = new THREE.Plane();\n\tthis.mirrorWorldPosition = new THREE.Vector3();\n\tthis.cameraWorldPosition = new THREE.Vector3();\n\tthis.rotationMatrix = new THREE.Matrix4();\n\tthis.lookAtPosition = new THREE.Vector3( 0, 0, - 1 );\n\tthis.matrixNeedsUpdate = true;\n\n\t// For debug only, show the normal and plane of the mirror\n\tvar debugMode = options.debugMode !== undefined ? options.debugMode : false;\n\n\tif ( debugMode ) {\n\n\t\tvar arrow = new THREE.ArrowHelper( new THREE.Vector3( 0, 0, 1 ), new THREE.Vector3( 0, 0, 0 ), 10, 0xffff80 );\n\t\tvar planeGeometry = new THREE.Geometry();\n\t\tplaneGeometry.vertices.push( new THREE.Vector3( - 10, - 10, 0 ) );\n\t\tplaneGeometry.vertices.push( new THREE.Vector3( 10, - 10, 0 ) );\n\t\tplaneGeometry.vertices.push( new THREE.Vector3( 10, 10, 0 ) );\n\t\tplaneGeometry.vertices.push( new THREE.Vector3( - 10, 10, 0 ) );\n\t\tplaneGeometry.vertices.push( planeGeometry.vertices[ 0 ] );\n\t\tvar plane = new THREE.Line( planeGeometry, new THREE.LineBasicMaterial( { color: 0xffff80 } ) );\n\n\t\tthis.add( arrow );\n\t\tthis.add( plane );\n\n\t}\n\n\tthis.reflectionTextureMatrix = new THREE.Matrix4();\n\n\tthis.mirrorNormal = new THREE.Vector3();\n\tvar parameters = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat, stencilBuffer: false };\n\n\tthis.mirrorRenderTarget = new THREE.WebGLRenderTarget( width, height, parameters );\n\tthis.mirrorRenderTarget.texture.name = \"GlossyMirror.mirror\";\n\t\n\tthis.material = new THREE.ShaderMaterial( THREE.GlossyMirrorShader );\n\tthis.material.defines = Object.assign( {}, this.material.defines );\n\tthis.material.uniforms = THREE.UniformsUtils.clone( this.material.uniforms );\n\tthis.material.uniforms.tReflection.value = this.mirrorRenderTarget.texture;\n\tthis.material.uniforms.reflectionTextureMatrix.value = this.reflectionTextureMatrix;\n\n\tthis.mirrorRenderTarget.texture.generateMipmaps = false;\n\n\tthis.clipPlane = new THREE.Plane( this.localMirrorNormal, 0 );\n\tthis.originalClipPlane = this.clipPlane.clone();\n\tthis.falseClipPlane = this.clipPlane.clone();\n\tthis.falseClipPlane.constant = 10000;\n\n\tthis.depthMaterial = new THREE.MeshDepthMaterial();\n \tthis.depthMaterial.depthPacking = THREE.RGBADepthPacking;\n \tthis.depthMaterial.blending = THREE.NoBlending;\n\tthis.depthMaterial.side = THREE.FrontSide;\n\n\tthis.depthRenderTarget = new THREE.WebGLRenderTarget( width, height,\n \t\t\t\t\t{ minFilter: THREE.NearestFilter, magFilter: THREE.NearestFilter, format: THREE.RGBAFormat } );\n\tthis.depthRenderTarget.texture.generateMipmaps = false;\n\tthis.depthRenderTarget.texture.name = \"GlossyMirror.depth\";\n\n\tthis.material.uniforms.tReflectionDepth.value = this.depthRenderTarget.texture;\n\n\n  \tthis.material.uniforms[ 'screenSize' ].value = new THREE.Vector2(width, height);\n\n\tthis.mirrorHelper = new THREE.MirrorHelper(this);\n\n\tthis.material.uniforms.tReflection.value = this.mirrorRenderTarget.texture;\n\tthis.material.uniforms.tReflection1.value = this.mirrorHelper.mirrorTextureMipMaps[0].texture;\n\tthis.material.uniforms.tReflection2.value = this.mirrorHelper.mirrorTextureMipMaps[1].texture;\n\tthis.material.uniforms.tReflection3.value = this.mirrorHelper.mirrorTextureMipMaps[2].texture;\n\tthis.material.uniforms.tReflection4.value = this.mirrorHelper.mirrorTextureMipMaps[3].texture;\n\n\tthis.setSize( width, height );\n\n};\n\nTHREE.GlossyMirror.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n\tconstructor: THREE.GlossyMirror,\n\n\tsetSize: function( width, height ) {\n\n\t\tif( this.size.x !== width || this.size.y !== height ) {\n\n\t\t\tthis.mirrorRenderTarget.setSize( width, height );\n\t\t\tthis.depthRenderTarget.setSize( width, height );\n\t\t\tthis.mirrorHelper.setSize( width, height );\n\t\t \tthis.material.uniforms[ 'screenSize' ].value = new THREE.Vector2(width, height);\n\n\t\t \tthis.size.set( width, height );\n\t\t \tthis.matrixNeedsUpdate = true;\n\t\t }\n\n\t \tthis.matrixNeedsUpdate = true;\n\n\t},\n\n\tupdateReflectionTextureMatrix: function ( camera ) {\n\n\t\tthis.updateMatrixWorld();\n\t\tcamera.updateMatrixWorld();\n\n\t\tthis.mirrorWorldPosition.setFromMatrixPosition( this.matrixWorld );\n\t\tthis.cameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );\n\n\t\tthis.rotationMatrix.extractRotation( this.matrixWorld );\n\n\t\tthis.mirrorNormal.copy( this.localMirrorNormal );\n\t\tthis.mirrorNormal.applyMatrix4( this.rotationMatrix );\n\n\t\tvar view = this.mirrorWorldPosition.clone().sub( this.cameraWorldPosition );\n\t\tview.reflect( this.mirrorNormal ).negate();\n\t\tview.add( this.mirrorWorldPosition );\n\n\t\tthis.rotationMatrix.extractRotation( camera.matrixWorld );\n\n\t\tthis.lookAtPosition.set( 0, 0, - 1 );\n\t\tthis.lookAtPosition.applyMatrix4( this.rotationMatrix );\n\t\tthis.lookAtPosition.add( this.cameraWorldPosition );\n\n\t\tvar target = this.mirrorWorldPosition.clone().sub( this.lookAtPosition );\n\t\ttarget.reflect( this.mirrorNormal ).negate();\n\t\ttarget.add( this.mirrorWorldPosition );\n\n\t\tthis.up.set( 0, - 1, 0 );\n\t\tthis.up.applyMatrix4( this.rotationMatrix );\n\t\tthis.up.reflect( this.mirrorNormal ).negate();\n\n\t\tthis.mirrorCamera.position.copy( view );\n\t\tthis.mirrorCamera.up = this.up;\n\t\tthis.mirrorCamera.lookAt( target );\n\t\tthis.mirrorCamera.fov = camera.fov;\n\t\tthis.mirrorCamera.near = camera.near;\n\t\tthis.mirrorCamera.far = camera.far;\n\t\tthis.mirrorCamera.aspect = camera.aspect;\n\n\t\tthis.mirrorCamera.updateProjectionMatrix();\n\t\tthis.mirrorCamera.updateMatrixWorld();\n\t\tthis.mirrorCamera.matrixWorldInverse.getInverse( this.mirrorCamera.matrixWorld );\n\n\t\t// Update the texture matrix\n\t\tthis.reflectionTextureMatrix.set( 0.5, 0.0, 0.0, 0.5,\n\t\t\t\t\t\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t\t\t\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t\t\t\t\t\t0.0, 0.0, 0.0, 1.0 );\n\t\tthis.reflectionTextureMatrix.multiply( this.mirrorCamera.projectionMatrix );\n\t\tthis.reflectionTextureMatrix.multiply( this.mirrorCamera.matrixWorldInverse );\n\n\t\tthis.mirrorPlane.setFromNormalAndCoplanarPoint( this.mirrorNormal, this.mirrorWorldPosition );\n\t\tthis.mirrorPlane.applyMatrix4( this.mirrorCamera.matrixWorldInverse );\n\n\n\t\tthis.material.uniforms[ 'mirrorCameraProjectionMatrix' ].value.copy( this.mirrorCamera.projectionMatrix );\n\t\tthis.material.uniforms[ 'mirrorCameraInverseProjectionMatrix' ].value.getInverse( this.mirrorCamera.projectionMatrix );\n\n\t\tthis.material.uniforms[ 'mirrorCameraWorldMatrix' ].value.copy( camera.matrixWorld );\n\t\tthis.material.uniforms[ 'mirrorCameraNear' ].value = this.mirrorCamera.near;\n\t\tthis.material.uniforms[ 'mirrorCameraFar' ].value = this.mirrorCamera.far;\n\n\t\tthis.material.uniforms[ 'mirrorNormal' ].value = this.mirrorNormal;\n\t\tthis.material.uniforms[ 'mirrorWorldPosition' ].value = this.mirrorWorldPosition;\n\t\tthis.material.transparent = true;\n\t},\n\n\trender: function ( renderer, scene, camera, width, height ) {\n\n\t\tif ( ! camera instanceof THREE.PerspectiveCamera ) console.error( \"THREE.GlossyMirror: camera is not a Perspective Camera!\" );\n\n\t\tthis.setSize( width, height );\n\n\t\tif( ! this.mirrorCamera ) {\n\t\t\tthis.mirrorCamera = camera.clone();\n\t\t\tthis.mirrorCamera.matrixAutoUpdate = true;\n\n\t\t}\n\n\n\t\tif ( this.matrixNeedsUpdate ) this.updateReflectionTextureMatrix( camera );\n\n\t\tthis.matrixNeedsUpdate = true;\n\n\t\t// Render the mirrored view of the current scene into the target texture\n\n\n\t\tif(this.clipPlane !== undefined) {\n\n\t\t\tthis.clipPlane.copy(this.originalClipPlane);\n\n\t\t\tthis.clipPlane.applyMatrix4(this.matrixWorld);\n\t\t\tthis.clippingPlanes = [this.clipPlane];\n\t\t}\n\n\t\trenderer.clippingPlanes = this.clippingPlanes;\n\n\t\tif ( scene !== undefined && scene instanceof THREE.Scene ) {\n\n\t\t\t// We can't render ourself to ourself\n\t\t\tvar visible = this.material.visible;\n\t\t\tthis.material.visible = false;\n\n\t\t\trenderer.render( scene, this.mirrorCamera, this.mirrorRenderTarget, true );\n\n\t\t\tthis.material.visible = visible;\n\n\t\t}\n\t\tscene.overrideMaterial = this.depthMaterial;\n\n\t\tvar visible = this.material.visible;\n\n\t\tvar oldClearColor = renderer.getClearColor(), oldClearAlpha = renderer.getClearAlpha();\n\n\t\trenderer.setClearColor(0xffffff, 1);\n\t\tthis.material.visible = false;\n\n\t\trenderer.render( scene, this.mirrorCamera, this.depthRenderTarget, true );\n\n\t\tscene.overrideMaterial = null;\n\t\trenderer.setClearColor( oldClearColor, oldClearAlpha );\n\n\n\t\tthis.material.visible = visible;\n\t\tthis.material.uniforms.distanceFade.value = this.distanceFade;\n\t\tthis.material.uniforms.metalness.value = this.metalness;\n\t\tthis.material.uniforms.fresnelStrength.value = this.fresnelStrength;\n\t\tthis.material.uniforms.specularColor.value.copy( this.specularColor );\n\t\tthis.material.uniforms.roughness.value = this.roughness;\n\n\t\tif(this.clipPlane !== undefined) {\n\n\t\t\tthis.clipPlane.copy(this.falseClipPlane);\n\n\t\t}\n\t\tif(this.mirrorHelper !== undefined) {\n\n\t\t\tthis.mirrorHelper.update(renderer);\n\n\t\t}\n\t}\n\n} );\n\n// File:examples/js/controls/OrbitControls.js\n\n/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n */\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one finger move\n//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n//    Pan - right mouse, or arrow keys / touch: three finger swipe\n\nTHREE.OrbitControls = function ( object, domElement ) {\n\n\tthis.object = object;\n\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new THREE.Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.25;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// Set to false to disable use of the keys\n\tthis.enableKeys = true;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn spherical.phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn spherical.theta;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function () {\n\n\t\tvar offset = new THREE.Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().inverse();\n\n\t\tvar lastPosition = new THREE.Vector3();\n\t\tvar lastQuaternion = new THREE.Quaternion();\n\n\t\treturn function update() {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\t\t\tspherical.setFromVector3( offset );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t// restrict theta to be between desired limits\n\t\t\tspherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\tspherical.makeSafe();\n\n\n\t\t\tspherical.radius *= scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t// move target to panned location\n\t\t\tscope.target.add( panOffset );\n\n\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function () {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n\t\tscope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\twindow.removeEventListener( 'keydown', onKeyDown, false );\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = { NONE: - 1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY: 4, TOUCH_PAN: 5 };\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar spherical = new THREE.Spherical();\n\tvar sphericalDelta = new THREE.Spherical();\n\n\tvar scale = 1;\n\tvar panOffset = new THREE.Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new THREE.Vector2();\n\tvar rotateEnd = new THREE.Vector2();\n\tvar rotateDelta = new THREE.Vector2();\n\n\tvar panStart = new THREE.Vector2();\n\tvar panEnd = new THREE.Vector2();\n\tvar panDelta = new THREE.Vector2();\n\n\tvar dollyStart = new THREE.Vector2();\n\tvar dollyEnd = new THREE.Vector2();\n\tvar dollyDelta = new THREE.Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tsphericalDelta.theta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tsphericalDelta.phi -= angle;\n\n\t}\n\n\tvar panLeft = function () {\n\n\t\tvar v = new THREE.Vector3();\n\n\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\tv.multiplyScalar( - distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\tvar panUp = function () {\n\n\t\tvar v = new THREE.Vector3();\n\n\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 1 ); // get Y column of objectMatrix\n\t\t\tv.multiplyScalar( distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function () {\n\n\t\tvar offset = new THREE.Vector3();\n\n\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t\tif ( scope.object instanceof THREE.PerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object instanceof THREE.OrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object instanceof THREE.PerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object instanceof THREE.OrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object instanceof THREE.PerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object instanceof THREE.OrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\t//console.log( 'handleMouseDownRotate' );\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\t//console.log( 'handleMouseDownDolly' );\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\t//console.log( 'handleMouseDownPan' );\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\t//console.log( 'handleMouseMoveRotate' );\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t// rotating across whole screen goes 360 degrees around\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\t//console.log( 'handleMouseMoveDolly' );\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\t//console.log( 'handleMouseMovePan' );\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( event ) {\n\n\t\t// console.log( 'handleMouseUp' );\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\t// console.log( 'handleMouseWheel' );\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\t//console.log( 'handleKeyDown' );\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\t//console.log( 'handleTouchStartRotate' );\n\n\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t}\n\n\tfunction handleTouchStartDolly( event ) {\n\n\t\t//console.log( 'handleTouchStartDolly' );\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyStart.set( 0, distance );\n\n\t}\n\n\tfunction handleTouchStartPan( event ) {\n\n\t\t//console.log( 'handleTouchStartPan' );\n\n\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\t//console.log( 'handleTouchMoveRotate' );\n\n\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t// rotating across whole screen goes 360 degrees around\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleTouchMoveDolly( event ) {\n\n\t\t//console.log( 'handleTouchMoveDolly' );\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyEnd.set( 0, distance );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleTouchMovePan( event ) {\n\n\t\t//console.log( 'handleTouchMovePan' );\n\n\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\tpanDelta.subVectors( panEnd, panStart );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleTouchEnd( event ) {\n\n\t\t//console.log( 'handleTouchEnd' );\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tif ( event.button === scope.mouseButtons.ORBIT ) {\n\n\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\thandleMouseDownRotate( event );\n\n\t\t\tstate = STATE.ROTATE;\n\n\t\t} else if ( event.button === scope.mouseButtons.ZOOM ) {\n\n\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\thandleMouseDownDolly( event );\n\n\t\t\tstate = STATE.DOLLY;\n\n\t\t} else if ( event.button === scope.mouseButtons.PAN ) {\n\n\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\thandleMouseDownPan( event );\n\n\t\t\tstate = STATE.PAN;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tif ( state === STATE.ROTATE ) {\n\n\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\thandleMouseMoveRotate( event );\n\n\t\t} else if ( state === STATE.DOLLY ) {\n\n\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\thandleMouseMoveDolly( event );\n\n\t\t} else if ( state === STATE.PAN ) {\n\n\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\thandleMouseMovePan( event );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( startEvent ); // not sure why these are here...\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\t// one-fingered touch: rotate\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchStartRotate( event );\n\n\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\t// two-fingered touch: dolly\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleTouchStartDolly( event );\n\n\t\t\t\tstate = STATE.TOUCH_DOLLY;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchStartPan( event );\n\n\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1: // one-fingered touch: rotate\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_ROTATE ) return; // is this needed?...\n\n\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // two-fingered touch: dolly\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_DOLLY ) return; // is this needed?...\n\n\t\t\t\thandleTouchMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_PAN ) return; // is this needed?...\n\n\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n\tscope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n\twindow.addEventListener( 'keydown', onKeyDown, false );\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nTHREE.OrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nTHREE.OrbitControls.prototype.constructor = THREE.OrbitControls;\n\nObject.defineProperties( THREE.OrbitControls.prototype, {\n\n\tcenter: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .center has been renamed to .target' );\n\t\t\treturn this.target;\n\n\t\t}\n\n\t},\n\n\t// backward compatibility\n\n\tnoZoom: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\treturn ! this.enableZoom;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\tthis.enableZoom = ! value;\n\n\t\t}\n\n\t},\n\n\tnoRotate: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\treturn ! this.enableRotate;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\tthis.enableRotate = ! value;\n\n\t\t}\n\n\t},\n\n\tnoPan: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\treturn ! this.enablePan;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\tthis.enablePan = ! value;\n\n\t\t}\n\n\t},\n\n\tnoKeys: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\treturn ! this.enableKeys;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\tthis.enableKeys = ! value;\n\n\t\t}\n\n\t},\n\n\tstaticMoving: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\treturn ! this.enableDamping;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\tthis.enableDamping = ! value;\n\n\t\t}\n\n\t},\n\n\tdynamicDampingFactor: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\treturn this.dampingFactor;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\tthis.dampingFactor = value;\n\n\t\t}\n\n\t}\n\n} );\n\n// File:examples/js/ColorToJsonOverride.js\n\n//override the toJSON function to return serialization to its previous state\nTHREE.Color.prototype.toJSON = function() {\n  return { r: this.r, g: this.g, b: this.b };\n}\n\n// File:examples/js/cameras/CombinedCamera.js\n\n/**\n *\t@author zz85 / http://twitter.com/blurspline / http://www.lab4games.net/zz85/blog\n *\n *\t\tA general perpose camera, for setting FOV, Lens Focal Length,\n *\t\tand switching between perspective and orthographic views easily.\n *\t\tUse this only if you do not wish to manage\n *\t\tboth a Orthographic and Perspective Camera\n *\n */\n\n\nTHREE.CombinedCamera = function ( width, height, fov, near, far) {\n\n\tTHREE.Camera.call( this );\n\t// perspective\n\tthis.fov = fov;\n\tthis.far = far;\n\tthis.near = near;\n\t//orthographic\n\tthis.left = - width / 2;\n\tthis.right = width / 2;\n\tthis.top = height / 2;\n\tthis.bottom = - height / 2;\n\n\tthis.aspect =  width / height;\n\tthis.zoom = 1;\n\tthis.view = null;\n\tthis.hyperfocusOffset = 0;\n\tthis.hyperfocusScale = 0.5;\n\t// We could also handle the projectionMatrix internally, but just wanted to test nested camera objects\n\n\tthis.cameraO = new THREE.OrthographicCamera( this.left, this.right, this.top, this.bottom, this.near, this.far );\n\tthis.cameraP = new THREE.PerspectiveCamera( this.fov, this.aspect, this.near, this.far );\n\n\tthis.toPerspective();\n\n};\n\nTHREE.CombinedCamera.prototype = Object.create( THREE.Camera.prototype );\nTHREE.CombinedCamera.prototype.constructor = THREE.CombinedCamera;\n\nTHREE.CombinedCamera.prototype.toPerspective = function () {\n\n\t// Switches to the Perspective Camera\n\n\tthis.cameraP.near = this.near;\n\tthis.cameraP.far = this.far;\n\tthis.cameraP.aspect = this.aspect;\n\tthis.cameraP.fov =  this.fov;\n\tthis.cameraP.zoom = this.zoom;\n\tthis.cameraP.view = this.view;\n\n\tthis.cameraP.updateProjectionMatrix();\n\n\tthis.projectionMatrix = this.cameraP.projectionMatrix;\n\n\tthis.inPerspectiveMode = true;\n\tthis.inOrthographicMode = false;\n\n};\n\nTHREE.CombinedCamera.prototype.toOrthographic = function () {\n\n\t// Switches to the Orthographic camera estimating viewport from Perspective\n\n\tvar fov = this.fov;\n\tvar aspect = this.aspect;\n\n\tvar halfHeight = Math.tan( fov * Math.PI / 180 / 2 ) * (this.hyperfocusOffset + this.hyperfocusScale * ( this.near + this.far ));\n\tvar halfWidth = halfHeight * aspect;\n\n\tthis.cameraO.near = this.near;\n\tthis.cameraO.far = this.far;\n\tthis.cameraO.left = - halfWidth;\n\tthis.cameraO.right = halfWidth;\n\tthis.cameraO.top = halfHeight;\n\tthis.cameraO.bottom = - halfHeight;\n\n\tthis.cameraO.zoom = this.zoom;\n\tthis.cameraO.view = this.view;\n\n\tthis.cameraO.updateProjectionMatrix();\n\n\tthis.projectionMatrix = this.cameraO.projectionMatrix;\n\n\tthis.inPerspectiveMode = false;\n\tthis.inOrthographicMode = true;\n\n};\n\n\nTHREE.CombinedCamera.prototype.setSize = function( width, height ) {\n\n\tthis.aspect = width / height;\n\tthis.left = - width / 2;\n\tthis.right = width / 2;\n\tthis.top = height / 2;\n\tthis.bottom = - height / 2;\n\n};\n\n\nTHREE.CombinedCamera.prototype.setFov = function( fov ) {\n\n\tthis.fov = fov;\n\n\tif ( this.inPerspectiveMode ) {\n\n\t\tthis.toPerspective();\n\n\t} else {\n\n\t\tthis.toOrthographic();\n\n\t}\n\n};\n\nTHREE.CombinedCamera.prototype.copy = function ( source ) {\n\n\tTHREE.Camera.prototype.copy.call( this, source );\n\n\tthis.fov = source.fov;\n\tthis.far = source.far;\n\tthis.near = source.near;\n\n\tthis.left = source.left;\n\tthis.right = source.right;\n\tthis.top = source.top;\n\tthis.bottom = source.bottom;\n\n\tthis.zoom = source.zoom;\n\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\tthis.aspect = source.aspect;\n\tthis.hyperfocusOffset = source.hyperfocusOffset;\n\tthis.hyperfocusScale = source.hyperfocusScale;\n  \n\tthis.cameraO.copy(source.cameraO);\n\tthis.cameraP.copy(source.cameraP);\n\n\tthis.inOrthographicMode = source.inOrthographicMode;\n\tthis.inPerspectiveMode = source.inPerspectiveMode;\n\n\treturn this;\n\n};\n\nTHREE.CombinedCamera.prototype.setViewOffset = function( fullWidth, fullHeight, x, y, width, height ) {\n\n\tthis.view = {\n\t\tfullWidth: fullWidth,\n\t\tfullHeight: fullHeight,\n\t\toffsetX: x,\n\t\toffsetY: y,\n\t\twidth: width,\n\t\theight: height\n\t};\n\n\tif ( this.inPerspectiveMode ) {\n\n\t\tthis.aspect = fullWidth / fullHeight;\n\n\t\tthis.toPerspective();\n\n\t} else {\n\n\t\tthis.toOrthographic();\n\n\t}\n\n};\n\nTHREE.CombinedCamera.prototype.clearViewOffset = function() {\n\n\tthis.view = null;\n\tthis.updateProjectionMatrix();\n\n};\n// For maintaining similar API with PerspectiveCamera\n\nTHREE.CombinedCamera.prototype.updateProjectionMatrix = function() {\n\n\tif ( this.inPerspectiveMode ) {\n\n\t\tthis.toPerspective();\n\n\t} else {\n\n\t\tthis.toPerspective();\n\t\tthis.toOrthographic();\n\n\t}\n\n};\n\n/*\n* Uses Focal Length (in mm) to estimate and set FOV\n* 35mm (full frame) camera is used if frame size is not specified;\n* Formula based on http://www.bobatkins.com/photography/technical/field_of_view.html\n*/\nTHREE.CombinedCamera.prototype.setLens = function ( focalLength, filmGauge ) {\n\n\tif ( filmGauge === undefined ) filmGauge = 35;\n\n\tvar vExtentSlope = 0.5 * filmGauge /\n\t\t\t( focalLength * Math.max( this.cameraP.aspect, 1 ) );\n\n\tvar fov = THREE.Math.RAD2DEG * 2 * Math.atan( vExtentSlope );\n\n\tthis.setFov( fov );\n\n\treturn fov;\n\n};\n\n\nTHREE.CombinedCamera.prototype.setZoom = function( zoom ) {\n\n\tthis.zoom = zoom;\n\n\tif ( this.inPerspectiveMode ) {\n\n\t\tthis.toPerspective();\n\n\t} else {\n\n\t\tthis.toOrthographic();\n\n\t}\n\n};\n\nTHREE.CombinedCamera.prototype.toFrontView = function() {\n\n\tthis.rotation.x = 0;\n\tthis.rotation.y = 0;\n\tthis.rotation.z = 0;\n\n\tthis.position.x = 0;\n\tthis.position.y = 0;\n\tthis.position.z = -15;\n\t// should we be modifing the matrix instead?\n\n};\n\nTHREE.CombinedCamera.prototype.toBackView = function() {\n\n\tthis.rotation.x = 0;\n\tthis.rotation.y = Math.PI;\n\tthis.rotation.z = 0;\n\n\tthis.position.x = 0;\n\tthis.position.y = 0;\n\tthis.position.z = 15;\n\n};\n\nTHREE.CombinedCamera.prototype.toLeftView = function() {\n\n\tthis.rotation.x = 0;\n\tthis.rotation.y = - Math.PI / 2;\n\tthis.rotation.z = 0;\n\n\tthis.position.x = -15;\n\tthis.position.y = 0;\n\tthis.position.z = 0;\n\n};\n\nTHREE.CombinedCamera.prototype.toRightView = function() {\n\n\tthis.rotation.x = 0;\n\tthis.rotation.y = Math.PI / 2;\n\tthis.rotation.z = 0;\n\n\tthis.position.x = 15;\n\tthis.position.y = 0;\n\tthis.position.z = 0;\n\n};\n\nTHREE.CombinedCamera.prototype.toTopView = function() {\n\n\tthis.rotation.x = - Math.PI / 2;\n\tthis.rotation.y = 0;\n\tthis.rotation.z = 0;\n\n\tthis.position.x = 0;\n\tthis.position.y = 15;\n\tthis.position.z = 0;\n\n};\n\nTHREE.CombinedCamera.prototype.toBottomView = function() {\n\n\tthis.rotation.x = Math.PI / 2;\n\tthis.rotation.y = 0;\n\tthis.rotation.z = 0;\n\n\tthis.position.x = 0;\n\tthis.position.y = -15;\n\tthis.position.z = 0;\n\n};\n\nTHREE.CombinedCamera.prototype.toPerspectiveView = function() {\n\n\tthis.rotation.x = - Math.PI / 4;\n\tthis.rotation.y = - Math.PI / 4;\n\tthis.rotation.z = 0;\n\n\tthis.position.x = 4;\n\tthis.position.y = 4;\n\tthis.position.z = 4;\n\n};\n\n\nmodule.exports = THREE;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/three/three.extra.js\n// module id = 64\n// module chunks = 0 1 2","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (factory((global.THREE = global.THREE || {})));\n}(this, (function (exports) { 'use strict';\n\n\t// Polyfills\n\n\tif ( Number.EPSILON === undefined ) {\n\n\t\tNumber.EPSILON = Math.pow( 2, - 52 );\n\n\t}\n\n\t//\n\n\tif ( Math.sign === undefined ) {\n\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\n\n\t\tMath.sign = function ( x ) {\n\n\t\t\treturn ( x < 0 ) ? - 1 : ( x > 0 ) ? 1 : + x;\n\n\t\t};\n\n\t}\n\n\tif ( Function.prototype.name === undefined ) {\n\n\t\t// Missing in IE9-11.\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\n\n\t\tObject.defineProperty( Function.prototype, 'name', {\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.toString().match( /^\\s*function\\s*([^\\(\\s]*)/ )[ 1 ];\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tif ( Object.assign === undefined ) {\n\n\t\t// Missing in IE.\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n\n\t\t( function () {\n\n\t\t\tObject.assign = function ( target ) {\n\n\t\t\t\t'use strict';\n\n\t\t\t\tif ( target === undefined || target === null ) {\n\n\t\t\t\t\tthrow new TypeError( 'Cannot convert undefined or null to object' );\n\n\t\t\t\t}\n\n\t\t\t\tvar output = Object( target );\n\n\t\t\t\tfor ( var index = 1; index < arguments.length; index ++ ) {\n\n\t\t\t\t\tvar source = arguments[ index ];\n\n\t\t\t\t\tif ( source !== undefined && source !== null ) {\n\n\t\t\t\t\t\tfor ( var nextKey in source ) {\n\n\t\t\t\t\t\t\tif ( Object.prototype.hasOwnProperty.call( source, nextKey ) ) {\n\n\t\t\t\t\t\t\t\toutput[ nextKey ] = source[ nextKey ];\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn output;\n\n\t\t\t};\n\n\t\t} )();\n\n\t}\n\n\t/**\n\t * https://github.com/mrdoob/eventdispatcher.js/\n\t */\n\n\tfunction EventDispatcher() {}\n\n\tEventDispatcher.prototype = {\n\n\t\taddEventListener: function ( type, listener ) {\n\n\t\t\tif ( this._listeners === undefined ) this._listeners = {};\n\n\t\t\tvar listeners = this._listeners;\n\n\t\t\tif ( listeners[ type ] === undefined ) {\n\n\t\t\t\tlisteners[ type ] = [];\n\n\t\t\t}\n\n\t\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\n\n\t\t\t\tlisteners[ type ].push( listener );\n\n\t\t\t}\n\n\t\t},\n\n\t\thasEventListener: function ( type, listener ) {\n\n\t\t\tif ( this._listeners === undefined ) return false;\n\n\t\t\tvar listeners = this._listeners;\n\n\t\t\treturn listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1;\n\n\t\t},\n\n\t\tremoveEventListener: function ( type, listener ) {\n\n\t\t\tif ( this._listeners === undefined ) return;\n\n\t\t\tvar listeners = this._listeners;\n\t\t\tvar listenerArray = listeners[ type ];\n\n\t\t\tif ( listenerArray !== undefined ) {\n\n\t\t\t\tvar index = listenerArray.indexOf( listener );\n\n\t\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\t\tlistenerArray.splice( index, 1 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\tdispatchEvent: function ( event ) {\n\n\t\t\tif ( this._listeners === undefined ) return;\n\n\t\t\tvar listeners = this._listeners;\n\t\t\tvar listenerArray = listeners[ event.type ];\n\n\t\t\tif ( listenerArray !== undefined ) {\n\n\t\t\t\tevent.target = this;\n\n\t\t\t\tvar array = [], i = 0;\n\t\t\t\tvar length = listenerArray.length;\n\n\t\t\t\tfor ( i = 0; i < length; i ++ ) {\n\n\t\t\t\t\tarray[ i ] = listenerArray[ i ];\n\n\t\t\t\t}\n\n\t\t\t\tfor ( i = 0; i < length; i ++ ) {\n\n\t\t\t\t\tarray[ i ].call( this, event );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tvar REVISION = '84dev';\n\tvar MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\n\tvar CullFaceNone = 0;\n\tvar CullFaceBack = 1;\n\tvar CullFaceFront = 2;\n\tvar CullFaceFrontBack = 3;\n\tvar FrontFaceDirectionCW = 0;\n\tvar FrontFaceDirectionCCW = 1;\n\tvar BasicShadowMap = 0;\n\tvar PCFShadowMap = 1;\n\tvar PCFSoftShadowMap = 2;\n\tvar PCSSSoftShadowMap = 3;\n\tvar FrontSide = 0;\n\tvar BackSide = 1;\n\tvar DoubleSide = 2;\n\tvar FlatShading = 1;\n\tvar SmoothShading = 2;\n\tvar NoColors = 0;\n\tvar FaceColors = 1;\n\tvar VertexColors = 2;\n\tvar NoBlending = 0;\n\tvar NormalBlending = 1;\n\tvar AdditiveBlending = 2;\n\tvar SubtractiveBlending = 3;\n\tvar MultiplyBlending = 4;\n\tvar CustomBlending = 5;\n\tvar AddEquation = 100;\n\tvar SubtractEquation = 101;\n\tvar ReverseSubtractEquation = 102;\n\tvar MinEquation = 103;\n\tvar MaxEquation = 104;\n\tvar ZeroFactor = 200;\n\tvar OneFactor = 201;\n\tvar SrcColorFactor = 202;\n\tvar OneMinusSrcColorFactor = 203;\n\tvar SrcAlphaFactor = 204;\n\tvar OneMinusSrcAlphaFactor = 205;\n\tvar DstAlphaFactor = 206;\n\tvar OneMinusDstAlphaFactor = 207;\n\tvar DstColorFactor = 208;\n\tvar OneMinusDstColorFactor = 209;\n\tvar SrcAlphaSaturateFactor = 210;\n\tvar NeverDepth = 0;\n\tvar AlwaysDepth = 1;\n\tvar LessDepth = 2;\n\tvar LessEqualDepth = 3;\n\tvar EqualDepth = 4;\n\tvar GreaterEqualDepth = 5;\n\tvar GreaterDepth = 6;\n\tvar NotEqualDepth = 7;\n\tvar MultiplyOperation = 0;\n\tvar MixOperation = 1;\n\tvar AddOperation = 2;\n\tvar NoToneMapping = 0;\n\tvar LinearToneMapping = 1;\n\tvar ReinhardToneMapping = 2;\n\tvar Uncharted2ToneMapping = 3;\n\tvar CineonToneMapping = 4;\n\tvar UVMapping = 300;\n\tvar CubeReflectionMapping = 301;\n\tvar CubeRefractionMapping = 302;\n\tvar EquirectangularReflectionMapping = 303;\n\tvar EquirectangularRefractionMapping = 304;\n\tvar SphericalReflectionMapping = 305;\n\tvar CubeUVReflectionMapping = 306;\n\tvar CubeUVRefractionMapping = 307;\n\tvar RepeatWrapping = 1000;\n\tvar ClampToEdgeWrapping = 1001;\n\tvar MirroredRepeatWrapping = 1002;\n\tvar NearestFilter = 1003;\n\tvar NearestMipMapNearestFilter = 1004;\n\tvar NearestMipMapLinearFilter = 1005;\n\tvar LinearFilter = 1006;\n\tvar LinearMipMapNearestFilter = 1007;\n\tvar LinearMipMapLinearFilter = 1008;\n\tvar UnsignedByteType = 1009;\n\tvar ByteType = 1010;\n\tvar ShortType = 1011;\n\tvar UnsignedShortType = 1012;\n\tvar IntType = 1013;\n\tvar UnsignedIntType = 1014;\n\tvar FloatType = 1015;\n\tvar HalfFloatType = 1016;\n\tvar UnsignedShort4444Type = 1017;\n\tvar UnsignedShort5551Type = 1018;\n\tvar UnsignedShort565Type = 1019;\n\tvar UnsignedInt248Type = 1020;\n\tvar AlphaFormat = 1021;\n\tvar RGBFormat = 1022;\n\tvar RGBAFormat = 1023;\n\tvar LuminanceFormat = 1024;\n\tvar LuminanceAlphaFormat = 1025;\n\tvar RGBEFormat = RGBAFormat;\n\tvar DepthFormat = 1026;\n\tvar DepthStencilFormat = 1027;\n\tvar RGB_S3TC_DXT1_Format = 2001;\n\tvar RGBA_S3TC_DXT1_Format = 2002;\n\tvar RGBA_S3TC_DXT3_Format = 2003;\n\tvar RGBA_S3TC_DXT5_Format = 2004;\n\tvar RGB_PVRTC_4BPPV1_Format = 2100;\n\tvar RGB_PVRTC_2BPPV1_Format = 2101;\n\tvar RGBA_PVRTC_4BPPV1_Format = 2102;\n\tvar RGBA_PVRTC_2BPPV1_Format = 2103;\n\tvar RGB_ETC1_Format = 2151;\n\tvar LoopOnce = 2200;\n\tvar LoopRepeat = 2201;\n\tvar LoopPingPong = 2202;\n\tvar InterpolateDiscrete = 2300;\n\tvar InterpolateLinear = 2301;\n\tvar InterpolateSmooth = 2302;\n\tvar ZeroCurvatureEnding = 2400;\n\tvar ZeroSlopeEnding = 2401;\n\tvar WrapAroundEnding = 2402;\n\tvar TrianglesDrawMode = 0;\n\tvar TriangleStripDrawMode = 1;\n\tvar TriangleFanDrawMode = 2;\n\tvar LinearEncoding = 3000;\n\tvar sRGBEncoding = 3001;\n\tvar GammaEncoding = 3007;\n\tvar RGBEEncoding = 3002;\n\tvar LogLuvEncoding = 3003;\n\tvar RGBM7Encoding = 3004;\n\tvar RGBM16Encoding = 3005;\n\tvar RGBDEncoding = 3006;\n\tvar BasicDepthPacking = 3200;\n\tvar RGBADepthPacking = 3201;\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tvar _Math = {\n\n\t\tDEG2RAD: Math.PI / 180,\n\t\tRAD2DEG: 180 / Math.PI,\n\n\t\tgenerateUUID: function () {\n\n\t\t\t// http://www.broofa.com/Tools/Math.uuid.htm\n\n\t\t\tvar chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split( '' );\n\t\t\tvar uuid = new Array( 36 );\n\t\t\tvar rnd = 0, r;\n\n\t\t\treturn function generateUUID() {\n\n\t\t\t\tfor ( var i = 0; i < 36; i ++ ) {\n\n\t\t\t\t\tif ( i === 8 || i === 13 || i === 18 || i === 23 ) {\n\n\t\t\t\t\t\tuuid[ i ] = '-';\n\n\t\t\t\t\t} else if ( i === 14 ) {\n\n\t\t\t\t\t\tuuid[ i ] = '4';\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( rnd <= 0x02 ) rnd = 0x2000000 + ( Math.random() * 0x1000000 ) | 0;\n\t\t\t\t\t\tr = rnd & 0xf;\n\t\t\t\t\t\trnd = rnd >> 4;\n\t\t\t\t\t\tuuid[ i ] = chars[ ( i === 19 ) ? ( r & 0x3 ) | 0x8 : r ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn uuid.join( '' );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tclamp: function ( value, min, max ) {\n\n\t\t\treturn Math.max( min, Math.min( max, value ) );\n\n\t\t},\n\n\t\t// compute euclidian modulo of m % n\n\t\t// https://en.wikipedia.org/wiki/Modulo_operation\n\n\t\teuclideanModulo: function ( n, m ) {\n\n\t\t\treturn ( ( n % m ) + m ) % m;\n\n\t\t},\n\n\t\t// Linear mapping from range <a1, a2> to range <b1, b2>\n\n\t\tmapLinear: function ( x, a1, a2, b1, b2 ) {\n\n\t\t\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n\t\t},\n\n\t\t// https://en.wikipedia.org/wiki/Linear_interpolation\n\n\t\tlerp: function ( x, y, t ) {\n\n\t\t\treturn ( 1 - t ) * x + t * y;\n\n\t\t},\n\n\t\t// http://en.wikipedia.org/wiki/Smoothstep\n\n\t\tsmoothstep: function ( x, min, max ) {\n\n\t\t\tif ( x <= min ) return 0;\n\t\t\tif ( x >= max ) return 1;\n\n\t\t\tx = ( x - min ) / ( max - min );\n\n\t\t\treturn x * x * ( 3 - 2 * x );\n\n\t\t},\n\n\t\tsmootherstep: function ( x, min, max ) {\n\n\t\t\tif ( x <= min ) return 0;\n\t\t\tif ( x >= max ) return 1;\n\n\t\t\tx = ( x - min ) / ( max - min );\n\n\t\t\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n\t\t},\n\n\t\t// Random integer from <low, high> interval\n\n\t\trandInt: function ( low, high ) {\n\n\t\t\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n\t\t},\n\n\t\t// Random float from <low, high> interval\n\n\t\trandFloat: function ( low, high ) {\n\n\t\t\treturn low + Math.random() * ( high - low );\n\n\t\t},\n\n\t\t// Random float from <-range/2, range/2> interval\n\n\t\trandFloatSpread: function ( range ) {\n\n\t\t\treturn range * ( 0.5 - Math.random() );\n\n\t\t},\n\n\t\tdegToRad: function ( degrees ) {\n\n\t\t\treturn degrees * _Math.DEG2RAD;\n\n\t\t},\n\n\t\tradToDeg: function ( radians ) {\n\n\t\t\treturn radians * _Math.RAD2DEG;\n\n\t\t},\n\n\t\tisPowerOfTwo: function ( value ) {\n\n\t\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n\t\t},\n\n\t\tnearestPowerOfTwo: function ( value ) {\n\n\t\t\treturn Math.pow( 2, Math.round( Math.log( value ) / Math.LN2 ) );\n\n\t\t},\n\n\t\tnextPowerOfTwo: function ( value ) {\n\n\t\t\tvalue --;\n\t\t\tvalue |= value >> 1;\n\t\t\tvalue |= value >> 2;\n\t\t\tvalue |= value >> 4;\n\t\t\tvalue |= value >> 8;\n\t\t\tvalue |= value >> 16;\n\t\t\tvalue ++;\n\n\t\t\treturn value;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author philogb / http://blog.thejit.org/\n\t * @author egraether / http://egraether.com/\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t */\n\n\tfunction Vector2( x, y ) {\n\n\t\tthis.x = x || 0;\n\t\tthis.y = y || 0;\n\n\t}\n\n\tVector2.prototype = {\n\n\t\tconstructor: Vector2,\n\n\t\tisVector2: true,\n\n\t\tget width() {\n\n\t\t\treturn this.x;\n\n\t\t},\n\n\t\tset width( value ) {\n\n\t\t\tthis.x = value;\n\n\t\t},\n\n\t\tget height() {\n\n\t\t\treturn this.y;\n\n\t\t},\n\n\t\tset height( value ) {\n\n\t\t\tthis.y = value;\n\n\t\t},\n\n\t\t//\n\n\t\tset: function ( x, y ) {\n\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetScalar: function ( scalar ) {\n\n\t\t\tthis.x = scalar;\n\t\t\tthis.y = scalar;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetX: function ( x ) {\n\n\t\t\tthis.x = x;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetY: function ( y ) {\n\n\t\t\tthis.y = y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetComponent: function ( index, value ) {\n\n\t\t\tswitch ( index ) {\n\n\t\t\t\tcase 0: this.x = value; break;\n\t\t\t\tcase 1: this.y = value; break;\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetComponent: function ( index ) {\n\n\t\t\tswitch ( index ) {\n\n\t\t\t\tcase 0: return this.x;\n\t\t\t\tcase 1: return this.y;\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t\t}\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this.x, this.y );\n\n\t\t},\n\n\t\tcopy: function ( v ) {\n\n\t\t\tthis.x = v.x;\n\t\t\tthis.y = v.y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tadd: function ( v, w ) {\n\n\t\t\tif ( w !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\t\treturn this.addVectors( v, w );\n\n\t\t\t}\n\n\t\t\tthis.x += v.x;\n\t\t\tthis.y += v.y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddScalar: function ( s ) {\n\n\t\t\tthis.x += s;\n\t\t\tthis.y += s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddVectors: function ( a, b ) {\n\n\t\t\tthis.x = a.x + b.x;\n\t\t\tthis.y = a.y + b.y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddScaledVector: function ( v, s ) {\n\n\t\t\tthis.x += v.x * s;\n\t\t\tthis.y += v.y * s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsub: function ( v, w ) {\n\n\t\t\tif ( w !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\t\treturn this.subVectors( v, w );\n\n\t\t\t}\n\n\t\t\tthis.x -= v.x;\n\t\t\tthis.y -= v.y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsubScalar: function ( s ) {\n\n\t\t\tthis.x -= s;\n\t\t\tthis.y -= s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsubVectors: function ( a, b ) {\n\n\t\t\tthis.x = a.x - b.x;\n\t\t\tthis.y = a.y - b.y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiply: function ( v ) {\n\n\t\t\tthis.x *= v.x;\n\t\t\tthis.y *= v.y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiplyScalar: function ( scalar ) {\n\n\t\t\tif ( isFinite( scalar ) ) {\n\n\t\t\t\tthis.x *= scalar;\n\t\t\t\tthis.y *= scalar;\n\n\t\t\t} else {\n\n\t\t\t\tthis.x = 0;\n\t\t\t\tthis.y = 0;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdivide: function ( v ) {\n\n\t\t\tthis.x /= v.x;\n\t\t\tthis.y /= v.y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdivideScalar: function ( scalar ) {\n\n\t\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t\t},\n\n\t\tmin: function ( v ) {\n\n\t\t\tthis.x = Math.min( this.x, v.x );\n\t\t\tthis.y = Math.min( this.y, v.y );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmax: function ( v ) {\n\n\t\t\tthis.x = Math.max( this.x, v.x );\n\t\t\tthis.y = Math.max( this.y, v.y );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclamp: function ( min, max ) {\n\n\t\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\n\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclampScalar: function () {\n\n\t\t\tvar min, max;\n\n\t\t\treturn function clampScalar( minVal, maxVal ) {\n\n\t\t\t\tif ( min === undefined ) {\n\n\t\t\t\t\tmin = new Vector2();\n\t\t\t\t\tmax = new Vector2();\n\n\t\t\t\t}\n\n\t\t\t\tmin.set( minVal, minVal );\n\t\t\t\tmax.set( maxVal, maxVal );\n\n\t\t\t\treturn this.clamp( min, max );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tclampLength: function ( min, max ) {\n\n\t\t\tvar length = this.length();\n\n\t\t\treturn this.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\n\n\t\t},\n\n\t\tfloor: function () {\n\n\t\t\tthis.x = Math.floor( this.x );\n\t\t\tthis.y = Math.floor( this.y );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tceil: function () {\n\n\t\t\tthis.x = Math.ceil( this.x );\n\t\t\tthis.y = Math.ceil( this.y );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tround: function () {\n\n\t\t\tthis.x = Math.round( this.x );\n\t\t\tthis.y = Math.round( this.y );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\troundToZero: function () {\n\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tnegate: function () {\n\n\t\t\tthis.x = - this.x;\n\t\t\tthis.y = - this.y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdot: function ( v ) {\n\n\t\t\treturn this.x * v.x + this.y * v.y;\n\n\t\t},\n\n\t\tlengthSq: function () {\n\n\t\t\treturn this.x * this.x + this.y * this.y;\n\n\t\t},\n\n\t\tlength: function () {\n\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\n\n\t\t},\n\n\t\tlengthManhattan: function() {\n\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y );\n\n\t\t},\n\n\t\tnormalize: function () {\n\n\t\t\treturn this.divideScalar( this.length() );\n\n\t\t},\n\n\t\tangle: function () {\n\n\t\t\t// computes the angle in radians with respect to the positive x-axis\n\n\t\t\tvar angle = Math.atan2( this.y, this.x );\n\n\t\t\tif ( angle < 0 ) angle += 2 * Math.PI;\n\n\t\t\treturn angle;\n\n\t\t},\n\n\t\tdistanceTo: function ( v ) {\n\n\t\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t\t},\n\n\t\tdistanceToSquared: function ( v ) {\n\n\t\t\tvar dx = this.x - v.x, dy = this.y - v.y;\n\t\t\treturn dx * dx + dy * dy;\n\n\t\t},\n\n\t\tdistanceToManhattan: function ( v ) {\n\n\t\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y );\n\n\t\t},\n\n\t\tsetLength: function ( length ) {\n\n\t\t\treturn this.multiplyScalar( length / this.length() );\n\n\t\t},\n\n\t\tlerp: function ( v, alpha ) {\n\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tlerpVectors: function ( v1, v2, alpha ) {\n\n\t\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\n\n\t\t},\n\n\t\tequals: function ( v ) {\n\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\n\n\t\t},\n\n\t\tfromArray: function ( array, offset ) {\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tthis.x = array[ offset ];\n\t\t\tthis.y = array[ offset + 1 ];\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoArray: function ( array, offset ) {\n\n\t\t\tif ( array === undefined ) array = [];\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tarray[ offset ] = this.x;\n\t\t\tarray[ offset + 1 ] = this.y;\n\n\t\t\treturn array;\n\n\t\t},\n\n\t\tfromBufferAttribute: function ( attribute, index, offset ) {\n\n\t\t\tif ( offset !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector2: offset has been removed from .fromBufferAttribute().' );\n\n\t\t\t}\n\n\t\t\tthis.x = attribute.getX( index );\n\t\t\tthis.y = attribute.getY( index );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\trotateAround: function ( center, angle ) {\n\n\t\t\tvar c = Math.cos( angle ), s = Math.sin( angle );\n\n\t\t\tvar x = this.x - center.x;\n\t\t\tvar y = this.y - center.y;\n\n\t\t\tthis.x = x * c - y * s + center.x;\n\t\t\tthis.y = x * s + y * c + center.y;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author szimek / https://github.com/szimek/\n\t */\n\n\tvar textureId = 0;\n\n\tfunction Texture( image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\n\n\t\tObject.defineProperty( this, 'id', { value: textureId ++ } );\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.name = '';\n\n\t\tthis.image = image !== undefined ? image : Texture.DEFAULT_IMAGE;\n\t\tthis.mipmaps = [];\n\n\t\tthis.mapping = mapping !== undefined ? mapping : Texture.DEFAULT_MAPPING;\n\n\t\tthis.wrapS = wrapS !== undefined ? wrapS : ClampToEdgeWrapping;\n\t\tthis.wrapT = wrapT !== undefined ? wrapT : ClampToEdgeWrapping;\n\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : LinearFilter;\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : LinearMipMapLinearFilter;\n\n\t\tthis.anisotropy = anisotropy !== undefined ? anisotropy : 1;\n\n\t\tthis.format = format !== undefined ? format : RGBAFormat;\n\t\tthis.type = type !== undefined ? type : UnsignedByteType;\n\n\t\tthis.offset = new Vector2( 0, 0 );\n\t\tthis.repeat = new Vector2( 1, 1 );\n\n\t\tthis.generateMipmaps = true;\n\t\tthis.premultiplyAlpha = false;\n\t\tthis.flipY = true;\n\t\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\n\n\n\t\t// Values of encoding !== THREE.LinearEncoding only supported on map, envMap and emissiveMap.\n\t\t//\n\t\t// Also changing the encoding after already used by a Material will not automatically make the Material\n\t\t// update.  You need to explicitly call Material.needsUpdate to trigger it to recompile.\n\t\tthis.encoding = encoding !== undefined ? encoding : LinearEncoding;\n\n\t\tthis.version = 0;\n\t\tthis.onUpdate = null;\n\n\t}\n\n\tTexture.DEFAULT_IMAGE = undefined;\n\tTexture.DEFAULT_MAPPING = UVMapping;\n\n\tTexture.prototype = {\n\n\t\tconstructor: Texture,\n\n\t\tisTexture: true,\n\n\t\tset needsUpdate( value ) {\n\n\t\t\tif ( value === true ) this.version ++;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( source ) {\n\n\n\t\t\tthis.name = source.name + \" (Copy)\";\n\n\t\t\tthis.image = source.image;\n\t\t\tthis.mipmaps = source.mipmaps.slice( 0 );\n\n\t\t\tthis.mapping = source.mapping;\n\n\t\t\tthis.wrapS = source.wrapS;\n\t\t\tthis.wrapT = source.wrapT;\n\n\t\t\tthis.magFilter = source.magFilter;\n\t\t\tthis.minFilter = source.minFilter;\n\n\t\t\tthis.anisotropy = source.anisotropy;\n\n\t\t\tthis.format = source.format;\n\t\t\tthis.type = source.type;\n\n\t\t\tthis.offset.copy( source.offset );\n\t\t\tthis.repeat.copy( source.repeat );\n\n\t\t\tthis.generateMipmaps = source.generateMipmaps;\n\t\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\n\t\t\tthis.flipY = source.flipY;\n\t\t\tthis.unpackAlignment = source.unpackAlignment;\n\t\t\tthis.encoding = source.encoding;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoJSON: function ( meta ) {\n\n\t\t\tif ( meta.textures[ this.uuid ] !== undefined ) {\n\n\t\t\t\treturn meta.textures[ this.uuid ];\n\n\t\t\t}\n\n\t\t\tfunction getDataURL( image ) {\n\n\t\t\t\tvar canvas;\n\n\t\t\t\tif ( image.toDataURL !== undefined ) {\n\n\t\t\t\t\tcanvas = image;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcanvas = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\n\t\t\t\t\tcanvas.width = image.width;\n\t\t\t\t\tcanvas.height = image.height;\n\n\t\t\t\t\tcanvas.getContext( '2d' ).drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\t\t}\n\n\t\t\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\n\n\t\t\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn canvas.toDataURL( 'image/png' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar output = {\n\t\t\t\tmetadata: {\n\t\t\t\t\tversion: 4.4,\n\t\t\t\t\ttype: 'Texture',\n\t\t\t\t\tgenerator: 'Texture.toJSON'\n\t\t\t\t},\n\n\t\t\t\tuuid: this.uuid,\n\t\t\t\tname: this.name,\n\n\t\t\t\tmapping: this.mapping,\n\n\t\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\n\t\t\t\toffset: [ this.offset.x, this.offset.y ],\n\t\t\t\twrap: [ this.wrapS, this.wrapT ],\n\n\t\t\t\tminFilter: this.minFilter,\n\t\t\t\tmagFilter: this.magFilter,\n\t\t\t\tanisotropy: this.anisotropy,\n\n\t\t\t\tflipY: this.flipY\n\t\t\t};\n\n\t\t\tif ( this.image !== undefined ) {\n\n\t\t\t\t// TODO: Move to THREE.Image\n\n\t\t\t\tvar image = this.image;\n\n\t\t\t\tif ( image.uuid === undefined ) {\n\n\t\t\t\t\timage.uuid = _Math.generateUUID(); // UGH\n\n\t\t\t\t}\n\n\t\t\t\tif ( meta.images[ image.uuid ] === undefined ) {\n\n\t\t\t\t\tmeta.images[ image.uuid ] = {\n\t\t\t\t\t\tuuid: image.uuid,\n\t\t\t\t\t\turl: getDataURL( image )\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\toutput.image = image.uuid;\n\n\t\t\t}\n\n\t\t\tmeta.textures[ this.uuid ] = output;\n\n\t\t\treturn output;\n\n\t\t},\n\n\t\tdispose: function () {\n\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\t},\n\n\t\ttransformUv: function ( uv ) {\n\n\t\t\tif ( this.mapping !== UVMapping ) return;\n\n\t\t\tuv.multiply( this.repeat );\n\t\t\tuv.add( this.offset );\n\n\t\t\tif ( uv.x < 0 || uv.x > 1 ) {\n\n\t\t\t\tswitch ( this.wrapS ) {\n\n\t\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( uv.y < 0 || uv.y > 1 ) {\n\n\t\t\t\tswitch ( this.wrapT ) {\n\n\t\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.flipY ) {\n\n\t\t\t\tuv.y = 1 - uv.y;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tObject.assign( Texture.prototype, EventDispatcher.prototype );\n\n\t/**\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\n\t * @author philogb / http://blog.thejit.org/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author egraether / http://egraether.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t */\n\n\tfunction Vector4( x, y, z, w ) {\n\n\t\tthis.x = x || 0;\n\t\tthis.y = y || 0;\n\t\tthis.z = z || 0;\n\t\tthis.w = ( w !== undefined ) ? w : 1;\n\n\t}\n\n\tVector4.prototype = {\n\n\t\tconstructor: Vector4,\n\n\t\tisVector4: true,\n\n\t\tset: function ( x, y, z, w ) {\n\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.z = z;\n\t\t\tthis.w = w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetScalar: function ( scalar ) {\n\n\t\t\tthis.x = scalar;\n\t\t\tthis.y = scalar;\n\t\t\tthis.z = scalar;\n\t\t\tthis.w = scalar;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetX: function ( x ) {\n\n\t\t\tthis.x = x;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetY: function ( y ) {\n\n\t\t\tthis.y = y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetZ: function ( z ) {\n\n\t\t\tthis.z = z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetW: function ( w ) {\n\n\t\t\tthis.w = w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetComponent: function ( index, value ) {\n\n\t\t\tswitch ( index ) {\n\n\t\t\t\tcase 0: this.x = value; break;\n\t\t\t\tcase 1: this.y = value; break;\n\t\t\t\tcase 2: this.z = value; break;\n\t\t\t\tcase 3: this.w = value; break;\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetComponent: function ( index ) {\n\n\t\t\tswitch ( index ) {\n\n\t\t\t\tcase 0: return this.x;\n\t\t\t\tcase 1: return this.y;\n\t\t\t\tcase 2: return this.z;\n\t\t\t\tcase 3: return this.w;\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t\t}\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\n\n\t\t},\n\n\t\tcopy: function ( v ) {\n\n\t\t\tthis.x = v.x;\n\t\t\tthis.y = v.y;\n\t\t\tthis.z = v.z;\n\t\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tadd: function ( v, w ) {\n\n\t\t\tif ( w !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\t\treturn this.addVectors( v, w );\n\n\t\t\t}\n\n\t\t\tthis.x += v.x;\n\t\t\tthis.y += v.y;\n\t\t\tthis.z += v.z;\n\t\t\tthis.w += v.w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddScalar: function ( s ) {\n\n\t\t\tthis.x += s;\n\t\t\tthis.y += s;\n\t\t\tthis.z += s;\n\t\t\tthis.w += s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddVectors: function ( a, b ) {\n\n\t\t\tthis.x = a.x + b.x;\n\t\t\tthis.y = a.y + b.y;\n\t\t\tthis.z = a.z + b.z;\n\t\t\tthis.w = a.w + b.w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddScaledVector: function ( v, s ) {\n\n\t\t\tthis.x += v.x * s;\n\t\t\tthis.y += v.y * s;\n\t\t\tthis.z += v.z * s;\n\t\t\tthis.w += v.w * s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsub: function ( v, w ) {\n\n\t\t\tif ( w !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\t\treturn this.subVectors( v, w );\n\n\t\t\t}\n\n\t\t\tthis.x -= v.x;\n\t\t\tthis.y -= v.y;\n\t\t\tthis.z -= v.z;\n\t\t\tthis.w -= v.w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsubScalar: function ( s ) {\n\n\t\t\tthis.x -= s;\n\t\t\tthis.y -= s;\n\t\t\tthis.z -= s;\n\t\t\tthis.w -= s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsubVectors: function ( a, b ) {\n\n\t\t\tthis.x = a.x - b.x;\n\t\t\tthis.y = a.y - b.y;\n\t\t\tthis.z = a.z - b.z;\n\t\t\tthis.w = a.w - b.w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiplyScalar: function ( scalar ) {\n\n\t\t\tif ( isFinite( scalar ) ) {\n\n\t\t\t\tthis.x *= scalar;\n\t\t\t\tthis.y *= scalar;\n\t\t\t\tthis.z *= scalar;\n\t\t\t\tthis.w *= scalar;\n\n\t\t\t} else {\n\n\t\t\t\tthis.x = 0;\n\t\t\t\tthis.y = 0;\n\t\t\t\tthis.z = 0;\n\t\t\t\tthis.w = 0;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tapplyMatrix4: function ( m ) {\n\n\t\t\tvar x = this.x, y = this.y, z = this.z, w = this.w;\n\t\t\tvar e = m.elements;\n\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n\t\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdivideScalar: function ( scalar ) {\n\n\t\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t\t},\n\n\t\tsetAxisAngleFromQuaternion: function ( q ) {\n\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n\n\t\t\t// q is assumed to be normalized\n\n\t\t\tthis.w = 2 * Math.acos( q.w );\n\n\t\t\tvar s = Math.sqrt( 1 - q.w * q.w );\n\n\t\t\tif ( s < 0.0001 ) {\n\n\t\t\t\t this.x = 1;\n\t\t\t\t this.y = 0;\n\t\t\t\t this.z = 0;\n\n\t\t\t} else {\n\n\t\t\t\t this.x = q.x / s;\n\t\t\t\t this.y = q.y / s;\n\t\t\t\t this.z = q.z / s;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetAxisAngleFromRotationMatrix: function ( m ) {\n\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\n\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\t\tvar angle, x, y, z,\t\t// variables for result\n\t\t\t\tepsilon = 0.01,\t\t// margin to allow for rounding errors\n\t\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\n\n\t\t\t\tte = m.elements,\n\n\t\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\n\t\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\n\t\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\n\n\t\t\t\t// singularity found\n\t\t\t\t// first check for identity matrix which must have +1 for all terms\n\t\t\t\t// in leading diagonal and zero in other terms\n\n\t\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\n\t\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\n\t\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\n\t\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\n\n\t\t\t\t\t// this singularity is identity matrix so angle = 0\n\n\t\t\t\t\tthis.set( 1, 0, 0, 0 );\n\n\t\t\t\t\treturn this; // zero angle, arbitrary axis\n\n\t\t\t\t}\n\n\t\t\t\t// otherwise this singularity is angle = 180\n\n\t\t\t\tangle = Math.PI;\n\n\t\t\t\tvar xx = ( m11 + 1 ) / 2;\n\t\t\t\tvar yy = ( m22 + 1 ) / 2;\n\t\t\t\tvar zz = ( m33 + 1 ) / 2;\n\t\t\t\tvar xy = ( m12 + m21 ) / 4;\n\t\t\t\tvar xz = ( m13 + m31 ) / 4;\n\t\t\t\tvar yz = ( m23 + m32 ) / 4;\n\n\t\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\n\n\t\t\t\t\t// m11 is the largest diagonal term\n\n\t\t\t\t\tif ( xx < epsilon ) {\n\n\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tx = Math.sqrt( xx );\n\t\t\t\t\t\ty = xy / x;\n\t\t\t\t\t\tz = xz / x;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( yy > zz ) {\n\n\t\t\t\t\t// m22 is the largest diagonal term\n\n\t\t\t\t\tif ( yy < epsilon ) {\n\n\t\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\t\ty = 0;\n\t\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ty = Math.sqrt( yy );\n\t\t\t\t\t\tx = xy / y;\n\t\t\t\t\t\tz = yz / y;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// m33 is the largest diagonal term so base result on this\n\n\t\t\t\t\tif ( zz < epsilon ) {\n\n\t\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\t\tz = 0;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tz = Math.sqrt( zz );\n\t\t\t\t\t\tx = xz / z;\n\t\t\t\t\t\ty = yz / z;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tthis.set( x, y, z, angle );\n\n\t\t\t\treturn this; // return 180 deg rotation\n\n\t\t\t}\n\n\t\t\t// as we have reached here there are no singularities so we can handle normally\n\n\t\t\tvar s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\n\t\t\t                   ( m13 - m31 ) * ( m13 - m31 ) +\n\t\t\t                   ( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\n\n\t\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\n\n\t\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\n\t\t\t// caught by singularity test above, but I've left it in just in case\n\n\t\t\tthis.x = ( m32 - m23 ) / s;\n\t\t\tthis.y = ( m13 - m31 ) / s;\n\t\t\tthis.z = ( m21 - m12 ) / s;\n\t\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmin: function ( v ) {\n\n\t\t\tthis.x = Math.min( this.x, v.x );\n\t\t\tthis.y = Math.min( this.y, v.y );\n\t\t\tthis.z = Math.min( this.z, v.z );\n\t\t\tthis.w = Math.min( this.w, v.w );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmax: function ( v ) {\n\n\t\t\tthis.x = Math.max( this.x, v.x );\n\t\t\tthis.y = Math.max( this.y, v.y );\n\t\t\tthis.z = Math.max( this.z, v.z );\n\t\t\tthis.w = Math.max( this.w, v.w );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclamp: function ( min, max ) {\n\n\t\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\n\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\t\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclampScalar: function () {\n\n\t\t\tvar min, max;\n\n\t\t\treturn function clampScalar( minVal, maxVal ) {\n\n\t\t\t\tif ( min === undefined ) {\n\n\t\t\t\t\tmin = new Vector4();\n\t\t\t\t\tmax = new Vector4();\n\n\t\t\t\t}\n\n\t\t\t\tmin.set( minVal, minVal, minVal, minVal );\n\t\t\t\tmax.set( maxVal, maxVal, maxVal, maxVal );\n\n\t\t\t\treturn this.clamp( min, max );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tfloor: function () {\n\n\t\t\tthis.x = Math.floor( this.x );\n\t\t\tthis.y = Math.floor( this.y );\n\t\t\tthis.z = Math.floor( this.z );\n\t\t\tthis.w = Math.floor( this.w );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tceil: function () {\n\n\t\t\tthis.x = Math.ceil( this.x );\n\t\t\tthis.y = Math.ceil( this.y );\n\t\t\tthis.z = Math.ceil( this.z );\n\t\t\tthis.w = Math.ceil( this.w );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tround: function () {\n\n\t\t\tthis.x = Math.round( this.x );\n\t\t\tthis.y = Math.round( this.y );\n\t\t\tthis.z = Math.round( this.z );\n\t\t\tthis.w = Math.round( this.w );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\troundToZero: function () {\n\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\t\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tnegate: function () {\n\n\t\t\tthis.x = - this.x;\n\t\t\tthis.y = - this.y;\n\t\t\tthis.z = - this.z;\n\t\t\tthis.w = - this.w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdot: function ( v ) {\n\n\t\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\n\n\t\t},\n\n\t\tlengthSq: function () {\n\n\t\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\n\n\t\t},\n\n\t\tlength: function () {\n\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n\t\t},\n\n\t\tlengthManhattan: function () {\n\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\n\n\t\t},\n\n\t\tnormalize: function () {\n\n\t\t\treturn this.divideScalar( this.length() );\n\n\t\t},\n\n\t\tsetLength: function ( length ) {\n\n\t\t\treturn this.multiplyScalar( length / this.length() );\n\n\t\t},\n\n\t\tlerp: function ( v, alpha ) {\n\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\t\tthis.z += ( v.z - this.z ) * alpha;\n\t\t\tthis.w += ( v.w - this.w ) * alpha;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tlerpVectors: function ( v1, v2, alpha ) {\n\n\t\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\n\n\t\t},\n\n\t\tequals: function ( v ) {\n\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\n\n\t\t},\n\n\t\tfromArray: function ( array, offset ) {\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tthis.x = array[ offset ];\n\t\t\tthis.y = array[ offset + 1 ];\n\t\t\tthis.z = array[ offset + 2 ];\n\t\t\tthis.w = array[ offset + 3 ];\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoArray: function ( array, offset ) {\n\n\t\t\tif ( array === undefined ) array = [];\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tarray[ offset ] = this.x;\n\t\t\tarray[ offset + 1 ] = this.y;\n\t\t\tarray[ offset + 2 ] = this.z;\n\t\t\tarray[ offset + 3 ] = this.w;\n\n\t\t\treturn array;\n\n\t\t},\n\n\t\tfromBufferAttribute: function ( attribute, index, offset ) {\n\n\t\t\tif ( offset !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector4: offset has been removed from .fromBufferAttribute().' );\n\n\t\t\t}\n\n\t\t\tthis.x = attribute.getX( index );\n\t\t\tthis.y = attribute.getY( index );\n\t\t\tthis.z = attribute.getZ( index );\n\t\t\tthis.w = attribute.getW( index );\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author szimek / https://github.com/szimek/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author Marius Kintel / https://github.com/kintel\n\t */\n\n\t/*\n\t In options, we can specify:\n\t * Texture parameters for an auto-generated target texture\n\t * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\n\t*/\n\tfunction WebGLRenderTarget( width, height, options ) {\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t\tthis.scissor = new Vector4( 0, 0, width, height );\n\t\tthis.scissorTest = false;\n\n\t\tthis.viewport = new Vector4( 0, 0, width, height );\n\n\t\toptions = options || {};\n\n\t\tif ( options.minFilter === undefined ) options.minFilter = LinearFilter;\n\n\t\tthis.texture = new Texture( undefined, undefined, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\n\n\t\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\n\t\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\n\t\tthis.depthTexture = options.depthTexture !== undefined ? options.depthTexture : null;\n\n\t\tthis.texture.name = options.name !== undefined ? options.name : \"\";\n\n\t}\n\n\tWebGLRenderTarget.prototype = {\n\n\t\tconstructor: WebGLRenderTarget,\n\n\t\tisWebGLRenderTarget: true,\n\n\t\tsetSize: function ( width, height ) {\n\n\t\t\tif ( this.width !== width || this.height !== height ) {\n\n\t\t\t\tthis.width = width;\n\t\t\t\tthis.height = height;\n\n\t\t\t\tthis.dispose();\n\n\t\t\t}\n\n\t\t\tthis.viewport.set( 0, 0, width, height );\n\t\t\tthis.scissor.set( 0, 0, width, height );\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( source ) {\n\n\t\t\tthis.width = source.width;\n\t\t\tthis.height = source.height;\n\n\t\t\tthis.viewport.copy( source.viewport );\n\n\t\t\tthis.texture = source.texture.clone();\n\n\t\t\tthis.depthBuffer = source.depthBuffer;\n\t\t\tthis.stencilBuffer = source.stencilBuffer;\n\t\t\tthis.depthTexture = source.depthTexture;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdispose: function () {\n\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\t}\n\n\t};\n\n\tObject.assign( WebGLRenderTarget.prototype, EventDispatcher.prototype );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com\n\t */\n\n\tfunction WebGLRenderTargetCube( width, height, options ) {\n\n\t\tWebGLRenderTarget.call( this, width, height, options );\n\n\t\tthis.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\n\t\tthis.activeMipMapLevel = 0;\n\n\t}\n\n\tWebGLRenderTargetCube.prototype = Object.create( WebGLRenderTarget.prototype );\n\tWebGLRenderTargetCube.prototype.constructor = WebGLRenderTargetCube;\n\n\tWebGLRenderTargetCube.prototype.isWebGLRenderTargetCube = true;\n\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author bhouston / http://clara.io\n\t */\n\n\tfunction Quaternion( x, y, z, w ) {\n\n\t\tthis._x = x || 0;\n\t\tthis._y = y || 0;\n\t\tthis._z = z || 0;\n\t\tthis._w = ( w !== undefined ) ? w : 1;\n\n\t}\n\n\tQuaternion.prototype = {\n\n\t\tconstructor: Quaternion,\n\n\t\tget x () {\n\n\t\t\treturn this._x;\n\n\t\t},\n\n\t\tset x ( value ) {\n\n\t\t\tthis._x = value;\n\t\t\tthis.onChangeCallback();\n\n\t\t},\n\n\t\tget y () {\n\n\t\t\treturn this._y;\n\n\t\t},\n\n\t\tset y ( value ) {\n\n\t\t\tthis._y = value;\n\t\t\tthis.onChangeCallback();\n\n\t\t},\n\n\t\tget z () {\n\n\t\t\treturn this._z;\n\n\t\t},\n\n\t\tset z ( value ) {\n\n\t\t\tthis._z = value;\n\t\t\tthis.onChangeCallback();\n\n\t\t},\n\n\t\tget w () {\n\n\t\t\treturn this._w;\n\n\t\t},\n\n\t\tset w ( value ) {\n\n\t\t\tthis._w = value;\n\t\t\tthis.onChangeCallback();\n\n\t\t},\n\n\t\tset: function ( x, y, z, w ) {\n\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\t\t\tthis._w = w;\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\n\n\t\t},\n\n\t\tcopy: function ( quaternion ) {\n\n\t\t\tthis._x = quaternion.x;\n\t\t\tthis._y = quaternion.y;\n\t\t\tthis._z = quaternion.z;\n\t\t\tthis._w = quaternion.w;\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromEuler: function ( euler, update ) {\n\n\t\t\tif ( (euler && euler.isEuler) === false ) {\n\n\t\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.' );\n\n\t\t\t}\n\n\t\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\n\t\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t\t\t//\tcontent/SpinCalc.m\n\n\t\t\tvar c1 = Math.cos( euler._x / 2 );\n\t\t\tvar c2 = Math.cos( euler._y / 2 );\n\t\t\tvar c3 = Math.cos( euler._z / 2 );\n\t\t\tvar s1 = Math.sin( euler._x / 2 );\n\t\t\tvar s2 = Math.sin( euler._y / 2 );\n\t\t\tvar s3 = Math.sin( euler._z / 2 );\n\n\t\t\tvar order = euler.order;\n\n\t\t\tif ( order === 'XYZ' ) {\n\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\n\t\t\t} else if ( order === 'YXZ' ) {\n\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\n\t\t\t} else if ( order === 'ZXY' ) {\n\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\n\t\t\t} else if ( order === 'ZYX' ) {\n\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\n\t\t\t} else if ( order === 'YZX' ) {\n\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\n\t\t\t} else if ( order === 'XZY' ) {\n\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\n\t\t\t}\n\n\t\t\tif ( update !== false ) this.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromAxisAngle: function ( axis, angle ) {\n\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\n\t\t\t// assumes axis is normalized\n\n\t\t\tvar halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n\t\t\tthis._x = axis.x * s;\n\t\t\tthis._y = axis.y * s;\n\t\t\tthis._z = axis.z * s;\n\t\t\tthis._w = Math.cos( halfAngle );\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromRotationMatrix: function ( m ) {\n\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\t\tvar te = m.elements,\n\n\t\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n\t\t\t\ttrace = m11 + m22 + m33,\n\t\t\t\ts;\n\n\t\t\tif ( trace > 0 ) {\n\n\t\t\t\ts = 0.5 / Math.sqrt( trace + 1.0 );\n\n\t\t\t\tthis._w = 0.25 / s;\n\t\t\t\tthis._x = ( m32 - m23 ) * s;\n\t\t\t\tthis._y = ( m13 - m31 ) * s;\n\t\t\t\tthis._z = ( m21 - m12 ) * s;\n\n\t\t\t} else if ( m11 > m22 && m11 > m33 ) {\n\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\n\n\t\t\t\tthis._w = ( m32 - m23 ) / s;\n\t\t\t\tthis._x = 0.25 * s;\n\t\t\t\tthis._y = ( m12 + m21 ) / s;\n\t\t\t\tthis._z = ( m13 + m31 ) / s;\n\n\t\t\t} else if ( m22 > m33 ) {\n\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\n\n\t\t\t\tthis._w = ( m13 - m31 ) / s;\n\t\t\t\tthis._x = ( m12 + m21 ) / s;\n\t\t\t\tthis._y = 0.25 * s;\n\t\t\t\tthis._z = ( m23 + m32 ) / s;\n\n\t\t\t} else {\n\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\n\n\t\t\t\tthis._w = ( m21 - m12 ) / s;\n\t\t\t\tthis._x = ( m13 + m31 ) / s;\n\t\t\t\tthis._y = ( m23 + m32 ) / s;\n\t\t\t\tthis._z = 0.25 * s;\n\n\t\t\t}\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromUnitVectors: function () {\n\n\t\t\t// http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\n\n\t\t\t// assumes direction vectors vFrom and vTo are normalized\n\n\t\t\tvar v1, r;\n\n\t\t\tvar EPS = 0.000001;\n\n\t\t\treturn function setFromUnitVectors( vFrom, vTo ) {\n\n\t\t\t\tif ( v1 === undefined ) v1 = new Vector3();\n\n\t\t\t\tr = vFrom.dot( vTo ) + 1;\n\n\t\t\t\tif ( r < EPS ) {\n\n\t\t\t\t\tr = 0;\n\n\t\t\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n\n\t\t\t\t\t\tv1.set( - vFrom.y, vFrom.x, 0 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tv1.set( 0, - vFrom.z, vFrom.y );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv1.crossVectors( vFrom, vTo );\n\n\t\t\t\t}\n\n\t\t\t\tthis._x = v1.x;\n\t\t\t\tthis._y = v1.y;\n\t\t\t\tthis._z = v1.z;\n\t\t\t\tthis._w = r;\n\n\t\t\t\treturn this.normalize();\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tinverse: function () {\n\n\t\t\treturn this.conjugate().normalize();\n\n\t\t},\n\n\t\tconjugate: function () {\n\n\t\t\tthis._x *= - 1;\n\t\t\tthis._y *= - 1;\n\t\t\tthis._z *= - 1;\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdot: function ( v ) {\n\n\t\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n\n\t\t},\n\n\t\tlengthSq: function () {\n\n\t\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n\n\t\t},\n\n\t\tlength: function () {\n\n\t\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\n\n\t\t},\n\n\t\tnormalize: function () {\n\n\t\t\tvar l = this.length();\n\n\t\t\tif ( l === 0 ) {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._y = 0;\n\t\t\t\tthis._z = 0;\n\t\t\t\tthis._w = 1;\n\n\t\t\t} else {\n\n\t\t\t\tl = 1 / l;\n\n\t\t\t\tthis._x = this._x * l;\n\t\t\t\tthis._y = this._y * l;\n\t\t\t\tthis._z = this._z * l;\n\t\t\t\tthis._w = this._w * l;\n\n\t\t\t}\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiply: function ( q, p ) {\n\n\t\t\tif ( p !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\n\t\t\t\treturn this.multiplyQuaternions( q, p );\n\n\t\t\t}\n\n\t\t\treturn this.multiplyQuaternions( this, q );\n\n\t\t},\n\n\t\tpremultiply: function ( q ) {\n\n\t\t\treturn this.multiplyQuaternions( q, this );\n\n\t\t},\n\n\t\tmultiplyQuaternions: function ( a, b ) {\n\n\t\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n\t\t\tvar qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\n\t\t\tvar qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\n\n\t\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n\t\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n\t\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n\t\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tslerp: function ( qb, t ) {\n\n\t\t\tif ( t === 0 ) return this;\n\t\t\tif ( t === 1 ) return this.copy( qb );\n\n\t\t\tvar x = this._x, y = this._y, z = this._z, w = this._w;\n\n\t\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n\t\t\tvar cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n\t\t\tif ( cosHalfTheta < 0 ) {\n\n\t\t\t\tthis._w = - qb._w;\n\t\t\t\tthis._x = - qb._x;\n\t\t\t\tthis._y = - qb._y;\n\t\t\t\tthis._z = - qb._z;\n\n\t\t\t\tcosHalfTheta = - cosHalfTheta;\n\n\t\t\t} else {\n\n\t\t\t\tthis.copy( qb );\n\n\t\t\t}\n\n\t\t\tif ( cosHalfTheta >= 1.0 ) {\n\n\t\t\t\tthis._w = w;\n\t\t\t\tthis._x = x;\n\t\t\t\tthis._y = y;\n\t\t\t\tthis._z = z;\n\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t\tvar sinHalfTheta = Math.sqrt( 1.0 - cosHalfTheta * cosHalfTheta );\n\n\t\t\tif ( Math.abs( sinHalfTheta ) < 0.001 ) {\n\n\t\t\t\tthis._w = 0.5 * ( w + this._w );\n\t\t\t\tthis._x = 0.5 * ( x + this._x );\n\t\t\t\tthis._y = 0.5 * ( y + this._y );\n\t\t\t\tthis._z = 0.5 * ( z + this._z );\n\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t\tvar halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\n\t\t\tvar ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n\t\t\tthis._w = ( w * ratioA + this._w * ratioB );\n\t\t\tthis._x = ( x * ratioA + this._x * ratioB );\n\t\t\tthis._y = ( y * ratioA + this._y * ratioB );\n\t\t\tthis._z = ( z * ratioA + this._z * ratioB );\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tequals: function ( quaternion ) {\n\n\t\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\n\n\t\t},\n\n\t\tfromArray: function ( array, offset ) {\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tthis._x = array[ offset ];\n\t\t\tthis._y = array[ offset + 1 ];\n\t\t\tthis._z = array[ offset + 2 ];\n\t\t\tthis._w = array[ offset + 3 ];\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoArray: function ( array, offset ) {\n\n\t\t\tif ( array === undefined ) array = [];\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tarray[ offset ] = this._x;\n\t\t\tarray[ offset + 1 ] = this._y;\n\t\t\tarray[ offset + 2 ] = this._z;\n\t\t\tarray[ offset + 3 ] = this._w;\n\n\t\t\treturn array;\n\n\t\t},\n\n\t\tonChange: function ( callback ) {\n\n\t\t\tthis.onChangeCallback = callback;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tonChangeCallback: function () {}\n\n\t};\n\n\tObject.assign( Quaternion, {\n\n\t\tslerp: function( qa, qb, qm, t ) {\n\n\t\t\treturn qm.copy( qa ).slerp( qb, t );\n\n\t\t},\n\n\t\tslerpFlat: function(\n\t\t\t\tdst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\n\n\t\t\t// fuzz-free, array-based Quaternion SLERP operation\n\n\t\t\tvar x0 = src0[ srcOffset0 + 0 ],\n\t\t\t\ty0 = src0[ srcOffset0 + 1 ],\n\t\t\t\tz0 = src0[ srcOffset0 + 2 ],\n\t\t\t\tw0 = src0[ srcOffset0 + 3 ],\n\n\t\t\t\tx1 = src1[ srcOffset1 + 0 ],\n\t\t\t\ty1 = src1[ srcOffset1 + 1 ],\n\t\t\t\tz1 = src1[ srcOffset1 + 2 ],\n\t\t\t\tw1 = src1[ srcOffset1 + 3 ];\n\n\t\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\n\n\t\t\t\tvar s = 1 - t,\n\n\t\t\t\t\tcos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\n\n\t\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\n\t\t\t\t\tsqrSin = 1 - cos * cos;\n\n\t\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\n\t\t\t\tif ( sqrSin > Number.EPSILON ) {\n\n\t\t\t\t\tvar sin = Math.sqrt( sqrSin ),\n\t\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\n\n\t\t\t\t\ts = Math.sin( s * len ) / sin;\n\t\t\t\t\tt = Math.sin( t * len ) / sin;\n\n\t\t\t\t}\n\n\t\t\t\tvar tDir = t * dir;\n\n\t\t\t\tx0 = x0 * s + x1 * tDir;\n\t\t\t\ty0 = y0 * s + y1 * tDir;\n\t\t\t\tz0 = z0 * s + z1 * tDir;\n\t\t\t\tw0 = w0 * s + w1 * tDir;\n\n\t\t\t\t// Normalize in case we just did a lerp:\n\t\t\t\tif ( s === 1 - t ) {\n\n\t\t\t\t\tvar f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\n\n\t\t\t\t\tx0 *= f;\n\t\t\t\t\ty0 *= f;\n\t\t\t\t\tz0 *= f;\n\t\t\t\t\tw0 *= f;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tdst[ dstOffset ] = x0;\n\t\t\tdst[ dstOffset + 1 ] = y0;\n\t\t\tdst[ dstOffset + 2 ] = z0;\n\t\t\tdst[ dstOffset + 3 ] = w0;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author *kile / http://kile.stravaganza.org/\n\t * @author philogb / http://blog.thejit.org/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author egraether / http://egraether.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t */\n\n\tfunction Vector3( x, y, z ) {\n\n\t\tthis.x = x || 0;\n\t\tthis.y = y || 0;\n\t\tthis.z = z || 0;\n\n\t}\n\n\tVector3.prototype = {\n\n\t\tconstructor: Vector3,\n\n\t\tisVector3: true,\n\n\t\tset: function ( x, y, z ) {\n\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.z = z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetScalar: function ( scalar ) {\n\n\t\t\tthis.x = scalar;\n\t\t\tthis.y = scalar;\n\t\t\tthis.z = scalar;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetX: function ( x ) {\n\n\t\t\tthis.x = x;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetY: function ( y ) {\n\n\t\t\tthis.y = y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetZ: function ( z ) {\n\n\t\t\tthis.z = z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetComponent: function ( index, value ) {\n\n\t\t\tswitch ( index ) {\n\n\t\t\t\tcase 0: this.x = value; break;\n\t\t\t\tcase 1: this.y = value; break;\n\t\t\t\tcase 2: this.z = value; break;\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetComponent: function ( index ) {\n\n\t\t\tswitch ( index ) {\n\n\t\t\t\tcase 0: return this.x;\n\t\t\t\tcase 1: return this.y;\n\t\t\t\tcase 2: return this.z;\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t\t}\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this.x, this.y, this.z );\n\n\t\t},\n\n\t\tcopy: function ( v ) {\n\n\t\t\tthis.x = v.x;\n\t\t\tthis.y = v.y;\n\t\t\tthis.z = v.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tadd: function ( v, w ) {\n\n\t\t\tif ( w !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\t\treturn this.addVectors( v, w );\n\n\t\t\t}\n\n\t\t\tthis.x += v.x;\n\t\t\tthis.y += v.y;\n\t\t\tthis.z += v.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddScalar: function ( s ) {\n\n\t\t\tthis.x += s;\n\t\t\tthis.y += s;\n\t\t\tthis.z += s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddVectors: function ( a, b ) {\n\n\t\t\tthis.x = a.x + b.x;\n\t\t\tthis.y = a.y + b.y;\n\t\t\tthis.z = a.z + b.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddScaledVector: function ( v, s ) {\n\n\t\t\tthis.x += v.x * s;\n\t\t\tthis.y += v.y * s;\n\t\t\tthis.z += v.z * s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsub: function ( v, w ) {\n\n\t\t\tif ( w !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\t\treturn this.subVectors( v, w );\n\n\t\t\t}\n\n\t\t\tthis.x -= v.x;\n\t\t\tthis.y -= v.y;\n\t\t\tthis.z -= v.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsubScalar: function ( s ) {\n\n\t\t\tthis.x -= s;\n\t\t\tthis.y -= s;\n\t\t\tthis.z -= s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsubVectors: function ( a, b ) {\n\n\t\t\tthis.x = a.x - b.x;\n\t\t\tthis.y = a.y - b.y;\n\t\t\tthis.z = a.z - b.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiply: function ( v, w ) {\n\n\t\t\tif ( w !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\n\t\t\t\treturn this.multiplyVectors( v, w );\n\n\t\t\t}\n\n\t\t\tthis.x *= v.x;\n\t\t\tthis.y *= v.y;\n\t\t\tthis.z *= v.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiplyScalar: function ( scalar ) {\n\n\t\t\tif ( isFinite( scalar ) ) {\n\n\t\t\t\tthis.x *= scalar;\n\t\t\t\tthis.y *= scalar;\n\t\t\t\tthis.z *= scalar;\n\n\t\t\t} else {\n\n\t\t\t\tthis.x = 0;\n\t\t\t\tthis.y = 0;\n\t\t\t\tthis.z = 0;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiplyVectors: function ( a, b ) {\n\n\t\t\tthis.x = a.x * b.x;\n\t\t\tthis.y = a.y * b.y;\n\t\t\tthis.z = a.z * b.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tapplyEuler: function () {\n\n\t\t\tvar quaternion;\n\n\t\t\treturn function applyEuler( euler ) {\n\n\t\t\t\tif ( (euler && euler.isEuler) === false ) {\n\n\t\t\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.' );\n\n\t\t\t\t}\n\n\t\t\t\tif ( quaternion === undefined ) quaternion = new Quaternion();\n\n\t\t\t\treturn this.applyQuaternion( quaternion.setFromEuler( euler ) );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tapplyAxisAngle: function () {\n\n\t\t\tvar quaternion;\n\n\t\t\treturn function applyAxisAngle( axis, angle ) {\n\n\t\t\t\tif ( quaternion === undefined ) quaternion = new Quaternion();\n\n\t\t\t\treturn this.applyQuaternion( quaternion.setFromAxisAngle( axis, angle ) );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tapplyMatrix3: function ( m ) {\n\n\t\t\tvar x = this.x, y = this.y, z = this.z;\n\t\t\tvar e = m.elements;\n\n\t\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\n\t\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\n\t\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tapplyMatrix4: function ( m ) {\n\n\t\t\tvar x = this.x, y = this.y, z = this.z;\n\t\t\tvar e = m.elements;\n\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ];\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ];\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ];\n\t\t\tvar w =  e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ];\n\n\t\t\treturn this.divideScalar( w );\n\n\t\t},\n\n\t\tapplyQuaternion: function ( q ) {\n\n\t\t\tvar x = this.x, y = this.y, z = this.z;\n\t\t\tvar qx = q.x, qy = q.y, qz = q.z, qw = q.w;\n\n\t\t\t// calculate quat * vector\n\n\t\t\tvar ix =  qw * x + qy * z - qz * y;\n\t\t\tvar iy =  qw * y + qz * x - qx * z;\n\t\t\tvar iz =  qw * z + qx * y - qy * x;\n\t\t\tvar iw = - qx * x - qy * y - qz * z;\n\n\t\t\t// calculate result * inverse quat\n\n\t\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\n\t\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\n\t\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tproject: function () {\n\n\t\t\tvar matrix;\n\n\t\t\treturn function project( camera ) {\n\n\t\t\t\tif ( matrix === undefined ) matrix = new Matrix4();\n\n\t\t\t\tmatrix.multiplyMatrices( camera.projectionMatrix, matrix.getInverse( camera.matrixWorld ) );\n\t\t\t\treturn this.applyMatrix4( matrix );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tunproject: function () {\n\n\t\t\tvar matrix;\n\n\t\t\treturn function unproject( camera ) {\n\n\t\t\t\tif ( matrix === undefined ) matrix = new Matrix4();\n\n\t\t\t\tmatrix.multiplyMatrices( camera.matrixWorld, matrix.getInverse( camera.projectionMatrix ) );\n\t\t\t\treturn this.applyMatrix4( matrix );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttransformDirection: function ( m ) {\n\n\t\t\t// input: THREE.Matrix4 affine matrix\n\t\t\t// vector interpreted as a direction\n\n\t\t\tvar x = this.x, y = this.y, z = this.z;\n\t\t\tvar e = m.elements;\n\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\n\n\t\t\treturn this.normalize();\n\n\t\t},\n\n\t\tdivide: function ( v ) {\n\n\t\t\tthis.x /= v.x;\n\t\t\tthis.y /= v.y;\n\t\t\tthis.z /= v.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdivideScalar: function ( scalar ) {\n\n\t\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t\t},\n\n\t\tmin: function ( v ) {\n\n\t\t\tthis.x = Math.min( this.x, v.x );\n\t\t\tthis.y = Math.min( this.y, v.y );\n\t\t\tthis.z = Math.min( this.z, v.z );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmax: function ( v ) {\n\n\t\t\tthis.x = Math.max( this.x, v.x );\n\t\t\tthis.y = Math.max( this.y, v.y );\n\t\t\tthis.z = Math.max( this.z, v.z );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclamp: function ( min, max ) {\n\n\t\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\n\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclampScalar: function () {\n\n\t\t\tvar min, max;\n\n\t\t\treturn function clampScalar( minVal, maxVal ) {\n\n\t\t\t\tif ( min === undefined ) {\n\n\t\t\t\t\tmin = new Vector3();\n\t\t\t\t\tmax = new Vector3();\n\n\t\t\t\t}\n\n\t\t\t\tmin.set( minVal, minVal, minVal );\n\t\t\t\tmax.set( maxVal, maxVal, maxVal );\n\n\t\t\t\treturn this.clamp( min, max );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tclampLength: function ( min, max ) {\n\n\t\t\tvar length = this.length();\n\n\t\t\treturn this.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\n\n\t\t},\n\n\t\tfloor: function () {\n\n\t\t\tthis.x = Math.floor( this.x );\n\t\t\tthis.y = Math.floor( this.y );\n\t\t\tthis.z = Math.floor( this.z );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tceil: function () {\n\n\t\t\tthis.x = Math.ceil( this.x );\n\t\t\tthis.y = Math.ceil( this.y );\n\t\t\tthis.z = Math.ceil( this.z );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tround: function () {\n\n\t\t\tthis.x = Math.round( this.x );\n\t\t\tthis.y = Math.round( this.y );\n\t\t\tthis.z = Math.round( this.z );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\troundToZero: function () {\n\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tnegate: function () {\n\n\t\t\tthis.x = - this.x;\n\t\t\tthis.y = - this.y;\n\t\t\tthis.z = - this.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdot: function ( v ) {\n\n\t\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\n\n\t\t},\n\n\t\tlengthSq: function () {\n\n\t\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\n\n\t\t},\n\n\t\tlength: function () {\n\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n\n\t\t},\n\n\t\tlengthManhattan: function () {\n\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\n\n\t\t},\n\n\t\tnormalize: function () {\n\n\t\t\treturn this.divideScalar( this.length() );\n\n\t\t},\n\n\t\tsetLength: function ( length ) {\n\n\t\t\treturn this.multiplyScalar( length / this.length() );\n\n\t\t},\n\n\t\tlerp: function ( v, alpha ) {\n\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\t\tthis.z += ( v.z - this.z ) * alpha;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tlerpVectors: function ( v1, v2, alpha ) {\n\n\t\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\n\n\t\t},\n\n\t\tcross: function ( v, w ) {\n\n\t\t\tif ( w !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\n\t\t\t\treturn this.crossVectors( v, w );\n\n\t\t\t}\n\n\t\t\tvar x = this.x, y = this.y, z = this.z;\n\n\t\t\tthis.x = y * v.z - z * v.y;\n\t\t\tthis.y = z * v.x - x * v.z;\n\t\t\tthis.z = x * v.y - y * v.x;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcrossVectors: function ( a, b ) {\n\n\t\t\tvar ax = a.x, ay = a.y, az = a.z;\n\t\t\tvar bx = b.x, by = b.y, bz = b.z;\n\n\t\t\tthis.x = ay * bz - az * by;\n\t\t\tthis.y = az * bx - ax * bz;\n\t\t\tthis.z = ax * by - ay * bx;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tprojectOnVector: function ( vector ) {\n\n\t\t\tvar scalar = vector.dot( this ) / vector.lengthSq();\n\n\t\t\treturn this.copy( vector ).multiplyScalar( scalar );\n\n\t\t},\n\n\t\tprojectOnPlane: function () {\n\n\t\t\tvar v1;\n\n\t\t\treturn function projectOnPlane( planeNormal ) {\n\n\t\t\t\tif ( v1 === undefined ) v1 = new Vector3();\n\n\t\t\t\tv1.copy( this ).projectOnVector( planeNormal );\n\n\t\t\t\treturn this.sub( v1 );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\treflect: function () {\n\n\t\t\t// reflect incident vector off plane orthogonal to normal\n\t\t\t// normal is assumed to have unit length\n\n\t\t\tvar v1;\n\n\t\t\treturn function reflect( normal ) {\n\n\t\t\t\tif ( v1 === undefined ) v1 = new Vector3();\n\n\t\t\t\treturn this.sub( v1.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tangleTo: function ( v ) {\n\n\t\t\tvar theta = this.dot( v ) / ( Math.sqrt( this.lengthSq() * v.lengthSq() ) );\n\n\t\t\t// clamp, to handle numerical problems\n\n\t\t\treturn Math.acos( _Math.clamp( theta, - 1, 1 ) );\n\n\t\t},\n\n\t\tdistanceTo: function ( v ) {\n\n\t\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t\t},\n\n\t\tdistanceToSquared: function ( v ) {\n\n\t\t\tvar dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\n\n\t\t\treturn dx * dx + dy * dy + dz * dz;\n\n\t\t},\n\n\t\tdistanceToManhattan: function ( v ) {\n\n\t\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y ) + Math.abs( this.z - v.z );\n\n\t\t},\n\n\t\tsetFromSpherical: function( s ) {\n\n\t\t\tvar sinPhiRadius = Math.sin( s.phi ) * s.radius;\n\n\t\t\tthis.x = sinPhiRadius * Math.sin( s.theta );\n\t\t\tthis.y = Math.cos( s.phi ) * s.radius;\n\t\t\tthis.z = sinPhiRadius * Math.cos( s.theta );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromCylindrical: function( c ) {\n\n\t\t\tthis.x = c.radius * Math.sin( c.theta );\n\t\t\tthis.y = c.y;\n\t\t\tthis.z = c.radius * Math.cos( c.theta );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromMatrixPosition: function ( m ) {\n\n\t\t\treturn this.setFromMatrixColumn( m, 3 );\n\n\t\t},\n\n\t\tsetFromMatrixScale: function ( m ) {\n\n\t\t\tvar sx = this.setFromMatrixColumn( m, 0 ).length();\n\t\t\tvar sy = this.setFromMatrixColumn( m, 1 ).length();\n\t\t\tvar sz = this.setFromMatrixColumn( m, 2 ).length();\n\n\t\t\tthis.x = sx;\n\t\t\tthis.y = sy;\n\t\t\tthis.z = sz;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromMatrixColumn: function ( m, index ) {\n\n\t\t\tif ( typeof m === 'number' ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).' );\n\t\t\t\tvar temp = m;\n\t\t\t\tm = index;\n\t\t\t\tindex = temp;\n\n\t\t\t}\n\n\t\t\treturn this.fromArray( m.elements, index * 4 );\n\n\t\t},\n\n\t\tequals: function ( v ) {\n\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\n\n\t\t},\n\n\t\tfromArray: function ( array, offset ) {\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tthis.x = array[ offset ];\n\t\t\tthis.y = array[ offset + 1 ];\n\t\t\tthis.z = array[ offset + 2 ];\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoArray: function ( array, offset ) {\n\n\t\t\tif ( array === undefined ) array = [];\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tarray[ offset ] = this.x;\n\t\t\tarray[ offset + 1 ] = this.y;\n\t\t\tarray[ offset + 2 ] = this.z;\n\n\t\t\treturn array;\n\n\t\t},\n\n\t\tfromBufferAttribute: function ( attribute, index, offset ) {\n\n\t\t\tif ( offset !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Vector3: offset has been removed from .fromBufferAttribute().' );\n\n\t\t\t}\n\n\t\t\tthis.x = attribute.getX( index );\n\t\t\tthis.y = attribute.getY( index );\n\t\t\tthis.z = attribute.getZ( index );\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\n\t * @author philogb / http://blog.thejit.org/\n\t * @author jordi_ros / http://plattsoft.com\n\t * @author D1plo1d / http://github.com/D1plo1d\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author timknip / http://www.floorplanner.com/\n\t * @author bhouston / http://clara.io\n\t * @author WestLangley / http://github.com/WestLangley\n\t */\n\n\tfunction Matrix4() {\n\n\t\tthis.elements = new Float32Array( [\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t] );\n\n\t\tif ( arguments.length > 0 ) {\n\n\t\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\n\n\t\t}\n\n\t}\n\n\tMatrix4.prototype = {\n\n\t\tconstructor: Matrix4,\n\n\t\tisMatrix4: true,\n\n\t\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\n\t\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\n\t\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\n\t\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tidentity: function () {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, 0, 0,\n\t\t\t\t0, 1, 0, 0,\n\t\t\t\t0, 0, 1, 0,\n\t\t\t\t0, 0, 0, 1\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new Matrix4().fromArray( this.elements );\n\n\t\t},\n\n\t\tcopy: function ( m ) {\n\n\t\t\tthis.elements.set( m.elements );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyPosition: function ( m ) {\n\n\t\t\tvar te = this.elements;\n\t\t\tvar me = m.elements;\n\n\t\t\tte[ 12 ] = me[ 12 ];\n\t\t\tte[ 13 ] = me[ 13 ];\n\t\t\tte[ 14 ] = me[ 14 ];\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\textractBasis: function ( xAxis, yAxis, zAxis ) {\n\n\t\t\txAxis.setFromMatrixColumn( this, 0 );\n\t\t\tyAxis.setFromMatrixColumn( this, 1 );\n\t\t\tzAxis.setFromMatrixColumn( this, 2 );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\n\n\t\t\tthis.set(\n\t\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\n\t\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\n\t\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\n\t\t\t\t0,       0,       0,       1\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\textractRotation: function () {\n\n\t\t\tvar v1;\n\n\t\t\treturn function extractRotation( m ) {\n\n\t\t\t\tif ( v1 === undefined ) v1 = new Vector3();\n\n\t\t\t\tvar te = this.elements;\n\t\t\t\tvar me = m.elements;\n\n\t\t\t\tvar scaleX = 1 / v1.setFromMatrixColumn( m, 0 ).length();\n\t\t\t\tvar scaleY = 1 / v1.setFromMatrixColumn( m, 1 ).length();\n\t\t\t\tvar scaleZ = 1 / v1.setFromMatrixColumn( m, 2 ).length();\n\n\t\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\n\t\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\n\t\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\n\n\t\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\n\t\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\n\t\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\n\n\t\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\n\t\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\n\t\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tmakeRotationFromEuler: function ( euler ) {\n\n\t\t\tif ( (euler && euler.isEuler) === false ) {\n\n\t\t\t\tconsole.error( 'THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\n\n\t\t\t}\n\n\t\t\tvar te = this.elements;\n\n\t\t\tvar x = euler.x, y = euler.y, z = euler.z;\n\t\t\tvar a = Math.cos( x ), b = Math.sin( x );\n\t\t\tvar c = Math.cos( y ), d = Math.sin( y );\n\t\t\tvar e = Math.cos( z ), f = Math.sin( z );\n\n\t\t\tif ( euler.order === 'XYZ' ) {\n\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\t\tte[ 0 ] = c * e;\n\t\t\t\tte[ 4 ] = - c * f;\n\t\t\t\tte[ 8 ] = d;\n\n\t\t\t\tte[ 1 ] = af + be * d;\n\t\t\t\tte[ 5 ] = ae - bf * d;\n\t\t\t\tte[ 9 ] = - b * c;\n\n\t\t\t\tte[ 2 ] = bf - ae * d;\n\t\t\t\tte[ 6 ] = be + af * d;\n\t\t\t\tte[ 10 ] = a * c;\n\n\t\t\t} else if ( euler.order === 'YXZ' ) {\n\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\t\tte[ 0 ] = ce + df * b;\n\t\t\t\tte[ 4 ] = de * b - cf;\n\t\t\t\tte[ 8 ] = a * d;\n\n\t\t\t\tte[ 1 ] = a * f;\n\t\t\t\tte[ 5 ] = a * e;\n\t\t\t\tte[ 9 ] = - b;\n\n\t\t\t\tte[ 2 ] = cf * b - de;\n\t\t\t\tte[ 6 ] = df + ce * b;\n\t\t\t\tte[ 10 ] = a * c;\n\n\t\t\t} else if ( euler.order === 'ZXY' ) {\n\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\t\tte[ 0 ] = ce - df * b;\n\t\t\t\tte[ 4 ] = - a * f;\n\t\t\t\tte[ 8 ] = de + cf * b;\n\n\t\t\t\tte[ 1 ] = cf + de * b;\n\t\t\t\tte[ 5 ] = a * e;\n\t\t\t\tte[ 9 ] = df - ce * b;\n\n\t\t\t\tte[ 2 ] = - a * d;\n\t\t\t\tte[ 6 ] = b;\n\t\t\t\tte[ 10 ] = a * c;\n\n\t\t\t} else if ( euler.order === 'ZYX' ) {\n\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\t\tte[ 0 ] = c * e;\n\t\t\t\tte[ 4 ] = be * d - af;\n\t\t\t\tte[ 8 ] = ae * d + bf;\n\n\t\t\t\tte[ 1 ] = c * f;\n\t\t\t\tte[ 5 ] = bf * d + ae;\n\t\t\t\tte[ 9 ] = af * d - be;\n\n\t\t\t\tte[ 2 ] = - d;\n\t\t\t\tte[ 6 ] = b * c;\n\t\t\t\tte[ 10 ] = a * c;\n\n\t\t\t} else if ( euler.order === 'YZX' ) {\n\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\t\tte[ 0 ] = c * e;\n\t\t\t\tte[ 4 ] = bd - ac * f;\n\t\t\t\tte[ 8 ] = bc * f + ad;\n\n\t\t\t\tte[ 1 ] = f;\n\t\t\t\tte[ 5 ] = a * e;\n\t\t\t\tte[ 9 ] = - b * e;\n\n\t\t\t\tte[ 2 ] = - d * e;\n\t\t\t\tte[ 6 ] = ad * f + bc;\n\t\t\t\tte[ 10 ] = ac - bd * f;\n\n\t\t\t} else if ( euler.order === 'XZY' ) {\n\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\t\tte[ 0 ] = c * e;\n\t\t\t\tte[ 4 ] = - f;\n\t\t\t\tte[ 8 ] = d * e;\n\n\t\t\t\tte[ 1 ] = ac * f + bd;\n\t\t\t\tte[ 5 ] = a * e;\n\t\t\t\tte[ 9 ] = ad * f - bc;\n\n\t\t\t\tte[ 2 ] = bc * f - ad;\n\t\t\t\tte[ 6 ] = b * e;\n\t\t\t\tte[ 10 ] = bd * f + ac;\n\n\t\t\t}\n\n\t\t\t// last column\n\t\t\tte[ 3 ] = 0;\n\t\t\tte[ 7 ] = 0;\n\t\t\tte[ 11 ] = 0;\n\n\t\t\t// bottom row\n\t\t\tte[ 12 ] = 0;\n\t\t\tte[ 13 ] = 0;\n\t\t\tte[ 14 ] = 0;\n\t\t\tte[ 15 ] = 1;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeRotationFromQuaternion: function ( q ) {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tvar x = q.x, y = q.y, z = q.z, w = q.w;\n\t\t\tvar x2 = x + x, y2 = y + y, z2 = z + z;\n\t\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\n\t\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\n\t\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\n\n\t\t\tte[ 0 ] = 1 - ( yy + zz );\n\t\t\tte[ 4 ] = xy - wz;\n\t\t\tte[ 8 ] = xz + wy;\n\n\t\t\tte[ 1 ] = xy + wz;\n\t\t\tte[ 5 ] = 1 - ( xx + zz );\n\t\t\tte[ 9 ] = yz - wx;\n\n\t\t\tte[ 2 ] = xz - wy;\n\t\t\tte[ 6 ] = yz + wx;\n\t\t\tte[ 10 ] = 1 - ( xx + yy );\n\n\t\t\t// last column\n\t\t\tte[ 3 ] = 0;\n\t\t\tte[ 7 ] = 0;\n\t\t\tte[ 11 ] = 0;\n\n\t\t\t// bottom row\n\t\t\tte[ 12 ] = 0;\n\t\t\tte[ 13 ] = 0;\n\t\t\tte[ 14 ] = 0;\n\t\t\tte[ 15 ] = 1;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tlookAt: function () {\n\n\t\t\tvar x, y, z;\n\n\t\t\treturn function lookAt( eye, target, up ) {\n\n\t\t\t\tif ( x === undefined ) {\n\n\t\t\t\t\tx = new Vector3();\n\t\t\t\t\ty = new Vector3();\n\t\t\t\t\tz = new Vector3();\n\n\t\t\t\t}\n\n\t\t\t\tvar te = this.elements;\n\n\t\t\t\tz.subVectors( eye, target ).normalize();\n\n\t\t\t\tif ( z.lengthSq() === 0 ) {\n\n\t\t\t\t\tz.z = 1;\n\n\t\t\t\t}\n\n\t\t\t\tx.crossVectors( up, z ).normalize();\n\n\t\t\t\tif ( x.lengthSq() === 0 ) {\n\n\t\t\t\t\tz.z += 0.0001;\n\t\t\t\t\tx.crossVectors( up, z ).normalize();\n\n\t\t\t\t}\n\n\t\t\t\ty.crossVectors( z, x );\n\n\n\t\t\t\tte[ 0 ] = x.x; te[ 4 ] = y.x; te[ 8 ] = z.x;\n\t\t\t\tte[ 1 ] = x.y; te[ 5 ] = y.y; te[ 9 ] = z.y;\n\t\t\t\tte[ 2 ] = x.z; te[ 6 ] = y.z; te[ 10 ] = z.z;\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tmultiply: function ( m, n ) {\n\n\t\t\tif ( n !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\n\t\t\t\treturn this.multiplyMatrices( m, n );\n\n\t\t\t}\n\n\t\t\treturn this.multiplyMatrices( this, m );\n\n\t\t},\n\n\t\tpremultiply: function ( m ) {\n\n\t\t\treturn this.multiplyMatrices( m, this );\n\n\t\t},\n\n\t\tmultiplyMatrices: function ( a, b ) {\n\n\t\t\tvar ae = a.elements;\n\t\t\tvar be = b.elements;\n\t\t\tvar te = this.elements;\n\n\t\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\n\t\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\n\t\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\n\t\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\n\n\t\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\n\t\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\n\t\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\n\t\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\n\n\t\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n\t\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n\t\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n\t\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n\n\t\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n\t\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n\t\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n\t\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n\n\t\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n\t\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n\t\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n\t\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n\n\t\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n\t\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n\t\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n\t\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiplyToArray: function ( a, b, r ) {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tthis.multiplyMatrices( a, b );\n\n\t\t\tr[ 0 ] = te[ 0 ]; r[ 1 ] = te[ 1 ]; r[ 2 ] = te[ 2 ]; r[ 3 ] = te[ 3 ];\n\t\t\tr[ 4 ] = te[ 4 ]; r[ 5 ] = te[ 5 ]; r[ 6 ] = te[ 6 ]; r[ 7 ] = te[ 7 ];\n\t\t\tr[ 8 ]  = te[ 8 ]; r[ 9 ]  = te[ 9 ]; r[ 10 ] = te[ 10 ]; r[ 11 ] = te[ 11 ];\n\t\t\tr[ 12 ] = te[ 12 ]; r[ 13 ] = te[ 13 ]; r[ 14 ] = te[ 14 ]; r[ 15 ] = te[ 15 ];\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiplyScalar: function ( s ) {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\n\t\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\n\t\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\n\t\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tapplyToBufferAttribute: function () {\n\n\t\t\tvar v1;\n\n\t\t\treturn function applyToBufferAttribute( attribute ) {\n\n\t\t\t\tif ( v1 === undefined ) v1 = new Vector3();\n\n\t\t\t\tfor ( var i = 0, l = attribute.count; i < l; i ++ ) {\n\n\t\t\t\t\tv1.x = attribute.getX( i );\n\t\t\t\t\tv1.y = attribute.getY( i );\n\t\t\t\t\tv1.z = attribute.getZ( i );\n\n\t\t\t\t\tv1.applyMatrix4( this );\n\n\t\t\t\t\tattribute.setXYZ( i, v1.x, v1.y, v1.z );\n\n\t\t\t\t}\n\n\t\t\t\treturn attribute;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tdeterminant: function () {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\n\t\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\n\t\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\n\t\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\n\n\t\t\t//TODO: make this more efficient\n\t\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\n\n\t\t\treturn (\n\t\t\t\tn41 * (\n\t\t\t\t\t+ n14 * n23 * n32\n\t\t\t\t\t - n13 * n24 * n32\n\t\t\t\t\t - n14 * n22 * n33\n\t\t\t\t\t + n12 * n24 * n33\n\t\t\t\t\t + n13 * n22 * n34\n\t\t\t\t\t - n12 * n23 * n34\n\t\t\t\t) +\n\t\t\t\tn42 * (\n\t\t\t\t\t+ n11 * n23 * n34\n\t\t\t\t\t - n11 * n24 * n33\n\t\t\t\t\t + n14 * n21 * n33\n\t\t\t\t\t - n13 * n21 * n34\n\t\t\t\t\t + n13 * n24 * n31\n\t\t\t\t\t - n14 * n23 * n31\n\t\t\t\t) +\n\t\t\t\tn43 * (\n\t\t\t\t\t+ n11 * n24 * n32\n\t\t\t\t\t - n11 * n22 * n34\n\t\t\t\t\t - n14 * n21 * n32\n\t\t\t\t\t + n12 * n21 * n34\n\t\t\t\t\t + n14 * n22 * n31\n\t\t\t\t\t - n12 * n24 * n31\n\t\t\t\t) +\n\t\t\t\tn44 * (\n\t\t\t\t\t- n13 * n22 * n31\n\t\t\t\t\t - n11 * n23 * n32\n\t\t\t\t\t + n11 * n22 * n33\n\t\t\t\t\t + n13 * n21 * n32\n\t\t\t\t\t - n12 * n21 * n33\n\t\t\t\t\t + n12 * n23 * n31\n\t\t\t\t)\n\n\t\t\t);\n\n\t\t},\n\n\t\ttranspose: function () {\n\n\t\t\tvar te = this.elements;\n\t\t\tvar tmp;\n\n\t\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\n\t\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\n\t\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\n\n\t\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\n\t\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\n\t\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetPosition: function ( v ) {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tte[ 12 ] = v.x;\n\t\t\tte[ 13 ] = v.y;\n\t\t\tte[ 14 ] = v.z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetInverse: function ( m, throwOnDegenerate ) {\n\n\t\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n\t\t\tvar te = this.elements,\n\t\t\t\tme = m.elements,\n\n\t\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ], n41 = me[ 3 ],\n\t\t\t\tn12 = me[ 4 ], n22 = me[ 5 ], n32 = me[ 6 ], n42 = me[ 7 ],\n\t\t\t\tn13 = me[ 8 ], n23 = me[ 9 ], n33 = me[ 10 ], n43 = me[ 11 ],\n\t\t\t\tn14 = me[ 12 ], n24 = me[ 13 ], n34 = me[ 14 ], n44 = me[ 15 ],\n\n\t\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\n\t\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\n\t\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\n\t\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\n\n\t\t\tvar det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\n\n\t\t\tif ( det === 0 ) {\n\n\t\t\t\tvar msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\n\n\t\t\t\tif ( throwOnDegenerate === true ) {\n\n\t\t\t\t\tthrow new Error( msg );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( msg );\n\n\t\t\t\t}\n\n\t\t\t\treturn this.identity();\n\n\t\t\t}\n\n\t\t\tvar detInv = 1 / det;\n\n\t\t\tte[ 0 ] = t11 * detInv;\n\t\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\n\t\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\n\t\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\n\n\t\t\tte[ 4 ] = t12 * detInv;\n\t\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\n\t\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\n\t\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\n\n\t\t\tte[ 8 ] = t13 * detInv;\n\t\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\n\t\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\n\t\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\n\n\t\t\tte[ 12 ] = t14 * detInv;\n\t\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\n\t\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\n\t\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tscale: function ( v ) {\n\n\t\t\tvar te = this.elements;\n\t\t\tvar x = v.x, y = v.y, z = v.z;\n\n\t\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\n\t\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\n\t\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\n\t\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetMaxScaleOnAxis: function () {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\n\t\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\n\t\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\n\n\t\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\n\n\t\t},\n\n\t\tmakeTranslation: function ( x, y, z ) {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, 0, x,\n\t\t\t\t0, 1, 0, y,\n\t\t\t\t0, 0, 1, z,\n\t\t\t\t0, 0, 0, 1\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeRotationX: function ( theta ) {\n\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0,  0, 0,\n\t\t\t\t0, c, - s, 0,\n\t\t\t\t0, s,  c, 0,\n\t\t\t\t0, 0,  0, 1\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeRotationY: function ( theta ) {\n\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\t\tthis.set(\n\n\t\t\t\t c, 0, s, 0,\n\t\t\t\t 0, 1, 0, 0,\n\t\t\t\t- s, 0, c, 0,\n\t\t\t\t 0, 0, 0, 1\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeRotationZ: function ( theta ) {\n\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\t\tthis.set(\n\n\t\t\t\tc, - s, 0, 0,\n\t\t\t\ts,  c, 0, 0,\n\t\t\t\t0,  0, 1, 0,\n\t\t\t\t0,  0, 0, 1\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeRotationAxis: function ( axis, angle ) {\n\n\t\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\n\n\t\t\tvar c = Math.cos( angle );\n\t\t\tvar s = Math.sin( angle );\n\t\t\tvar t = 1 - c;\n\t\t\tvar x = axis.x, y = axis.y, z = axis.z;\n\t\t\tvar tx = t * x, ty = t * y;\n\n\t\t\tthis.set(\n\n\t\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\n\t\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\n\t\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\n\t\t\t\t0, 0, 0, 1\n\n\t\t\t);\n\n\t\t\t return this;\n\n\t\t},\n\n\t\tmakeScale: function ( x, y, z ) {\n\n\t\t\tthis.set(\n\n\t\t\t\tx, 0, 0, 0,\n\t\t\t\t0, y, 0, 0,\n\t\t\t\t0, 0, z, 0,\n\t\t\t\t0, 0, 0, 1\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeShear: function ( x, y, z ) {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, y, z, 0,\n\t\t\t\tx, 1, z, 0,\n\t\t\t\tx, y, 1, 0,\n\t\t\t\t0, 0, 0, 1\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcompose: function ( position, quaternion, scale ) {\n\n\t\t\tthis.makeRotationFromQuaternion( quaternion );\n\t\t\tthis.scale( scale );\n\t\t\tthis.setPosition( position );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdecompose: function () {\n\n\t\t\tvar vector, matrix;\n\n\t\t\treturn function decompose( position, quaternion, scale ) {\n\n\t\t\t\tif ( vector === undefined ) {\n\n\t\t\t\t\tvector = new Vector3();\n\t\t\t\t\tmatrix = new Matrix4();\n\n\t\t\t\t}\n\n\t\t\t\tvar te = this.elements;\n\n\t\t\t\tvar sx = vector.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\n\t\t\t\tvar sy = vector.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\n\t\t\t\tvar sz = vector.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\n\n\t\t\t\t// if determine is negative, we need to invert one scale\n\t\t\t\tvar det = this.determinant();\n\t\t\t\tif ( det < 0 ) {\n\n\t\t\t\t\tsx = - sx;\n\n\t\t\t\t}\n\n\t\t\t\tposition.x = te[ 12 ];\n\t\t\t\tposition.y = te[ 13 ];\n\t\t\t\tposition.z = te[ 14 ];\n\n\t\t\t\t// scale the rotation part\n\n\t\t\t\tmatrix.elements.set( this.elements ); // at this point matrix is incomplete so we can't use .copy()\n\n\t\t\t\tvar invSX = 1 / sx;\n\t\t\t\tvar invSY = 1 / sy;\n\t\t\t\tvar invSZ = 1 / sz;\n\n\t\t\t\tmatrix.elements[ 0 ] *= invSX;\n\t\t\t\tmatrix.elements[ 1 ] *= invSX;\n\t\t\t\tmatrix.elements[ 2 ] *= invSX;\n\n\t\t\t\tmatrix.elements[ 4 ] *= invSY;\n\t\t\t\tmatrix.elements[ 5 ] *= invSY;\n\t\t\t\tmatrix.elements[ 6 ] *= invSY;\n\n\t\t\t\tmatrix.elements[ 8 ] *= invSZ;\n\t\t\t\tmatrix.elements[ 9 ] *= invSZ;\n\t\t\t\tmatrix.elements[ 10 ] *= invSZ;\n\n\t\t\t\tquaternion.setFromRotationMatrix( matrix );\n\n\t\t\t\tscale.x = sx;\n\t\t\t\tscale.y = sy;\n\t\t\t\tscale.z = sz;\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tmakePerspective: function ( left, right, top, bottom, near, far ) {\n\n\t\t\tif ( far === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.' );\n\n\t\t\t}\n\n\t\t\tvar te = this.elements;\n\t\t\tvar x = 2 * near / ( right - left );\n\t\t\tvar y = 2 * near / ( top - bottom );\n\n\t\t\tvar a = ( right + left ) / ( right - left );\n\t\t\tvar b = ( top + bottom ) / ( top - bottom );\n\t\t\tvar c = - ( far + near ) / ( far - near );\n\t\t\tvar d = - 2 * far * near / ( far - near );\n\n\t\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\n\n\t\t\tvar te = this.elements;\n\t\t\tvar w = 1.0 / ( right - left );\n\t\t\tvar h = 1.0 / ( top - bottom );\n\t\t\tvar p = 1.0 / ( far - near );\n\n\t\t\tvar x = ( right + left ) * w;\n\t\t\tvar y = ( top + bottom ) * h;\n\t\t\tvar z = ( far + near ) * p;\n\n\t\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tequals: function ( matrix ) {\n\n\t\t\tvar te = this.elements;\n\t\t\tvar me = matrix.elements;\n\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\n\n\t\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t},\n\n\t\tfromArray: function ( array, offset ) {\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tfor( var i = 0; i < 16; i ++ ) {\n\n\t\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoArray: function ( array, offset ) {\n\n\t\t\tif ( array === undefined ) array = [];\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tvar te = this.elements;\n\n\t\t\tarray[ offset ] = te[ 0 ];\n\t\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\t\tarray[ offset + 2 ] = te[ 2 ];\n\t\t\tarray[ offset + 3 ] = te[ 3 ];\n\n\t\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\t\tarray[ offset + 5 ] = te[ 5 ];\n\t\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\t\tarray[ offset + 7 ] = te[ 7 ];\n\n\t\t\tarray[ offset + 8 ]  = te[ 8 ];\n\t\t\tarray[ offset + 9 ]  = te[ 9 ];\n\t\t\tarray[ offset + 10 ] = te[ 10 ];\n\t\t\tarray[ offset + 11 ] = te[ 11 ];\n\n\t\t\tarray[ offset + 12 ] = te[ 12 ];\n\t\t\tarray[ offset + 13 ] = te[ 13 ];\n\t\t\tarray[ offset + 14 ] = te[ 14 ];\n\t\t\tarray[ offset + 15 ] = te[ 15 ];\n\n\t\t\treturn array;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction CubeTexture( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\n\n\t\timages = images !== undefined ? images : [];\n\t\tmapping = mapping !== undefined ? mapping : CubeReflectionMapping;\n\n\t\tTexture.call( this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.flipY = false;\n\n\t}\n\n\tCubeTexture.prototype = Object.create( Texture.prototype );\n\tCubeTexture.prototype.constructor = CubeTexture;\n\n\tCubeTexture.prototype.isCubeTexture = true;\n\n\tObject.defineProperty( CubeTexture.prototype, 'images', {\n\n\t\tget: function () {\n\n\t\t\treturn this.image;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tthis.image = value;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author tschw\n\t *\n\t * Uniforms of a program.\n\t * Those form a tree structure with a special top-level container for the root,\n\t * which you get by calling 'new WebGLUniforms( gl, program, renderer )'.\n\t *\n\t *\n\t * Properties of inner nodes including the top-level container:\n\t *\n\t * .seq - array of nested uniforms\n\t * .map - nested uniforms by name\n\t *\n\t *\n\t * Methods of all nodes except the top-level container:\n\t *\n\t * .setValue( gl, value, [renderer] )\n\t *\n\t * \t\tuploads a uniform value(s)\n\t *  \tthe 'renderer' parameter is needed for sampler uniforms\n\t *\n\t *\n\t * Static methods of the top-level container (renderer factorizations):\n\t *\n\t * .upload( gl, seq, values, renderer )\n\t *\n\t * \t\tsets uniforms in 'seq' to 'values[id].value'\n\t *\n\t * .seqWithValue( seq, values ) : filteredSeq\n\t *\n\t * \t\tfilters 'seq' entries with corresponding entry in values\n\t *\n\t *\n\t * Methods of the top-level container (renderer factorizations):\n\t *\n\t * .setValue( gl, name, value )\n\t *\n\t * \t\tsets uniform with  name 'name' to 'value'\n\t *\n\t * .set( gl, obj, prop )\n\t *\n\t * \t\tsets uniform from object and property with same name than uniform\n\t *\n\t * .setOptional( gl, obj, prop )\n\t *\n\t * \t\tlike .set for an optional property of the object\n\t *\n\t */\n\n\tvar emptyTexture = new Texture();\n\tvar emptyCubeTexture = new CubeTexture();\n\n\t// --- Base for inner nodes (including the root) ---\n\n\tfunction UniformContainer() {\n\n\t\tthis.seq = [];\n\t\tthis.map = {};\n\n\t}\n\n\t// --- Utilities ---\n\n\t// Array Caches (provide typed arrays for temporary by size)\n\n\tvar arrayCacheF32 = [];\n\tvar arrayCacheI32 = [];\n\n\t// Flattening for arrays of vectors and matrices\n\n\tfunction flatten( array, nBlocks, blockSize ) {\n\n\t\tvar firstElem = array[ 0 ];\n\n\t\tif ( firstElem <= 0 || firstElem > 0 ) return array;\n\t\t// unoptimized: ! isNaN( firstElem )\n\t\t// see http://jacksondunstan.com/articles/983\n\n\t\tvar n = nBlocks * blockSize,\n\t\t\tr = arrayCacheF32[ n ];\n\n\t\tif ( r === undefined ) {\n\n\t\t\tr = new Float32Array( n );\n\t\t\tarrayCacheF32[ n ] = r;\n\n\t\t}\n\n\t\tif ( nBlocks !== 0 ) {\n\n\t\t\tfirstElem.toArray( r, 0 );\n\n\t\t\tfor ( var i = 1, offset = 0; i !== nBlocks; ++ i ) {\n\n\t\t\t\toffset += blockSize;\n\t\t\t\tarray[ i ].toArray( r, offset );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn r;\n\n\t}\n\n\t// Texture unit allocation\n\n\tfunction allocTexUnits( renderer, n ) {\n\n\t\tvar r = arrayCacheI32[ n ];\n\n\t\tif ( r === undefined ) {\n\n\t\t\tr = new Int32Array( n );\n\t\t\tarrayCacheI32[ n ] = r;\n\n\t\t}\n\n\t\tfor ( var i = 0; i !== n; ++ i )\n\t\t\tr[ i ] = renderer.allocTextureUnit();\n\n\t\treturn r;\n\n\t}\n\n\t// --- Setters ---\n\n\t// Note: Defining these methods externally, because they come in a bunch\n\t// and this way their names minify.\n\n\t// Single scalar\n\n\tfunction setValue1f( gl, v ) { gl.uniform1f( this.addr, v ); }\n\tfunction setValue1i( gl, v ) { gl.uniform1i( this.addr, v ); }\n\n\t// Single float vector (from flat array or THREE.VectorN)\n\n\tfunction setValue2fv( gl, v ) {\n\n\t\tif ( v.x === undefined ) gl.uniform2fv( this.addr, v );\n\t\telse gl.uniform2f( this.addr, v.x, v.y );\n\n\t}\n\n\tfunction setValue3fv( gl, v ) {\n\n\t\tif ( v.x !== undefined )\n\t\t\tgl.uniform3f( this.addr, v.x, v.y, v.z );\n\t\telse if ( v.r !== undefined )\n\t\t\tgl.uniform3f( this.addr, v.r, v.g, v.b );\n\t\telse\n\t\t\tgl.uniform3fv( this.addr, v );\n\n\t}\n\n\tfunction setValue4fv( gl, v ) {\n\n\t\tif ( v.x === undefined ) gl.uniform4fv( this.addr, v );\n\t\telse gl.uniform4f( this.addr, v.x, v.y, v.z, v.w );\n\n\t}\n\n\t// Single matrix (from flat array or MatrixN)\n\n\tfunction setValue2fm( gl, v ) {\n\n\t\tgl.uniformMatrix2fv( this.addr, false, v.elements || v );\n\n\t}\n\n\tfunction setValue3fm( gl, v ) {\n\n\t\tgl.uniformMatrix3fv( this.addr, false, v.elements || v );\n\n\t}\n\n\tfunction setValue4fm( gl, v ) {\n\n\t\tgl.uniformMatrix4fv( this.addr, false, v.elements || v );\n\n\t}\n\n\t// Single texture (2D / Cube)\n\n\tfunction setValueT1( gl, v, renderer ) {\n\n\t\tvar unit = renderer.allocTextureUnit();\n\t\tgl.uniform1i( this.addr, unit );\n\t\trenderer.setTexture2D( v || emptyTexture, unit );\n\n\t}\n\n\tfunction setValueT6( gl, v, renderer ) {\n\n\t\tvar unit = renderer.allocTextureUnit();\n\t\tgl.uniform1i( this.addr, unit );\n\t\trenderer.setTextureCube( v || emptyCubeTexture, unit );\n\n\t}\n\n\t// Integer / Boolean vectors or arrays thereof (always flat arrays)\n\n\tfunction setValue2iv( gl, v ) { gl.uniform2iv( this.addr, v ); }\n\tfunction setValue3iv( gl, v ) { gl.uniform3iv( this.addr, v ); }\n\tfunction setValue4iv( gl, v ) { gl.uniform4iv( this.addr, v ); }\n\n\t// Helper to pick the right setter for the singular case\n\n\tfunction getSingularSetter( type ) {\n\n\t\tswitch ( type ) {\n\n\t\t\tcase 0x1406: return setValue1f; // FLOAT\n\t\t\tcase 0x8b50: return setValue2fv; // _VEC2\n\t\t\tcase 0x8b51: return setValue3fv; // _VEC3\n\t\t\tcase 0x8b52: return setValue4fv; // _VEC4\n\n\t\t\tcase 0x8b5a: return setValue2fm; // _MAT2\n\t\t\tcase 0x8b5b: return setValue3fm; // _MAT3\n\t\t\tcase 0x8b5c: return setValue4fm; // _MAT4\n\n\t\t\tcase 0x8b5e: return setValueT1; // SAMPLER_2D\n\t\t\tcase 0x8b60: return setValueT6; // SAMPLER_CUBE\n\n\t\t\tcase 0x1404: case 0x8b56: return setValue1i; // INT, BOOL\n\t\t\tcase 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\n\t\t\tcase 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\n\t\t\tcase 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\n\n\t\t}\n\n\t}\n\n\t// Array of scalars\n\n\tfunction setValue1fv( gl, v ) { gl.uniform1fv( this.addr, v ); }\n\tfunction setValue1iv( gl, v ) { gl.uniform1iv( this.addr, v ); }\n\n\t// Array of vectors (flat or from THREE classes)\n\n\tfunction setValueV2a( gl, v ) {\n\n\t\tgl.uniform2fv( this.addr, flatten( v, this.size, 2 ) );\n\n\t}\n\n\tfunction setValueV3a( gl, v ) {\n\n\t\tgl.uniform3fv( this.addr, flatten( v, this.size, 3 ) );\n\n\t}\n\n\tfunction setValueV4a( gl, v ) {\n\n\t\tgl.uniform4fv( this.addr, flatten( v, this.size, 4 ) );\n\n\t}\n\n\t// Array of matrices (flat or from THREE clases)\n\n\tfunction setValueM2a( gl, v ) {\n\n\t\tgl.uniformMatrix2fv( this.addr, false, flatten( v, this.size, 4 ) );\n\n\t}\n\n\tfunction setValueM3a( gl, v ) {\n\n\t\tgl.uniformMatrix3fv( this.addr, false, flatten( v, this.size, 9 ) );\n\n\t}\n\n\tfunction setValueM4a( gl, v ) {\n\n\t\tgl.uniformMatrix4fv( this.addr, false, flatten( v, this.size, 16 ) );\n\n\t}\n\n\t// Array of textures (2D / Cube)\n\n\tfunction setValueT1a( gl, v, renderer ) {\n\n\t\tvar n = v.length,\n\t\t\tunits = allocTexUnits( renderer, n );\n\n\t\tgl.uniform1iv( this.addr, units );\n\n\t\tfor ( var i = 0; i !== n; ++ i ) {\n\n\t\t\trenderer.setTexture2D( v[ i ] || emptyTexture, units[ i ] );\n\n\t\t}\n\n\t}\n\n\tfunction setValueT6a( gl, v, renderer ) {\n\n\t\tvar n = v.length,\n\t\t\tunits = allocTexUnits( renderer, n );\n\n\t\tgl.uniform1iv( this.addr, units );\n\n\t\tfor ( var i = 0; i !== n; ++ i ) {\n\n\t\t\trenderer.setTextureCube( v[ i ] || emptyCubeTexture, units[ i ] );\n\n\t\t}\n\n\t}\n\n\t// Helper to pick the right setter for a pure (bottom-level) array\n\n\tfunction getPureArraySetter( type ) {\n\n\t\tswitch ( type ) {\n\n\t\t\tcase 0x1406: return setValue1fv; // FLOAT\n\t\t\tcase 0x8b50: return setValueV2a; // _VEC2\n\t\t\tcase 0x8b51: return setValueV3a; // _VEC3\n\t\t\tcase 0x8b52: return setValueV4a; // _VEC4\n\n\t\t\tcase 0x8b5a: return setValueM2a; // _MAT2\n\t\t\tcase 0x8b5b: return setValueM3a; // _MAT3\n\t\t\tcase 0x8b5c: return setValueM4a; // _MAT4\n\n\t\t\tcase 0x8b5e: return setValueT1a; // SAMPLER_2D\n\t\t\tcase 0x8b60: return setValueT6a; // SAMPLER_CUBE\n\n\t\t\tcase 0x1404: case 0x8b56: return setValue1iv; // INT, BOOL\n\t\t\tcase 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\n\t\t\tcase 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\n\t\t\tcase 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\n\n\t\t}\n\n\t}\n\n\t// --- Uniform Classes ---\n\n\tfunction SingleUniform( id, activeInfo, addr ) {\n\n\t\tthis.id = id;\n\t\tthis.addr = addr;\n\t\tthis.setValue = getSingularSetter( activeInfo.type );\n\n\t\t// this.path = activeInfo.name; // DEBUG\n\n\t}\n\n\tfunction PureArrayUniform( id, activeInfo, addr ) {\n\n\t\tthis.id = id;\n\t\tthis.addr = addr;\n\t\tthis.size = activeInfo.size;\n\t\tthis.setValue = getPureArraySetter( activeInfo.type );\n\n\t\t// this.path = activeInfo.name; // DEBUG\n\n\t}\n\n\tfunction StructuredUniform( id ) {\n\n\t\tthis.id = id;\n\n\t\tUniformContainer.call( this ); // mix-in\n\n\t}\n\n\tStructuredUniform.prototype.setValue = function( gl, value ) {\n\n\t\t// Note: Don't need an extra 'renderer' parameter, since samplers\n\t\t// are not allowed in structured uniforms.\n\n\t\tvar seq = this.seq;\n\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\t\tvar u = seq[ i ];\n\t\t\tu.setValue( gl, value[ u.id ] );\n\n\t\t}\n\n\t};\n\n\t// --- Top-level ---\n\n\t// Parser - builds up the property tree from the path strings\n\n\tvar RePathPart = /([\\w\\d_]+)(\\])?(\\[|\\.)?/g;\n\n\t// extracts\n\t// \t- the identifier (member name or array index)\n\t//  - followed by an optional right bracket (found when array index)\n\t//  - followed by an optional left bracket or dot (type of subscript)\n\t//\n\t// Note: These portions can be read in a non-overlapping fashion and\n\t// allow straightforward parsing of the hierarchy that WebGL encodes\n\t// in the uniform names.\n\n\tfunction addUniform( container, uniformObject ) {\n\n\t\tcontainer.seq.push( uniformObject );\n\t\tcontainer.map[ uniformObject.id ] = uniformObject;\n\n\t}\n\n\tfunction parseUniform( activeInfo, addr, container ) {\n\n\t\tvar path = activeInfo.name,\n\t\t\tpathLength = path.length;\n\n\t\t// reset RegExp object, because of the early exit of a previous run\n\t\tRePathPart.lastIndex = 0;\n\n\t\tfor (; ;) {\n\n\t\t\tvar match = RePathPart.exec( path ),\n\t\t\t\tmatchEnd = RePathPart.lastIndex,\n\n\t\t\t\tid = match[ 1 ],\n\t\t\t\tidIsIndex = match[ 2 ] === ']',\n\t\t\t\tsubscript = match[ 3 ];\n\n\t\t\tif ( idIsIndex ) id = id | 0; // convert to integer\n\n\t\t\tif ( subscript === undefined ||\n\t\t\t\t\tsubscript === '[' && matchEnd + 2 === pathLength ) {\n\t\t\t\t// bare name or \"pure\" bottom-level array \"[0]\" suffix\n\n\t\t\t\taddUniform( container, subscript === undefined ?\n\t\t\t\t\t\tnew SingleUniform( id, activeInfo, addr ) :\n\t\t\t\t\t\tnew PureArrayUniform( id, activeInfo, addr ) );\n\n\t\t\t\tbreak;\n\n\t\t\t} else {\n\t\t\t\t// step into inner node / create it in case it doesn't exist\n\n\t\t\t\tvar map = container.map,\n\t\t\t\t\tnext = map[ id ];\n\n\t\t\t\tif ( next === undefined ) {\n\n\t\t\t\t\tnext = new StructuredUniform( id );\n\t\t\t\t\taddUniform( container, next );\n\n\t\t\t\t}\n\n\t\t\t\tcontainer = next;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// Root Container\n\n\tfunction WebGLUniforms( gl, program, renderer ) {\n\n\t\tUniformContainer.call( this );\n\n\t\tthis.renderer = renderer;\n\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_UNIFORMS );\n\n\t\tfor ( var i = 0; i !== n; ++ i ) {\n\n\t\t\tvar info = gl.getActiveUniform( program, i ),\n\t\t\t\tpath = info.name,\n\t\t\t\taddr = gl.getUniformLocation( program, path );\n\n\t\t\tparseUniform( info, addr, this );\n\n\t\t}\n\n\t}\n\n\tWebGLUniforms.prototype.setValue = function( gl, name, value ) {\n\n\t\tvar u = this.map[ name ];\n\n\t\tif ( u !== undefined ) u.setValue( gl, value, this.renderer );\n\n\t};\n\n\tWebGLUniforms.prototype.set = function( gl, object, name ) {\n\n\t\tvar u = this.map[ name ];\n\n\t\tif ( u !== undefined ) u.setValue( gl, object[ name ], this.renderer );\n\n\t};\n\n\tWebGLUniforms.prototype.setOptional = function( gl, object, name ) {\n\n\t\tvar v = object[ name ];\n\n\t\tif ( v !== undefined ) this.setValue( gl, name, v );\n\n\t};\n\n\n\t// Static interface\n\n\tWebGLUniforms.upload = function( gl, seq, values, renderer ) {\n\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\t\tvar u = seq[ i ],\n\t\t\t\tv = values[ u.id ];\n\n\t\t\tif ( v.needsUpdate !== false ) {\n\t\t\t\t// note: always updating when .needsUpdate is undefined\n\n\t\t\t\tu.setValue( gl, v.value, renderer );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tWebGLUniforms.seqWithValue = function( seq, values ) {\n\n\t\tvar r = [];\n\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\t\tvar u = seq[ i ];\n\t\t\tif ( u.id in values ) r.push( u );\n\n\t\t}\n\n\t\treturn r;\n\n\t};\n\n\t/**\n\t * Uniform Utilities\n\t */\n\n\tvar UniformsUtils = {\n\n\t\tmerge: function ( uniforms ) {\n\n\t\t\tvar merged = {};\n\n\t\t\tfor ( var u = 0; u < uniforms.length; u ++ ) {\n\n\t\t\t\tvar tmp = this.clone( uniforms[ u ] );\n\n\t\t\t\tfor ( var p in tmp ) {\n\n\t\t\t\t\tmerged[ p ] = tmp[ p ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn merged;\n\n\t\t},\n\n\t\tclone: function ( uniforms_src ) {\n\n\t\t\tvar uniforms_dst = {};\n\n\t\t\tfor ( var u in uniforms_src ) {\n\n\t\t\t\tuniforms_dst[ u ] = UniformsUtils.cloneParameters( uniforms_src[ u ] );\n\n\t\t\t}\n\n\t\t\treturn uniforms_dst;\n\n\t\t},\n\n\n\t\tcloneParameters: function ( parameters_src ) {\n\n\t\t\tvar parameters_dst = {};\n\n\t\t\tfor ( var p in parameters_src ) {\n\n\t\t\t\tparameters_dst[ p ] = UniformsUtils.cloneParameter( parameters_src[ p ] );\n\n\t\t\t}\n\n\t\t\treturn parameters_dst;\n\n\t\t},\n\n\t\tcloneParameter: function ( parameter_src ) {\n\n\t\t\tif ( parameter_src && ( parameter_src.isColor ||\n\t\t\t\tparameter_src.isMatrix3 || parameter_src.isMatrix4 ||\n\t\t\t\tparameter_src.isVector2 || parameter_src.isVector3 || parameter_src.isVector4 ||\n\t\t\t\tparameter_src.isTexture ) ) {\n\n\t\t\t\treturn parameter_src.clone();\n\n\t\t\t} else if ( Array.isArray( parameter_src ) ) {\n\n\t\t\t\treturn parameter_src.slice();\n\n\t\t\t} else {\n\n\t\t\t\treturn parameter_src;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tvar alphamap_fragment = \"#ifdef USE_ALPHAMAP\\r\\n\\r\\n#if defined( TEXTURE_SLOTS )\\r\\n\\tvec2 alphaUv = alphaMapUV();\\r\\n#else\\r\\n\\tvec2 alphaUv = vUv;\\r\\n#endif\\r\\n\\r\\n\\tdiffuseColor.a *= alphaMapTexelTransform( texture2D( alphaMap, alphaUv ) ).g;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar alphamap_pars_fragment = \"#if ! defined( TEXTURE_SLOTS )\\r\\n\\t#ifdef USE_ALPHAMAP\\r\\n\\r\\n\\t\\tuniform sampler2D alphaMap;\\r\\n\\r\\n\\t#endif\\r\\n#endif\\r\\n\";\n\n\tvar alphatest_fragment = \"#ifdef ALPHATEST\\r\\n\\r\\n\\tif ( diffuseColor.a < ALPHATEST ) discard;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar aomap_fragment = \"#ifdef USE_AOMAP\\r\\n\\r\\n#if defined( TEXTURE_SLOTS )\\r\\n\\tvec2 aoUv = aoMapUV();\\r\\n#else\\r\\n\\tvec2 aoUv = vUv2;\\r\\n#endif\\r\\n\\r\\n\\tfloat ambientOcclusion = ( aoMapTexelTransform( texture2D( aoMap, aoUv ) ).r - 1.0 ) * aoMapIntensity + 1.0;\\r\\n\\r\\n\\treflectedLight.indirectDiffuse *= ambientOcclusion;\\r\\n\\r\\n\\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\\r\\n\\r\\n\\t\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\r\\n\\r\\n\\t\\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar aomap_pars_fragment = \"#ifdef USE_AOMAP\\r\\n\\r\\n#if ! defined( TEXTURE_SLOTS )\\r\\n\\tuniform sampler2D aoMap;\\r\\n#endif\\r\\n\\r\\n\\tuniform float aoMapIntensity;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar begin_vertex = \"\\r\\nvec3 transformed = vec3( position );\\r\\n\";\n\n\tvar beginnormal_vertex = \"\\r\\nvec3 objectNormal = vec3( normal );\\r\\n\";\n\n\tvar bsdfs = \"\\r\\n\\r\\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\\r\\n\\r\\n\\tif ( decayExponent > 0.0 && cutoffDistance > 0.0 ) {\\r\\n\\t\\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\r\\n\\t}\\r\\n\\telse if ( decayExponent < 0.0 ) {\\r\\n\\t\\t// this is based upon UE4 light fall as described on page 11 of:\\r\\n\\t\\t//  https://de45xmedrsdbp.cloudfront.net/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\\r\\n\\t\\tfloat maxDistanceCutoffFactor = 1.0;\\r\\n\\t\\tif( cutoffDistance > 0.0 ) {\\r\\n\\t\\t\\tmaxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\\r\\n\\t\\t}\\r\\n\\t\\tfloat distanceFalloff = 1.0 / ( pow2( lightDistance ) + 1.0 );\\r\\n\\r\\n\\t\\treturn maxDistanceCutoffFactor * distanceFalloff;\\r\\n\\t}\\r\\n\\telse {\\r\\n\\t\\treturn 1.0;\\r\\n\\t}\\r\\n}\\r\\n\\r\\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\\r\\n\\r\\n\\treturn RECIPROCAL_PI * diffuseColor;\\r\\n\\r\\n} // validated\\r\\n\\r\\n\\r\\nfloat F_Schlick( const in float specular, const in float dotLH ) {\\r\\n\\r\\n\\t// Original approximation by Christophe Schlick '94\\r\\n\\t//;float fresnel = pow( 1.0 - dotLH, 5.0 );\\r\\n\\r\\n\\t// Optimized variant (presented by Epic at SIGGRAPH '13)\\r\\n\\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\\r\\n\\r\\n\\treturn ( 1.0 - specular ) * fresnel + specular;\\r\\n\\r\\n} // validated\\r\\n\\r\\n\\r\\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\\r\\n\\r\\n\\t// Original approximation by Christophe Schlick '94\\r\\n\\t//;float fresnel = pow( 1.0 - dotLH, 5.0 );\\r\\n\\r\\n\\t// Optimized variant (presented by Epic at SIGGRAPH '13)\\r\\n\\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\\r\\n\\r\\n\\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\r\\n\\r\\n} // validated\\r\\n\\r\\n\\r\\n// Microfacet Models for Refraction through Rough Surfaces - equation (34)\\r\\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\\r\\n// alpha is \\\"roughness squared\\\" in Disney’s reparameterization\\r\\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\\r\\n\\r\\n\\t// geometry term = G(l)⋅G(v) / 4(n⋅l)(n⋅v)\\r\\n\\r\\n\\tfloat a2 = pow2( alpha );\\r\\n\\r\\n\\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\r\\n\\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\r\\n\\r\\n\\treturn 1.0 / ( gl * gv );\\r\\n\\r\\n} // validated\\r\\n\\r\\n// from page 12, listing 2 of http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr_v2.pdf\\r\\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\\r\\n\\r\\n\\tfloat a2 = pow2( alpha );\\r\\n\\r\\n\\t// dotNL and dotNV are explicitly swapped. This is not a mistake.\\r\\n\\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\r\\n\\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\r\\n\\r\\n\\treturn 0.5 / max( gv + gl, EPSILON );\\r\\n}\\r\\n\\r\\n\\r\\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\\r\\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\\r\\n// alpha is \\\"roughness squared\\\" in Disney’s reparameterization\\r\\nfloat D_GGX( const in float alpha, const in float dotNH ) {\\r\\n\\r\\n\\tfloat a2 = pow2( alpha );\\r\\n\\r\\n\\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1\\r\\n\\r\\n\\treturn RECIPROCAL_PI * a2 / pow2( denom );\\r\\n\\r\\n}\\r\\n\\r\\n\\r\\n// GGX Distribution, Schlick Fresnel, GGX-Smith Visibility\\r\\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\r\\n\\r\\n\\tfloat alpha = pow2( roughness ); // UE4's roughness\\r\\n\\r\\n\\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\r\\n\\r\\n\\tfloat dotNL = clamp( dot( geometry.normal, incidentLight.direction ), EPSILON, 1.0 ); // avoid artifacts from divides by zero\\r\\n\\tfloat dotNV = clamp( dot( geometry.normal, geometry.viewDir ), EPSILON, 1.0 ); // avoid artifacts from divides by zero\\r\\n\\tfloat dotNH = clamp( dot( geometry.normal, halfDir ), EPSILON, 1.0 ); // avoid artifacts from divides by zero\\r\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\r\\n\\r\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\r\\n\\r\\n\\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\r\\n\\r\\n\\tfloat D = D_GGX( alpha, dotNH );\\r\\n\\r\\n\\treturn F * ( G * D );\\r\\n\\r\\n} // validated\\r\\n\\r\\nfloat BRDF_ClearCoat_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in float specular, const in float roughness, out float layerAttenuation ) {\\r\\n\\r\\n\\tfloat alpha = pow2( roughness ); // UE4's roughness\\r\\n\\r\\n\\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\r\\n\\r\\n\\tfloat dotNL = clamp( dot( geometry.normal, incidentLight.direction ), EPSILON, 1.0 ); // avoid artifacts from divides by zero\\r\\n\\tfloat dotNV = clamp( dot( geometry.normal, geometry.viewDir ), EPSILON, 1.0 ); // avoid artifacts from divides by zero\\r\\n\\tfloat dotNH = clamp( dot( geometry.normal, halfDir ), EPSILON, 1.0 ); // avoid artifacts from divides by zero\\r\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\r\\n\\r\\n\\tfloat F = F_Schlick( specular, dotLH );\\r\\n\\r\\n\\tlayerAttenuation = F;\\r\\n\\r\\n\\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\r\\n\\r\\n\\tfloat D = D_GGX( alpha, dotNH );\\r\\n\\r\\n\\treturn F * ( G * D );\\r\\n\\r\\n}\\r\\n\\r\\n//\\r\\n// Rect Area Light BRDF Approximations\\r\\n//\\r\\n\\r\\n// Area light computation code adapted from:\\r\\n// http://blog.selfshadow.com/sandbox/ltc.html\\r\\n//\\r\\n// Based on paper:\\r\\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\\r\\n// By: Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\\r\\n// https://eheitzresearch.wordpress.com/415-2/\\r\\n\\r\\nvec2 ltcTextureCoords( const in GeometricContext geometry, const in float roughness ) {\\r\\n\\r\\n\\tconst float LUT_SIZE  = 64.0;\\r\\n\\tconst float LUT_SCALE = (LUT_SIZE - 1.0)/LUT_SIZE;\\r\\n\\tconst float LUT_BIAS  = 0.5/LUT_SIZE;\\r\\n\\r\\n\\tvec3 N = geometry.normal;\\r\\n\\tvec3 V = geometry.viewDir;\\r\\n\\tvec3 P = geometry.position;\\r\\n\\r\\n\\t// view angle on surface determines which LTC BRDF values we use\\r\\n\\tfloat theta = acos( dot( N, V ) );\\r\\n\\r\\n\\t// Parameterization of texture:\\r\\n\\t// sqrt(roughness) -> [0,1]\\r\\n\\t// theta -> [0, PI/2]\\r\\n\\tvec2 uv = vec2(\\r\\n\\t\\tsqrt( saturate( roughness ) ),\\r\\n\\t\\tsaturate( theta / ( 0.5 * PI ) ) );\\r\\n\\r\\n\\t// Ensure we don't have nonlinearities at the look-up table's edges\\r\\n\\t// see: http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter24.html\\r\\n\\t//      \\\"Shader Analysis\\\" section\\r\\n\\tuv = uv * LUT_SCALE + LUT_BIAS;\\r\\n\\r\\n\\treturn uv;\\r\\n\\r\\n}\\r\\n\\r\\nvoid clipQuadToHorizon( inout vec3 L[5], out int n ) {\\r\\n\\r\\n\\t// detect clipping config\\r\\n\\tint config = 0;\\r\\n\\tif ( L[0].z > 0.0 ) config += 1;\\r\\n\\tif ( L[1].z > 0.0 ) config += 2;\\r\\n\\tif ( L[2].z > 0.0 ) config += 4;\\r\\n\\tif ( L[3].z > 0.0 ) config += 8;\\r\\n\\r\\n\\t// clip\\r\\n\\tn = 0;\\r\\n\\r\\n\\tif ( config == 0 ) {\\r\\n\\r\\n\\t\\t// clip all\\r\\n\\r\\n\\t} else if ( config == 1 ) {\\r\\n\\r\\n\\t\\t// V1 clip V2 V3 V4\\r\\n\\t\\tn = 3;\\r\\n\\t\\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\\r\\n\\t\\tL[2] = -L[3].z * L[0] + L[0].z * L[3];\\r\\n\\r\\n\\t} else if ( config == 2 ) {\\r\\n\\r\\n\\t\\t// V2 clip V1 V3 V4\\r\\n\\t\\tn = 3;\\r\\n\\t\\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\\r\\n\\t\\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\\r\\n\\r\\n\\t} else if ( config == 3 ) {\\r\\n\\r\\n\\t\\t// V1 V2 clip V3 V4\\r\\n\\t\\tn = 4;\\r\\n\\t\\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\\r\\n\\t\\tL[3] = -L[3].z * L[0] + L[0].z * L[3];\\r\\n\\r\\n\\t} else if ( config == 4 ) {\\r\\n\\r\\n\\t\\t// V3 clip V1 V2 V4\\r\\n\\t\\tn = 3;\\r\\n\\t\\tL[0] = -L[3].z * L[2] + L[2].z * L[3];\\r\\n\\t\\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\\r\\n\\r\\n\\t} else if ( config == 5 ) {\\r\\n\\r\\n\\t\\t// V1 V3 clip V2 V4) impossible\\r\\n\\t\\tn = 0;\\r\\n\\r\\n\\t} else if ( config == 6 ) {\\r\\n\\r\\n\\t\\t// V2 V3 clip V1 V4\\r\\n\\t\\tn = 4;\\r\\n\\t\\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\\r\\n\\t\\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\\r\\n\\r\\n\\t} else if ( config == 7 ) {\\r\\n\\r\\n\\t\\t// V1 V2 V3 clip V4\\r\\n\\t\\tn = 5;\\r\\n\\t\\tL[4] = -L[3].z * L[0] + L[0].z * L[3];\\r\\n\\t\\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\\r\\n\\r\\n\\t} else if ( config == 8 ) {\\r\\n\\r\\n\\t\\t// V4 clip V1 V2 V3\\r\\n\\t\\tn = 3;\\r\\n\\t\\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\\r\\n\\t\\tL[1] = -L[2].z * L[3] + L[3].z * L[2];\\r\\n\\t\\tL[2] =  L[3];\\r\\n\\r\\n\\t} else if ( config == 9 ) {\\r\\n\\r\\n\\t\\t// V1 V4 clip V2 V3\\r\\n\\t\\tn = 4;\\r\\n\\t\\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\\r\\n\\t\\tL[2] = -L[2].z * L[3] + L[3].z * L[2];\\r\\n\\r\\n\\t} else if ( config == 10 ) {\\r\\n\\r\\n\\t\\t// V2 V4 clip V1 V3) impossible\\r\\n\\t\\tn = 0;\\r\\n\\r\\n\\t} else if ( config == 11 ) {\\r\\n\\r\\n\\t\\t// V1 V2 V4 clip V3\\r\\n\\t\\tn = 5;\\r\\n\\t\\tL[4] = L[3];\\r\\n\\t\\tL[3] = -L[2].z * L[3] + L[3].z * L[2];\\r\\n\\t\\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\\r\\n\\r\\n\\t} else if ( config == 12 ) {\\r\\n\\r\\n\\t\\t// V3 V4 clip V1 V2\\r\\n\\t\\tn = 4;\\r\\n\\t\\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\\r\\n\\t\\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\\r\\n\\r\\n\\t} else if ( config == 13 ) {\\r\\n\\r\\n\\t\\t// V1 V3 V4 clip V2\\r\\n\\t\\tn = 5;\\r\\n\\t\\tL[4] = L[3];\\r\\n\\t\\tL[3] = L[2];\\r\\n\\t\\tL[2] = -L[1].z * L[2] + L[2].z * L[1];\\r\\n\\t\\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\\r\\n\\r\\n\\t} else if ( config == 14 ) {\\r\\n\\r\\n\\t\\t// V2 V3 V4 clip V1\\r\\n\\t\\tn = 5;\\r\\n\\t\\tL[4] = -L[0].z * L[3] + L[3].z * L[0];\\r\\n\\t\\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\\r\\n\\r\\n\\t} else if ( config == 15 ) {\\r\\n\\r\\n\\t\\t// V1 V2 V3 V4\\r\\n\\t\\tn = 4;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\tif ( n == 3 )\\r\\n\\t\\tL[3] = L[0];\\r\\n\\tif ( n == 4 )\\r\\n\\t\\tL[4] = L[0];\\r\\n\\r\\n}\\r\\n\\r\\n// Equation (11) of \\\"Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\\\"\\r\\nfloat integrateLtcBrdfOverRectEdge( vec3 v1, vec3 v2 ) {\\r\\n\\r\\n\\tfloat cosTheta = dot( v1, v2 );\\r\\n\\tfloat theta = acos( cosTheta );\\r\\n\\tfloat res = cross( v1, v2 ).z * ( ( theta > 0.001 ) ? theta / sin( theta ) : 1.0 );\\r\\n\\r\\n\\treturn res;\\r\\n\\r\\n}\\r\\n\\r\\nvoid initRectPoints( const in vec3 pos, const in vec3 halfWidth, const in vec3 halfHeight, out vec3 rectPoints[4] ) {\\r\\n\\r\\n\\trectPoints[0] = pos - halfWidth - halfHeight;\\r\\n\\trectPoints[1] = pos + halfWidth - halfHeight;\\r\\n\\trectPoints[2] = pos + halfWidth + halfHeight;\\r\\n\\trectPoints[3] = pos - halfWidth + halfHeight;\\r\\n\\r\\n}\\r\\n\\r\\nvec3 integrateLtcBrdfOverRect( const in GeometricContext geometry, const in mat3 brdfMat, const in vec3 rectPoints[4] ) {\\r\\n\\r\\n\\tvec3 N = geometry.normal;\\r\\n\\tvec3 V = geometry.viewDir;\\r\\n\\tvec3 P = geometry.position;\\r\\n\\r\\n\\t// construct orthonormal basis around N\\r\\n\\tvec3 T1, T2;\\r\\n\\tT1 = normalize(V - N * dot( V, N ));\\r\\n\\t// TODO (abelnation): I had to negate this cross product to get proper light.  Curious why sample code worked without negation\\r\\n\\tT2 = - cross( N, T1 );\\r\\n\\r\\n\\t// rotate area light in (T1, T2, N) basis\\r\\n\\tmat3 brdfWrtSurface = brdfMat * transpose( mat3( T1, T2, N ) );\\r\\n\\r\\n\\t// transformed rect relative to surface point\\r\\n\\tvec3 clippedRect[5];\\r\\n\\tclippedRect[0] = brdfWrtSurface * ( rectPoints[0] - P );\\r\\n\\tclippedRect[1] = brdfWrtSurface * ( rectPoints[1] - P );\\r\\n\\tclippedRect[2] = brdfWrtSurface * ( rectPoints[2] - P );\\r\\n\\tclippedRect[3] = brdfWrtSurface * ( rectPoints[3] - P );\\r\\n\\r\\n\\t// clip light rect to horizon, resulting in at most 5 points\\r\\n\\t// we do this because we are integrating the BRDF over the hemisphere centered on the surface points normal\\r\\n\\tint n;\\r\\n\\tclipQuadToHorizon(clippedRect, n);\\r\\n\\r\\n\\t// light is completely below horizon\\r\\n\\tif ( n == 0 )\\r\\n\\t\\treturn vec3( 0, 0, 0 );\\r\\n\\r\\n\\t// project clipped rect onto sphere\\r\\n\\tclippedRect[0] = normalize( clippedRect[0] );\\r\\n\\tclippedRect[1] = normalize( clippedRect[1] );\\r\\n\\tclippedRect[2] = normalize( clippedRect[2] );\\r\\n\\tclippedRect[3] = normalize( clippedRect[3] );\\r\\n\\tclippedRect[4] = normalize( clippedRect[4] );\\r\\n\\r\\n\\t// integrate\\r\\n\\t// simplified integration only needs to be evaluated for each edge in the polygon\\r\\n\\tfloat sum = 0.0;\\r\\n\\tsum += integrateLtcBrdfOverRectEdge( clippedRect[0], clippedRect[1] );\\r\\n\\tsum += integrateLtcBrdfOverRectEdge( clippedRect[1], clippedRect[2] );\\r\\n\\tsum += integrateLtcBrdfOverRectEdge( clippedRect[2], clippedRect[3] );\\r\\n\\tif (n >= 4)\\r\\n\\t\\tsum += integrateLtcBrdfOverRectEdge( clippedRect[3], clippedRect[4] );\\r\\n\\tif (n == 5)\\r\\n\\t\\tsum += integrateLtcBrdfOverRectEdge( clippedRect[4], clippedRect[0] );\\r\\n\\r\\n\\t// TODO (abelnation): two-sided area light\\r\\n\\t// sum = twoSided ? abs(sum) : max(0.0, sum);\\r\\n\\tsum = max( 0.0, sum );\\r\\n\\t// sum = abs( sum );\\r\\n\\r\\n\\tvec3 Lo_i = vec3( sum, sum, sum );\\r\\n\\r\\n\\treturn Lo_i;\\r\\n\\r\\n}\\r\\n\\r\\nvec3 Rect_Area_Light_Specular_Reflectance(\\r\\n\\t\\tconst in GeometricContext geometry,\\r\\n\\t\\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight,\\r\\n\\t\\tconst in float roughness,\\r\\n\\t\\tconst in sampler2D ltcMat, const in sampler2D ltcMag ) {\\r\\n\\r\\n\\tvec3 rectPoints[4];\\r\\n\\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\\r\\n\\r\\n\\tvec2 uv = ltcTextureCoords( geometry, roughness );\\r\\n\\r\\n\\tvec4 brdfLtcApproxParams, t;\\r\\n\\r\\n\\tbrdfLtcApproxParams = texture2D( ltcMat, uv );\\r\\n\\tt = texture2D( ltcMat, uv );\\r\\n\\r\\n\\tfloat brdfLtcScalar = texture2D( ltcMag, uv ).a;\\r\\n\\r\\n\\t// inv(M) matrix referenced by equation (6) in paper\\r\\n\\tmat3 brdfLtcApproxMat = mat3(\\r\\n\\t\\tvec3(   1,   0, t.y ),\\r\\n\\t\\tvec3(   0, t.z,   0 ),\\r\\n\\t\\tvec3( t.w,   0, t.x )\\r\\n\\t);\\r\\n\\r\\n\\tvec3 specularReflectance = integrateLtcBrdfOverRect( geometry, brdfLtcApproxMat, rectPoints );\\r\\n\\tspecularReflectance *= brdfLtcScalar;\\r\\n\\r\\n\\treturn specularReflectance;\\r\\n\\r\\n}\\r\\n\\r\\nvec3 Rect_Area_Light_Diffuse_Reflectance(\\r\\n\\t\\tconst in GeometricContext geometry,\\r\\n\\t\\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight ) {\\r\\n\\r\\n\\tvec3 rectPoints[4];\\r\\n\\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\\r\\n\\r\\n\\tmat3 diffuseBrdfMat = mat3(1);\\r\\n\\tvec3 diffuseReflectance = integrateLtcBrdfOverRect( geometry, diffuseBrdfMat, rectPoints );\\r\\n\\r\\n\\treturn diffuseReflectance;\\r\\n\\r\\n}\\r\\n// End RectArea BRDF\\r\\n\\r\\n// ref: https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\\r\\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\r\\n\\r\\n\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\r\\n\\r\\n\\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\r\\n\\r\\n\\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\r\\n\\r\\n\\tvec4 r = roughness * c0 + c1;\\r\\n\\r\\n\\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\r\\n\\r\\n\\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\\r\\n\\r\\n\\treturn specularColor * AB.x + AB.y;\\r\\n\\r\\n} // validated\\r\\n\\r\\n\\r\\n// ref: https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\\r\\nfloat BRDF_ClearCoat_GGX_Environment( const in GeometricContext geometry, const in float specular, const in float roughness, out float layerAttention ) {\\r\\n\\r\\n\\tvec3 incidentLightDirection = reflect( geometry.viewDir, geometry.normal );\\r\\n\\tvec3 halfDir = normalize( incidentLightDirection + geometry.viewDir );\\r\\n\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\r\\n\\tfloat dotLH = saturate( dot( incidentLightDirection, halfDir ) );\\r\\n\\r\\n\\tlayerAttention = F_Schlick( specular, dotLH );\\r\\n\\r\\n\\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\r\\n\\r\\n\\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\r\\n\\r\\n\\tvec4 r = roughness * c0 + c1;\\r\\n\\r\\n\\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\r\\n\\r\\n\\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\\r\\n\\r\\n\\treturn specular * AB.x + AB.y;\\r\\n\\r\\n} // validated\\r\\n\\r\\n\\r\\nfloat G_BlinnPhong_Implicit( ) {\\r\\n\\r\\n\\t// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)\\r\\n\\treturn 0.25;\\r\\n\\r\\n}\\r\\n\\r\\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\\r\\n\\r\\n\\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\r\\n\\r\\n}\\r\\n\\r\\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\\r\\n\\r\\n\\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\r\\n\\r\\n\\t//float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\\r\\n\\t//float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\r\\n\\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\r\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\r\\n\\r\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\r\\n\\r\\n\\tfloat G = G_BlinnPhong_Implicit( );\\r\\n\\r\\n\\tfloat D = D_BlinnPhong( shininess, dotNH );\\r\\n\\r\\n\\treturn F * ( G * D );\\r\\n\\r\\n} // validated\\r\\n\\r\\n// source: http://simonstechblog.blogspot.ca/2011/12/microfacet-brdf.html\\r\\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\\r\\n\\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\\r\\n}\\r\\n\\r\\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\\r\\n\\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\\r\\n}\\r\\n\";\n\n\tvar bumpmap_pars_fragment = \"#ifdef USE_BUMPMAP\\r\\n\\r\\n#if ! defined( TEXTURE_SLOTS )\\r\\n\\r\\n\\tuniform sampler2D bumpMap;\\r\\n\\tuniform float bumpScale;\\r\\n\\r\\n#endif\\r\\n\\r\\n\\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\\r\\n\\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\\r\\n\\r\\n\\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\\r\\n\\r\\n\\tvec2 dHdxy_fwd() {\\r\\n\\r\\n#if defined( TEXTURE_SLOTS )\\r\\n\\t\\tvec2 bumpUv = bumpMapUV();\\r\\n#else\\r\\n\\t\\tvec2 bumpUv = vUv;\\r\\n#endif\\r\\n\\r\\n\\t\\tvec2 dSTdx = dFdx( bumpUv );\\r\\n\\t\\tvec2 dSTdy = dFdy( bumpUv );\\r\\n\\r\\n\\t\\tfloat Hll = bumpMapTexelTransform( texture2D( bumpMap, bumpUv ) ).x;\\r\\n\\t\\tfloat dBx = bumpMapTexelTransform( texture2D( bumpMap, bumpUv + dSTdx ) ).x - Hll;\\r\\n\\t\\tfloat dBy = bumpMapTexelTransform( texture2D( bumpMap, bumpUv + dSTdy ) ).x - Hll;\\r\\n\\r\\n\\t\\treturn vec2( dBx, dBy );\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\r\\n\\r\\n\\t\\tvec3 vSigmaX = dFdx( surf_pos );\\r\\n\\t\\tvec3 vSigmaY = dFdy( surf_pos );\\r\\n\\t\\tvec3 vN = surf_norm;\\t\\t// normalized\\r\\n\\r\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\r\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\r\\n\\r\\n\\t\\tfloat fDet = dot( vSigmaX, R1 );\\r\\n\\r\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\r\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar clipping_planes_fragment = \"#if NUM_CLIPPING_PLANES > 0\\r\\n\\r\\n\\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\\r\\n\\r\\n\\t\\tvec4 plane = clippingPlanes[ i ];\\r\\n\\t\\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\\r\\n\\r\\n\\t\\tbool clipped = true;\\r\\n\\t\\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\\r\\n\\t\\t\\tvec4 plane = clippingPlanes[ i ];\\r\\n\\t\\t\\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\\r\\n\\t\\t}\\r\\n\\r\\n\\t\\tif ( clipped ) discard;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar clipping_planes_pars_fragment = \"#if NUM_CLIPPING_PLANES > 0\\r\\n\\r\\n\\t#if ! defined( VARYING_VVIEWPOSITION )\\r\\n\\t\\tvarying vec3 vViewPosition;\\r\\n\\t\\t#define VARYING_VVIEWPOSITION 1\\r\\n\\t#endif\\r\\n\\r\\n\\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar clipping_planes_pars_vertex = \"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\r\\n\\t#if ! defined( VARYING_VVIEWPOSITION )\\r\\n    \\tvarying vec3 vViewPosition;\\r\\n    \\t#define VARYING_VVIEWPOSITION 1\\r\\n    #endif\\r\\n#endif\\r\\n\";\n\n\tvar clipping_planes_vertex = \"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\r\\n\\tvViewPosition = - mvPosition.xyz;\\r\\n#endif\\r\\n\\r\\n\";\n\n\tvar color_fragment = \"#ifdef USE_COLOR\\r\\n\\r\\n\\tdiffuseColor.rgb *= vColor;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar color_pars_fragment = \"#ifdef USE_COLOR\\r\\n\\r\\n\\tvarying vec3 vColor;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar color_pars_vertex = \"#ifdef USE_COLOR\\r\\n\\r\\n\\tvarying vec3 vColor;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar color_vertex = \"#ifdef USE_COLOR\\r\\n\\r\\n\\tvColor.xyz = color.xyz;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar common = \"#define PI 3.14159265359\\r\\n#define PI2 6.28318530718\\r\\n#define PI_HALF 1.5707963267949\\r\\n#define RECIPROCAL_PI 0.31830988618\\r\\n#define RECIPROCAL_PI2 0.15915494\\r\\n#define LOG2 1.442695\\r\\n#define EPSILON 1e-6\\r\\n\\r\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\r\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\r\\n\\r\\nfloat pow2( const in float x ) { return x*x; }\\r\\nfloat pow3( const in float x ) { return x*x*x; }\\r\\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\\r\\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\\r\\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\\r\\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\\r\\nhighp float rand( const in vec2 uv ) {\\r\\n\\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\\r\\n\\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\\r\\n\\treturn fract(sin(sn) * c);\\r\\n}\\r\\n\\r\\nstruct IncidentLight {\\r\\n\\tvec3 color;\\r\\n\\tvec3 direction;\\r\\n\\tbool visible;\\r\\n};\\r\\n\\r\\nstruct ReflectedLight {\\r\\n\\tvec3 directDiffuse;\\r\\n\\tvec3 directSpecular;\\r\\n\\tvec3 indirectDiffuse;\\r\\n\\tvec3 indirectSpecular;\\r\\n};\\r\\n\\r\\nstruct GeometricContext {\\r\\n\\tvec3 position;\\r\\n\\tvec3 normal;\\r\\n\\tvec3 viewDir;\\r\\n};\\r\\n\\r\\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\r\\n\\r\\n\\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\r\\n\\r\\n}\\r\\n\\r\\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\\r\\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\\r\\n\\r\\n\\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\\r\\n\\r\\n}\\r\\n\\r\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\r\\n\\r\\n\\tfloat distance = dot( planeNormal, point - pointOnPlane );\\r\\n\\r\\n\\treturn - distance * planeNormal + point;\\r\\n\\r\\n}\\r\\n\\r\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\r\\n\\r\\n\\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\r\\n\\r\\n}\\r\\n\\r\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\r\\n\\r\\n\\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\r\\n\\r\\n}\\r\\n\\r\\nmat3 transpose( const in mat3 v ) {\\r\\n\\r\\n\\tmat3 tmp;\\r\\n\\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\\r\\n\\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\\r\\n\\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\\r\\n\\r\\n\\treturn tmp;\\r\\n\\r\\n}\\r\\n\";\n\n\tvar cube_uv_reflection_fragment = \"#ifdef ENVMAP_TYPE_CUBE_UV\\r\\n\\r\\n#define cubeUV_textureSize (1024.0)\\r\\n\\r\\nint getFaceFromDirection(vec3 direction) {\\r\\n\\tvec3 absDirection = abs(direction);\\r\\n\\tint face = -1;\\r\\n\\tif( absDirection.x > absDirection.z ) {\\r\\n\\t\\tif(absDirection.x > absDirection.y )\\r\\n\\t\\t\\tface = direction.x > 0.0 ? 0 : 3;\\r\\n\\t\\telse\\r\\n\\t\\t\\tface = direction.y > 0.0 ? 1 : 4;\\r\\n\\t}\\r\\n\\telse {\\r\\n\\t\\tif(absDirection.z > absDirection.y )\\r\\n\\t\\t\\tface = direction.z > 0.0 ? 2 : 5;\\r\\n\\t\\telse\\r\\n\\t\\t\\tface = direction.y > 0.0 ? 1 : 4;\\r\\n\\t}\\r\\n\\treturn face;\\r\\n}\\r\\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\\r\\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\\r\\n\\r\\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\\r\\n\\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\\r\\n\\tfloat dxRoughness = dFdx(roughness);\\r\\n\\tfloat dyRoughness = dFdy(roughness);\\r\\n\\tvec3 dx = dFdx( vec * scale * dxRoughness );\\r\\n\\tvec3 dy = dFdy( vec * scale * dyRoughness );\\r\\n\\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\\r\\n\\t// Clamp the value to the max mip level counts. hard coded to 6 mips\\r\\n\\td = clamp(d, 1.0, cubeUV_rangeClamp);\\r\\n\\tfloat mipLevel = 0.5 * log2(d);\\r\\n\\treturn vec2(floor(mipLevel), fract(mipLevel));\\r\\n}\\r\\n\\r\\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\\r\\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\\r\\n\\r\\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\\r\\n\\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\\r\\n\\tfloat a = 16.0 * cubeUV_rcpTextureSize;\\r\\n\\r\\n\\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\\r\\n\\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\\r\\n\\t// float powScale = exp2(roughnessLevel + mipLevel);\\r\\n\\tfloat powScale = exp2_packed.x * exp2_packed.y;\\r\\n\\t// float scale =  1.0 / exp2(roughnessLevel + 2.0 + mipLevel);\\r\\n\\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\\r\\n\\t// float mipOffset = 0.75*(1.0 - 1.0/exp2(mipLevel))/exp2(roughnessLevel);\\r\\n\\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\\r\\n\\r\\n\\tbool bRes = mipLevel == 0.0;\\r\\n\\tscale =  bRes && (scale < a) ? a : scale;\\r\\n\\r\\n\\tvec3 r;\\r\\n\\tvec2 offset;\\r\\n\\tint face = getFaceFromDirection(direction);\\r\\n\\r\\n\\tfloat rcpPowScale = 1.0 / powScale;\\r\\n\\r\\n\\tif( face == 0) {\\r\\n\\t\\tr = vec3(direction.x, -direction.z, direction.y);\\r\\n\\t\\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\\r\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\\r\\n\\t}\\r\\n\\telse if( face == 1) {\\r\\n\\t\\tr = vec3(direction.y, direction.x, direction.z);\\r\\n\\t\\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\\r\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\\r\\n\\t}\\r\\n\\telse if( face == 2) {\\r\\n\\t\\tr = vec3(direction.z, direction.x, direction.y);\\r\\n\\t\\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\\r\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\\r\\n\\t}\\r\\n\\telse if( face == 3) {\\r\\n\\t\\tr = vec3(direction.x, direction.z, direction.y);\\r\\n\\t\\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\\r\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\\r\\n\\t}\\r\\n\\telse if( face == 4) {\\r\\n\\t\\tr = vec3(direction.y, direction.x, -direction.z);\\r\\n\\t\\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\\r\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\\r\\n\\t}\\r\\n\\telse {\\r\\n\\t\\tr = vec3(direction.z, -direction.x, direction.y);\\r\\n\\t\\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\\r\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\\r\\n\\t}\\r\\n\\tr = normalize(r);\\r\\n\\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\\r\\n\\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\\r\\n\\tvec2 base = offset + vec2( texelOffset );\\r\\n\\treturn base + s * ( scale - 2.0 * texelOffset );\\r\\n}\\r\\n\\r\\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\\r\\n\\r\\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\\r\\n\\tfloat roughnessVal = roughness* cubeUV_maxLods3;\\r\\n\\tfloat r1 = floor(roughnessVal);\\r\\n\\tfloat r2 = r1 + 1.0;\\r\\n\\tfloat t = fract(roughnessVal);\\r\\n\\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\\r\\n\\tfloat s = mipInfo.y;\\r\\n\\tfloat level0 = mipInfo.x;\\r\\n\\tfloat level1 = level0 + 1.0;\\r\\n\\tlevel1 = level1 > 5.0 ? 5.0 : level1;\\r\\n\\r\\n\\t// round to nearest mipmap if we are not interpolating.\\r\\n\\tlevel0 += min( floor( s + 0.5 ), 5.0 );\\r\\n\\r\\n\\t// Tri linear interpolation.\\r\\n\\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\\r\\n\\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\\r\\n\\r\\n\\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\\r\\n\\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\\r\\n\\r\\n\\tvec4 result = mix(color10, color20, t);\\r\\n\\r\\n\\treturn vec4(result.rgb, 1.0);\\r\\n}\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar defaultnormal_vertex = \"#ifdef FLIP_SIDED\\r\\n\\r\\n\\tobjectNormal = -objectNormal;\\r\\n\\r\\n#endif\\r\\n\\r\\nvec3 transformedNormal = normalMatrix * objectNormal;\\r\\n\";\n\n\tvar displacementmap_pars_vertex = \"#ifdef USE_DISPLACEMENTMAP\\r\\n\\r\\n\\tuniform sampler2D displacementMap;\\r\\n\\tuniform float displacementScale;\\r\\n\\tuniform float displacementBias;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar displacementmap_vertex = \"#ifdef USE_DISPLACEMENTMAP\\r\\n\\r\\n\\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar emissivemap_fragment = \"#ifdef USE_EMISSIVEMAP\\r\\n\\r\\n#if defined( TEXTURE_SLOTS )\\r\\n\\tvec2 emissiveUv = emissiveMapUV();\\r\\n#else\\r\\n\\tvec2 emissiveUv = vUv;\\r\\n#endif\\r\\n\\r\\n\\tvec4 emissiveColor = texture2D( emissiveMap, emissiveUv );\\r\\n\\r\\n\\temissiveColor.rgb = emissiveMapTexelTransform( emissiveMapTexelToLinear( emissiveColor ) ).rgb;\\r\\n\\r\\n\\ttotalEmissiveRadiance *= emissiveColor.rgb;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar emissivemap_pars_fragment = \"#if ! defined( TEXTURE_SLOTS )\\r\\n\\t#ifdef USE_EMISSIVEMAP\\r\\n\\r\\n\\t\\tuniform sampler2D emissiveMap;\\r\\n\\r\\n\\t#endif\\r\\n#endif\\r\\n\";\n\n\tvar encodings_fragment = \"  gl_FragColor = linearToOutputTexel( gl_FragColor );\\r\\n\";\n\n\tvar encodings_pars_fragment = \"// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\\r\\n\\r\\nvec4 LinearToLinear( in vec4 value ) {\\r\\n  return value;\\r\\n}\\r\\n\\r\\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\\r\\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\\r\\n}\\r\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\r\\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\\r\\n}\\r\\n\\r\\nvec4 sRGBToLinear( in vec4 value ) {\\r\\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\\r\\n}\\r\\nvec4 LinearTosRGB( in vec4 value ) {\\r\\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\\r\\n}\\r\\n\\r\\nvec4 RGBEToLinear( in vec4 value ) {\\r\\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\\r\\n}\\r\\nvec4 LinearToRGBE( in vec4 value ) {\\r\\n  float maxComponent = max( max( value.r, value.g ), value.b );\\r\\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\\r\\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\\r\\n//  return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\\r\\n}\\r\\n\\r\\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\\r\\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\\r\\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\\r\\n}\\r\\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\\r\\n  float maxRGB = max( value.x, max( value.g, value.b ) );\\r\\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\\r\\n  M            = ceil( M * 255.0 ) / 255.0;\\r\\n  return vec4( value.rgb / ( M * maxRange ), M );\\r\\n}\\r\\n\\r\\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\\r\\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\\r\\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\\r\\n}\\r\\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\\r\\n    float maxRGB = max( value.x, max( value.g, value.b ) );\\r\\n    float D      = max( maxRange / maxRGB, 1.0 );\\r\\n    D            = min( floor( D ) / 255.0, 1.0 );\\r\\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\\r\\n}\\r\\n\\r\\n// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\\r\\n\\r\\n// M matrix, for encoding\\r\\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\\r\\nvec4 LinearToLogLuv( in vec4 value )  {\\r\\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\\r\\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\\r\\n  vec4 vResult;\\r\\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\\r\\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\\r\\n  vResult.w = fract(Le);\\r\\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\\r\\n  return vResult;\\r\\n}\\r\\n\\r\\n// Inverse M matrix, for decoding\\r\\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\\r\\nvec4 LogLuvToLinear( in vec4 value ) {\\r\\n  float Le = value.z * 255.0 + value.w;\\r\\n  vec3 Xp_Y_XYZp;\\r\\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\\r\\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\\r\\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\\r\\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\\r\\n  return vec4( max(vRGB, 0.0), 1.0 );\\r\\n}\\r\\n\";\n\n\tvar envmap_fragment = \"#ifdef USE_ENVMAP\\r\\n\\r\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\r\\n\\r\\n\\t\\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\r\\n\\r\\n\\t\\t// Transforming Normal Vectors with the Inverse Transformation\\r\\n\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\r\\n\\r\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\r\\n\\r\\n\\t\\t\\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\r\\n\\r\\n\\t\\t#else\\r\\n\\r\\n\\t\\t\\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tvec3 reflectVec = vReflect;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#ifdef ENVMAP_TYPE_CUBE\\r\\n\\r\\n\\t\\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\r\\n\\r\\n\\t#elif defined( ENVMAP_TYPE_EQUIREC )\\r\\n\\r\\n\\t\\tvec2 sampleUV;\\r\\n\\t\\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\r\\n\\t\\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\r\\n\\t\\tvec4 envColor = texture2D( envMap, sampleUV );\\r\\n\\r\\n\\t#elif defined( ENVMAP_TYPE_SPHERE )\\r\\n\\r\\n\\t\\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\\r\\n\\t\\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tvec4 envColor = vec4( 0.0 );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\tenvColor = envMapTexelToLinear( envColor );\\r\\n\\r\\n\\t#ifdef ENVMAP_BLENDING_MULTIPLY\\r\\n\\r\\n\\t\\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\r\\n\\r\\n\\t#elif defined( ENVMAP_BLENDING_MIX )\\r\\n\\r\\n\\t\\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\r\\n\\r\\n\\t#elif defined( ENVMAP_BLENDING_ADD )\\r\\n\\r\\n\\t\\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar envmap_pars_fragment = \"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\\r\\n\\tuniform float reflectivity;\\r\\n\\tuniform float envMapIntensity;\\r\\n#endif\\r\\n\\r\\n#ifdef USE_ENVMAP\\r\\n\\r\\n\\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\\r\\n\\t\\tvarying vec3 vWorldPosition;\\r\\n\\t#endif\\r\\n\\r\\n\\t#ifdef ENVMAP_TYPE_CUBE\\r\\n\\t\\tuniform samplerCube envMap;\\r\\n\\t#else\\r\\n\\t\\tuniform sampler2D envMap;\\r\\n\\t#endif\\r\\n\\tuniform float flipEnvMap;\\r\\n\\r\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\\r\\n\\t\\tuniform float refractionRatio;\\r\\n\\t#else\\r\\n\\t\\tvarying vec3 vReflect;\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar envmap_pars_vertex = \"#ifdef USE_ENVMAP\\r\\n\\r\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\r\\n\\t\\tvarying vec3 vWorldPosition;\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tvarying vec3 vReflect;\\r\\n\\t\\tuniform float refractionRatio;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar envmap_vertex = \"#ifdef USE_ENVMAP\\r\\n\\r\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\r\\n\\r\\n\\t\\tvWorldPosition = worldPosition.xyz;\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\r\\n\\r\\n\\t\\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\r\\n\\r\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\r\\n\\r\\n\\t\\t\\tvReflect = reflect( cameraToVertex, worldNormal );\\r\\n\\r\\n\\t\\t#else\\r\\n\\r\\n\\t\\t\\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar falloff_fragment = \"#ifdef FALLOFF\\r\\n\\r\\nfloat falloffModulator = abs( dot( normal, normalize( vViewPosition ) ) );\\r\\n\\r\\n// smoothstep: this is a hack, it needs to be fixed.\\r\\nfalloffModulator = ( falloffModulator * falloffModulator * ( 3.0 - 2.0 * falloffModulator ) );\\r\\n\\r\\ndiffuseColor = mix( falloffDiffuseColor, diffuseColor, falloffModulator );\\r\\n\\r\\n#endif // FALLOFF\\r\\n\";\n\n\tvar falloffalphamap_fragment = \"#ifdef USE_FALLOFFALPHAMAP\\r\\n\\r\\n#if defined( TEXTURE_SLOTS )\\r\\n\\tvec2 falloffAlphaUv = falloffAlphaMapUV();\\r\\n#else\\r\\n\\tvec2 falloffAlphaUv = vUv;\\r\\n#endif\\r\\n\\r\\n\\tfalloffDiffuseColor.a *= falloffAlphaMapTexelTransform( texture2D( falloffAlphaMap, falloffAlphaUv ) ).g;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar falloffmap_fragment = \"#ifdef USE_FALLOFFMAP\\r\\n\\r\\n#if defined( TEXTURE_SLOTS )\\r\\n\\tvec2 falloffMapUv = falloffMapUV();\\r\\n#else\\r\\n\\tvec2 falloffMapUv = vUv;\\r\\n#endif\\r\\n\\r\\n\\tvec4 falloffTexelColor = texture2D( falloffMap, falloffMapUv );\\r\\n\\r\\n\\tfalloffTexelColor = falloffMapTexelTransform( falloffMapTexelToLinear( falloffTexelColor ) );\\r\\n\\tfalloffDiffuseColor *= falloffTexelColor;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar fog_fragment = \"#ifdef USE_FOG\\r\\n\\r\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\r\\n\\r\\n\\t\\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#ifdef FOG_EXP2\\r\\n\\r\\n\\t\\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar fog_pars_fragment = \"#ifdef USE_FOG\\r\\n\\r\\n\\tuniform vec3 fogColor;\\r\\n\\r\\n\\t#ifdef FOG_EXP2\\r\\n\\r\\n\\t\\tuniform float fogDensity;\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tuniform float fogNear;\\r\\n\\t\\tuniform float fogFar;\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar gradientmap_pars_fragment = \"#ifdef TOON\\r\\n\\r\\n\\tuniform sampler2D gradientMap;\\r\\n\\r\\n\\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\\r\\n\\r\\n\\t\\t// dotNL will be from -1.0 to 1.0\\r\\n\\t\\tfloat dotNL = dot( normal, lightDirection );\\r\\n\\t\\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\\r\\n\\r\\n\\t\\t#ifdef USE_GRADIENTMAP\\r\\n\\r\\n\\t\\t\\treturn texture2D( gradientMap, coord ).rgb;\\r\\n\\r\\n\\t\\t#else\\r\\n\\r\\n\\t\\t\\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar lightmap_fragment = \"#ifdef USE_LIGHTMAP\\r\\n\\r\\n#if defined( TEXTURE_SLOTS )\\r\\n\\tvec2 lightUv = lightMapUV();\\r\\n#else\\r\\n\\tvec2 lightUv = vUv2;\\r\\n#endif\\r\\n\\r\\n\\treflectedLight.indirectDiffuse += PI * emissiveMapTexelTransform( texture2D( lightMap, lightUv ) ).xyz; // factor of PI should not be present; included here to prevent breakage\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar lightmap_pars_fragment = \"#if ! defined( TEXTURE_SLOTS )\\r\\n\\t#ifdef USE_LIGHTMAP\\r\\n\\r\\n\\t\\tuniform sampler2D lightMap;\\r\\n\\t\\tuniform float lightMapIntensity;\\r\\n\\r\\n\\t#endif\\r\\n#endif\\r\\n\";\n\n\tvar lights_lambert_vertex = \"vec3 diffuse = vec3( 1.0 );\\r\\n\\r\\nGeometricContext geometry;\\r\\ngeometry.position = mvPosition.xyz;\\r\\ngeometry.normal = normalize( transformedNormal );\\r\\ngeometry.viewDir = normalize( -mvPosition.xyz );\\r\\n\\r\\nGeometricContext backGeometry;\\r\\nbackGeometry.position = geometry.position;\\r\\nbackGeometry.normal = -geometry.normal;\\r\\nbackGeometry.viewDir = geometry.viewDir;\\r\\n\\r\\nvLightFront = vec3( 0.0 );\\r\\n\\r\\n#ifdef DOUBLE_SIDED\\r\\n\\tvLightBack = vec3( 0.0 );\\r\\n#endif\\r\\n\\r\\nIncidentLight directLight;\\r\\nfloat dotNL;\\r\\nvec3 directLightColor_Diffuse;\\r\\n\\r\\n#if NUM_POINT_LIGHTS > 0\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\\r\\n\\r\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\r\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\r\\n\\r\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\r\\n\\r\\n\\t\\t#ifdef DOUBLE_SIDED\\r\\n\\r\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n#if NUM_SPOT_LIGHTS > 0\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\\r\\n\\r\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\r\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\r\\n\\r\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\r\\n\\r\\n\\t\\t#ifdef DOUBLE_SIDED\\r\\n\\r\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\r\\n\\r\\n\\t\\t#endif\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n#if NUM_RECT_AREA_LIGHTS > 0\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\t// TODO (abelnation): implement\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n#if NUM_DIR_LIGHTS > 0\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\\r\\n\\r\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\r\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\r\\n\\r\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\r\\n\\r\\n\\t\\t#ifdef DOUBLE_SIDED\\r\\n\\r\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n#if NUM_HEMI_LIGHTS > 0\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\r\\n\\r\\n\\t\\t#ifdef DOUBLE_SIDED\\r\\n\\r\\n\\t\\t\\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar lights_pars = \"uniform vec3 ambientLightColor;\\r\\n\\r\\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\\r\\n\\r\\n\\tvec3 irradiance = ambientLightColor;\\r\\n\\r\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\r\\n\\r\\n\\t\\tirradiance *= PI;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\treturn irradiance;\\r\\n\\r\\n}\\r\\n\\r\\n#if NUM_DIR_LIGHTS > 0\\r\\n\\r\\n\\tstruct DirectionalLight {\\r\\n\\t\\tvec3 direction;\\r\\n\\t\\tvec3 color;\\r\\n\\r\\n\\t\\tint shadow;\\r\\n\\t\\tfloat shadowBias;\\r\\n\\t\\tfloat spreadAngle;\\r\\n\\t\\tvec2 shadowMapSize;\\r\\n\\t\\tvec3 shadowCameraParams;\\r\\n\\t};\\r\\n\\r\\n\\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\\r\\n\\r\\n\\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\r\\n\\r\\n\\t\\tdirectLight.color = directionalLight.color;\\r\\n\\t\\tdirectLight.direction = directionalLight.direction;\\r\\n\\t\\tdirectLight.visible = true;\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n\\r\\n#if NUM_POINT_LIGHTS > 0\\r\\n\\r\\n\\tstruct PointLight {\\r\\n\\t\\tvec3 position;\\r\\n\\t\\tvec3 color;\\r\\n\\t\\tfloat distance;\\r\\n\\t\\tfloat decay;\\r\\n\\r\\n\\t\\tint shadow;\\r\\n\\t\\tfloat shadowBias;\\r\\n\\t\\tfloat shadowRadius;\\r\\n\\t\\tvec2 shadowMapSize;\\r\\n\\t};\\r\\n\\r\\n\\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\\r\\n\\r\\n\\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\\r\\n\\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\r\\n\\r\\n\\t\\tvec3 lVector = pointLight.position - geometry.position;\\r\\n\\t\\tfloat lightDistance = length( lVector );\\r\\n\\t\\tdirectLight.direction = lVector / lightDistance;\\r\\n\\r\\n\\r\\n\\t\\tdirectLight.color = pointLight.color;\\r\\n\\t\\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\\r\\n\\t\\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n\\r\\n#if NUM_SPOT_LIGHTS > 0\\r\\n\\r\\n\\tstruct SpotLight {\\r\\n\\t\\tvec3 position;\\r\\n\\t\\tvec3 direction;\\r\\n\\t\\tvec3 color;\\r\\n\\t\\tfloat distance;\\r\\n\\t\\tfloat decay;\\r\\n\\t\\tfloat coneCos;\\r\\n\\t\\tfloat penumbraCos;\\r\\n\\r\\n\\t\\tint shadow;\\r\\n\\t\\tfloat shadowBias;\\r\\n\\t\\tfloat shadowRadius;\\r\\n\\t\\tvec2 shadowMapSize;\\r\\n\\t\\tvec3 shadowCameraParams;\\r\\n\\t};\\r\\n\\r\\n\\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\\r\\n\\r\\n\\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\\r\\n\\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\\r\\n\\r\\n\\t\\tvec3 lVector = spotLight.position - geometry.position;\\r\\n\\t\\tfloat lightDistance = length( lVector );\\r\\n\\t\\tdirectLight.direction = lVector / lightDistance;\\r\\n\\r\\n\\t\\tfloat angleCos = dot( directLight.direction, spotLight.direction );\\r\\n\\r\\n\\t\\tif ( angleCos > spotLight.coneCos ) {\\r\\n\\r\\n\\t\\t\\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\\r\\n\\r\\n\\t\\t\\tdirectLight.color = spotLight.color;\\r\\n\\t\\t\\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\\r\\n\\t\\t\\tdirectLight.visible = true;\\r\\n\\r\\n\\t\\t} else {\\r\\n\\r\\n\\t\\t\\tdirectLight.color = vec3( 0.0 );\\r\\n\\t\\t\\tdirectLight.visible = false;\\r\\n\\r\\n\\t\\t}\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n\\r\\n#if NUM_RECT_AREA_LIGHTS > 0\\r\\n\\r\\n\\tstruct RectAreaLight {\\r\\n\\t\\tvec3 color;\\r\\n\\t\\tvec3 position;\\r\\n\\t\\tvec3 halfWidth;\\r\\n\\t\\tvec3 halfHeight;\\r\\n\\t};\\r\\n\\r\\n\\t// Pre-computed values of LinearTransformedCosine approximation of BRDF\\r\\n\\t// BRDF approximation Texture is 64x64\\r\\n\\tuniform sampler2D ltcMat; // RGBA Float\\r\\n\\tuniform sampler2D ltcMag; // Alpha Float (only has w component)\\r\\n\\r\\n\\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\\r\\n\\r\\n#endif\\r\\n\\r\\n\\r\\n#if NUM_HEMI_LIGHTS > 0\\r\\n\\r\\n\\tstruct HemisphereLight {\\r\\n\\t\\tvec3 direction;\\r\\n\\t\\tvec3 skyColor;\\r\\n\\t\\tvec3 groundColor;\\r\\n\\t};\\r\\n\\r\\n\\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\\r\\n\\r\\n\\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\\r\\n\\r\\n\\t\\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\\r\\n\\t\\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\\r\\n\\r\\n\\t\\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\\r\\n\\r\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\r\\n\\r\\n\\t\\t\\tirradiance *= PI;\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\treturn irradiance;\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n\\r\\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\\r\\n\\r\\n\\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\\r\\n\\r\\n\\t\\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\\r\\n\\r\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\r\\n\\r\\n\\t\\t\\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\r\\n\\r\\n\\t\\t\\t// TODO: replace with properly filtered cubemaps and access the irradiance LOD level, be it the last LOD level\\r\\n\\t\\t\\t// of a specular cubemap, or just the default level of a specially created irradiance cubemap.\\r\\n\\r\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\r\\n\\r\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\\r\\n\\r\\n\\t\\t\\t#else\\r\\n\\r\\n\\t\\t\\t\\t// force the bias high to get the last LOD level as it is the most blurred.\\r\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\\r\\n\\r\\n\\t\\t\\t#endif\\r\\n\\r\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\r\\n\\r\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\r\\n\\r\\n\\t\\t\\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\r\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\\r\\n\\r\\n\\t\\t#else\\r\\n\\r\\n\\t\\t\\tvec4 envMapColor = vec4( 0.0 );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\treturn PI * envMapColor.rgb * envMapIntensity;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\t// taken from here: http://casual-effects.blogspot.ca/2011/08/plausible-environment-lighting-in-two.html\\r\\n\\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\\r\\n\\r\\n\\t\\t//float envMapWidth = pow( 2.0, maxMIPLevelScalar );\\r\\n\\t\\t//float desiredMIPLevel = log2( envMapWidth * sqrt( 3.0 ) ) - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\\r\\n\\r\\n\\t\\tfloat maxMIPLevelScalar = float( maxMIPLevel );\\r\\n\\t\\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\\r\\n\\r\\n\\t\\t// clamp to allowable LOD ranges.\\r\\n\\t\\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\\r\\n\\r\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\r\\n\\r\\n\\t\\t\\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\\r\\n\\r\\n\\t\\t#else\\r\\n\\r\\n\\t\\t\\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\\r\\n\\r\\n\\t\\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\\r\\n\\r\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\r\\n\\r\\n\\t\\t\\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\r\\n\\r\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\r\\n\\r\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\\r\\n\\r\\n\\t\\t\\t#else\\r\\n\\r\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\\r\\n\\r\\n\\t\\t\\t#endif\\r\\n\\r\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\r\\n\\r\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\r\\n\\r\\n\\t\\t\\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\r\\n\\t\\t\\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\\r\\n\\r\\n\\t\\t#elif defined( ENVMAP_TYPE_EQUIREC )\\r\\n\\r\\n\\t\\t\\tvec2 sampleUV;\\r\\n\\t\\t\\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\\r\\n\\t\\t\\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\r\\n\\r\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\r\\n\\r\\n\\t\\t\\t\\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\\r\\n\\r\\n\\t\\t\\t#else\\r\\n\\r\\n\\t\\t\\t\\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\\r\\n\\r\\n\\t\\t\\t#endif\\r\\n\\r\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\r\\n\\r\\n\\t\\t#elif defined( ENVMAP_TYPE_SPHERE )\\r\\n\\r\\n\\t\\t\\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\\r\\n\\r\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\r\\n\\r\\n\\t\\t\\t\\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\r\\n\\r\\n\\t\\t\\t#else\\r\\n\\r\\n\\t\\t\\t\\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\r\\n\\r\\n\\t\\t\\t#endif\\r\\n\\r\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\treturn envMapColor.rgb * envMapIntensity;\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar lights_phong_fragment = \"BlinnPhongMaterial material;\\r\\nmaterial.diffuseColor = diffuseColor.rgb;\\r\\nmaterial.specularColor = specular;\\r\\nmaterial.specularShininess = shininess;\\r\\nmaterial.specularStrength = specularStrength;\\r\\n\";\n\n\tvar lights_phong_pars_fragment = \"#if ! defined( VARYING_VVIEWPOSITION )\\r\\n    varying vec3 vViewPosition;\\r\\n    #define VARYING_VVIEWPOSITION 1\\r\\n#endif\\r\\n\\r\\n#ifndef FLAT_SHADED\\r\\n\\r\\n\\tvarying vec3 vNormal;\\r\\n\\r\\n#endif\\r\\n\\r\\n\\r\\nstruct BlinnPhongMaterial {\\r\\n\\r\\n\\tvec3\\tdiffuseColor;\\r\\n\\tvec3\\tspecularColor;\\r\\n\\tfloat\\tspecularShininess;\\r\\n\\tfloat\\tspecularStrength;\\r\\n\\r\\n};\\r\\n\\r\\n#if NUM_RECT_AREA_LIGHTS > 0\\r\\n    void RE_Direct_RectArea_BlinnPhong( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\r\\n\\r\\n        vec3 matDiffColor = material.diffuseColor;\\r\\n        vec3 matSpecColor = material.specularColor;\\r\\n        vec3 lightColor   = rectAreaLight.color;\\r\\n\\r\\n        float roughness = BlinnExponentToGGXRoughness( material.specularShininess );\\r\\n\\r\\n        // Evaluate Lighting Equation\\r\\n        vec3 spec = Rect_Area_Light_Specular_Reflectance(\\r\\n                geometry,\\r\\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\\r\\n                roughness,\\r\\n                ltcMat, ltcMag );\\r\\n        vec3 diff = Rect_Area_Light_Diffuse_Reflectance(\\r\\n                geometry,\\r\\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\\r\\n\\r\\n        // TODO (abelnation): note why division by 2PI is necessary\\r\\n        reflectedLight.directSpecular += lightColor * matSpecColor * spec / PI2;\\r\\n        reflectedLight.directDiffuse  += lightColor * matDiffColor * diff / PI2;\\r\\n\\r\\n    }\\r\\n#endif\\r\\n\\r\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\r\\n\\r\\n\\t#ifdef TOON\\r\\n\\r\\n\\t\\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\r\\n\\t\\tvec3 irradiance = dotNL * directLight.color;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\r\\n\\r\\n\\t\\tirradiance *= PI; // punctual light\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\r\\n\\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\\r\\n\\r\\n}\\r\\n\\r\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\r\\n\\r\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\r\\n\\r\\n}\\r\\n\\r\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_BlinnPhong\\r\\n#define RE_Direct_RectArea\\t\\tRE_Direct_RectArea_BlinnPhong\\r\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_BlinnPhong\\r\\n\\r\\n#define Material_LightProbeLOD( material )\\t(0)\\r\\n\";\n\n\tvar lights_physical_fragment = \"PhysicalMaterial material;\\r\\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\\r\\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\\r\\n#ifdef STANDARD\\r\\n\\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\\r\\n#else\\r\\n\\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\\r\\n\\tmaterial.clearCoat = saturate( clearCoat );\\r\\n\\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\\r\\n#endif\\r\\n\";\n\n\tvar lights_physical_pars_fragment = \"struct PhysicalMaterial {\\r\\n\\r\\n\\tvec3\\tdiffuseColor;\\r\\n\\tfloat\\tspecularRoughness;\\r\\n\\tvec3\\tspecularColor;\\r\\n\\r\\n\\t#ifndef STANDARD\\r\\n\\t\\tfloat clearCoat;\\r\\n\\t\\tfloat clearCoatRoughness;\\r\\n\\t#endif\\r\\n\\r\\n};\\r\\n\\r\\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\\r\\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\\r\\n\\r\\n// Clear coat directional hemishperical reflectance (this approximation should be improved)\\r\\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\\r\\n\\r\\n\\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\\r\\n\\r\\n}\\r\\n\\r\\n#if NUM_RECT_AREA_LIGHTS > 0\\r\\n    void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\r\\n\\r\\n        vec3 matDiffColor = material.diffuseColor;\\r\\n        vec3 matSpecColor = material.specularColor;\\r\\n        vec3 lightColor   = rectAreaLight.color;\\r\\n        float roughness = material.specularRoughness;\\r\\n\\r\\n        vec3 spec = Rect_Area_Light_Specular_Reflectance(\\r\\n                geometry,\\r\\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\\r\\n                roughness,\\r\\n                ltcMat, ltcMag );\\r\\n        vec3 diff = Rect_Area_Light_Diffuse_Reflectance(\\r\\n                geometry,\\r\\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\\r\\n\\r\\n        reflectedLight.directSpecular += lightColor * matSpecColor * spec;\\r\\n        reflectedLight.directDiffuse  += lightColor * matDiffColor * diff;\\r\\n\\r\\n    }\\r\\n#endif\\r\\n\\r\\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\r\\n\\r\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\r\\n\\r\\n\\tvec3 irradiance = dotNL * directLight.color;\\r\\n\\r\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\r\\n\\r\\n\\t\\tirradiance *= PI; // punctual light\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\tvec3 specularRadiance = irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\\r\\n\\tvec3 diffuseRadiance = irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\r\\n\\r\\n\\t#ifndef STANDARD\\r\\n\\r\\n\\t\\tfloat layerAttention;\\r\\n\\t\\tvec3 clearCoatSpecularRadiance = irradiance * BRDF_ClearCoat_GGX( directLight, geometry, material.clearCoat, material.clearCoatRoughness, layerAttention );\\r\\n\\r\\n\\t\\tspecularRadiance = mix( specularRadiance, clearCoatSpecularRadiance, material.clearCoat );\\r\\n\\t\\tdiffuseRadiance = mix( diffuseRadiance, vec3( 0.0 ), material.clearCoat );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\treflectedLight.directSpecular += specularRadiance;\\r\\n\\treflectedLight.directDiffuse += diffuseRadiance;\\r\\n\\r\\n\\r\\n}\\r\\n\\r\\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\r\\n\\r\\n\\tvec3 diffuseRadiance = irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\r\\n\\r\\n\\t#ifndef STANDARD\\r\\n\\r\\n\\t\\tdiffuseRadiance = mix( diffuseRadiance, vec3( 0.0 ), material.clearCoat );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\treflectedLight.indirectDiffuse += diffuseRadiance;\\r\\n\\r\\n}\\r\\n\\r\\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\r\\n\\r\\n\\tvec3 specularRadiance = radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\\r\\n\\r\\n\\t#ifndef STANDARD\\r\\n\\r\\n\\t\\tfloat layerAttention;\\r\\n\\t\\tvec3 clearCoatSpecularRadiance = clearCoatRadiance * BRDF_ClearCoat_GGX_Environment( geometry, material.clearCoat, material.clearCoatRoughness, layerAttention );\\r\\n\\r\\n\\t\\tspecularRadiance = mix( specularRadiance, clearCoatSpecularRadiance, material.clearCoat );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\treflectedLight.indirectSpecular += specularRadiance;\\r\\n\\r\\n}\\r\\n\\r\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Physical\\r\\n#define RE_Direct_RectArea\\t\\tRE_Direct_RectArea_Physical\\r\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Physical\\r\\n#define RE_IndirectSpecular\\t\\tRE_IndirectSpecular_Physical\\r\\n\\r\\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\\r\\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\\r\\n\\r\\n// ref: http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr_v2.pdf\\r\\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\\r\\n\\r\\n\\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\\r\\n\\r\\n}\\r\\n\";\n\n\tvar lights_template = \"//\\r\\n// This is a template that can be used to light a material, it uses pluggable RenderEquations (RE)\\r\\n//   for specific lighting scenarios.\\r\\n//\\r\\n// Instructions for use:\\r\\n//  - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\\r\\n//  - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\\r\\n//  - Create a material parameter that is to be passed as the third parameter to your lighting functions.\\r\\n//\\r\\n// TODO:\\r\\n//  - Add area light support.\\r\\n//  - Add sphere light support.\\r\\n//  - Add diffuse light probe (irradiance cubemap) support.\\r\\n//\\r\\n\\r\\nGeometricContext geometry;\\r\\n\\r\\ngeometry.position = - vViewPosition;\\r\\ngeometry.normal = normal;\\r\\ngeometry.viewDir = normalize( vViewPosition );\\r\\n\\r\\nIncidentLight directLight;\\r\\n\\r\\n#ifdef USE_SHADOWMAP\\r\\n\\tinitShadows();\\r\\n#endif\\r\\n\\r\\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\\r\\n\\r\\n\\tPointLight pointLight;\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tpointLight = pointLights[ i ];\\r\\n\\r\\n\\t\\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\\r\\n\\r\\n\\t\\t#ifdef USE_SHADOWMAP\\r\\n\\t\\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\\r\\n\\r\\n\\tSpotLight spotLight;\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tspotLight = spotLights[ i ];\\r\\n\\r\\n\\t\\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\\r\\n\\r\\n\\t\\t#ifdef USE_SHADOWMAP\\r\\n\\t\\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, 0.0, spotLight.shadowCameraParams, vSpotShadowCoord[ i ], 1 ) : 1.0;\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\\r\\n\\r\\n\\tDirectionalLight directionalLight;\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tdirectionalLight = directionalLights[ i ];\\r\\n\\r\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\\r\\n\\r\\n\\t\\t#ifdef USE_SHADOWMAP\\r\\n\\t\\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, 0.0, directionalLight.spreadAngle, directionalLight.shadowCameraParams, vDirectionalShadowCoord[ i ], 0 ) : 1.0;\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\\r\\n\\r\\n\\tRectAreaLight rectAreaLight;\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\trectAreaLight = rectAreaLights[ i ];\\r\\n\\t\\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\\r\\n#if defined( RE_IndirectDiffuse )\\r\\n\\r\\n\\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\r\\n\\r\\n\\t#ifdef USE_LIGHTMAP\\r\\n\\r\\n\\t\\t#if defined( TEXTURE_SLOTS )\\r\\n\\t\\t\\tvec2 lightUv = lightMapUV();\\r\\n\\t\\t\\tvec3 lightMapIrradiance = lightMapTexelTransform( texture2D( lightMap, vUv2 ) ).xyz;\\r\\n\\t\\t#else\\r\\n\\t\\t\\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\r\\n\\r\\n\\t\\t\\tlightMapIrradiance *= PI; // factor of PI should not be present; included here to prevent breakage\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\tirradiance += lightMapIrradiance;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if ( NUM_HEMI_LIGHTS > 0 )\\r\\n\\r\\n\\t\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\t\\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\r\\n\\r\\n\\t\\t}\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\\r\\n\\r\\n\\t\\t// TODO, replace 8 with the real maxMIPLevel\\r\\n\\t \\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\\r\\n\\r\\n#endif\\r\\n\\r\\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\\r\\n\\r\\n\\t// TODO, replace 8 with the real maxMIPLevel\\r\\n\\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\\r\\n\\r\\n\\t#ifndef STANDARD\\r\\n\\t\\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\\r\\n\\t#else\\r\\n\\t\\tvec3 clearCoatRadiance = vec3( 0.0 );\\r\\n\\t#endif\\r\\n\\r\\n\\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar logdepthbuf_fragment = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\r\\n\\r\\n\\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar logdepthbuf_pars_fragment = \"#ifdef USE_LOGDEPTHBUF\\r\\n\\r\\n\\tuniform float logDepthBufFC;\\r\\n\\r\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\r\\n\\r\\n\\t\\tvarying float vFragDepth;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar logdepthbuf_pars_vertex = \"#ifdef USE_LOGDEPTHBUF\\r\\n\\r\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\r\\n\\r\\n\\t\\tvarying float vFragDepth;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\tuniform float logDepthBufFC;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar logdepthbuf_vertex = \"#ifdef USE_LOGDEPTHBUF\\r\\n\\r\\n\\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\r\\n\\r\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\r\\n\\r\\n\\t\\tvFragDepth = 1.0 + gl_Position.w;\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar map_fragment = \"#ifdef USE_MAP\\r\\n\\r\\n#if defined( TEXTURE_SLOTS )\\r\\n\\tvec2 mapUv = mapUV();\\r\\n#else\\r\\n\\tvec2 mapUv = vUv;\\r\\n#endif\\r\\n\\r\\n\\tvec4 texelColor = texture2D( map, mapUv );\\r\\n\\r\\n\\ttexelColor = mapTexelTransform( mapTexelToLinear( texelColor ) );\\r\\n\\tdiffuseColor *= texelColor;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar map_pars_fragment = \"#if ! defined( TEXTURE_SLOTS )\\r\\n\\t#ifdef USE_MAP\\r\\n\\r\\n\\t\\tuniform sampler2D map;\\r\\n\\r\\n\\t#endif\\r\\n#endif\\r\\n\";\n\n\tvar map_particle_fragment = \"#ifdef USE_MAP\\r\\n\\r\\n\\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\r\\n\\tdiffuseColor *= mapTexelToLinear( mapTexel );\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar map_particle_pars_fragment = \"#ifdef USE_MAP\\r\\n\\r\\n\\tuniform vec4 offsetRepeat;\\r\\n\\tuniform sampler2D map;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar metalnessmap_fragment = \"float metalnessFactor = metalness;\\r\\n\\r\\n#ifdef USE_METALNESSMAP\\r\\n\\r\\n\\t#if defined( TEXTURE_SLOTS )\\r\\n\\t\\tvec2 metalnessUv = metalnessMapUV();\\r\\n\\t#else\\r\\n\\t\\tvec2 metalnessUv = vUv;\\r\\n\\t#endif\\r\\n\\r\\n\\tvec4 texelMetalness = metalnessMapTexelTransform( texture2D( metalnessMap, metalnessUv ) );\\r\\n\\tmetalnessFactor *= texelMetalness.r;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar metalnessmap_pars_fragment = \"#if ! defined( TEXTURE_SLOTS )\\r\\n\\t#ifdef USE_METALNESSMAP\\r\\n\\r\\n\\t\\tuniform sampler2D metalnessMap;\\r\\n\\r\\n\\t#endif\\r\\n#endif\\r\\n\";\n\n\tvar morphnormal_vertex = \"#ifdef USE_MORPHNORMALS\\r\\n\\r\\n\\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\r\\n\\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\r\\n\\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\r\\n\\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar morphtarget_pars_vertex = \"#ifdef USE_MORPHTARGETS\\r\\n\\r\\n\\t#ifndef USE_MORPHNORMALS\\r\\n\\r\\n\\tuniform float morphTargetInfluences[ 8 ];\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\tuniform float morphTargetInfluences[ 4 ];\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar morphtarget_vertex = \"#ifdef USE_MORPHTARGETS\\r\\n\\r\\n\\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\r\\n\\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\r\\n\\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\r\\n\\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\r\\n\\r\\n\\t#ifndef USE_MORPHNORMALS\\r\\n\\r\\n\\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\r\\n\\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\r\\n\\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\r\\n\\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar normal_flip = \"#ifdef DOUBLE_SIDED\\r\\n\\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\r\\n#else\\r\\n\\tfloat flipNormal = 1.0;\\r\\n#endif\\r\\n\";\n\n\tvar normal_fragment = \"#ifdef FLAT_SHADED\\r\\n\\r\\n\\t// Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\\r\\n\\r\\n\\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\\r\\n\\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\\r\\n\\tvec3 normal = normalize( cross( fdx, fdy ) );\\r\\n\\r\\n#else\\r\\n\\r\\n\\tvec3 normal = normalize( vNormal ) * flipNormal;\\r\\n\\r\\n#endif\\r\\n\\r\\n#ifdef USE_NORMALMAP\\r\\n\\r\\n\\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\r\\n\\r\\n#elif defined( USE_BUMPMAP )\\r\\n\\r\\n\\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar normalmap_pars_fragment = \"#ifdef USE_NORMALMAP\\r\\n\\r\\n\\t#if ! defined( TEXTURE_SLOTS )\\r\\n\\t\\tuniform sampler2D normalMap;\\r\\n\\t#endif\\r\\n\\t\\tuniform vec2 normalScale;\\r\\n\\r\\n\\t// Per-Pixel Tangent Space Normal Mapping\\r\\n\\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\r\\n\\r\\n\\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\r\\n\\r\\n\\t\\t#if defined( TEXTURE_SLOTS )\\r\\n\\t\\t\\tvec2 normalUv = normalMapUV();\\r\\n\\t\\t#else\\r\\n\\t\\t\\tvec2 normalUv = vUv;\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\tvec3 q0 = dFdx( eye_pos.xyz );\\r\\n\\t\\tvec3 q1 = dFdy( eye_pos.xyz );\\r\\n\\t\\tvec2 st0 = dFdx( normalUv.st );\\r\\n\\t\\tvec2 st1 = dFdy( normalUv.st );\\r\\n\\r\\n\\t\\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\r\\n\\t\\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\r\\n\\t\\tvec3 N = normalize( surf_norm );\\r\\n\\r\\n\\t\\tvec3 mapN = texture2D( normalMap, normalUv ).xyz * 2.0 - 1.0;\\r\\n\\t\\tmapN.xy = normalScale * mapN.xy;\\r\\n\\t\\tmat3 tsn = mat3( S, T, N );\\r\\n\\t\\treturn normalize( tsn * mapN );\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar packing = \"vec3 packNormalToRGB( const in vec3 normal ) {\\r\\n  return normalize( normal ) * 0.5 + 0.5;\\r\\n}\\r\\n\\r\\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\\r\\n  return 1.0 - 2.0 * rgb.xyz;\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\nvec4 packDepthToRGBA( const in highp float v ) {\\r\\n\\r\\n  const highp vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\\r\\n  const highp vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\\r\\n  highp vec4 res = mod( v * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 ); // vec4 res = fract( depth * bit_shift );\\\",\\r\\n  res -= res.xxyz * bit_mask;\\r\\n  return res;\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n}\\r\\n\\r\\nfloat unpackRGBAToDepth( const in vec4 v ) {\\r\\n\\r\\n  const highp vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\r\\n\\treturn dot( v, bit_shift );\\r\\n\\r\\n  //return dot( v, UnpackFactors );\\r\\n\\r\\n}\\r\\n\\r\\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\\r\\n\\r\\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\\r\\n  return ( viewZ + near ) / ( near - far );\\r\\n}\\r\\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\\r\\n  return linearClipZ * ( near - far ) - near;\\r\\n}\\r\\n\\r\\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\\r\\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\\r\\n}\\r\\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\\r\\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\\r\\n}\\r\\n\";\n\n\tvar premultiplied_alpha_fragment = \"#ifdef PREMULTIPLIED_ALPHA\\r\\n\\r\\n\\t// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.\\r\\n\\tgl_FragColor.rgb *= gl_FragColor.a;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar project_vertex = \"#ifdef USE_SKINNING\\r\\n\\r\\n\\tvec4 mvPosition = modelViewMatrix * skinned;\\r\\n\\r\\n#else\\r\\n\\r\\n\\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\r\\n\\r\\n#endif\\r\\n\\r\\ngl_Position = projectionMatrix * mvPosition;\\r\\n\";\n\n\tvar roughnessmap_fragment = \"float roughnessFactor = roughness;\\r\\n\\r\\n#ifdef USE_ROUGHNESSMAP\\r\\n\\r\\n\\t#if defined( TEXTURE_SLOTS )\\r\\n\\t\\tvec2 roughnessUv = roughnessMapUV();\\r\\n\\t#else\\r\\n\\t\\tvec2 roughnessUv = vUv;\\r\\n\\t#endif\\r\\n\\r\\n\\tvec4 texelRoughness = roughnessMapTexelTransform( texture2D( roughnessMap, roughnessUv ) );\\r\\n\\troughnessFactor *= texelRoughness.r;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar roughnessmap_pars_fragment = \"#if ! defined( TEXTURE_SLOTS )\\r\\n\\t#ifdef USE_ROUGHNESSMAP\\r\\n\\r\\n\\t\\tuniform sampler2D roughnessMap;\\r\\n\\r\\n\\t#endif\\r\\n#endif\\r\\n\";\n\n\tvar shadowmap_pars_fragment = \"#ifdef USE_SHADOWMAP\\r\\n\\r\\n\\t#if NUM_DIR_LIGHTS > 0\\r\\n\\r\\n\\t\\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\\r\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if NUM_SPOT_LIGHTS > 0\\r\\n\\r\\n\\t\\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\\r\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if NUM_POINT_LIGHTS > 0\\r\\n\\r\\n\\t\\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\\r\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\r\\n\\t#if defined( SHADOWMAP_TYPE_PCSS )\\r\\n\\t\\t#define PCSS_QUALITY_LEVEL 5\\r\\n\\t\\t#define PCSS_NUM_POISSON_SAMPLES 16\\r\\n\\t\\t#define PCSS_ROTATE_POISSON_SAMPLES 1\\r\\n\\r\\n\\t\\tvec2 poissonDisk[PCSS_NUM_POISSON_SAMPLES];\\r\\n\\r\\n\\t\\tvoid initPercentCloserSoftShadow( const in vec2 randomSeed )\\t{\\r\\n\\r\\n\\t\\t\\tpoissonDisk[0] = vec2(-0.94201624, -0.39906216 );\\r\\n\\t\\t\\tpoissonDisk[1] = vec2( 0.94558609, -0.76890725 );\\r\\n\\t\\t\\tpoissonDisk[2] = vec2( -0.094184101, -0.92938870 );\\r\\n\\t\\t\\tpoissonDisk[3] = vec2( 0.34495938, 0.29387760 );\\r\\n\\t\\t\\tpoissonDisk[4] = vec2( -0.91588581, 0.45771432 );\\r\\n\\t\\t\\tpoissonDisk[5] = vec2( -0.81544232, -0.87912464 );\\r\\n\\t\\t\\tpoissonDisk[6] = vec2( -0.38277543, 0.27676845 );\\r\\n\\t\\t\\tpoissonDisk[7] = vec2( 0.97484398, 0.75648379 );\\r\\n\\t\\t\\tpoissonDisk[8] = vec2( 0.44323325, -0.97511554 );\\r\\n\\t\\t\\tpoissonDisk[9] = vec2( 0.53742981, -0.47373420 );\\r\\n\\t\\t\\tpoissonDisk[10] = vec2( -0.26496911, -0.41893023 );\\r\\n\\t\\t\\tpoissonDisk[11] = vec2( 0.79197514, 0.19090188 );\\r\\n\\t\\t\\tpoissonDisk[12] = vec2( -0.24188840, 0.99706507 );\\r\\n\\t\\t\\tpoissonDisk[13] = vec2( -0.81409955, 0.91437590 );\\r\\n\\t\\t\\tpoissonDisk[14] = vec2( 0.19984126, 0.78641367 );\\r\\n\\t\\t\\tpoissonDisk[15] = vec2( 0.14383161, -0.14100790 );\\r\\n\\t\\t}\\r\\n\\r\\n\\t\\tmat2 createRotationMatrix( const in vec2 randomSeed ) {\\r\\n\\t\\t\\tfloat angle = rand( randomSeed ) * PI2;\\r\\n\\t\\t\\tfloat c = cos( angle ), s = sin( angle );\\r\\n\\t\\t\\treturn mat2( c, s, -s, c );\\r\\n\\t\\t}\\r\\n\\r\\n\\t\\tfloat penumbraSize( const in float zReceiverLightSpace, const in float zBlockerLightSpace ) { // Parallel plane estimation\\r\\n\\t\\t\\treturn (zReceiverLightSpace - zBlockerLightSpace) / zBlockerLightSpace;\\r\\n\\t\\t}\\r\\n\\r\\n\\t\\tfloat findBlockerLightZ( sampler2D shadowMap, const in vec2 uv, const in float zReceiverClipSpace, const in float zReceiverLightSpace, const in float shadowRadius, const in float spreadAngle, const in vec3 shadowCameraParams, const in vec2 randomSeed, const int lightType ) {\\r\\n\\t\\t\\t// This uses similar triangles to compute what\\r\\n\\t\\t\\t// area of the shadow map we should search\\r\\n\\t\\t\\tfloat lightFrustrumWidth = 2.0 * shadowCameraParams.y * tan(shadowCameraParams.x * 0.5);\\r\\n\\t\\t\\tfloat searchRadius = 0.0;\\r\\n\\t\\t\\tsearchRadius = ( lightType == 0) ? zReceiverLightSpace * spreadAngle/shadowCameraParams.x : ( shadowRadius / lightFrustrumWidth ) * ( zReceiverLightSpace - shadowCameraParams.y ) / zReceiverLightSpace;\\r\\n\\t\\t\\tfloat blockerLightZSum = 0.0;\\r\\n\\t\\t\\tint numBlockers = 0;\\r\\n\\r\\n\\t\\t\\tfloat angle = rand( randomSeed ) * PI2;\\r\\n\\t\\t\\tfloat s = sin(angle);\\r\\n\\t\\t\\tfloat c = cos(angle);\\r\\n\\t\\t\\tfor( int i = 0; i < PCSS_NUM_POISSON_SAMPLES; i++ ) {\\r\\n\\t\\t\\t#if PCSS_ROTATE_POISSON_SAMPLES == 1\\r\\n\\t\\t\\t\\tvec2 poissonSample = vec2(poissonDisk[i].y * c + poissonDisk[i].x * s, poissonDisk[i].y * -s + poissonDisk[i].x * c);\\r\\n\\t\\t\\t#else\\r\\n\\t\\t\\t\\tvec2 poissonSample = poissonDisk[i];\\r\\n\\t\\t\\t#endif\\r\\n\\t\\t\\t\\tfloat shadowMapDepth = unpackRGBAToDepth( texture2D( shadowMap, uv + poissonSample * searchRadius ) );\\r\\n\\t\\t\\t\\tif ( shadowMapDepth < zReceiverClipSpace ) {\\r\\n\\t\\t\\t\\t\\tblockerLightZSum += shadowMapDepth;\\r\\n\\t\\t\\t\\t\\tnumBlockers ++;\\r\\n\\t\\t\\t\\t}\\r\\n\\r\\n\\t\\t\\t}\\r\\n\\r\\n\\t\\t\\tif( numBlockers == 0 ) return -1.0;\\r\\n\\r\\n\\t\\t\\treturn blockerLightZSum / float( numBlockers );\\r\\n\\t\\t}\\r\\n\\r\\n\\t\\tfloat percentCloserFilter( sampler2D shadowMap, vec2 uv, float receiverClipZ, float filterRadius, const in vec2 randomSeed ) {\\r\\n\\t\\t\\tint numBlockers = 0;\\r\\n\\t\\t\\tfloat angle = rand( randomSeed ) * PI2;\\r\\n\\t\\t\\tfloat s = sin(angle);\\r\\n\\t\\t\\tfloat c = cos(angle);\\r\\n\\r\\n\\t\\t\\tfor( int i = 0; i < PCSS_NUM_POISSON_SAMPLES; i ++ ) {\\r\\n\\t\\t\\t#if PCSS_ROTATE_POISSON_SAMPLES == 1\\r\\n\\t\\t\\t\\tvec2 poissonSample = vec2(poissonDisk[i].y * c + poissonDisk[i].x * s, poissonDisk[i].y * -s + poissonDisk[i].x * c);\\r\\n\\t\\t\\t#else\\r\\n\\t\\t\\t\\tvec2 poissonSample = poissonDisk[i];\\r\\n\\t\\t\\t#endif\\r\\n\\t\\t\\t\\tvec2 uvOffset = poissonSample * filterRadius;\\r\\n\\r\\n\\t\\t\\t\\tfloat blockerClipZ = unpackRGBAToDepth( texture2D( shadowMap, uv + uvOffset ) );\\r\\n\\t\\t\\t\\tif( receiverClipZ <= blockerClipZ ) numBlockers ++;\\r\\n\\r\\n\\t\\t\\t\\tblockerClipZ = unpackRGBAToDepth( texture2D( shadowMap, uv - uvOffset ) );\\r\\n\\t\\t\\t\\tif( receiverClipZ <= blockerClipZ ) numBlockers ++;\\r\\n\\r\\n\\t\\t\\t}\\r\\n\\r\\n\\t\\t\\treturn float( numBlockers ) / ( 2.0 * float( PCSS_NUM_POISSON_SAMPLES ) );\\r\\n\\t\\t}\\r\\n\\r\\n\\t\\tfloat percentCloserSoftShadow( sampler2D shadowMap, const in float shadowRadius, const in float spreadAngle, const in vec3 shadowCameraParams, const in vec4 coords, const int lightType ) {\\r\\n\\r\\n\\t\\t\\tvec2 uv = coords.xy;\\r\\n\\t\\t\\tfloat receiverLightZ = coords.z;\\r\\n\\t\\t\\tfloat cameraNear = shadowCameraParams.y, cameraFar = shadowCameraParams.z;\\r\\n\\t\\t\\tfloat zReceiverLightSpace;\\r\\n\\t\\t\\tif(lightType == 0)\\r\\n\\t\\t\\t\\tzReceiverLightSpace = -orthographicDepthToViewZ( receiverLightZ, cameraNear, cameraFar );\\r\\n\\t\\t\\telse\\r\\n\\t\\t\\t\\tzReceiverLightSpace = -perspectiveDepthToViewZ( receiverLightZ, cameraNear, cameraFar );\\r\\n\\r\\n\\t\\t\\t// STEP 1: blocker search\\r\\n\\t\\t\\tfloat blockerLightZ = findBlockerLightZ( shadowMap, uv, receiverLightZ, zReceiverLightSpace, shadowRadius, spreadAngle, shadowCameraParams, uv, lightType );\\r\\n\\r\\n\\t\\t\\t//There are no occluders so early out (this saves filtering)\\r\\n\\t\\t\\tif( blockerLightZ == -1.0 ) return 1.0;\\r\\n\\r\\n\\t\\t\\tfloat avgBlockerDepthLightSpace;\\r\\n\\t\\t\\tfloat filterRadius = 0.0;\\r\\n\\r\\n\\t\\t\\t// STEP 2: penumbra size\\r\\n\\t\\t\\tif(lightType == 0) {\\r\\n\\t\\t\\t\\tavgBlockerDepthLightSpace = -orthographicDepthToViewZ( blockerLightZ, cameraNear, cameraFar );\\r\\n\\t\\t\\t\\tfilterRadius = (zReceiverLightSpace - avgBlockerDepthLightSpace) * spreadAngle/shadowCameraParams.x;\\r\\n\\t\\t\\t}\\r\\n\\t\\t\\telse {\\r\\n\\t\\t\\t\\tavgBlockerDepthLightSpace = -perspectiveDepthToViewZ( blockerLightZ, cameraNear, cameraFar );\\r\\n\\t\\t\\t\\tfloat penumbraRatio = penumbraSize( zReceiverLightSpace, avgBlockerDepthLightSpace );\\r\\n\\t\\t\\t\\tfloat lightFrustrumWidth = 2.0 * cameraNear * tan(shadowCameraParams.x * 0.5);\\r\\n\\t\\t\\t\\tfilterRadius = penumbraRatio * ( shadowRadius/lightFrustrumWidth ) * cameraNear / zReceiverLightSpace;\\r\\n\\t\\t\\t}\\r\\n\\t\\t\\t// STEP 3: filtering\\r\\n\\t\\t\\treturn percentCloserFilter( shadowMap, uv, receiverLightZ, filterRadius, uv );\\r\\n\\t\\t}\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n    #if NUM_RECT_AREA_LIGHTS > 0\\r\\n        // TODO (abelnation): create uniforms for area light shadows\\r\\n    #endif\\r\\n\\r\\n\\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\\r\\n\\r\\n\\t\\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\\r\\n\\r\\n\\t\\tconst vec2 offset = vec2( 0.0, 1.0 );\\r\\n\\r\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / size;\\r\\n\\t\\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\\r\\n\\r\\n\\t\\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\\r\\n\\t\\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\\r\\n\\t\\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\\r\\n\\t\\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\\r\\n\\r\\n\\t\\tvec2 f = fract( uv * size + 0.5 );\\r\\n\\r\\n\\t\\tfloat a = mix( lb, lt, f.y );\\r\\n\\t\\tfloat b = mix( rb, rt, f.y );\\r\\n\\t\\tfloat c = mix( a, b, f.x );\\r\\n\\r\\n\\t\\treturn c;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\tvoid initShadows() {\\r\\n\\r\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCSS )\\r\\n\\r\\n\\t\\t  initPercentCloserSoftShadow( vViewPosition.xy );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, float spreadAngle, vec3 shadowCameraParams, vec4 shadowCoord, const int lightType ) {\\r\\n\\r\\n\\t\\tshadowCoord.xyz /= shadowCoord.w;\\r\\n\\t\\tshadowCoord.z += shadowBias;\\r\\n\\r\\n\\t\\t// if ( something && something ) breaks ATI OpenGL shader compiler\\r\\n\\t\\t// if ( all( something, something ) ) using this instead\\r\\n\\r\\n\\t\\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\r\\n\\t\\tbool inFrustum = all( inFrustumVec );\\r\\n\\r\\n\\t\\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\r\\n\\r\\n\\t\\tbool frustumTest = all( frustumTestVec );\\r\\n\\r\\n\\t\\tif ( frustumTest ) {\\r\\n\\r\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF )\\r\\n\\r\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\r\\n\\r\\n\\t\\t\\tfloat dx0 = - texelSize.x * shadowRadius;\\r\\n\\t\\t\\tfloat dy0 = - texelSize.y * shadowRadius;\\r\\n\\t\\t\\tfloat dx1 = + texelSize.x * shadowRadius;\\r\\n\\t\\t\\tfloat dy1 = + texelSize.y * shadowRadius;\\r\\n\\r\\n\\t\\t\\treturn (\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\r\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\r\\n\\r\\n\\t\\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\r\\n\\r\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\r\\n\\r\\n\\t\\t\\tfloat dx0 = - texelSize.x * shadowRadius;\\r\\n\\t\\t\\tfloat dy0 = - texelSize.y * shadowRadius;\\r\\n\\t\\t\\tfloat dx1 = + texelSize.x * shadowRadius;\\r\\n\\t\\t\\tfloat dy1 = + texelSize.y * shadowRadius;\\r\\n\\r\\n\\t\\t\\treturn (\\r\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\r\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\r\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\r\\n\\r\\n\\t\\t#elif defined( SHADOWMAP_TYPE_PCSS )\\r\\n\\r\\n\\t\\t  return percentCloserSoftShadow( shadowMap, shadowRadius, spreadAngle, shadowCameraParams, shadowCoord, lightType );\\r\\n\\r\\n\\t\\t#else // no percentage-closer filtering:\\r\\n\\r\\n\\t\\t\\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\t}\\r\\n\\r\\n\\t\\treturn 1.0;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\t// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\\r\\n\\t// vector suitable for 2D texture mapping. This code uses the following layout for the\\r\\n\\t// 2D texture:\\r\\n\\t//\\r\\n\\t// xzXZ\\r\\n\\t//  y Y\\r\\n\\t//\\r\\n\\t// Y - Positive y direction\\r\\n\\t// y - Negative y direction\\r\\n\\t// X - Positive x direction\\r\\n\\t// x - Negative x direction\\r\\n\\t// Z - Positive z direction\\r\\n\\t// z - Negative z direction\\r\\n\\t//\\r\\n\\t// Source and test bed:\\r\\n\\t// https://gist.github.com/tschw/da10c43c467ce8afd0c4\\r\\n\\r\\n\\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\r\\n\\r\\n\\t\\t// Number of texels to avoid at the edge of each square\\r\\n\\r\\n\\t\\tvec3 absV = abs( v );\\r\\n\\r\\n\\t\\t// Intersect unit cube\\r\\n\\r\\n\\t\\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\r\\n\\t\\tabsV *= scaleToCube;\\r\\n\\r\\n\\t\\t// Apply scale to avoid seams\\r\\n\\r\\n\\t\\t// two texels less per square (one texel will do for NEAREST)\\r\\n\\t\\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\r\\n\\r\\n\\t\\t// Unwrap\\r\\n\\r\\n\\t\\t// space: -1 ... 1 range for each square\\r\\n\\t\\t//\\r\\n\\t\\t// #X##\\t\\tdim    := ( 4 , 2 )\\r\\n\\t\\t//  # #\\t\\tcenter := ( 1 , 1 )\\r\\n\\r\\n\\t\\tvec2 planar = v.xy;\\r\\n\\r\\n\\t\\tfloat almostATexel = 1.5 * texelSizeY;\\r\\n\\t\\tfloat almostOne = 1.0 - almostATexel;\\r\\n\\r\\n\\t\\tif ( absV.z >= almostOne ) {\\r\\n\\r\\n\\t\\t\\tif ( v.z > 0.0 )\\r\\n\\t\\t\\t\\tplanar.x = 4.0 - v.x;\\r\\n\\r\\n\\t\\t} else if ( absV.x >= almostOne ) {\\r\\n\\r\\n\\t\\t\\tfloat signX = sign( v.x );\\r\\n\\t\\t\\tplanar.x = v.z * signX + 2.0 * signX;\\r\\n\\r\\n\\t\\t} else if ( absV.y >= almostOne ) {\\r\\n\\r\\n\\t\\t\\tfloat signY = sign( v.y );\\r\\n\\t\\t\\tplanar.x = v.x + 2.0 * signY + 2.0;\\r\\n\\t\\t\\tplanar.y = v.z * signY - 2.0;\\r\\n\\r\\n\\t\\t}\\r\\n\\r\\n\\t\\t// Transform to UV space\\r\\n\\r\\n\\t\\t// scale := 0.5 / dim\\r\\n\\t\\t// translate := ( center + 0.5 ) / dim\\r\\n\\t\\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\r\\n\\r\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\\r\\n\\r\\n\\t\\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\\r\\n\\t\\t// the distance from the light to the world-space position of the fragment.\\r\\n\\t\\tvec3 lightToPosition = shadowCoord.xyz;\\r\\n\\r\\n\\t\\t// bd3D = base direction 3D\\r\\n\\t\\tvec3 bd3D = normalize( lightToPosition );\\r\\n\\t\\t// dp = distance from light to fragment position\\r\\n\\t\\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\\r\\n\\r\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\\r\\n\\r\\n\\t\\t\\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\\r\\n\\r\\n\\t\\t\\treturn (\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\\r\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\\r\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\r\\n\\r\\n\\t\\t#else // no percentage-closer filtering\\r\\n\\r\\n\\t\\t\\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t}\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar shadowmap_pars_vertex = \"#ifdef USE_SHADOWMAP\\r\\n\\r\\n\\t#if NUM_DIR_LIGHTS > 0\\r\\n\\r\\n\\t\\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\\r\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if NUM_SPOT_LIGHTS > 0\\r\\n\\r\\n\\t\\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\\r\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if NUM_POINT_LIGHTS > 0\\r\\n\\r\\n\\t\\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\\r\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n    #if NUM_RECT_AREA_LIGHTS > 0\\r\\n\\r\\n        // TODO (abelnation): uniforms for area light shadows\\r\\n\\r\\n    #endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar shadowmap_vertex = \"#ifdef USE_SHADOWMAP\\r\\n\\r\\n\\t#if NUM_DIR_LIGHTS > 0\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if NUM_SPOT_LIGHTS > 0\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if NUM_POINT_LIGHTS > 0\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n    #if NUM_RECT_AREA_LIGHTS > 0\\r\\n\\r\\n    // TODO (abelnation): update vAreaShadowCoord with area light info\\r\\n\\r\\n    #endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar shadowmask_pars_fragment = \"float getShadowMask() {\\r\\n\\r\\n\\tfloat shadow = 1.0;\\r\\n\\r\\n\\t#ifdef USE_SHADOWMAP\\r\\n\\r\\n\\t#if NUM_DIR_LIGHTS > 0\\r\\n\\r\\n\\tDirectionalLight directionalLight;\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tdirectionalLight = directionalLights[ i ];\\r\\n\\t\\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, 0.0, directionalLight.spreadAngle, directionalLight.shadowCameraParams, vDirectionalShadowCoord[ i ], 0 ) : 1.0;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if NUM_SPOT_LIGHTS > 0\\r\\n\\r\\n\\tSpotLight spotLight;\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tspotLight = spotLights[ i ];\\r\\n\\t\\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, 0.0, spotLight.shadowCameraParams, vSpotShadowCoord[ i ], 1 ) : 1.0;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if NUM_POINT_LIGHTS > 0\\r\\n\\r\\n\\tPointLight pointLight;\\r\\n\\r\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\r\\n\\r\\n\\t\\tpointLight = pointLights[ i ];\\r\\n\\t\\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#if NUM_RECT_AREA_LIGHTS > 0\\r\\n\\r\\n\\t// TODO (abelnation): update shadow for Area light\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\treturn shadow;\\r\\n\\r\\n}\\r\\n\";\n\n\tvar skinbase_vertex = \"#ifdef USE_SKINNING\\r\\n\\r\\n\\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\r\\n\\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\r\\n\\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\r\\n\\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar skinning_pars_vertex = \"#ifdef USE_SKINNING\\r\\n\\r\\n\\tuniform mat4 bindMatrix;\\r\\n\\tuniform mat4 bindMatrixInverse;\\r\\n\\r\\n\\t#ifdef BONE_TEXTURE\\r\\n\\r\\n\\t\\tuniform sampler2D boneTexture;\\r\\n\\t\\tuniform int boneTextureWidth;\\r\\n\\t\\tuniform int boneTextureHeight;\\r\\n\\r\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\r\\n\\r\\n\\t\\t\\tfloat j = i * 4.0;\\r\\n\\t\\t\\tfloat x = mod( j, float( boneTextureWidth ) );\\r\\n\\t\\t\\tfloat y = floor( j / float( boneTextureWidth ) );\\r\\n\\r\\n\\t\\t\\tfloat dx = 1.0 / float( boneTextureWidth );\\r\\n\\t\\t\\tfloat dy = 1.0 / float( boneTextureHeight );\\r\\n\\r\\n\\t\\t\\ty = dy * ( y + 0.5 );\\r\\n\\r\\n\\t\\t\\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\r\\n\\t\\t\\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\r\\n\\t\\t\\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\r\\n\\t\\t\\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\r\\n\\r\\n\\t\\t\\tmat4 bone = mat4( v1, v2, v3, v4 );\\r\\n\\r\\n\\t\\t\\treturn bone;\\r\\n\\r\\n\\t\\t}\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tuniform mat4 boneMatrices[ MAX_BONES ];\\r\\n\\r\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\r\\n\\r\\n\\t\\t\\tmat4 bone = boneMatrices[ int(i) ];\\r\\n\\t\\t\\treturn bone;\\r\\n\\r\\n\\t\\t}\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar skinning_vertex = \"#ifdef USE_SKINNING\\r\\n\\r\\n\\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\r\\n\\r\\n\\tvec4 skinned = vec4( 0.0 );\\r\\n\\tskinned += boneMatX * skinVertex * skinWeight.x;\\r\\n\\tskinned += boneMatY * skinVertex * skinWeight.y;\\r\\n\\tskinned += boneMatZ * skinVertex * skinWeight.z;\\r\\n\\tskinned += boneMatW * skinVertex * skinWeight.w;\\r\\n\\tskinned  = bindMatrixInverse * skinned;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar skinnormal_vertex = \"#ifdef USE_SKINNING\\r\\n\\r\\n\\tmat4 skinMatrix = mat4( 0.0 );\\r\\n\\tskinMatrix += skinWeight.x * boneMatX;\\r\\n\\tskinMatrix += skinWeight.y * boneMatY;\\r\\n\\tskinMatrix += skinWeight.z * boneMatZ;\\r\\n\\tskinMatrix += skinWeight.w * boneMatW;\\r\\n\\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\r\\n\\r\\n\\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar slot_texel_transform_template = \"uniform vec2 $SLOT_NAME$TexelTransformParams;\\r\\n\\r\\nvec4 $SLOT_NAME$TexelTransform( vec4 value ) {\\r\\n    value.rgb *= $SLOT_NAME$TexelTransformParams.x;\\r\\n    value.rgb += vec3( $SLOT_NAME$TexelTransformParams.y );\\r\\n    return value;\\r\\n}\\r\\n\";\n\n\tvar slot_uv_transform_template = \"uniform vec4 $SLOT_NAME$UVTransformParams;\\r\\n\\r\\nvec2 $SLOT_NAME$UV() {\\r\\n  vec2 value = $UV_VAR_NAME$;\\r\\n  value.xy *= $SLOT_NAME$UVTransformParams.xy;\\r\\n  value.xy += $SLOT_NAME$UVTransformParams.zw;\\r\\n  return value;\\r\\n}\\r\\n\";\n\n\tvar specularmap_fragment = \"float specularStrength;\\r\\n\\r\\n#ifdef USE_SPECULARMAP\\r\\n\\r\\n\\t#if defined( TEXTURE_SLOTS )\\r\\n\\t\\tvec2 specularUv = specularMapUV();\\r\\n\\t#else\\r\\n\\t\\tvec2 specularUv = vUv;\\r\\n\\t#endif\\r\\n\\r\\n\\tvec4 texelSpecular = specularMapTexelTransform( texture2D( specularMap, specularUv ) );\\r\\n\\tspecularStrength = texelSpecular.r;\\r\\n\\r\\n#else\\r\\n\\r\\n\\tspecularStrength = 1.0;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar specularmap_pars_fragment = \"#if ! defined( TEXTURE_SLOTS )\\r\\n\\t#ifdef USE_SPECULARMAP\\r\\n\\r\\n\\t\\tuniform sampler2D specularMap;\\r\\n\\r\\n\\t#endif\\r\\n#endif\\r\\n\";\n\n\tvar tonemapping_fragment = \"#if defined( TONE_MAPPING )\\r\\n\\r\\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar tonemapping_pars_fragment = \"#define saturate(a) clamp( a, 0.0, 1.0 )\\r\\n\\r\\nuniform float toneMappingExposure;\\r\\nuniform float toneMappingWhitePoint;\\r\\n\\r\\n// exposure only\\r\\nvec3 LinearToneMapping( vec3 color ) {\\r\\n\\r\\n  return toneMappingExposure * color;\\r\\n\\r\\n}\\r\\n\\r\\n// source: https://www.cs.utah.edu/~reinhard/cdrom/\\r\\nvec3 ReinhardToneMapping( vec3 color ) {\\r\\n\\r\\n  color *= toneMappingExposure;\\r\\n  return saturate( color / ( vec3( 1.0 ) + color ) );\\r\\n\\r\\n}\\r\\n\\r\\n// source: http://filmicgames.com/archives/75\\r\\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\\r\\nvec3 Uncharted2ToneMapping( vec3 color ) {\\r\\n\\r\\n  // John Hable's filmic operator from Uncharted 2 video game\\r\\n  color *= toneMappingExposure;\\r\\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\\r\\n\\r\\n}\\r\\n\\r\\n// source: http://filmicgames.com/archives/75\\r\\nvec3 OptimizedCineonToneMapping( vec3 color ) {\\r\\n\\r\\n  // optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\\r\\n  color *= toneMappingExposure;\\r\\n  color = max( vec3( 0.0 ), color - 0.004 );\\r\\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\\r\\n\\r\\n}\\r\\n\";\n\n\tvar uv_pars_fragment = \"#if ! defined( TEXTURE_SLOTS )\\r\\n\\r\\n\\t#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP ) || defined( USE_FALLOFFMAP ) || defined( USE_FALLOFFALPHAMAP )\\r\\n\\r\\n\\t\\tvarying vec2 vUv;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar uv_pars_vertex = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )  || defined( USE_FALLOFFMAP ) || defined( USE_FALLOFFALPHAMAP )\\r\\n\\r\\n\\tvarying vec2 vUv;\\r\\n\\tuniform vec4 offsetRepeat;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar uv_vertex = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP ) || defined( USE_FALLOFFMAP ) || defined( USE_FALLOFFALPHAMAP )\\r\\n\\r\\n\\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar uv2_pars_fragment = \"#if ! defined( TEXTURE_SLOTS )\\r\\n\\t#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\r\\n\\r\\n\\t\\tvarying vec2 vUv2;\\r\\n\\r\\n\\t#endif\\r\\n#endif\\r\\n\";\n\n\tvar uv2_pars_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\r\\n\\r\\n\\tattribute vec2 uv2;\\r\\n\\tvarying vec2 vUv2;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar uv2_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\r\\n\\r\\n\\tvUv2 = uv2;\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar worldpos_vertex = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\r\\n\\r\\n\\t#ifdef USE_SKINNING\\r\\n\\r\\n\\t\\tvec4 worldPosition = modelMatrix * skinned;\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\";\n\n\tvar cube_frag = \"uniform samplerCube tCube;\\r\\nuniform float tFlip;\\r\\nuniform float opacity;\\r\\n\\r\\nvarying vec3 vWorldPosition;\\r\\n\\r\\n#include <common>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\\r\\n\\tgl_FragColor.a *= opacity;\\r\\n\\r\\n}\\r\\n\";\n\n\tvar cube_vert = \"varying vec3 vWorldPosition;\\r\\n\\r\\n#include <common>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\tvWorldPosition = transformDirection( position, modelMatrix );\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar cubeEnv_frag = \"uniform float tFlip;\\r\\nuniform float opacity;\\r\\nuniform float roughness;\\r\\n\\r\\nvarying vec3 vWorldPosition;\\r\\n\\r\\n#include <common>\\r\\n#include <logdepthbuf_pars_fragment>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n#include <envmap_pars_fragment>\\r\\n#include <cube_uv_reflection_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\r\\n\\tvec3 queryReflectVec = vec3( tFlip * vWorldPosition.x, vWorldPosition.yz );\\r\\n\\r\\n\\tvec4 envMapColor = vec4( 0.0 );\\r\\n\\r\\n\\t#if defined( ENVMAP_TYPE_CUBE )\\r\\n\\r\\n\\t\\t#ifdef TEXTURE_LOD_EXT\\r\\n\\r\\n\\t\\t\\tenvMapColor = textureCubeLodEXT( envMap, queryReflectVec, roughness * 8.0 );\\r\\n\\r\\n\\t\\t#else\\r\\n\\r\\n\\t\\t\\tenvMapColor = textureCube( envMap, queryReflectVec, roughness * 8.0 );\\r\\n\\r\\n\\t\\t#endif\\r\\n\\r\\n\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\r\\n\\t\\tenvMapColor.rgb *= envMapIntensity;\\r\\n\\r\\n\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\r\\n\\r\\n\\t\\tenvMapColor = textureCubeUV( queryReflectVec, roughness );\\r\\n\\t\\tenvMapColor.rgb *= envMapIntensity;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\tgl_FragColor = envMapColor;\\r\\n\\tgl_FragColor.a = opacity;\\r\\n\\r\\n\\t#include <tonemapping_fragment>\\r\\n\\t#include <encodings_fragment>\\r\\n\\t#include <logdepthbuf_fragment>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar cubeEnv_vert = \"varying vec3 vWorldPosition;\\r\\n\\r\\n#include <common>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\r\\n#if NUM_CLIPPING_PLANES == 0\\r\\n\\t#if ! defined( VARYING_VVIEWPOSITION )\\r\\n   \\t\\tvarying vec3 vViewPosition;\\r\\n   \\t\\t#define VARYING_VVIEWPOSITION 1\\r\\n   #endif\\r\\n#endif\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\tvWorldPosition = transformDirection( position, modelMatrix );\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\r\\n\\tvViewPosition = - mvPosition.xyz;\\r\\n\\r\\n}\\r\\n\";\n\n\tvar depth_frag = \"precision highp float;\\r\\n\\r\\n#if DEPTH_PACKING == 3200\\r\\n\\r\\n\\tuniform float opacity;\\r\\n\\r\\n#endif\\r\\n\\r\\n#include <common>\\r\\n#include <packing>\\r\\n#include <uv_pars_fragment>\\r\\n#include <map_pars_fragment>\\r\\n#include <alphamap_pars_fragment>\\r\\n#include <logdepthbuf_pars_fragment>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\r\\n\\tvec4 diffuseColor = vec4( 1.0 );\\r\\n\\r\\n\\t#if DEPTH_PACKING == 3200\\r\\n\\r\\n\\t\\tdiffuseColor.a = opacity;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#include <map_fragment>\\r\\n\\t#include <alphamap_fragment>\\r\\n\\t#include <alphatest_fragment>\\r\\n\\r\\n\\t#include <logdepthbuf_fragment>\\r\\n\\r\\n\\t#if DEPTH_PACKING == 3200\\r\\n\\r\\n\\t\\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\\r\\n\\r\\n\\t#elif DEPTH_PACKING == 3201\\r\\n\\r\\n\\t\\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n}\\r\\n\";\n\n\tvar depth_vert = \"#include <common>\\r\\n#include <uv_pars_vertex>\\r\\n#include <displacementmap_pars_vertex>\\r\\n#include <morphtarget_pars_vertex>\\r\\n#include <skinning_pars_vertex>\\r\\n#include <logdepthbuf_pars_vertex>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <uv_vertex>\\r\\n\\r\\n\\t#include <skinbase_vertex>\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <displacementmap_vertex>\\r\\n\\t#include <morphtarget_vertex>\\r\\n\\t#include <skinning_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\t#include <logdepthbuf_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar distanceRGBA_frag = \"uniform vec3 lightPos;\\r\\nvarying vec4 vWorldPosition;\\r\\n\\r\\n#include <common>\\r\\n#include <packing>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n\\r\\nvoid main () {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\r\\n\\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\\r\\n\\r\\n}\\r\\n\";\n\n\tvar distanceRGBA_vert = \"varying vec4 vWorldPosition;\\r\\n\\r\\n#include <common>\\r\\n#include <morphtarget_pars_vertex>\\r\\n#include <skinning_pars_vertex>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <skinbase_vertex>\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <morphtarget_vertex>\\r\\n\\t#include <skinning_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\t#include <worldpos_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\r\\n\\tvWorldPosition = worldPosition;\\r\\n\\r\\n}\\r\\n\";\n\n\tvar equirect_frag = \"uniform sampler2D tEquirect;\\r\\nuniform float tFlip;\\r\\n\\r\\nvarying vec3 vWorldPosition;\\r\\n\\r\\n#include <common>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t// \\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\\r\\n\\tvec3 direction = normalize( vWorldPosition );\\r\\n\\tvec2 sampleUV;\\r\\n\\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\\r\\n\\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\\r\\n\\tgl_FragColor = texture2D( tEquirect, sampleUV );\\r\\n\\r\\n}\\r\\n\";\n\n\tvar equirect_vert = \"varying vec3 vWorldPosition;\\r\\n\\r\\n#include <common>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\tvWorldPosition = transformDirection( position, modelMatrix );\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar linedashed_frag = \"uniform vec3 diffuse;\\r\\nuniform float opacity;\\r\\n\\r\\nuniform float dashSize;\\r\\nuniform float totalSize;\\r\\n\\r\\nvarying float vLineDistance;\\r\\n\\r\\n#include <common>\\r\\n#include <color_pars_fragment>\\r\\n#include <fog_pars_fragment>\\r\\n#include <logdepthbuf_pars_fragment>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\r\\n\\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\\r\\n\\r\\n\\t\\tdiscard;\\r\\n\\r\\n\\t}\\r\\n\\r\\n\\tvec3 outgoingLight = vec3( 0.0 );\\r\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\r\\n\\r\\n\\t#include <logdepthbuf_fragment>\\r\\n\\t#include <color_fragment>\\r\\n\\r\\n\\toutgoingLight = diffuseColor.rgb; // simple shader\\r\\n\\r\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\r\\n\\r\\n\\t#include <premultiplied_alpha_fragment>\\r\\n\\t#include <tonemapping_fragment>\\r\\n\\t#include <encodings_fragment>\\r\\n\\t#include <fog_fragment>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar linedashed_vert = \"uniform float scale;\\r\\nattribute float lineDistance;\\r\\n\\r\\nvarying float vLineDistance;\\r\\n\\r\\n#include <common>\\r\\n#include <color_pars_vertex>\\r\\n#include <logdepthbuf_pars_vertex>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <color_vertex>\\r\\n\\r\\n\\tvLineDistance = scale * lineDistance;\\r\\n\\r\\n\\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\r\\n\\tgl_Position = projectionMatrix * mvPosition;\\r\\n\\r\\n\\t#include <logdepthbuf_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar meshbasic_frag = \"uniform vec3 diffuse;\\r\\nuniform float opacity;\\r\\n\\r\\n#ifndef FLAT_SHADED\\r\\n\\r\\n\\tvarying vec3 vNormal;\\r\\n\\r\\n#endif\\r\\n\\r\\n#include <common>\\r\\n#include <color_pars_fragment>\\r\\n#include <uv_pars_fragment>\\r\\n#include <uv2_pars_fragment>\\r\\n#include <map_pars_fragment>\\r\\n#include <alphamap_pars_fragment>\\r\\n#include <aomap_pars_fragment>\\r\\n#include <lightmap_pars_fragment>\\r\\n#include <envmap_pars_fragment>\\r\\n#include <fog_pars_fragment>\\r\\n#include <specularmap_pars_fragment>\\r\\n#include <logdepthbuf_pars_fragment>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\r\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\r\\n\\r\\n\\t#include <logdepthbuf_fragment>\\r\\n\\t#include <map_fragment>\\r\\n\\t#include <color_fragment>\\r\\n\\t#include <alphamap_fragment>\\r\\n\\t#include <alphatest_fragment>\\r\\n\\t#include <specularmap_fragment>\\r\\n\\r\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\r\\n\\r\\n\\t// accumulation (baked indirect lighting only)\\r\\n\\t#ifdef USE_LIGHTMAP\\r\\n\\r\\n\\t\\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\treflectedLight.indirectDiffuse += vec3( 1.0 );\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t// modulation\\r\\n\\t#include <aomap_fragment>\\r\\n\\r\\n\\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\\r\\n\\r\\n\\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\\r\\n\\r\\n\\t#include <normal_flip>\\r\\n\\t#include <envmap_fragment>\\r\\n\\r\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\r\\n\\r\\n\\t#include <premultiplied_alpha_fragment>\\r\\n\\t#include <tonemapping_fragment>\\r\\n\\t#include <encodings_fragment>\\r\\n\\t#include <fog_fragment>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar meshbasic_vert = \"#include <common>\\r\\n#include <uv_pars_vertex>\\r\\n#include <uv2_pars_vertex>\\r\\n#include <envmap_pars_vertex>\\r\\n#include <color_pars_vertex>\\r\\n#include <morphtarget_pars_vertex>\\r\\n#include <skinning_pars_vertex>\\r\\n#include <logdepthbuf_pars_vertex>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <uv_vertex>\\r\\n\\t#include <uv2_vertex>\\r\\n\\t#include <color_vertex>\\r\\n\\t#include <skinbase_vertex>\\r\\n\\r\\n\\t#ifdef USE_ENVMAP\\r\\n\\r\\n\\t#include <beginnormal_vertex>\\r\\n\\t#include <morphnormal_vertex>\\r\\n\\t#include <skinnormal_vertex>\\r\\n\\t#include <defaultnormal_vertex>\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <morphtarget_vertex>\\r\\n\\t#include <skinning_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\t#include <logdepthbuf_vertex>\\r\\n\\r\\n\\t#include <worldpos_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\t#include <envmap_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar meshlambert_frag = \"uniform vec3 diffuse;\\r\\nuniform vec3 emissive;\\r\\nuniform float opacity;\\r\\n\\r\\nvarying vec3 vLightFront;\\r\\n\\r\\n#ifdef DOUBLE_SIDED\\r\\n\\r\\n\\tvarying vec3 vLightBack;\\r\\n\\r\\n#endif\\r\\n\\r\\n#include <common>\\r\\n#include <packing>\\r\\n#include <color_pars_fragment>\\r\\n#include <uv_pars_fragment>\\r\\n#include <uv2_pars_fragment>\\r\\n#include <map_pars_fragment>\\r\\n#include <alphamap_pars_fragment>\\r\\n#include <aomap_pars_fragment>\\r\\n#include <lightmap_pars_fragment>\\r\\n#include <emissivemap_pars_fragment>\\r\\n#include <envmap_pars_fragment>\\r\\n#include <bsdfs>\\r\\n#include <lights_pars>\\r\\n#include <fog_pars_fragment>\\r\\n#include <shadowmap_pars_fragment>\\r\\n#include <shadowmask_pars_fragment>\\r\\n#include <specularmap_pars_fragment>\\r\\n#include <logdepthbuf_pars_fragment>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\r\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\r\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\r\\n\\tvec3 totalEmissiveRadiance = emissive;\\r\\n\\r\\n\\t#include <logdepthbuf_fragment>\\r\\n\\t#include <map_fragment>\\r\\n\\t#include <color_fragment>\\r\\n\\t#include <alphamap_fragment>\\r\\n\\t#include <alphatest_fragment>\\r\\n\\t#include <specularmap_fragment>\\r\\n\\t#include <emissivemap_fragment>\\r\\n\\r\\n\\t// accumulation\\r\\n\\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\\r\\n\\r\\n\\t#include <lightmap_fragment>\\r\\n\\r\\n\\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\\r\\n\\r\\n\\t#ifdef DOUBLE_SIDED\\r\\n\\r\\n\\t\\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\\r\\n\\r\\n\\t#else\\r\\n\\r\\n\\t\\treflectedLight.directDiffuse = vLightFront;\\r\\n\\r\\n\\t#endif\\r\\n\\r\\n\\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\\r\\n\\r\\n\\t// modulation\\r\\n\\t#include <aomap_fragment>\\r\\n\\r\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\r\\n\\r\\n\\t#include <normal_flip>\\r\\n\\t#include <envmap_fragment>\\r\\n\\r\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\r\\n\\r\\n\\t#include <premultiplied_alpha_fragment>\\r\\n\\t#include <tonemapping_fragment>\\r\\n\\t#include <encodings_fragment>\\r\\n\\t#include <fog_fragment>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar meshlambert_vert = \"#define LAMBERT\\r\\n\\r\\nvarying vec3 vLightFront;\\r\\n\\r\\n#ifdef DOUBLE_SIDED\\r\\n\\r\\n\\tvarying vec3 vLightBack;\\r\\n\\r\\n#endif\\r\\n\\r\\n#include <common>\\r\\n#include <uv_pars_vertex>\\r\\n#include <uv2_pars_vertex>\\r\\n#include <envmap_pars_vertex>\\r\\n#include <bsdfs>\\r\\n#include <lights_pars>\\r\\n#include <color_pars_vertex>\\r\\n#include <morphtarget_pars_vertex>\\r\\n#include <skinning_pars_vertex>\\r\\n#include <shadowmap_pars_vertex>\\r\\n#include <logdepthbuf_pars_vertex>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <uv_vertex>\\r\\n\\t#include <uv2_vertex>\\r\\n\\t#include <color_vertex>\\r\\n\\r\\n\\t#include <beginnormal_vertex>\\r\\n\\t#include <morphnormal_vertex>\\r\\n\\t#include <skinbase_vertex>\\r\\n\\t#include <skinnormal_vertex>\\r\\n\\t#include <defaultnormal_vertex>\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <morphtarget_vertex>\\r\\n\\t#include <skinning_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\t#include <logdepthbuf_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\r\\n\\t#include <worldpos_vertex>\\r\\n\\t#include <envmap_vertex>\\r\\n\\t#include <lights_lambert_vertex>\\r\\n\\t#include <shadowmap_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar meshphong_frag = \"#define PHONG\\r\\n\\r\\nuniform vec3 diffuse;\\r\\nuniform vec3 emissive;\\r\\nuniform vec3 specular;\\r\\nuniform float shininess;\\r\\nuniform float opacity;\\r\\n\\r\\n#include <common>\\r\\n#include <packing>\\r\\n#include <color_pars_fragment>\\r\\n#include <uv_pars_fragment>\\r\\n#include <uv2_pars_fragment>\\r\\n#include <map_pars_fragment>\\r\\n#include <alphamap_pars_fragment>\\r\\n#include <aomap_pars_fragment>\\r\\n#include <lightmap_pars_fragment>\\r\\n#include <emissivemap_pars_fragment>\\r\\n#include <envmap_pars_fragment>\\r\\n#include <gradientmap_pars_fragment>\\r\\n#include <fog_pars_fragment>\\r\\n#include <bsdfs>\\r\\n#include <lights_pars>\\r\\n#include <lights_phong_pars_fragment>\\r\\n#include <shadowmap_pars_fragment>\\r\\n#include <bumpmap_pars_fragment>\\r\\n#include <normalmap_pars_fragment>\\r\\n#include <specularmap_pars_fragment>\\r\\n#include <logdepthbuf_pars_fragment>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\r\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\r\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\r\\n\\tvec3 totalEmissiveRadiance = emissive;\\r\\n\\r\\n\\t#include <logdepthbuf_fragment>\\r\\n\\t#include <map_fragment>\\r\\n\\t#include <color_fragment>\\r\\n\\t#include <alphamap_fragment>\\r\\n\\t#include <alphatest_fragment>\\r\\n\\t#include <specularmap_fragment>\\r\\n\\t#include <normal_flip>\\r\\n\\t#include <normal_fragment>\\r\\n\\t#include <emissivemap_fragment>\\r\\n\\r\\n\\t// accumulation\\r\\n\\t#include <lights_phong_fragment>\\r\\n\\t#include <lights_template>\\r\\n\\r\\n\\t// modulation\\r\\n\\t#include <aomap_fragment>\\r\\n\\r\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\r\\n\\r\\n\\t#include <envmap_fragment>\\r\\n\\r\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\r\\n\\r\\n\\t#include <premultiplied_alpha_fragment>\\r\\n\\t#include <tonemapping_fragment>\\r\\n\\t#include <encodings_fragment>\\r\\n\\t#include <fog_fragment>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar meshphong_vert = \"#define PHONG\\r\\n\\r\\n#if ! defined( VARYING_VVIEWPOSITION )\\r\\n\\tvarying vec3 vViewPosition;\\r\\n\\t#define VARYING_VVIEWPOSITION 1\\r\\n#endif\\r\\n\\r\\n#ifndef FLAT_SHADED\\r\\n\\r\\n\\tvarying vec3 vNormal;\\r\\n\\r\\n#endif\\r\\n\\r\\n#include <common>\\r\\n#include <uv_pars_vertex>\\r\\n#include <uv2_pars_vertex>\\r\\n#include <displacementmap_pars_vertex>\\r\\n#include <envmap_pars_vertex>\\r\\n#include <color_pars_vertex>\\r\\n#include <morphtarget_pars_vertex>\\r\\n#include <skinning_pars_vertex>\\r\\n#include <shadowmap_pars_vertex>\\r\\n#include <logdepthbuf_pars_vertex>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <uv_vertex>\\r\\n\\t#include <uv2_vertex>\\r\\n\\t#include <color_vertex>\\r\\n\\r\\n\\t#include <beginnormal_vertex>\\r\\n\\t#include <morphnormal_vertex>\\r\\n\\t#include <skinbase_vertex>\\r\\n\\t#include <skinnormal_vertex>\\r\\n\\t#include <defaultnormal_vertex>\\r\\n\\r\\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\\r\\n\\r\\n\\tvNormal = normalize( transformedNormal );\\r\\n\\r\\n#endif\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <displacementmap_vertex>\\r\\n\\t#include <morphtarget_vertex>\\r\\n\\t#include <skinning_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\t#include <logdepthbuf_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\r\\n\\tvViewPosition = - mvPosition.xyz;\\r\\n\\r\\n\\t#include <worldpos_vertex>\\r\\n\\t#include <envmap_vertex>\\r\\n\\t#include <shadowmap_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar meshphysical_frag = \"precision highp float;\\r\\n#define PHYSICAL\\r\\n\\r\\nuniform vec3 diffuse;\\r\\nuniform vec3 emissive;\\r\\nuniform float roughness;\\r\\nuniform float metalness;\\r\\nuniform float opacity;\\r\\n\\r\\n#ifndef STANDARD\\r\\n\\tuniform float clearCoat;\\r\\n\\tuniform float clearCoatRoughness;\\r\\n\\r\\n\\t#ifdef FALLOFF\\r\\n\\t\\tuniform vec3 falloffDiffuse;\\r\\n\\t\\tuniform float falloffOpacity;\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\\r\\n#if ! defined( VARYING_VVIEWPOSITION )\\r\\n\\tvarying vec3 vViewPosition;\\r\\n\\t#define VARYING_VVIEWPOSITION 1\\r\\n#endif\\r\\n\\r\\n#ifndef FLAT_SHADED\\r\\n\\r\\n\\tvarying vec3 vNormal;\\r\\n\\r\\n#endif\\r\\n\\r\\n#include <common>\\r\\n#include <packing>\\r\\n#include <color_pars_fragment>\\r\\n#include <uv_pars_fragment>\\r\\n#include <uv2_pars_fragment>\\r\\n#include <map_pars_fragment>\\r\\n#include <alphamap_pars_fragment>\\r\\n#include <aomap_pars_fragment>\\r\\n#include <lightmap_pars_fragment>\\r\\n#include <emissivemap_pars_fragment>\\r\\n#include <envmap_pars_fragment>\\r\\n#include <fog_pars_fragment>\\r\\n#include <bsdfs>\\r\\n#include <cube_uv_reflection_fragment>\\r\\n#include <lights_pars>\\r\\n#include <lights_physical_pars_fragment>\\r\\n#include <shadowmap_pars_fragment>\\r\\n#include <bumpmap_pars_fragment>\\r\\n#include <normalmap_pars_fragment>\\r\\n#include <roughnessmap_pars_fragment>\\r\\n#include <metalnessmap_pars_fragment>\\r\\n#include <logdepthbuf_pars_fragment>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\r\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\r\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\r\\n\\tvec3 totalEmissiveRadiance = emissive;\\r\\n\\r\\n\\t#ifdef FALLOFF\\r\\n\\t\\tvec4 falloffDiffuseColor = vec4( falloffDiffuse, falloffOpacity );\\r\\n\\t#endif\\r\\n\\r\\n\\t#include <logdepthbuf_fragment>\\r\\n\\t#include <map_fragment>\\r\\n\\t#include <color_fragment>\\r\\n\\t#include <alphamap_fragment>\\r\\n\\r\\n\\t#include <falloffmap_fragment>\\r\\n\\t#include <falloffalphamap_fragment>\\r\\n\\r\\n\\t#include <alphatest_fragment>\\r\\n\\t#include <specularmap_fragment>\\r\\n\\t#include <roughnessmap_fragment>\\r\\n\\t#include <metalnessmap_fragment>\\r\\n\\t#include <normal_flip>\\r\\n\\t#include <normal_fragment>\\r\\n\\t#include <emissivemap_fragment>\\r\\n\\r\\n\\t#include <falloff_fragment>\\r\\n\\r\\n\\t// accumulation\\r\\n\\t#include <lights_physical_fragment>\\r\\n\\t#include <lights_template>\\r\\n\\r\\n\\t// modulation\\r\\n\\t#include <aomap_fragment>\\r\\n\\r\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\r\\n\\r\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\r\\n\\r\\n\\t#include <premultiplied_alpha_fragment>\\r\\n\\t#include <tonemapping_fragment>\\r\\n\\t#include <encodings_fragment>\\r\\n\\t#include <fog_fragment>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar meshphysical_vert = \"#define PHYSICAL\\r\\n\\r\\n#if ! defined( VARYING_VVIEWPOSITION )\\r\\n\\tvarying vec3 vViewPosition;\\r\\n\\t#define VARYING_VVIEWPOSITION 1\\r\\n#endif\\r\\n\\r\\n#ifndef FLAT_SHADED\\r\\n\\r\\n\\tvarying vec3 vNormal;\\r\\n\\r\\n#endif\\r\\n\\r\\n#include <common>\\r\\n#include <uv_pars_vertex>\\r\\n#include <uv2_pars_vertex>\\r\\n#include <displacementmap_pars_vertex>\\r\\n#include <color_pars_vertex>\\r\\n#include <morphtarget_pars_vertex>\\r\\n#include <skinning_pars_vertex>\\r\\n#include <shadowmap_pars_vertex>\\r\\n#include <specularmap_pars_fragment>\\r\\n#include <logdepthbuf_pars_vertex>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <uv_vertex>\\r\\n\\t#include <uv2_vertex>\\r\\n\\t#include <color_vertex>\\r\\n\\r\\n\\t#include <beginnormal_vertex>\\r\\n\\t#include <morphnormal_vertex>\\r\\n\\t#include <skinbase_vertex>\\r\\n\\t#include <skinnormal_vertex>\\r\\n\\t#include <defaultnormal_vertex>\\r\\n\\r\\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\\r\\n\\r\\n\\tvNormal = normalize( transformedNormal );\\r\\n\\r\\n#endif\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <displacementmap_vertex>\\r\\n\\t#include <morphtarget_vertex>\\r\\n\\t#include <skinning_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\t#include <logdepthbuf_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\r\\n\\tvViewPosition = - mvPosition.xyz;\\r\\n\\r\\n\\t#include <worldpos_vertex>\\r\\n\\t#include <shadowmap_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar normal_frag = \"#define NORMAL\\r\\n\\r\\nuniform float opacity;\\r\\n\\r\\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\\r\\n\\r\\n\\t#if ! defined( VARYING_VVIEWPOSITION )\\r\\n\\t\\tvarying vec3 vViewPosition;\\r\\n\\t\\t#define VARYING_VVIEWPOSITION 1\\r\\n\\t#endif\\r\\n\\r\\n#endif\\r\\n\\r\\n#ifndef FLAT_SHADED\\r\\n\\r\\n\\tvarying vec3 vNormal;\\r\\n\\r\\n#endif\\r\\n\\r\\n#include <packing>\\r\\n#include <uv_pars_fragment>\\r\\n#include <bumpmap_pars_fragment>\\r\\n#include <normalmap_pars_fragment>\\r\\n#include <logdepthbuf_pars_fragment>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\t#include <normal_flip>\\r\\n\\t#include <normal_fragment>\\r\\n\\r\\n   \\tgl_FragColor = vec4( packNormalToRGB( vNormal * flipNormal ), opacity );\\r\\n\\r\\n\\t#include <logdepthbuf_fragment>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar normal_vert = \"#define NORMAL\\r\\n\\r\\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\\r\\n\\r\\n\\t#if ! defined( VARYING_VVIEWPOSITION )\\r\\n   \\t\\tvarying vec3 vViewPosition;\\r\\n   \\t\\t#define VARYING_VVIEWPOSITION 1\\r\\n   #endif\\r\\n\\r\\n#endif\\r\\n\\r\\n#ifndef FLAT_SHADED\\r\\n\\r\\n\\tvarying vec3 vNormal;\\r\\n\\r\\n#endif\\r\\n\\r\\n#include <uv_pars_vertex>\\r\\n#include <displacementmap_pars_vertex>\\r\\n#include <morphtarget_pars_vertex>\\r\\n#include <skinning_pars_vertex>\\r\\n#include <logdepthbuf_pars_vertex>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\t\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <uv_vertex>\\r\\n\\r\\n\\t#include <beginnormal_vertex>\\r\\n\\t#include <morphnormal_vertex>\\r\\n\\t#include <skinbase_vertex>\\r\\n\\t#include <skinnormal_vertex>\\r\\n\\t#include <defaultnormal_vertex>\\r\\n\\r\\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\\r\\n\\r\\n\\tvNormal = normalize( transformedNormal );\\r\\n\\r\\n#endif\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <displacementmap_vertex>\\r\\n\\t#include <morphtarget_vertex>\\r\\n\\t#include <skinning_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\t#include <logdepthbuf_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\r\\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\\r\\n\\r\\n\\tvViewPosition = - mvPosition.xyz;\\r\\n\\r\\n#endif\\r\\n\\r\\n}\\r\\n\";\n\n\tvar points_frag = \"uniform vec3 diffuse;\\r\\nuniform float opacity;\\r\\n\\r\\n#include <common>\\r\\n#include <packing>\\r\\n#include <color_pars_fragment>\\r\\n#include <map_particle_pars_fragment>\\r\\n#include <fog_pars_fragment>\\r\\n#include <shadowmap_pars_fragment>\\r\\n#include <logdepthbuf_pars_fragment>\\r\\n#include <clipping_planes_pars_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <clipping_planes_fragment>\\r\\n\\r\\n\\tvec3 outgoingLight = vec3( 0.0 );\\r\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\r\\n\\r\\n\\t#include <logdepthbuf_fragment>\\r\\n\\t#include <map_particle_fragment>\\r\\n\\t#include <color_fragment>\\r\\n\\t#include <alphatest_fragment>\\r\\n\\r\\n\\toutgoingLight = diffuseColor.rgb;\\r\\n\\r\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\r\\n\\r\\n\\t#include <premultiplied_alpha_fragment>\\r\\n\\t#include <tonemapping_fragment>\\r\\n\\t#include <encodings_fragment>\\r\\n\\t#include <fog_fragment>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar points_vert = \"uniform float size;\\r\\nuniform float scale;\\r\\n\\r\\n#include <common>\\r\\n#include <color_pars_vertex>\\r\\n#include <shadowmap_pars_vertex>\\r\\n#include <logdepthbuf_pars_vertex>\\r\\n#include <clipping_planes_pars_vertex>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <color_vertex>\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\r\\n\\t#ifdef USE_SIZEATTENUATION\\r\\n\\t\\tgl_PointSize = size * ( scale / - mvPosition.z );\\r\\n\\t#else\\r\\n\\t\\tgl_PointSize = size;\\r\\n\\t#endif\\r\\n\\r\\n\\t#include <logdepthbuf_vertex>\\r\\n\\t#include <clipping_planes_vertex>\\r\\n\\t#include <worldpos_vertex>\\r\\n\\t#include <shadowmap_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar shadow_frag = \"uniform float opacity;\\r\\n\\r\\n#include <common>\\r\\n#include <packing>\\r\\n#include <bsdfs>\\r\\n#include <lights_pars>\\r\\n#include <shadowmap_pars_fragment>\\r\\n#include <shadowmask_pars_fragment>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\\r\\n\\r\\n}\\r\\n\";\n\n\tvar shadow_vert = \"#include <shadowmap_pars_vertex>\\r\\n\\r\\nvoid main() {\\r\\n\\r\\n\\t#include <begin_vertex>\\r\\n\\t#include <project_vertex>\\r\\n\\t#include <worldpos_vertex>\\r\\n\\t#include <shadowmap_vertex>\\r\\n\\r\\n}\\r\\n\";\n\n\tvar ShaderChunk = {\n\t\talphamap_fragment: alphamap_fragment,\n\t\talphamap_pars_fragment: alphamap_pars_fragment,\n\t\talphatest_fragment: alphatest_fragment,\n\t\taomap_fragment: aomap_fragment,\n\t\taomap_pars_fragment: aomap_pars_fragment,\n\t\tbegin_vertex: begin_vertex,\n\t\tbeginnormal_vertex: beginnormal_vertex,\n\t\tbsdfs: bsdfs,\n\t\tbumpmap_pars_fragment: bumpmap_pars_fragment,\n\t\tclipping_planes_fragment: clipping_planes_fragment,\n\t\tclipping_planes_pars_fragment: clipping_planes_pars_fragment,\n\t\tclipping_planes_pars_vertex: clipping_planes_pars_vertex,\n\t\tclipping_planes_vertex: clipping_planes_vertex,\n\t\tcolor_fragment: color_fragment,\n\t\tcolor_pars_fragment: color_pars_fragment,\n\t\tcolor_pars_vertex: color_pars_vertex,\n\t\tcolor_vertex: color_vertex,\n\t\tcommon: common,\n\t\tcube_uv_reflection_fragment: cube_uv_reflection_fragment,\n\t\tdefaultnormal_vertex: defaultnormal_vertex,\n\t\tdisplacementmap_pars_vertex: displacementmap_pars_vertex,\n\t\tdisplacementmap_vertex: displacementmap_vertex,\n\t\temissivemap_fragment: emissivemap_fragment,\n\t\temissivemap_pars_fragment: emissivemap_pars_fragment,\n\t\tencodings_fragment: encodings_fragment,\n\t\tencodings_pars_fragment: encodings_pars_fragment,\n\t\tenvmap_fragment: envmap_fragment,\n\t\tenvmap_pars_fragment: envmap_pars_fragment,\n\t\tenvmap_pars_vertex: envmap_pars_vertex,\n\t\tenvmap_vertex: envmap_vertex,\n\t\tfalloff_fragment: falloff_fragment,\n\t\tfalloffalphamap_fragment: falloffalphamap_fragment,\n\t\tfalloffmap_fragment: falloffmap_fragment,\n\t\tfog_fragment: fog_fragment,\n\t\tfog_pars_fragment: fog_pars_fragment,\n\t\tgradientmap_pars_fragment: gradientmap_pars_fragment,\n\t\tlightmap_fragment: lightmap_fragment,\n\t\tlightmap_pars_fragment: lightmap_pars_fragment,\n\t\tlights_lambert_vertex: lights_lambert_vertex,\n\t\tlights_pars: lights_pars,\n\t\tlights_phong_fragment: lights_phong_fragment,\n\t\tlights_phong_pars_fragment: lights_phong_pars_fragment,\n\t\tlights_physical_fragment: lights_physical_fragment,\n\t\tlights_physical_pars_fragment: lights_physical_pars_fragment,\n\t\tlights_template: lights_template,\n\t\tlogdepthbuf_fragment: logdepthbuf_fragment,\n\t\tlogdepthbuf_pars_fragment: logdepthbuf_pars_fragment,\n\t\tlogdepthbuf_pars_vertex: logdepthbuf_pars_vertex,\n\t\tlogdepthbuf_vertex: logdepthbuf_vertex,\n\t\tmap_fragment: map_fragment,\n\t\tmap_pars_fragment: map_pars_fragment,\n\t\tmap_particle_fragment: map_particle_fragment,\n\t\tmap_particle_pars_fragment: map_particle_pars_fragment,\n\t\tmetalnessmap_fragment: metalnessmap_fragment,\n\t\tmetalnessmap_pars_fragment: metalnessmap_pars_fragment,\n\t\tmorphnormal_vertex: morphnormal_vertex,\n\t\tmorphtarget_pars_vertex: morphtarget_pars_vertex,\n\t\tmorphtarget_vertex: morphtarget_vertex,\n\t\tnormal_flip: normal_flip,\n\t\tnormal_fragment: normal_fragment,\n\t\tnormalmap_pars_fragment: normalmap_pars_fragment,\n\t\tpacking: packing,\n\t\tpremultiplied_alpha_fragment: premultiplied_alpha_fragment,\n\t\tproject_vertex: project_vertex,\n\t\troughnessmap_fragment: roughnessmap_fragment,\n\t\troughnessmap_pars_fragment: roughnessmap_pars_fragment,\n\t\tshadowmap_pars_fragment: shadowmap_pars_fragment,\n\t\tshadowmap_pars_vertex: shadowmap_pars_vertex,\n\t\tshadowmap_vertex: shadowmap_vertex,\n\t\tshadowmask_pars_fragment: shadowmask_pars_fragment,\n\t\tskinbase_vertex: skinbase_vertex,\n\t\tskinning_pars_vertex: skinning_pars_vertex,\n\t\tskinning_vertex: skinning_vertex,\n\t\tskinnormal_vertex: skinnormal_vertex,\n\t\tslot_texel_transform_template: slot_texel_transform_template,\n\t\tslot_uv_transform_template: slot_uv_transform_template,\n\t\tspecularmap_fragment: specularmap_fragment,\n\t\tspecularmap_pars_fragment: specularmap_pars_fragment,\n\t\ttonemapping_fragment: tonemapping_fragment,\n\t\ttonemapping_pars_fragment: tonemapping_pars_fragment,\n\t\tuv_pars_fragment: uv_pars_fragment,\n\t\tuv_pars_vertex: uv_pars_vertex,\n\t\tuv_vertex: uv_vertex,\n\t\tuv2_pars_fragment: uv2_pars_fragment,\n\t\tuv2_pars_vertex: uv2_pars_vertex,\n\t\tuv2_vertex: uv2_vertex,\n\t\tworldpos_vertex: worldpos_vertex,\n\n\t\tcube_frag: cube_frag,\n\t\tcube_vert: cube_vert,\n\t\tcubeEnv_frag: cubeEnv_frag,\n\t\tcubeEnv_vert: cubeEnv_vert,\n\t\tdepth_frag: depth_frag,\n\t\tdepth_vert: depth_vert,\n\t\tdistanceRGBA_frag: distanceRGBA_frag,\n\t\tdistanceRGBA_vert: distanceRGBA_vert,\n\t\tequirect_frag: equirect_frag,\n\t\tequirect_vert: equirect_vert,\n\t\tlinedashed_frag: linedashed_frag,\n\t\tlinedashed_vert: linedashed_vert,\n\t\tmeshbasic_frag: meshbasic_frag,\n\t\tmeshbasic_vert: meshbasic_vert,\n\t\tmeshlambert_frag: meshlambert_frag,\n\t\tmeshlambert_vert: meshlambert_vert,\n\t\tmeshphong_frag: meshphong_frag,\n\t\tmeshphong_vert: meshphong_vert,\n\t\tmeshphysical_frag: meshphysical_frag,\n\t\tmeshphysical_vert: meshphysical_vert,\n\t\tnormal_frag: normal_frag,\n\t\tnormal_vert: normal_vert,\n\t\tpoints_frag: points_frag,\n\t\tpoints_vert: points_vert,\n\t\tshadow_frag: shadow_frag,\n\t\tshadow_vert: shadow_vert\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Color( r, g, b ) {\n\n\t\tif ( g === undefined && b === undefined ) {\n\n\t\t\t// r is THREE.Color, hex or string\n\t\t\treturn this.set( r );\n\n\t\t}\n\n\t\treturn this.setRGB( r, g, b );\n\n\t}\n\n\tColor.prototype = {\n\n\t\tconstructor: Color,\n\n\t\tisColor: true,\n\n\t\tr: 1, g: 1, b: 1,\n\n\t\tset: function ( value ) {\n\n\t\t\tif ( value && value.isColor ) {\n\n\t\t\t\tthis.copy( value );\n\n\t\t\t} else if ( typeof value === 'number' ) {\n\n\t\t\t\tthis.setHex( value );\n\n\t\t\t} else if ( typeof value === 'string' ) {\n\n\t\t\t\tthis.setStyle( value );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetScalar: function ( scalar ) {\n\n\t\t\tthis.r = scalar;\n\t\t\tthis.g = scalar;\n\t\t\tthis.b = scalar;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetHex: function ( hex ) {\n\n\t\t\thex = Math.floor( hex );\n\n\t\t\tthis.r = ( hex >> 16 & 255 ) / 255;\n\t\t\tthis.g = ( hex >> 8 & 255 ) / 255;\n\t\t\tthis.b = ( hex & 255 ) / 255;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetRGB: function ( r, g, b ) {\n\n\t\t\tthis.r = r;\n\t\t\tthis.g = g;\n\t\t\tthis.b = b;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetHSL: function () {\n\n\t\t\tfunction hue2rgb( p, q, t ) {\n\n\t\t\t\tif ( t < 0 ) t += 1;\n\t\t\t\tif ( t > 1 ) t -= 1;\n\t\t\t\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\n\t\t\t\tif ( t < 1 / 2 ) return q;\n\t\t\t\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\n\t\t\t\treturn p;\n\n\t\t\t}\n\n\t\t\treturn function setHSL( h, s, l ) {\n\n\t\t\t\t// h,s,l ranges are in 0.0 - 1.0\n\t\t\t\th = _Math.euclideanModulo( h, 1 );\n\t\t\t\ts = _Math.clamp( s, 0, 1 );\n\t\t\t\tl = _Math.clamp( l, 0, 1 );\n\n\t\t\t\tif ( s === 0 ) {\n\n\t\t\t\t\tthis.r = this.g = this.b = l;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\n\t\t\t\t\tvar q = ( 2 * l ) - p;\n\n\t\t\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\n\t\t\t\t\tthis.g = hue2rgb( q, p, h );\n\t\t\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\n\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tsetStyle: function ( style ) {\n\n\t\t\tfunction handleAlpha( string ) {\n\n\t\t\t\tif ( string === undefined ) return;\n\n\t\t\t\tif ( parseFloat( string ) < 1 ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tvar m;\n\n\t\t\tif ( m = /^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec( style ) ) {\n\n\t\t\t\t// rgb / hsl\n\n\t\t\t\tvar color;\n\t\t\t\tvar name = m[ 1 ];\n\t\t\t\tvar components = m[ 2 ];\n\n\t\t\t\tswitch ( name ) {\n\n\t\t\t\t\tcase 'rgb':\n\t\t\t\t\tcase 'rgba':\n\n\t\t\t\t\t\tif ( color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\n\t\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\n\t\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\n\t\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\n\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\n\n\t\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\n\t\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\n\t\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\n\t\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\n\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\n\n\t\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'hsl':\n\t\t\t\t\tcase 'hsla':\n\n\t\t\t\t\t\tif ( color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\n\t\t\t\t\t\t\tvar h = parseFloat( color[ 1 ] ) / 360;\n\t\t\t\t\t\t\tvar s = parseInt( color[ 2 ], 10 ) / 100;\n\t\t\t\t\t\t\tvar l = parseInt( color[ 3 ], 10 ) / 100;\n\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\n\n\t\t\t\t\t\t\treturn this.setHSL( h, s, l );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t} else if ( m = /^\\#([A-Fa-f0-9]+)$/.exec( style ) ) {\n\n\t\t\t\t// hex color\n\n\t\t\t\tvar hex = m[ 1 ];\n\t\t\t\tvar size = hex.length;\n\n\t\t\t\tif ( size === 3 ) {\n\n\t\t\t\t\t// #ff0\n\t\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\n\t\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\n\n\t\t\t\t\treturn this;\n\n\t\t\t\t} else if ( size === 6 ) {\n\n\t\t\t\t\t// #ff0000\n\t\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\n\t\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\n\n\t\t\t\t\treturn this;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( style && style.length > 0 ) {\n\n\t\t\t\t// color keywords\n\t\t\t\tvar hex = ColorKeywords[ style ];\n\n\t\t\t\tif ( hex !== undefined ) {\n\n\t\t\t\t\t// red\n\t\t\t\t\tthis.setHex( hex );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// unknown color\n\t\t\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this.r, this.g, this.b );\n\n\t\t},\n\n\t\tcopy: function ( color ) {\n\n\t\t\tthis.r = color.r;\n\t\t\tthis.g = color.g;\n\t\t\tthis.b = color.b;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyGammaToLinear: function ( color, gammaFactor ) {\n\n\t\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\n\n\t\t\tthis.r = Math.pow( color.r, gammaFactor );\n\t\t\tthis.g = Math.pow( color.g, gammaFactor );\n\t\t\tthis.b = Math.pow( color.b, gammaFactor );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyLinearToGamma: function ( color, gammaFactor ) {\n\n\t\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\n\n\t\t\tvar safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\n\n\t\t\tthis.r = Math.pow( color.r, safeInverse );\n\t\t\tthis.g = Math.pow( color.g, safeInverse );\n\t\t\tthis.b = Math.pow( color.b, safeInverse );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tconvertGammaToLinear: function () {\n\n\t\t\tvar r = this.r, g = this.g, b = this.b;\n\n\t\t\tthis.r = r * r;\n\t\t\tthis.g = g * g;\n\t\t\tthis.b = b * b;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tconvertLinearToGamma: function () {\n\n\t\t\tthis.r = Math.sqrt( this.r );\n\t\t\tthis.g = Math.sqrt( this.g );\n\t\t\tthis.b = Math.sqrt( this.b );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetHex: function () {\n\n\t\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\n\n\t\t},\n\n\t\tgetHexString: function () {\n\n\t\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\n\n\t\t},\n\n\t\tgetHSL: function ( optionalTarget ) {\n\n\t\t\t// h,s,l ranges are in 0.0 - 1.0\n\n\t\t\tvar hsl = optionalTarget || { h: 0, s: 0, l: 0 };\n\n\t\t\tvar r = this.r, g = this.g, b = this.b;\n\n\t\t\tvar max = Math.max( r, g, b );\n\t\t\tvar min = Math.min( r, g, b );\n\n\t\t\tvar hue, saturation;\n\t\t\tvar lightness = ( min + max ) / 2.0;\n\n\t\t\tif ( min === max ) {\n\n\t\t\t\thue = 0;\n\t\t\t\tsaturation = 0;\n\n\t\t\t} else {\n\n\t\t\t\tvar delta = max - min;\n\n\t\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\n\n\t\t\t\tswitch ( max ) {\n\n\t\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\n\t\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\n\t\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\n\n\t\t\t\t}\n\n\t\t\t\thue /= 6;\n\n\t\t\t}\n\n\t\t\thsl.h = hue;\n\t\t\thsl.s = saturation;\n\t\t\thsl.l = lightness;\n\n\t\t\treturn hsl;\n\n\t\t},\n\n\t\tgetStyle: function () {\n\n\t\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\n\n\t\t},\n\n\t\toffsetHSL: function ( h, s, l ) {\n\n\t\t\tvar hsl = this.getHSL();\n\n\t\t\thsl.h += h; hsl.s += s; hsl.l += l;\n\n\t\t\tthis.setHSL( hsl.h, hsl.s, hsl.l );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tadd: function ( color ) {\n\n\t\t\tthis.r += color.r;\n\t\t\tthis.g += color.g;\n\t\t\tthis.b += color.b;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddColors: function ( color1, color2 ) {\n\n\t\t\tthis.r = color1.r + color2.r;\n\t\t\tthis.g = color1.g + color2.g;\n\t\t\tthis.b = color1.b + color2.b;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddScalar: function ( s ) {\n\n\t\t\tthis.r += s;\n\t\t\tthis.g += s;\n\t\t\tthis.b += s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsub: function( color ) {\n\n\t\t\tthis.r = Math.max( 0, this.r - color.r );\n\t\t\tthis.g = Math.max( 0, this.g - color.g );\n\t\t\tthis.b = Math.max( 0, this.b - color.b );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiply: function ( color ) {\n\n\t\t\tthis.r *= color.r;\n\t\t\tthis.g *= color.g;\n\t\t\tthis.b *= color.b;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmultiplyScalar: function ( s ) {\n\n\t\t\tthis.r *= s;\n\t\t\tthis.g *= s;\n\t\t\tthis.b *= s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tlerp: function ( color, alpha ) {\n\n\t\t\tthis.r += ( color.r - this.r ) * alpha;\n\t\t\tthis.g += ( color.g - this.g ) * alpha;\n\t\t\tthis.b += ( color.b - this.b ) * alpha;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tequals: function ( c ) {\n\n\t\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\n\n\t\t},\n\n\t\tfromArray: function ( array, offset ) {\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tthis.r = array[ offset ];\n\t\t\tthis.g = array[ offset + 1 ];\n\t\t\tthis.b = array[ offset + 2 ];\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoArray: function ( array, offset ) {\n\n\t\t\tif ( array === undefined ) array = [];\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tarray[ offset ] = this.r;\n\t\t\tarray[ offset + 1 ] = this.g;\n\t\t\tarray[ offset + 2 ] = this.b;\n\n\t\t\treturn array;\n\n\t\t},\n\n\t\ttoJSON: function () {\n\n\t\t\treturn this.getHex();\n\n\t\t}\n\n\t};\n\n\tvar ColorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\n\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\n\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\n\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\n\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\n\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\n\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\n\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\n\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\n\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\n\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\n\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\n\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\n\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\n\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\n\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\n\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\n\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\n\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\n\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\n\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\n\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\n\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\n\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction DataTexture( data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\n\n\t\tTexture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.image = { data: data, width: width, height: height };\n\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\n\n\t\tthis.generateMipmaps  = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n\tDataTexture.prototype = Object.create( Texture.prototype );\n\tDataTexture.prototype.constructor = DataTexture;\n\n\tDataTexture.prototype.isDataTexture = true;\n\n\t/**\n\t * Uniforms library for shared webgl shaders\n\t */\n\n\tvar UniformsLib = {\n\n\t\tcommon: {\n\n\t\t\tdiffuse: { value: new Color( 0xeeeeee ) },\n\t\t\topacity: { value: 1.0 },\n\n\t\t\t\"map\": { value: null },\n\t\t\t\"mapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"mapTexelTransformParams\": { value: new Vector2( 1, 0 ) },\n\t\t\t\"offsetRepeat\": { value: new Vector4( 0, 0, 1, 1 ) },\n\n\t\t\t\"specularMap\": { value: null },\n\t\t\t\"specularMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"specularMapTexelTransformParams\": { value: new Vector2( 1, 0 ) },\n\n\t\t\t\"alphaMap\": { value: null },\n\t\t\t\"alphaMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"alphaMapTexelTransformParams\": { value: new Vector2( 1, 0 ) },\n\n\t\t\tenvMap: { value: null },\n\t\t\tflipEnvMap: { value: - 1 },\n\t\t\treflectivity: { value: 1.0 },\n\t\t\trefractionRatio: { value: 0.98 }\n\n\t\t},\n\n\t\taomap: {\n\n\t\t\t\"aoMap\": { value: null },\n\t\t\t\"aoMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"aoMapTexelTransformParams\": { value: new Vector2( 1, 0 ) },\n\t\t\t\"aoMapIntensity\": { value: 1 }\n\n\t\t},\n\n\t\tlightmap: {\n\n\t\t\t\"lightMap\": { value: null },\n\t\t\t\"lightMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"lightMapTexelTransformParams\": { value: new Vector2( 1, 0 ) },\n\t\t\t\"lightMapIntensity\": { value: 1 }\n\n\t\t},\n\n\t\temissivemap: {\n\n\t\t\t\"emissiveMap\": { value: null },\n\t\t\t\"emissiveMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"emissiveMapTexelTransformParams\": { value: new Vector2( 1, 0 ) }\n\n\t\t},\n\n\t\tbumpmap: {\n\n\t\t\t\"bumpMap\": { value: null },\n\t\t\t\"bumpScale\": { value: 1 },\n\t\t\t\"bumpMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"bumpMapTexelTransformParams\": { value: new Vector2( 1, 0 ) }\n\n\t\t},\n\n\t\tnormalmap: {\n\n\t\t\t\"normalMap\": { value: null },\n\t\t\t\"normalScale\": { value: new Vector2( 1, 1 ) }, // for backwards compatibility\n\t\t\t\"normalMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"normalMapTexelTransformParams\": { value: new Vector2( 1, 0 ) }\n\n\t\t},\n\n\t\tdisplacementmap: {\n\n\t\t\t\"displacementMap\": { value: null },\n\t\t\t\"displacementScale\": { value: 1 }, // for backwards compatibility\n\t\t\t\"displacementBias\": { value: 0 }, // for backwards compatibility\n\t\t\t\"displacementMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"displacementMapTexelTransformParams\": { value: new Vector2( 1, 0 ) }\n\n\t\t},\n\n\n\t\tfalloffmap: {\n\n\t\t\t\"falloffMap\": { value: null },\n\t\t\t\"falloffMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"falloffMapTexelTransformParams\": { value: new Vector2( 1, 0 ) }\n\n\t\t},\n\n\t\tfalloffalphamap: {\n\n\t\t\t\"falloffAlphaMap\": { value: null },\n\t\t\t\"falloffAlphaMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"falloffAlphaMapTexelTransformParams\": { value: new Vector2( 1, 0 ) }\n\n\t\t},\n\n\t\troughnessmap: {\n\n\t\t\t\"roughnessMap\": { value: null },\n\t\t\t\"roughnessMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"roughnessMapTexelTransformParams\": { value: new Vector2( 1, 0 ) }\n\n\t\t},\n\n\t\tmetalnessmap: {\n\n\t\t\t\"metalnessMap\": { value: null },\n\t\t\t\"metalnessMapUVTransformParams\": { value: new Vector4( 0, 0, 1, 1 ) },\n\t\t\t\"metalnessMapTexelTransformParams\": { value: new Vector2( 1, 0 ) }\n\n\t\t},\n\n\t\tgradientmap: {\n\n\t\t\tgradientMap: { value: null }\n\n\t\t},\n\n\t\tfog: {\n\n\t\t\tfogDensity: { value: 0.00025 },\n\t\t\tfogNear: { value: 1 },\n\t\t\tfogFar: { value: 2000 },\n\t\t\tfogColor: { value: new Color( 0xffffff ) }\n\n\t\t},\n\n\t\tlights: {\n\n\t\t\tambientLightColor: { value: [] },\n\n\t\t\tdirectionalLights: { value: [], properties: {\n\t\t\t\tdirection: {},\n\t\t\t\tcolor: {},\n\n\t\t\t\tshadow: {},\n\t\t\t\tshadowBias: {},\n\t\t\t\tshadowRadius: {},\n\t\t\t\tshadowMapSize: {},\n\t\t\t\tshadowSpreadAngle: {},\n\t\t\t\tshadowCameraParams: {}\n\t\t\t} },\n\n\t\t\tdirectionalShadowMap: { value: [] },\n\t\t\tdirectionalShadowMatrix: { value: [] },\n\n\t\t\tspotLights: { value: [], properties: {\n\t\t\t\tcolor: {},\n\t\t\t\tposition: {},\n\t\t\t\tdirection: {},\n\t\t\t\tdistance: {},\n\t\t\t\tconeCos: {},\n\t\t\t\tpenumbraCos: {},\n\t\t\t\tdecay: {},\n\n\t\t\t\tshadow: {},\n\t\t\t\tshadowBias: {},\n\t\t\t\tshadowRadius: {},\n\t\t\t\tshadowMapSize: {},\n\t\t\t\tshadowCameraParams: {}\n\t\t\t} },\n\n\t\t\tspotShadowMap: { value: [] },\n\t\t\tspotShadowMatrix: { value: [] },\n\n\t\t\tpointLights: { value: [], properties: {\n\t\t\t\tcolor: {},\n\t\t\t\tposition: {},\n\t\t\t\tdecay: {},\n\t\t\t\tdistance: {},\n\n\t\t\t\tshadow: {},\n\t\t\t\tshadowBias: {},\n\t\t\t\tshadowRadius: {},\n\t\t\t\tshadowMapSize: {}\n\t\t\t} },\n\n\t\t\tpointShadowMap: { value: [] },\n\t\t\tpointShadowMatrix: { value: [] },\n\n\t\t\themisphereLights: { value: [], properties: {\n\t\t\t\tdirection: {},\n\t\t\t\tskyColor: {},\n\t\t\t\tgroundColor: {}\n\t\t\t} },\n\n\t        // TODO (abelnation): RectAreaLight BRDF data needs to be moved from example to main src\n\t        rectAreaLights: { value: [], properties: {\n\t            color: {},\n\t            position: {},\n\t            width: {},\n\t            height: {},\n\t        } }\n\n\t\t},\n\n\t\tpoints: {\n\n\t\t\tdiffuse: { value: new Color( 0xeeeeee ) },\n\t\t\topacity: { value: 1.0 },\n\t\t\tsize: { value: 1.0 },\n\t\t\tscale: { value: 1.0 },\n\t\t\tmap: { value: null },\n\t\t\toffsetRepeat: { value: new Vector4( 0, 0, 1, 1 ) }\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t */\n\n\tvar ShaderLib = {\n\n\t\tbasic: {\n\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib.common,\n\t\t\t\tUniformsLib.aomap,\n\t\t\t\tUniformsLib.lightmap,\n\t\t\t\tUniformsLib.fog\n\t\t\t] ),\n\n\t\t\tvertexShader: ShaderChunk.meshbasic_vert,\n\t\t\tfragmentShader: ShaderChunk.meshbasic_frag\n\n\t\t},\n\n\t\tlambert: {\n\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib.common,\n\t\t\t\tUniformsLib.aomap,\n\t\t\t\tUniformsLib.lightmap,\n\t\t\t\tUniformsLib.emissivemap,\n\t\t\t\tUniformsLib.fog,\n\t\t\t\tUniformsLib.lights,\n\t\t\t\t{\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) }\n\t\t\t\t}\n\t\t\t] ),\n\n\t\t\tvertexShader: ShaderChunk.meshlambert_vert,\n\t\t\tfragmentShader: ShaderChunk.meshlambert_frag\n\n\t\t},\n\n\t\tphong: {\n\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib.common,\n\t\t\t\tUniformsLib.aomap,\n\t\t\t\tUniformsLib.lightmap,\n\t\t\t\tUniformsLib.emissivemap,\n\t\t\t\tUniformsLib.bumpmap,\n\t\t\t\tUniformsLib.normalmap,\n\t\t\t\tUniformsLib.displacementmap,\n\t\t\t\tUniformsLib.gradientmap,\n\t\t\t\tUniformsLib.fog,\n\t\t\t\tUniformsLib.lights,\n\t\t\t\t{\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) },\n\t\t\t\t\tspecular: { value: new Color( 0x111111 ) },\n\t\t\t\t\tshininess: { value: 30 }\n\t\t\t\t}\n\t\t\t] ),\n\n\t\t\tvertexShader: ShaderChunk.meshphong_vert,\n\t\t\tfragmentShader: ShaderChunk.meshphong_frag\n\n\t\t},\n\n\t\tstandard: {\n\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib.common,\n\t\t\t\tUniformsLib.aomap,\n\t\t\t\tUniformsLib.lightmap,\n\t\t\t\tUniformsLib.emissivemap,\n\t\t\t\tUniformsLib.bumpmap,\n\t\t\t\tUniformsLib.normalmap,\n\t\t\t\tUniformsLib.displacementmap,\n\t\t\t\tUniformsLib.roughnessmap,\n\t\t\t\tUniformsLib.metalnessmap,\n\t\t\t\tUniformsLib.fog,\n\t\t\t\tUniformsLib.lights,\n\t\t\t\t{\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) },\n\t\t\t\t\troughness: { value: 0.5 },\n\t\t\t\t\tmetalness: { value: 0 },\n\t\t\t\t\tenvMapIntensity: { value: 1 } // temporary\n\t\t\t\t}\n\t\t\t] ),\n\n\t\t\tvertexShader: ShaderChunk.meshphysical_vert,\n\t\t\tfragmentShader: ShaderChunk.meshphysical_frag\n\n\t\t},\n\n\t\tpoints: {\n\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib.points,\n\t\t\t\tUniformsLib.fog\n\t\t\t] ),\n\n\t\t\tvertexShader: ShaderChunk.points_vert,\n\t\t\tfragmentShader: ShaderChunk.points_frag\n\n\t\t},\n\n\t\tdashed: {\n\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib.common,\n\t\t\t\tUniformsLib.fog,\n\t\t\t\t{\n\t\t\t\t\tscale: { value: 1 },\n\t\t\t\t\tdashSize: { value: 1 },\n\t\t\t\t\ttotalSize: { value: 2 }\n\t\t\t\t}\n\t\t\t] ),\n\n\t\t\tvertexShader: ShaderChunk.linedashed_vert,\n\t\t\tfragmentShader: ShaderChunk.linedashed_frag\n\n\t\t},\n\n\t\tdepth: {\n\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib.common,\n\t\t\t\tUniformsLib.displacementmap\n\t\t\t] ),\n\n\t\t\tvertexShader: ShaderChunk.depth_vert,\n\t\t\tfragmentShader: ShaderChunk.depth_frag\n\n\t\t},\n\n\t\tnormal: {\n\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib.common,\n\t\t\t\tUniformsLib.bumpmap,\n\t\t\t\tUniformsLib.normalmap,\n\t\t\t\tUniformsLib.displacementmap,\n\t\t\t\t{\n\t\t\t\t\topacity: { value: 1.0 }\n\t\t\t\t}\n\t\t\t] ),\n\n\t\t\tvertexShader: ShaderChunk.normal_vert,\n\t\t\tfragmentShader: ShaderChunk.normal_frag\n\n\t\t},\n\n\t\t/* -------------------------------------------------------------------------\n\t\t//\tCube map shader\n\t\t ------------------------------------------------------------------------- */\n\n\t\tcube: {\n\n\t\t\tuniforms: {\n\t\t\t\ttCube: { value: null },\n\t\t\t\ttFlip: { value: - 1 },\n\t\t\t\topacity: { value: 1.0 }\n\t\t\t},\n\n\t\t\tvertexShader: ShaderChunk.cube_vert,\n\t\t\tfragmentShader: ShaderChunk.cube_frag\n\n\t\t},\n\n\t\t/* -------------------------------------------------------------------------\n\t\t//\tCube map shader\n\t\t ------------------------------------------------------------------------- */\n\n\t\tequirect: {\n\n\t\t\tuniforms: {\n\t\t\t\ttEquirect: { value: null },\n\t\t\t\ttFlip: { value: - 1 }\n\t\t\t},\n\n\t\t\tvertexShader: ShaderChunk.equirect_vert,\n\t\t\tfragmentShader: ShaderChunk.equirect_frag\n\n\t\t},\n\n\t\tdistanceRGBA: {\n\n\t\t\tuniforms: {\n\t\t\t\tlightPos: { value: new Vector3() }\n\t\t\t},\n\n\t\t\tvertexShader: ShaderChunk.distanceRGBA_vert,\n\t\t\tfragmentShader: ShaderChunk.distanceRGBA_frag\n\n\t\t}\n\n\t};\n\n\t/* -------------------------------------------------------------------------\n\t//\tCube map shader\n\t ------------------------------------------------------------------------- */\n\n\tShaderLib.cubeEnv = {\n\n\n\t\tuniforms: UniformsUtils.merge( [\n\t\t\tUniformsLib.common,\n\t\t\tShaderLib.standard.uniforms,\n\t\t\t{\n\t\t\t\tenvMap: { value: null },\n\t\t\t\tenvMapIntensity: { value: 1.0 },\n\t\t\t\ttFlip: { value: - 1 },\n\t\t\t\topacity: { value: 1.0 },\n\t\t\t\troughness: { value: 0.0 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.cubeEnv_vert,\n\t\tfragmentShader: ShaderChunk.cubeEnv_frag\n\n\t};\n\n\tShaderLib.physical = {\n\n\t\tuniforms: UniformsUtils.merge( [\n\t\t\tShaderLib.standard.uniforms,\n\t\t\tUniformsLib.falloffmap,\n\t\t\tUniformsLib.falloffalphamap,\n\t\t\t{\n\t\t\t\tfalloffDiffuse: { value: new Color( 0xffffff ) },\n\t\t\t\tfalloffOpacity: { value: 0 },\n\t\t\t\tclearCoat: { value: 0 },\n\t\t\t\tclearCoatRoughness: { value: 0 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshphysical_vert,\n\t\tfragmentShader: ShaderChunk.meshphysical_frag\n\n\t};\n\n\t/**\n\t * @author bhouston / http://clara.io\n\t */\n\n\tfunction Box2( min, max ) {\n\n\t\tthis.min = ( min !== undefined ) ? min : new Vector2( + Infinity, + Infinity );\n\t\tthis.max = ( max !== undefined ) ? max : new Vector2( - Infinity, - Infinity );\n\n\t}\n\n\tBox2.prototype = {\n\n\t\tconstructor: Box2,\n\n\t\tset: function ( min, max ) {\n\n\t\t\tthis.min.copy( min );\n\t\t\tthis.max.copy( max );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromPoints: function ( points ) {\n\n\t\t\tthis.makeEmpty();\n\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromCenterAndSize: function () {\n\n\t\t\tvar v1 = new Vector2();\n\n\t\t\treturn function setFromCenterAndSize( center, size ) {\n\n\t\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\n\t\t\t\tthis.min.copy( center ).sub( halfSize );\n\t\t\t\tthis.max.copy( center ).add( halfSize );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( box ) {\n\n\t\t\tthis.min.copy( box.min );\n\t\t\tthis.max.copy( box.max );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeEmpty: function () {\n\n\t\t\tthis.min.x = this.min.y = + Infinity;\n\t\t\tthis.max.x = this.max.y = - Infinity;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tisEmpty: function () {\n\n\t\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\n\n\t\t},\n\n\t\tgetCenter: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector2();\n\t\t\treturn this.isEmpty() ? result.set( 0, 0 ) : result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t\t},\n\n\t\tgetSize: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector2();\n\t\t\treturn this.isEmpty() ? result.set( 0, 0 ) : result.subVectors( this.max, this.min );\n\n\t\t},\n\n\t\texpandByPoint: function ( point ) {\n\n\t\t\tthis.min.min( point );\n\t\t\tthis.max.max( point );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\texpandByVector: function ( vector ) {\n\n\t\t\tthis.min.sub( vector );\n\t\t\tthis.max.add( vector );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\texpandByScalar: function ( scalar ) {\n\n\t\t\tthis.min.addScalar( - scalar );\n\t\t\tthis.max.addScalar( scalar );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcontainsPoint: function ( point ) {\n\n\t\t\treturn point.x < this.min.x || point.x > this.max.x ||\n\t\t\t\tpoint.y < this.min.y || point.y > this.max.y ? false : true;\n\n\t\t},\n\n\t\tcontainsBox: function ( box ) {\n\n\t\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y;\n\n\t\t},\n\n\t\tgetParameter: function ( point, optionalTarget ) {\n\n\t\t\t// This can potentially have a divide by zero if the box\n\t\t\t// has a size dimension of 0.\n\n\t\t\tvar result = optionalTarget || new Vector2();\n\n\t\t\treturn result.set(\n\t\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\n\t\t\t);\n\n\t\t},\n\n\t\tintersectsBox: function ( box ) {\n\n\t\t\t// using 6 splitting planes to rule out intersections.\n\t\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ? false : true;\n\n\t\t},\n\n\t\tclampPoint: function ( point, optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector2();\n\t\t\treturn result.copy( point ).clamp( this.min, this.max );\n\n\t\t},\n\n\t\tdistanceToPoint: function () {\n\n\t\t\tvar v1 = new Vector2();\n\n\t\t\treturn function distanceToPoint( point ) {\n\n\t\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\n\t\t\t\treturn clampedPoint.sub( point ).length();\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tintersect: function ( box ) {\n\n\t\t\tthis.min.max( box.min );\n\t\t\tthis.max.min( box.max );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tunion: function ( box ) {\n\n\t\t\tthis.min.min( box.min );\n\t\t\tthis.max.max( box.max );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttranslate: function ( offset ) {\n\n\t\t\tthis.min.add( offset );\n\t\t\tthis.max.add( offset );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tequals: function ( box ) {\n\n\t\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction LensFlarePlugin( renderer, flares ) {\n\n\t\tvar gl = renderer.context;\n\t\tvar state = renderer.state;\n\n\t\tvar vertexBuffer, elementBuffer;\n\t\tvar shader, program, attributes, uniforms;\n\n\t\tvar tempTexture, occlusionTexture;\n\n\t\tfunction init() {\n\n\t\t\tvar vertices = new Float32Array( [\n\t\t\t\t- 1, - 1,  0, 0,\n\t\t\t\t 1, - 1,  1, 0,\n\t\t\t\t 1,  1,  1, 1,\n\t\t\t\t- 1,  1,  0, 1\n\t\t\t] );\n\n\t\t\tvar faces = new Uint16Array( [\n\t\t\t\t0, 1, 2,\n\t\t\t\t0, 2, 3\n\t\t\t] );\n\n\t\t\t// buffers\n\n\t\t\tvertexBuffer     = gl.createBuffer();\n\t\t\telementBuffer    = gl.createBuffer();\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\n\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\n\t\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\n\n\t\t\t// textures\n\n\t\t\ttempTexture      = gl.createTexture();\n\t\t\tocclusionTexture = gl.createTexture();\n\n\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\n\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null );\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\n\t\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\n\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null );\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\n\t\t\tshader = {\n\n\t\t\t\tvertexShader: [\n\n\t\t\t\t\t\"uniform lowp int renderType;\",\n\n\t\t\t\t\t\"uniform vec3 screenPosition;\",\n\t\t\t\t\t\"uniform vec2 scale;\",\n\t\t\t\t\t\"uniform float rotation;\",\n\n\t\t\t\t\t\"uniform sampler2D occlusionMap;\",\n\n\t\t\t\t\t\"attribute vec2 position;\",\n\t\t\t\t\t\"attribute vec2 uv;\",\n\n\t\t\t\t\t\"varying vec2 vUV;\",\n\t\t\t\t\t\"varying float vVisibility;\",\n\n\t\t\t\t\t\"void main() {\",\n\n\t\t\t\t\t\t\"vUV = uv;\",\n\n\t\t\t\t\t\t\"vec2 pos = position;\",\n\n\t\t\t\t\t\t\"if ( renderType == 2 ) {\",\n\n\t\t\t\t\t\t\t\"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\n\n\t\t\t\t\t\t\t\"vVisibility =        visibility.r / 9.0;\",\n\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.g / 9.0;\",\n\t\t\t\t\t\t\t\"vVisibility *=       visibility.b / 9.0;\",\n\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.a / 9.0;\",\n\n\t\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\n\t\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\n\n\t\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\n\n\t\t\t\t\t\"}\"\n\n\t\t\t\t].join( \"\\n\" ),\n\n\t\t\t\tfragmentShader: [\n\n\t\t\t\t\t\"uniform lowp int renderType;\",\n\n\t\t\t\t\t\"uniform sampler2D map;\",\n\t\t\t\t\t\"uniform float opacity;\",\n\t\t\t\t\t\"uniform vec3 color;\",\n\n\t\t\t\t\t\"varying vec2 vUV;\",\n\t\t\t\t\t\"varying float vVisibility;\",\n\n\t\t\t\t\t\"void main() {\",\n\n\t\t\t\t\t\t// pink square\n\n\t\t\t\t\t\t\"if ( renderType == 0 ) {\",\n\n\t\t\t\t\t\t\t\"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\n\n\t\t\t\t\t\t// restore\n\n\t\t\t\t\t\t\"} else if ( renderType == 1 ) {\",\n\n\t\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\n\n\t\t\t\t\t\t// flare\n\n\t\t\t\t\t\t\"} else {\",\n\n\t\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\n\t\t\t\t\t\t\t\"texture.a *= opacity * vVisibility;\",\n\t\t\t\t\t\t\t\"gl_FragColor = texture;\",\n\t\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\n\n\t\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\"}\"\n\n\t\t\t\t].join( \"\\n\" )\n\n\t\t\t};\n\n\t\t\tprogram = createProgram( shader );\n\n\t\t\tattributes = {\n\t\t\t\tvertex: gl.getAttribLocation ( program, \"position\" ),\n\t\t\t\tuv:     gl.getAttribLocation ( program, \"uv\" )\n\t\t\t};\n\n\t\t\tuniforms = {\n\t\t\t\trenderType:     gl.getUniformLocation( program, \"renderType\" ),\n\t\t\t\tmap:            gl.getUniformLocation( program, \"map\" ),\n\t\t\t\tocclusionMap:   gl.getUniformLocation( program, \"occlusionMap\" ),\n\t\t\t\topacity:        gl.getUniformLocation( program, \"opacity\" ),\n\t\t\t\tcolor:          gl.getUniformLocation( program, \"color\" ),\n\t\t\t\tscale:          gl.getUniformLocation( program, \"scale\" ),\n\t\t\t\trotation:       gl.getUniformLocation( program, \"rotation\" ),\n\t\t\t\tscreenPosition: gl.getUniformLocation( program, \"screenPosition\" )\n\t\t\t};\n\n\t\t}\n\n\t\t/*\n\t\t * Render lens flares\n\t\t * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\n\t\t *         reads these back and calculates occlusion.\n\t\t */\n\n\t\tthis.render = function ( scene, camera, viewport ) {\n\n\t\t\tif ( flares.length === 0 ) return;\n\n\t\t\tvar tempPosition = new Vector3();\n\n\t\t\tvar invAspect = viewport.w / viewport.z,\n\t\t\t\thalfViewportWidth = viewport.z * 0.5,\n\t\t\t\thalfViewportHeight = viewport.w * 0.5;\n\n\t\t\tvar size = 16 / viewport.w,\n\t\t\t\tscale = new Vector2( size * invAspect, size );\n\n\t\t\tvar screenPosition = new Vector3( 1, 1, 0 ),\n\t\t\t\tscreenPositionPixels = new Vector2( 1, 1 );\n\n\t\t\tvar validArea = new Box2();\n\n\t\t\tvalidArea.min.set( viewport.x, viewport.y );\n\t\t\tvalidArea.max.set( viewport.x + ( viewport.z - 16 ), viewport.y + ( viewport.w - 16 ) );\n\n\t\t\tif ( program === undefined ) {\n\n\t\t\t\tinit();\n\n\t\t\t}\n\n\t\t\tgl.useProgram( program );\n\n\t\t\tstate.initAttributes();\n\t\t\tstate.enableAttribute( attributes.vertex );\n\t\t\tstate.enableAttribute( attributes.uv );\n\t\t\tstate.disableUnusedAttributes();\n\n\t\t\t// loop through all lens flares to update their occlusion and positions\n\t\t\t// setup gl and common used attribs/uniforms\n\n\t\t\tgl.uniform1i( uniforms.occlusionMap, 0 );\n\t\t\tgl.uniform1i( uniforms.map, 1 );\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\n\t\t\tgl.vertexAttribPointer( attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0 );\n\t\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\n\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\n\n\t\t\tstate.disable( gl.CULL_FACE );\n\t\t\tstate.setDepthWrite( false );\n\n\t\t\tfor ( var i = 0, l = flares.length; i < l; i ++ ) {\n\n\t\t\t\tsize = 16 / viewport.w;\n\t\t\t\tscale.set( size * invAspect, size );\n\n\t\t\t\t// calc object screen position\n\n\t\t\t\tvar flare = flares[ i ];\n\n\t\t\t\ttempPosition.set( flare.matrixWorld.elements[ 12 ], flare.matrixWorld.elements[ 13 ], flare.matrixWorld.elements[ 14 ] );\n\n\t\t\t\ttempPosition.applyMatrix4( camera.matrixWorldInverse );\n\t\t\t\ttempPosition.applyMatrix4( camera.projectionMatrix );\n\n\t\t\t\t// setup arrays for gl programs\n\n\t\t\t\tscreenPosition.copy( tempPosition );\n\n\t\t\t\t// horizontal and vertical coordinate of the lower left corner of the pixels to copy\n\n\t\t\t\tscreenPositionPixels.x = viewport.x + ( screenPosition.x * halfViewportWidth ) + halfViewportWidth - 8;\n\t\t\t\tscreenPositionPixels.y = viewport.y + ( screenPosition.y * halfViewportHeight ) + halfViewportHeight - 8;\n\n\t\t\t\t// screen cull\n\n\t\t\t\tif ( validArea.containsPoint( screenPositionPixels ) === true ) {\n\n\t\t\t\t\t// save current RGB to temp texture\n\n\t\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\n\t\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, null );\n\t\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\n\t\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\n\t\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x, screenPositionPixels.y, 16, 16, 0 );\n\n\n\t\t\t\t\t// render pink quad\n\n\t\t\t\t\tgl.uniform1i( uniforms.renderType, 0 );\n\t\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\n\t\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\n\n\t\t\t\t\tstate.disable( gl.BLEND );\n\t\t\t\t\tstate.enable( gl.DEPTH_TEST );\n\n\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\n\n\n\t\t\t\t\t// copy result to occlusionMap\n\n\t\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\n\t\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\n\t\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x, screenPositionPixels.y, 16, 16, 0 );\n\n\n\t\t\t\t\t// restore graphics\n\n\t\t\t\t\tgl.uniform1i( uniforms.renderType, 1 );\n\t\t\t\t\tstate.disable( gl.DEPTH_TEST );\n\n\t\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\n\t\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\n\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\n\n\n\t\t\t\t\t// update object positions\n\n\t\t\t\t\tflare.positionScreen.copy( screenPosition );\n\n\t\t\t\t\tif ( flare.customUpdateCallback ) {\n\n\t\t\t\t\t\tflare.customUpdateCallback( flare );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tflare.updateLensFlares();\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// render flares\n\n\t\t\t\t\tgl.uniform1i( uniforms.renderType, 2 );\n\t\t\t\t\tstate.enable( gl.BLEND );\n\n\t\t\t\t\tfor ( var j = 0, jl = flare.lensFlares.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar sprite = flare.lensFlares[ j ];\n\n\t\t\t\t\t\tif ( sprite.opacity > 0.001 && sprite.scale > 0.001 ) {\n\n\t\t\t\t\t\t\tscreenPosition.x = sprite.x;\n\t\t\t\t\t\t\tscreenPosition.y = sprite.y;\n\t\t\t\t\t\t\tscreenPosition.z = sprite.z;\n\n\t\t\t\t\t\t\tsize = sprite.size * sprite.scale / viewport.w;\n\n\t\t\t\t\t\t\tscale.x = size * invAspect;\n\t\t\t\t\t\t\tscale.y = size;\n\n\t\t\t\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\n\t\t\t\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\n\t\t\t\t\t\t\tgl.uniform1f( uniforms.rotation, sprite.rotation );\n\n\t\t\t\t\t\t\tgl.uniform1f( uniforms.opacity, sprite.opacity );\n\t\t\t\t\t\t\tgl.uniform3f( uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b );\n\n\t\t\t\t\t\t\tstate.setBlending( sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst );\n\t\t\t\t\t\t\trenderer.setTexture2D( sprite.texture, 1 );\n\n\t\t\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// restore gl\n\n\t\t\tstate.enable( gl.CULL_FACE );\n\t\t\tstate.enable( gl.DEPTH_TEST );\n\t\t\tstate.setDepthWrite( true );\n\n\t\t\trenderer.resetGLState();\n\n\t\t};\n\n\t\tfunction createProgram( shader ) {\n\n\t\t\tvar program = gl.createProgram();\n\n\t\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\n\t\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\n\n\t\t\tvar prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\n\n\t\t\tgl.shaderSource( fragmentShader, prefix + shader.fragmentShader );\n\t\t\tgl.shaderSource( vertexShader, prefix + shader.vertexShader );\n\n\t\t\tgl.compileShader( fragmentShader );\n\t\t\tgl.compileShader( vertexShader );\n\n\t\t\tgl.attachShader( program, fragmentShader );\n\t\t\tgl.attachShader( program, vertexShader );\n\n\t\t\tgl.linkProgram( program );\n\n\t\t\treturn program;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction SpritePlugin( renderer, sprites ) {\n\n\t\tvar gl = renderer.context;\n\t\tvar state = renderer.state;\n\n\t\tvar vertexBuffer, elementBuffer;\n\t\tvar program, attributes, uniforms;\n\n\t\tvar texture;\n\n\t\t// decompose matrixWorld\n\n\t\tvar spritePosition = new Vector3();\n\t\tvar spriteRotation = new Quaternion();\n\t\tvar spriteScale = new Vector3();\n\n\t\tfunction init() {\n\n\t\t\tvar vertices = new Float32Array( [\n\t\t\t\t- 0.5, - 0.5,  0, 0,\n\t\t\t\t  0.5, - 0.5,  1, 0,\n\t\t\t\t  0.5,   0.5,  1, 1,\n\t\t\t\t- 0.5,   0.5,  0, 1\n\t\t\t] );\n\n\t\t\tvar faces = new Uint16Array( [\n\t\t\t\t0, 1, 2,\n\t\t\t\t0, 2, 3\n\t\t\t] );\n\n\t\t\tvertexBuffer  = gl.createBuffer();\n\t\t\telementBuffer = gl.createBuffer();\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\n\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\n\t\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\n\n\t\t\tprogram = createProgram();\n\n\t\t\tattributes = {\n\t\t\t\tposition:\t\t\tgl.getAttribLocation ( program, 'position' ),\n\t\t\t\tuv:\t\t\t\t\tgl.getAttribLocation ( program, 'uv' )\n\t\t\t};\n\n\t\t\tuniforms = {\n\t\t\t\tuvOffset:\t\t\tgl.getUniformLocation( program, 'uvOffset' ),\n\t\t\t\tuvScale:\t\t\tgl.getUniformLocation( program, 'uvScale' ),\n\n\t\t\t\trotation:\t\t\tgl.getUniformLocation( program, 'rotation' ),\n\t\t\t\tscale:\t\t\t\tgl.getUniformLocation( program, 'scale' ),\n\n\t\t\t\tcolor:\t\t\t\tgl.getUniformLocation( program, 'color' ),\n\t\t\t\tmap:\t\t\t\tgl.getUniformLocation( program, 'map' ),\n\t\t\t\topacity:\t\t\tgl.getUniformLocation( program, 'opacity' ),\n\n\t\t\t\tmodelViewMatrix: \tgl.getUniformLocation( program, 'modelViewMatrix' ),\n\t\t\t\tprojectionMatrix:\tgl.getUniformLocation( program, 'projectionMatrix' ),\n\n\t\t\t\tfogType:\t\t\tgl.getUniformLocation( program, 'fogType' ),\n\t\t\t\tfogDensity:\t\t\tgl.getUniformLocation( program, 'fogDensity' ),\n\t\t\t\tfogNear:\t\t\tgl.getUniformLocation( program, 'fogNear' ),\n\t\t\t\tfogFar:\t\t\t\tgl.getUniformLocation( program, 'fogFar' ),\n\t\t\t\tfogColor:\t\t\tgl.getUniformLocation( program, 'fogColor' ),\n\n\t\t\t\talphaTest:\t\t\tgl.getUniformLocation( program, 'alphaTest' )\n\t\t\t};\n\n\t\t\tvar canvas = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\n\t\t\tcanvas.width = 8;\n\t\t\tcanvas.height = 8;\n\n\t\t\tvar context = canvas.getContext( '2d' );\n\t\t\tcontext.fillStyle = 'white';\n\t\t\tcontext.fillRect( 0, 0, 8, 8 );\n\n\t\t\ttexture = new Texture( canvas );\n\t\t\ttexture.needsUpdate = true;\n\n\t\t}\n\n\t\tthis.render = function ( scene, camera ) {\n\n\t\t\tif ( sprites.length === 0 ) return;\n\n\t\t\t// setup gl\n\n\t\t\tif ( program === undefined ) {\n\n\t\t\t\tinit();\n\n\t\t\t}\n\n\t\t\tgl.useProgram( program );\n\n\t\t\tstate.initAttributes();\n\t\t\tstate.enableAttribute( attributes.position );\n\t\t\tstate.enableAttribute( attributes.uv );\n\t\t\tstate.disableUnusedAttributes();\n\n\t\t\tstate.disable( gl.CULL_FACE );\n\t\t\tstate.enable( gl.BLEND );\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\n\t\t\tgl.vertexAttribPointer( attributes.position, 2, gl.FLOAT, false, 2 * 8, 0 );\n\t\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\n\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\n\n\t\t\tgl.uniformMatrix4fv( uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\n\n\t\t\tstate.activeTexture( gl.TEXTURE0 );\n\t\t\tgl.uniform1i( uniforms.map, 0 );\n\n\t\t\tvar oldFogType = 0;\n\t\t\tvar sceneFogType = 0;\n\t\t\tvar fog = scene.fog;\n\n\t\t\tif ( fog ) {\n\n\t\t\t\tgl.uniform3f( uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b );\n\n\t\t\t\tif ( fog.isFog ) {\n\n\t\t\t\t\tgl.uniform1f( uniforms.fogNear, fog.near );\n\t\t\t\t\tgl.uniform1f( uniforms.fogFar, fog.far );\n\n\t\t\t\t\tgl.uniform1i( uniforms.fogType, 1 );\n\t\t\t\t\toldFogType = 1;\n\t\t\t\t\tsceneFogType = 1;\n\n\t\t\t\t} else if ( fog.isFogExp2 ) {\n\n\t\t\t\t\tgl.uniform1f( uniforms.fogDensity, fog.density );\n\n\t\t\t\t\tgl.uniform1i( uniforms.fogType, 2 );\n\t\t\t\t\toldFogType = 2;\n\t\t\t\t\tsceneFogType = 2;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tgl.uniform1i( uniforms.fogType, 0 );\n\t\t\t\toldFogType = 0;\n\t\t\t\tsceneFogType = 0;\n\n\t\t\t}\n\n\n\t\t\t// update positions and sort\n\n\t\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\n\n\t\t\t\tvar sprite = sprites[ i ];\n\n\t\t\t\tsprite.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, sprite.matrixWorld );\n\t\t\t\tsprite.z = - sprite.modelViewMatrix.elements[ 14 ];\n\n\t\t\t}\n\n\t\t\tsprites.sort( painterSortStable );\n\n\t\t\t// render all sprites\n\n\t\t\tvar scale = [];\n\n\t\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\n\n\t\t\t\tvar sprite = sprites[ i ];\n\t\t\t\tvar material = sprite.material;\n\n\t\t\t\tif ( material.visible === false ) continue;\n\n\t\t\t\tgl.uniform1f( uniforms.alphaTest, material.alphaTest );\n\t\t\t\tgl.uniformMatrix4fv( uniforms.modelViewMatrix, false, sprite.modelViewMatrix.elements );\n\n\t\t\t\tsprite.matrixWorld.decompose( spritePosition, spriteRotation, spriteScale );\n\n\t\t\t\tscale[ 0 ] = spriteScale.x;\n\t\t\t\tscale[ 1 ] = spriteScale.y;\n\n\t\t\t\tvar fogType = 0;\n\n\t\t\t\tif ( scene.fog && material.fog ) {\n\n\t\t\t\t\tfogType = sceneFogType;\n\n\t\t\t\t}\n\n\t\t\t\tif ( oldFogType !== fogType ) {\n\n\t\t\t\t\tgl.uniform1i( uniforms.fogType, fogType );\n\t\t\t\t\toldFogType = fogType;\n\n\t\t\t\t}\n\n\t\t\t\tif ( material.map !== null ) {\n\n\t\t\t\t\tgl.uniform2f( uniforms.uvOffset, material.map.offset.x, material.map.offset.y );\n\t\t\t\t\tgl.uniform2f( uniforms.uvScale, material.map.repeat.x, material.map.repeat.y );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgl.uniform2f( uniforms.uvOffset, 0, 0 );\n\t\t\t\t\tgl.uniform2f( uniforms.uvScale, 1, 1 );\n\n\t\t\t\t}\n\n\t\t\t\tgl.uniform1f( uniforms.opacity, material.opacity );\n\t\t\t\tgl.uniform3f( uniforms.color, material.color.r, material.color.g, material.color.b );\n\n\t\t\t\tgl.uniform1f( uniforms.rotation, material.rotation );\n\t\t\t\tgl.uniform2fv( uniforms.scale, scale );\n\n\t\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst );\n\t\t\t\tstate.setDepthTest( material.depthTest );\n\t\t\t\tstate.setDepthWrite( material.depthWrite );\n\n\t\t\t\tif ( material.map ) {\n\n\t\t\t\t\trenderer.setTexture2D( material.map, 0 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\trenderer.setTexture2D( texture, 0 );\n\n\t\t\t\t}\n\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\n\n\t\t\t}\n\n\t\t\t// restore gl\n\n\t\t\tstate.enable( gl.CULL_FACE );\n\n\t\t\trenderer.resetGLState();\n\n\t\t};\n\n\t\tfunction createProgram() {\n\n\t\t\tvar program = gl.createProgram();\n\n\t\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\n\t\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\n\n\t\t\tgl.shaderSource( vertexShader, [\n\n\t\t\t\t'precision ' + renderer.getPrecision() + ' float;',\n\n\t\t\t\t'uniform mat4 modelViewMatrix;',\n\t\t\t\t'uniform mat4 projectionMatrix;',\n\t\t\t\t'uniform float rotation;',\n\t\t\t\t'uniform vec2 scale;',\n\t\t\t\t'uniform vec2 uvOffset;',\n\t\t\t\t'uniform vec2 uvScale;',\n\n\t\t\t\t'attribute vec2 position;',\n\t\t\t\t'attribute vec2 uv;',\n\n\t\t\t\t'varying vec2 vUV;',\n\n\t\t\t\t'void main() {',\n\n\t\t\t\t\t'vUV = uvOffset + uv * uvScale;',\n\n\t\t\t\t\t'vec2 alignedPosition = position * scale;',\n\n\t\t\t\t\t'vec2 rotatedPosition;',\n\t\t\t\t\t'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\n\t\t\t\t\t'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\n\n\t\t\t\t\t'vec4 finalPosition;',\n\n\t\t\t\t\t'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\n\t\t\t\t\t'finalPosition.xy += rotatedPosition;',\n\t\t\t\t\t'finalPosition = projectionMatrix * finalPosition;',\n\n\t\t\t\t\t'gl_Position = finalPosition;',\n\n\t\t\t\t'}'\n\n\t\t\t].join( '\\n' ) );\n\n\t\t\tgl.shaderSource( fragmentShader, [\n\n\t\t\t\t'precision ' + renderer.getPrecision() + ' float;',\n\n\t\t\t\t'uniform vec3 color;',\n\t\t\t\t'uniform sampler2D map;',\n\t\t\t\t'uniform float opacity;',\n\n\t\t\t\t'uniform int fogType;',\n\t\t\t\t'uniform vec3 fogColor;',\n\t\t\t\t'uniform float fogDensity;',\n\t\t\t\t'uniform float fogNear;',\n\t\t\t\t'uniform float fogFar;',\n\t\t\t\t'uniform float alphaTest;',\n\n\t\t\t\t'varying vec2 vUV;',\n\n\t\t\t\t'void main() {',\n\n\t\t\t\t\t'vec4 texture = texture2D( map, vUV );',\n\n\t\t\t\t\t'if ( texture.a < alphaTest ) discard;',\n\n\t\t\t\t\t'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\n\n\t\t\t\t\t'if ( fogType > 0 ) {',\n\n\t\t\t\t\t\t'float depth = gl_FragCoord.z / gl_FragCoord.w;',\n\t\t\t\t\t\t'float fogFactor = 0.0;',\n\n\t\t\t\t\t\t'if ( fogType == 1 ) {',\n\n\t\t\t\t\t\t\t'fogFactor = smoothstep( fogNear, fogFar, depth );',\n\n\t\t\t\t\t\t'} else {',\n\n\t\t\t\t\t\t\t'const float LOG2 = 1.442695;',\n\t\t\t\t\t\t\t'fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\n\t\t\t\t\t\t\t'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\n\n\t\t\t\t\t\t'}',\n\n\t\t\t\t\t\t'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\n\n\t\t\t\t\t'}',\n\n\t\t\t\t'}'\n\n\t\t\t].join( '\\n' ) );\n\n\t\t\tgl.compileShader( vertexShader );\n\t\t\tgl.compileShader( fragmentShader );\n\n\t\t\tgl.attachShader( program, vertexShader );\n\t\t\tgl.attachShader( program, fragmentShader );\n\n\t\t\tgl.linkProgram( program );\n\n\t\t\treturn program;\n\n\t\t}\n\n\t\tfunction painterSortStable( a, b ) {\n\n\t\t\tif ( a.renderOrder !== b.renderOrder ) {\n\n\t\t\t\treturn a.renderOrder - b.renderOrder;\n\n\t\t\t} else if ( a.z !== b.z ) {\n\n\t\t\t\treturn b.z - a.z;\n\n\t\t\t} else {\n\n\t\t\t\treturn b.id - a.id;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tvar materialId = 0;\n\n\tfunction Material() {\n\n\t\tObject.defineProperty( this, 'id', { value: materialId ++ } );\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Material';\n\n\t\tthis.fog = true;\n\t\tthis.lights = true;\n\n\t\tthis.blending = NormalBlending;\n\t\tthis.side = FrontSide;\n\t\tthis.shading = SmoothShading; // THREE.FlatShading, THREE.SmoothShading\n\t\tthis.vertexColors = NoColors; // THREE.NoColors, THREE.VertexColors, THREE.FaceColors\n\n\t\tthis.opacity = 1;\n\t\tthis.transparent = false;\n\n\t\tthis.blendSrc = SrcAlphaFactor;\n\t\tthis.blendDst = OneMinusSrcAlphaFactor;\n\t\tthis.blendEquation = AddEquation;\n\t\tthis.blendSrcAlpha = null;\n\t\tthis.blendDstAlpha = null;\n\t\tthis.blendEquationAlpha = null;\n\n\t\tthis.depthFunc = LessEqualDepth;\n\t\tthis.depthTest = true;\n\t\tthis.depthWrite = true;\n\n\t\tthis.clippingPlanes = null;\n\t\tthis.clipIntersection = false;\n\t\tthis.clipShadows = false;\n\n\t\tthis.colorWrite = true;\n\n\t\tthis.precision = null; // override the renderer's default precision for this material\n\n\t\tthis.polygonOffset = false;\n\t\tthis.polygonOffsetFactor = 0;\n\t\tthis.polygonOffsetUnits = 0;\n\n\t\tthis.alphaTest = 0;\n\t\tthis.premultipliedAlpha = false;\n\n\t\tthis.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\n\n\t\tthis.visible = true;\n\n\t\tthis._needsUpdate = true;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tMaterial.prototype = {\n\n\t\tconstructor: Material,\n\n\t\tisMaterial: true,\n\n\t\tget needsUpdate() {\n\n\t\t\treturn this._needsUpdate;\n\n\t\t},\n\n\t\tset needsUpdate( value ) {\n\n\t\t\tif ( value === true ) this.update();\n\t\t\tthis._needsUpdate = value;\n\t\t\tthis.version ++;\n\n\t\t},\n\n\t\tsetValues: function ( values ) {\n\n\t\t\tif ( values === undefined ) return;\n\n\t\t\tfor ( var key in values ) {\n\n\t\t\t\tvar newValue = values[ key ];\n\n\t\t\t\tif ( newValue === undefined ) {\n\n\t\t\t\t\tconsole.warn( \"THREE.Material: '\" + key + \"' parameter is undefined.\" );\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tvar currentValue = this[ key ];\n\n\t\t\t\tif ( currentValue === undefined ) {\n\n\t\t\t\t\tconsole.warn( \"THREE.\" + this.type + \": '\" + key + \"' is not a property of this material.\" );\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tif ( currentValue && currentValue.isColor ) {\n\n\t\t\t\t\tcurrentValue.set( newValue );\n\n\t\t\t\t} else if ( ( currentValue && currentValue.isVector3 ) && ( newValue && newValue.isVector3 ) ) {\n\n\t\t\t\t\tcurrentValue.copy( newValue );\n\n\t\t\t\t} else if ( key === 'overdraw' ) {\n\n\t\t\t\t\t// ensure overdraw is backwards-compatible with legacy boolean type\n\t\t\t\t\tthis[ key ] = Number( newValue );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis[ key ] = newValue;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\ttoJSON: function ( meta ) {\n\n\t\t\tvar isRoot = meta === undefined;\n\n\t\t\tif ( isRoot ) {\n\n\t\t\t\tmeta = {\n\t\t\t\t\ttextures: {},\n\t\t\t\t\timages: {}\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tvar data = {\n\t\t\t\tmetadata: {\n\t\t\t\t\tversion: 4.4,\n\t\t\t\t\ttype: 'Material',\n\t\t\t\t\tgenerator: 'Material.toJSON'\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// standard Material serialization\n\t\t\tdata.uuid = this.uuid;\n\t\t\tdata.type = this.type;\n\n\t\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\t\tif ( this.color && this.color.isColor ) data.color = this.color.getHex();\n\n\t\t\tif ( this.roughness !== undefined ) data.roughness = this.roughness;\n\t\t\tif ( this.metalness !== undefined ) data.metalness = this.metalness;\n\n\t\t\tif ( this.emissive && this.emissive.isColor ) data.emissive = this.emissive.getHex();\n\t\t\tif ( this.specular && this.specular.isColor ) data.specular = this.specular.getHex();\n\t\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\n\t\t\tif ( this.clearCoat !== undefined ) data.clearCoat = this.clearCoat;\n\t\t\tif ( this.clearCoatRoughness !== undefined ) data.clearCoatRoughness = this.clearCoatRoughness;\n\n\t\t\tif ( this.map && this.map.isTexture ) data.map = this.map.toJSON( meta ).uuid;\n\t\t\tif ( this.alphaMap && this.alphaMap.isTexture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\n\t\t\tif ( this.lightMap && this.lightMap.isTexture ) data.lightMap = this.lightMap.toJSON( meta ).uuid;\n\t\t\tif ( this.bumpMap && this.bumpMap.isTexture ) {\n\n\t\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\n\t\t\t\tdata.bumpScale = this.bumpScale;\n\n\t\t\t}\n\t\t\tif ( this.normalMap && this.normalMap.isTexture ) {\n\n\t\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\n\t\t\t\tdata.normalScale = this.normalScale.toArray();\n\n\t\t\t}\n\t\t\tif ( this.displacementMap && this.displacementMap.isTexture ) {\n\n\t\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\n\t\t\t\tdata.displacementScale = this.displacementScale;\n\t\t\t\tdata.displacementBias = this.displacementBias;\n\n\t\t\t}\n\t\t\tif ( this.roughnessMap && this.roughnessMap.isTexture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\n\t\t\tif ( this.metalnessMap && this.metalnessMap.isTexture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\n\n\t\t\tif ( this.emissiveMap && this.emissiveMap.isTexture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\n\t\t\tif ( this.specularMap && this.specularMap.isTexture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\n\n\t\t\tif ( this.envMap && this.envMap.isTexture ) {\n\n\t\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\n\t\t\t\tdata.reflectivity = this.reflectivity; // Scale behind envMap\n\n\t\t\t}\n\n\t\t\tif ( this.gradientMap && this.gradientMap.isTexture ) {\n\n\t\t\t\tdata.gradientMap = this.gradientMap.toJSON( meta ).uuid;\n\n\t\t\t}\n\n\t\t\tif ( this.size !== undefined ) data.size = this.size;\n\t\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\n\n\t\t\tif ( this.blending !== NormalBlending ) data.blending = this.blending;\n\t\t\tif ( this.shading !== SmoothShading ) data.shading = this.shading;\n\t\t\tif ( this.side !== FrontSide ) data.side = this.side;\n\t\t\tif ( this.vertexColors !== NoColors ) data.vertexColors = this.vertexColors;\n\n\t\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\n\t\t\tif ( this.transparent === true ) data.transparent = this.transparent;\n\n\t\t\tdata.depthFunc = this.depthFunc;\n\t\t\tdata.depthTest = this.depthTest;\n\t\t\tdata.depthWrite = this.depthWrite;\n\n\t\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\n\t\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = this.premultipliedAlpha;\n\t\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\n\t\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\n\t\t\tif ( this.wireframeLinecap !== 'round' ) data.wireframeLinecap = this.wireframeLinecap;\n\t\t\tif ( this.wireframeLinejoin !== 'round' ) data.wireframeLinejoin = this.wireframeLinejoin;\n\n\t\t\tdata.skinning = this.skinning;\n\t\t\tdata.morphTargets = this.morphTargets;\n\n\t\t\t// TODO: Copied from Object3D.toJSON\n\n\t\t\tfunction extractFromCache( cache ) {\n\n\t\t\t\tvar values = [];\n\n\t\t\t\tfor ( var key in cache ) {\n\n\t\t\t\t\tvar data = cache[ key ];\n\t\t\t\t\tdelete data.metadata;\n\t\t\t\t\tvalues.push( data );\n\n\t\t\t\t}\n\n\t\t\t\treturn values;\n\n\t\t\t}\n\n\t\t\tif ( isRoot ) {\n\n\t\t\t\tvar textures = extractFromCache( meta.textures );\n\t\t\t\tvar images = extractFromCache( meta.images );\n\n\t\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\t\tif ( images.length > 0 ) data.images = images;\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( source ) {\n\n\t\t\tthis.name = source.name;\n\n\t\t\tthis.fog = source.fog;\n\t\t\tthis.lights = source.lights;\n\n\t\t\tthis.blending = source.blending;\n\t\t\tthis.side = source.side;\n\t\t\tthis.shading = source.shading;\n\t\t\tthis.vertexColors = source.vertexColors;\n\n\t\t\tthis.opacity = source.opacity;\n\t\t\tthis.transparent = source.transparent;\n\n\t\t\tthis.blendSrc = source.blendSrc;\n\t\t\tthis.blendDst = source.blendDst;\n\t\t\tthis.blendEquation = source.blendEquation;\n\t\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\n\t\t\tthis.blendDstAlpha = source.blendDstAlpha;\n\t\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\n\n\t\t\tthis.depthFunc = source.depthFunc;\n\t\t\tthis.depthTest = source.depthTest;\n\t\t\tthis.depthWrite = source.depthWrite;\n\n\t\t\tthis.colorWrite = source.colorWrite;\n\n\t\t\tthis.precision = source.precision;\n\n\t\t\tthis.polygonOffset = source.polygonOffset;\n\t\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\n\t\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\n\n\t\t\tthis.alphaTest = source.alphaTest;\n\n\t\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\n\n\t\t\tthis.overdraw = source.overdraw;\n\n\t\t\tthis.visible = source.visible;\n\t\t\tthis.clipShadows = source.clipShadows;\n\t\t\tthis.clipIntersection = source.clipIntersection;\n\n\t\t\tvar srcPlanes = source.clippingPlanes,\n\t\t\t\tdstPlanes = null;\n\n\t\t\tif ( srcPlanes !== null ) {\n\n\t\t\t\tvar n = srcPlanes.length;\n\t\t\t\tdstPlanes = new Array( n );\n\n\t\t\t\tfor ( var i = 0; i !== n; ++ i )\n\t\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\n\n\t\t\t}\n\n\t\t\tthis.clippingPlanes = dstPlanes;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tupdate: function () {\n\n\t\t\tthis.dispatchEvent( { type: 'update' } );\n\n\t\t},\n\n\t\tdispose: function () {\n\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\t}\n\n\t};\n\n\tObject.assign( Material.prototype, EventDispatcher.prototype );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  defines: { \"label\" : \"value\" },\n\t *  uniforms: { \"parameter1\": { value: 1.0 }, \"parameter2\": { value2: 2 } },\n\t *\n\t *  fragmentShader: <string>,\n\t *  vertexShader: <string>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>,\n\t *\n\t *  lights: <bool>,\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>,\n\t *  morphNormals: <bool>\n\t * }\n\t */\n\n\tfunction ShaderMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'ShaderMaterial';\n\n\t\tthis.defines = {};\n\t\tthis.uniforms = {};\n\n\t\tthis.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\n\t\tthis.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\n\n\t\tthis.linewidth = 1;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false; // set to use scene fog\n\t\tthis.lights = false; // set to use scene lights\n\t\tthis.clipping = false; // set to use user-defined clipping planes\n\n\t\tthis.skinning = false; // set to use skinning attribute streams\n\t\tthis.morphTargets = false; // set to use morph targets\n\t\tthis.morphNormals = false; // set to use morph normals\n\n\t\tthis.extensions = {\n\t\t\tderivatives: false, // set to use derivatives\n\t\t\tfragDepth: false, // set to use fragment depth values\n\t\t\tdrawBuffers: false, // set to use draw buffers\n\t\t\tshaderTextureLOD: false // set to use shader texture LOD\n\t\t};\n\n\t\t// When rendered geometry doesn't include these attributes but the material does,\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\n\t\tthis.defaultAttributeValues = {\n\t\t\t'color': [ 1, 1, 1 ],\n\t\t\t'uv': [ 0, 0 ],\n\t\t\t'uv2': [ 0, 0 ]\n\t\t};\n\n\t\tthis.index0AttributeName = undefined;\n\n\t\tif ( parameters !== undefined ) {\n\n\t\t\tif ( parameters.attributes !== undefined ) {\n\n\t\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t\tthis.setValues( parameters );\n\n\t\t}\n\n\t}\n\n\tShaderMaterial.prototype = Object.create( Material.prototype );\n\tShaderMaterial.prototype.constructor = ShaderMaterial;\n\n\tShaderMaterial.prototype.isShaderMaterial = true;\n\n\tShaderMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.fragmentShader = source.fragmentShader;\n\t\tthis.vertexShader = source.vertexShader;\n\n\t\tthis.uniforms = UniformsUtils.clone( source.uniforms );\n\n\t\tthis.defines = source.defines;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.lights = source.lights;\n\t\tthis.clipping = source.clipping;\n\n\t\tthis.skinning = source.skinning;\n\n\t\tthis.morphTargets = source.morphTargets;\n\t\tthis.morphNormals = source.morphNormals;\n\n\t\tthis.extensions = source.extensions;\n\n\t\treturn this;\n\n\t};\n\n\tShaderMaterial.prototype.toJSON = function ( meta ) {\n\n\t\tvar data = Material.prototype.toJSON.call( this, meta );\n\n\t\tdata.uniforms = this.uniforms;\n\t\tdata.vertexShader = this.vertexShader;\n\t\tdata.fragmentShader = this.fragmentShader;\n\n\t\treturn data;\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author bhouston / https://clara.io\n\t * @author WestLangley / http://github.com/WestLangley\n\t *\n\t * parameters = {\n\t *\n\t *  opacity: <float>,\n\t *\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  alphaMap: new THREE.Texture( <Image> ),\n\t *\n\t *  displacementMap: new THREE.Texture( <Image> ),\n\t *  displacementScale: <float>,\n\t *  displacementBias: <float>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>\n\t * }\n\t */\n\n\tfunction MeshDepthMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'MeshDepthMaterial';\n\n\t\tthis.depthPacking = BasicDepthPacking;\n\n\t\tthis.skinning = false;\n\t\tthis.morphTargets = false;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false;\n\t\tthis.lights = false;\n\n\t\t// far clipping plane in both RGBA and Basic encoding\n\t\tthis.clearColor = new Color( 1.0, 1.0, 1.0 );\n\t\tthis.clearAlpha = 1.0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tMeshDepthMaterial.prototype = Object.create( Material.prototype );\n\tMeshDepthMaterial.prototype.constructor = MeshDepthMaterial;\n\n\tMeshDepthMaterial.prototype.isMeshDepthMaterial = true;\n\n\tMeshDepthMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.depthPacking = source.depthPacking;\n\n\t\tthis.skinning = source.skinning;\n\t\tthis.morphTargets = source.morphTargets;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.clearColor = source.clearColor;\n\t\tthis.clearAlpha = source.clearAlpha;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author bhouston / http://clara.io\n\t * @author WestLangley / http://github.com/WestLangley\n\t */\n\n\tfunction Box3( min, max ) {\n\n\t\tthis.min = ( min !== undefined ) ? min : new Vector3( + Infinity, + Infinity, + Infinity );\n\t\tthis.max = ( max !== undefined ) ? max : new Vector3( - Infinity, - Infinity, - Infinity );\n\n\t}\n\n\tBox3.prototype = {\n\n\t\tconstructor: Box3,\n\n\t\tisBox3: true,\n\n\t\tset: function ( min, max ) {\n\n\t\t\tthis.min.copy( min );\n\t\t\tthis.max.copy( max );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromArray: function ( array ) {\n\n\t\t\tvar minX = + Infinity;\n\t\t\tvar minY = + Infinity;\n\t\t\tvar minZ = + Infinity;\n\n\t\t\tvar maxX = - Infinity;\n\t\t\tvar maxY = - Infinity;\n\t\t\tvar maxZ = - Infinity;\n\n\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\t\tvar x = array[ i ];\n\t\t\t\tvar y = array[ i + 1 ];\n\t\t\t\tvar z = array[ i + 2 ];\n\n\t\t\t\tif ( x < minX ) minX = x;\n\t\t\t\tif ( y < minY ) minY = y;\n\t\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\t\tif ( x > maxX ) maxX = x;\n\t\t\t\tif ( y > maxY ) maxY = y;\n\t\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t\t}\n\n\t\t\tthis.min.set( minX, minY, minZ );\n\t\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\t},\n\n\t\tsetFromBufferAttribute: function ( attribute ) {\n\n\t\t\tvar minX = + Infinity;\n\t\t\tvar minY = + Infinity;\n\t\t\tvar minZ = + Infinity;\n\n\t\t\tvar maxX = - Infinity;\n\t\t\tvar maxY = - Infinity;\n\t\t\tvar maxZ = - Infinity;\n\n\t\t\tfor ( var i = 0, l = attribute.count; i < l; i ++ ) {\n\n\t\t\t\tvar x = attribute.getX( i );\n\t\t\t\tvar y = attribute.getY( i );\n\t\t\t\tvar z = attribute.getZ( i );\n\n\t\t\t\tif ( x < minX ) minX = x;\n\t\t\t\tif ( y < minY ) minY = y;\n\t\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\t\tif ( x > maxX ) maxX = x;\n\t\t\t\tif ( y > maxY ) maxY = y;\n\t\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t\t}\n\n\t\t\tthis.min.set( minX, minY, minZ );\n\t\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\t},\n\n\t\tsetFromPoints: function ( points ) {\n\n\t\t\tthis.makeEmpty();\n\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromCenterAndSize: function () {\n\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function setFromCenterAndSize( center, size ) {\n\n\t\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\n\n\t\t\t\tthis.min.copy( center ).sub( halfSize );\n\t\t\t\tthis.max.copy( center ).add( halfSize );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tsetFromObject: function () {\n\n\t\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\n\t\t\t// accounting for both the object's, and children's, world transforms\n\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function setFromObject( object ) {\n\n\t\t\t\tvar scope = this;\n\n\t\t\t\tobject.updateMatrixWorld( true );\n\n\t\t\t\tthis.makeEmpty();\n\n\t\t\t\tobject.traverse( function ( node ) {\n\n\t\t\t\t\tvar i, l;\n\n\t\t\t\t\tvar geometry = node.geometry;\n\n\t\t\t\t\tif ( geometry !== undefined ) {\n\n\t\t\t\t\t\tif ( geometry.isGeometry ) {\n\n\t\t\t\t\t\t\tvar vertices = geometry.vertices;\n\n\t\t\t\t\t\t\tfor ( i = 0, l = vertices.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t\t\tv1.copy( vertices[ i ] );\n\t\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\n\n\t\t\t\t\t\t\t\tscope.expandByPoint( v1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else if ( geometry.isBufferGeometry ) {\n\n\t\t\t\t\t\t\tvar attribute = geometry.attributes.position;\n\n\t\t\t\t\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\t\t\t\t\tfor ( i = 0, l = attribute.count; i < l; i ++ ) {\n\n\t\t\t\t\t\t\t\t\tv1.fromBufferAttribute( attribute, i ).applyMatrix4( node.matrixWorld );\n\n\t\t\t\t\t\t\t\t\tscope.expandByPoint( v1 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( box ) {\n\n\t\t\tthis.min.copy( box.min );\n\t\t\tthis.max.copy( box.max );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tmakeEmpty: function () {\n\n\t\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\n\t\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tisEmpty: function () {\n\n\t\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\n\n\t\t},\n\n\t\tgetCenter: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\treturn this.isEmpty() ? result.set( 0, 0, 0 ) : result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t\t},\n\n\t\tgetSize: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\treturn this.isEmpty() ? result.set( 0, 0, 0 ) : result.subVectors( this.max, this.min );\n\n\t\t},\n\n\t\texpandByPoint: function ( point ) {\n\n\t\t\tthis.min.min( point );\n\t\t\tthis.max.max( point );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\texpandByVector: function ( vector ) {\n\n\t\t\tthis.min.sub( vector );\n\t\t\tthis.max.add( vector );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\texpandByScalar: function ( scalar ) {\n\n\t\t\tthis.min.addScalar( - scalar );\n\t\t\tthis.max.addScalar( scalar );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcontainsPoint: function ( point ) {\n\n\t\t\treturn point.x < this.min.x || point.x > this.max.x ||\n\t\t\t\tpoint.y < this.min.y || point.y > this.max.y ||\n\t\t\t\tpoint.z < this.min.z || point.z > this.max.z ? false : true;\n\n\t\t},\n\n\t\tcontainsBox: function ( box ) {\n\n\t\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y &&\n\t\t\t\tthis.min.z <= box.min.z && box.max.z <= this.max.z;\n\n\t\t},\n\n\t\tgetParameter: function ( point, optionalTarget ) {\n\n\t\t\t// This can potentially have a divide by zero if the box\n\t\t\t// has a size dimension of 0.\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\treturn result.set(\n\t\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\n\t\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\n\t\t\t);\n\n\t\t},\n\n\t\tintersectsBox: function ( box ) {\n\n\t\t\t// using 6 splitting planes to rule out intersections.\n\t\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ||\n\t\t\t\tbox.max.z < this.min.z || box.min.z > this.max.z ? false : true;\n\n\t\t},\n\n\t\tintersectsSphere: ( function () {\n\n\t\t\tvar closestPoint;\n\n\t\t\treturn function intersectsSphere( sphere ) {\n\n\t\t\t\tif ( closestPoint === undefined ) closestPoint = new Vector3();\n\n\t\t\t\t// Find the point on the AABB closest to the sphere center.\n\t\t\t\tthis.clampPoint( sphere.center, closestPoint );\n\n\t\t\t\t// If that point is inside the sphere, the AABB and sphere intersect.\n\t\t\t\treturn closestPoint.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t\t\t};\n\n\t\t} )(),\n\n\t\tintersectsPlane: function ( plane ) {\n\n\t\t\t// We compute the minimum and maximum dot product values. If those values\n\t\t\t// are on the same side (back or front) of the plane, then there is no intersection.\n\n\t\t\tvar min, max;\n\n\t\t\tif ( plane.normal.x > 0 ) {\n\n\t\t\t\tmin = plane.normal.x * this.min.x;\n\t\t\t\tmax = plane.normal.x * this.max.x;\n\n\t\t\t} else {\n\n\t\t\t\tmin = plane.normal.x * this.max.x;\n\t\t\t\tmax = plane.normal.x * this.min.x;\n\n\t\t\t}\n\n\t\t\tif ( plane.normal.y > 0 ) {\n\n\t\t\t\tmin += plane.normal.y * this.min.y;\n\t\t\t\tmax += plane.normal.y * this.max.y;\n\n\t\t\t} else {\n\n\t\t\t\tmin += plane.normal.y * this.max.y;\n\t\t\t\tmax += plane.normal.y * this.min.y;\n\n\t\t\t}\n\n\t\t\tif ( plane.normal.z > 0 ) {\n\n\t\t\t\tmin += plane.normal.z * this.min.z;\n\t\t\t\tmax += plane.normal.z * this.max.z;\n\n\t\t\t} else {\n\n\t\t\t\tmin += plane.normal.z * this.max.z;\n\t\t\t\tmax += plane.normal.z * this.min.z;\n\n\t\t\t}\n\n\t\t\treturn ( min <= plane.constant && max >= plane.constant );\n\n\t\t},\n\n\t\tclampPoint: function ( point, optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\treturn result.copy( point ).clamp( this.min, this.max );\n\n\t\t},\n\n\t\tdistanceToPoint: function () {\n\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function distanceToPoint( point ) {\n\n\t\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\n\t\t\t\treturn clampedPoint.sub( point ).length();\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tgetBoundingSphere: function () {\n\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function getBoundingSphere( optionalTarget ) {\n\n\t\t\t\tvar result = optionalTarget || new Sphere();\n\n\t\t\t\tthis.getCenter( result.center );\n\n\t\t\t\tresult.radius = this.getSize( v1 ).length() * 0.5;\n\n\t\t\t\treturn result;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tintersect: function ( box ) {\n\n\t\t\tthis.min.max( box.min );\n\t\t\tthis.max.min( box.max );\n\n\t\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\n\t\t\tif( this.isEmpty() ) this.makeEmpty();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tunion: function ( box ) {\n\n\t\t\tthis.min.min( box.min );\n\t\t\tthis.max.max( box.max );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tapplyMatrix4: function () {\n\n\t\t\tvar points = [\n\t\t\t\tnew Vector3(),\n\t\t\t\tnew Vector3(),\n\t\t\t\tnew Vector3(),\n\t\t\t\tnew Vector3(),\n\t\t\t\tnew Vector3(),\n\t\t\t\tnew Vector3(),\n\t\t\t\tnew Vector3(),\n\t\t\t\tnew Vector3()\n\t\t\t];\n\n\t\t\treturn function applyMatrix4( matrix ) {\n\n\t\t\t\t// transform of empty box is an empty box.\n\t\t\t\tif( this.isEmpty() ) return this;\n\n\t\t\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\n\t\t\t\tpoints[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\n\t\t\t\tpoints[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\n\t\t\t\tpoints[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\n\t\t\t\tpoints[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\n\t\t\t\tpoints[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\n\t\t\t\tpoints[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\n\t\t\t\tpoints[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\n\t\t\t\tpoints[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix );\t// 111\n\n\t\t\t\tthis.setFromPoints( points );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttranslate: function ( offset ) {\n\n\t\t\tthis.min.add( offset );\n\t\t\tthis.max.add( offset );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tequals: function ( box ) {\n\n\t\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author bhouston / http://clara.io\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Sphere( center, radius ) {\n\n\t\tthis.center = ( center !== undefined ) ? center : new Vector3();\n\t\tthis.radius = ( radius !== undefined ) ? radius : 0;\n\n\t}\n\n\tSphere.prototype = {\n\n\t\tconstructor: Sphere,\n\n\t\tset: function ( center, radius ) {\n\n\t\t\tthis.center.copy( center );\n\t\t\tthis.radius = radius;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromPoints: function () {\n\n\t\t\tvar box = new Box3();\n\n\t\t\treturn function setFromPoints( points, optionalCenter ) {\n\n\t\t\t\tvar center = this.center;\n\n\t\t\t\tif ( optionalCenter !== undefined ) {\n\n\t\t\t\t\tcenter.copy( optionalCenter );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbox.setFromPoints( points ).getCenter( center );\n\n\t\t\t\t}\n\n\t\t\t\tvar maxRadiusSq = 0;\n\n\t\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tthis.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( sphere ) {\n\n\t\t\tthis.center.copy( sphere.center );\n\t\t\tthis.radius = sphere.radius;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tempty: function () {\n\n\t\t\treturn ( this.radius <= 0 );\n\n\t\t},\n\n\t\tcontainsPoint: function ( point ) {\n\n\t\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\n\n\t\t},\n\n\t\tdistanceToPoint: function ( point ) {\n\n\t\t\treturn ( point.distanceTo( this.center ) - this.radius );\n\n\t\t},\n\n\t\tintersectsSphere: function ( sphere ) {\n\n\t\t\tvar radiusSum = this.radius + sphere.radius;\n\n\t\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\n\n\t\t},\n\n\t\tintersectsBox: function ( box ) {\n\n\t\t\treturn box.intersectsSphere( this );\n\n\t\t},\n\n\t\tintersectsPlane: function ( plane ) {\n\n\t\t\t// We use the following equation to compute the signed distance from\n\t\t\t// the center of the sphere to the plane.\n\t\t\t//\n\t\t\t// distance = q * n - d\n\t\t\t//\n\t\t\t// If this distance is greater than the radius of the sphere,\n\t\t\t// then there is no intersection.\n\n\t\t\treturn Math.abs( this.center.dot( plane.normal ) - plane.constant ) <= this.radius;\n\n\t\t},\n\n\t\tclampPoint: function ( point, optionalTarget ) {\n\n\t\t\tvar deltaLengthSq = this.center.distanceToSquared( point );\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\tresult.copy( point );\n\n\t\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\t\tresult.sub( this.center ).normalize();\n\t\t\t\tresult.multiplyScalar( this.radius ).add( this.center );\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t},\n\n\t\tgetBoundingBox: function ( optionalTarget ) {\n\n\t\t\tvar box = optionalTarget || new Box3();\n\n\t\t\tbox.set( this.center, this.center );\n\t\t\tbox.expandByScalar( this.radius );\n\n\t\t\treturn box;\n\n\t\t},\n\n\t\tapplyMatrix4: function ( matrix ) {\n\n\t\t\tthis.center.applyMatrix4( matrix );\n\t\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttranslate: function ( offset ) {\n\n\t\t\tthis.center.add( offset );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tequals: function ( sphere ) {\n\n\t\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author bhouston / http://clara.io\n\t * @author tschw\n\t */\n\n\tfunction Matrix3() {\n\n\t\tthis.elements = new Float32Array( [\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t] );\n\n\t\tif ( arguments.length > 0 ) {\n\n\t\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\n\n\t\t}\n\n\t}\n\n\tMatrix3.prototype = {\n\n\t\tconstructor: Matrix3,\n\n\t\tisMatrix3: true,\n\n\t\tset: function ( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\n\t\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\n\t\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tidentity: function () {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, 0,\n\t\t\t\t0, 1, 0,\n\t\t\t\t0, 0, 1\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().fromArray( this.elements );\n\n\t\t},\n\n\t\tcopy: function ( m ) {\n\n\t\t\tvar me = m.elements;\n\n\t\t\tthis.set(\n\n\t\t\t\tme[ 0 ], me[ 3 ], me[ 6 ],\n\t\t\t\tme[ 1 ], me[ 4 ], me[ 7 ],\n\t\t\t\tme[ 2 ], me[ 5 ], me[ 8 ]\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromMatrix4: function( m ) {\n\n\t\t\tvar me = m.elements;\n\n\t\t\tthis.set(\n\n\t\t\t\tme[ 0 ], me[ 4 ], me[  8 ],\n\t\t\t\tme[ 1 ], me[ 5 ], me[  9 ],\n\t\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\n\n\t\t\t);\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tapplyToBufferAttribute: function () {\n\n\t\t\tvar v1;\n\n\t\t\treturn function applyToBufferAttribute( attribute ) {\n\n\t\t\t\tif ( v1 === undefined ) v1 = new Vector3();\n\n\t\t\t\tfor ( var i = 0, l = attribute.count; i < l; i ++ ) {\n\n\t\t\t\t\tv1.x = attribute.getX( i );\n\t\t\t\t\tv1.y = attribute.getY( i );\n\t\t\t\t\tv1.z = attribute.getZ( i );\n\n\t\t\t\t\tv1.applyMatrix3( this );\n\n\t\t\t\t\tattribute.setXYZ( i, v1.x, v1.y, v1.z );\n\n\t\t\t\t}\n\n\t\t\t\treturn attribute;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tmultiplyScalar: function ( s ) {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\n\t\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\n\t\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdeterminant: function () {\n\n\t\t\tvar te = this.elements;\n\n\t\t\tvar a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\n\t\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\n\t\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\n\n\t\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\n\n\t\t},\n\n\t\tgetInverse: function ( matrix, throwOnDegenerate ) {\n\n\t\t\tif ( matrix && matrix.isMatrix4 ) {\n\n\t\t\t\tconsole.error( \"THREE.Matrix3.getInverse no longer takes a Matrix4 argument.\" );\n\n\t\t\t}\n\n\t\t\tvar me = matrix.elements,\n\t\t\t\tte = this.elements,\n\n\t\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ],\n\t\t\t\tn12 = me[ 3 ], n22 = me[ 4 ], n32 = me[ 5 ],\n\t\t\t\tn13 = me[ 6 ], n23 = me[ 7 ], n33 = me[ 8 ],\n\n\t\t\t\tt11 = n33 * n22 - n32 * n23,\n\t\t\t\tt12 = n32 * n13 - n33 * n12,\n\t\t\t\tt13 = n23 * n12 - n22 * n13,\n\n\t\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\n\n\t\t\tif ( det === 0 ) {\n\n\t\t\t\tvar msg = \"THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0\";\n\n\t\t\t\tif ( throwOnDegenerate === true ) {\n\n\t\t\t\t\tthrow new Error( msg );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( msg );\n\n\t\t\t\t}\n\n\t\t\t\treturn this.identity();\n\t\t\t}\n\n\t\t\tvar detInv = 1 / det;\n\n\t\t\tte[ 0 ] = t11 * detInv;\n\t\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\n\t\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\n\n\t\t\tte[ 3 ] = t12 * detInv;\n\t\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\n\t\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\n\n\t\t\tte[ 6 ] = t13 * detInv;\n\t\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\n\t\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttranspose: function () {\n\n\t\t\tvar tmp, m = this.elements;\n\n\t\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\n\t\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\n\t\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetNormalMatrix: function ( matrix4 ) {\n\n\t\t\treturn this.setFromMatrix4( matrix4 ).getInverse( this ).transpose();\n\n\t\t},\n\n\t\ttransposeIntoArray: function ( r ) {\n\n\t\t\tvar m = this.elements;\n\n\t\t\tr[ 0 ] = m[ 0 ];\n\t\t\tr[ 1 ] = m[ 3 ];\n\t\t\tr[ 2 ] = m[ 6 ];\n\t\t\tr[ 3 ] = m[ 1 ];\n\t\t\tr[ 4 ] = m[ 4 ];\n\t\t\tr[ 5 ] = m[ 7 ];\n\t\t\tr[ 6 ] = m[ 2 ];\n\t\t\tr[ 7 ] = m[ 5 ];\n\t\t\tr[ 8 ] = m[ 8 ];\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tfromArray: function ( array, offset ) {\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tfor( var i = 0; i < 9; i ++ ) {\n\n\t\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoArray: function ( array, offset ) {\n\n\t\t\tif ( array === undefined ) array = [];\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tvar te = this.elements;\n\n\t\t\tarray[ offset ] = te[ 0 ];\n\t\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\t\tarray[ offset + 2 ] = te[ 2 ];\n\n\t\t\tarray[ offset + 3 ] = te[ 3 ];\n\t\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\t\tarray[ offset + 5 ] = te[ 5 ];\n\n\t\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\t\tarray[ offset + 7 ] = te[ 7 ];\n\t\t\tarray[ offset + 8 ]  = te[ 8 ];\n\n\t\t\treturn array;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author bhouston / http://clara.io\n\t */\n\n\tfunction Plane( normal, constant ) {\n\n\t\tthis.normal = ( normal !== undefined ) ? normal : new Vector3( 1, 0, 0 );\n\t\tthis.constant = ( constant !== undefined ) ? constant : 0;\n\n\t}\n\n\tPlane.prototype = {\n\n\t\tconstructor: Plane,\n\n\t\tset: function ( normal, constant ) {\n\n\t\t\tthis.normal.copy( normal );\n\t\t\tthis.constant = constant;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetComponents: function ( x, y, z, w ) {\n\n\t\t\tthis.normal.set( x, y, z );\n\t\t\tthis.constant = w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromNormalAndCoplanarPoint: function ( normal, point ) {\n\n\t\t\tthis.normal.copy( normal );\n\t\t\tthis.constant = - point.dot( this.normal );\t// must be this.normal, not normal, as this.normal is normalized\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromCoplanarPoints: function () {\n\n\t\t\tvar v1 = new Vector3();\n\t\t\tvar v2 = new Vector3();\n\n\t\t\treturn function setFromCoplanarPoints( a, b, c ) {\n\n\t\t\t\tvar normal = v1.subVectors( c, b ).cross( v2.subVectors( a, b ) ).normalize();\n\n\t\t\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\n\n\t\t\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( plane ) {\n\n\t\t\tthis.normal.copy( plane.normal );\n\t\t\tthis.constant = plane.constant;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tnormalize: function () {\n\n\t\t\t// Note: will lead to a divide by zero if the plane is invalid.\n\n\t\t\tvar inverseNormalLength = 1.0 / this.normal.length();\n\t\t\tthis.normal.multiplyScalar( inverseNormalLength );\n\t\t\tthis.constant *= inverseNormalLength;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tnegate: function () {\n\n\t\t\tthis.constant *= - 1;\n\t\t\tthis.normal.negate();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdistanceToPoint: function ( point ) {\n\n\t\t\treturn this.normal.dot( point ) + this.constant;\n\n\t\t},\n\n\t\tdistanceToSphere: function ( sphere ) {\n\n\t\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\n\n\t\t},\n\n\t\tprojectPoint: function ( point, optionalTarget ) {\n\n\t\t\treturn this.orthoPoint( point, optionalTarget ).sub( point ).negate();\n\n\t\t},\n\n\t\torthoPoint: function ( point, optionalTarget ) {\n\n\t\t\tvar perpendicularMagnitude = this.distanceToPoint( point );\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\treturn result.copy( this.normal ).multiplyScalar( perpendicularMagnitude );\n\n\t\t},\n\n\t\tintersectLine: function () {\n\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function intersectLine( line, optionalTarget ) {\n\n\t\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\t\tvar direction = line.delta( v1 );\n\n\t\t\t\tvar denominator = this.normal.dot( direction );\n\n\t\t\t\tif ( denominator === 0 ) {\n\n\t\t\t\t\t// line is coplanar, return origin\n\t\t\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\n\n\t\t\t\t\t\treturn result.copy( line.start );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Unsure if this is the correct method to handle this case.\n\t\t\t\t\treturn undefined;\n\n\t\t\t\t}\n\n\t\t\t\tvar t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\n\n\t\t\t\tif ( t < 0 || t > 1 ) {\n\n\t\t\t\t\treturn undefined;\n\n\t\t\t\t}\n\n\t\t\t\treturn result.copy( direction ).multiplyScalar( t ).add( line.start );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tintersectsLine: function ( line ) {\n\n\t\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\n\n\t\t\tvar startSign = this.distanceToPoint( line.start );\n\t\t\tvar endSign = this.distanceToPoint( line.end );\n\n\t\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\n\n\t\t},\n\n\t\tintersectsBox: function ( box ) {\n\n\t\t\treturn box.intersectsPlane( this );\n\n\t\t},\n\n\t\tintersectsSphere: function ( sphere ) {\n\n\t\t\treturn sphere.intersectsPlane( this );\n\n\t\t},\n\n\t\tcoplanarPoint: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\treturn result.copy( this.normal ).multiplyScalar( - this.constant );\n\n\t\t},\n\n\t\tapplyMatrix4: function () {\n\n\t\t\tvar v1 = new Vector3();\n\t\t\tvar m1 = new Matrix3();\n\n\t\t\treturn function applyMatrix4( matrix, optionalNormalMatrix ) {\n\n\t\t\t\tvar referencePoint = this.coplanarPoint( v1 ).applyMatrix4( matrix );\n\n\t\t\t\t// transform normal based on theory here:\n\t\t\t\t// http://www.songho.ca/opengl/gl_normaltransform.html\n\t\t\t\tvar normalMatrix = optionalNormalMatrix || m1.getNormalMatrix( matrix );\n\t\t\t\tvar normal = this.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t\t// recalculate constant (like in setFromNormalAndCoplanarPoint)\n\t\t\t\tthis.constant = - referencePoint.dot( normal );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttranslate: function ( offset ) {\n\n\t\t\tthis.constant = this.constant - offset.dot( this.normal );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tequals: function ( plane ) {\n\n\t\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author bhouston / http://clara.io\n\t */\n\n\tfunction Frustum( p0, p1, p2, p3, p4, p5 ) {\n\n\t\tthis.planes = [\n\n\t\t\t( p0 !== undefined ) ? p0 : new Plane(),\n\t\t\t( p1 !== undefined ) ? p1 : new Plane(),\n\t\t\t( p2 !== undefined ) ? p2 : new Plane(),\n\t\t\t( p3 !== undefined ) ? p3 : new Plane(),\n\t\t\t( p4 !== undefined ) ? p4 : new Plane(),\n\t\t\t( p5 !== undefined ) ? p5 : new Plane()\n\n\t\t];\n\n\t}\n\n\tFrustum.prototype = {\n\n\t\tconstructor: Frustum,\n\n\t\tset: function ( p0, p1, p2, p3, p4, p5 ) {\n\n\t\t\tvar planes = this.planes;\n\n\t\t\tplanes[ 0 ].copy( p0 );\n\t\t\tplanes[ 1 ].copy( p1 );\n\t\t\tplanes[ 2 ].copy( p2 );\n\t\t\tplanes[ 3 ].copy( p3 );\n\t\t\tplanes[ 4 ].copy( p4 );\n\t\t\tplanes[ 5 ].copy( p5 );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( frustum ) {\n\n\t\t\tvar planes = this.planes;\n\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromMatrix: function ( m ) {\n\n\t\t\tvar planes = this.planes;\n\t\t\tvar me = m.elements;\n\t\t\tvar me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\n\t\t\tvar me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\n\t\t\tvar me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\n\t\t\tvar me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\n\n\t\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\n\t\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\n\t\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\n\t\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\n\t\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\n\t\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tintersectsObject: function () {\n\n\t\t\tvar sphere = new Sphere();\n\n\t\t\treturn function intersectsObject( object ) {\n\n\t\t\t\tvar geometry = object.geometry;\n\n\t\t\t\tif ( geometry.boundingSphere === null )\n\t\t\t\t\tgeometry.computeBoundingSphere();\n\n\t\t\t\tsphere.copy( geometry.boundingSphere )\n\t\t\t\t\t.applyMatrix4( object.matrixWorld );\n\n\t\t\t\treturn this.intersectsSphere( sphere );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tintersectsSprite: function () {\n\n\t\t\tvar sphere = new Sphere();\n\n\t\t\treturn function intersectsSprite( sprite ) {\n\n\t\t\t\tsphere.center.set( 0, 0, 0 );\n\t\t\t\tsphere.radius = 0.7071067811865476;\n\t\t\t\tsphere.applyMatrix4( sprite.matrixWorld );\n\n\t\t\t\treturn this.intersectsSphere( sphere );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tintersectsSphere: function ( sphere ) {\n\n\t\t\tvar planes = this.planes;\n\t\t\tvar center = sphere.center;\n\t\t\tvar negRadius = - sphere.radius;\n\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\tvar distance = planes[ i ].distanceToPoint( center );\n\n\t\t\t\tif ( distance < negRadius ) {\n\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t},\n\n\t\tintersectsBox: function () {\n\n\t\t\tvar p1 = new Vector3(),\n\t\t\t\tp2 = new Vector3();\n\n\t\t\treturn function intersectsBox( box ) {\n\n\t\t\t\tvar planes = this.planes;\n\n\t\t\t\tfor ( var i = 0; i < 6 ; i ++ ) {\n\n\t\t\t\t\tvar plane = planes[ i ];\n\n\t\t\t\t\tp1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\n\t\t\t\t\tp2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\n\t\t\t\t\tp1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\n\t\t\t\t\tp2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\n\t\t\t\t\tp1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\n\t\t\t\t\tp2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\n\n\t\t\t\t\tvar d1 = plane.distanceToPoint( p1 );\n\t\t\t\t\tvar d2 = plane.distanceToPoint( p2 );\n\n\t\t\t\t\t// if both outside plane, no intersection\n\n\t\t\t\t\tif ( d1 < 0 && d2 < 0 ) {\n\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\n\t\t\t};\n\n\t\t}(),\n\n\n\t\tcontainsPoint: function ( point ) {\n\n\t\t\tvar planes = this.planes;\n\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\n\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLShadowMap( _renderer, _lights, _objects, capabilities ) {\n\n\t\tvar _gl = _renderer.context,\n\t\t_state = _renderer.state,\n\t\t_frustum = new Frustum(),\n\t\t_projScreenMatrix = new Matrix4(),\n\n\t\t_lightShadows = _lights.shadows,\n\n\t\t_shadowMapSize = new Vector2(),\n\t\t_maxShadowMapSize = new Vector2( capabilities.maxTextureSize, capabilities.maxTextureSize ),\n\n\t\t_lookTarget = new Vector3(),\n\t\t_lightPositionWorld = new Vector3(),\n\n\t\t_renderList = [],\n\n\t\t_MorphingFlag = 1,\n\t\t_SkinningFlag = 2,\n\n\t\t_NumberOfMaterialVariants = ( _MorphingFlag | _SkinningFlag ) + 1,\n\n\t\t_depthMaterials = new Array( _NumberOfMaterialVariants ),\n\t\t_distanceMaterials = new Array( _NumberOfMaterialVariants ),\n\n\t\t_materialCache = {};\n\n\t\tvar cubeDirections = [\n\t\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\n\t\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\n\t\t];\n\n\t\tvar cubeUps = [\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\n\t\t];\n\n\t\tvar cube2DViewPorts = [\n\t\t\tnew Vector4(), new Vector4(), new Vector4(),\n\t\t\tnew Vector4(), new Vector4(), new Vector4()\n\t\t];\n\n\t\t// init\n\n\t\tvar depthMaterialTemplate = new MeshDepthMaterial();\n\t\tdepthMaterialTemplate.depthPacking = RGBADepthPacking;\n\t\tdepthMaterialTemplate.clipping = true;\n\n\t\tvar distanceShader = ShaderLib[ \"distanceRGBA\" ];\n\t\tvar distanceUniforms = UniformsUtils.clone( distanceShader.uniforms );\n\n\t\tfor ( var i = 0; i !== _NumberOfMaterialVariants; ++ i ) {\n\n\t\t\tvar useMorphing = ( i & _MorphingFlag ) !== 0;\n\t\t\tvar useSkinning = ( i & _SkinningFlag ) !== 0;\n\n\t\t\tvar depthMaterial = depthMaterialTemplate.clone();\n\t\t\tdepthMaterial.morphTargets = useMorphing;\n\t\t\tdepthMaterial.skinning = useSkinning;\n\n\t\t\t_depthMaterials[ i ] = depthMaterial;\n\n\t\t\tvar distanceMaterial = new ShaderMaterial( {\n\t\t\t\tdefines: {\n\t\t\t\t\t'USE_SHADOWMAP': ''\n\t\t\t\t},\n\t\t\t\tuniforms: distanceUniforms,\n\t\t\t\tvertexShader: distanceShader.vertexShader,\n\t\t\t\tfragmentShader: distanceShader.fragmentShader,\n\t\t\t\tmorphTargets: useMorphing,\n\t\t\t\tskinning: useSkinning,\n\t\t\t\tclipping: true\n\t\t\t} );\n\n\t\t\t_distanceMaterials[ i ] = distanceMaterial;\n\n\t\t}\n\n\t\t//\n\n\t\tvar scope = this;\n\n\t\tthis.enabled = false;\n\n\t\tthis.autoUpdate = true;\n\t\tthis.needsUpdate = false;\n\n\t\tthis.type = PCFShadowMap;\n\n\t\tthis.renderReverseSided = true;\n\t\tthis.renderSingleSided = true;\n\n\t\tthis.render = function ( scene, camera ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\t\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\n\n\t\t\tif ( _lightShadows.length === 0 ) return;\n\n\t\t\t// Set GL state for depth map.\n\t\t\t_state.buffers.color.setClear( 1, 1, 1, 1 );\n\t\t\t_state.disable( _gl.BLEND );\n\t\t\t_state.setDepthTest( true );\n\t\t\t_state.setScissorTest( false );\n\n\t\t\t// render depth map\n\n\t\t\tvar faceCount, isPointLight;\n\n\t\t\tfor ( var i = 0, il = _lightShadows.length; i < il; i ++ ) {\n\n\t\t\t\tvar light = _lightShadows[ i ];\n\t\t\t\tvar shadow = light.shadow;\n\n\t\t\t\tif ( shadow === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap:', light, 'has no shadow.' );\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tvar shadowCamera = shadow.camera;\n\n\t\t\t\t_shadowMapSize.copy( shadow.mapSize );\n\t\t\t\t_shadowMapSize.min( _maxShadowMapSize );\n\n\t\t\t\tif ( light && light.isPointLight ) {\n\n\t\t\t\t\tfaceCount = 6;\n\t\t\t\t\tisPointLight = true;\n\n\t\t\t\t\tvar vpWidth = _shadowMapSize.x;\n\t\t\t\t\tvar vpHeight = _shadowMapSize.y;\n\n\t\t\t\t\t// These viewports map a cube-map onto a 2D texture with the\n\t\t\t\t\t// following orientation:\n\t\t\t\t\t//\n\t\t\t\t\t//  xzXZ\n\t\t\t\t\t//   y Y\n\t\t\t\t\t//\n\t\t\t\t\t// X - Positive x direction\n\t\t\t\t\t// x - Negative x direction\n\t\t\t\t\t// Y - Positive y direction\n\t\t\t\t\t// y - Negative y direction\n\t\t\t\t\t// Z - Positive z direction\n\t\t\t\t\t// z - Negative z direction\n\n\t\t\t\t\t// positive X\n\t\t\t\t\tcube2DViewPorts[ 0 ].set( vpWidth * 2, vpHeight, vpWidth, vpHeight );\n\t\t\t\t\t// negative X\n\t\t\t\t\tcube2DViewPorts[ 1 ].set( 0, vpHeight, vpWidth, vpHeight );\n\t\t\t\t\t// positive Z\n\t\t\t\t\tcube2DViewPorts[ 2 ].set( vpWidth * 3, vpHeight, vpWidth, vpHeight );\n\t\t\t\t\t// negative Z\n\t\t\t\t\tcube2DViewPorts[ 3 ].set( vpWidth, vpHeight, vpWidth, vpHeight );\n\t\t\t\t\t// positive Y\n\t\t\t\t\tcube2DViewPorts[ 4 ].set( vpWidth * 3, 0, vpWidth, vpHeight );\n\t\t\t\t\t// negative Y\n\t\t\t\t\tcube2DViewPorts[ 5 ].set( vpWidth, 0, vpWidth, vpHeight );\n\n\t\t\t\t\t_shadowMapSize.x *= 4.0;\n\t\t\t\t\t_shadowMapSize.y *= 2.0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfaceCount = 1;\n\t\t\t\t\tisPointLight = false;\n\n\t\t\t\t}\n\n\t\t\t\tif ( shadow.map === null ) {\n\n\t\t\t\t\tvar pars = { minFilter: NearestFilter, magFilter: NearestFilter, format: RGBAFormat, name: ( light.name + \".shadowMap\" ) };\n\n\t\t\t\t\tshadow.map = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\n\n\t\t\t\t\tshadowCamera.updateProjectionMatrix();\n\n\t\t\t\t}\n\n\t\t\t\tif ( shadow.isSpotLightShadow || shadow.isDirectionalLightShadow ) {\n\n\t\t\t\t\tshadow.update( light );\n\n\t\t\t\t}\n\n\t\t\t\t// TODO (abelnation / sam-g-steel): is this needed?\n\t\t\t\tif (shadow && shadow.isRectAreaLightShadow ) {\n\n\t\t\t\t\tshadow.update( light );\n\n\t\t\t\t}\n\n\t\t\t\tvar shadowMap = shadow.map;\n\t\t\t\tvar shadowMatrix = shadow.matrix;\n\n\t\t\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tshadowCamera.position.copy( _lightPositionWorld );\n\n\t\t\t\t_renderer.setRenderTarget( shadowMap );\n\t\t\t\t_renderer.clear();\n\n\t\t\t\t// render shadow map for each cube face (if omni-directional) or\n\t\t\t\t// run a single pass if not\n\n\t\t\t\tfor ( var face = 0; face < faceCount; face ++ ) {\n\n\t\t\t\t\tif ( isPointLight ) {\n\n\t\t\t\t\t\t_lookTarget.copy( shadowCamera.position );\n\t\t\t\t\t\t_lookTarget.add( cubeDirections[ face ] );\n\t\t\t\t\t\tshadowCamera.up.copy( cubeUps[ face ] );\n\t\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\n\n\t\t\t\t\t\tvar vpDimensions = cube2DViewPorts[ face ];\n\t\t\t\t\t\t_state.viewport( vpDimensions );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_lookTarget.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tshadowCamera.updateMatrixWorld();\n\t\t\t\t\tshadowCamera.matrixWorldInverse.getInverse( shadowCamera.matrixWorld );\n\n\t\t\t\t\t// compute shadow matrix\n\n\t\t\t\t\tshadowMatrix.set(\n\t\t\t\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t\t\t\t);\n\n\t\t\t\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\n\t\t\t\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\n\n\t\t\t\t\t// update camera matrices and frustum\n\n\t\t\t\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\n\t\t\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\n\n\t\t\t\t\t// set object matrices & frustum culling\n\n\t\t\t\t\t_renderList.length = 0;\n\n\t\t\t\t\tprojectObject( scene, camera, shadowCamera );\n\n\t\t\t\t\t// render shadow map\n\t\t\t\t\t// render regular objects\n\n\t\t\t\t\tfor ( var j = 0, jl = _renderList.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar object = _renderList[ j ];\n\t\t\t\t\t\tvar geometry = _objects.update( object );\n\t\t\t\t\t\tvar material = object.material;\n\n\t\t\t\t\t\tif ( material && material.isMultiMaterial ) {\n\n\t\t\t\t\t\t\tvar groups = geometry.groups;\n\t\t\t\t\t\t\tvar materials = material.materials;\n\n\t\t\t\t\t\t\tfor ( var k = 0, kl = groups.length; k < kl; k ++ ) {\n\n\t\t\t\t\t\t\t\tvar group = groups[ k ];\n\t\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\n\n\t\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\n\n\t\t\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, groupMaterial, isPointLight, _lightPositionWorld );\n\t\t\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, group );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, material, isPointLight, _lightPositionWorld );\n\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, null );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Restore GL state.\n\t\t\tvar clearColor = _renderer.getClearColor(),\n\t\t\tclearAlpha = _renderer.getClearAlpha();\n\t\t\t_renderer.setClearColor( clearColor, clearAlpha );\n\n\t\t\tscope.needsUpdate = false;\n\n\t\t};\n\n\t\tfunction getDepthMaterial( object, material, isPointLight, lightPositionWorld ) {\n\n\t\t\tvar geometry = object.geometry;\n\n\t\t\tvar result = null;\n\n\t\t\tvar materialVariants = _depthMaterials;\n\t\t\tvar customMaterial = object.customDepthMaterial;\n\n\t\t\tif ( isPointLight ) {\n\n\t\t\t\tmaterialVariants = _distanceMaterials;\n\t\t\t\tcustomMaterial = object.customDistanceMaterial;\n\n\t\t\t}\n\n\t\t\tif ( ! customMaterial ) {\n\n\t\t\t\tvar useMorphing = false;\n\n\t\t\t\tif ( material.morphTargets ) {\n\n\t\t\t\t\tif ( geometry && geometry.isBufferGeometry ) {\n\n\t\t\t\t\t\tuseMorphing = geometry.morphAttributes && geometry.morphAttributes.position && geometry.morphAttributes.position.length > 0;\n\n\t\t\t\t\t} else if ( geometry && geometry.isGeometry ) {\n\n\t\t\t\t\t\tuseMorphing = geometry.morphTargets && geometry.morphTargets.length > 0;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvar useSkinning = object.isSkinnedMesh && material.skinning;\n\n\t\t\t\tvar variantIndex = 0;\n\n\t\t\t\tif ( useMorphing ) variantIndex |= _MorphingFlag;\n\t\t\t\tif ( useSkinning ) variantIndex |= _SkinningFlag;\n\n\t\t\t\tresult = materialVariants[ variantIndex ];\n\n\t\t\t} else {\n\n\t\t\t\tresult = customMaterial;\n\n\t\t\t}\n\n\t\t\tif ( _renderer.localClippingEnabled &&\n\t\t\t\t material.clipShadows === true &&\n\t\t\t\t\tmaterial.clippingPlanes.length !== 0 ) {\n\n\t\t\t\t// in this case we need a unique material instance reflecting the\n\t\t\t\t// appropriate state\n\n\t\t\t\tvar keyA = result.uuid, keyB = material.uuid;\n\n\t\t\t\tvar materialsForVariant = _materialCache[ keyA ];\n\n\t\t\t\tif ( materialsForVariant === undefined ) {\n\n\t\t\t\t\tmaterialsForVariant = {};\n\t\t\t\t\t_materialCache[ keyA ] = materialsForVariant;\n\n\t\t\t\t}\n\n\t\t\t\tvar cachedMaterial = materialsForVariant[ keyB ];\n\n\t\t\t\tif ( cachedMaterial === undefined ) {\n\n\t\t\t\t\tcachedMaterial = result.clone();\n\t\t\t\t\tmaterialsForVariant[ keyB ] = cachedMaterial;\n\n\t\t\t\t}\n\n\t\t\t\tresult = cachedMaterial;\n\n\t\t\t}\n\n\t\t\tresult.visible = material.visible;\n\t\t\tresult.wireframe = material.wireframe;\n\n\t\t\tvar side = material.side;\n\n\t\t\tif ( scope.renderSingleSided && side == DoubleSide ) {\n\n\t\t\t\tside = FrontSide;\n\n\t\t\t}\n\n\t\t\tif ( scope.renderReverseSided ) {\n\n\t\t\t\tif ( side === FrontSide ) side = BackSide;\n\t\t\t\telse if ( side === BackSide ) side = FrontSide;\n\n\t\t\t}\n\n\t\t\tresult.side = side;\n\n\t\t\tresult.clipShadows = material.clipShadows;\n\t\t\tresult.clippingPlanes = material.clippingPlanes;\n\n\t\t\tresult.wireframeLinewidth = material.wireframeLinewidth;\n\t\t\tresult.linewidth = material.linewidth;\n\n\t\t\tif ( isPointLight && result.uniforms.lightPos !== undefined ) {\n\n\t\t\t\tresult.uniforms.lightPos.value.copy( lightPositionWorld );\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t}\n\n\t\tfunction projectObject( object, camera, shadowCamera ) {\n\n\t\t\tif ( object.visible === false ) return;\n\n\t\t\tvar visible = ( object.layers.mask & camera.layers.mask ) !== 0;\n\n\t\t\tif ( visible && ( object.isMesh || object.isLine || object.isPoints ) ) {\n\n\t\t\t\tif ( object.castShadow && ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) ) {\n\n\t\t\t\t\tvar material = object.material;\n\n\t\t\t\t\tif ( material.visible === true ) {\n\n\t\t\t\t\t\tobject.modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\n\t\t\t\t\t\t_renderList.push( object );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar children = object.children;\n\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tprojectObject( children[ i ], camera, shadowCamera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @author bhouston / http://clara.io\n\t */\n\n\tfunction Ray( origin, direction ) {\n\n\t\tthis.origin = ( origin !== undefined ) ? origin : new Vector3();\n\t\tthis.direction = ( direction !== undefined ) ? direction : new Vector3();\n\n\t}\n\n\tRay.prototype = {\n\n\t\tconstructor: Ray,\n\n\t\tset: function ( origin, direction ) {\n\n\t\t\tthis.origin.copy( origin );\n\t\t\tthis.direction.copy( direction );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( ray ) {\n\n\t\t\tthis.origin.copy( ray.origin );\n\t\t\tthis.direction.copy( ray.direction );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tat: function ( t, optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\treturn result.copy( this.direction ).multiplyScalar( t ).add( this.origin );\n\n\t\t},\n\n\t\tlookAt: function ( v ) {\n\n\t\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\trecast: function () {\n\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function recast( t ) {\n\n\t\t\t\tthis.origin.copy( this.at( t, v1 ) );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tclosestPointToPoint: function ( point, optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\tresult.subVectors( point, this.origin );\n\t\t\tvar directionDistance = result.dot( this.direction );\n\n\t\t\tif ( directionDistance < 0 ) {\n\n\t\t\t\treturn result.copy( this.origin );\n\n\t\t\t}\n\n\t\t\treturn result.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t\t},\n\n\t\tdistanceToPoint: function ( point ) {\n\n\t\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\n\n\t\t},\n\n\t\tdistanceSqToPoint: function () {\n\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function distanceSqToPoint( point ) {\n\n\t\t\t\tvar directionDistance = v1.subVectors( point, this.origin ).dot( this.direction );\n\n\t\t\t\t// point behind the ray\n\n\t\t\t\tif ( directionDistance < 0 ) {\n\n\t\t\t\t\treturn this.origin.distanceToSquared( point );\n\n\t\t\t\t}\n\n\t\t\t\tv1.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t\t\t\treturn v1.distanceToSquared( point );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tdistanceSqToSegment: function () {\n\n\t\t\tvar segCenter = new Vector3();\n\t\t\tvar segDir = new Vector3();\n\t\t\tvar diff = new Vector3();\n\n\t\t\treturn function distanceSqToSegment( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\n\n\t\t\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteDistRaySegment.h\n\t\t\t\t// It returns the min distance between the ray and the segment\n\t\t\t\t// defined by v0 and v1\n\t\t\t\t// It can also set two optional targets :\n\t\t\t\t// - The closest point on the ray\n\t\t\t\t// - The closest point on the segment\n\n\t\t\t\tsegCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\n\t\t\t\tsegDir.copy( v1 ).sub( v0 ).normalize();\n\t\t\t\tdiff.copy( this.origin ).sub( segCenter );\n\n\t\t\t\tvar segExtent = v0.distanceTo( v1 ) * 0.5;\n\t\t\t\tvar a01 = - this.direction.dot( segDir );\n\t\t\t\tvar b0 = diff.dot( this.direction );\n\t\t\t\tvar b1 = - diff.dot( segDir );\n\t\t\t\tvar c = diff.lengthSq();\n\t\t\t\tvar det = Math.abs( 1 - a01 * a01 );\n\t\t\t\tvar s0, s1, sqrDist, extDet;\n\n\t\t\t\tif ( det > 0 ) {\n\n\t\t\t\t\t// The ray and segment are not parallel.\n\n\t\t\t\t\ts0 = a01 * b1 - b0;\n\t\t\t\t\ts1 = a01 * b0 - b1;\n\t\t\t\t\textDet = segExtent * det;\n\n\t\t\t\t\tif ( s0 >= 0 ) {\n\n\t\t\t\t\t\tif ( s1 >= - extDet ) {\n\n\t\t\t\t\t\t\tif ( s1 <= extDet ) {\n\n\t\t\t\t\t\t\t\t// region 0\n\t\t\t\t\t\t\t\t// Minimum at interior points of ray and segment.\n\n\t\t\t\t\t\t\t\tvar invDet = 1 / det;\n\t\t\t\t\t\t\t\ts0 *= invDet;\n\t\t\t\t\t\t\t\ts1 *= invDet;\n\t\t\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// region 1\n\n\t\t\t\t\t\t\t\ts1 = segExtent;\n\t\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// region 5\n\n\t\t\t\t\t\t\ts1 = - segExtent;\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( s1 <= - extDet ) {\n\n\t\t\t\t\t\t\t// region 4\n\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\n\t\t\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t\t} else if ( s1 <= extDet ) {\n\n\t\t\t\t\t\t\t// region 3\n\n\t\t\t\t\t\t\ts0 = 0;\n\t\t\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// region 2\n\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\n\t\t\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Ray and segment are parallel.\n\n\t\t\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t\tif ( optionalPointOnRay ) {\n\n\t\t\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\n\n\t\t\t\t}\n\n\t\t\t\tif ( optionalPointOnSegment ) {\n\n\t\t\t\t\toptionalPointOnSegment.copy( segDir ).multiplyScalar( s1 ).add( segCenter );\n\n\t\t\t\t}\n\n\t\t\t\treturn sqrDist;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tintersectSphere: function () {\n\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function intersectSphere( sphere, optionalTarget ) {\n\n\t\t\t\tv1.subVectors( sphere.center, this.origin );\n\t\t\t\tvar tca = v1.dot( this.direction );\n\t\t\t\tvar d2 = v1.dot( v1 ) - tca * tca;\n\t\t\t\tvar radius2 = sphere.radius * sphere.radius;\n\n\t\t\t\tif ( d2 > radius2 ) return null;\n\n\t\t\t\tvar thc = Math.sqrt( radius2 - d2 );\n\n\t\t\t\t// t0 = first intersect point - entrance on front of sphere\n\t\t\t\tvar t0 = tca - thc;\n\n\t\t\t\t// t1 = second intersect point - exit point on back of sphere\n\t\t\t\tvar t1 = tca + thc;\n\n\t\t\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\n\t\t\t\tif ( t0 < 0 && t1 < 0 ) return null;\n\n\t\t\t\t// test to see if t0 is behind the ray:\n\t\t\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\n\t\t\t\t// in order to always return an intersect point that is in front of the ray.\n\t\t\t\tif ( t0 < 0 ) return this.at( t1, optionalTarget );\n\n\t\t\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\n\t\t\t\treturn this.at( t0, optionalTarget );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tintersectsSphere: function ( sphere ) {\n\n\t\t\treturn this.distanceToPoint( sphere.center ) <= sphere.radius;\n\n\t\t},\n\n\t\tdistanceToPlane: function ( plane ) {\n\n\t\t\tvar denominator = plane.normal.dot( this.direction );\n\n\t\t\tif ( denominator === 0 ) {\n\n\t\t\t\t// line is coplanar, return origin\n\t\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\n\n\t\t\t\t\treturn 0;\n\n\t\t\t\t}\n\n\t\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tvar t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\n\n\t\t\t// Return if the ray never intersects the plane\n\n\t\t\treturn t >= 0 ? t :  null;\n\n\t\t},\n\n\t\tintersectPlane: function ( plane, optionalTarget ) {\n\n\t\t\tvar t = this.distanceToPlane( plane );\n\n\t\t\tif ( t === null ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\treturn this.at( t, optionalTarget );\n\n\t\t},\n\n\n\n\t\tintersectsPlane: function ( plane ) {\n\n\t\t\t// check if the ray lies on the plane first\n\n\t\t\tvar distToPoint = plane.distanceToPoint( this.origin );\n\n\t\t\tif ( distToPoint === 0 ) {\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\tvar denominator = plane.normal.dot( this.direction );\n\n\t\t\tif ( denominator * distToPoint < 0 ) {\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\t// ray origin is behind the plane (and is pointing behind it)\n\n\t\t\treturn false;\n\n\t\t},\n\n\t\tintersectBox: function ( box, optionalTarget ) {\n\n\t\t\tvar tmin, tmax, tymin, tymax, tzmin, tzmax;\n\n\t\t\tvar invdirx = 1 / this.direction.x,\n\t\t\t\tinvdiry = 1 / this.direction.y,\n\t\t\t\tinvdirz = 1 / this.direction.z;\n\n\t\t\tvar origin = this.origin;\n\n\t\t\tif ( invdirx >= 0 ) {\n\n\t\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\n\t\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\n\n\t\t\t} else {\n\n\t\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\n\t\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\n\n\t\t\t}\n\n\t\t\tif ( invdiry >= 0 ) {\n\n\t\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\n\t\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\n\n\t\t\t} else {\n\n\t\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\n\t\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\n\n\t\t\t}\n\n\t\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\n\n\t\t\t// These lines also handle the case where tmin or tmax is NaN\n\t\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\n\n\t\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\n\n\t\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\n\n\t\t\tif ( invdirz >= 0 ) {\n\n\t\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\n\t\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\n\n\t\t\t} else {\n\n\t\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\n\t\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\n\n\t\t\t}\n\n\t\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\n\n\t\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\n\n\t\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\n\n\t\t\t//return point closest to the ray (positive side)\n\n\t\t\tif ( tmax < 0 ) return null;\n\n\t\t\treturn this.at( tmin >= 0 ? tmin : tmax, optionalTarget );\n\n\t\t},\n\n\t\tintersectsBox: ( function () {\n\n\t\t\tvar v = new Vector3();\n\n\t\t\treturn function intersectsBox( box ) {\n\n\t\t\t\treturn this.intersectBox( box, v ) !== null;\n\n\t\t\t};\n\n\t\t} )(),\n\n\t\tintersectTriangle: function () {\n\n\t\t\t// Compute the offset origin, edges, and normal.\n\t\t\tvar diff = new Vector3();\n\t\t\tvar edge1 = new Vector3();\n\t\t\tvar edge2 = new Vector3();\n\t\t\tvar normal = new Vector3();\n\n\t\t\treturn function intersectTriangle( a, b, c, backfaceCulling, optionalTarget ) {\n\n\t\t\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\n\n\t\t\t\tedge1.subVectors( b, a );\n\t\t\t\tedge2.subVectors( c, a );\n\t\t\t\tnormal.crossVectors( edge1, edge2 );\n\n\t\t\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\n\t\t\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\n\t\t\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\n\t\t\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\n\t\t\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\n\t\t\t\tvar DdN = this.direction.dot( normal );\n\t\t\t\tvar sign;\n\n\t\t\t\tif ( DdN > 0 ) {\n\n\t\t\t\t\tif ( backfaceCulling ) return null;\n\t\t\t\t\tsign = 1;\n\n\t\t\t\t} else if ( DdN < 0 ) {\n\n\t\t\t\t\tsign = - 1;\n\t\t\t\t\tDdN = - DdN;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t\tdiff.subVectors( this.origin, a );\n\t\t\t\tvar DdQxE2 = sign * this.direction.dot( edge2.crossVectors( diff, edge2 ) );\n\n\t\t\t\t// b1 < 0, no intersection\n\t\t\t\tif ( DdQxE2 < 0 ) {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t\tvar DdE1xQ = sign * this.direction.dot( edge1.cross( diff ) );\n\n\t\t\t\t// b2 < 0, no intersection\n\t\t\t\tif ( DdE1xQ < 0 ) {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t\t// b1+b2 > 1, no intersection\n\t\t\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t\t// Line intersects triangle, check if ray does.\n\t\t\t\tvar QdN = - sign * diff.dot( normal );\n\n\t\t\t\t// t < 0, no intersection\n\t\t\t\tif ( QdN < 0 ) {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t\t// Ray intersects triangle.\n\t\t\t\treturn this.at( QdN / DdN, optionalTarget );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tapplyMatrix4: function ( matrix4 ) {\n\n\t\t\tthis.direction.add( this.origin ).applyMatrix4( matrix4 );\n\t\t\tthis.origin.applyMatrix4( matrix4 );\n\t\t\tthis.direction.sub( this.origin );\n\t\t\tthis.direction.normalize();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tequals: function ( ray ) {\n\n\t\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author bhouston / http://clara.io\n\t */\n\n\tfunction Euler( x, y, z, order ) {\n\n\t\tthis._x = x || 0;\n\t\tthis._y = y || 0;\n\t\tthis._z = z || 0;\n\t\tthis._order = order || Euler.DefaultOrder;\n\n\t}\n\n\tEuler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\n\n\tEuler.DefaultOrder = 'XYZ';\n\n\tEuler.prototype = {\n\n\t\tconstructor: Euler,\n\n\t\tisEuler: true,\n\n\t\tget x () {\n\n\t\t\treturn this._x;\n\n\t\t},\n\n\t\tset x ( value ) {\n\n\t\t\tthis._x = value;\n\t\t\tthis.onChangeCallback();\n\n\t\t},\n\n\t\tget y () {\n\n\t\t\treturn this._y;\n\n\t\t},\n\n\t\tset y ( value ) {\n\n\t\t\tthis._y = value;\n\t\t\tthis.onChangeCallback();\n\n\t\t},\n\n\t\tget z () {\n\n\t\t\treturn this._z;\n\n\t\t},\n\n\t\tset z ( value ) {\n\n\t\t\tthis._z = value;\n\t\t\tthis.onChangeCallback();\n\n\t\t},\n\n\t\tget order () {\n\n\t\t\treturn this._order;\n\n\t\t},\n\n\t\tset order ( value ) {\n\n\t\t\tthis._order = value;\n\t\t\tthis.onChangeCallback();\n\n\t\t},\n\n\t\tset: function ( x, y, z, order ) {\n\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\t\t\tthis._order = order || this._order;\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\n\n\t\t},\n\n\t\tcopy: function ( euler ) {\n\n\t\t\tthis._x = euler._x;\n\t\t\tthis._y = euler._y;\n\t\t\tthis._z = euler._z;\n\t\t\tthis._order = euler._order;\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromRotationMatrix: function ( m, order, update ) {\n\n\t\t\tvar clamp = _Math.clamp;\n\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\t\tvar te = m.elements;\n\t\t\tvar m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\n\t\t\tvar m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\n\t\t\tvar m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\t\torder = order || this._order;\n\n\t\t\tif ( order === 'XYZ' ) {\n\n\t\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m13 ) < 0.99999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t} else if ( order === 'YXZ' ) {\n\n\t\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m23 ) < 0.99999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t} else if ( order === 'ZXY' ) {\n\n\t\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m32 ) < 0.99999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = 0;\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t}\n\n\t\t\t} else if ( order === 'ZYX' ) {\n\n\t\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m31 ) < 0.99999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t}\n\n\t\t\t} else if ( order === 'YZX' ) {\n\n\t\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m21 ) < 0.99999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\n\t\t\t\t}\n\n\t\t\t} else if ( order === 'XZY' ) {\n\n\t\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m12 ) < 0.99999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._y = 0;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order );\n\n\t\t\t}\n\n\t\t\tthis._order = order;\n\n\t\t\tif ( update !== false ) this.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromQuaternion: function () {\n\n\t\t\tvar matrix;\n\n\t\t\treturn function setFromQuaternion( q, order, update ) {\n\n\t\t\t\tif ( matrix === undefined ) matrix = new Matrix4();\n\n\t\t\t\tmatrix.makeRotationFromQuaternion( q );\n\n\t\t\t\treturn this.setFromRotationMatrix( matrix, order, update );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tsetFromVector3: function ( v, order ) {\n\n\t\t\treturn this.set( v.x, v.y, v.z, order || this._order );\n\n\t\t},\n\n\t\treorder: function () {\n\n\t\t\t// WARNING: this discards revolution information -bhouston\n\n\t\t\tvar q = new Quaternion();\n\n\t\t\treturn function reorder( newOrder ) {\n\n\t\t\t\tq.setFromEuler( this );\n\n\t\t\t\treturn this.setFromQuaternion( q, newOrder );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tequals: function ( euler ) {\n\n\t\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\n\n\t\t},\n\n\t\tfromArray: function ( array ) {\n\n\t\t\tthis._x = array[ 0 ];\n\t\t\tthis._y = array[ 1 ];\n\t\t\tthis._z = array[ 2 ];\n\t\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\n\n\t\t\tthis.onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoArray: function ( array, offset ) {\n\n\t\t\tif ( array === undefined ) array = [];\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tarray[ offset ] = this._x;\n\t\t\tarray[ offset + 1 ] = this._y;\n\t\t\tarray[ offset + 2 ] = this._z;\n\t\t\tarray[ offset + 3 ] = this._order;\n\n\t\t\treturn array;\n\n\t\t},\n\n\t\ttoVector3: function ( optionalResult ) {\n\n\t\t\tif ( optionalResult ) {\n\n\t\t\t\treturn optionalResult.set( this._x, this._y, this._z );\n\n\t\t\t} else {\n\n\t\t\t\treturn new Vector3( this._x, this._y, this._z );\n\n\t\t\t}\n\n\t\t},\n\n\t\tonChange: function ( callback ) {\n\n\t\t\tthis.onChangeCallback = callback;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tonChangeCallback: function () {}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Layers() {\n\n\t\tthis.mask = 1;\n\n\t}\n\n\tLayers.prototype = {\n\n\t\tconstructor: Layers,\n\n\t\tset: function ( channel ) {\n\n\t\t\tthis.mask = 1 << channel;\n\n\t\t},\n\n\t\tenable: function ( channel ) {\n\n\t\t\tthis.mask |= 1 << channel;\n\n\t\t},\n\n\t\ttoggle: function ( channel ) {\n\n\t\t\tthis.mask ^= 1 << channel;\n\n\t\t},\n\n\t\tdisable: function ( channel ) {\n\n\t\t\tthis.mask &= ~ ( 1 << channel );\n\n\t\t},\n\n\t\ttest: function ( layers ) {\n\n\t\t\treturn ( this.mask & layers.mask ) !== 0;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author elephantatwork / www.elephantatwork.ch\n\t */\n\n\tvar object3DId = 0;\n\n\tfunction Object3D() {\n\n\t\tObject.defineProperty( this, 'id', { value: object3DId ++ } );\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Object3D';\n\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\tthis.up = Object3D.DefaultUp.clone();\n\n\t\tvar position = new Vector3();\n\t\tvar rotation = new Euler();\n\t\tvar quaternion = new Quaternion();\n\t\tvar scale = new Vector3( 1, 1, 1 );\n\n\t\tfunction onRotationChange() {\n\n\t\t\tquaternion.setFromEuler( rotation, false );\n\n\t\t}\n\n\t\tfunction onQuaternionChange() {\n\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\n\n\t\t}\n\n\t\trotation.onChange( onRotationChange );\n\t\tquaternion.onChange( onQuaternionChange );\n\n\t\tObject.defineProperties( this, {\n\t\t\tposition: {\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: position\n\t\t\t},\n\t\t\trotation: {\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: rotation\n\t\t\t},\n\t\t\tquaternion: {\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: quaternion\n\t\t\t},\n\t\t\tscale: {\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: scale\n\t\t\t},\n\t\t\tmodelViewMatrix: {\n\t\t\t\tvalue: new Matrix4()\n\t\t\t},\n\t\t\tnormalMatrix: {\n\t\t\t\tvalue: new Matrix3()\n\t\t\t}\n\t\t} );\n\n\t\tthis.matrix = new Matrix4();\n\t\tthis.matrixWorld = new Matrix4();\n\n\t\tthis.matrixAutoUpdate = Object3D.DefaultMatrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\tthis.layers = new Layers();\n\t\tthis.visible = true;\n\n\t\tthis.castShadow = false;\n\t\tthis.receiveShadow = false;\n\n\t\tthis.frustumCulled = true;\n\t\tthis.renderOrder = 0;\n\n\t\tthis.userData = {};\n\n\t\tthis.onBeforeRender = function () {};\n\t\tthis.onAfterRender = function () {};\n\n\t}\n\n\tObject3D.DefaultUp = new Vector3( 0, 1, 0 );\n\tObject3D.DefaultMatrixAutoUpdate = true;\n\n\tObject3D.prototype = {\n\n\t\tconstructor: Object3D,\n\n\t\tisObject3D: true,\n\n\t\tapplyMatrix: function ( matrix ) {\n\n\t\t\tthis.matrix.multiplyMatrices( matrix, this.matrix );\n\n\t\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\n\n\t\t},\n\n\t\tsetRotationFromAxisAngle: function ( axis, angle ) {\n\n\t\t\t// assumes axis is normalized\n\n\t\t\tthis.quaternion.setFromAxisAngle( axis, angle );\n\n\t\t},\n\n\t\tsetRotationFromEuler: function ( euler ) {\n\n\t\t\tthis.quaternion.setFromEuler( euler, true );\n\n\t\t},\n\n\t\tsetRotationFromMatrix: function ( m ) {\n\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\t\tthis.quaternion.setFromRotationMatrix( m );\n\n\t\t},\n\n\t\tsetRotationFromQuaternion: function ( q ) {\n\n\t\t\t// assumes q is normalized\n\n\t\t\tthis.quaternion.copy( q );\n\n\t\t},\n\n\t\trotateOnAxis: function () {\n\n\t\t\t// rotate object on axis in object space\n\t\t\t// axis is assumed to be normalized\n\n\t\t\tvar q1 = new Quaternion();\n\n\t\t\treturn function rotateOnAxis( axis, angle ) {\n\n\t\t\t\tq1.setFromAxisAngle( axis, angle );\n\n\t\t\t\tthis.quaternion.multiply( q1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\trotateX: function () {\n\n\t\t\tvar v1 = new Vector3( 1, 0, 0 );\n\n\t\t\treturn function rotateX( angle ) {\n\n\t\t\t\treturn this.rotateOnAxis( v1, angle );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\trotateY: function () {\n\n\t\t\tvar v1 = new Vector3( 0, 1, 0 );\n\n\t\t\treturn function rotateY( angle ) {\n\n\t\t\t\treturn this.rotateOnAxis( v1, angle );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\trotateZ: function () {\n\n\t\t\tvar v1 = new Vector3( 0, 0, 1 );\n\n\t\t\treturn function rotateZ( angle ) {\n\n\t\t\t\treturn this.rotateOnAxis( v1, angle );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttranslateOnAxis: function () {\n\n\t\t\t// translate object by distance along axis in object space\n\t\t\t// axis is assumed to be normalized\n\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function translateOnAxis( axis, distance ) {\n\n\t\t\t\tv1.copy( axis ).applyQuaternion( this.quaternion );\n\n\t\t\t\tthis.position.add( v1.multiplyScalar( distance ) );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttranslateX: function () {\n\n\t\t\tvar v1 = new Vector3( 1, 0, 0 );\n\n\t\t\treturn function translateX( distance ) {\n\n\t\t\t\treturn this.translateOnAxis( v1, distance );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttranslateY: function () {\n\n\t\t\tvar v1 = new Vector3( 0, 1, 0 );\n\n\t\t\treturn function translateY( distance ) {\n\n\t\t\t\treturn this.translateOnAxis( v1, distance );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttranslateZ: function () {\n\n\t\t\tvar v1 = new Vector3( 0, 0, 1 );\n\n\t\t\treturn function translateZ( distance ) {\n\n\t\t\t\treturn this.translateOnAxis( v1, distance );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tlocalToWorld: function ( vector ) {\n\n\t\t\treturn vector.applyMatrix4( this.matrixWorld );\n\n\t\t},\n\n\t\tworldToLocal: function () {\n\n\t\t\tvar m1 = new Matrix4();\n\n\t\t\treturn function worldToLocal( vector ) {\n\n\t\t\t\treturn vector.applyMatrix4( m1.getInverse( this.matrixWorld ) );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tlookAt: function () {\n\n\t\t\t// This routine does not support objects with rotated and/or translated parent(s)\n\n\t\t\tvar m1 = new Matrix4();\n\n\t\t\treturn function lookAt( vector ) {\n\n\t\t\t\tm1.lookAt( vector, this.position, this.up );\n\n\t\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tadd: function ( object ) {\n\n\t\t\tif ( arguments.length > 1 ) {\n\n\t\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\t\tthis.add( arguments[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t\tif ( object === this ) {\n\n\t\t\t\tconsole.error( \"THREE.Object3D.add: object can't be added as a child of itself.\", object );\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t\tif ( ( object && object.isObject3D ) ) {\n\n\t\t\t\tif ( object.parent !== null ) {\n\n\t\t\t\t\tobject.parent.remove( object );\n\n\t\t\t\t}\n\n\t\t\t\tobject.parent = this;\n\t\t\t\tobject.dispatchEvent( { type: 'added' } );\n\n\t\t\t\tthis.children.push( object );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( \"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tremove: function ( object ) {\n\n\t\t\tif ( arguments.length > 1 ) {\n\n\t\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\t\tthis.remove( arguments[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar index = this.children.indexOf( object );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\tobject.parent = null;\n\n\t\t\t\tobject.dispatchEvent( { type: 'removed' } );\n\n\t\t\t\tthis.children.splice( index, 1 );\n\n\t\t\t}\n\n\t\t},\n\n\t\tgetObjectById: function ( id ) {\n\n\t\t\treturn this.getObjectByProperty( 'id', id );\n\n\t\t},\n\n\t\tgetObjectByName: function ( name ) {\n\n\t\t\treturn this.getObjectByProperty( 'name', name );\n\n\t\t},\n\n\t\tgetObjectByProperty: function ( name, value ) {\n\n\t\t\tif ( this[ name ] === value ) return this;\n\n\t\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = this.children[ i ];\n\t\t\t\tvar object = child.getObjectByProperty( name, value );\n\n\t\t\t\tif ( object !== undefined ) {\n\n\t\t\t\t\treturn object;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn undefined;\n\n\t\t},\n\n\t\tgetWorldPosition: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\treturn result.setFromMatrixPosition( this.matrixWorld );\n\n\t\t},\n\n\t\tgetWorldQuaternion: function () {\n\n\t\t\tvar position = new Vector3();\n\t\t\tvar scale = new Vector3();\n\n\t\t\treturn function getWorldQuaternion( optionalTarget ) {\n\n\t\t\t\tvar result = optionalTarget || new Quaternion();\n\n\t\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\t\tthis.matrixWorld.decompose( position, result, scale );\n\n\t\t\t\treturn result;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tgetWorldRotation: function () {\n\n\t\t\tvar quaternion = new Quaternion();\n\n\t\t\treturn function getWorldRotation( optionalTarget ) {\n\n\t\t\t\tvar result = optionalTarget || new Euler();\n\n\t\t\t\tthis.getWorldQuaternion( quaternion );\n\n\t\t\t\treturn result.setFromQuaternion( quaternion, this.rotation.order, false );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tgetWorldScale: function () {\n\n\t\t\tvar position = new Vector3();\n\t\t\tvar quaternion = new Quaternion();\n\n\t\t\treturn function getWorldScale( optionalTarget ) {\n\n\t\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\t\tthis.matrixWorld.decompose( position, quaternion, result );\n\n\t\t\t\treturn result;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tgetWorldDirection: function () {\n\n\t\t\tvar quaternion = new Quaternion();\n\n\t\t\treturn function getWorldDirection( optionalTarget ) {\n\n\t\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\t\tthis.getWorldQuaternion( quaternion );\n\n\t\t\t\treturn result.set( 0, 0, 1 ).applyQuaternion( quaternion );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\traycast: function () {},\n\n\t\ttraverse: function ( callback ) {\n\n\t\t\tcallback( this );\n\n\t\t\tvar children = this.children;\n\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tchildren[ i ].traverse( callback );\n\n\t\t\t}\n\n\t\t},\n\n\t\ttraverseVisible: function ( callback ) {\n\n\t\t\tif ( this.visible === false ) return;\n\n\t\t\tcallback( this );\n\n\t\t\tvar children = this.children;\n\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tchildren[ i ].traverseVisible( callback );\n\n\t\t\t}\n\n\t\t},\n\n\t\ttraverseAncestors: function ( callback ) {\n\n\t\t\tvar parent = this.parent;\n\n\t\t\tif ( parent !== null ) {\n\n\t\t\t\tcallback( parent );\n\n\t\t\t\tparent.traverseAncestors( callback );\n\n\t\t\t}\n\n\t\t},\n\n\t\tupdateMatrix: function () {\n\n\t\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\n\n\t\t\tthis.matrixWorldNeedsUpdate = true;\n\n\t\t},\n\n\t\tupdateMatrixWorld: function ( force ) {\n\n\t\t\tif ( this.matrixAutoUpdate === true ) this.updateMatrix();\n\n\t\t\tif ( this.matrixWorldNeedsUpdate === true || force === true ) {\n\n\t\t\t\tif ( this.parent === null ) {\n\n\t\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t\t}\n\n\t\t\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\t\t\tforce = true;\n\n\t\t\t}\n\n\t\t\t// update children\n\n\t\t\tvar children = this.children;\n\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tchildren[ i ].updateMatrixWorld( force );\n\n\t\t\t}\n\n\t\t},\n\n\t\ttoJSON: function ( meta ) {\n\n\t\t\t// meta is '' when called from JSON.stringify\n\t\t\tvar isRootObject = ( meta === undefined || meta === '' );\n\n\t\t\tvar output = {};\n\n\t\t\t// meta is a hash used to collect geometries, materials.\n\t\t\t// not providing it implies that this is the root object\n\t\t\t// being serialized.\n\t\t\tif ( isRootObject ) {\n\n\t\t\t\t// initialize meta obj\n\t\t\t\tmeta = {\n\t\t\t\t\tgeometries: {},\n\t\t\t\t\tmaterials: {},\n\t\t\t\t\ttextures: {},\n\t\t\t\t\timages: {}\n\t\t\t\t};\n\n\t\t\t\toutput.metadata = {\n\t\t\t\t\tversion: 4.4,\n\t\t\t\t\ttype: 'Object',\n\t\t\t\t\tgenerator: 'Object3D.toJSON'\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\t// standard Object3D serialization\n\n\t\t\tvar object = {};\n\n\t\t\tobject.uuid = this.uuid;\n\t\t\tobject.type = this.type;\n\n\t\t\tif ( this.name !== '' ) object.name = this.name;\n\t\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\n\t\t\tif ( this.castShadow === true ) object.castShadow = true;\n\t\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\n\t\t\tif ( this.visible === false ) object.visible = false;\n\n\t\t\tobject.matrix = this.matrix.toArray();\n\n\t\t\t//\n\n\t\t\tif ( this.geometry !== undefined ) {\n\n\t\t\t\tif ( meta.geometries[ this.geometry.uuid ] === undefined ) {\n\n\t\t\t\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\n\n\t\t\t\t}\n\n\t\t\t\tobject.geometry = this.geometry.uuid;\n\n\t\t\t}\n\n\t\t\tif ( this.material !== undefined ) {\n\n\t\t\t\tif ( meta.materials[ this.material.uuid ] === undefined ) {\n\n\t\t\t\t\tmeta.materials[ this.material.uuid ] = this.material.toJSON( meta );\n\n\t\t\t\t}\n\n\t\t\t\tobject.material = this.material.uuid;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tif ( this.children.length > 0 ) {\n\n\t\t\t\tobject.children = [];\n\n\t\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\n\n\t\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( isRootObject ) {\n\n\t\t\t\tvar geometries = extractFromCache( meta.geometries );\n\t\t\t\tvar materials = extractFromCache( meta.materials );\n\t\t\t\tvar textures = extractFromCache( meta.textures );\n\t\t\t\tvar images = extractFromCache( meta.images );\n\n\t\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\n\t\t\t\tif ( materials.length > 0 ) output.materials = materials;\n\t\t\t\tif ( textures.length > 0 ) output.textures = textures;\n\t\t\t\tif ( images.length > 0 ) output.images = images;\n\n\t\t\t}\n\n\t\t\toutput.object = object;\n\n\t\t\treturn output;\n\n\t\t\t// extract data from the cache hash\n\t\t\t// remove metadata on each item\n\t\t\t// and return as array\n\t\t\tfunction extractFromCache( cache ) {\n\n\t\t\t\tvar values = [];\n\t\t\t\tfor ( var key in cache ) {\n\n\t\t\t\t\tvar data = cache[ key ];\n\t\t\t\t\tdelete data.metadata;\n\t\t\t\t\tvalues.push( data );\n\n\t\t\t\t}\n\t\t\t\treturn values;\n\n\t\t\t}\n\n\t\t},\n\n\t\tclone: function ( recursive ) {\n\n\t\t\treturn new this.constructor().copy( this, recursive );\n\n\t\t},\n\n\t\tcopy: function ( source, recursive ) {\n\n\t\t\tif ( recursive === undefined ) recursive = true;\n\n\t\t\tthis.name = source.name;\n\n\t\t\tthis.up.copy( source.up );\n\n\t\t\tthis.position.copy( source.position );\n\t\t\tthis.quaternion.copy( source.quaternion );\n\t\t\tthis.scale.copy( source.scale );\n\n\t\t\tthis.matrix.copy( source.matrix );\n\t\t\tthis.matrixWorld.copy( source.matrixWorld );\n\n\t\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\n\n\t\t\tthis.layers.mask = source.layers.mask;\n\t\t\tthis.visible = source.visible;\n\n\t\t\tthis.castShadow = source.castShadow;\n\t\t\tthis.receiveShadow = source.receiveShadow;\n\n\t\t\tthis.frustumCulled = source.frustumCulled;\n\t\t\tthis.renderOrder = source.renderOrder;\n\n\t\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\t\tif ( recursive === true ) {\n\n\t\t\t\tfor ( var i = 0; i < source.children.length; i ++ ) {\n\n\t\t\t\t\tvar child = source.children[ i ];\n\t\t\t\t\tthis.add( child.clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\tObject.assign( Object3D.prototype, EventDispatcher.prototype );\n\n\t/**\n\t * @author bhouston / http://clara.io\n\t */\n\n\tfunction Line3( start, end ) {\n\n\t\tthis.start = ( start !== undefined ) ? start : new Vector3();\n\t\tthis.end = ( end !== undefined ) ? end : new Vector3();\n\n\t}\n\n\tLine3.prototype = {\n\n\t\tconstructor: Line3,\n\n\t\tset: function ( start, end ) {\n\n\t\t\tthis.start.copy( start );\n\t\t\tthis.end.copy( end );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( line ) {\n\n\t\t\tthis.start.copy( line.start );\n\t\t\tthis.end.copy( line.end );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetCenter: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\treturn result.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\n\n\t\t},\n\n\t\tdelta: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\treturn result.subVectors( this.end, this.start );\n\n\t\t},\n\n\t\tdistanceSq: function () {\n\n\t\t\treturn this.start.distanceToSquared( this.end );\n\n\t\t},\n\n\t\tdistance: function () {\n\n\t\t\treturn this.start.distanceTo( this.end );\n\n\t\t},\n\n\t\tat: function ( t, optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\n\n\t\t},\n\n\t\tclosestPointToPointParameter: function () {\n\n\t\t\tvar startP = new Vector3();\n\t\t\tvar startEnd = new Vector3();\n\n\t\t\treturn function closestPointToPointParameter( point, clampToLine ) {\n\n\t\t\t\tstartP.subVectors( point, this.start );\n\t\t\t\tstartEnd.subVectors( this.end, this.start );\n\n\t\t\t\tvar startEnd2 = startEnd.dot( startEnd );\n\t\t\t\tvar startEnd_startP = startEnd.dot( startP );\n\n\t\t\t\tvar t = startEnd_startP / startEnd2;\n\n\t\t\t\tif ( clampToLine ) {\n\n\t\t\t\t\tt = _Math.clamp( t, 0, 1 );\n\n\t\t\t\t}\n\n\t\t\t\treturn t;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tclosestPointToPoint: function ( point, clampToLine, optionalTarget ) {\n\n\t\t\tvar t = this.closestPointToPointParameter( point, clampToLine );\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\n\n\t\t},\n\n\t\tapplyMatrix4: function ( matrix ) {\n\n\t\t\tthis.start.applyMatrix4( matrix );\n\t\t\tthis.end.applyMatrix4( matrix );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tequals: function ( line ) {\n\n\t\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author bhouston / http://clara.io\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Triangle( a, b, c ) {\n\n\t\tthis.a = ( a !== undefined ) ? a : new Vector3();\n\t\tthis.b = ( b !== undefined ) ? b : new Vector3();\n\t\tthis.c = ( c !== undefined ) ? c : new Vector3();\n\n\t}\n\n\tTriangle.normal = function () {\n\n\t\tvar v0 = new Vector3();\n\n\t\treturn function normal( a, b, c, optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\tresult.subVectors( c, b );\n\t\t\tv0.subVectors( a, b );\n\t\t\tresult.cross( v0 );\n\n\t\t\tvar resultLengthSq = result.lengthSq();\n\t\t\tif ( resultLengthSq > 0 ) {\n\n\t\t\t\treturn result.multiplyScalar( 1 / Math.sqrt( resultLengthSq ) );\n\n\t\t\t}\n\n\t\t\treturn result.set( 0, 0, 0 );\n\n\t\t};\n\n\t}();\n\n\t// static/instance method to calculate barycentric coordinates\n\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\n\tTriangle.barycoordFromPoint = function () {\n\n\t\tvar v0 = new Vector3();\n\t\tvar v1 = new Vector3();\n\t\tvar v2 = new Vector3();\n\n\t\treturn function barycoordFromPoint( point, a, b, c, optionalTarget ) {\n\n\t\t\tv0.subVectors( c, a );\n\t\t\tv1.subVectors( b, a );\n\t\t\tv2.subVectors( point, a );\n\n\t\t\tvar dot00 = v0.dot( v0 );\n\t\t\tvar dot01 = v0.dot( v1 );\n\t\t\tvar dot02 = v0.dot( v2 );\n\t\t\tvar dot11 = v1.dot( v1 );\n\t\t\tvar dot12 = v1.dot( v2 );\n\n\t\t\tvar denom = ( dot00 * dot11 - dot01 * dot01 );\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\t// collinear or singular triangle\n\t\t\tif ( denom === 0 ) {\n\n\t\t\t\t// arbitrary location outside of triangle?\n\t\t\t\t// not sure if this is the best idea, maybe should be returning undefined\n\t\t\t\treturn result.set( - 2, - 1, - 1 );\n\n\t\t\t}\n\n\t\t\tvar invDenom = 1 / denom;\n\t\t\tvar u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\n\t\t\tvar v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\n\n\t\t\t// barycentric coordinates must always sum to 1\n\t\t\treturn result.set( 1 - u - v, v, u );\n\n\t\t};\n\n\t}();\n\n\tTriangle.containsPoint = function () {\n\n\t\tvar v1 = new Vector3();\n\n\t\treturn function containsPoint( point, a, b, c ) {\n\n\t\t\tvar result = Triangle.barycoordFromPoint( point, a, b, c, v1 );\n\n\t\t\treturn ( result.x >= 0 ) && ( result.y >= 0 ) && ( ( result.x + result.y ) <= 1 );\n\n\t\t};\n\n\t}();\n\n\tTriangle.prototype = {\n\n\t\tconstructor: Triangle,\n\n\t\tset: function ( a, b, c ) {\n\n\t\t\tthis.a.copy( a );\n\t\t\tthis.b.copy( b );\n\t\t\tthis.c.copy( c );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromPointsAndIndices: function ( points, i0, i1, i2 ) {\n\n\t\t\tthis.a.copy( points[ i0 ] );\n\t\t\tthis.b.copy( points[ i1 ] );\n\t\t\tthis.c.copy( points[ i2 ] );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( triangle ) {\n\n\t\t\tthis.a.copy( triangle.a );\n\t\t\tthis.b.copy( triangle.b );\n\t\t\tthis.c.copy( triangle.c );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tarea: function () {\n\n\t\t\tvar v0 = new Vector3();\n\t\t\tvar v1 = new Vector3();\n\n\t\t\treturn function area() {\n\n\t\t\t\tv0.subVectors( this.c, this.b );\n\t\t\t\tv1.subVectors( this.a, this.b );\n\n\t\t\t\treturn v0.cross( v1 ).length() * 0.5;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tmidpoint: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\treturn result.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\n\n\t\t},\n\n\t\tnormal: function ( optionalTarget ) {\n\n\t\t\treturn Triangle.normal( this.a, this.b, this.c, optionalTarget );\n\n\t\t},\n\n\t\tplane: function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Plane();\n\n\t\t\treturn result.setFromCoplanarPoints( this.a, this.b, this.c );\n\n\t\t},\n\n\t\tbarycoordFromPoint: function ( point, optionalTarget ) {\n\n\t\t\treturn Triangle.barycoordFromPoint( point, this.a, this.b, this.c, optionalTarget );\n\n\t\t},\n\n\t\tcontainsPoint: function ( point ) {\n\n\t\t\treturn Triangle.containsPoint( point, this.a, this.b, this.c );\n\n\t\t},\n\n\t\tclosestPointToPoint: function () {\n\n\t\t\tvar plane, edgeList, projectedPoint, closestPoint;\n\n\t\t\treturn function closestPointToPoint( point, optionalTarget ) {\n\n\t\t\t\tif ( plane === undefined ) {\n\n\t\t\t\t\tplane = new Plane();\n\t\t\t\t\tedgeList = [ new Line3(), new Line3(), new Line3() ];\n\t\t\t\t\tprojectedPoint = new Vector3();\n\t\t\t\t\tclosestPoint = new Vector3();\n\n\t\t\t\t}\n\n\t\t\t\tvar result = optionalTarget || new Vector3();\n\t\t\t\tvar minDistance = Infinity;\n\n\t\t\t\t// project the point onto the plane of the triangle\n\n\t\t\t\tplane.setFromCoplanarPoints( this.a, this.b, this.c );\n\t\t\t\tplane.projectPoint( point, projectedPoint );\n\n\t\t\t\t// check if the projection lies within the triangle\n\n\t\t\t\tif( this.containsPoint( projectedPoint ) === true ) {\n\n\t\t\t\t\t// if so, this is the closest point\n\n\t\t\t\t\tresult.copy( projectedPoint );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// if not, the point falls outside the triangle. the result is the closest point to the triangle's edges or vertices\n\n\t\t\t\t\tedgeList[ 0 ].set( this.a, this.b );\n\t\t\t\t\tedgeList[ 1 ].set( this.b, this.c );\n\t\t\t\t\tedgeList[ 2 ].set( this.c, this.a );\n\n\t\t\t\t\tfor( var i = 0; i < edgeList.length; i ++ ) {\n\n\t\t\t\t\t\tedgeList[ i ].closestPointToPoint( projectedPoint, true, closestPoint );\n\n\t\t\t\t\t\tvar distance = projectedPoint.distanceToSquared( closestPoint );\n\n\t\t\t\t\t\tif( distance < minDistance ) {\n\n\t\t\t\t\t\t\tminDistance = distance;\n\n\t\t\t\t\t\t\tresult.copy( closestPoint );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tequals: function ( triangle ) {\n\n\t\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction Face3( a, b, c, normal, color, materialIndex ) {\n\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\n\t\tthis.normal = (normal && normal.isVector3) ? normal : new Vector3();\n\t\tthis.vertexNormals = Array.isArray( normal ) ? normal : [];\n\n\t\tthis.color = (color && color.isColor) ? color : new Color();\n\t\tthis.vertexColors = Array.isArray( color ) ? color : [];\n\n\t\tthis.materialIndex = materialIndex !== undefined ? materialIndex : 0;\n\n\t}\n\n\tFace3.prototype = {\n\n\t\tconstructor: Face3,\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( source ) {\n\n\t\t\tthis.a = source.a;\n\t\t\tthis.b = source.b;\n\t\t\tthis.c = source.c;\n\n\t\t\tthis.normal.copy( source.normal );\n\t\t\tthis.color.copy( source.color );\n\n\t\t\tthis.materialIndex = source.materialIndex;\n\n\t\t\tfor ( var i = 0, il = source.vertexNormals.length; i < il; i ++ ) {\n\n\t\t\t\tthis.vertexNormals[ i ] = source.vertexNormals[ i ].clone();\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, il = source.vertexColors.length; i < il; i ++ ) {\n\n\t\t\t\tthis.vertexColors[ i ] = source.vertexColors[ i ].clone();\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  lightMap: new THREE.Texture( <Image> ),\n\t *  lightMapIntensity: <float>\n\t *\n\t *  aoMap: new THREE.Texture( <Image> ),\n\t *  aoMapIntensity: <float>\n\t *\n\t *  specularMap: new THREE.Texture( <Image> ),\n\t *\n\t *  alphaMap: new THREE.Texture( <Image> ),\n\t *\n\t *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\n\t *  combine: THREE.Multiply,\n\t *  reflectivity: <float>,\n\t *  refractionRatio: <float>,\n\t *\n\t *  shading: THREE.SmoothShading,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>,\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>\n\t * }\n\t */\n\n\tfunction MeshBasicMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'MeshBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // emissive\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.skinning = false;\n\t\tthis.morphTargets = false;\n\n\t\tthis.lights = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tMeshBasicMaterial.prototype = Object.create( Material.prototype );\n\tMeshBasicMaterial.prototype.constructor = MeshBasicMaterial;\n\n\tMeshBasicMaterial.prototype.isMeshBasicMaterial = true;\n\n\tMeshBasicMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.skinning = source.skinning;\n\t\tthis.morphTargets = source.morphTargets;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction BufferAttribute( array, itemSize, normalized ) {\n\n\t\tif ( Array.isArray( array ) ) {\n\n\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\n\n\t\t}\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.array = array;\n\t\tthis.itemSize = itemSize;\n\t\tthis.count = array !== undefined ? array.length / itemSize : 0;\n\t\tthis.normalized = normalized === true;\n\n\t\tthis.dynamic = false;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.onUploadCallback = function () {};\n\n\t\tthis.version = 0;\n\n\t}\n\n\tBufferAttribute.prototype = {\n\n\t\tconstructor: BufferAttribute,\n\n\t\tisBufferAttribute: true,\n\n\t\tset needsUpdate( value ) {\n\n\t\t\tif ( value === true ) this.version ++;\n\n\t\t},\n\n\t\tsetArray: function ( array ) {\n\n\t\t\tif ( Array.isArray( array ) ) {\n\n\t\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\n\n\t\t\t}\n\n\t\t\tthis.count = array !== undefined ? array.length / this.itemSize : 0;\n\t\t\tthis.array = array;\n\n\t\t},\n\n\t\tsetDynamic: function ( value ) {\n\n\t\t\tthis.dynamic = value;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopy: function ( source ) {\n\n\t\t\tthis.array = new source.array.constructor( source.array );\n\t\t\tthis.itemSize = source.itemSize;\n\t\t\tthis.count = source.count;\n\t\t\tthis.normalized = source.normalized;\n\n\t\t\tthis.dynamic = source.dynamic;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyAt: function ( index1, attribute, index2 ) {\n\n\t\t\tindex1 *= this.itemSize;\n\t\t\tindex2 *= attribute.itemSize;\n\n\t\t\tfor ( var i = 0, l = this.itemSize; i < l; i ++ ) {\n\n\t\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyArray: function ( array ) {\n\n\t\t\tthis.array.set( array );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyColorsArray: function ( colors ) {\n\n\t\t\tvar array = this.array, offset = 0;\n\n\t\t\tfor ( var i = 0, l = colors.length; i < l; i ++ ) {\n\n\t\t\t\tvar color = colors[ i ];\n\n\t\t\t\tif ( color === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\n\t\t\t\t\tcolor = new Color();\n\n\t\t\t\t}\n\n\t\t\t\tarray[ offset ++ ] = color.r;\n\t\t\t\tarray[ offset ++ ] = color.g;\n\t\t\t\tarray[ offset ++ ] = color.b;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyIndicesArray: function ( indices ) {\n\n\t\t\tvar array = this.array, offset = 0;\n\n\t\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\n\n\t\t\t\tvar index = indices[ i ];\n\n\t\t\t\tarray[ offset ++ ] = index.a;\n\t\t\t\tarray[ offset ++ ] = index.b;\n\t\t\t\tarray[ offset ++ ] = index.c;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyVector2sArray: function ( vectors ) {\n\n\t\t\tvar array = this.array, offset = 0;\n\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\t\tvar vector = vectors[ i ];\n\n\t\t\t\tif ( vector === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\n\t\t\t\t\tvector = new Vector2();\n\n\t\t\t\t}\n\n\t\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\t\tarray[ offset ++ ] = vector.y;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyVector3sArray: function ( vectors ) {\n\n\t\t\tvar array = this.array, offset = 0;\n\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\t\tvar vector = vectors[ i ];\n\n\t\t\t\tif ( vector === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\n\t\t\t\t\tvector = new Vector3();\n\n\t\t\t\t}\n\n\t\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\t\tarray[ offset ++ ] = vector.z;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyVector4sArray: function ( vectors ) {\n\n\t\t\tvar array = this.array, offset = 0;\n\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\t\tvar vector = vectors[ i ];\n\n\t\t\t\tif ( vector === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\n\t\t\t\t\tvector = new Vector4();\n\n\t\t\t\t}\n\n\t\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\t\tarray[ offset ++ ] = vector.z;\n\t\t\t\tarray[ offset ++ ] = vector.w;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tset: function ( value, offset ) {\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tthis.array.set( value, offset );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetX: function ( index ) {\n\n\t\t\treturn this.array[ index * this.itemSize ];\n\n\t\t},\n\n\t\tsetX: function ( index, x ) {\n\n\t\t\tthis.array[ index * this.itemSize ] = x;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetY: function ( index ) {\n\n\t\t\treturn this.array[ index * this.itemSize + 1 ];\n\n\t\t},\n\n\t\tsetY: function ( index, y ) {\n\n\t\t\tthis.array[ index * this.itemSize + 1 ] = y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetZ: function ( index ) {\n\n\t\t\treturn this.array[ index * this.itemSize + 2 ];\n\n\t\t},\n\n\t\tsetZ: function ( index, z ) {\n\n\t\t\tthis.array[ index * this.itemSize + 2 ] = z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetW: function ( index ) {\n\n\t\t\treturn this.array[ index * this.itemSize + 3 ];\n\n\t\t},\n\n\t\tsetW: function ( index, w ) {\n\n\t\t\tthis.array[ index * this.itemSize + 3 ] = w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetXY: function ( index, x, y ) {\n\n\t\t\tindex *= this.itemSize;\n\n\t\t\tthis.array[ index + 0 ] = x;\n\t\t\tthis.array[ index + 1 ] = y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetXYZ: function ( index, x, y, z ) {\n\n\t\t\tindex *= this.itemSize;\n\n\t\t\tthis.array[ index + 0 ] = x;\n\t\t\tthis.array[ index + 1 ] = y;\n\t\t\tthis.array[ index + 2 ] = z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetXYZW: function ( index, x, y, z, w ) {\n\n\t\t\tindex *= this.itemSize;\n\n\t\t\tthis.array[ index + 0 ] = x;\n\t\t\tthis.array[ index + 1 ] = y;\n\t\t\tthis.array[ index + 2 ] = z;\n\t\t\tthis.array[ index + 3 ] = w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tonUpload: function ( callback ) {\n\n\t\t\tthis.onUploadCallback = callback;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t}\n\n\t};\n\n\t//\n\n\tfunction Int8BufferAttribute( array, itemSize ) {\n\n\t\tBufferAttribute.call( this, new Int8Array( array ), itemSize );\n\n\t}\n\n\tInt8BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tInt8BufferAttribute.prototype.constructor = Int8BufferAttribute;\n\n\n\tfunction Uint8BufferAttribute( array, itemSize ) {\n\n\t\tBufferAttribute.call( this, new Uint8Array( array ), itemSize );\n\n\t}\n\n\tUint8BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tUint8BufferAttribute.prototype.constructor = Uint8BufferAttribute;\n\n\n\tfunction Uint8ClampedBufferAttribute( array, itemSize ) {\n\n\t\tBufferAttribute.call( this, new Uint8ClampedArray( array ), itemSize );\n\n\t}\n\n\tUint8ClampedBufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tUint8ClampedBufferAttribute.prototype.constructor = Uint8ClampedBufferAttribute;\n\n\n\tfunction Int16BufferAttribute( array, itemSize ) {\n\n\t\tBufferAttribute.call( this, new Int16Array( array ), itemSize );\n\n\t}\n\n\tInt16BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tInt16BufferAttribute.prototype.constructor = Int16BufferAttribute;\n\n\n\tfunction Uint16BufferAttribute( array, itemSize ) {\n\n\t\tBufferAttribute.call( this, new Uint16Array( array ), itemSize );\n\n\t}\n\n\tUint16BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tUint16BufferAttribute.prototype.constructor = Uint16BufferAttribute;\n\n\n\tfunction Int32BufferAttribute( array, itemSize ) {\n\n\t\tBufferAttribute.call( this, new Int32Array( array ), itemSize );\n\n\t}\n\n\tInt32BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tInt32BufferAttribute.prototype.constructor = Int32BufferAttribute;\n\n\n\tfunction Uint32BufferAttribute( array, itemSize ) {\n\n\t\tBufferAttribute.call( this, new Uint32Array( array ), itemSize );\n\n\t}\n\n\tUint32BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tUint32BufferAttribute.prototype.constructor = Uint32BufferAttribute;\n\n\n\tfunction Float32BufferAttribute( array, itemSize ) {\n\n\t\tBufferAttribute.call( this, new Float32Array( array ), itemSize );\n\n\t}\n\n\tFloat32BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tFloat32BufferAttribute.prototype.constructor = Float32BufferAttribute;\n\n\n\tfunction Float64BufferAttribute( array, itemSize ) {\n\n\t\tBufferAttribute.call( this, new Float64Array( array ), itemSize );\n\n\t}\n\n\tFloat64BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tFloat64BufferAttribute.prototype.constructor = Float64BufferAttribute;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction DirectGeometry() {\n\n\t\tthis.indices = [];\n\t\tthis.vertices = [];\n\t\tthis.normals = [];\n\t\tthis.colors = [];\n\t\tthis.uvs = [];\n\t\tthis.uvs2 = [];\n\n\t\tthis.groups = [];\n\n\t\tthis.morphTargets = {};\n\n\t\tthis.skinWeights = [];\n\t\tthis.skinIndices = [];\n\n\t\t// this.lineDistances = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// update flags\n\n\t\tthis.verticesNeedUpdate = false;\n\t\tthis.normalsNeedUpdate = false;\n\t\tthis.colorsNeedUpdate = false;\n\t\tthis.uvsNeedUpdate = false;\n\t\tthis.groupsNeedUpdate = false;\n\n\t}\n\n\tObject.assign( DirectGeometry.prototype, {\n\n\t\tcomputeGroups: function ( geometry ) {\n\n\t\t\tvar group;\n\t\t\tvar groups = [];\n\t\t\tvar materialIndex = undefined;\n\n\t\t\tvar faces = geometry.faces;\n\n\t\t\tfor ( var i = 0; i < faces.length; i ++ ) {\n\n\t\t\t\tvar face = faces[ i ];\n\n\t\t\t\t// materials\n\n\t\t\t\tif ( face.materialIndex !== materialIndex ) {\n\n\t\t\t\t\tmaterialIndex = face.materialIndex;\n\n\t\t\t\t\tif ( group !== undefined ) {\n\n\t\t\t\t\t\tgroup.count = ( i * 3 ) - group.start;\n\t\t\t\t\t\tgroups.push( group );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tgroup = {\n\t\t\t\t\t\tstart: i * 3,\n\t\t\t\t\t\tmaterialIndex: materialIndex\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( group !== undefined ) {\n\n\t\t\t\tgroup.count = ( i * 3 ) - group.start;\n\t\t\t\tgroups.push( group );\n\n\t\t\t}\n\n\t\t\tthis.groups = groups;\n\n\t\t},\n\n\t\tfromGeometry: function ( geometry ) {\n\n\t\t\tvar faces = geometry.faces;\n\t\t\tvar vertices = geometry.vertices;\n\t\t\tvar faceVertexUvs = geometry.faceVertexUvs;\n\n\t\t\tvar hasFaceVertexUv = faceVertexUvs[ 0 ] && faceVertexUvs[ 0 ].length > 0;\n\t\t\tvar hasFaceVertexUv2 = faceVertexUvs[ 1 ] && faceVertexUvs[ 1 ].length > 0;\n\n\t\t\t// morphs\n\n\t\t\tvar morphTargets = geometry.morphTargets;\n\t\t\tvar morphTargetsLength = morphTargets.length;\n\n\t\t\tvar morphTargetsPosition;\n\n\t\t\tif ( morphTargetsLength > 0 ) {\n\n\t\t\t\tmorphTargetsPosition = [];\n\n\t\t\t\tfor ( var i = 0; i < morphTargetsLength; i ++ ) {\n\n\t\t\t\t\tmorphTargetsPosition[ i ] = [];\n\n\t\t\t\t}\n\n\t\t\t\tthis.morphTargets.position = morphTargetsPosition;\n\n\t\t\t}\n\n\t\t\tvar morphNormals = geometry.morphNormals;\n\t\t\tvar morphNormalsLength = morphNormals.length;\n\n\t\t\tvar morphTargetsNormal;\n\n\t\t\tif ( morphNormalsLength > 0 ) {\n\n\t\t\t\tmorphTargetsNormal = [];\n\n\t\t\t\tfor ( var i = 0; i < morphNormalsLength; i ++ ) {\n\n\t\t\t\t\tmorphTargetsNormal[ i ] = [];\n\n\t\t\t\t}\n\n\t\t\t\tthis.morphTargets.normal = morphTargetsNormal;\n\n\t\t\t}\n\n\t\t\t// skins\n\n\t\t\tvar skinIndices = geometry.skinIndices;\n\t\t\tvar skinWeights = geometry.skinWeights;\n\n\t\t\tvar hasSkinIndices = skinIndices.length === vertices.length;\n\t\t\tvar hasSkinWeights = skinWeights.length === vertices.length;\n\n\t\t\t//\n\n\t\t\tfor ( var i = 0; i < faces.length; i ++ ) {\n\n\t\t\t\tvar face = faces[ i ];\n\n\t\t\t\tthis.vertices.push( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ] );\n\n\t\t\t\tvar vertexNormals = face.vertexNormals;\n\n\t\t\t\tif ( vertexNormals.length === 3 ) {\n\n\t\t\t\t\tthis.normals.push( vertexNormals[ 0 ], vertexNormals[ 1 ], vertexNormals[ 2 ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar normal = face.normal;\n\n\t\t\t\t\tthis.normals.push( normal, normal, normal );\n\n\t\t\t\t}\n\n\t\t\t\tvar vertexColors = face.vertexColors;\n\n\t\t\t\tif ( vertexColors.length === 3 ) {\n\n\t\t\t\t\tthis.colors.push( vertexColors[ 0 ], vertexColors[ 1 ], vertexColors[ 2 ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar color = face.color;\n\n\t\t\t\t\tthis.colors.push( color, color, color );\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasFaceVertexUv === true ) {\n\n\t\t\t\t\tvar vertexUvs = faceVertexUvs[ 0 ][ i ];\n\n\t\t\t\t\tif ( vertexUvs !== undefined ) {\n\n\t\t\t\t\t\tthis.uvs.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i );\n\n\t\t\t\t\t\tthis.uvs.push( new Vector2(), new Vector2(), new Vector2() );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasFaceVertexUv2 === true ) {\n\n\t\t\t\t\tvar vertexUvs = faceVertexUvs[ 1 ][ i ];\n\n\t\t\t\t\tif ( vertexUvs !== undefined ) {\n\n\t\t\t\t\t\tthis.uvs2.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i );\n\n\t\t\t\t\t\tthis.uvs2.push( new Vector2(), new Vector2(), new Vector2() );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// morphs\n\n\t\t\t\tfor ( var j = 0; j < morphTargetsLength; j ++ ) {\n\n\t\t\t\t\tvar morphTarget = morphTargets[ j ].vertices;\n\n\t\t\t\t\tmorphTargetsPosition[ j ].push( morphTarget[ face.a ], morphTarget[ face.b ], morphTarget[ face.c ] );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0; j < morphNormalsLength; j ++ ) {\n\n\t\t\t\t\tvar morphNormal = morphNormals[ j ].vertexNormals[ i ];\n\n\t\t\t\t\tmorphTargetsNormal[ j ].push( morphNormal.a, morphNormal.b, morphNormal.c );\n\n\t\t\t\t}\n\n\t\t\t\t// skins\n\n\t\t\t\tif ( hasSkinIndices ) {\n\n\t\t\t\t\tthis.skinIndices.push( skinIndices[ face.a ], skinIndices[ face.b ], skinIndices[ face.c ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasSkinWeights ) {\n\n\t\t\t\t\tthis.skinWeights.push( skinWeights[ face.a ], skinWeights[ face.b ], skinWeights[ face.c ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.computeGroups( geometry );\n\n\t\t\tthis.verticesNeedUpdate = geometry.verticesNeedUpdate;\n\t\t\tthis.normalsNeedUpdate = geometry.normalsNeedUpdate;\n\t\t\tthis.colorsNeedUpdate = geometry.colorsNeedUpdate;\n\t\t\tthis.uvsNeedUpdate = geometry.uvsNeedUpdate;\n\t\t\tthis.groupsNeedUpdate = geometry.groupsNeedUpdate;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author kile / http://kile.stravaganza.org/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * @author bhouston / http://clara.io\n\t */\n\n\tvar count = 0;\n\tfunction GeometryIdCount() { return count++; }\n\n\tfunction Geometry() {\n\n\t\tObject.defineProperty( this, 'id', { value: GeometryIdCount() } );\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Geometry';\n\n\t\tthis.vertices = [];\n\t\tthis.colors = [];\n\t\tthis.faces = [];\n\t\tthis.faceVertexUvs = [[]];\n\n\t\tthis.morphTargets = [];\n\t\tthis.morphNormals = [];\n\n\t\tthis.skinWeights = [];\n\t\tthis.skinIndices = [];\n\n\t\tthis.lineDistances = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// update flags\n\n\t\tthis.elementsNeedUpdate = false;\n\t\tthis.verticesNeedUpdate = false;\n\t\tthis.uvsNeedUpdate = false;\n\t\tthis.normalsNeedUpdate = false;\n\t\tthis.colorsNeedUpdate = false;\n\t\tthis.lineDistancesNeedUpdate = false;\n\t\tthis.groupsNeedUpdate = false;\n\n\t}\n\n\tGeometry.prototype = {\n\n\t\tconstructor: Geometry,\n\n\t\tisGeometry: true,\n\n\t\tapplyMatrix: function ( matrix ) {\n\n\t\t\tvar normalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t\tfor ( var i = 0, il = this.vertices.length; i < il; i ++ ) {\n\n\t\t\t\tvar vertex = this.vertices[ i ];\n\t\t\t\tvertex.applyMatrix4( matrix );\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, il = this.faces.length; i < il; i ++ ) {\n\n\t\t\t\tvar face = this.faces[ i ];\n\t\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\n\n\t\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.boundingBox !== null ) {\n\n\t\t\t\tthis.computeBoundingBox();\n\n\t\t\t}\n\n\t\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\t\tthis.computeBoundingSphere();\n\n\t\t\t}\n\n\t\t\tthis.verticesNeedUpdate = true;\n\t\t\tthis.normalsNeedUpdate = true;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\trotateX: function () {\n\n\t\t\t// rotate geometry around world x-axis\n\n\t\t\tvar m1;\n\n\t\t\treturn function rotateX( angle ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeRotationX( angle );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\trotateY: function () {\n\n\t\t\t// rotate geometry around world y-axis\n\n\t\t\tvar m1;\n\n\t\t\treturn function rotateY( angle ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeRotationY( angle );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\trotateZ: function () {\n\n\t\t\t// rotate geometry around world z-axis\n\n\t\t\tvar m1;\n\n\t\t\treturn function rotateZ( angle ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeRotationZ( angle );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttranslate: function () {\n\n\t\t\t// translate geometry\n\n\t\t\tvar m1;\n\n\t\t\treturn function translate( x, y, z ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeTranslation( x, y, z );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tscale: function () {\n\n\t\t\t// scale geometry\n\n\t\t\tvar m1;\n\n\t\t\treturn function scale( x, y, z ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeScale( x, y, z );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tlookAt: function () {\n\n\t\t\tvar obj;\n\n\t\t\treturn function lookAt( vector ) {\n\n\t\t\t\tif ( obj === undefined ) obj = new Object3D();\n\n\t\t\t\tobj.lookAt( vector );\n\n\t\t\t\tobj.updateMatrix();\n\n\t\t\t\tthis.applyMatrix( obj.matrix );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tfromBufferGeometry: function ( geometry ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar indices = geometry.index !== null ? geometry.index.array : undefined;\n\t\t\tvar attributes = geometry.attributes;\n\n\t\t\tvar positions = attributes.position.array;\n\t\t\tvar normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\n\t\t\tvar colors = attributes.color !== undefined ? attributes.color.array : undefined;\n\t\t\tvar uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\n\t\t\tvar uvs2 = attributes.uv2 !== undefined ? attributes.uv2.array : undefined;\n\n\t\t\tif ( uvs2 !== undefined ) this.faceVertexUvs[ 1 ] = [];\n\n\t\t\tvar tempNormals = [];\n\t\t\tvar tempUVs = [];\n\t\t\tvar tempUVs2 = [];\n\n\t\t\tfor ( var i = 0, j = 0; i < positions.length; i += 3, j += 2 ) {\n\n\t\t\t\tscope.vertices.push( new Vector3( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] ) );\n\n\t\t\t\tif ( normals !== undefined ) {\n\n\t\t\t\t\ttempNormals.push( new Vector3( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( colors !== undefined ) {\n\n\t\t\t\t\tscope.colors.push( new Color( colors[ i ], colors[ i + 1 ], colors[ i + 2 ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( uvs !== undefined ) {\n\n\t\t\t\t\ttempUVs.push( new Vector2( uvs[ j ], uvs[ j + 1 ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( uvs2 !== undefined ) {\n\n\t\t\t\t\ttempUVs2.push( new Vector2( uvs2[ j ], uvs2[ j + 1 ] ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction addFace( a, b, c, materialIndex ) {\n\n\t\t\t\tvar vertexNormals = normals !== undefined ? [ tempNormals[ a ].clone(), tempNormals[ b ].clone(), tempNormals[ c ].clone() ] : [];\n\t\t\t\tvar vertexColors = colors !== undefined ? [ scope.colors[ a ].clone(), scope.colors[ b ].clone(), scope.colors[ c ].clone() ] : [];\n\n\t\t\t\tvar face = new Face3( a, b, c, vertexNormals, vertexColors, materialIndex );\n\n\t\t\t\tscope.faces.push( face );\n\n\t\t\t\tif ( uvs !== undefined ) {\n\n\t\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ tempUVs[ a ].clone(), tempUVs[ b ].clone(), tempUVs[ c ].clone() ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( uvs2 !== undefined ) {\n\n\t\t\t\t\tscope.faceVertexUvs[ 1 ].push( [ tempUVs2[ a ].clone(), tempUVs2[ b ].clone(), tempUVs2[ c ].clone() ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( indices !== undefined ) {\n\n\t\t\t\tvar groups = geometry.groups;\n\n\t\t\t\tif ( groups.length > 0 ) {\n\n\t\t\t\t\tfor ( var i = 0; i < groups.length; i ++ ) {\n\n\t\t\t\t\t\tvar group = groups[ i ];\n\n\t\t\t\t\t\tvar start = group.start;\n\t\t\t\t\t\tvar count = group.count;\n\n\t\t\t\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\t\t\t\taddFace( indices[ j ], indices[ j + 1 ], indices[ j + 2 ], group.materialIndex );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\n\n\t\t\t\t\t\taddFace( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfor ( var i = 0; i < positions.length / 3; i += 3 ) {\n\n\t\t\t\t\taddFace( i, i + 1, i + 2 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.computeFaceNormals();\n\n\t\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\n\n\t\t\t}\n\n\t\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcenter: function () {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t\tvar offset = this.boundingBox.getCenter().negate();\n\n\t\t\tthis.translate( offset.x, offset.y, offset.z );\n\n\t\t\treturn offset;\n\n\t\t},\n\n\t\tnormalize: function () {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t\tvar center = this.boundingSphere.center;\n\t\t\tvar radius = this.boundingSphere.radius;\n\n\t\t\tvar s = radius === 0 ? 1 : 1.0 / radius;\n\n\t\t\tvar matrix = new Matrix4();\n\t\t\tmatrix.set(\n\t\t\t\ts, 0, 0, - s * center.x,\n\t\t\t\t0, s, 0, - s * center.y,\n\t\t\t\t0, 0, s, - s * center.z,\n\t\t\t\t0, 0, 0, 1\n\t\t\t);\n\n\t\t\tthis.applyMatrix( matrix );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcomputeFaceNormals: function () {\n\n\t\t\tvar cb = new Vector3(), ab = new Vector3();\n\n\t\t\tfor ( var f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tvar face = this.faces[ f ];\n\n\t\t\t\tvar vA = this.vertices[ face.a ];\n\t\t\t\tvar vB = this.vertices[ face.b ];\n\t\t\t\tvar vC = this.vertices[ face.c ];\n\n\t\t\t\tcb.subVectors( vC, vB );\n\t\t\t\tab.subVectors( vA, vB );\n\t\t\t\tcb.cross( ab );\n\n\t\t\t\tcb.normalize();\n\n\t\t\t\tface.normal.copy( cb );\n\n\t\t\t}\n\n\t\t},\n\n\t\tcomputeVertexNormals: function ( areaWeighted ) {\n\n\t\t\tif ( areaWeighted === undefined ) areaWeighted = true;\n\n\t\t\tvar v, vl, f, fl, face, vertices;\n\n\t\t\tvertices = new Array( this.vertices.length );\n\n\t\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\n\n\t\t\t\tvertices[ v ] = new Vector3();\n\n\t\t\t}\n\n\t\t\tif ( areaWeighted ) {\n\n\t\t\t\t// vertex normals weighted by triangle areas\n\t\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\n\n\t\t\t\tvar vA, vB, vC;\n\t\t\t\tvar cb = new Vector3(), ab = new Vector3();\n\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\t\tvA = this.vertices[ face.a ];\n\t\t\t\t\tvB = this.vertices[ face.b ];\n\t\t\t\t\tvC = this.vertices[ face.c ];\n\n\t\t\t\t\tcb.subVectors( vC, vB );\n\t\t\t\t\tab.subVectors( vA, vB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tvertices[ face.a ].add( cb );\n\t\t\t\t\tvertices[ face.b ].add( cb );\n\t\t\t\t\tvertices[ face.c ].add( cb );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tthis.computeFaceNormals();\n\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\t\tvertices[ face.a ].add( face.normal );\n\t\t\t\t\tvertices[ face.b ].add( face.normal );\n\t\t\t\t\tvertices[ face.c ].add( face.normal );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\n\n\t\t\t\tvertices[ v ].normalize();\n\n\t\t\t}\n\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\tvar vertexNormals = face.vertexNormals;\n\n\t\t\t\tif ( vertexNormals.length === 3 ) {\n\n\t\t\t\t\tvertexNormals[ 0 ].copy( vertices[ face.a ] );\n\t\t\t\t\tvertexNormals[ 1 ].copy( vertices[ face.b ] );\n\t\t\t\t\tvertexNormals[ 2 ].copy( vertices[ face.c ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvertexNormals[ 0 ] = vertices[ face.a ].clone();\n\t\t\t\t\tvertexNormals[ 1 ] = vertices[ face.b ].clone();\n\t\t\t\t\tvertexNormals[ 2 ] = vertices[ face.c ].clone();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.faces.length > 0 ) {\n\n\t\t\t\tthis.normalsNeedUpdate = true;\n\n\t\t\t}\n\n\t\t},\n\n\t\tcomputeFlatVertexNormals: function () {\n\n\t\t\tvar f, fl, face;\n\n\t\t\tthis.computeFaceNormals();\n\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\tvar vertexNormals = face.vertexNormals;\n\n\t\t\t\tif ( vertexNormals.length === 3 ) {\n\n\t\t\t\t\tvertexNormals[ 0 ].copy( face.normal );\n\t\t\t\t\tvertexNormals[ 1 ].copy( face.normal );\n\t\t\t\t\tvertexNormals[ 2 ].copy( face.normal );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvertexNormals[ 0 ] = face.normal.clone();\n\t\t\t\t\tvertexNormals[ 1 ] = face.normal.clone();\n\t\t\t\t\tvertexNormals[ 2 ] = face.normal.clone();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.faces.length > 0 ) {\n\n\t\t\t\tthis.normalsNeedUpdate = true;\n\n\t\t\t}\n\n\t\t},\n\n\t\tcomputeMorphNormals: function () {\n\n\t\t\tvar i, il, f, fl, face;\n\n\t\t\t// save original normals\n\t\t\t// - create temp variables on first access\n\t\t\t//   otherwise just copy (for faster repeated calls)\n\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\tif ( ! face.__originalFaceNormal ) {\n\n\t\t\t\t\tface.__originalFaceNormal = face.normal.clone();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tface.__originalFaceNormal.copy( face.normal );\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! face.__originalVertexNormals ) face.__originalVertexNormals = [];\n\n\t\t\t\tfor ( i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\n\n\t\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\n\n\t\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// use temp geometry to compute face and vertex normals for each morph\n\n\t\t\tvar tmpGeo = new Geometry();\n\t\t\ttmpGeo.faces = this.faces;\n\n\t\t\tfor ( i = 0, il = this.morphTargets.length; i < il; i ++ ) {\n\n\t\t\t\t// create on first access\n\n\t\t\t\tif ( ! this.morphNormals[ i ] ) {\n\n\t\t\t\t\tthis.morphNormals[ i ] = {};\n\t\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\n\t\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\n\n\t\t\t\t\tvar dstNormalsFace = this.morphNormals[ i ].faceNormals;\n\t\t\t\t\tvar dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\n\n\t\t\t\t\tvar faceNormal, vertexNormals;\n\n\t\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\t\t\tfaceNormal = new Vector3();\n\t\t\t\t\t\tvertexNormals = { a: new Vector3(), b: new Vector3(), c: new Vector3() };\n\n\t\t\t\t\t\tdstNormalsFace.push( faceNormal );\n\t\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvar morphNormals = this.morphNormals[ i ];\n\n\t\t\t\t// set vertices to morph target\n\n\t\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\n\n\t\t\t\t// compute morph normals\n\n\t\t\t\ttmpGeo.computeFaceNormals();\n\t\t\t\ttmpGeo.computeVertexNormals();\n\n\t\t\t\t// store morph normals\n\n\t\t\t\tvar faceNormal, vertexNormals;\n\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\t\tfaceNormal = morphNormals.faceNormals[ f ];\n\t\t\t\t\tvertexNormals = morphNormals.vertexNormals[ f ];\n\n\t\t\t\t\tfaceNormal.copy( face.normal );\n\n\t\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\n\t\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\n\t\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// restore original normals\n\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\tface.normal = face.__originalFaceNormal;\n\t\t\t\tface.vertexNormals = face.__originalVertexNormals;\n\n\t\t\t}\n\n\t\t},\n\n\t\tcomputeLineDistances: function () {\n\n\t\t\tvar d = 0;\n\t\t\tvar vertices = this.vertices;\n\n\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\n\n\t\t\t\tif ( i > 0 ) {\n\n\t\t\t\t\td += vertices[ i ].distanceTo( vertices[ i - 1 ] );\n\n\t\t\t\t}\n\n\t\t\t\tthis.lineDistances[ i ] = d;\n\n\t\t\t}\n\n\t\t},\n\n\t\tcomputeBoundingBox: function () {\n\n\t\t\tif ( this.boundingBox === null ) {\n\n\t\t\t\tthis.boundingBox = new Box3();\n\n\t\t\t}\n\n\t\t\tthis.boundingBox.setFromPoints( this.vertices );\n\n\t\t},\n\n\t\tcomputeBoundingSphere: function () {\n\n\t\t\tif ( this.boundingSphere === null ) {\n\n\t\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t\t}\n\n\t\t\tthis.boundingSphere.setFromPoints( this.vertices );\n\n\t\t},\n\n\t\tmerge: function ( geometry, matrix, materialIndexOffset ) {\n\n\t\t\tif ( ( geometry && geometry.isGeometry ) === false ) {\n\n\t\t\t\tconsole.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tvar normalMatrix,\n\t\t\tvertexOffset = this.vertices.length,\n\t\t\tvertices1 = this.vertices,\n\t\t\tvertices2 = geometry.vertices,\n\t\t\tfaces1 = this.faces,\n\t\t\tfaces2 = geometry.faces,\n\t\t\tuvs1 = this.faceVertexUvs[ 0 ],\n\t\t\tuvs2 = geometry.faceVertexUvs[ 0 ],\n\t\t\tcolors1 = this.colors,\n\t\t\tcolors2 = geometry.colors;\n\n\t\t\tif ( materialIndexOffset === undefined ) materialIndexOffset = 0;\n\n\t\t\tif ( matrix !== undefined ) {\n\n\t\t\t\tnormalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t\t}\n\n\t\t\t// vertices\n\n\t\t\tfor ( var i = 0, il = vertices2.length; i < il; i ++ ) {\n\n\t\t\t\tvar vertex = vertices2[ i ];\n\n\t\t\t\tvar vertexCopy = vertex.clone();\n\n\t\t\t\tif ( matrix !== undefined ) vertexCopy.applyMatrix4( matrix );\n\n\t\t\t\tvertices1.push( vertexCopy );\n\n\t\t\t}\n\n\t\t\t// colors\n\n\t\t\tfor ( var i = 0, il = colors2.length; i < il; i ++ ) {\n\n\t\t\t\tcolors1.push( colors2[ i ].clone() );\n\n\t\t\t}\n\n\t\t\t// faces\n\n\t\t\tfor ( i = 0, il = faces2.length; i < il; i ++ ) {\n\n\t\t\t\tvar face = faces2[ i ], faceCopy, normal, color,\n\t\t\t\tfaceVertexNormals = face.vertexNormals,\n\t\t\t\tfaceVertexColors = face.vertexColors;\n\n\t\t\t\tfaceCopy = new Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\n\t\t\t\tfaceCopy.normal.copy( face.normal );\n\n\t\t\t\tif ( normalMatrix !== undefined ) {\n\n\t\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\n\n\t\t\t\t\tnormal = faceVertexNormals[ j ].clone();\n\n\t\t\t\t\tif ( normalMatrix !== undefined ) {\n\n\t\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfaceCopy.vertexNormals.push( normal );\n\n\t\t\t\t}\n\n\t\t\t\tfaceCopy.color.copy( face.color );\n\n\t\t\t\tfor ( var j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\n\n\t\t\t\t\tcolor = faceVertexColors[ j ];\n\t\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\n\n\t\t\t\t}\n\n\t\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\n\n\t\t\t\tfaces1.push( faceCopy );\n\n\t\t\t}\n\n\t\t\t// uvs\n\n\t\t\tfor ( i = 0, il = uvs2.length; i < il; i ++ ) {\n\n\t\t\t\tvar uv = uvs2[ i ], uvCopy = [];\n\n\t\t\t\tif ( uv === undefined ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = uv.length; j < jl; j ++ ) {\n\n\t\t\t\t\tuvCopy.push( uv[ j ].clone() );\n\n\t\t\t\t}\n\n\t\t\t\tuvs1.push( uvCopy );\n\n\t\t\t}\n\n\t\t},\n\n\t\tmergeMesh: function ( mesh ) {\n\n\t\t\tif ( ( mesh && mesh.isMesh ) === false ) {\n\n\t\t\t\tconsole.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tmesh.matrixAutoUpdate && mesh.updateMatrix();\n\n\t\t\tthis.merge( mesh.geometry, mesh.matrix );\n\n\t\t},\n\n\t\t/*\n\t\t * Checks for duplicate vertices with hashmap.\n\t\t * Duplicated vertices are removed\n\t\t * and faces' vertices are updated.\n\t\t */\n\n\t\tmergeVertices: function () {\n\n\t\t\tvar verticesMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\n\t\t\tvar unique = [], changes = [];\n\n\t\t\tvar v, key;\n\t\t\tvar precisionPoints = 4; // number of decimal points, e.g. 4 for epsilon of 0.0001\n\t\t\tvar precision = Math.pow( 10, precisionPoints );\n\t\t\tvar i, il, face;\n\t\t\tvar indices, j, jl;\n\n\t\t\tfor ( i = 0, il = this.vertices.length; i < il; i ++ ) {\n\n\t\t\t\tv = this.vertices[ i ];\n\t\t\t\tkey = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\n\n\t\t\t\tif ( verticesMap[ key ] === undefined ) {\n\n\t\t\t\t\tverticesMap[ key ] = i;\n\t\t\t\t\tunique.push( this.vertices[ i ] );\n\t\t\t\t\tchanges[ i ] = unique.length - 1;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\n\t\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t// if faces are completely degenerate after merging vertices, we\n\t\t\t// have to remove them from the geometry.\n\t\t\tvar faceIndicesToRemove = [];\n\n\t\t\tfor ( i = 0, il = this.faces.length; i < il; i ++ ) {\n\n\t\t\t\tface = this.faces[ i ];\n\n\t\t\t\tface.a = changes[ face.a ];\n\t\t\t\tface.b = changes[ face.b ];\n\t\t\t\tface.c = changes[ face.c ];\n\n\t\t\t\tindices = [ face.a, face.b, face.c ];\n\n\t\t\t\t// if any duplicate vertices are found in a Face3\n\t\t\t\t// we have to remove the face as nothing can be saved\n\t\t\t\tfor ( var n = 0; n < 3; n ++ ) {\n\n\t\t\t\t\tif ( indices[ n ] === indices[ ( n + 1 ) % 3 ] ) {\n\n\t\t\t\t\t\tfaceIndicesToRemove.push( i );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\n\n\t\t\t\tvar idx = faceIndicesToRemove[ i ];\n\n\t\t\t\tthis.faces.splice( idx, 1 );\n\n\t\t\t\tfor ( j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\n\n\t\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Use unique set of vertices\n\n\t\t\tvar diff = this.vertices.length - unique.length;\n\t\t\tthis.vertices = unique;\n\t\t\treturn diff;\n\n\t\t},\n\n\t\tsortFacesByMaterialIndex: function () {\n\n\t\t\tvar faces = this.faces;\n\t\t\tvar length = faces.length;\n\n\t\t\t// tag faces\n\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\n\n\t\t\t\tfaces[ i ]._id = i;\n\n\t\t\t}\n\n\t\t\t// sort faces\n\n\t\t\tfunction materialIndexSort( a, b ) {\n\n\t\t\t\treturn a.materialIndex - b.materialIndex;\n\n\t\t\t}\n\n\t\t\tfaces.sort( materialIndexSort );\n\n\t\t\t// sort uvs\n\n\t\t\tvar uvs1 = this.faceVertexUvs[ 0 ];\n\t\t\tvar uvs2 = this.faceVertexUvs[ 1 ];\n\n\t\t\tvar newUvs1, newUvs2;\n\n\t\t\tif ( uvs1 && uvs1.length === length ) newUvs1 = [];\n\t\t\tif ( uvs2 && uvs2.length === length ) newUvs2 = [];\n\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\n\n\t\t\t\tvar id = faces[ i ]._id;\n\n\t\t\t\tif ( newUvs1 ) newUvs1.push( uvs1[ id ] );\n\t\t\t\tif ( newUvs2 ) newUvs2.push( uvs2[ id ] );\n\n\t\t\t}\n\n\t\t\tif ( newUvs1 ) this.faceVertexUvs[ 0 ] = newUvs1;\n\t\t\tif ( newUvs2 ) this.faceVertexUvs[ 1 ] = newUvs2;\n\n\t\t},\n\n\t\ttoJSON: function () {\n\n\t\t\tvar data = {\n\t\t\t\tmetadata: {\n\t\t\t\t\tversion: 4.4,\n\t\t\t\t\ttype: 'Geometry',\n\t\t\t\t\tgenerator: 'Geometry.toJSON'\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// standard Geometry serialization\n\n\t\t\tdata.uuid = this.uuid;\n\t\t\tdata.type = this.type;\n\t\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\t\tif ( this.parameters !== undefined ) {\n\n\t\t\t\tvar parameters = this.parameters;\n\n\t\t\t\tfor ( var key in parameters ) {\n\n\t\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t\t}\n\n\t\t\t\treturn data;\n\n\t\t\t}\n\n\t\t\tvar vertices = [];\n\n\t\t\tfor ( var i = 0; i < this.vertices.length; i ++ ) {\n\n\t\t\t\tvar vertex = this.vertices[ i ];\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t}\n\n\t\t\tvar faces = [];\n\t\t\tvar normals = [];\n\t\t\tvar normalsHash = {};\n\t\t\tvar colors = [];\n\t\t\tvar colorsHash = {};\n\t\t\tvar uvs = [];\n\t\t\tvar uvsHash = {};\n\n\t\t\tfor ( var i = 0; i < this.faces.length; i ++ ) {\n\n\t\t\t\tvar face = this.faces[ i ];\n\n\t\t\t\tvar hasMaterial = true;\n\t\t\t\tvar hasFaceUv = false; // deprecated\n\t\t\t\tvar hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\n\t\t\t\tvar hasFaceNormal = face.normal.length() > 0;\n\t\t\t\tvar hasFaceVertexNormal = face.vertexNormals.length > 0;\n\t\t\t\tvar hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\n\t\t\t\tvar hasFaceVertexColor = face.vertexColors.length > 0;\n\n\t\t\t\tvar faceType = 0;\n\n\t\t\t\tfaceType = setBit( faceType, 0, 0 ); // isQuad\n\t\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\n\t\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\n\t\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\n\t\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\n\t\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\n\t\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\n\t\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\n\n\t\t\t\tfaces.push( faceType );\n\t\t\t\tfaces.push( face.a, face.b, face.c );\n\t\t\t\tfaces.push( face.materialIndex );\n\n\t\t\t\tif ( hasFaceVertexUv ) {\n\n\t\t\t\t\tvar faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\n\n\t\t\t\t\tfaces.push(\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasFaceNormal ) {\n\n\t\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasFaceVertexNormal ) {\n\n\t\t\t\t\tvar vertexNormals = face.vertexNormals;\n\n\t\t\t\t\tfaces.push(\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasFaceColor ) {\n\n\t\t\t\t\tfaces.push( getColorIndex( face.color ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasFaceVertexColor ) {\n\n\t\t\t\t\tvar vertexColors = face.vertexColors;\n\n\t\t\t\t\tfaces.push(\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction setBit( value, position, enabled ) {\n\n\t\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position ) );\n\n\t\t\t}\n\n\t\t\tfunction getNormalIndex( normal ) {\n\n\t\t\t\tvar hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\n\n\t\t\t\tif ( normalsHash[ hash ] !== undefined ) {\n\n\t\t\t\t\treturn normalsHash[ hash ];\n\n\t\t\t\t}\n\n\t\t\t\tnormalsHash[ hash ] = normals.length / 3;\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\treturn normalsHash[ hash ];\n\n\t\t\t}\n\n\t\t\tfunction getColorIndex( color ) {\n\n\t\t\t\tvar hash = color.r.toString() + color.g.toString() + color.b.toString();\n\n\t\t\t\tif ( colorsHash[ hash ] !== undefined ) {\n\n\t\t\t\t\treturn colorsHash[ hash ];\n\n\t\t\t\t}\n\n\t\t\t\tcolorsHash[ hash ] = colors.length;\n\t\t\t\tcolors.push( color.getHex() );\n\n\t\t\t\treturn colorsHash[ hash ];\n\n\t\t\t}\n\n\t\t\tfunction getUvIndex( uv ) {\n\n\t\t\t\tvar hash = uv.x.toString() + uv.y.toString();\n\n\t\t\t\tif ( uvsHash[ hash ] !== undefined ) {\n\n\t\t\t\t\treturn uvsHash[ hash ];\n\n\t\t\t\t}\n\n\t\t\t\tuvsHash[ hash ] = uvs.length / 2;\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\treturn uvsHash[ hash ];\n\n\t\t\t}\n\n\t\t\tdata.data = {};\n\n\t\t\tdata.data.vertices = vertices;\n\t\t\tdata.data.normals = normals;\n\t\t\tif ( colors.length > 0 ) data.data.colors = colors;\n\t\t\tif ( uvs.length > 0 ) data.data.uvs = [ uvs ]; // temporal backward compatibility\n\t\t\tdata.data.faces = faces;\n\n\t\t\treturn data;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\t/*\n\t\t\t// Handle primitives\n\n\t\t\tvar parameters = this.parameters;\n\n\t\t\tif ( parameters !== undefined ) {\n\n\t\t\t\tvar values = [];\n\n\t\t\t\tfor ( var key in parameters ) {\n\n\t\t\t\t\tvalues.push( parameters[ key ] );\n\n\t\t\t\t}\n\n\t\t\t\tvar geometry = Object.create( this.constructor.prototype );\n\t\t\t\tthis.constructor.apply( geometry, values );\n\t\t\t\treturn geometry;\n\n\t\t\t}\n\n\t\t\treturn new this.constructor().copy( this );\n\t\t\t*/\n\n\t\t\treturn new Geometry().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( source ) {\n\n\t\t\tthis.vertices = [];\n\t\t\tthis.faces = [];\n\t\t\tthis.faceVertexUvs = [ [] ];\n\t\t\tthis.colors = [];\n\n\t\t\tvar vertices = source.vertices;\n\n\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\n\n\t\t\t\tthis.vertices.push( vertices[ i ].clone() );\n\n\t\t\t}\n\n\t\t\tvar colors = source.colors;\n\n\t\t\tfor ( var i = 0, il = colors.length; i < il; i ++ ) {\n\n\t\t\t\tthis.colors.push( colors[ i ].clone() );\n\n\t\t\t}\n\n\t\t\tvar faces = source.faces;\n\n\t\t\tfor ( var i = 0, il = faces.length; i < il; i ++ ) {\n\n\t\t\t\tthis.faces.push( faces[ i ].clone() );\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, il = source.faceVertexUvs.length; i < il; i ++ ) {\n\n\t\t\t\tvar faceVertexUvs = source.faceVertexUvs[ i ];\n\n\t\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) {\n\n\t\t\t\t\tthis.faceVertexUvs[ i ] = [];\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\n\n\t\t\t\t\tvar uvs = faceVertexUvs[ j ], uvsCopy = [];\n\n\t\t\t\t\tfor ( var k = 0, kl = uvs.length; k < kl; k ++ ) {\n\n\t\t\t\t\t\tvar uv = uvs[ k ];\n\n\t\t\t\t\t\tuvsCopy.push( uv.clone() );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdispose: function () {\n\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\t}\n\n\t};\n\n\tObject.assign( Geometry.prototype, EventDispatcher.prototype );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction BufferGeometry() {\n\n\t\tObject.defineProperty( this, 'id', { value: GeometryIdCount() } );\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'BufferGeometry';\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\n\t\tthis.morphAttributes = {};\n\n\t\tthis.groups = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\tthis.drawRange = { start: 0, count: Infinity };\n\n\t}\n\n\tBufferGeometry.prototype = {\n\n\t\tconstructor: BufferGeometry,\n\n\t\tisBufferGeometry: true,\n\n\t\tgetIndex: function () {\n\n\t\t\treturn this.index;\n\n\t\t},\n\n\t\tsetIndex: function ( index ) {\n\n\t\t\tthis.index = index;\n\n\t\t},\n\n\t\taddAttribute: function ( name, attribute ) {\n\n\t\t\tif ( ( attribute && attribute.isBufferAttribute ) === false && ( attribute && attribute.isInterleavedBufferAttribute ) === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\n\n\t\t\t\tthis.addAttribute( name, new BufferAttribute( arguments[ 1 ], arguments[ 2 ] ) );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( name === 'index' ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.' );\n\t\t\t\tthis.setIndex( attribute );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tthis.attributes[ name ] = attribute;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetAttribute: function ( name ) {\n\n\t\t\treturn this.attributes[ name ];\n\n\t\t},\n\n\t\tremoveAttribute: function ( name ) {\n\n\t\t\tdelete this.attributes[ name ];\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddGroup: function ( start, count, materialIndex ) {\n\n\t\t\tthis.groups.push( {\n\n\t\t\t\tstart: start,\n\t\t\t\tcount: count,\n\t\t\t\tmaterialIndex: materialIndex !== undefined ? materialIndex : 0\n\n\t\t\t} );\n\n\t\t},\n\n\t\tclearGroups: function () {\n\n\t\t\tthis.groups = [];\n\n\t\t},\n\n\t\tsetDrawRange: function ( start, count ) {\n\n\t\t\tthis.drawRange.start = start;\n\t\t\tthis.drawRange.count = count;\n\n\t\t},\n\n\t\tapplyMatrix: function ( matrix ) {\n\n\t\t\tvar position = this.attributes.position;\n\n\t\t\tif ( position !== undefined ) {\n\n\t\t\t\tmatrix.applyToBufferAttribute( position );\n\t\t\t\tposition.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tvar normal = this.attributes.normal;\n\n\t\t\tif ( normal !== undefined ) {\n\n\t\t\t\tvar normalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t\t\tnormalMatrix.applyToBufferAttribute( normal );\n\t\t\t\tnormal.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tif ( this.boundingBox !== null ) {\n\n\t\t\t\tthis.computeBoundingBox();\n\n\t\t\t}\n\n\t\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\t\tthis.computeBoundingSphere();\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\trotateX: function () {\n\n\t\t\t// rotate geometry around world x-axis\n\n\t\t\tvar m1;\n\n\t\t\treturn function rotateX( angle ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeRotationX( angle );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\trotateY: function () {\n\n\t\t\t// rotate geometry around world y-axis\n\n\t\t\tvar m1;\n\n\t\t\treturn function rotateY( angle ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeRotationY( angle );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\trotateZ: function () {\n\n\t\t\t// rotate geometry around world z-axis\n\n\t\t\tvar m1;\n\n\t\t\treturn function rotateZ( angle ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeRotationZ( angle );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttranslate: function () {\n\n\t\t\t// translate geometry\n\n\t\t\tvar m1;\n\n\t\t\treturn function translate( x, y, z ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeTranslation( x, y, z );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tscale: function () {\n\n\t\t\t// scale geometry\n\n\t\t\tvar m1;\n\n\t\t\treturn function scale( x, y, z ) {\n\n\t\t\t\tif ( m1 === undefined ) m1 = new Matrix4();\n\n\t\t\t\tm1.makeScale( x, y, z );\n\n\t\t\t\tthis.applyMatrix( m1 );\n\n\t\t\t\treturn this;\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tlookAt: function () {\n\n\t\t\tvar obj;\n\n\t\t\treturn function lookAt( vector ) {\n\n\t\t\t\tif ( obj === undefined ) obj = new Object3D();\n\n\t\t\t\tobj.lookAt( vector );\n\n\t\t\t\tobj.updateMatrix();\n\n\t\t\t\tthis.applyMatrix( obj.matrix );\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tcenter: function () {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t\tvar offset = this.boundingBox.getCenter().negate();\n\n\t\t\tthis.translate( offset.x, offset.y, offset.z );\n\n\t\t\treturn offset;\n\n\t\t},\n\n\t\tsetFromObject: function ( object ) {\n\n\t\t\t// console.log( 'THREE.BufferGeometry.setFromObject(). Converting', object, this );\n\n\t\t\tvar geometry = object.geometry;\n\n\t\t\tif ( object.isPoints || object.isLine ) {\n\n\t\t\t\tvar positions = new Float32BufferAttribute( geometry.vertices.length * 3, 3 );\n\t\t\t\tvar colors = new Float32BufferAttribute( geometry.colors.length * 3, 3 );\n\n\t\t\t\tthis.addAttribute( 'position', positions.copyVector3sArray( geometry.vertices ) );\n\t\t\t\tthis.addAttribute( 'color', colors.copyColorsArray( geometry.colors ) );\n\n\t\t\t\tif ( geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length ) {\n\n\t\t\t\t\tvar lineDistances = new Float32BufferAttribute( geometry.lineDistances.length, 1 );\n\n\t\t\t\t\tthis.addAttribute( 'lineDistance', lineDistances.copyArray( geometry.lineDistances ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isMesh ) {\n\n\t\t\t\tif ( geometry && geometry.isGeometry ) {\n\n\t\t\t\t\tthis.fromGeometry( geometry );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tupdateFromObject: function ( object ) {\n\n\t\t\tvar geometry = object.geometry;\n\n\t\t\tif ( object.isMesh ) {\n\n\t\t\t\tvar direct = geometry.__directGeometry;\n\n\t\t\t\tif ( geometry.elementsNeedUpdate === true ) {\n\n\t\t\t\t\tdirect = undefined;\n\t\t\t\t\tgeometry.elementsNeedUpdate = false;\n\n\t\t\t\t}\n\n\t\t\t\tif ( direct === undefined ) {\n\n\t\t\t\t\treturn this.fromGeometry( geometry );\n\n\t\t\t\t}\n\n\t\t\t\tdirect.verticesNeedUpdate = geometry.verticesNeedUpdate;\n\t\t\t\tdirect.normalsNeedUpdate = geometry.normalsNeedUpdate;\n\t\t\t\tdirect.colorsNeedUpdate = geometry.colorsNeedUpdate;\n\t\t\t\tdirect.uvsNeedUpdate = geometry.uvsNeedUpdate;\n\t\t\t\tdirect.groupsNeedUpdate = geometry.groupsNeedUpdate;\n\n\t\t\t\tgeometry.verticesNeedUpdate = false;\n\t\t\t\tgeometry.normalsNeedUpdate = false;\n\t\t\t\tgeometry.colorsNeedUpdate = false;\n\t\t\t\tgeometry.uvsNeedUpdate = false;\n\t\t\t\tgeometry.groupsNeedUpdate = false;\n\n\t\t\t\tgeometry = direct;\n\n\t\t\t}\n\n\t\t\tvar attribute;\n\n\t\t\tif ( geometry.verticesNeedUpdate === true ) {\n\n\t\t\t\tattribute = this.attributes.position;\n\n\t\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\t\tattribute.copyVector3sArray( geometry.vertices );\n\t\t\t\t\tattribute.needsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.verticesNeedUpdate = false;\n\n\t\t\t}\n\n\t\t\tif ( geometry.normalsNeedUpdate === true ) {\n\n\t\t\t\tattribute = this.attributes.normal;\n\n\t\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\t\tattribute.copyVector3sArray( geometry.normals );\n\t\t\t\t\tattribute.needsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.normalsNeedUpdate = false;\n\n\t\t\t}\n\n\t\t\tif ( geometry.colorsNeedUpdate === true ) {\n\n\t\t\t\tattribute = this.attributes.color;\n\n\t\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\t\tattribute.copyColorsArray( geometry.colors );\n\t\t\t\t\tattribute.needsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.colorsNeedUpdate = false;\n\n\t\t\t}\n\n\t\t\tif ( geometry.uvsNeedUpdate ) {\n\n\t\t\t\tattribute = this.attributes.uv;\n\n\t\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\t\tattribute.copyVector2sArray( geometry.uvs );\n\t\t\t\t\tattribute.needsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.uvsNeedUpdate = false;\n\n\t\t\t}\n\n\t\t\tif ( geometry.lineDistancesNeedUpdate ) {\n\n\t\t\t\tattribute = this.attributes.lineDistance;\n\n\t\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\t\tattribute.copyArray( geometry.lineDistances );\n\t\t\t\t\tattribute.needsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.lineDistancesNeedUpdate = false;\n\n\t\t\t}\n\n\t\t\tif ( geometry.groupsNeedUpdate ) {\n\n\t\t\t\tgeometry.computeGroups( object.geometry );\n\t\t\t\tthis.groups = geometry.groups;\n\n\t\t\t\tgeometry.groupsNeedUpdate = false;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tfromGeometry: function ( geometry ) {\n\n\t\t\tgeometry.__directGeometry = new DirectGeometry().fromGeometry( geometry );\n\n\t\t\treturn this.fromDirectGeometry( geometry.__directGeometry );\n\n\t\t},\n\n\t\tfromDirectGeometry: function ( geometry ) {\n\n\t\t\tvar positions = new Float32Array( geometry.vertices.length * 3 );\n\t\t\tthis.addAttribute( 'position', new BufferAttribute( positions, 3 ).copyVector3sArray( geometry.vertices ) );\n\n\t\t\tif ( geometry.normals.length > 0 ) {\n\n\t\t\t\tvar normals = new Float32Array( geometry.normals.length * 3 );\n\t\t\t\tthis.addAttribute( 'normal', new BufferAttribute( normals, 3 ).copyVector3sArray( geometry.normals ) );\n\n\t\t\t}\n\n\t\t\tif ( geometry.colors.length > 0 ) {\n\n\t\t\t\tvar colors = new Float32Array( geometry.colors.length * 3 );\n\t\t\t\tthis.addAttribute( 'color', new BufferAttribute( colors, 3 ).copyColorsArray( geometry.colors ) );\n\n\t\t\t}\n\n\t\t\tif ( geometry.uvs.length > 0 ) {\n\n\t\t\t\tvar uvs = new Float32Array( geometry.uvs.length * 2 );\n\t\t\t\tthis.addAttribute( 'uv', new BufferAttribute( uvs, 2 ).copyVector2sArray( geometry.uvs ) );\n\n\t\t\t}\n\n\t\t\tif ( geometry.uvs2.length > 0 ) {\n\n\t\t\t\tvar uvs2 = new Float32Array( geometry.uvs2.length * 2 );\n\t\t\t\tthis.addAttribute( 'uv2', new BufferAttribute( uvs2, 2 ).copyVector2sArray( geometry.uvs2 ) );\n\n\t\t\t}\n\n\t\t\tif ( geometry.indices.length > 0 ) {\n\n\t\t\t\tvar TypeArray = geometry.vertices.length > 65535 ? Uint32Array : Uint16Array;\n\t\t\t\tvar indices = new TypeArray( geometry.indices.length * 3 );\n\t\t\t\tthis.setIndex( new BufferAttribute( indices, 1 ).copyIndicesArray( geometry.indices ) );\n\n\t\t\t}\n\n\t\t\t// groups\n\n\t\t\tthis.groups = geometry.groups;\n\n\t\t\t// morphs\n\n\t\t\tfor ( var name in geometry.morphTargets ) {\n\n\t\t\t\tvar array = [];\n\t\t\t\tvar morphTargets = geometry.morphTargets[ name ];\n\n\t\t\t\tfor ( var i = 0, l = morphTargets.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar morphTarget = morphTargets[ i ];\n\n\t\t\t\t\tvar attribute = new Float32BufferAttribute( morphTarget.length * 3, 3 );\n\n\t\t\t\t\tarray.push( attribute.copyVector3sArray( morphTarget ) );\n\n\t\t\t\t}\n\n\t\t\t\tthis.morphAttributes[ name ] = array;\n\n\t\t\t}\n\n\t\t\t// skinning\n\n\t\t\tif ( geometry.skinIndices.length > 0 ) {\n\n\t\t\t\tvar skinIndices = new Float32BufferAttribute( geometry.skinIndices.length * 4, 4 );\n\t\t\t\tthis.addAttribute( 'skinIndex', skinIndices.copyVector4sArray( geometry.skinIndices ) );\n\n\t\t\t}\n\n\t\t\tif ( geometry.skinWeights.length > 0 ) {\n\n\t\t\t\tvar skinWeights = new Float32BufferAttribute( geometry.skinWeights.length * 4, 4 );\n\t\t\t\tthis.addAttribute( 'skinWeight', skinWeights.copyVector4sArray( geometry.skinWeights ) );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t\t}\n\n\t\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcomputeBoundingBox: function () {\n\n\t\t\tif ( this.boundingBox === null ) {\n\n\t\t\t\tthis.boundingBox = new Box3();\n\n\t\t\t}\n\n\t\t\tvar position = this.attributes.position;\n\n\t\t\tif ( position !== undefined ) {\n\n\t\t\t\tthis.boundingBox.setFromBufferAttribute( position );\n\n\t\t\t} else {\n\n\t\t\t\tthis.boundingBox.makeEmpty();\n\n\t\t\t}\n\n\t\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t}\n\n\t\t},\n\n\t\tcomputeBoundingSphere: function () {\n\n\t\t\tvar box = new Box3();\n\t\t\tvar vector = new Vector3();\n\n\t\t\treturn function computeBoundingSphere() {\n\n\t\t\t\tif ( this.boundingSphere === null ) {\n\n\t\t\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t\t\t}\n\n\t\t\t\tvar position = this.attributes.position;\n\n\t\t\t\tif ( position ) {\n\n\t\t\t\t\tvar center = this.boundingSphere.center;\n\n\t\t\t\t\tbox.setFromBufferAttribute( position );\n\t\t\t\t\tbox.getCenter( center );\n\n\t\t\t\t\t// hoping to find a boundingSphere with a radius smaller than the\n\t\t\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\n\n\t\t\t\t\tvar maxRadiusSq = 0;\n\n\t\t\t\t\tfor ( var i = 0, il = position.count; i < il; i ++ ) {\n\n\t\t\t\t\t\tvector.x = position.getX( i );\n\t\t\t\t\t\tvector.y = position.getY( i );\n\t\t\t\t\t\tvector.z = position.getZ( i );\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}(),\n\n\t\tcomputeFaceNormals: function () {\n\n\t\t\t// backwards compatibility\n\n\t\t},\n\n\t\tcomputeVertexNormals: function () {\n\n\t\t\tvar index = this.index;\n\t\t\tvar attributes = this.attributes;\n\t\t\tvar groups = this.groups;\n\n\t\t\tif ( attributes.position ) {\n\n\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\tif ( attributes.normal === undefined ) {\n\n\t\t\t\t\tthis.addAttribute( 'normal', new BufferAttribute( new Float32Array( positions.length ), 3 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// reset existing normals to zero\n\n\t\t\t\t\tvar array = attributes.normal.array;\n\n\t\t\t\t\tfor ( var i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tarray[ i ] = 0;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvar normals = attributes.normal.array;\n\n\t\t\t\tvar vA, vB, vC;\n\t\t\t\tvar pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\n\t\t\t\tvar cb = new Vector3(), ab = new Vector3();\n\n\t\t\t\t// indexed elements\n\n\t\t\t\tif ( index ) {\n\n\t\t\t\t\tvar indices = index.array;\n\n\t\t\t\t\tif ( groups.length === 0 ) {\n\n\t\t\t\t\t\tthis.addGroup( 0, indices.length );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var j = 0, jl = groups.length; j < jl; ++ j ) {\n\n\t\t\t\t\t\tvar group = groups[ j ];\n\n\t\t\t\t\t\tvar start = group.start;\n\t\t\t\t\t\tvar count = group.count;\n\n\t\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\n\n\t\t\t\t\t\t\tvA = indices[ i + 0 ] * 3;\n\t\t\t\t\t\t\tvB = indices[ i + 1 ] * 3;\n\t\t\t\t\t\t\tvC = indices[ i + 2 ] * 3;\n\n\t\t\t\t\t\t\tpA.fromArray( positions, vA );\n\t\t\t\t\t\t\tpB.fromArray( positions, vB );\n\t\t\t\t\t\t\tpC.fromArray( positions, vC );\n\n\t\t\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\t\t\tnormals[ vA ] += cb.x;\n\t\t\t\t\t\t\tnormals[ vA + 1 ] += cb.y;\n\t\t\t\t\t\t\tnormals[ vA + 2 ] += cb.z;\n\n\t\t\t\t\t\t\tnormals[ vB ] += cb.x;\n\t\t\t\t\t\t\tnormals[ vB + 1 ] += cb.y;\n\t\t\t\t\t\t\tnormals[ vB + 2 ] += cb.z;\n\n\t\t\t\t\t\t\tnormals[ vC ] += cb.x;\n\t\t\t\t\t\t\tnormals[ vC + 1 ] += cb.y;\n\t\t\t\t\t\t\tnormals[ vC + 2 ] += cb.z;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// non-indexed elements (unconnected triangle soup)\n\n\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 9 ) {\n\n\t\t\t\t\t\tpA.fromArray( positions, i );\n\t\t\t\t\t\tpB.fromArray( positions, i + 3 );\n\t\t\t\t\t\tpC.fromArray( positions, i + 6 );\n\n\t\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\t\tnormals[ i ] = cb.x;\n\t\t\t\t\t\tnormals[ i + 1 ] = cb.y;\n\t\t\t\t\t\tnormals[ i + 2 ] = cb.z;\n\n\t\t\t\t\t\tnormals[ i + 3 ] = cb.x;\n\t\t\t\t\t\tnormals[ i + 4 ] = cb.y;\n\t\t\t\t\t\tnormals[ i + 5 ] = cb.z;\n\n\t\t\t\t\t\tnormals[ i + 6 ] = cb.x;\n\t\t\t\t\t\tnormals[ i + 7 ] = cb.y;\n\t\t\t\t\t\tnormals[ i + 8 ] = cb.z;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tthis.normalizeNormals();\n\n\t\t\t\tattributes.normal.needsUpdate = true;\n\n\t\t\t}\n\n\t\t},\n\n\t\tmerge: function ( geometry, offset ) {\n\n\t\t\tif ( ( geometry && geometry.isBufferGeometry ) === false ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tvar attributes = this.attributes;\n\n\t\t\tfor ( var key in attributes ) {\n\n\t\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\n\n\t\t\t\tvar attribute1 = attributes[ key ];\n\t\t\t\tvar attributeArray1 = attribute1.array;\n\n\t\t\t\tvar attribute2 = geometry.attributes[ key ];\n\t\t\t\tvar attributeArray2 = attribute2.array;\n\n\t\t\t\tvar attributeSize = attribute2.itemSize;\n\n\t\t\t\tfor ( var i = 0, j = attributeSize * offset; i < attributeArray2.length; i ++, j ++ ) {\n\n\t\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tnormalizeNormals: function () {\n\n\t\t\tvar normals = this.attributes.normal.array;\n\n\t\t\tvar x, y, z, n;\n\n\t\t\tfor ( var i = 0, il = normals.length; i < il; i += 3 ) {\n\n\t\t\t\tx = normals[ i ];\n\t\t\t\ty = normals[ i + 1 ];\n\t\t\t\tz = normals[ i + 2 ];\n\n\t\t\t\tn = 1.0 / Math.sqrt( x * x + y * y + z * z );\n\n\t\t\t\tnormals[ i ] *= n;\n\t\t\t\tnormals[ i + 1 ] *= n;\n\t\t\t\tnormals[ i + 2 ] *= n;\n\n\t\t\t}\n\n\t\t},\n\n\t\ttoNonIndexed: function () {\n\n\t\t\tif ( this.index === null ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.' );\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t\tvar geometry2 = new BufferGeometry();\n\n\t\t\tvar indices = this.index.array;\n\t\t\tvar attributes = this.attributes;\n\n\t\t\tfor ( var name in attributes ) {\n\n\t\t\t\tvar attribute = attributes[ name ];\n\n\t\t\t\tvar array = attribute.array;\n\t\t\t\tvar itemSize = attribute.itemSize;\n\n\t\t\t\tvar array2 = new array.constructor( indices.length * itemSize );\n\n\t\t\t\tvar index = 0, index2 = 0;\n\n\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\n\n\t\t\t\t\tindex = indices[ i ] * itemSize;\n\n\t\t\t\t\tfor ( var j = 0; j < itemSize; j ++ ) {\n\n\t\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgeometry2.addAttribute( name, new BufferAttribute( array2, itemSize ) );\n\n\t\t\t}\n\n\t\t\treturn geometry2;\n\n\t\t},\n\n\t\ttoJSON: function () {\n\n\t\t\tvar data = {\n\t\t\t\tmetadata: {\n\t\t\t\t\tversion: 4.4,\n\t\t\t\t\ttype: 'BufferGeometry',\n\t\t\t\t\tgenerator: 'BufferGeometry.toJSON'\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// standard BufferGeometry serialization\n\n\t\t\tdata.uuid = this.uuid;\n\t\t\tdata.type = this.type;\n\t\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\t\tif ( this.parameters !== undefined ) {\n\n\t\t\t\tvar parameters = this.parameters;\n\n\t\t\t\tfor ( var key in parameters ) {\n\n\t\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t\t}\n\n\t\t\t\treturn data;\n\n\t\t\t}\n\n\t\t\tdata.data = { attributes: {} };\n\n\t\t\tvar index = this.index;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tvar array = Array.prototype.slice.call( index.array );\n\n\t\t\t\tdata.data.index = {\n\t\t\t\t\ttype: index.array.constructor.name,\n\t\t\t\t\tarray: array\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tvar attributes = this.attributes;\n\n\t\t\tfor ( var key in attributes ) {\n\n\t\t\t\tvar attribute = attributes[ key ];\n\n\t\t\t\tvar array = Array.prototype.slice.call( attribute.array );\n\n\t\t\t\tdata.data.attributes[ key ] = {\n\t\t\t\t\titemSize: attribute.itemSize,\n\t\t\t\t\ttype: attribute.array.constructor.name,\n\t\t\t\t\tarray: array,\n\t\t\t\t\tnormalized: attribute.normalized\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tvar groups = this.groups;\n\n\t\t\tif ( groups.length > 0 ) {\n\n\t\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\n\n\t\t\t}\n\n\t\t\tvar boundingSphere = this.boundingSphere;\n\n\t\t\tif ( boundingSphere !== null ) {\n\n\t\t\t\tdata.data.boundingSphere = {\n\t\t\t\t\tcenter: boundingSphere.center.toArray(),\n\t\t\t\t\tradius: boundingSphere.radius\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\t/*\n\t\t\t// Handle primitives\n\n\t\t\tvar parameters = this.parameters;\n\n\t\t\tif ( parameters !== undefined ) {\n\n\t\t\t\tvar values = [];\n\n\t\t\t\tfor ( var key in parameters ) {\n\n\t\t\t\t\tvalues.push( parameters[ key ] );\n\n\t\t\t\t}\n\n\t\t\t\tvar geometry = Object.create( this.constructor.prototype );\n\t\t\t\tthis.constructor.apply( geometry, values );\n\t\t\t\treturn geometry;\n\n\t\t\t}\n\n\t\t\treturn new this.constructor().copy( this );\n\t\t\t*/\n\n\t\t\treturn new BufferGeometry().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( source ) {\n\n\t\t\tvar name, i, l;\n\n\t\t\t// reset\n\n\t\t\tthis.index = null;\n\t\t\tthis.attributes = {};\n\t\t\tthis.morphAttributes = {};\n\t\t\tthis.groups = [];\n\t\t\tthis.boundingBox = null;\n\t\t\tthis.boundingSphere = null;\n\n\t\t\t// name\n\n\t\t\tthis.name = source.name;\n\n\t\t\t// index\n\n\t\t\tvar index = source.index;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tthis.setIndex( index.clone() );\n\n\t\t\t}\n\n\t\t\t// attributes\n\n\t\t\tvar attributes = source.attributes;\n\n\t\t\tfor ( name in attributes ) {\n\n\t\t\t\tvar attribute = attributes[ name ];\n\t\t\t\tthis.addAttribute( name, attribute.clone() );\n\n\t\t\t}\n\n\t\t\t// morph attributes\n\n\t\t\tvar morphAttributes = source.morphAttributes;\n\n\t\t\tfor ( name in morphAttributes ) {\n\n\t\t\t\tvar array = [];\n\t\t\t\tvar morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\t\tfor ( i = 0, l = morphAttribute.length; i < l; i ++ ) {\n\n\t\t\t\t\tarray.push( morphAttribute[ i ].clone() );\n\n\t\t\t\t}\n\n\t\t\t\tthis.morphAttributes[ name ] = array;\n\n\t\t\t}\n\n\t\t\t// groups\n\n\t\t\tvar groups = source.groups;\n\n\t\t\tfor ( i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\t\tvar group = groups[ i ];\n\t\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t\t}\n\n\t\t\t// bounding box\n\n\t\t\tvar boundingBox = source.boundingBox;\n\n\t\t\tif ( boundingBox !== null ) {\n\n\t\t\t\tthis.boundingBox = boundingBox.clone();\n\n\t\t\t}\n\n\t\t\t// bounding sphere\n\n\t\t\tvar boundingSphere = source.boundingSphere;\n\n\t\t\tif ( boundingSphere !== null ) {\n\n\t\t\t\tthis.boundingSphere = boundingSphere.clone();\n\n\t\t\t}\n\n\t\t\t// draw range\n\n\t\t\tthis.drawRange.start = source.drawRange.start;\n\t\t\tthis.drawRange.count = source.drawRange.count;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdispose: function () {\n\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\t}\n\n\t};\n\n\tBufferGeometry.MaxIndex = 65535;\n\n\tObject.assign( BufferGeometry.prototype, EventDispatcher.prototype );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author jonobr1 / http://jonobr1.com/\n\t */\n\n\tfunction Mesh( geometry, material ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Mesh';\n\n\t\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\n\t\tthis.material = material !== undefined ? material : new MeshBasicMaterial( { color: Math.random() * 0xffffff } );\n\n\t\tthis.drawMode = TrianglesDrawMode;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tMesh.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: Mesh,\n\n\t\tisMesh: true,\n\n\t\tsetDrawMode: function ( value ) {\n\n\t\t\tthis.drawMode = value;\n\n\t\t},\n\n\t\tcopy: function ( source ) {\n\n\t\t\tObject3D.prototype.copy.call( this, source );\n\n\t\t\tthis.drawMode = source.drawMode;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tupdateMorphTargets: function () {\n\n\t\t\tvar morphTargets = this.geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( var m = 0, ml = morphTargets.length; m < ml; m ++ ) {\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ morphTargets[ m ].name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\traycast: ( function () {\n\n\t\t\tvar inverseMatrix = new Matrix4();\n\t\t\tvar ray = new Ray();\n\t\t\tvar sphere = new Sphere();\n\n\t\t\tvar vA = new Vector3();\n\t\t\tvar vB = new Vector3();\n\t\t\tvar vC = new Vector3();\n\n\t\t\tvar tempA = new Vector3();\n\t\t\tvar tempB = new Vector3();\n\t\t\tvar tempC = new Vector3();\n\n\t\t\tvar uvA = new Vector2();\n\t\t\tvar uvB = new Vector2();\n\t\t\tvar uvC = new Vector2();\n\n\t\t\tvar barycoord = new Vector3();\n\n\t\t\tvar intersectionPoint = new Vector3();\n\t\t\tvar intersectionPointWorld = new Vector3();\n\n\t\t\tfunction uvIntersection( point, p1, p2, p3, uv1, uv2, uv3 ) {\n\n\t\t\t\tTriangle.barycoordFromPoint( point, p1, p2, p3, barycoord );\n\n\t\t\t\tuv1.multiplyScalar( barycoord.x );\n\t\t\t\tuv2.multiplyScalar( barycoord.y );\n\t\t\t\tuv3.multiplyScalar( barycoord.z );\n\n\t\t\t\tuv1.add( uv2 ).add( uv3 );\n\n\t\t\t\treturn uv1.clone();\n\n\t\t\t}\n\n\t\t\tfunction checkIntersection( object, raycaster, ray, pA, pB, pC, point ) {\n\n\t\t\t\tvar intersect;\n\t\t\t\tvar material = object.material;\n\n\t\t\t\tif ( material.side === BackSide ) {\n\n\t\t\t\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== DoubleSide, point );\n\n\t\t\t\t}\n\n\t\t\t\tif ( intersect === null ) return null;\n\n\t\t\t\tintersectionPointWorld.copy( point );\n\t\t\t\tintersectionPointWorld.applyMatrix4( object.matrixWorld );\n\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\n\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\n\n\t\t\t\treturn {\n\t\t\t\t\tdistance: distance,\n\t\t\t\t\tpoint: intersectionPointWorld.clone(),\n\t\t\t\t\tobject: object\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tfunction checkBufferGeometryIntersection( object, raycaster, ray, position, uv, a, b, c ) {\n\n\t\t\t\tvA.fromBufferAttribute( position, a );\n\t\t\t\tvB.fromBufferAttribute( position, b );\n\t\t\t\tvC.fromBufferAttribute( position, c );\n\n\t\t\t\tvar intersection = checkIntersection( object, raycaster, ray, vA, vB, vC, intersectionPoint );\n\n\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\tif ( uv ) {\n\n\t\t\t\t\t\tuvA.fromBufferAttribute( uv, a );\n\t\t\t\t\t\tuvB.fromBufferAttribute( uv, b );\n\t\t\t\t\t\tuvC.fromBufferAttribute( uv, c );\n\n\t\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint,  vA, vB, vC, uvA, uvB, uvC );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tintersection.face = new Face3( a, b, c, Triangle.normal( vA, vB, vC ) );\n\t\t\t\t\tintersection.faceIndex = a;\n\n\t\t\t\t}\n\n\t\t\t\treturn intersection;\n\n\t\t\t}\n\n\t\t\treturn function raycast( raycaster, intersects ) {\n\n\t\t\t\tvar geometry = this.geometry;\n\t\t\t\tvar material = this.material;\n\t\t\t\tvar matrixWorld = this.matrixWorld;\n\n\t\t\t\tif ( material === undefined ) return;\n\n\t\t\t\t// Checking boundingSphere distance to ray\n\n\t\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t\t\tsphere.copy( geometry.boundingSphere );\n\t\t\t\tsphere.applyMatrix4( matrixWorld );\n\n\t\t\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\n\n\t\t\t\t//\n\n\t\t\t\tinverseMatrix.getInverse( matrixWorld );\n\t\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\n\n\t\t\t\t// Check boundingBox before continuing\n\n\t\t\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\t\t\tif ( ray.intersectsBox( geometry.boundingBox ) === false ) return;\n\n\t\t\t\t}\n\n\t\t\t\tvar intersection;\n\n\t\t\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t\t\tvar a, b, c;\n\t\t\t\t\tvar index = geometry.index;\n\t\t\t\t\tvar position = geometry.attributes.position;\n\t\t\t\t\tvar uv = geometry.attributes.uv;\n\t\t\t\t\tvar i, l;\n\n\t\t\t\t\tif ( index !== null ) {\n\n\t\t\t\t\t\t// indexed buffer geometry\n\n\t\t\t\t\t\tfor ( i = 0, l = index.count; i < l; i += 3 ) {\n\n\t\t\t\t\t\t\ta = index.getX( i );\n\t\t\t\t\t\t\tb = index.getX( i + 1 );\n\t\t\t\t\t\t\tc = index.getX( i + 2 );\n\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, position, uv, a, b, c );\n\n\t\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indices buffer semantics\n\t\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// non-indexed buffer geometry\n\n\t\t\t\t\t\tfor ( i = 0, l = position.count; i < l; i += 3 ) {\n\n\t\t\t\t\t\t\ta = i;\n\t\t\t\t\t\t\tb = i + 1;\n\t\t\t\t\t\t\tc = i + 2;\n\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, position, uv, a, b, c );\n\n\t\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\t\tintersection.index = a; // triangle number in positions buffer semantics\n\t\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\t\t\tvar fvA, fvB, fvC;\n\t\t\t\t\tvar isFaceMaterial = ( material && material.isMultiMaterial );\n\t\t\t\t\tvar materials = isFaceMaterial === true ? material.materials : null;\n\n\t\t\t\t\tvar vertices = geometry.vertices;\n\t\t\t\t\tvar faces = geometry.faces;\n\t\t\t\t\tvar uvs;\n\n\t\t\t\t\tvar faceVertexUvs = geometry.faceVertexUvs[ 0 ];\n\t\t\t\t\tif ( faceVertexUvs.length > 0 ) uvs = faceVertexUvs;\n\n\t\t\t\t\tfor ( var f = 0, fl = faces.length; f < fl; f ++ ) {\n\n\t\t\t\t\t\tvar face = faces[ f ];\n\t\t\t\t\t\tvar faceMaterial = isFaceMaterial === true ? materials[ face.materialIndex ] : material;\n\n\t\t\t\t\t\tif ( faceMaterial === undefined ) continue;\n\n\t\t\t\t\t\tfvA = vertices[ face.a ];\n\t\t\t\t\t\tfvB = vertices[ face.b ];\n\t\t\t\t\t\tfvC = vertices[ face.c ];\n\n\t\t\t\t\t\tif ( faceMaterial.morphTargets === true ) {\n\n\t\t\t\t\t\t\tvar morphTargets = geometry.morphTargets;\n\t\t\t\t\t\t\tvar morphInfluences = this.morphTargetInfluences;\n\n\t\t\t\t\t\t\tvA.set( 0, 0, 0 );\n\t\t\t\t\t\t\tvB.set( 0, 0, 0 );\n\t\t\t\t\t\t\tvC.set( 0, 0, 0 );\n\n\t\t\t\t\t\t\tfor ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {\n\n\t\t\t\t\t\t\t\tvar influence = morphInfluences[ t ];\n\n\t\t\t\t\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t\t\t\t\tvar targets = morphTargets[ t ].vertices;\n\n\t\t\t\t\t\t\t\tvA.addScaledVector( tempA.subVectors( targets[ face.a ], fvA ), influence );\n\t\t\t\t\t\t\t\tvB.addScaledVector( tempB.subVectors( targets[ face.b ], fvB ), influence );\n\t\t\t\t\t\t\t\tvC.addScaledVector( tempC.subVectors( targets[ face.c ], fvC ), influence );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvA.add( fvA );\n\t\t\t\t\t\t\tvB.add( fvB );\n\t\t\t\t\t\t\tvC.add( fvC );\n\n\t\t\t\t\t\t\tfvA = vA;\n\t\t\t\t\t\t\tfvB = vB;\n\t\t\t\t\t\t\tfvC = vC;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tintersection = checkIntersection( this, raycaster, ray, fvA, fvB, fvC, intersectionPoint );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tif ( uvs ) {\n\n\t\t\t\t\t\t\t\tvar uvs_f = uvs[ f ];\n\t\t\t\t\t\t\t\tuvA.copy( uvs_f[ 0 ] );\n\t\t\t\t\t\t\t\tuvB.copy( uvs_f[ 1 ] );\n\t\t\t\t\t\t\t\tuvC.copy( uvs_f[ 2 ] );\n\n\t\t\t\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint, fvA, fvB, fvC, uvA, uvB, uvC );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tintersection.face = face;\n\t\t\t\t\t\t\tintersection.faceIndex = f;\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}() ),\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction BoxBufferGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'BoxBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\tdepth: depth,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tdepthSegments: depthSegments\n\t\t};\n\n\t\tvar scope = this;\n\n\t\t// segments\n\t\twidthSegments = Math.floor( widthSegments ) || 1;\n\t\theightSegments = Math.floor( heightSegments ) || 1;\n\t\tdepthSegments = Math.floor( depthSegments ) || 1;\n\n\t\t// these are used to calculate buffer length\n\t\tvar vertexCount = calculateVertexCount( widthSegments, heightSegments, depthSegments );\n\t\tvar indexCount = calculateIndexCount( widthSegments, heightSegments, depthSegments );\n\n\t\t// buffers\n\t\tvar indices = new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount );\n\t\tvar vertices = new Float32Array( vertexCount * 3 );\n\t\tvar normals = new Float32Array( vertexCount * 3 );\n\t\tvar uvs = new Float32Array( vertexCount * 2 );\n\n\t\t// offset variables\n\t\tvar vertexBufferOffset = 0;\n\t\tvar uvBufferOffset = 0;\n\t\tvar indexBufferOffset = 0;\n\t\tvar numberOfVertices = 0;\n\n\t\t// group variables\n\t\tvar groupStart = 0;\n\n\t\t// build each side of the box geometry\n\t\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height,   width,  depthSegments, heightSegments, 0 ); // px\n\t\tbuildPlane( 'z', 'y', 'x',   1, - 1, depth, height, - width,  depthSegments, heightSegments, 1 ); // nx\n\t\tbuildPlane( 'x', 'z', 'y',   1,   1, width, depth,    height, widthSegments, depthSegments,  2 ); // py\n\t\tbuildPlane( 'x', 'z', 'y',   1, - 1, width, depth,  - height, widthSegments, depthSegments,  3 ); // ny\n\t\tbuildPlane( 'x', 'y', 'z',   1, - 1, width, height,   depth,  widthSegments, heightSegments, 4 ); // pz\n\t\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth,  widthSegments, heightSegments, 5 ); // nz\n\n\t\t// build geometry\n\t\tthis.setIndex( new BufferAttribute( indices, 1 ) );\n\t\tthis.addAttribute( 'position', new BufferAttribute( vertices, 3 ) );\n\t\tthis.addAttribute( 'normal', new BufferAttribute( normals, 3 ) );\n\t\tthis.addAttribute( 'uv', new BufferAttribute( uvs, 2 ) );\n\n\t\t// helper functions\n\n\t\tfunction calculateVertexCount( w, h, d ) {\n\n\t\t\tvar vertices = 0;\n\n\t\t\t// calculate the amount of vertices for each side (plane)\n\t\t\tvertices += (w + 1) * (h + 1) * 2; // xy\n\t\t\tvertices += (w + 1) * (d + 1) * 2; // xz\n\t\t\tvertices += (d + 1) * (h + 1) * 2; // zy\n\n\t\t\treturn vertices;\n\n\t\t}\n\n\t\tfunction calculateIndexCount( w, h, d ) {\n\n\t\t\tvar index = 0;\n\n\t\t\t// calculate the amount of squares for each side\n\t\t\tindex += w * h * 2; // xy\n\t\t\tindex += w * d * 2; // xz\n\t\t\tindex += d * h * 2; // zy\n\n\t\t\treturn index * 6; // two triangles per square => six vertices per square\n\n\t\t}\n\n\t\tfunction buildPlane( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\n\n\t\t\tvar segmentWidth\t= width / gridX;\n\t\t\tvar segmentHeight = height / gridY;\n\n\t\t\tvar widthHalf = width / 2;\n\t\t\tvar heightHalf = height / 2;\n\t\t\tvar depthHalf = depth / 2;\n\n\t\t\tvar gridX1 = gridX + 1;\n\t\t\tvar gridY1 = gridY + 1;\n\n\t\t\tvar vertexCounter = 0;\n\t\t\tvar groupCount = 0;\n\n\t\t\tvar vector = new Vector3();\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\t\tvar y = iy * segmentHeight - heightHalf;\n\n\t\t\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\t\tvar x = ix * segmentWidth - widthHalf;\n\n\t\t\t\t\t// set values to correct vector component\n\t\t\t\t\tvector[ u ] = x * udir;\n\t\t\t\t\tvector[ v ] = y * vdir;\n\t\t\t\t\tvector[ w ] = depthHalf;\n\n\t\t\t\t\t// now apply vector to vertex buffer\n\t\t\t\t\tvertices[ vertexBufferOffset ] = vector.x;\n\t\t\t\t\tvertices[ vertexBufferOffset + 1 ] = vector.y;\n\t\t\t\t\tvertices[ vertexBufferOffset + 2 ] = vector.z;\n\n\t\t\t\t\t// set values to correct vector component\n\t\t\t\t\tvector[ u ] = 0;\n\t\t\t\t\tvector[ v ] = 0;\n\t\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\n\n\t\t\t\t\t// now apply vector to normal buffer\n\t\t\t\t\tnormals[ vertexBufferOffset ] = vector.x;\n\t\t\t\t\tnormals[ vertexBufferOffset + 1 ] = vector.y;\n\t\t\t\t\tnormals[ vertexBufferOffset + 2 ] = vector.z;\n\n\t\t\t\t\t// uvs\n\t\t\t\t\tuvs[ uvBufferOffset ] = ix / gridX;\n\t\t\t\t\tuvs[ uvBufferOffset + 1 ] = 1 - ( iy / gridY );\n\n\t\t\t\t\t// update offsets and counters\n\t\t\t\t\tvertexBufferOffset += 3;\n\t\t\t\t\tuvBufferOffset += 2;\n\t\t\t\t\tvertexCounter += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// 1. you need three indices to draw a single face\n\t\t\t// 2. a single segment consists of two faces\n\t\t\t// 3. so we need to generate six (2*3) indices per segment\n\n\t\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\t\t// indices\n\t\t\t\t\tvar a = numberOfVertices + ix + gridX1 * iy;\n\t\t\t\t\tvar b = numberOfVertices + ix + gridX1 * ( iy + 1 );\n\t\t\t\t\tvar c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\t\tvar d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\t\t// face one\n\t\t\t\t\tindices[ indexBufferOffset ] = a;\n\t\t\t\t\tindices[ indexBufferOffset + 1 ] = b;\n\t\t\t\t\tindices[ indexBufferOffset + 2 ] = d;\n\n\t\t\t\t\t// face two\n\t\t\t\t\tindices[ indexBufferOffset + 3 ] = b;\n\t\t\t\t\tindices[ indexBufferOffset + 4 ] = c;\n\t\t\t\t\tindices[ indexBufferOffset + 5 ] = d;\n\n\t\t\t\t\t// update offsets and counters\n\t\t\t\t\tindexBufferOffset += 6;\n\t\t\t\t\tgroupCount += 6;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\t\t\tscope.addGroup( groupStart, groupCount, materialIndex );\n\n\t\t\t// calculate new start value for groups\n\t\t\tgroupStart += groupCount;\n\n\t\t\t// update total number of vertices\n\t\t\tnumberOfVertices += vertexCounter;\n\n\t\t}\n\n\t}\n\n\tBoxBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tBoxBufferGeometry.prototype.constructor = BoxBufferGeometry;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\n\t */\n\n\tfunction PlaneBufferGeometry( width, height, widthSegments, heightSegments ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'PlaneBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments\n\t\t};\n\n\t\tvar width_half = width / 2;\n\t\tvar height_half = height / 2;\n\n\t\tvar gridX = Math.floor( widthSegments ) || 1;\n\t\tvar gridY = Math.floor( heightSegments ) || 1;\n\n\t\tvar gridX1 = gridX + 1;\n\t\tvar gridY1 = gridY + 1;\n\n\t\tvar segment_width = width / gridX;\n\t\tvar segment_height = height / gridY;\n\n\t\tvar vertices = new Float32Array( gridX1 * gridY1 * 3 );\n\t\tvar normals = new Float32Array( gridX1 * gridY1 * 3 );\n\t\tvar uvs = new Float32Array( gridX1 * gridY1 * 2 );\n\n\t\tvar offset = 0;\n\t\tvar offset2 = 0;\n\n\t\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\tvar y = iy * segment_height - height_half;\n\n\t\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\tvar x = ix * segment_width - width_half;\n\n\t\t\t\tvertices[ offset ] = x;\n\t\t\t\tvertices[ offset + 1 ] = - y;\n\n\t\t\t\tnormals[ offset + 2 ] = 1;\n\n\t\t\t\tuvs[ offset2 ] = ix / gridX;\n\t\t\t\tuvs[ offset2 + 1 ] = 1 - ( iy / gridY );\n\n\t\t\t\toffset += 3;\n\t\t\t\toffset2 += 2;\n\n\t\t\t}\n\n\t\t}\n\n\t\toffset = 0;\n\n\t\tvar indices = new ( ( vertices.length / 3 ) > 65535 ? Uint32Array : Uint16Array )( gridX * gridY * 6 );\n\n\t\tfor ( var iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\tfor ( var ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\tvar a = ix + gridX1 * iy;\n\t\t\t\tvar b = ix + gridX1 * ( iy + 1 );\n\t\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\tindices[ offset ] = a;\n\t\t\t\tindices[ offset + 1 ] = b;\n\t\t\t\tindices[ offset + 2 ] = d;\n\n\t\t\t\tindices[ offset + 3 ] = b;\n\t\t\t\tindices[ offset + 4 ] = c;\n\t\t\t\tindices[ offset + 5 ] = d;\n\n\t\t\t\toffset += 6;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setIndex( new BufferAttribute( indices, 1 ) );\n\t\tthis.addAttribute( 'position', new BufferAttribute( vertices, 3 ) );\n\t\tthis.addAttribute( 'normal', new BufferAttribute( normals, 3 ) );\n\t\tthis.addAttribute( 'uv', new BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tPlaneBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tPlaneBufferGeometry.prototype.constructor = PlaneBufferGeometry;\n\n\t/**\n\t * @author Ben Houston / bhouston / http://clara.io\n\t *\n\t */\n\n\tfunction MaterialMap( name, uvChannel, uvTransform, texelTransform ) {\n\n\t  this.name = name || \"unnamed\";\n\n\t  this.texture = null;\n\n\t  this.uvChannel = uvChannel || 0;\n\n\t  this.uvTransform = uvTransform || false;\n\t  this.uvOffset = new Vector2( 0, 0 );\n\t  this.uvRepeat = new Vector2( 1.0, 1.0 );\n\t  //this.uvRotation = 0;  - not implemented because offset/repeat fix in a vec4 uniform, rotation doesn't.\n\n\t  this.texelTransform = uvTransform || false;\n\t  this.texelScale = 1.0;\n\t  this.texelOffset = 0.0;\n\t  this.texelInvert = false;\n\n\t}\n\n\tMaterialMap.prototype = {\n\n\t  constructor: MaterialMap,\n\n\t  copy: function ( source ) {\n\n\t    this.name = source.name;\n\n\t  \tthis.texture = source.texture;\n\n\t    this.uvChannel = source.uvChannel;\n\n\t    this.uvTransform = source.uvTransform;\n\t    this.uvOffset = source.uvOffset;\n\t    this.uvRepeat = source.uvRepeat;\n\t    //this.uvRotation = source.uvRotation;\n\n\t    this.texelTransform = source.texelTransform;\n\t    this.texelScale = source.texelScale;\n\t    this.texelOffset = source.texelOffset;\n\t    this.texelInvert = source.texelInvert;\n\n\t  \treturn this;\n\n\t  },\n\n\t  // bakes all the input texel parameters into just two.\n\t  getFlattenedTexelTransform: function( optionalTexelTransform ) {\n\t      var texelTransform = optionalTexelTransform || {};\n\t      if( this.texelInvert ) {\n\t        texelTransform.texelScale = -this.texelScale;\n\t        texelTransform.texelOffset = this.texelScale + this.texelOffset;\n\t      }\n\t      else {\n\t        texelTransform.texelScale = this.texelScale;\n\t        texelTransform.texelOffset = this.texelOffset;\n\t      }\n\t      return texelTransform;\n\t  }\n\n\t};\n\n\tMaterialMap.SupportedMapNames = [\n\t\t'map', 'lightMap', 'aoMap', 'emissiveMap', 'specularMap', 'bumpMap', 'normalMap', 'roughnessMap', 'metalnessMap', 'alphaMap', 'displacementMap', 'falloffMap', 'falloffAlphaMap'\n\t];\n\tMaterialMap.SupportedMapSlotNames = [];\n\tMaterialMap.SupportedMapUVNames = [];\n\tMaterialMap.SupportedMapTexelNames = [];\n\n\tfor( var i = 0; i < MaterialMap.SupportedMapNames.length; i ++ ) {\n\t  var name = MaterialMap.SupportedMapNames [i];\n\t  MaterialMap.SupportedMapSlotNames.push( name + 'Slot' );\n\t  MaterialMap.SupportedMapUVNames.push( name + 'UVTransformParams' );\n\t  MaterialMap.SupportedMapTexelNames.push( name + 'TexelTransformParams' );\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/\n\n\tfunction Camera() {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Camera';\n\n\t\tthis.matrixWorldInverse = new Matrix4();\n\t\tthis.projectionMatrix = new Matrix4();\n\n\t}\n\n\tCamera.prototype = Object.create( Object3D.prototype );\n\tCamera.prototype.constructor = Camera;\n\n\tCamera.prototype.isCamera = true;\n\n\tCamera.prototype.getWorldDirection = function () {\n\n\t\tvar quaternion = new Quaternion();\n\n\t\treturn function getWorldDirection( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new Vector3();\n\n\t\t\tthis.getWorldQuaternion( quaternion );\n\n\t\t\treturn result.set( 0, 0, - 1 ).applyQuaternion( quaternion );\n\n\t\t};\n\n\t}();\n\n\tCamera.prototype.lookAt = function () {\n\n\t\t// This routine does not support cameras with rotated and/or translated parent(s)\n\n\t\tvar m1 = new Matrix4();\n\n\t\treturn function lookAt( vector ) {\n\n\t\t\tm1.lookAt( this.position, vector, this.up );\n\n\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\n\n\t\t};\n\n\t}();\n\n\tCamera.prototype.clone = function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t};\n\n\tCamera.prototype.copy = function ( source ) {\n\n\t\tObject3D.prototype.copy.call( this, source );\n\n\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\n\t\tthis.projectionMatrix.copy( source.projectionMatrix );\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author greggman / http://games.greggman.com/\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * @author tschw\n\t */\n\n\tfunction PerspectiveCamera( fov, aspect, near, far ) {\n\n\t\tCamera.call( this );\n\n\t\tthis.type = 'PerspectiveCamera';\n\n\t\tthis.fov = fov !== undefined ? fov : 50;\n\t\tthis.zoom = 1;\n\n\t\tthis.near = near !== undefined ? near : 0.1;\n\t\tthis.far = far !== undefined ? far : 2000;\n\t\tthis.focus = 10;\n\n\t\tthis.aspect = aspect !== undefined ? aspect : 1;\n\t\tthis.view = null;\n\n\t\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\n\t\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tPerspectiveCamera.prototype = Object.assign( Object.create( Camera.prototype ), {\n\n\t\tconstructor: PerspectiveCamera,\n\n\t\tisPerspectiveCamera: true,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tCamera.prototype.copy.call( this, source );\n\n\t\t\tthis.fov = source.fov;\n\t\t\tthis.zoom = source.zoom;\n\n\t\t\tthis.near = source.near;\n\t\t\tthis.far = source.far;\n\t\t\tthis.focus = source.focus;\n\n\t\t\tthis.aspect = source.aspect;\n\t\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\t\tthis.filmGauge = source.filmGauge;\n\t\t\tthis.filmOffset = source.filmOffset;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t/**\n\t\t * Sets the FOV by focal length in respect to the current .filmGauge.\n\t\t *\n\t\t * The default film gauge is 35, so that the focal length can be specified for\n\t\t * a 35mm (full frame) camera.\n\t\t *\n\t\t * Values for focal length and film gauge must have the same unit.\n\t\t */\n\t\tsetFocalLength: function ( focalLength ) {\n\n\t\t\t// see http://www.bobatkins.com/photography/technical/field_of_view.html\n\t\t\tvar vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\n\n\t\t\tthis.fov = _Math.RAD2DEG * 2 * Math.atan( vExtentSlope );\n\t\t\tthis.updateProjectionMatrix();\n\n\t\t},\n\n\t\t/**\n\t\t * Calculates the focal length from the current .fov and .filmGauge.\n\t\t */\n\t\tgetFocalLength: function () {\n\n\t\t\tvar vExtentSlope = Math.tan( _Math.DEG2RAD * 0.5 * this.fov );\n\n\t\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\n\n\t\t},\n\n\t\tgetEffectiveFOV: function () {\n\n\t\t\treturn _Math.RAD2DEG * 2 * Math.atan(\n\t\t\t\t\tMath.tan( _Math.DEG2RAD * 0.5 * this.fov ) / this.zoom );\n\n\t\t},\n\n\t\tgetFilmWidth: function () {\n\n\t\t\t// film not completely covered in portrait format (aspect < 1)\n\t\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\n\n\t\t},\n\n\t\tgetFilmHeight: function () {\n\n\t\t\t// film not completely covered in landscape format (aspect > 1)\n\t\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\n\n\t\t},\n\n\t\t/**\n\t\t * Sets an offset in a larger frustum. This is useful for multi-window or\n\t\t * multi-monitor/multi-machine setups.\n\t\t *\n\t\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\n\t\t * the monitors are in grid like this\n\t\t *\n\t\t *   +---+---+---+\n\t\t *   | A | B | C |\n\t\t *   +---+---+---+\n\t\t *   | D | E | F |\n\t\t *   +---+---+---+\n\t\t *\n\t\t * then for each monitor you would call it like this\n\t\t *\n\t\t *   var w = 1920;\n\t\t *   var h = 1080;\n\t\t *   var fullWidth = w * 3;\n\t\t *   var fullHeight = h * 2;\n\t\t *\n\t\t *   --A--\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\n\t\t *   --B--\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\n\t\t *   --C--\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\n\t\t *   --D--\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\n\t\t *   --E--\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\n\t\t *   --F--\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\n\t\t *\n\t\t *   Note there is no reason monitors have to be the same size or in a grid.\n\t\t */\n\t\tsetViewOffset: function ( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\t\tif( ! fullWidth ) {\n\t\t\t\tthis.view = null;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.aspect = fullWidth / fullHeight;\n\n\t\t\tthis.view = {\n\t\t\t\tfullWidth: fullWidth,\n\t\t\t\tfullHeight: fullHeight,\n\t\t\t\toffsetX: x,\n\t\t\t\toffsetY: y,\n\t\t\t\twidth: width,\n\t\t\t\theight: height\n\t\t\t};\n\n\t\t\tthis.updateProjectionMatrix();\n\n\t\t},\n\n\t\tclearViewOffset: function() {\n\n\t\t\tthis.view = null;\n\t\t\tthis.updateProjectionMatrix();\n\n\t\t},\n\n\t\tupdateProjectionMatrix: function () {\n\n\t\t\tvar near = this.near,\n\t\t\t\ttop = near * Math.tan(\n\t\t\t\t\t\t_Math.DEG2RAD * 0.5 * this.fov ) / this.zoom,\n\t\t\t\theight = 2 * top,\n\t\t\t\twidth = this.aspect * height,\n\t\t\t\tleft = - 0.5 * width,\n\t\t\t\tview = this.view;\n\n\t\t\tif ( view !== null ) {\n\n\t\t\t\tvar fullWidth = view.fullWidth,\n\t\t\t\t\tfullHeight = view.fullHeight;\n\n\t\t\t\tleft += view.offsetX * width / fullWidth;\n\t\t\t\ttop -= view.offsetY * height / fullHeight;\n\t\t\t\twidth *= view.width / fullWidth;\n\t\t\t\theight *= view.height / fullHeight;\n\n\t\t\t}\n\n\t\t\tvar skew = this.filmOffset;\n\t\t\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\n\n\t\t\tthis.projectionMatrix.makePerspective( left, left + width, top, top - height, near, this.far );\n\n\t\t},\n\n\t\ttoJSON: function ( meta ) {\n\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\n\n\t\t\tdata.object.fov = this.fov;\n\t\t\tdata.object.zoom = this.zoom;\n\n\t\t\tdata.object.near = this.near;\n\t\t\tdata.object.far = this.far;\n\t\t\tdata.object.focus = this.focus;\n\n\t\t\tdata.object.aspect = this.aspect;\n\n\t\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\t\tdata.object.filmGauge = this.filmGauge;\n\t\t\tdata.object.filmOffset = this.filmOffset;\n\n\t\t\treturn data;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author arose / http://github.com/arose\n\t */\n\n\tfunction OrthographicCamera( left, right, top, bottom, near, far ) {\n\n\t\tCamera.call( this );\n\n\t\tthis.type = 'OrthographicCamera';\n\n\t\tthis.zoom = 1;\n\t\tthis.view = null;\n\n\t\tthis.left = left;\n\t\tthis.right = right;\n\t\tthis.top = top;\n\t\tthis.bottom = bottom;\n\n\t\tthis.near = ( near !== undefined ) ? near : 0.1;\n\t\tthis.far = ( far !== undefined ) ? far : 2000;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tOrthographicCamera.prototype = Object.assign( Object.create( Camera.prototype ), {\n\n\t\tconstructor: OrthographicCamera,\n\n\t\tisOrthographicCamera: true,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tCamera.prototype.copy.call( this, source );\n\n\t\t\tthis.left = source.left;\n\t\t\tthis.right = source.right;\n\t\t\tthis.top = source.top;\n\t\t\tthis.bottom = source.bottom;\n\t\t\tthis.near = source.near;\n\t\t\tthis.far = source.far;\n\n\t\t\tthis.zoom = source.zoom;\n\t\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetViewOffset: function( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\t\tthis.view = {\n\t\t\t\tfullWidth: fullWidth,\n\t\t\t\tfullHeight: fullHeight,\n\t\t\t\toffsetX: x,\n\t\t\t\toffsetY: y,\n\t\t\t\twidth: width,\n\t\t\t\theight: height\n\t\t\t};\n\n\t\t\tthis.updateProjectionMatrix();\n\n\t\t},\n\n\t\tclearViewOffset: function() {\n\n\t\t\tthis.view = null;\n\t\t\tthis.updateProjectionMatrix();\n\n\t\t},\n\n\t\tupdateProjectionMatrix: function () {\n\n\t\t\tvar dx = ( this.right - this.left ) / ( 2 * this.zoom );\n\t\t\tvar dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\n\t\t\tvar cx = ( this.right + this.left ) / 2;\n\t\t\tvar cy = ( this.top + this.bottom ) / 2;\n\n\t\t\tvar left = cx - dx;\n\t\t\tvar right = cx + dx;\n\t\t\tvar top = cy + dy;\n\t\t\tvar bottom = cy - dy;\n\n\t\t\tif ( this.view !== null ) {\n\n\t\t\t\tvar zoomW = this.zoom / ( this.view.width / this.view.fullWidth );\n\t\t\t\tvar zoomH = this.zoom / ( this.view.height / this.view.fullHeight );\n\t\t\t\tvar scaleW = ( this.right - this.left ) / this.view.width;\n\t\t\t\tvar scaleH = ( this.top - this.bottom ) / this.view.height;\n\n\t\t\t\tleft += scaleW * ( this.view.offsetX / zoomW );\n\t\t\t\tright = left + scaleW * ( this.view.width / zoomW );\n\t\t\t\ttop -= scaleH * ( this.view.offsetY / zoomH );\n\t\t\t\tbottom = top - scaleH * ( this.view.height / zoomH );\n\n\t\t\t}\n\n\t\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far );\n\n\t\t},\n\n\t\ttoJSON: function ( meta ) {\n\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\n\n\t\t\tdata.object.zoom = this.zoom;\n\t\t\tdata.object.left = this.left;\n\t\t\tdata.object.right = this.right;\n\t\t\tdata.object.top = this.top;\n\t\t\tdata.object.bottom = this.bottom;\n\t\t\tdata.object.near = this.near;\n\t\t\tdata.object.far = this.far;\n\n\t\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\t\treturn data;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLIndexedBufferRenderer( gl, extensions, infoRender ) {\n\n\t\tvar mode;\n\n\t\tfunction setMode( value ) {\n\n\t\t\tmode = value;\n\n\t\t}\n\n\t\tvar type, size;\n\n\t\tfunction setIndex( index ) {\n\n\t\t\tif ( index.array instanceof Uint32Array && extensions.get( 'OES_element_index_uint' ) ) {\n\n\t\t\t\ttype = gl.UNSIGNED_INT;\n\t\t\t\tsize = 4;\n\n\t\t\t} else if ( index.array instanceof Uint16Array ) {\n\n\t\t\t\ttype = gl.UNSIGNED_SHORT;\n\t\t\t\tsize = 2;\n\n\t\t\t} else {\n\n\t\t\t\ttype = gl.UNSIGNED_BYTE;\n\t\t\t\tsize = 1;\n\t\t\t}\n\n\t\t}\n\n\t\tfunction render( start, count ) {\n\n\t\t\tgl.drawElements( mode, count, type, start * size );\n\n\t\t\tinfoRender.calls ++;\n\t\t\tinfoRender.vertices += count;\n\n\t\t\tif ( mode === gl.TRIANGLES ) infoRender.faces += count / 3;\n\n\t\t}\n\n\t\tfunction renderInstances( geometry, start, count ) {\n\n\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\textension.drawElementsInstancedANGLE( mode, count, type, start * size, geometry.maxInstancedCount );\n\n\t\t\tinfoRender.calls ++;\n\t\t\tinfoRender.vertices += count * geometry.maxInstancedCount;\n\n\t\t\tif ( mode === gl.TRIANGLES ) infoRender.faces += geometry.maxInstancedCount * count / 3;\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tsetMode: setMode,\n\t\t\tsetIndex: setIndex,\n\t\t\trender: render,\n\t\t\trenderInstances: renderInstances\n\n\t\t};\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLBufferRenderer( gl, extensions, infoRender ) {\n\n\t\tvar mode;\n\n\t\tfunction setMode( value ) {\n\n\t\t\tmode = value;\n\n\t\t}\n\n\t\tfunction render( start, count ) {\n\n\t\t\tgl.drawArrays( mode, start, count );\n\n\t\t\tinfoRender.calls ++;\n\t\t\tinfoRender.vertices += count;\n\n\t\t\tif ( mode === gl.TRIANGLES ) infoRender.faces += count / 3;\n\n\t\t}\n\n\t\tfunction renderInstances( geometry ) {\n\n\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tvar position = geometry.attributes.position;\n\n\t\t\tvar count = 0;\n\n\t\t\tif ( position.isInterleavedBufferAttribute ) {\n\n\t\t\t\tcount = position.data.count;\n\n\t\t\t\textension.drawArraysInstancedANGLE( mode, 0, count, geometry.maxInstancedCount );\n\n\t\t\t} else {\n\n\t\t\t\tcount = position.count;\n\n\t\t\t\textension.drawArraysInstancedANGLE( mode, 0, count, geometry.maxInstancedCount );\n\n\t\t\t}\n\n\t\t\tinfoRender.calls ++;\n\t\t\tinfoRender.vertices += count * geometry.maxInstancedCount;\n\n\t\t\tif ( mode === gl.TRIANGLES ) infoRender.faces += geometry.maxInstancedCount * count / 3;\n\n\t\t}\n\n\t\treturn {\n\t\t\tsetMode: setMode,\n\t\t\trender: render,\n\t\t\trenderInstances: renderInstances\n\t\t};\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLLights() {\n\n\t\tvar lights = {};\n\n\t\treturn {\n\n\t\t\tget: function ( light ) {\n\n\t\t\t\tif ( lights[ light.id ] !== undefined ) {\n\n\t\t\t\t\treturn lights[ light.id ];\n\n\t\t\t\t}\n\n\t\t\t\tvar uniforms;\n\n\t\t\t\tswitch ( light.type ) {\n\n\t\t\t\t\tcase 'DirectionalLight':\n\t\t\t\t\t\tconsole.warn( \"ShadowSpreadAngle initilized but may not match other names used.\");\n\t\t\t\t\t\tuniforms = {\n\t\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\t\tcolor: new Color(),\n\n\t\t\t\t\t\t\tshadow: false,\n\t\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\t\tshadowSpreadAngle: 0,\n\t\t\t\t\t\t\tshadowMapSize: new Vector2(),\n\t\t\t\t\t\t\tshadowCameraParams: new Vector3()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'SpotLight':\n\t\t\t\t\t\tconsole.warn( \"shadowCameraFovNearFar and shadowCameraParams are both initilized but may not match other names used.\");\n\t\t\t\t\t\tuniforms = {\n\t\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\t\tdistance: 0,\n\t\t\t\t\t\t\tconeCos: 0,\n\t\t\t\t\t\t\tpenumbraCos: 0,\n\t\t\t\t\t\t\tdecay: 0,\n\n\t\t\t\t\t\t\tshadow: false,\n\t\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\t\tshadowMapSize: new Vector2(),\n\t\t\t\t\t\t\tshadowCameraFovNearFar: new Vector3(),\n\t\t\t\t\t\t\tshadowCameraParams: new Vector3()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'PointLight':\n\t\t\t\t\t\tuniforms = {\n\t\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\t\tdistance: 0,\n\t\t\t\t\t\t\tdecay: 0,\n\n\t\t\t\t\t\t\tshadow: false,\n\t\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\t\tshadowMapSize: new Vector2()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'HemisphereLight':\n\t\t\t\t\t\tuniforms = {\n\t\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\t\tskyColor: new Color(),\n\t\t\t\t\t\t\tgroundColor: new Color()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'RectAreaLight':\n\t\t\t\t\t\tuniforms = {\n\t\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\t\thalfWidth: new Vector3(),\n\t\t\t\t\t\t\thalfHeight: new Vector3()\n\t\t\t\t\t\t\t// TODO (abelnation): set RectAreaLight shadow uniforms\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tlights[ light.id ] = uniforms;\n\n\t\t\t\treturn uniforms;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction addLineNumbers( string ) {\n\n\t\tvar lines = string.split( '\\n' );\n\n\t\tfor ( var i = 0; i < lines.length; i ++ ) {\n\n\t\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\n\n\t\t}\n\n\t\treturn lines.join( '\\n' );\n\n\t}\n\n\tfunction WebGLShader( gl, type, string ) {\n\n\t\tvar shader = gl.createShader( type );\n\n\t\tgl.shaderSource( shader, string );\n\t\tgl.compileShader( shader );\n\n\t\tif ( gl.getShaderParameter( shader, gl.COMPILE_STATUS ) === false ) {\n\n\t\t\tconsole.error( 'THREE.WebGLShader: Shader couldn\\'t compile.', gl.getShaderInfoLog( shader ), addLineNumbers( string ) );\n\n\t\t}\n\n\t\tif ( gl.getShaderInfoLog( shader ) !== '' ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLShader: gl.getShaderInfoLog()', type === gl.VERTEX_SHADER ? 'vertex' : 'fragment', gl.getShaderInfoLog( shader ), addLineNumbers( string ) );\n\n\t\t}\n\n\t\t// --enable-privileged-webgl-extension\n\t\t// console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\n\n\t\treturn shader;\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tvar programIdCount = 0;\n\n\tfunction getEncodingComponents( encoding ) {\n\n\t\tswitch ( encoding ) {\n\n\t\t\tcase LinearEncoding:\n\t\t\t\treturn [ 'Linear','( value )' ];\n\t\t\tcase sRGBEncoding:\n\t\t\t\treturn [ 'sRGB','( value )' ];\n\t\t\tcase RGBEEncoding:\n\t\t\t\treturn [ 'RGBE','( value )' ];\n\t\t\tcase RGBM7Encoding:\n\t\t\t\treturn [ 'RGBM','( value, 7.0 )' ];\n\t\t\tcase RGBM16Encoding:\n\t\t\t\treturn [ 'RGBM','( value, 16.0 )' ];\n\t\t\tcase RGBDEncoding:\n\t\t\t\treturn [ 'RGBD','( value, 256.0 )' ];\n\t\t\tcase GammaEncoding:\n\t\t\t\treturn [ 'Gamma','( value, float( GAMMA_FACTOR ) )' ];\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'unsupported encoding: ' + encoding );\n\n\t\t}\n\n\t}\n\n\tfunction getTexelDecodingFunction( functionName, encoding ) {\n\n\t\tvar components = getEncodingComponents( encoding );\n\t\treturn \"vec4 \" + functionName + \"( vec4 value ) { return \" + components[ 0 ] + \"ToLinear\" + components[ 1 ] + \"; }\";\n\n\t}\n\n\tfunction getTexelEncodingFunction( functionName, encoding ) {\n\n\t\tvar components = getEncodingComponents( encoding );\n\t\treturn \"vec4 \" + functionName + \"( vec4 value ) { return LinearTo\" + components[ 0 ] + components[ 1 ] + \"; }\";\n\n\t}\n\n\tfunction getTexelTransformFunction( mapName, map ) {\n\n\t\tif( ! map || ! map.texelTransform ) {\n\t\t\treturn \"vec4 \" + mapName + \"TexelTransform( vec4 value ) { return value; }\\n\";\n\t\t}\n\n\t\tvar transform = map.getFlattenedTexelTransform();\n\t\tvar template = ShaderChunk[ 'slot_texel_transform_template' ];\n\t\tvar result = template.replace( /\\$SLOT_NAME\\$/g, mapName );\n\t\treturn result;\n\n\t}\n\n\tfunction getUVFunction( mapName, map, isVertexShader ) {\n\n\t\tvar uvVariableName = ( isVertexShader ) ? \"uv\" : \"vUv\";\n\t\tif( map && map.uvChannel > 0 ) {\n\t\t\tuvVariableName += ( map.uvChannel + 1 );\n\t\t}\n\n\t\tif( ! map || ! map.uvTransform ) {\n\t\t\treturn \"vec2 \" + mapName + \"UV() { return \" + uvVariableName + \"; }\\n\";\n\t\t}\n\n\t\tvar transform = map.getFlattenedTexelTransform();\n\t\tvar template = ShaderChunk[ 'slot_uv_transform_template' ];\n\t\tvar result = template.replace( /\\$SLOT_NAME\\$/g, mapName );\n\t\tresult = result.replace( /\\$UV_VAR_NAME\\$/g, uvVariableName );\n\t\treturn result;\n\n\t}\n\n\tfunction getToneMappingFunction( functionName, toneMapping ) {\n\n\t\tvar toneMappingName;\n\n\t\tswitch ( toneMapping ) {\n\n\t\t\tcase LinearToneMapping:\n\t\t\t\ttoneMappingName = \"Linear\";\n\t\t\t\tbreak;\n\n\t\t\tcase ReinhardToneMapping:\n\t\t\t\ttoneMappingName = \"Reinhard\";\n\t\t\t\tbreak;\n\n\t\t\tcase Uncharted2ToneMapping:\n\t\t\t\ttoneMappingName = \"Uncharted2\";\n\t\t\t\tbreak;\n\n\t\t\tcase CineonToneMapping:\n\t\t\t\ttoneMappingName = \"OptimizedCineon\";\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'unsupported toneMapping: ' + toneMapping );\n\n\t\t}\n\n\t\treturn \"vec3 \" + functionName + \"( vec3 color ) { return \" + toneMappingName + \"ToneMapping( color ); }\";\n\n\t}\n\n\tfunction generateExtensions( extensions, parameters, rendererExtensions ) {\n\n\t\textensions = extensions || {};\n\n\t\tvar chunks = [\n\t\t\t( extensions.derivatives || parameters.envMapCubeUV || parameters.bumpMap || parameters.normalMap || parameters.flatShading ) ? '#extension GL_OES_standard_derivatives : enable' : '',\n\t\t\t( extensions.fragDepth || parameters.logarithmicDepthBuffer ) && rendererExtensions.get( 'EXT_frag_depth' ) ? '#extension GL_EXT_frag_depth : enable' : '',\n\t\t\t( extensions.drawBuffers ) && rendererExtensions.get( 'WEBGL_draw_buffers' ) ? '#extension GL_EXT_draw_buffers : require' : '',\n\t\t\t( extensions.shaderTextureLOD || parameters.envMap ) && rendererExtensions.get( 'EXT_shader_texture_lod' ) ? '#extension GL_EXT_shader_texture_lod : enable' : ''\n\t\t];\n\n\t\treturn chunks.filter( filterEmptyLine ).join( '\\n' );\n\n\t}\n\n\tfunction generateDefines( defines ) {\n\n\t\tvar chunks = [];\n\n\t\tfor ( var name in defines ) {\n\n\t\t\tvar value = defines[ name ];\n\n\t\t\tif ( value === false ) continue;\n\n\t\t\tchunks.push( '#define ' + name + ' ' + value );\n\n\t\t}\n\n\t\treturn chunks.join( '\\n' );\n\n\t}\n\n\tfunction fetchAttributeLocations( gl, program, identifiers ) {\n\n\t\tvar attributes = {};\n\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_ATTRIBUTES );\n\n\t\tfor ( var i = 0; i < n; i ++ ) {\n\n\t\t\tvar info = gl.getActiveAttrib( program, i );\n\t\t\tvar name = info.name;\n\n\t\t\t// console.log(\"THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:\", name, i );\n\n\t\t\tattributes[ name ] = gl.getAttribLocation( program, name );\n\n\t\t}\n\n\t\treturn attributes;\n\n\t}\n\n\tfunction filterEmptyLine( string ) {\n\n\t\treturn string !== '';\n\n\t}\n\n\tfunction replaceLightNums( string, parameters ) {\n\n\t\treturn string\n\t\t\t.replace( /NUM_DIR_LIGHTS/g, parameters.numDirLights )\n\t\t\t.replace( /NUM_SPOT_LIGHTS/g, parameters.numSpotLights )\n\t\t\t.replace( /NUM_RECT_AREA_LIGHTS/g, parameters.numRectAreaLights )\n\t\t\t.replace( /NUM_POINT_LIGHTS/g, parameters.numPointLights )\n\t\t\t.replace( /NUM_HEMI_LIGHTS/g, parameters.numHemiLights );\n\n\t}\n\n\tfunction parseIncludes( string ) {\n\n\t\tvar pattern = /#include +<([\\w\\d.]+)>/g;\n\n\t\tfunction replace( match, include ) {\n\n\t\t\tvar replace = ShaderChunk[ include ];\n\n\t\t\tif ( replace === undefined ) {\n\n\t\t\t\tthrow new Error( 'Can not resolve #include <' + include + '>' );\n\n\t\t\t}\n\n\t\t\treturn parseIncludes( replace );\n\n\t\t}\n\n\t\treturn string.replace( pattern, replace );\n\n\t}\n\n\tfunction unrollLoops( string ) {\n\n\t\tvar pattern = /for \\( int i \\= (\\d+)\\; i < (\\d+)\\; i \\+\\+ \\) \\{([\\s\\S]+?)(?=\\})\\}/g;\n\n\t\tfunction replace( match, start, end, snippet ) {\n\n\t\t\tvar unroll = '';\n\n\t\t\tfor ( var i = parseInt( start ); i < parseInt( end ); i ++ ) {\n\n\t\t\t\tunroll += snippet.replace( /\\[ i \\]/g, '[ ' + i + ' ]' );\n\n\t\t\t}\n\n\t\t\treturn unroll;\n\n\t\t}\n\n\t\treturn string.replace( pattern, replace );\n\n\t}\n\n\tfunction WebGLProgram( renderer, code, material, parameters ) {\n\n\t\tvar gl = renderer.context;\n\n\t\tvar extensions = material.extensions;\n\t\tvar defines = material.defines;\n\n\t\tvar vertexShader = material.__webglShader.vertexShader;\n\t\tvar fragmentShader = material.__webglShader.fragmentShader;\n\n\t\tvar shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\n\n\t\tif ( parameters.shadowMapType === PCFShadowMap ) {\n\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\n\n\t\t} else if ( parameters.shadowMapType === PCSSSoftShadowMap ) {\n\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCSS';\n\n\t\t} else if ( parameters.shadowMapType === PCFSoftShadowMap ) {\n\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\n\n\t\t}\n\n\t\tvar envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\t\tvar envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\n\t\tvar envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\n\n\t\tif ( parameters.envMap ) {\n\n\t\t\tswitch ( material.envMap.mapping ) {\n\n\t\t\t\tcase CubeReflectionMapping:\n\t\t\t\tcase CubeRefractionMapping:\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CubeUVReflectionMapping:\n\t\t\t\tcase CubeUVRefractionMapping:\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE_UV';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase EquirectangularReflectionMapping:\n\t\t\t\tcase EquirectangularRefractionMapping:\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase SphericalReflectionMapping:\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tswitch ( material.envMap.mapping ) {\n\n\t\t\t\tcase CubeRefractionMapping:\n\t\t\t\tcase EquirectangularRefractionMapping:\n\t\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tswitch ( material.combine ) {\n\n\t\t\t\tcase MultiplyOperation:\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MixOperation:\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AddOperation:\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\n\n\t\t// console.log( 'building new program ' );\n\n\t\t//\n\n\t\tvar customExtensions = generateExtensions( extensions, parameters, renderer.extensions );\n\n\t\tvar customDefines = generateDefines( defines );\n\n\t\t//\n\n\t\tvar program = gl.createProgram();\n\n\t\tvar prefixVertex, prefixFragment;\n\n\t\tif ( material.isRawShaderMaterial ) {\n\n\t\t\tprefixVertex = [\n\n\t\t\t\tcustomDefines,\n\n\t\t\t\t'\\n'\n\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\t\tprefixFragment = [\n\n\t\t\t\tcustomExtensions,\n\t\t\t\tcustomDefines,\n\n\t\t\t\t'\\n'\n\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\t} else {\n\n\t\t\tprefixVertex = [\n\n\t\t\t\t'precision ' + parameters.precision + ' float;',\n\t\t\t\t'precision ' + parameters.precision + ' int;',\n\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\n\n\t\t\t\tcustomDefines,\n\n\t\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\n\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\n\n\t\t\t\t'#define MAX_BONES ' + parameters.maxBones,\n\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\n\t\t\t\tparameters.falloffMap && parameters.falloff ? '#define USE_FALLOFFMAP' : '',\n\t\t\t\tparameters.falloffAlphaMap && parameters.falloff ? '#define USE_FALLOFFALPHAMAP' : '',\n\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\n\t\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\n\n\t\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\n\t\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\t\t'#define NUM_CLIPPING_PLANES ' + parameters.numClippingPlanes,\n\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\n\t\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\n\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\t\t\t\t'uniform mat4 modelMatrix;',\n\t\t\t\t'uniform mat4 modelViewMatrix;',\n\t\t\t\t'uniform mat4 projectionMatrix;',\n\t\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t\t'uniform mat3 normalMatrix;',\n\t\t\t\t'uniform vec3 cameraPosition;',\n\n\t\t\t\t'attribute vec3 position;',\n\t\t\t\t'attribute vec3 normal;',\n\t\t\t\t'attribute vec2 uv;',\n\n\t\t\t\t'#ifdef USE_COLOR',\n\n\t\t\t\t'\tattribute vec3 color;',\n\n\t\t\t\t'#endif',\n\n\t\t\t\t'#ifdef USE_MORPHTARGETS',\n\n\t\t\t\t'\tattribute vec3 morphTarget0;',\n\t\t\t\t'\tattribute vec3 morphTarget1;',\n\t\t\t\t'\tattribute vec3 morphTarget2;',\n\t\t\t\t'\tattribute vec3 morphTarget3;',\n\n\t\t\t\t'\t#ifdef USE_MORPHNORMALS',\n\n\t\t\t\t'\t\tattribute vec3 morphNormal0;',\n\t\t\t\t'\t\tattribute vec3 morphNormal1;',\n\t\t\t\t'\t\tattribute vec3 morphNormal2;',\n\t\t\t\t'\t\tattribute vec3 morphNormal3;',\n\n\t\t\t\t'\t#else',\n\n\t\t\t\t'\t\tattribute vec3 morphTarget4;',\n\t\t\t\t'\t\tattribute vec3 morphTarget5;',\n\t\t\t\t'\t\tattribute vec3 morphTarget6;',\n\t\t\t\t'\t\tattribute vec3 morphTarget7;',\n\n\t\t\t\t'\t#endif',\n\n\t\t\t\t'#endif',\n\n\t\t\t\t'#ifdef USE_SKINNING',\n\n\t\t\t\t'\tattribute vec4 skinIndex;',\n\t\t\t\t'\tattribute vec4 skinWeight;',\n\n\t\t\t\t'#endif',\n\n\t\t\t\t'\\n'\n\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\t\tprefixFragment = [\n\n\t\t\t\tcustomExtensions,\n\n\t\t\t\t'precision ' + parameters.precision + ' float;',\n\t\t\t\t'precision ' + parameters.precision + ' int;',\n\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\n\n\t\t\t\tcustomDefines,\n\n\t\t\t\tparameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\n\n\t\t\t\tparameters.falloff ? '#define FALLOFF' : '',\n\t\t\t\tparameters.falloffMap && parameters.falloff ? '#define USE_FALLOFFMAP' : '',\n\t\t\t\tparameters.falloffAlphaMap && parameters.falloff ? '#define USE_FALLOFFALPHAMAP' : '',\n\n\t\t\t\t//parameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\n\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\n\t\t\t\t( parameters.useFog && parameters.fogExp ) ? '#define FOG_EXP2' : '',\n\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\n\n\t\t\t\tparameters.gradientMap ? '#define USE_GRADIENTMAP' : '',\n\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\t\t'#define NUM_CLIPPING_PLANES ' + parameters.numClippingPlanes,\n\t\t\t\t'#define UNION_CLIPPING_PLANES ' + (parameters.numClippingPlanes - parameters.numClipIntersection),\n\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\n\t\t\t\tparameters.premultipliedAlpha ? \"#define PREMULTIPLIED_ALPHA\" : '',\n\n\t\t\t\tparameters.physicallyCorrectLights ? \"#define PHYSICALLY_CORRECT_LIGHTS\" : '',\n\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\t\t\t\t( parameters.outputEncoding || parameters.mapEncoding || parameters.envMapEncoding || parameters.falloffMapEncoding || parameters.emissiveMapEncoding ) ? ShaderChunk[ 'encodings_pars_fragment' ] : '', // this code is required here because it is used by the various encoding/decoding function defined below\n\t\t\t\tparameters.mapEncoding ? getTexelDecodingFunction( 'mapTexelToLinear', parameters.mapEncoding ) : '',\n\t\t\t\tparameters.envMapEncoding ? getTexelDecodingFunction( 'envMapTexelToLinear', parameters.envMapEncoding ) : '',\n\t\t\t\tparameters.emissiveMapEncoding ? getTexelDecodingFunction( 'emissiveMapTexelToLinear', parameters.emissiveMapEncoding ) : '',\n\t\t\t\tparameters.falloffMapEncoding ? getTexelDecodingFunction( 'falloffMapTexelToLinear', parameters.falloffMapEncoding ) : '',\n\t\t\t\tparameters.outputEncoding ? getTexelEncodingFunction( \"linearToOutputTexel\", parameters.outputEncoding ) : '',\n\n\n\t\t\t\tparameters.depthPacking ? \"#define DEPTH_PACKING \" + material.depthPacking : '',\n\n\t\t\t\tparameters.envMap && renderer.extensions.get( 'EXT_shader_texture_lod' ) ? '#define TEXTURE_LOD_EXT' : '',\n\n\t\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t\t'uniform vec3 cameraPosition;',\n\n\t\t\t\t( parameters.toneMapping !== NoToneMapping ) ? \"#define TONE_MAPPING\" : '',\n\t\t\t\t( parameters.toneMapping !== NoToneMapping ) ? ShaderChunk[ 'tonemapping_pars_fragment' ] : '',  // this code is required here because it is used by the toneMapping() function defined below\n\t\t\t\t( parameters.toneMapping !== NoToneMapping ) ? getToneMappingFunction( \"toneMapping\", parameters.toneMapping ) : '',\n\n\t\t\t\t'\\n'\n\n\t\t\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\n\t\t\tvar supportedMapNames = MaterialMap.SupportedMapNames;\n\n\t\t\tvar mapUVChannelsCode = \"\";\n\t\t\tvar mapTexelTransformCode = \"\";\n\t\t\tvar mapUvChannels = {};\n\t\t\tfor( var i = 0; i < supportedMapNames.length; i ++ ) {\n\t\t\t\tvar mapName = supportedMapNames[i];\n\t\t\t\tvar map = material[ mapName + 'Slot' ];\n\t\t\t\tif( material[ mapName ] || ( map && map.texture ) ) {\n\t\t\t\t\tif( map && ! mapUvChannels[ map.uvChannel ]) mapUvChannels[ map.uvChannel ] = true;\n\t\t\t\t\tmapTexelTransformCode += getTexelTransformFunction( mapName, map );\n\t\t\t\t\tmapUVChannelsCode += \"uniform sampler2D \" + mapName + \";\\n\";\n\t\t\t\t\tmapUVChannelsCode += getUVFunction( mapName, map, false );\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( Object.keys( mapUvChannels ).length > 0 ) {\n\t\t\t\tvar mapUVPrefix = \"\";\n\t\t\t\tmapUVPrefix += \"#define TEXTURE_SLOTS\\n\";\n\t\t\t\tfor( var uvChannel in mapUvChannels ) {\n\t\t\t\t\tuvChannel = parseInt( uvChannel );\n\t\t\t\t\tvar uvChannelName = \"vUv\";\n\t\t\t\t\tif( uvChannel > 0 ) uvChannelName += '' + ( uvChannel + 1 );\n\t\t\t\t\tmapUVPrefix += \"varying vec2 \" + uvChannelName + \";\\n\";\n\t\t\t\t}\n\t\t\t\tprefixFragment += mapUVPrefix + mapUVChannelsCode;\n\t\t\t}\n\t\t\tprefixFragment += mapTexelTransformCode;\n\n\t\t}\n\n\t\tvertexShader = parseIncludes( vertexShader, parameters );\n\t\tvertexShader = replaceLightNums( vertexShader, parameters );\n\n\t\tfragmentShader = parseIncludes( fragmentShader, parameters );\n\t\tfragmentShader = replaceLightNums( fragmentShader, parameters );\n\n\t\tif ( ! material.isShaderMaterial ) {\n\n\t\t\tvertexShader = unrollLoops( vertexShader );\n\t\t\tfragmentShader = unrollLoops( fragmentShader );\n\n\t\t}\n\n\t\tvar vertexGlsl = prefixVertex + vertexShader;\n\t\tvar fragmentGlsl = prefixFragment + fragmentShader;\n\n\t\t// console.log( '*VERTEX*', vertexGlsl );\n\t\t// console.log( '*FRAGMENT*', fragmentGlsl );\n\n\t\tvar glVertexShader = WebGLShader( gl, gl.VERTEX_SHADER, vertexGlsl );\n\t\tvar glFragmentShader = WebGLShader( gl, gl.FRAGMENT_SHADER, fragmentGlsl );\n\n\t\tgl.attachShader( program, glVertexShader );\n\t\tgl.attachShader( program, glFragmentShader );\n\n\t\t// Force a particular attribute to index 0.\n\n\t\tif ( material.index0AttributeName !== undefined ) {\n\n\t\t\tgl.bindAttribLocation( program, 0, material.index0AttributeName );\n\n\t\t} else if ( parameters.morphTargets === true ) {\n\n\t\t\t// programs with morphTargets displace position out of attribute 0\n\t\t\tgl.bindAttribLocation( program, 0, 'position' );\n\n\t\t}\n\n\t\tgl.linkProgram( program );\n\n\t\tvar programLog = gl.getProgramInfoLog( program );\n\t\tvar vertexLog = gl.getShaderInfoLog( glVertexShader );\n\t\tvar fragmentLog = gl.getShaderInfoLog( glFragmentShader );\n\n\t\tvar runnable = true;\n\t\tvar haveDiagnostics = true;\n\n\t\t// console.log( '**VERTEX**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glVertexShader ) );\n\t\t// console.log( '**FRAGMENT**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glFragmentShader ) );\n\n\t\tif ( gl.getProgramParameter( program, gl.LINK_STATUS ) === false ) {\n\n\t\t\trunnable = false;\n\n\t\t\tconsole.log( '**VERTEX**', vertexGlsl, \"----------------------------------------------------------\", gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glVertexShader ) );\n\t\t\tconsole.log( '**FRAGMENT**', fragmentGlsl, \"----------------------------------------------------------\", gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glFragmentShader ) );\n\n\t\t\tconsole.error( 'THREE.WebGLProgram: shader error: ', gl.getError(), 'gl.VALIDATE_STATUS', gl.getProgramParameter( program, gl.VALIDATE_STATUS ), 'gl.getProgramInfoLog', programLog, vertexLog, fragmentLog );\n\n\t\t} else if ( programLog !== '' ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLProgram: gl.getProgramInfoLog()', programLog );\n\n\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\n\n\t\t\thaveDiagnostics = false;\n\n\t\t}\n\n\t\tif ( haveDiagnostics ) {\n\n\t\t\tthis.diagnostics = {\n\n\t\t\t\trunnable: runnable,\n\t\t\t\tmaterial: material,\n\n\t\t\t\tprogramLog: programLog,\n\n\t\t\t\tvertexShader: {\n\n\t\t\t\t\tlog: vertexLog,\n\t\t\t\t\tprefix: prefixVertex\n\n\t\t\t\t},\n\n\t\t\t\tfragmentShader: {\n\n\t\t\t\t\tlog: fragmentLog,\n\t\t\t\t\tprefix: prefixFragment\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\t// clean up\n\n\t\tgl.deleteShader( glVertexShader );\n\t\tgl.deleteShader( glFragmentShader );\n\n\t\t// set up caching for uniform locations\n\n\t\tvar cachedUniforms;\n\n\t\tthis.getUniforms = function() {\n\n\t\t\tif ( cachedUniforms === undefined ) {\n\n\t\t\t\tcachedUniforms =\n\t\t\t\t\tnew WebGLUniforms( gl, program, renderer );\n\n\t\t\t}\n\n\t\t\treturn cachedUniforms;\n\n\t\t};\n\n\t\t// set up caching for attribute locations\n\n\t\tvar cachedAttributes;\n\n\t\tthis.getAttributes = function() {\n\n\t\t\tif ( cachedAttributes === undefined ) {\n\n\t\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\n\n\t\t\t}\n\n\t\t\treturn cachedAttributes;\n\n\t\t};\n\n\t\t// free resource\n\n\t\tthis.destroy = function() {\n\n\t\t\tgl.deleteProgram( program );\n\t\t\tthis.program = undefined;\n\n\t\t};\n\n\t\t// DEPRECATED\n\n\t\tObject.defineProperties( this, {\n\n\t\t\tuniforms: {\n\t\t\t\tget: function() {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .uniforms is now .getUniforms().' );\n\t\t\t\t\treturn this.getUniforms();\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tattributes: {\n\t\t\t\tget: function() {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .attributes is now .getAttributes().' );\n\t\t\t\t\treturn this.getAttributes();\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} );\n\n\n\t\t//\n\n\t\tthis.id = programIdCount ++;\n\t\tthis.code = code;\n\t\tthis.usedTimes = 1;\n\t\tthis.program = program;\n\t\tthis.vertexShader = glVertexShader;\n\t\tthis.fragmentShader = glFragmentShader;\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLPrograms( renderer, capabilities ) {\n\n\t\tvar programs = [];\n\n\t\tvar shaderIDs = {\n\t\t\tMeshDepthMaterial: 'depth',\n\t\t\tMeshNormalMaterial: 'normal',\n\t\t\tMeshBasicMaterial: 'basic',\n\t\t\tMeshLambertMaterial: 'lambert',\n\t\t\tMeshPhongMaterial: 'phong',\n\t\t\tMeshToonMaterial: 'phong',\n\t\t\tMeshStandardMaterial: 'physical',\n\t\t\tMeshPhysicalMaterial: 'physical',\n\t\t\tMeshCubeMaterial: 'cubeEnv',\n\t\t\tLineBasicMaterial: 'basic',\n\t\t\tLineDashedMaterial: 'dashed',\n\t\t\tPointsMaterial: 'points'\n\t\t};\n\n\t\tvar parameterNames = [\n\t\t\t\"precision\", \"supportsVertexTextures\", \"map\", \"mapEncoding\", \"envMap\", \"envMapMode\", \"envMapEncoding\",\n\t\t\t\"lightMap\", \"aoMap\", \"emissiveMap\", \"emissiveMapEncoding\", \"bumpMap\", \"normalMap\", \"displacementMap\", \"specularMap\",\n\t\t\t\"roughnessMap\", \"metalnessMap\", \"gradientMap\",\n\t\t\t\"alphaMap\", \"combine\", \"vertexColors\", \"fog\", \"useFog\", \"fogExp\",\n\t\t\t\"flatShading\", \"sizeAttenuation\", \"logarithmicDepthBuffer\", \"skinning\",\n\t\t\t\"maxBones\", \"useVertexTexture\", \"morphTargets\", \"morphNormals\",\n\t\t\t\"maxMorphTargets\", \"maxMorphNormals\", \"premultipliedAlpha\",\n\t\t\t\"numDirLights\", \"numPointLights\", \"numSpotLights\", \"numHemiLights\", \"numRectAreaLights\",\n\t\t\t\"shadowMapEnabled\", \"shadowMapType\", \"toneMapping\", 'physicallyCorrectLights',\n\t\t\t\"alphaTest\", \"doubleSided\", \"flipSided\", \"numClippingPlanes\", \"numClipIntersection\", \"depthPacking\", 'falloff', 'falloffMap', 'falloffAlphaMap'\n\t\t];\n\n\t\tvar supportedMaps = MaterialMap.SupportedMapNames;\n\t\tfor( var i = 0; i < supportedMaps.length; i ++ ) {\n\t\t\tvar name = supportedMaps[i];\n\t\t\tparameterNames.push( name );\n\t\t\tparameterNames.push( name + 'UVChannel' );\n\t\t\tparameterNames.push( name + 'UVTransform' );\n\t\t\tparameterNames.push( name + 'TexelTransform' );\n\t\t}\n\n\t\tfunction allocateBones( object ) {\n\n\t\t\tif ( capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture ) {\n\n\t\t\t\treturn 1024;\n\n\t\t\t} else {\n\n\t\t\t\t// default for when object is not specified\n\t\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\n\t\t\t\t//\n\t\t\t\t//  - leave some extra space for other uniforms\n\t\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\n\t\t\t\t//    (up to 54 should be safe)\n\n\t\t\t\tvar nVertexUniforms = capabilities.maxVertexUniforms;\n\t\t\t\tvar nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\n\n\t\t\t\tvar maxBones = nVertexMatrices;\n\n\t\t\t\tif ( object !== undefined && (object && object.isSkinnedMesh) ) {\n\n\t\t\t\t\tmaxBones = Math.min( object.skeleton.bones.length, maxBones );\n\n\t\t\t\t\tif ( maxBones < object.skeleton.bones.length ) {\n\n\t\t\t\t\t\tconsole.warn( 'WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn maxBones;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getTextureEncodingFromMap( map, gammaOverrideLinear ) {\n\n\t\t\tvar encoding;\n\n\t\t\tif ( ! map ) {\n\n\t\t\t\tencoding = LinearEncoding;\n\n\t\t\t} else if ( map.isTexture ) {\n\n\t\t\t\tencoding = map.encoding;\n\n\t\t\t} else if ( map.isWebGLRenderTarget ) {\n\n\t\t\t\tconsole.warn( \"THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead.\" );\n\t\t\t\tencoding = map.texture.encoding;\n\n\t\t\t}\n\n\t\t\t// add backwards compatibility for WebGLRenderer.gammaInput/gammaOutput parameter, should probably be removed at some point.\n\t\t\tif ( encoding === LinearEncoding && gammaOverrideLinear ) {\n\n\t\t\t\tencoding = GammaEncoding;\n\n\t\t\t}\n\n\t\t\treturn encoding;\n\n\t\t}\n\n\t\tthis.getParameters = function ( material, lights, fog, nClipPlanes, nClipIntersection, object ) {\n\n\t\t\tvar shaderID = shaderIDs[ material.type ];\n\n\t\t\t// heuristics to create shader parameters according to lights in the scene\n\t\t\t// (not to blow over maxLights budget)\n\n\t\t\tvar maxBones = allocateBones( object );\n\t\t\tvar precision = renderer.getPrecision();\n\n\t\t\tif ( material.precision !== null ) {\n\n\t\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\n\n\t\t\t\tif ( precision !== material.precision ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram.getParameters:', material.precision, 'not supported, using', precision, 'instead.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar currentRenderTarget = renderer.getCurrentRenderTarget();\n\n\t\t\tvar parameters = {\n\n\t\t\t\tshaderID: shaderID,\n\n\t\t\t\tprecision: precision,\n\t\t\t\tsupportsVertexTextures: capabilities.vertexTextures,\n\t\t\t\toutputEncoding: getTextureEncodingFromMap( ( ! currentRenderTarget ) ? null : currentRenderTarget.texture, renderer.gammaOutput ),\n\t\t\t\tmapEncoding: getTextureEncodingFromMap( material.map, renderer.gammaInput ),\n\t\t\t\tenvMap: !!material.envMap,\n\t\t\t\tenvMapMode: material.envMap && material.envMap.mapping,\n\t\t\t\tenvMapEncoding: getTextureEncodingFromMap( material.envMap, renderer.gammaInput ),\n\t\t\t\tenvMapCubeUV: ( !! material.envMap ) && ( ( material.envMap.mapping === CubeUVReflectionMapping ) || ( material.envMap.mapping === CubeUVRefractionMapping ) ),\n\t\t\t\temissiveMapEncoding: getTextureEncodingFromMap( material.emissiveMap, renderer.gammaInput ),\n\n\t\t\t\tfalloff: material.falloff,\n\t\t\t\tfalloffMapEncoding: getTextureEncodingFromMap( material.falloffMap, renderer.gammaInput ),\n\n\t\t\t\tgradientMap: !! material.gradientMap,\n\n\t\t\t\tcombine: material.combine,\n\n\t\t\t\tvertexColors: material.vertexColors,\n\n\t\t\t\tfog: !! fog,\n\t\t\t\tuseFog: material.fog,\n\t\t\t\tfogExp: (fog && fog.isFogExp2),\n\n\t\t\t\tflatShading: material.shading === FlatShading,\n\n\t\t\t\tsizeAttenuation: material.sizeAttenuation,\n\t\t\t\tlogarithmicDepthBuffer: capabilities.logarithmicDepthBuffer,\n\n\t\t\t\tskinning: material.skinning,\n\t\t\t\tmaxBones: maxBones,\n\t\t\t\tuseVertexTexture: capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture,\n\n\t\t\t\tmorphTargets: material.morphTargets,\n\t\t\t\tmorphNormals: material.morphNormals,\n\t\t\t\tmaxMorphTargets: renderer.maxMorphTargets,\n\t\t\t\tmaxMorphNormals: renderer.maxMorphNormals,\n\n\t\t\t\tnumDirLights: lights.directional.length,\n\t\t\t\tnumPointLights: lights.point.length,\n\t\t\t\tnumSpotLights: lights.spot.length,\n\t\t\t\tnumRectAreaLights: lights.rectArea.length,\n\t\t\t\tnumHemiLights: lights.hemi.length,\n\n\t\t\t\tnumClippingPlanes: nClipPlanes,\n\t\t\t\tnumClipIntersection: nClipIntersection,\n\n\t\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && object.receiveShadow && lights.shadows.length > 0,\n\t\t\t\tshadowMapType: renderer.shadowMap.type,\n\n\t\t\t\ttoneMapping: renderer.toneMapping,\n\t\t\t\tphysicallyCorrectLights: renderer.physicallyCorrectLights,\n\n\t\t\t\tpremultipliedAlpha: material.premultipliedAlpha,\n\n\t\t\t\talphaTest: material.alphaTest,\n\t\t\t\tdoubleSided: material.side === DoubleSide,\n\t\t\t\tflipSided: material.side === BackSide,\n\n\t\t\t\tdepthPacking: ( material.depthPacking !== undefined ) ? material.depthPacking : false\n\n\t\t\t};\n\n\t\t\tvar supportedMapNames = MaterialMap.SupportedMapNames;\n\n\t\t\tfor( var i = 0; i < supportedMapNames.length; i ++ ) {\n\t\t\t\tvar mapName = supportedMapNames[i];\n\t\t\t\tvar mapSlotName = MaterialMap.SupportedMapSlotNames[i];\n\t\t\t\t// backwards compatibility\n\t\t\t\tparameters[mapName] = !! material[ mapName ];\n\n\t\t\t\t// new functional for slot-based maps\n\t\t\t\tvar map = material[ mapSlotName ];\n\t\t\t\tparameters[mapName + \"UVChannel\" ] = ( map !== undefined ) ? map.uvChannel : 0;\n\t\t\t\tparameters[mapName + \"UVTransform\" ] = ( map !== undefined ) ? map.uvTransform : false;\n\t\t\t\tparameters[mapName + \"TexelTransform\" ] = ( map !== undefined ) ? map.texelTransform : false;\n\t\t\t}\n\n\t\t\treturn parameters;\n\n\t\t};\n\n\t\tthis.getProgramCode = function ( material, parameters ) {\n\n\t\t\tvar array = [];\n\n\t\t\tif ( parameters.shaderID ) {\n\n\t\t\t\tarray.push( parameters.shaderID );\n\n\t\t\t} else {\n\n\t\t\t\tarray.push( material.fragmentShader );\n\t\t\t\tarray.push( material.vertexShader );\n\n\t\t\t}\n\n\t\t\tif ( material.defines !== undefined ) {\n\n\t\t\t\tfor ( var name in material.defines ) {\n\n\t\t\t\t\tarray.push( name );\n\t\t\t\t\tarray.push( material.defines[ name ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < parameterNames.length; i ++ ) {\n\n\t\t\t\tarray.push( parameters[ parameterNames[ i ] ] );\n\n\t\t\t}\n\n\t\t\treturn array.join();\n\n\t\t};\n\n\t\tthis.acquireProgram = function ( material, parameters, code ) {\n\n\t\t\tvar program;\n\n\t\t\t// Check if code has been already compiled\n\t\t\tfor ( var p = 0, pl = programs.length; p < pl; p ++ ) {\n\n\t\t\t\tvar programInfo = programs[ p ];\n\n\t\t\t\tif ( programInfo.code === code ) {\n\n\t\t\t\t\tprogram = programInfo;\n\t\t\t\t\t++ program.usedTimes;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( program === undefined ) {\n\n\t\t\t\tprogram = new WebGLProgram( renderer, code, material, parameters );\n\t\t\t\tprograms.push( program );\n\n\t\t\t}\n\n\t\t\treturn program;\n\n\t\t};\n\n\t\tthis.releaseProgram = function( program ) {\n\n\t\t\tif ( -- program.usedTimes === 0 ) {\n\n\t\t\t\t// Remove from unordered set\n\t\t\t\tvar i = programs.indexOf( program );\n\t\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\n\t\t\t\tprograms.pop();\n\n\t\t\t\t// Free WebGL resources\n\t\t\t\tprogram.destroy();\n\n\t\t\t}\n\n\t\t};\n\n\t\t// Exposed for resource monitoring & error feedback via renderer.info:\n\t\tthis.programs = programs;\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLGeometries( gl, properties, info ) {\n\n\t\tvar geometries = {};\n\n\t\tfunction onGeometryDispose( event ) {\n\n\t\t\tvar geometry = event.target;\n\t\t\tvar buffergeometry = geometries[ geometry.id ];\n\n\t\t\tif ( buffergeometry.index !== null ) {\n\n\t\t\t\tdeleteAttribute( buffergeometry.index );\n\n\t\t\t}\n\n\t\t\tdeleteAttributes( buffergeometry.attributes );\n\n\t\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\n\n\t\t\tdelete geometries[ geometry.id ];\n\n\t\t\t// TODO\n\n\t\t\tvar property = properties.get( geometry );\n\n\t\t\tif ( property.wireframe ) {\n\n\t\t\t\tdeleteAttribute( property.wireframe );\n\n\t\t\t}\n\n\t\t\tproperties.delete( geometry );\n\n\t\t\tvar bufferproperty = properties.get( buffergeometry );\n\n\t\t\tif ( bufferproperty.wireframe ) {\n\n\t\t\t\tdeleteAttribute( bufferproperty.wireframe );\n\n\t\t\t}\n\n\t\t\tproperties.delete( buffergeometry );\n\n\t\t\t//\n\n\t\t\tinfo.memory.geometries --;\n\n\t\t}\n\n\t\tfunction getAttributeBuffer( attribute ) {\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\treturn properties.get( attribute.data ).__webglBuffer;\n\n\t\t\t}\n\n\t\t\treturn properties.get( attribute ).__webglBuffer;\n\n\t\t}\n\n\t\tfunction deleteAttribute( attribute ) {\n\n\t\t\tvar buffer = getAttributeBuffer( attribute );\n\n\t\t\tif ( buffer !== undefined ) {\n\n\t\t\t\tgl.deleteBuffer( buffer );\n\t\t\t\tremoveAttributeBuffer( attribute );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction deleteAttributes( attributes ) {\n\n\t\t\tfor ( var name in attributes ) {\n\n\t\t\t\tdeleteAttribute( attributes[ name ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction removeAttributeBuffer( attribute ) {\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\tproperties.delete( attribute.data );\n\n\t\t\t} else {\n\n\t\t\t\tproperties.delete( attribute );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tget: function ( object ) {\n\n\t\t\t\tvar geometry = object.geometry;\n\n\t\t\t\tif ( geometries[ geometry.id ] !== undefined ) {\n\n\t\t\t\t\treturn geometries[ geometry.id ];\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\n\n\t\t\t\tvar buffergeometry;\n\n\t\t\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t\t\tbuffergeometry = geometry;\n\n\t\t\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\t\t\tif ( geometry._bufferGeometry === undefined ) {\n\n\t\t\t\t\t\tgeometry._bufferGeometry = new BufferGeometry().setFromObject( object );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbuffergeometry = geometry._bufferGeometry;\n\n\t\t\t\t}\n\n\t\t\t\tgeometries[ geometry.id ] = buffergeometry;\n\n\t\t\t\tinfo.memory.geometries ++;\n\n\t\t\t\treturn buffergeometry;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLObjects( gl, properties, info ) {\n\n\t\tvar geometries = new WebGLGeometries( gl, properties, info );\n\n\t\t//\n\n\t\tfunction update( object ) {\n\n\t\t\t// TODO: Avoid updating twice (when using shadowMap). Maybe add frame counter.\n\n\t\t\tvar geometry = geometries.get( object );\n\n\t\t\tif ( object.geometry.isGeometry ) {\n\n\t\t\t\tgeometry.updateFromObject( object );\n\n\t\t\t}\n\n\t\t\tvar index = geometry.index;\n\t\t\tvar attributes = geometry.attributes;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tupdateAttribute( index, gl.ELEMENT_ARRAY_BUFFER );\n\n\t\t\t}\n\n\t\t\tfor ( var name in attributes ) {\n\n\t\t\t\tupdateAttribute( attributes[ name ], gl.ARRAY_BUFFER );\n\n\t\t\t}\n\n\t\t\t// morph targets\n\n\t\t\tvar morphAttributes = geometry.morphAttributes;\n\n\t\t\tfor ( var name in morphAttributes ) {\n\n\t\t\t\tvar array = morphAttributes[ name ];\n\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\t\tupdateAttribute( array[ i ], gl.ARRAY_BUFFER );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn geometry;\n\n\t\t}\n\n\t\tfunction updateAttribute( attribute, bufferType ) {\n\n\t\t\tvar data = ( attribute.isInterleavedBufferAttribute ) ? attribute.data : attribute;\n\n\t\t\tvar attributeProperties = properties.get( data );\n\n\t\t\tif ( attributeProperties.__webglBuffer === undefined ) {\n\n\t\t\t\tcreateBuffer( attributeProperties, data, bufferType );\n\n\t\t\t} else if ( attributeProperties.version !== data.version ) {\n\n\t\t\t\tupdateBuffer( attributeProperties, data, bufferType );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction createBuffer( attributeProperties, data, bufferType ) {\n\n\t\t\tattributeProperties.__webglBuffer = gl.createBuffer();\n\t\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\n\n\t\t\tvar usage = data.dynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW;\n\n\t\t\tgl.bufferData( bufferType, data.array, usage );\n\n\t\t\tvar type = gl.FLOAT;\n\t\t\tvar array = data.array;\n\n\t\t\tif ( array instanceof Float32Array ) {\n\n\t\t\t\ttype = gl.FLOAT;\n\n\t\t\t} else if ( array instanceof Float64Array ) {\n\n\t\t\t\tconsole.warn( \"Unsupported data buffer format: Float64Array\" );\n\n\t\t\t} else if ( array instanceof Uint16Array ) {\n\n\t\t\t\ttype = gl.UNSIGNED_SHORT;\n\n\t\t\t} else if ( array instanceof Int16Array ) {\n\n\t\t\t\ttype = gl.SHORT;\n\n\t\t\t} else if ( array instanceof Uint32Array ) {\n\n\t\t\t\ttype = gl.UNSIGNED_INT;\n\n\t\t\t} else if ( array instanceof Int32Array ) {\n\n\t\t\t\ttype = gl.INT;\n\n\t\t\t} else if ( array instanceof Int8Array ) {\n\n\t\t\t\ttype = gl.BYTE;\n\n\t\t\t} else if ( array instanceof Uint8Array ) {\n\n\t\t\t\ttype = gl.UNSIGNED_BYTE;\n\n\t\t\t}\n\n\t\t\tattributeProperties.bytesPerElement = array.BYTES_PER_ELEMENT;\n\t\t\tattributeProperties.type = type;\n\t\t\tattributeProperties.version = data.version;\n\n\t\t\tdata.onUploadCallback();\n\n\t\t}\n\n\t\tfunction updateBuffer( attributeProperties, data, bufferType ) {\n\n\t\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\n\n\t\t\tif ( data.dynamic === false ) {\n\n\t\t\t\tgl.bufferData( bufferType, data.array, gl.STATIC_DRAW );\n\n\t\t\t} else if ( data.updateRange.count === - 1 ) {\n\n\t\t\t\t// Not using update ranges\n\n\t\t\t\tgl.bufferSubData( bufferType, 0, data.array );\n\n\t\t\t} else if ( data.updateRange.count === 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.' );\n\n\t\t\t} else {\n\n\t\t\t\tgl.bufferSubData( bufferType, data.updateRange.offset * data.array.BYTES_PER_ELEMENT,\n\t\t\t\t\t\t\t\t  data.array.subarray( data.updateRange.offset, data.updateRange.offset + data.updateRange.count ) );\n\n\t\t\t\tdata.updateRange.count = 0; // reset range\n\n\t\t\t}\n\n\t\t\tattributeProperties.version = data.version;\n\n\t\t}\n\n\t\tfunction getAttributeBuffer( attribute ) {\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\treturn properties.get( attribute.data ).__webglBuffer;\n\n\t\t\t}\n\n\t\t\treturn properties.get( attribute ).__webglBuffer;\n\n\t\t}\n\n\t\tfunction getAttributeProperties( attribute ) {\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\treturn properties.get( attribute.data );\n\n\t\t\t}\n\n\t\t\treturn properties.get( attribute );\n\n\t\t}\n\n\t\tfunction getWireframeAttribute( geometry ) {\n\n\t\t\tvar property = properties.get( geometry );\n\n\t\t\tif ( property.wireframe !== undefined ) {\n\n\t\t\t\treturn property.wireframe;\n\n\t\t\t}\n\n\t\t\tvar indices = [];\n\n\t\t\tvar index = geometry.index;\n\t\t\tvar attributes = geometry.attributes;\n\t\t\tvar position = attributes.position;\n\n\t\t\t// console.time( 'wireframe' );\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tvar edges = {};\n\t\t\t\tvar array = index.array;\n\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\t\t\tvar a = array[ i + 0 ];\n\t\t\t\t\tvar b = array[ i + 1 ];\n\t\t\t\t\tvar c = array[ i + 2 ];\n\n\t\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tvar array = attributes.position.array;\n\n\t\t\t\tfor ( var i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\n\n\t\t\t\t\tvar a = i + 0;\n\t\t\t\t\tvar b = i + 1;\n\t\t\t\t\tvar c = i + 2;\n\n\t\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// console.timeEnd( 'wireframe' );\n\n\t\t\tvar TypeArray = position.count > 65535 ? Uint32Array : Uint16Array;\n\t\t\tvar attribute = new BufferAttribute( new TypeArray( indices ), 1 );\n\n\t\t\tupdateAttribute( attribute, gl.ELEMENT_ARRAY_BUFFER );\n\n\t\t\tproperty.wireframe = attribute;\n\n\t\t\treturn attribute;\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tgetAttributeBuffer: getAttributeBuffer,\n\t\t\tgetAttributeProperties: getAttributeProperties,\n\t\t\tgetWireframeAttribute: getWireframeAttribute,\n\n\t\t\tupdate: update\n\n\t\t};\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLTextures( _gl, extensions, state, properties, capabilities, paramThreeToGL, info ) {\n\n\t\tvar _infoMemory = info.memory;\n\t\tvar _isWebGL2 = ( typeof WebGL2RenderingContext !== 'undefined' && _gl instanceof WebGL2RenderingContext );\n\n\t\t//\n\n\t\tfunction clampToMaxSize( image, maxSize ) {\n\n\t\t\tif ( image.width > maxSize || image.height > maxSize ) {\n\n\t\t\t\t// Warning: Scaling through the canvas will only work with images that use\n\t\t\t\t// premultiplied alpha.\n\n\t\t\t\tvar scale = maxSize / Math.max( image.width, image.height );\n\n\t\t\t\tvar canvas = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\n\t\t\t\tcanvas.width = Math.floor( image.width * scale );\n\t\t\t\tcanvas.height = Math.floor( image.height * scale );\n\n\t\t\t\tvar context = canvas.getContext( '2d' );\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height );\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\n\n\t\t\t\treturn canvas;\n\n\t\t\t}\n\n\t\t\treturn image;\n\n\t\t}\n\n\t\tfunction isPowerOfTwo( image ) {\n\n\t\t\treturn _Math.isPowerOfTwo( image.width ) && _Math.isPowerOfTwo( image.height );\n\n\t\t}\n\n\t\tfunction makePowerOfTwo( image ) {\n\n\t\t\tif ( image instanceof HTMLImageElement || image instanceof HTMLCanvasElement ) {\n\n\t\t\t\tvar canvas = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\n\t\t\t\tcanvas.width = _Math.nearestPowerOfTwo( image.width );\n\t\t\t\tcanvas.height = _Math.nearestPowerOfTwo( image.height );\n\n\t\t\t\tvar context = canvas.getContext( '2d' );\n\t\t\t\tcontext.drawImage( image, 0, 0, canvas.width, canvas.height );\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is not power of two (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\n\n\t\t\t\treturn canvas;\n\n\t\t\t}\n\n\t\t\treturn image;\n\n\t\t}\n\n\t\tfunction textureNeedsPowerOfTwo( texture ) {\n\n\t\t\treturn ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) ||\n\t\t\t\t( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter );\n\n\t\t}\n\n\t\t// Fallback filters for non-power-of-2 textures\n\n\t\tfunction filterFallback( f ) {\n\n\t\t\tif ( f === NearestFilter || f === NearestMipMapNearestFilter || f === NearestMipMapLinearFilter ) {\n\n\t\t\t\treturn _gl.NEAREST;\n\n\t\t\t}\n\n\t\t\treturn _gl.LINEAR;\n\n\t\t}\n\n\t\t//\n\n\t\tfunction onTextureDispose( event ) {\n\n\t\t\tvar texture = event.target;\n\n\t\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\t\tdeallocateTexture( texture );\n\n\t\t\t_infoMemory.textures --;\n\n\n\t\t}\n\n\t\tfunction onRenderTargetDispose( event ) {\n\n\t\t\tvar renderTarget = event.target;\n\n\t\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\n\n\t\t\tdeallocateRenderTarget( renderTarget );\n\n\t\t\t_infoMemory.textures --;\n\n\t\t}\n\n\t\t//\n\n\t\tfunction deallocateTexture( texture ) {\n\n\t\t\tvar textureProperties = properties.get( texture );\n\n\t\t\tif ( texture.image && textureProperties.__image__webglTextureCube ) {\n\n\t\t\t\t// cube texture\n\n\t\t\t\t_gl.deleteTexture( textureProperties.__image__webglTextureCube );\n\n\t\t\t} else {\n\n\t\t\t\t// 2D texture\n\n\t\t\t\tif ( textureProperties.__webglInit === undefined ) return;\n\n\t\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\n\n\t\t\t}\n\n\t\t\t// remove all webgl properties\n\t\t\tproperties.delete( texture );\n\n\t\t}\n\n\t\tfunction deallocateRenderTarget( renderTarget ) {\n\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\n\n\t\t\tif ( ! renderTarget ) return;\n\n\t\t\tif ( textureProperties.__webglTexture !== undefined ) {\n\n\t\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\n\n\t\t\t}\n\n\t\t\tif ( renderTarget.depthTexture ) {\n\n\t\t\t\trenderTarget.depthTexture.dispose();\n\n\t\t\t}\n\n\t\t\tif ( renderTarget.isWebGLRenderTargetCube ) {\n\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\n\t\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer[ i ] );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\n\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer );\n\n\t\t\t}\n\n\t\t\tproperties.delete( renderTarget.texture );\n\t\t\tproperties.delete( renderTarget );\n\n\t\t}\n\n\t\t//\n\n\n\t\t var textureUpdateUndefinedWarning = false;\n\t\t var textureUpdateIncompleteWarning = false;\n\n\t\tfunction setTexture2D( texture, slot ) {\n\n\t\t\tvar textureProperties = properties.get( texture );\n\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\t\tvar image = texture.image;\n\n\t\t\t\tif ( image === undefined ) {\n\n\t\t\t\t\tif( ! textureUpdateUndefinedWarning ) {\n\t\t\t\t\t\tconsole.trace( 'THREE.WebGLRenderer: Texture marked for update but image is undefined', texture );\n\t\t\t\t\t\ttextureUpdateUndefinedWarning = true;\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( image.complete === false ) {\n\n\t\t\t\t\tif( ! textureUpdateIncompleteWarning ) {\n\t\t\t\t\t\tconsole.trace( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete', texture );\n\t\t\t\t\t\ttextureUpdateIncompleteWarning = true;\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\n\n\t\t}\n\n\t\tfunction setTextureCube( texture, slot ) {\n\n\t\t\tvar textureProperties = properties.get( texture );\n\n\t\t\tif ( texture.image.length === 6 ) {\n\n\t\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\t\t\tif ( ! textureProperties.__image__webglTextureCube ) {\n\n\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\ttextureProperties.__image__webglTextureCube = _gl.createTexture();\n\n\t\t\t\t\t\t_infoMemory.textures ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\n\n\t\t\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\n\n\t\t\t\t\tvar isCompressed = ( texture && texture.isCompressedTexture );\n\t\t\t\t\tvar isDataTexture = ( texture.image[ 0 ] && texture.image[ 0 ].isDataTexture );\n\n\t\t\t\t\tvar cubeImage = [];\n\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\t\tif ( ! isCompressed && ! isDataTexture ) {\n\n\t\t\t\t\t\t\tcubeImage[ i ] = clampToMaxSize( texture.image[ i ], capabilities.maxCubemapSize );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar image = cubeImage[ 0 ],\n\t\t\t\t\tisPowerOfTwoImage = isPowerOfTwo( image ),\n\t\t\t\t\tglFormat = paramThreeToGL( texture.format ),\n\t\t\t\t\tglType = paramThreeToGL( texture.type );\n\n\t\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, isPowerOfTwoImage );\n\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\t\tif ( ! isCompressed ) {\n\n\t\t\t\t\t\t\tif ( isDataTexture ) {\n\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[ i ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tvar mipmap, mipmaps = cubeImage[ i ].mipmaps;\n\n\t\t\t\t\t\t\tfor ( var j = 0, jl = mipmaps.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\t\tmipmap = mipmaps[ j ];\n\n\t\t\t\t\t\t\t\tif ( texture.format !== RGBAFormat && texture.format !== RGBFormat ) {\n\n\t\t\t\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\n\n\t\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()\" );\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( texture.generateMipmaps && isPowerOfTwoImage ) {\n\n\t\t\t\t\t\t_gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttextureProperties.__version = texture.version;\n\n\t\t\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction setTextureCubeDynamic( texture, slot ) {\n\n\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, properties.get( texture ).__webglTexture );\n\n\t\t}\n\n\t\tfunction setTextureParameters( textureType, texture, isPowerOfTwoImage ) {\n\n\t\t\tvar extension;\n\n\t\t\tif ( isPowerOfTwoImage ) {\n\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL( texture.wrapS ) );\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL( texture.wrapT ) );\n\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL( texture.magFilter ) );\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL( texture.minFilter ) );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE );\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE );\n\n\t\t\t\tif ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.', texture );\n\n\t\t\t\t}\n\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterFallback( texture.magFilter ) );\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterFallback( texture.minFilter ) );\n\n\t\t\t\tif ( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.', texture );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\textension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tif ( extension ) {\n\n\t\t\t\tif ( texture.type === FloatType && extensions.get( 'OES_texture_float_linear' ) === null ) return;\n\t\t\t\tif ( texture.type === HalfFloatType && extensions.get( 'OES_texture_half_float_linear' ) === null ) return;\n\n\t\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\n\n\t\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, capabilities.getMaxAnisotropy() ) );\n\t\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction uploadTexture( textureProperties, texture, slot ) {\n\n\t\t\tif ( textureProperties.__webglInit === undefined ) {\n\n\t\t\t\ttextureProperties.__webglInit = true;\n\n\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\n\n\t\t\t\t_infoMemory.textures ++;\n\n\t\t\t}\n\n\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\n\n\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\n\t\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\n\t\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\n\n\t\t\tvar image = clampToMaxSize( texture.image, capabilities.maxTextureSize );\n\n\t\t\tif ( textureNeedsPowerOfTwo( texture ) && isPowerOfTwo( image ) === false ) {\n\n\t\t\t\timage = makePowerOfTwo( image );\n\n\t\t\t}\n\n\t\t\tvar isPowerOfTwoImage = isPowerOfTwo( image ),\n\t\t\tglFormat = paramThreeToGL( texture.format ),\n\t\t\tglType = paramThreeToGL( texture.type );\n\n\t\t\tsetTextureParameters( _gl.TEXTURE_2D, texture, isPowerOfTwoImage );\n\n\t\t\tvar mipmap, mipmaps = texture.mipmaps;\n\n\t\t\tif ( texture.isDepthTexture ) {\n\n\t\t\t\t// populate depth texture with dummy data\n\n\t\t\t\tvar internalFormat = _gl.DEPTH_COMPONENT;\n\n\t\t\t\tif ( texture.type === FloatType ) {\n\n\t\t\t\t\tif ( !_isWebGL2 ) throw new Error('Float Depth Texture only supported in WebGL2.0');\n\t\t\t\t\tinternalFormat = _gl.DEPTH_COMPONENT32F;\n\n\t\t\t\t} else if ( _isWebGL2 ) {\n\n\t\t\t\t\t// WebGL 2.0 requires signed internalformat for glTexImage2D\n\t\t\t\t\tinternalFormat = _gl.DEPTH_COMPONENT16;\n\n\t\t\t\t}\n\n\t\t\t\tif ( texture.format === DepthFormat && internalFormat === _gl.DEPTH_COMPONENT ) {\n\n\t\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\n\t\t\t\t\t// DEPTH_COMPONENT and type is not UNSIGNED_SHORT or UNSIGNED_INT\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\t\tif ( texture.type !== UnsignedShortType && texture.type !== UnsignedIntType ) {\n\n\t\t\t\t\t        console.warn( 'THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.' );\n\n\t\t\t\t\t\ttexture.type = UnsignedShortType;\n\t\t\t\t\t\tglType = paramThreeToGL( texture.type );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Depth stencil textures need the DEPTH_STENCIL internal format\n\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\tif ( texture.format === DepthStencilFormat ) {\n\n\t\t\t\t\tinternalFormat = _gl.DEPTH_STENCIL;\n\n\t\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\n\t\t\t\t\t// DEPTH_STENCIL and type is not UNSIGNED_INT_24_8_WEBGL.\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\t\tif ( texture.type !== UnsignedInt248Type ) {\n\n\t\t\t\t\t        console.warn( 'THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.' );\n\n\t\t\t\t\t\ttexture.type = UnsignedInt248Type;\n\t\t\t\t\t\tglType = paramThreeToGL( texture.type );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, internalFormat, image.width, image.height, 0, glFormat, glType, null );\n\n\t\t\t} else if ( texture.isDataTexture ) {\n\n\t\t\t\t// use manually created mipmaps if available\n\t\t\t\t// if there are no manual mipmaps\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\t\tif ( mipmaps.length > 0 && isPowerOfTwoImage ) {\n\n\t\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data );\n\n\t\t\t\t}\n\n\t\t\t} else if ( texture.isCompressedTexture ) {\n\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\t\tif ( texture.format !== RGBAFormat && texture.format !== RGBFormat ) {\n\n\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\n\n\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\" );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// regular Texture (image, video, canvas)\n\n\t\t\t\t// use manually created mipmaps if available\n\t\t\t\t// if there are no manual mipmaps\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\t\tif ( mipmaps.length > 0 && isPowerOfTwoImage ) {\n\n\t\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, glFormat, glType, image );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( texture.generateMipmaps && isPowerOfTwoImage ) _gl.generateMipmap( _gl.TEXTURE_2D );\n\n\t\t\ttextureProperties.__version = texture.version;\n\n\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t\t}\n\n\t\t// Render targets\n\n\t\t// Setup storage for target texture and bind it to correct framebuffer\n\t\tfunction setupFrameBufferTexture( framebuffer, renderTarget, attachment, textureTarget ) {\n\n\t\t\tvar glFormat = paramThreeToGL( renderTarget.texture.format );\n\t\t\tvar glType = paramThreeToGL( renderTarget.texture.type );\n\t\t\tstate.texImage2D( textureTarget, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, attachment, textureTarget, properties.get( renderTarget.texture ).__webglTexture, 0 );\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\n\n\t\t}\n\n\t\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\n\t\tfunction setupRenderBufferStorage( renderbuffer, renderTarget ) {\n\n\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderbuffer );\n\n\t\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\n\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height );\n\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\n\n\t\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\n\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height );\n\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\n\n\t\t\t} else {\n\n\t\t\t\t// FIXME: We don't support !depth !stencil\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\n\n\t\t}\n\n\t\t// Setup resources for a Depth Texture for a FBO (needs an extension)\n\t\tfunction setupDepthTexture( framebuffer, renderTarget ) {\n\n\t\t\tvar isCube = ( renderTarget && renderTarget.isWebGLRenderTargetCube );\n\t\t\tif ( isCube ) throw new Error('Depth Texture with cube render targets is not supported!');\n\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\n\t\t\tif ( !( renderTarget.depthTexture && renderTarget.depthTexture.isDepthTexture ) ) {\n\n\t\t\t\tthrow new Error('renderTarget.depthTexture must be an instance of THREE.DepthTexture');\n\n\t\t\t}\n\n\t\t\t// upload an empty depth texture with framebuffer size\n\t\t\tif ( !properties.get( renderTarget.depthTexture ).__webglTexture ||\n\t\t\t\t\trenderTarget.depthTexture.image.width !== renderTarget.width ||\n\t\t\t\t\trenderTarget.depthTexture.image.height !== renderTarget.height ) {\n\t\t\t\trenderTarget.depthTexture.image.width = renderTarget.width;\n\t\t\t\trenderTarget.depthTexture.image.height = renderTarget.height;\n\t\t\t\trenderTarget.depthTexture.needsUpdate = true;\n\t\t\t}\n\n\t\t\tsetTexture2D( renderTarget.depthTexture, 0 );\n\n\t\t\tvar webglDepthTexture = properties.get( renderTarget.depthTexture ).__webglTexture;\n\n\t\t\tif ( renderTarget.depthTexture.format === DepthFormat ) {\n\n\t\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.TEXTURE_2D, webglDepthTexture, 0 );\n\n\t\t\t} else if ( renderTarget.depthTexture.format === DepthStencilFormat ) {\n\n\t\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.TEXTURE_2D, webglDepthTexture, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tthrow new Error('Unknown depthTexture format')\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Setup GL resources for a non-texture depth buffer\n\t\tfunction setupDepthRenderbuffer( renderTarget ) {\n\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\n\n\t\t\tvar isCube = ( renderTarget.isWebGLRenderTargetCube === true );\n\n\t\t\tif ( renderTarget.depthTexture ) {\n\n\t\t\t\tif ( isCube ) throw new Error('target.depthTexture not supported in Cube render targets');\n\n\t\t\t\tsetupDepthTexture( renderTargetProperties.__webglFramebuffer, renderTarget );\n\n\t\t\t} else {\n\n\t\t\t\tif ( isCube ) {\n\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer = [];\n\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer[ i ] );\n\t\t\t\t\t\trenderTargetProperties.__webglDepthbuffer[ i ] = _gl.createRenderbuffer();\n\t\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer[ i ], renderTarget );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer );\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer = _gl.createRenderbuffer();\n\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer, renderTarget );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\n\n\t\t}\n\n\t\t// Set up GL resources for the render target\n\t\tfunction setupRenderTarget( renderTarget ) {\n\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\n\n\t\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\n\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\n\n\t\t\t_infoMemory.textures ++;\n\n\t\t\tvar isCube = ( renderTarget.isWebGLRenderTargetCube === true );\n\t\t\tvar isTargetPowerOfTwo = isPowerOfTwo( renderTarget );\n\n\t\t\t// Setup framebuffer\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\trenderTargetProperties.__webglFramebuffer = [];\n\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\n\n\t\t\t}\n\n\t\t\t// Setup color buffer\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__webglTexture );\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, renderTarget.texture, isTargetPowerOfTwo );\n\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i );\n\n\t\t\t\t}\n\n\t\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\n\n\t\t\t} else {\n\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_2D, renderTarget.texture, isTargetPowerOfTwo );\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_2D );\n\n\t\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, null );\n\n\t\t\t}\n\n\t\t\t// Setup depth and stencil buffers\n\n\t\t\tif ( renderTarget.depthBuffer ) {\n\n\t\t\t\tsetupDepthRenderbuffer( renderTarget );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction updateRenderTargetMipmap( renderTarget ) {\n\n\t\t\tvar texture = renderTarget.texture;\n\n\t\t\tif ( texture.generateMipmaps && isPowerOfTwo( renderTarget ) &&\n\t\t\t\t\ttexture.minFilter !== NearestFilter &&\n\t\t\t\t\ttexture.minFilter !== LinearFilter ) {\n\n\t\t\t\tvar target = (renderTarget && renderTarget.isWebGLRenderTargetCube) ? _gl.TEXTURE_CUBE_MAP : _gl.TEXTURE_2D;\n\t\t\t\tvar webglTexture = properties.get( texture ).__webglTexture;\n\n\t\t\t\tstate.bindTexture( target, webglTexture );\n\t\t\t\t_gl.generateMipmap( target );\n\t\t\t\tstate.bindTexture( target, null );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setTexture2D = setTexture2D;\n\t\tthis.setTextureCube = setTextureCube;\n\t\tthis.setTextureCubeDynamic = setTextureCubeDynamic;\n\t\tthis.setupRenderTarget = setupRenderTarget;\n\t\tthis.updateRenderTargetMipmap = updateRenderTargetMipmap;\n\n\t}\n\n\t/**\n\t * @author fordacious / fordacious.github.io\n\t */\n\n\tfunction WebGLProperties() {\n\n\t\tvar properties = {};\n\n\t\treturn {\n\n\t\t\tget: function ( object ) {\n\n\t\t\t\tvar uuid = object.uuid;\n\t\t\t\tvar map = properties[ uuid ];\n\n\t\t\t\tif ( map === undefined ) {\n\n\t\t\t\t\tmap = {};\n\t\t\t\t\tproperties[ uuid ] = map;\n\n\t\t\t\t}\n\n\t\t\t\treturn map;\n\n\t\t\t},\n\n\t\t\tdelete: function ( object ) {\n\n\t\t\t\tdelete properties[ object.uuid ];\n\n\t\t\t},\n\n\t\t\tclear: function () {\n\n\t\t\t\tproperties = {};\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLState( gl, extensions, paramThreeToGL ) {\n\n\t\tfunction ColorBuffer() {\n\n\t\t\tvar locked = false;\n\n\t\t\tvar color = new Vector4();\n\t\t\tvar currentColorMask = null;\n\t\t\tvar currentColorClear = new Vector4();\n\n\t\t\treturn {\n\n\t\t\t\tsetMask: function ( colorMask ) {\n\n\t\t\t\t\tif ( currentColorMask !== colorMask && ! locked ) {\n\n\t\t\t\t\t\tgl.colorMask( colorMask, colorMask, colorMask, colorMask );\n\t\t\t\t\t\tcurrentColorMask = colorMask;\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\t\tlocked = lock;\n\n\t\t\t\t},\n\n\t\t\t\tsetClear: function ( r, g, b, a, premultipliedAlpha ) {\n\n\t\t\t\t\tif ( premultipliedAlpha === true ) {\n\n\t\t\t\t\t\tr *= a; g *= a; b *= a;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcolor.set( r, g, b, a );\n\n\t\t\t\t\tif ( currentColorClear.equals( color ) === false ) {\n\n\t\t\t\t\t\tgl.clearColor( r, g, b, a );\n\t\t\t\t\t\tcurrentColorClear.copy( color );\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\treset: function () {\n\n\t\t\t\t\tlocked = false;\n\n\t\t\t\t\tcurrentColorMask = null;\n\t\t\t\t\tcurrentColorClear.set( 0, 0, 0, 1 );\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\tfunction DepthBuffer() {\n\n\t\t\tvar locked = false;\n\n\t\t\tvar currentDepthMask = null;\n\t\t\tvar currentDepthFunc = null;\n\t\t\tvar currentDepthClear = null;\n\n\t\t\treturn {\n\n\t\t\t\tsetTest: function ( depthTest ) {\n\n\t\t\t\t\tif ( depthTest ) {\n\n\t\t\t\t\t\tenable( gl.DEPTH_TEST );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdisable( gl.DEPTH_TEST );\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tsetMask: function ( depthMask ) {\n\n\t\t\t\t\tif ( currentDepthMask !== depthMask && ! locked ) {\n\n\t\t\t\t\t\tgl.depthMask( depthMask );\n\t\t\t\t\t\tcurrentDepthMask = depthMask;\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tsetFunc: function ( depthFunc ) {\n\n\t\t\t\t\tif ( currentDepthFunc !== depthFunc ) {\n\n\t\t\t\t\t\tif ( depthFunc ) {\n\n\t\t\t\t\t\t\tswitch ( depthFunc ) {\n\n\t\t\t\t\t\t\t\tcase NeverDepth:\n\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.NEVER );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase AlwaysDepth:\n\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase LessDepth:\n\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.LESS );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase LessEqualDepth:\n\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase EqualDepth:\n\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.EQUAL );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase GreaterEqualDepth:\n\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase GreaterDepth:\n\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.GREATER );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase NotEqualDepth:\n\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrentDepthFunc = depthFunc;\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\t\tlocked = lock;\n\n\t\t\t\t},\n\n\t\t\t\tsetClear: function ( depth ) {\n\n\t\t\t\t\tif ( currentDepthClear !== depth ) {\n\n\t\t\t\t\t\tgl.clearDepth( depth );\n\t\t\t\t\t\tcurrentDepthClear = depth;\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\treset: function () {\n\n\t\t\t\t\tlocked = false;\n\n\t\t\t\t\tcurrentDepthMask = null;\n\t\t\t\t\tcurrentDepthFunc = null;\n\t\t\t\t\tcurrentDepthClear = null;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\tfunction StencilBuffer() {\n\n\t\t\tvar locked = false;\n\n\t\t\tvar currentStencilMask = null;\n\t\t\tvar currentStencilFunc = null;\n\t\t\tvar currentStencilRef = null;\n\t\t\tvar currentStencilFuncMask = null;\n\t\t\tvar currentStencilFail = null;\n\t\t\tvar currentStencilZFail = null;\n\t\t\tvar currentStencilZPass = null;\n\t\t\tvar currentStencilClear = null;\n\n\t\t\treturn {\n\n\t\t\t\tsetTest: function ( stencilTest ) {\n\n\t\t\t\t\tif ( stencilTest ) {\n\n\t\t\t\t\t\tenable( gl.STENCIL_TEST );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdisable( gl.STENCIL_TEST );\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tsetMask: function ( stencilMask ) {\n\n\t\t\t\t\tif ( currentStencilMask !== stencilMask && ! locked ) {\n\n\t\t\t\t\t\tgl.stencilMask( stencilMask );\n\t\t\t\t\t\tcurrentStencilMask = stencilMask;\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tsetFunc: function ( stencilFunc, stencilRef, stencilMask ) {\n\n\t\t\t\t\tif ( currentStencilFunc !== stencilFunc ||\n\t\t\t\t\t     currentStencilRef \t!== stencilRef \t||\n\t\t\t\t\t     currentStencilFuncMask !== stencilMask ) {\n\n\t\t\t\t\t\tgl.stencilFunc( stencilFunc, stencilRef, stencilMask );\n\n\t\t\t\t\t\tcurrentStencilFunc = stencilFunc;\n\t\t\t\t\t\tcurrentStencilRef = stencilRef;\n\t\t\t\t\t\tcurrentStencilFuncMask = stencilMask;\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tsetOp: function ( stencilFail, stencilZFail, stencilZPass ) {\n\n\t\t\t\t\tif ( currentStencilFail\t !== stencilFail \t||\n\t\t\t\t\t     currentStencilZFail !== stencilZFail ||\n\t\t\t\t\t     currentStencilZPass !== stencilZPass ) {\n\n\t\t\t\t\t\tgl.stencilOp( stencilFail, stencilZFail, stencilZPass );\n\n\t\t\t\t\t\tcurrentStencilFail = stencilFail;\n\t\t\t\t\t\tcurrentStencilZFail = stencilZFail;\n\t\t\t\t\t\tcurrentStencilZPass = stencilZPass;\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\t\tlocked = lock;\n\n\t\t\t\t},\n\n\t\t\t\tsetClear: function ( stencil ) {\n\n\t\t\t\t\tif ( currentStencilClear !== stencil ) {\n\n\t\t\t\t\t\tgl.clearStencil( stencil );\n\t\t\t\t\t\tcurrentStencilClear = stencil;\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\treset: function () {\n\n\t\t\t\t\tlocked = false;\n\n\t\t\t\t\tcurrentStencilMask = null;\n\t\t\t\t\tcurrentStencilFunc = null;\n\t\t\t\t\tcurrentStencilRef = null;\n\t\t\t\t\tcurrentStencilFuncMask = null;\n\t\t\t\t\tcurrentStencilFail = null;\n\t\t\t\t\tcurrentStencilZFail = null;\n\t\t\t\t\tcurrentStencilZPass = null;\n\t\t\t\t\tcurrentStencilClear = null;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\t//\n\n\t\tvar colorBuffer = new ColorBuffer();\n\t\tvar depthBuffer = new DepthBuffer();\n\t\tvar stencilBuffer = new StencilBuffer();\n\n\t\tvar maxVertexAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\n\t\tvar newAttributes = new Uint8Array( maxVertexAttributes );\n\t\tvar enabledAttributes = new Uint8Array( maxVertexAttributes );\n\t\tvar attributeDivisors = new Uint8Array( maxVertexAttributes );\n\n\t\tvar capabilities = {};\n\n\t\tvar compressedTextureFormats = null;\n\n\t\tvar currentBlending = null;\n\t\tvar currentBlendEquation = null;\n\t\tvar currentBlendSrc = null;\n\t\tvar currentBlendDst = null;\n\t\tvar currentBlendEquationAlpha = null;\n\t\tvar currentBlendSrcAlpha = null;\n\t\tvar currentBlendDstAlpha = null;\n\t\tvar currentPremultipledAlpha = false;\n\n\t\tvar currentFlipSided = null;\n\t\tvar currentCullFace = null;\n\n\t\tvar currentLineWidth = null;\n\n\t\tvar currentPolygonOffsetFactor = null;\n\t\tvar currentPolygonOffsetUnits = null;\n\n\t\tvar currentScissorTest = null;\n\n\t\tvar maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\n\n\t\tvar version = parseFloat( /^WebGL\\ ([0-9])/.exec( gl.getParameter( gl.VERSION ) )[ 1 ] );\n\t\tvar lineWidthAvailable = parseFloat( version ) >= 1.0;\n\n\t\tvar currentTextureSlot = null;\n\t\tvar currentBoundTextures = {};\n\n\t\tvar currentScissor = new Vector4();\n\t\tvar currentViewport = new Vector4();\n\n\t\tfunction createTexture( type, target, count ) {\n\n\t\t\tvar data = new Uint8Array( 4 ); // 4 is required to match default unpack alignment of 4.\n\t\t\tvar texture = gl.createTexture();\n\n\t\t\tgl.bindTexture( type, texture );\n\t\t\tgl.texParameteri( type, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\t\t\tgl.texParameteri( type, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\n\t\t\tfor ( var i = 0; i < count; i ++ ) {\n\n\t\t\t\tgl.texImage2D( target + i, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, data );\n\n\t\t\t}\n\n\t\t\treturn texture;\n\n\t\t}\n\n\t\tvar emptyTextures = {};\n\t\temptyTextures[ gl.TEXTURE_2D ] = createTexture( gl.TEXTURE_2D, gl.TEXTURE_2D, 1 );\n\t\temptyTextures[ gl.TEXTURE_CUBE_MAP ] = createTexture( gl.TEXTURE_CUBE_MAP, gl.TEXTURE_CUBE_MAP_POSITIVE_X, 6 );\n\n\t\t//\n\n\t\tfunction init() {\n\n\t\t\tcolorBuffer.setClear( 0, 0, 0, 1 );\n\t\t\tdepthBuffer.setClear( 1 );\n\t\t\tstencilBuffer.setClear( 0 );\n\n\t\t\tenable( gl.DEPTH_TEST );\n\t\t\tsetDepthFunc( LessEqualDepth );\n\n\t\t\tsetFlipSided( false );\n\t\t\tsetCullFace( CullFaceBack );\n\t\t\tenable( gl.CULL_FACE );\n\n\t\t\tenable( gl.BLEND );\n\t\t\tsetBlending( NormalBlending );\n\n\t\t}\n\n\t\tfunction initAttributes() {\n\n\t\t\tfor ( var i = 0, l = newAttributes.length; i < l; i ++ ) {\n\n\t\t\t\tnewAttributes[ i ] = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction enableAttribute( attribute ) {\n\n\t\t\tnewAttributes[ attribute ] = 1;\n\n\t\t\tif ( enabledAttributes[ attribute ] === 0 ) {\n\n\t\t\t\tgl.enableVertexAttribArray( attribute );\n\t\t\t\tenabledAttributes[ attribute ] = 1;\n\n\t\t\t}\n\n\t\t\tif ( attributeDivisors[ attribute ] !== 0 ) {\n\n\t\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\t\t\textension.vertexAttribDivisorANGLE( attribute, 0 );\n\t\t\t\tattributeDivisors[ attribute ] = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction enableAttributeAndDivisor( attribute, meshPerAttribute, extension ) {\n\n\t\t\tnewAttributes[ attribute ] = 1;\n\n\t\t\tif ( enabledAttributes[ attribute ] === 0 ) {\n\n\t\t\t\tgl.enableVertexAttribArray( attribute );\n\t\t\t\tenabledAttributes[ attribute ] = 1;\n\n\t\t\t}\n\n\t\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\n\n\t\t\t\textension.vertexAttribDivisorANGLE( attribute, meshPerAttribute );\n\t\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction disableUnusedAttributes() {\n\n\t\t\tfor ( var i = 0, l = enabledAttributes.length; i !== l; ++ i ) {\n\n\t\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\n\n\t\t\t\t\tgl.disableVertexAttribArray( i );\n\t\t\t\t\tenabledAttributes[ i ] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction enable( id ) {\n\n\t\t\tif ( capabilities[ id ] !== true ) {\n\n\t\t\t\tgl.enable( id );\n\t\t\t\tcapabilities[ id ] = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction disable( id ) {\n\n\t\t\tif ( capabilities[ id ] !== false ) {\n\n\t\t\t\tgl.disable( id );\n\t\t\t\tcapabilities[ id ] = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getCompressedTextureFormats() {\n\n\t\t\tif ( compressedTextureFormats === null ) {\n\n\t\t\t\tcompressedTextureFormats = [];\n\n\t\t\t\tif ( extensions.get( 'WEBGL_compressed_texture_pvrtc' ) ||\n\t\t\t\t     extensions.get( 'WEBGL_compressed_texture_s3tc' ) ||\n\t\t\t\t     extensions.get( 'WEBGL_compressed_texture_etc1' ) ) {\n\n\t\t\t\t\tvar formats = gl.getParameter( gl.COMPRESSED_TEXTURE_FORMATS );\n\n\t\t\t\t\tfor ( var i = 0; i < formats.length; i ++ ) {\n\n\t\t\t\t\t\tcompressedTextureFormats.push( formats[ i ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn compressedTextureFormats;\n\n\t\t}\n\n\t\tfunction setBlending( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\n\n\t\t\tif ( blending !== NoBlending ) {\n\n\t\t\t\tenable( gl.BLEND );\n\n\t\t\t} else {\n\n\t\t\t\tdisable( gl.BLEND );\n\n\t\t\t}\n\n\t\t\tif ( blending !== currentBlending || premultipliedAlpha !== currentPremultipledAlpha ) {\n\n\t\t\t\tif ( blending === AdditiveBlending ) {\n\n\t\t\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\n\t\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE, gl.ONE, gl.ONE );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\n\t\t\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( blending === SubtractiveBlending ) {\n\n\t\t\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\n\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ONE_MINUS_SRC_ALPHA );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\n\t\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.ONE_MINUS_SRC_COLOR );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( blending === MultiplyBlending ) {\n\n\t\t\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\n\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.SRC_COLOR, gl.ZERO, gl.SRC_ALPHA );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\n\t\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\n\t\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\n\t\t\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tcurrentBlending = blending;\n\t\t\t\tcurrentPremultipledAlpha = premultipliedAlpha;\n\n\t\t\t}\n\n\t\t\tif ( blending === CustomBlending ) {\n\n\t\t\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\n\t\t\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\n\t\t\t\tblendDstAlpha = blendDstAlpha || blendDst;\n\n\t\t\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\n\n\t\t\t\t\tgl.blendEquationSeparate( paramThreeToGL( blendEquation ), paramThreeToGL( blendEquationAlpha ) );\n\n\t\t\t\t\tcurrentBlendEquation = blendEquation;\n\t\t\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\n\t\t\t\t\tconsole.log(\"setting custom blend state\", blendEquation, blendEquationAlpha );\n\t\t\t\t}\n\n\t\t\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\n\n\t\t\t\t\tgl.blendFuncSeparate( paramThreeToGL( blendSrc ), paramThreeToGL( blendDst ), paramThreeToGL( blendSrcAlpha ), paramThreeToGL( blendDstAlpha ) );\n\t\t\t\t\tconsole.log(\"setting custom blend state\", blendSrc, blendDst, blendSrcAlpha, blendDstAlpha );\n\n\t\t\t\t\tcurrentBlendSrc = blendSrc;\n\t\t\t\t\tcurrentBlendDst = blendDst;\n\t\t\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\n\t\t\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tcurrentBlendEquation = null;\n\t\t\t\tcurrentBlendSrc = null;\n\t\t\t\tcurrentBlendDst = null;\n\t\t\t\tcurrentBlendEquationAlpha = null;\n\t\t\t\tcurrentBlendSrcAlpha = null;\n\t\t\t\tcurrentBlendDstAlpha = null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// TODO Deprecate\n\n\t\tfunction setColorWrite( colorWrite ) {\n\n\t\t\tcolorBuffer.setMask( colorWrite );\n\n\t\t}\n\n\t\tfunction setDepthTest( depthTest ) {\n\n\t\t\tdepthBuffer.setTest( depthTest );\n\n\t\t}\n\n\t\tfunction setDepthWrite( depthWrite ) {\n\n\t\t\tdepthBuffer.setMask( depthWrite );\n\n\t\t}\n\n\t\tfunction setDepthFunc( depthFunc ) {\n\n\t\t\tdepthBuffer.setFunc( depthFunc );\n\n\t\t}\n\n\t\tfunction setStencilTest( stencilTest ) {\n\n\t\t\tstencilBuffer.setTest( stencilTest );\n\n\t\t}\n\n\t\tfunction setStencilWrite( stencilWrite ) {\n\n\t\t\tstencilBuffer.setMask( stencilWrite );\n\n\t\t}\n\n\t\tfunction setStencilFunc( stencilFunc, stencilRef, stencilMask ) {\n\n\t\t\tstencilBuffer.setFunc( stencilFunc, stencilRef, stencilMask );\n\n\t\t}\n\n\t\tfunction setStencilOp( stencilFail, stencilZFail, stencilZPass ) {\n\n\t\t\tstencilBuffer.setOp( stencilFail, stencilZFail, stencilZPass );\n\n\t\t}\n\n\t\t//\n\n\t\tfunction setFlipSided( flipSided ) {\n\n\t\t\tif ( currentFlipSided !== flipSided ) {\n\n\t\t\t\tif ( flipSided ) {\n\n\t\t\t\t\tgl.frontFace( gl.CW );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgl.frontFace( gl.CCW );\n\n\t\t\t\t}\n\n\t\t\t\tcurrentFlipSided = flipSided;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction setCullFace( cullFace ) {\n\n\t\t\tif ( cullFace !== CullFaceNone ) {\n\n\t\t\t\tenable( gl.CULL_FACE );\n\n\t\t\t\tif ( cullFace !== currentCullFace ) {\n\n\t\t\t\t\tif ( cullFace === CullFaceBack ) {\n\n\t\t\t\t\t\tgl.cullFace( gl.BACK );\n\n\t\t\t\t\t} else if ( cullFace === CullFaceFront ) {\n\n\t\t\t\t\t\tgl.cullFace( gl.FRONT );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.cullFace( gl.FRONT_AND_BACK );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tdisable( gl.CULL_FACE );\n\n\t\t\t}\n\n\t\t\tcurrentCullFace = cullFace;\n\n\t\t}\n\n\t\tfunction setLineWidth( width ) {\n\n\t\t\tif ( width !== currentLineWidth ) {\n\n\t\t\t\tif ( lineWidthAvailable ) gl.lineWidth( width );\n\n\t\t\t\tcurrentLineWidth = width;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction setPolygonOffset( polygonOffset, factor, units ) {\n\n\t\t\tif ( polygonOffset ) {\n\n\t\t\t\tenable( gl.POLYGON_OFFSET_FILL );\n\n\t\t\t\tif ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) {\n\n\t\t\t\t\tgl.polygonOffset( factor, units );\n\n\t\t\t\t\tcurrentPolygonOffsetFactor = factor;\n\t\t\t\t\tcurrentPolygonOffsetUnits = units;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tdisable( gl.POLYGON_OFFSET_FILL );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getScissorTest() {\n\n\t\t\treturn currentScissorTest;\n\n\t\t}\n\n\t\tfunction setScissorTest( scissorTest ) {\n\n\t\t\tcurrentScissorTest = scissorTest;\n\n\t\t\tif ( scissorTest ) {\n\n\t\t\t\tenable( gl.SCISSOR_TEST );\n\n\t\t\t} else {\n\n\t\t\t\tdisable( gl.SCISSOR_TEST );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// texture\n\n\t\tfunction activeTexture( webglSlot ) {\n\n\t\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\n\n\t\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\t\tgl.activeTexture( webglSlot );\n\t\t\t\tcurrentTextureSlot = webglSlot;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction bindTexture( webglType, webglTexture ) {\n\n\t\t\tif ( currentTextureSlot === null ) {\n\n\t\t\t\tactiveTexture();\n\n\t\t\t}\n\n\t\t\tvar boundTexture = currentBoundTextures[ currentTextureSlot ];\n\n\t\t\tif ( boundTexture === undefined ) {\n\n\t\t\t\tboundTexture = { type: undefined, texture: undefined };\n\t\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\n\n\t\t\t}\n\n\t\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\n\n\t\t\t\tgl.bindTexture( webglType, webglTexture || emptyTextures[ webglType ] );\n\n\t\t\t\tboundTexture.type = webglType;\n\t\t\t\tboundTexture.texture = webglTexture;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction compressedTexImage2D() {\n\n\t\t\ttry {\n\n\t\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tconsole.error( error );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction texImage2D() {\n\n\t\t\ttry {\n\n\t\t\t\tgl.texImage2D.apply( gl, arguments );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tconsole.error( error );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tfunction scissor( scissor ) {\n\n\t\t\tif ( currentScissor.equals( scissor ) === false ) {\n\n\t\t\t\tgl.scissor( scissor.x, scissor.y, scissor.z, scissor.w );\n\t\t\t\tcurrentScissor.copy( scissor );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction viewport( viewport ) {\n\n\t\t\tif ( currentViewport.equals( viewport ) === false ) {\n\n\t\t\t\tgl.viewport( viewport.x, viewport.y, viewport.z, viewport.w );\n\t\t\t\tcurrentViewport.copy( viewport );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tfunction reset() {\n\n\t\t\tfor ( var i = 0; i < enabledAttributes.length; i ++ ) {\n\n\t\t\t\tif ( enabledAttributes[ i ] === 1 ) {\n\n\t\t\t\t\tgl.disableVertexAttribArray( i );\n\t\t\t\t\tenabledAttributes[ i ] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tcapabilities = {};\n\n\t\t\tcompressedTextureFormats = null;\n\n\t\t\tcurrentTextureSlot = null;\n\t\t\tcurrentBoundTextures = {};\n\n\t\t\tcurrentBlending = null;\n\n\t\t\tcurrentFlipSided = null;\n\t\t\tcurrentCullFace = null;\n\n\t\t\tcolorBuffer.reset();\n\t\t\tdepthBuffer.reset();\n\t\t\tstencilBuffer.reset();\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tbuffers: {\n\t\t\t\tcolor: colorBuffer,\n\t\t\t\tdepth: depthBuffer,\n\t\t\t\tstencil: stencilBuffer\n\t\t\t},\n\n\t\t\tinit: init,\n\t\t\tinitAttributes: initAttributes,\n\t\t\tenableAttribute: enableAttribute,\n\t\t\tenableAttributeAndDivisor: enableAttributeAndDivisor,\n\t\t\tdisableUnusedAttributes: disableUnusedAttributes,\n\t\t\tenable: enable,\n\t\t\tdisable: disable,\n\t\t\tgetCompressedTextureFormats: getCompressedTextureFormats,\n\n\t\t\tsetBlending: setBlending,\n\n\t\t\tsetColorWrite: setColorWrite,\n\t\t\tsetDepthTest: setDepthTest,\n\t\t\tsetDepthWrite: setDepthWrite,\n\t\t\tsetDepthFunc: setDepthFunc,\n\t\t\tsetStencilTest: setStencilTest,\n\t\t\tsetStencilWrite: setStencilWrite,\n\t\t\tsetStencilFunc: setStencilFunc,\n\t\t\tsetStencilOp: setStencilOp,\n\n\t\t\tsetFlipSided: setFlipSided,\n\t\t\tsetCullFace: setCullFace,\n\n\t\t\tsetLineWidth: setLineWidth,\n\t\t\tsetPolygonOffset: setPolygonOffset,\n\n\t\t\tgetScissorTest: getScissorTest,\n\t\t\tsetScissorTest: setScissorTest,\n\n\t\t\tactiveTexture: activeTexture,\n\t\t\tbindTexture: bindTexture,\n\t\t\tcompressedTexImage2D: compressedTexImage2D,\n\t\t\ttexImage2D: texImage2D,\n\n\t\t\tscissor: scissor,\n\t\t\tviewport: viewport,\n\n\t\t\treset: reset\n\n\t\t};\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLCapabilities( gl, extensions, parameters ) {\n\n\t\tvar maxAnisotropy;\n\n\t\tfunction getMaxAnisotropy() {\n\n\t\t\tif ( maxAnisotropy !== undefined ) return maxAnisotropy;\n\n\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tmaxAnisotropy = gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\n\n\t\t\t} else {\n\n\t\t\t\tmaxAnisotropy = 0;\n\n\t\t\t}\n\n\t\t\treturn maxAnisotropy;\n\n\t\t}\n\n\t\tfunction getMaxPrecision( precision ) {\n\n\t\t\tif ( precision === 'highp' ) {\n\n\t\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.HIGH_FLOAT ).precision > 0 &&\n\t\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.HIGH_FLOAT ).precision > 0 ) {\n\n\t\t\t\t\treturn 'highp';\n\n\t\t\t\t}\n\n\t\t\t\tprecision = 'mediump';\n\n\t\t\t}\n\n\t\t\tif ( precision === 'mediump' ) {\n\n\t\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.MEDIUM_FLOAT ).precision > 0 &&\n\t\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT ).precision > 0 ) {\n\n\t\t\t\t\treturn 'mediump';\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn 'lowp';\n\n\t\t}\n\n\t\tvar precision = parameters.precision !== undefined ? parameters.precision : 'highp';\n\t\tvar maxPrecision = getMaxPrecision( precision );\n\n\t\tif ( maxPrecision !== precision ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer:', precision, 'not supported, using', maxPrecision, 'instead.' );\n\t\t\tprecision = maxPrecision;\n\n\t\t}\n\n\t\tvar logarithmicDepthBuffer = parameters.logarithmicDepthBuffer === true && !! extensions.get( 'EXT_frag_depth' );\n\n\t\tvar maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\n\t\tvar maxVertexTextures = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS );\n\t\tvar maxTextureSize = gl.getParameter( gl.MAX_TEXTURE_SIZE );\n\t\tvar maxCubemapSize = gl.getParameter( gl.MAX_CUBE_MAP_TEXTURE_SIZE );\n\n\t\tvar maxAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\n\t\tvar maxVertexUniforms = gl.getParameter( gl.MAX_VERTEX_UNIFORM_VECTORS );\n\t\tvar maxVaryings = gl.getParameter( gl.MAX_VARYING_VECTORS );\n\t\tvar maxFragmentUniforms = gl.getParameter( gl.MAX_FRAGMENT_UNIFORM_VECTORS );\n\n\t\tvar vertexTextures = maxVertexTextures > 0;\n\t\tvar floatFragmentTextures = !! extensions.get( 'OES_texture_float' );\n\t\tvar floatVertexTextures = vertexTextures && floatFragmentTextures;\n\n\t\treturn {\n\n\t\t\tgetMaxAnisotropy: getMaxAnisotropy,\n\t\t\tgetMaxPrecision: getMaxPrecision,\n\n\t\t\tprecision: precision,\n\t\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\n\n\t\t\tmaxTextures: maxTextures,\n\t\t\tmaxVertexTextures: maxVertexTextures,\n\t\t\tmaxTextureSize: maxTextureSize,\n\t\t\tmaxCubemapSize: maxCubemapSize,\n\n\t\t\tmaxAttributes: maxAttributes,\n\t\t\tmaxVertexUniforms: maxVertexUniforms,\n\t\t\tmaxVaryings: maxVaryings,\n\t\t\tmaxFragmentUniforms: maxFragmentUniforms,\n\n\t\t\tvertexTextures: vertexTextures,\n\t\t\tfloatFragmentTextures: floatFragmentTextures,\n\t\t\tfloatVertexTextures: floatVertexTextures\n\n\t\t};\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WebGLExtensions( gl ) {\n\n\t\tvar extensions = {};\n\n\t\treturn {\n\n\t\t\tget: function ( name ) {\n\n\t\t\t\tif ( extensions[ name ] !== undefined ) {\n\n\t\t\t\t\treturn extensions[ name ];\n\n\t\t\t\t}\n\n\t\t\t\tvar extension;\n\n\t\t\t\tswitch ( name ) {\n\n\t\t\t\t\tcase 'WEBGL_depth_texture':\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_depth_texture' ) || gl.getExtension( 'MOZ_WEBGL_depth_texture' ) || gl.getExtension( 'WEBKIT_WEBGL_depth_texture' );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'EXT_texture_filter_anisotropic':\n\t\t\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'WEBGL_compressed_texture_s3tc':\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'WEBGL_compressed_texture_etc1':\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_etc1' );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\textension = gl.getExtension( name );\n\n\t\t\t\t}\n\n\t\t\t\tif ( extension === null ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\n\n\t\t\t\t}\n\n\t\t\t\textensions[ name ] = extension;\n\n\t\t\t\treturn extension;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/**\n\t * @author tschw\n\t */\n\n\tfunction WebGLClipping() {\n\n\t\tvar scope = this,\n\n\t\t\tglobalState = null,\n\t\t\tnumGlobalPlanes = 0,\n\t\t\tlocalClippingEnabled = false,\n\t\t\trenderingShadows = false,\n\n\t\t\tplane = new Plane(),\n\t\t\tviewNormalMatrix = new Matrix3(),\n\n\t\t\tuniform = { value: null, needsUpdate: false };\n\n\t\tthis.uniform = uniform;\n\t\tthis.numPlanes = 0;\n\t\tthis.numIntersection = 0;\n\n\t\tthis.init = function( planes, enableLocalClipping, camera ) {\n\n\t\t\tvar enabled =\n\t\t\t\tplanes.length !== 0 ||\n\t\t\t\tenableLocalClipping ||\n\t\t\t\t// enable state of previous frame - the clipping code has to\n\t\t\t\t// run another frame in order to reset the state:\n\t\t\t\tnumGlobalPlanes !== 0 ||\n\t\t\t\tlocalClippingEnabled;\n\n\t\t\tlocalClippingEnabled = enableLocalClipping;\n\n\t\t\tglobalState = projectPlanes( planes, camera, 0 );\n\t\t\tnumGlobalPlanes = planes.length;\n\n\t\t\treturn enabled;\n\n\t\t};\n\n\t\tthis.beginShadows = function() {\n\n\t\t\trenderingShadows = true;\n\t\t\tprojectPlanes( null );\n\n\t\t};\n\n\t\tthis.endShadows = function() {\n\n\t\t\trenderingShadows = false;\n\t\t\tresetGlobalState();\n\n\t\t};\n\n\t\tthis.setState = function( planes, clipIntersection, clipShadows, camera, cache, fromCache ) {\n\n\t\t\tif ( ! localClippingEnabled ||\n\t\t\t\t\tplanes === null || planes.length === 0 ||\n\t\t\t\t\trenderingShadows && ! clipShadows ) {\n\t\t\t\t// there's no local clipping\n\n\t\t\t\tif ( renderingShadows ) {\n\t\t\t\t\t// there's no global clipping\n\n\t\t\t\t\tprojectPlanes( null );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tresetGlobalState();\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tvar nGlobal = renderingShadows ? 0 : numGlobalPlanes,\n\t\t\t\t\tlGlobal = nGlobal * 4,\n\n\t\t\t\t\tdstArray = cache.clippingState || null;\n\n\t\t\t\tuniform.value = dstArray; // ensure unique state\n\n\t\t\t\tdstArray = projectPlanes( planes, camera, lGlobal, fromCache );\n\n\t\t\t\tfor ( var i = 0; i !== lGlobal; ++ i ) {\n\n\t\t\t\t\tdstArray[ i ] = globalState[ i ];\n\n\t\t\t\t}\n\n\t\t\t\tcache.clippingState = dstArray;\n\t\t\t\tthis.numIntersection = clipIntersection ? this.numPlanes : 0;\n\t\t\t\tthis.numPlanes += nGlobal;\n\n\t\t\t}\n\n\n\t\t};\n\n\t\tfunction resetGlobalState() {\n\n\t\t\tif ( uniform.value !== globalState ) {\n\n\t\t\t\tuniform.value = globalState;\n\t\t\t\tuniform.needsUpdate = numGlobalPlanes > 0;\n\n\t\t\t}\n\n\t\t\tscope.numPlanes = numGlobalPlanes;\n\t\t\tscope.numIntersection = 0;\n\n\t\t}\n\n\t\tfunction projectPlanes( planes, camera, dstOffset, skipTransform ) {\n\n\t\t\tvar nPlanes = planes !== null ? planes.length : 0,\n\t\t\t\tdstArray = null;\n\n\t\t\tif ( nPlanes !== 0 ) {\n\n\t\t\t\tdstArray = uniform.value;\n\n\t\t\t\tif ( skipTransform !== true || dstArray === null ) {\n\n\t\t\t\t\tvar flatSize = dstOffset + nPlanes * 4,\n\t\t\t\t\t\tviewMatrix = camera.matrixWorldInverse;\n\n\t\t\t\t\tviewNormalMatrix.getNormalMatrix( viewMatrix );\n\n\t\t\t\t\tif ( dstArray === null || dstArray.length < flatSize ) {\n\n\t\t\t\t\t\tdstArray = new Float32Array( flatSize );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var i = 0, i4 = dstOffset;\n\t\t\t\t\t\t\t\t\t\ti !== nPlanes; ++ i, i4 += 4 ) {\n\n\t\t\t\t\t\tplane.copy( planes[ i ] ).\n\t\t\t\t\t\t\t\tapplyMatrix4( viewMatrix, viewNormalMatrix );\n\n\t\t\t\t\t\tplane.normal.toArray( dstArray, i4 );\n\t\t\t\t\t\tdstArray[ i4 + 3 ] = plane.constant;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tuniform.value = dstArray;\n\t\t\t\tuniform.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tscope.numPlanes = nPlanes;\n\n\t\t\treturn dstArray;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Scene () {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Scene';\n\n\t\tthis.background = null;\n\t\tthis.fog = null;\n\t\tthis.overrideMaterial = null;\n\n\t\tthis.autoUpdate = true; // checked by the renderer\n\n\t}\n\n\tScene.prototype = Object.create( Object3D.prototype );\n\n\tScene.prototype.constructor = Scene;\n\n\tScene.prototype.copy = function ( source, recursive ) {\n\n\t\tObject3D.prototype.copy.call( this, source, recursive );\n\n\t\tif ( source.background !== null ) this.background = source.background.clone();\n\t\tif ( source.fog !== null ) this.fog = source.fog.clone();\n\t\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\n\n\t\tthis.autoUpdate = source.autoUpdate;\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\n\t\treturn this;\n\n\t};\n\n\tScene.prototype.toJSON = function ( meta ) {\n\n\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\n\n\t\tif ( this.background !== null ) data.object.background = this.background.toJSON( meta );\n\t\tif ( this.fog !== null ) data.object.fog = this.fog.toJSON();\n\n\t\treturn data;\n\n\t};\n\n\t/**\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author szimek / https://github.com/szimek/\n\t * @author tschw\n\t */\n\n\tfunction WebGLRenderer( parameters ) {\n\n\t\tconsole.log( 'THREE.WebGLRenderer', REVISION );\n\n\t\tparameters = parameters || {};\n\n\t\tvar _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' ),\n\t\t\t_context = parameters.context !== undefined ? parameters.context : null,\n\n\t\t\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\n\t\t\t_depth = parameters.depth !== undefined ? parameters.depth : true,\n\t\t\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\n\t\t\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\n\t\t\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\n\t\t\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false;\n\n\t\tvar lights = [];\n\n\t\tvar opaqueObjects = [];\n\t\tvar opaqueObjectsLastIndex = - 1;\n\t\tvar transparentObjects = [];\n\t\tvar transparentObjectsLastIndex = - 1;\n\n\t\tvar morphInfluences = new Float32Array( 8 );\n\n\t\tvar sprites = [];\n\t\tvar lensFlares = [];\n\n\t\tvar passScene = null, passCamera = null, passQuad = null;\n\n\t\t// public properties\n\n\t\tthis.domElement = _canvas;\n\t\tthis.context = null;\n\n\t\t// clearing\n\n\t\tthis.autoClear = true;\n\t\tthis.autoClearColor = true;\n\t\tthis.autoClearDepth = true;\n\t\tthis.autoClearStencil = true;\n\n\t\t// scene graph\n\n\t\tthis.sortObjects = true;\n\n\t\t// user-defined clipping\n\n\t\tthis.clippingPlanes = [];\n\t\tthis.localClippingEnabled = false;\n\n\t\t// physically based shading\n\n\t\tthis.gammaFactor = 2.0;\t// for backwards compatibility\n\t\tthis.gammaInput = false;\n\t\tthis.gammaOutput = false;\n\n\t\t// physical lights\n\n\t\tthis.physicallyCorrectLights = false;\n\n\t\t// tone mapping\n\n\t\tthis.toneMapping = LinearToneMapping;\n\t\tthis.toneMappingExposure = 1.0;\n\t\tthis.toneMappingWhitePoint = 1.0;\n\n\t\t// morphs\n\n\t\tthis.maxMorphTargets = 8;\n\t\tthis.maxMorphNormals = 4;\n\n\t\t// flags\n\n\t\tthis.autoScaleCubemaps = true;\n\t\tthis.autoResizeTextures = false;\n\n\t\t// internal properties\n\n\t\tvar _this = this,\n\n\t\t\t// internal state cache\n\n\t\t\t_currentProgram = null,\n\t\t\t_currentRenderTarget = null,\n\t\t\t_currentFramebuffer = null,\n\t\t\t_currentMaterialId = - 1,\n\t\t\t_currentGeometryProgram = '',\n\t\t\t_currentCamera = null,\n\n\t\t\t_currentScissor = new Vector4(),\n\t\t\t_currentScissorTest = null,\n\n\t\t\t_currentViewport = new Vector4(),\n\n\t\t\t//\n\n\t\t\t_usedTextureUnits = 0,\n\n\t\t\t//\n\n\t\t\t_clearColor = new Color( 0x000000 ),\n\t\t\t_clearAlpha = 0,\n\n\t\t\t_width = _canvas.width,\n\t\t\t_height = _canvas.height,\n\n\t\t\t_pixelRatio = 1,\n\n\t\t\t_scissor = new Vector4( 0, 0, _width, _height ),\n\t\t\t_scissorTest = false,\n\n\t\t\t_viewport = new Vector4( 0, 0, _width, _height ),\n\n\t\t\t// frustum\n\n\t\t\t_frustum = new Frustum(),\n\n\t\t\t// clipping\n\n\t\t\t_clipping = new WebGLClipping(),\n\t\t\t_clippingEnabled = false,\n\t\t\t_localClippingEnabled = false,\n\n\t\t\t_sphere = new Sphere(),\n\n\t\t\t// camera matrices cache\n\n\t\t\t_projScreenMatrix = new Matrix4(),\n\n\t\t\t_vector3 = new Vector3(),\n\t\t\t_matrix4 = new Matrix4(),\n\t\t\t_matrix42 = new Matrix4(),\n\n\t\t\t// light arrays cache\n\n\t\t\t_lights = {\n\n\t\t\t\thash: '',\n\n\t\t\tambient: [ 0, 0, 0 ],\n\t\t\tdirectional: [],\n\t\t\tdirectionalShadowMap: [],\n\t\t\tdirectionalShadowMatrix: [],\n\t\t\tspot: [],\n\t\t\tspotShadowMap: [],\n\t\t\tspotShadowMatrix: [],\n\t\t\trectArea: [],\n\t\t\tpoint: [],\n\t\t\tpointShadowMap: [],\n\t\t\tpointShadowMatrix: [],\n\t\t\themi: [],\n\n\t\t\t\tshadows: []\n\n\t\t\t},\n\n\t\t\t// info\n\n\t\t\t_infoRender = {\n\n\t\t\t\tcalls: 0,\n\t\t\t\tvertices: 0,\n\t\t\t\tfaces: 0,\n\t\t\t\tpoints: 0\n\n\t\t\t};\n\n\t\tthis.info = {\n\n\t\t\trender: _infoRender,\n\t\t\tmemory: {\n\n\t\t\t\tgeometries: 0,\n\t\t\t\ttextures: 0\n\n\t\t\t},\n\t\t\tprograms: null\n\n\t\t};\n\n\n\t\t// initialize\n\n\t\tvar _gl;\n\n\t\ttry {\n\n\t\t\tvar attributes = {\n\t\t\t\talpha: _alpha,\n\t\t\t\tdepth: _depth,\n\t\t\t\tstencil: _stencil,\n\t\t\t\tantialias: _antialias,\n\t\t\t\tpremultipliedAlpha: _premultipliedAlpha,\n\t\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer\n\t\t\t};\n\n\t\t\t_gl = _context || _canvas.getContext( 'webgl', attributes ) || _canvas.getContext( 'experimental-webgl', attributes );\n\n\t\t\tif ( _gl === null ) {\n\n\t\t\t\tif ( _canvas.getContext( 'webgl' ) !== null ) {\n\n\t\t\t\t\tthrow 'Error creating WebGL context with your selected attributes.';\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow 'Error creating WebGL context.';\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Some experimental-webgl implementations do not have getShaderPrecisionFormat\n\n\t\t\tif ( _gl.getShaderPrecisionFormat === undefined ) {\n\n\t\t\t\t_gl.getShaderPrecisionFormat = function () {\n\n\t\t\t\t\treturn { 'rangeMin': 1, 'rangeMax': 1, 'precision': 1 };\n\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer: ' + error );\n\n\t\t}\n\n\t\tvar extensions = new WebGLExtensions( _gl );\n\n\t\textensions.get( 'WEBGL_depth_texture' );\n\t\textensions.get( 'OES_texture_float' );\n\t\textensions.get( 'OES_texture_float_linear' );\n\t\textensions.get( 'OES_texture_half_float' );\n\t\textensions.get( 'OES_texture_half_float_linear' );\n\t\textensions.get( 'OES_standard_derivatives' );\n\t\textensions.get( 'ANGLE_instanced_arrays' );\n\n\t\tif ( extensions.get( 'OES_element_index_uint' ) ) {\n\n\t\t\tBufferGeometry.MaxIndex = 4294967296;\n\n\t\t}\n\n\t\tvar capabilities = new WebGLCapabilities( _gl, extensions, parameters );\n\n\t\tvar state = new WebGLState( _gl, extensions, paramThreeToGL );\n\t\tvar properties = new WebGLProperties();\n\t\tvar textures = new WebGLTextures( _gl, extensions, state, properties, capabilities, paramThreeToGL, this.info );\n\t\tvar objects = new WebGLObjects( _gl, properties, this.info );\n\t\tvar programCache = new WebGLPrograms( this, capabilities );\n\t\tvar lightCache = new WebGLLights();\n\n\t\tthis.info.programs = programCache.programs;\n\n\t\tvar bufferRenderer = new WebGLBufferRenderer( _gl, extensions, _infoRender );\n\t\tvar indexedBufferRenderer = new WebGLIndexedBufferRenderer( _gl, extensions, _infoRender );\n\n\t\t//\n\n\t\tvar backgroundCamera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\t\tvar backgroundCamera2 = new PerspectiveCamera();\n\t\tvar backgroundPlaneMesh = new Mesh(\n\t\t\tnew PlaneBufferGeometry( 2, 2 ),\n\t\t\tnew MeshBasicMaterial( { depthTest: false, depthWrite: false, fog: false } )\n\t\t);\n\t\tvar backgroundBoxShader = ShaderLib[ 'cube' ];\n\t\tvar backgroundBoxMesh = new Mesh(\n\t\t\tnew BoxBufferGeometry( 5, 5, 5 ),\n\t\t\tnew ShaderMaterial( {\n\t\t\t\tuniforms: backgroundBoxShader.uniforms,\n\t\t\t\tvertexShader: backgroundBoxShader.vertexShader,\n\t\t\t\tfragmentShader: backgroundBoxShader.fragmentShader,\n\t\t\t\tside: BackSide,\n\t\t\t\tdepthTest: false,\n\t\t\t\tdepthWrite: false,\n\t\t\t\tfog: false\n\t\t\t} )\n\t\t);\n\n\t\t//\n\n\t\tfunction getTargetPixelRatio() {\n\n\t\t\treturn _currentRenderTarget === null ? _pixelRatio : 1;\n\n\t\t}\n\n\t\tfunction setDefaultGLState() {\n\n\t\t\tstate.init();\n\n\t\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ) );\n\t\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ) );\n\n\t\t\tstate.buffers.color.setClear( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha, _premultipliedAlpha );\n\n\t\t}\n\n\t\tfunction resetGLState() {\n\n\t\t\t_currentProgram = null;\n\t\t\t_currentCamera = null;\n\n\t\t\t_currentGeometryProgram = '';\n\t\t\t_currentMaterialId = - 1;\n\n\t\t\tstate.reset();\n\n\t\t}\n\n\t\tsetDefaultGLState();\n\n\t\tthis.context = _gl;\n\t\tthis.capabilities = capabilities;\n\t\tthis.extensions = extensions;\n\t\tthis.properties = properties;\n\t\tthis.state = state;\n\n\t\t// shadow map\n\n\t\tvar shadowMap = new WebGLShadowMap( this, _lights, objects, capabilities );\n\n\t\tthis.shadowMap = shadowMap;\n\n\n\t\t// Plugins\n\n\t\tvar spritePlugin = new SpritePlugin( this, sprites );\n\t\tvar lensFlarePlugin = new LensFlarePlugin( this, lensFlares );\n\n\t\t// API\n\n\t\tthis.getContext = function () {\n\n\t\t\treturn _gl;\n\n\t\t};\n\n\t\tthis.getContextAttributes = function () {\n\n\t\t\treturn _gl.getContextAttributes();\n\n\t\t};\n\n\t\tthis.forceContextLoss = function () {\n\n\t\t\textensions.get( 'WEBGL_lose_context' ).loseContext();\n\n\t\t};\n\n\t\tthis.getMaxAnisotropy = function () {\n\n\t\t\treturn capabilities.getMaxAnisotropy();\n\n\t\t};\n\n\t\tthis.getPrecision = function () {\n\n\t\t\treturn capabilities.precision;\n\n\t\t};\n\n\t\tthis.getPixelRatio = function () {\n\n\t\t\treturn _pixelRatio;\n\n\t\t};\n\n\t\tthis.setPixelRatio = function ( value ) {\n\n\t\t\tif ( value === undefined ) return;\n\n\t\t\t_pixelRatio = value;\n\n\t\t\tthis.setSize( _viewport.z, _viewport.w, false );\n\n\t\t};\n\n\t\tthis.getSize = function () {\n\n\t\t\treturn {\n\t\t\t\twidth: _width,\n\t\t\t\theight: _height\n\t\t\t};\n\n\t\t};\n\n\t\tthis.setSize = function ( width, height, updateStyle ) {\n\n\t\t\t_width = width;\n\t\t\t_height = height;\n\n\t\t\t_canvas.width = width * _pixelRatio;\n\t\t\t_canvas.height = height * _pixelRatio;\n\n\t\t\tif ( updateStyle !== false ) {\n\n\t\t\t\t_canvas.style.width = width + 'px';\n\t\t\t\t_canvas.style.height = height + 'px';\n\n\t\t\t}\n\n\t\t\tthis.setViewport( 0, 0, width, height );\n\n\t\t};\n\n\t\tthis.setViewport = function ( x, y, width, height ) {\n\n\t\t\tstate.viewport( _viewport.set( x, y, width, height ) );\n\n\t\t};\n\n\t\tthis.setScissor = function ( x, y, width, height ) {\n\n\t\t\tstate.scissor( _scissor.set( x, y, width, height ) );\n\n\t\t};\n\n\t\tthis.setScissorTest = function ( boolean ) {\n\n\t\t\tstate.setScissorTest( _scissorTest = boolean );\n\n\t\t};\n\n\t\t// Clearing\n\n\t\tthis.getClearColor = function () {\n\n\t\t\treturn _clearColor;\n\n\t\t};\n\n\t\tthis.setClearColor = function ( color, alpha ) {\n\n\t\t\t_clearColor.set( color );\n\n\t\t\t_clearAlpha = alpha !== undefined ? alpha : 1;\n\n\t\t\tstate.buffers.color.setClear( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha, _premultipliedAlpha );\n\n\t\t};\n\n\t\tthis.getClearAlpha = function () {\n\n\t\t\treturn _clearAlpha;\n\n\t\t};\n\n\t\tthis.setClearAlpha = function ( alpha ) {\n\n\t\t\t_clearAlpha = alpha;\n\n\t\t\tstate.buffers.color.setClear( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha, _premultipliedAlpha );\n\n\t\t};\n\n\t\tthis.clear = function ( color, depth, stencil ) {\n\n\t\t\tvar bits = 0;\n\n\t\t\tif ( color === undefined || color ) bits |= _gl.COLOR_BUFFER_BIT;\n\t\t\tif ( depth === undefined || depth ) bits |= _gl.DEPTH_BUFFER_BIT;\n\t\t\tif ( stencil === undefined || stencil ) bits |= _gl.STENCIL_BUFFER_BIT;\n\n\t\t\t_gl.clear( bits );\n\n\t\t};\n\n\t\tthis.clearColor = function () {\n\n\t\t\tthis.clear( true, false, false );\n\n\t\t};\n\n\t\tthis.clearDepth = function () {\n\n\t\t\tthis.clear( false, true, false );\n\n\t\t};\n\n\t\tthis.clearStencil = function () {\n\n\t\t\tthis.clear( false, false, true );\n\n\t\t};\n\n\t\tthis.clearTarget = function ( renderTarget, color, depth, stencil ) {\n\n\t\t\tthis.setRenderTarget( renderTarget );\n\t\t\tthis.clear( color, depth, stencil );\n\n\t\t};\n\n\t\t// Reset\n\n\t\tthis.resetGLState = resetGLState;\n\n\t\tthis.dispose = function() {\n\n\t\t\ttransparentObjects = [];\n\t\t\ttransparentObjectsLastIndex = -1;\n\t\t\topaqueObjects = [];\n\t\t\topaqueObjectsLastIndex = -1;\n\n\t\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\n\n\t\t};\n\n\t\t// Events\n\n\t\tfunction onContextLost( event ) {\n\n\t\t\tevent.preventDefault();\n\n\t\t\tresetGLState();\n\t\t\tsetDefaultGLState();\n\n\t\t\tproperties.clear();\n\n\t\t}\n\n\t\tfunction onMaterialDispose( event ) {\n\n\t\t\tvar material = event.target;\n\n\t\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\n\n\t\t\tdeallocateMaterial( material );\n\n\t\t}\n\n\t\t// Buffer deallocation\n\n\t\tfunction deallocateMaterial( material ) {\n\n\t\t\treleaseMaterialProgramReference( material );\n\n\t\t\tproperties.delete( material );\n\n\t\t}\n\n\n\t\tfunction releaseMaterialProgramReference( material ) {\n\n\t\t\tvar programInfo = properties.get( material ).program;\n\n\t\t\tmaterial.program = undefined;\n\n\t\t\tif ( programInfo !== undefined ) {\n\n\t\t\t\tprogramCache.releaseProgram( programInfo );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Buffer rendering\n\n\t\tthis.renderBufferImmediate = function ( object, program, material ) {\n\n\t\t\tstate.initAttributes();\n\n\t\t\tvar buffers = properties.get( object );\n\n\t\t\tif ( object.hasPositions && ! buffers.position ) buffers.position = _gl.createBuffer();\n\t\t\tif ( object.hasNormals && ! buffers.normal ) buffers.normal = _gl.createBuffer();\n\t\t\tif ( object.hasUvs && ! buffers.uv ) buffers.uv = _gl.createBuffer();\n\t\t\tif ( object.hasColors && ! buffers.color ) buffers.color = _gl.createBuffer();\n\n\t\t\tvar attributes = program.getAttributes();\n\n\t\t\tif ( object.hasPositions ) {\n\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.position );\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW );\n\n\t\t\t\tstate.enableAttribute( attributes.position );\n\t\t\t\t_gl.vertexAttribPointer( attributes.position, 3, _gl.FLOAT, false, 0, 0 );\n\n\t\t\t}\n\n\t\t\tif ( object.hasNormals ) {\n\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.normal );\n\n\t\t\t\tif ( ! material.isMeshPhongMaterial &&\n\t\t\t\t\t! material.isMeshStandardMaterial &&\n\t\t\t\t\t! material.isMeshNormalMaterial &&\n\t\t\t\t\tmaterial.shading === FlatShading ) {\n\n\t\t\t\t\tfor ( var i = 0, l = object.count * 3; i < l; i += 9 ) {\n\n\t\t\t\t\t\tvar array = object.normalArray;\n\n\t\t\t\t\t\tvar nx = ( array[ i + 0 ] + array[ i + 3 ] + array[ i + 6 ] ) / 3;\n\t\t\t\t\t\tvar ny = ( array[ i + 1 ] + array[ i + 4 ] + array[ i + 7 ] ) / 3;\n\t\t\t\t\t\tvar nz = ( array[ i + 2 ] + array[ i + 5 ] + array[ i + 8 ] ) / 3;\n\n\t\t\t\t\t\tarray[ i + 0 ] = nx;\n\t\t\t\t\t\tarray[ i + 1 ] = ny;\n\t\t\t\t\t\tarray[ i + 2 ] = nz;\n\n\t\t\t\t\t\tarray[ i + 3 ] = nx;\n\t\t\t\t\t\tarray[ i + 4 ] = ny;\n\t\t\t\t\t\tarray[ i + 5 ] = nz;\n\n\t\t\t\t\t\tarray[ i + 6 ] = nx;\n\t\t\t\t\t\tarray[ i + 7 ] = ny;\n\t\t\t\t\t\tarray[ i + 8 ] = nz;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW );\n\n\t\t\t\tstate.enableAttribute( attributes.normal );\n\n\t\t\t\t_gl.vertexAttribPointer( attributes.normal, 3, _gl.FLOAT, false, 0, 0 );\n\n\t\t\t}\n\n\t\t\tif ( object.hasUvs && material.map ) {\n\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.uv );\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW );\n\n\t\t\t\tstate.enableAttribute( attributes.uv );\n\n\t\t\t\t_gl.vertexAttribPointer( attributes.uv, 2, _gl.FLOAT, false, 0, 0 );\n\n\t\t\t}\n\n\t\t\tif ( object.hasColors && material.vertexColors !== NoColors ) {\n\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.color );\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW );\n\n\t\t\t\tstate.enableAttribute( attributes.color );\n\n\t\t\t\t_gl.vertexAttribPointer( attributes.color, 3, _gl.FLOAT, false, 0, 0 );\n\n\t\t\t}\n\n\t\t\tstate.disableUnusedAttributes();\n\n\t\t\t_gl.drawArrays( _gl.TRIANGLES, 0, object.count );\n\n\t\t\tobject.count = 0;\n\n\t\t};\n\n\t\tthis.renderBufferDirect = function ( camera, fog, geometry, material, object, group ) {\n\n\t\t\tsetMaterial( material );\n\n\t\t\tvar program = setProgram( camera, fog, material, object );\n\n\t\t\tvar updateBuffers = false;\n\t\t\tvar geometryProgram = geometry.id + '_' + program.id + '_' + material.wireframe;\n\n\t\t\tif ( geometryProgram !== _currentGeometryProgram ) {\n\n\t\t\t\t_currentGeometryProgram = geometryProgram;\n\t\t\t\tupdateBuffers = true;\n\n\t\t\t}\n\n\t\t\t// morph targets\n\n\t\t\tvar morphTargetInfluences = object.morphTargetInfluences;\n\n\t\t\tif ( morphTargetInfluences !== undefined ) {\n\n\t\t\t\tvar activeInfluences = [];\n\n\t\t\t\tfor ( var i = 0, l = morphTargetInfluences.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar influence = morphTargetInfluences[ i ];\n\t\t\t\t\tactiveInfluences.push( [ influence, i ] );\n\n\t\t\t\t}\n\n\t\t\t\tactiveInfluences.sort( absNumericalSort );\n\n\t\t\t\tif ( activeInfluences.length > 8 ) {\n\n\t\t\t\t\tactiveInfluences.length = 8;\n\n\t\t\t\t}\n\n\t\t\t\tvar morphAttributes = geometry.morphAttributes;\n\n\t\t\t\tfor ( var i = 0, l = activeInfluences.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar influence = activeInfluences[ i ];\n\t\t\t\t\tmorphInfluences[ i ] = influence[ 0 ];\n\n\t\t\t\t\tif ( influence[ 0 ] !== 0 ) {\n\n\t\t\t\t\t\tvar index = influence[ 1 ];\n\n\t\t\t\t\t\tif ( material.morphTargets === true && morphAttributes.position ) geometry.addAttribute( 'morphTarget' + i, morphAttributes.position[ index ] );\n\t\t\t\t\t\tif ( material.morphNormals === true && morphAttributes.normal ) geometry.addAttribute( 'morphNormal' + i, morphAttributes.normal[ index ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( material.morphTargets === true ) geometry.removeAttribute( 'morphTarget' + i );\n\t\t\t\t\t\tif ( material.morphNormals === true ) geometry.removeAttribute( 'morphNormal' + i );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = activeInfluences.length, il = morphInfluences.length; i < il; i ++ ) {\n\n\t\t\t\t\tmorphInfluences[ i ] = 0.0;\n\n\t\t\t\t}\n\n\t\t\t\tprogram.getUniforms().setValue(\n\t\t\t\t\t_gl, 'morphTargetInfluences', morphInfluences );\n\n\t\t\t\tupdateBuffers = true;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tvar index = geometry.index;\n\t\t\tvar position = geometry.attributes.position;\n\t\t\tvar rangeFactor = 1;\n\n\t\t\tif ( material.wireframe === true ) {\n\n\t\t\t\tindex = objects.getWireframeAttribute( geometry );\n\t\t\t\trangeFactor = 2;\n\n\t\t\t}\n\n\t\t\tvar renderer;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\trenderer = indexedBufferRenderer;\n\t\t\t\trenderer.setIndex( index );\n\n\t\t\t} else {\n\n\t\t\t\trenderer = bufferRenderer;\n\n\t\t\t}\n\n\t\t\tif ( updateBuffers ) {\n\n\t\t\t\tsetupVertexAttributes( material, program, geometry );\n\n\t\t\t\tif ( index !== null ) {\n\n\t\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, objects.getAttributeBuffer( index ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tvar dataCount = 0;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tdataCount = index.count;\n\n\t\t\t} else if ( position !== undefined ) {\n\n\t\t\t\tdataCount = position.count;\n\n\t\t\t}\n\n\t\t\tvar rangeStart = geometry.drawRange.start * rangeFactor;\n\t\t\tvar rangeCount = geometry.drawRange.count * rangeFactor;\n\n\t\t\tvar groupStart = group !== null ? group.start * rangeFactor : 0;\n\t\t\tvar groupCount = group !== null ? group.count * rangeFactor : Infinity;\n\n\t\t\tvar drawStart = Math.max( rangeStart, groupStart );\n\t\t\tvar drawEnd = Math.min( dataCount, rangeStart + rangeCount, groupStart + groupCount ) - 1;\n\n\t\t\tvar drawCount = Math.max( 0, drawEnd - drawStart + 1 );\n\n\t\t\tif ( drawCount === 0 ) return;\n\n\t\t\t//\n\n\t\t\tif ( object.isMesh ) {\n\n\t\t\t\tif ( material.wireframe === true ) {\n\n\t\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * getTargetPixelRatio() );\n\t\t\t\t\trenderer.setMode( _gl.LINES );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tswitch ( object.drawMode ) {\n\n\t\t\t\t\t\tcase TrianglesDrawMode:\n\t\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLES );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TriangleStripDrawMode:\n\t\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLE_STRIP );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TriangleFanDrawMode:\n\t\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLE_FAN );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\n\t\t\t} else if ( object.isLine ) {\n\n\t\t\t\tvar lineWidth = material.linewidth;\n\n\t\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\n\n\t\t\t\tstate.setLineWidth( lineWidth * getTargetPixelRatio() );\n\n\t\t\t\tif ( object.isLineSegments ) {\n\n\t\t\t\t\trenderer.setMode( _gl.LINES );\n\n\t\t\t\t} else {\n\n\t\t\t\t\trenderer.setMode( _gl.LINE_STRIP );\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isPoints ) {\n\n\t\t\t\trenderer.setMode( _gl.POINTS );\n\n\t\t\t}\n\n\t\t\tif ( geometry && geometry.isInstancedBufferGeometry ) {\n\n\t\t\t\tif ( geometry.maxInstancedCount > 0 ) {\n\n\t\t\t\t\trenderer.renderInstances( geometry, drawStart, drawCount );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\trenderer.render( drawStart, drawCount );\n\n\t\t\t}\n\n\t\t};\n\n\t\tfunction setupVertexAttributes( material, program, geometry, startIndex ) {\n\n\t\t\tvar extension;\n\n\t\t\tif ( geometry && geometry.isInstancedBufferGeometry ) {\n\n\t\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\t\t\tif ( extension === null ) {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( startIndex === undefined ) startIndex = 0;\n\n\t\t\tstate.initAttributes();\n\n\t\t\tvar geometryAttributes = geometry.attributes;\n\n\t\t\tvar programAttributes = program.getAttributes();\n\n\t\t\tvar materialDefaultAttributeValues = material.defaultAttributeValues;\n\n\t\t\tfor ( var name in programAttributes ) {\n\n\t\t\t\tvar programAttribute = programAttributes[ name ];\n\n\t\t\t\tif ( programAttribute >= 0 ) {\n\n\t\t\t\t\tvar geometryAttribute = geometryAttributes[ name ];\n\n\t\t\t\t\tif ( geometryAttribute !== undefined ) {\n\n\t\t\t\t\t\tvar normalized = geometryAttribute.normalized;\n\t\t\t\t\t\tvar size = geometryAttribute.itemSize;\n\n\t\t\t\t\t\tvar attributeProperties = objects.getAttributeProperties( geometryAttribute );\n\n\t\t\t\t\t\tvar buffer = attributeProperties.__webglBuffer;\n\t\t\t\t\t\tvar type = attributeProperties.type;\n\t\t\t\t\t\tvar bytesPerElement = attributeProperties.bytesPerElement;\n\n\t\t\t\t\t\tif ( geometryAttribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\t\t\tvar data = geometryAttribute.data;\n\t\t\t\t\t\t\tvar stride = data.stride;\n\t\t\t\t\t\t\tvar offset = geometryAttribute.offset;\n\n\t\t\t\t\t\t\tif ( data && data.isInstancedInterleavedBuffer ) {\n\n\t\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, data.meshPerAttribute, extension );\n\n\t\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\n\n\t\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = data.meshPerAttribute * data.count;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\n\t\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, stride * bytesPerElement, ( startIndex * stride + offset ) * bytesPerElement );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( geometryAttribute.isInstancedBufferAttribute ) {\n\n\t\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, geometryAttribute.meshPerAttribute, extension );\n\n\t\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\n\n\t\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\n\t\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, 0, startIndex * size * bytesPerElement );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\n\n\t\t\t\t\t\tvar value = materialDefaultAttributeValues[ name ];\n\n\t\t\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\t\t\tswitch ( value.length ) {\n\n\t\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib2fv( programAttribute, value );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib3fv( programAttribute, value );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib4fv( programAttribute, value );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib1fv( programAttribute, value );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.disableUnusedAttributes();\n\n\t\t}\n\n\t\t// Sorting\n\n\t\tfunction absNumericalSort( a, b ) {\n\n\t\t\treturn Math.abs( b[ 0 ] ) - Math.abs( a[ 0 ] );\n\n\t\t}\n\n\t\tfunction painterSortStable( a, b ) {\n\n\t\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\n\n\t\t\t\treturn a.object.renderOrder - b.object.renderOrder;\n\n\t\t\t} else if ( a.material.program && b.material.program && a.material.program !== b.material.program ) {\n\n\t\t\t\treturn a.material.program.id - b.material.program.id;\n\n\t\t\t} else if ( a.material.id !== b.material.id ) {\n\n\t\t\t\treturn a.material.id - b.material.id;\n\n\t\t\t} else if ( a.z !== b.z ) {\n\n\t\t\t\treturn a.z - b.z;\n\n\t\t\t} else {\n\n\t\t\t\treturn a.id - b.id;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction reversePainterSortStable( a, b ) {\n\n\t\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\n\n\t\t\t\treturn a.object.renderOrder - b.object.renderOrder;\n\n\t\t\t} if ( a.z !== b.z ) {\n\n\t\t\t\treturn b.z - a.z;\n\n\t\t\t} else {\n\n\t\t\t\treturn a.id - b.id;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Rendering\n\n\t\tthis.renderOverride = function ( overrideMaterial, scene, camera, renderTarget, forceClear ) {\n\n\t\t\tscene.overrideMaterial = overrideMaterial;\n\t\t\tthis.render( scene, camera, renderTarget, forceClear );\n\t\t\tscene.overrideMaterial = null;\n\n\t\t};\n\n\t\tthis.renderPass = function ( passMaterial, renderTarget, forceClear ) {\n\n\t\t\tif( passScene === null ) {\n\t\t\t\tpassCamera = new OrthographicCamera( -1, 1, 1, -1, 0, 1 );\n\t\t\t\tpassQuad = new Mesh( new PlaneBufferGeometry( 2, 2 ), null );\n\t\t\t\tpassScene = new Scene();\n\t\t\t\tpassScene.add( passQuad );\n\t\t\t}\n\n\t\t\tpassQuad.material = passMaterial;\n\t\t\tthis.render( passScene, passCamera, renderTarget, forceClear );\n\t\t\tpassQuad.material = null;\n\n\t\t};\n\n\n\t\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\n\n\t\t\tif ( camera !== undefined && camera.isCamera !== true ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// reset caching for this frame\n\n\t\t\t_currentGeometryProgram = '';\n\t\t\t_currentMaterialId = - 1;\n\t\t\t_currentCamera = null;\n\n\t\t\t// update scene graph\n\n\t\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n\n\t\t\t// update camera matrices and frustum\n\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\n\n\t\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\n\n\t\t\tlights.length = 0;\n\n\t\t\topaqueObjectsLastIndex = - 1;\n\t\t\ttransparentObjectsLastIndex = - 1;\n\n\t\t\tsprites.length = 0;\n\t\t\tlensFlares.length = 0;\n\n\t\t\t_localClippingEnabled = this.localClippingEnabled;\n\t\t\t_clippingEnabled = _clipping.init( this.clippingPlanes, _localClippingEnabled, camera );\n\n\t\t\tprojectObject( scene, camera );\n\n\t\t\topaqueObjects.length = opaqueObjectsLastIndex + 1;\n\t\t\ttransparentObjects.length = transparentObjectsLastIndex + 1;\n\n\t\t\tif ( _this.sortObjects === true ) {\n\n\t\t\t\topaqueObjects.sort( painterSortStable );\n\t\t\t\ttransparentObjects.sort( reversePainterSortStable );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tif ( _clippingEnabled ) _clipping.beginShadows();\n\n\t\t\tsetupShadows( lights );\n\n\t\t\tshadowMap.render( scene, camera );\n\n\t\t\tsetupLights( lights, camera );\n\n\t\t\tif ( _clippingEnabled ) _clipping.endShadows();\n\n\t\t\t//\n\n\t\t\t_infoRender.calls = 0;\n\t\t\t_infoRender.vertices = 0;\n\t\t\t_infoRender.faces = 0;\n\t\t\t_infoRender.points = 0;\n\n\t\t\tif ( renderTarget === undefined ) {\n\n\t\t\t\trenderTarget = null;\n\n\t\t\t}\n\n\t\t\t//console.log( \"render() renderTarget: \", renderTarget );\n\n\t\t\tthis.setRenderTarget( renderTarget );\n\n\t\t\t//\n\n\t\t\tvar background = scene.background;\n\t\t\tbackground = null;\n\n\t\t\tif ( background === null ) {\n\n\t\t\t\tstate.buffers.color.setClear( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha, _premultipliedAlpha );\n\n\t\t\t} else if ( background && background.isColor ) {\n\n\t\t\t\tstate.buffers.color.setClear( background.r, background.g, background.b, 1, _premultipliedAlpha );\n\t\t\t\tforceClear = true;\n\n\t\t\t}\n\n\t\t\tif ( this.autoClear || forceClear ) {\n\n\t\t\t\tthis.clear( this.autoClearColor, this.autoClearDepth, this.autoClearStencil );\n\n\t\t\t}\n\n\t\t\tif ( background && background.isCubeTexture ) {\n\n\t\t\t\tbackgroundCamera2.projectionMatrix.copy( camera.projectionMatrix );\n\n\t\t\t\tbackgroundCamera2.matrixWorld.extractRotation( camera.matrixWorld );\n\t\t\t\tbackgroundCamera2.matrixWorldInverse.getInverse( backgroundCamera2.matrixWorld );\n\n\t\t\t\tbackgroundBoxMesh.material.uniforms[ \"tCube\" ].value = background;\n\t\t\t\tbackgroundBoxMesh.modelViewMatrix.multiplyMatrices( backgroundCamera2.matrixWorldInverse, backgroundBoxMesh.matrixWorld );\n\n\t\t\t\tobjects.update( backgroundBoxMesh );\n\n\t\t\t\t_this.renderBufferDirect( backgroundCamera2, null, backgroundBoxMesh.geometry, backgroundBoxMesh.material, backgroundBoxMesh, null );\n\n\t\t\t} else if ( background && background.isTexture ) {\n\n\t\t\t\tbackgroundPlaneMesh.material.map = background;\n\n\t\t\t\tobjects.update( backgroundPlaneMesh );\n\n\t\t\t\t_this.renderBufferDirect( backgroundCamera, null, backgroundPlaneMesh.geometry, backgroundPlaneMesh.material, backgroundPlaneMesh, null );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tif ( scene.overrideMaterial ) {\n\n\t\t\t\tvar overrideMaterial = scene.overrideMaterial;\n\n\t\t\t\trenderObjects( opaqueObjects, scene, camera, overrideMaterial );\n\t\t\t\trenderObjects( transparentObjects, scene, camera, overrideMaterial );\n\n\t\t\t} else {\n\n\t\t\t\t// opaque pass (front-to-back order)\n\n\t\t\t\tstate.setBlending( NoBlending );\n\t\t\t\trenderObjects( opaqueObjects, scene, camera );\n\n\t\t\t\t// transparent pass (back-to-front order)\n\n\t\t\t\trenderObjects( transparentObjects, scene, camera );\n\n\t\t\t}\n\n\t\t\t// custom render plugins (post pass)\n\n\t\t\tspritePlugin.render( scene, camera );\n\t\t\tlensFlarePlugin.render( scene, camera, _currentViewport );\n\n\t\t\t// Generate mipmap if we're using any kind of mipmap filtering\n\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\ttextures.updateRenderTargetMipmap( renderTarget );\n\n\t\t\t}\n\n\t\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\n\n\t\t\tstate.setDepthTest( true );\n\t\t\tstate.setDepthWrite( true );\n\t\t\tstate.setColorWrite( true );\n\n\t\t\t// _gl.finish();\n\n\t\t};\n\n\t\tfunction pushRenderItem( object, geometry, material, z, group ) {\n\n\t\t\tvar array, index;\n\n\t\t\t// allocate the next position in the appropriate array\n\n\t\t\tif ( material.transparent ) {\n\n\t\t\t\tarray = transparentObjects;\n\t\t\t\tindex = ++ transparentObjectsLastIndex;\n\n\t\t\t} else {\n\n\t\t\t\tarray = opaqueObjects;\n\t\t\t\tindex = ++ opaqueObjectsLastIndex;\n\n\t\t\t}\n\n\t\t\t// recycle existing render item or grow the array\n\n\t\t\tvar renderItem = array[ index ];\n\n\t\t\tif ( renderItem !== undefined ) {\n\n\t\t\t\trenderItem.id = object.id;\n\t\t\t\trenderItem.object = object;\n\t\t\t\trenderItem.geometry = geometry;\n\t\t\t\trenderItem.material = material;\n\t\t\t\trenderItem.z = _vector3.z;\n\t\t\t\trenderItem.group = group;\n\n\t\t\t} else {\n\n\t\t\t\trenderItem = {\n\t\t\t\t\tid: object.id,\n\t\t\t\t\tobject: object,\n\t\t\t\t\tgeometry: geometry,\n\t\t\t\t\tmaterial: material,\n\t\t\t\t\tz: _vector3.z,\n\t\t\t\t\tgroup: group\n\t\t\t\t};\n\n\t\t\t\t// assert( index === array.length );\n\t\t\t\tarray.push( renderItem );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// TODO Duplicated code (Frustum)\n\n\t\tfunction isObjectViewable( object ) {\n\n\t\t\tvar geometry = object.geometry;\n\n\t\t\tif ( geometry.boundingSphere === null )\n\t\t\t\tgeometry.computeBoundingSphere();\n\n\t\t\t_sphere.copy( geometry.boundingSphere ).\n\t\t\tapplyMatrix4( object.matrixWorld );\n\n\t\t\treturn isSphereViewable( _sphere );\n\n\t\t}\n\n\t\tfunction isSpriteViewable( sprite ) {\n\n\t\t\t_sphere.center.set( 0, 0, 0 );\n\t\t\t_sphere.radius = 0.7071067811865476;\n\t\t\t_sphere.applyMatrix4( sprite.matrixWorld );\n\n\t\t\treturn isSphereViewable( _sphere );\n\n\t\t}\n\n\t\tfunction isSphereViewable( sphere ) {\n\n\t\t\tif ( ! _frustum.intersectsSphere( sphere ) ) return false;\n\n\t\t\tvar numPlanes = _clipping.numPlanes;\n\n\t\t\tif ( numPlanes === 0 ) return true;\n\n\t\t\tvar planes = _this.clippingPlanes,\n\n\t\t\t\tcenter = sphere.center,\n\t\t\t\tnegRad = - sphere.radius,\n\t\t\t\ti = 0;\n\n\t\t\tdo {\n\n\t\t\t\t// out when deeper than radius in the negative halfspace\n\t\t\t\tif ( planes[ i ].distanceToPoint( center ) < negRad ) return false;\n\n\t\t\t} while ( ++ i !== numPlanes );\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tfunction projectObject( object, camera ) {\n\n\t\t\tif ( object.visible === false ) return;\n\n\t\t\tvar visible = ( object.layers.mask & camera.layers.mask ) !== 0;\n\n\t\t\tif ( visible ) {\n\n\t\t\t\tif ( object.isLight ) {\n\n\t\t\t\t\tlights.push( object );\n\n\t\t\t\t} else if ( object.isSprite ) {\n\n\t\t\t\t\tif ( object.frustumCulled === false || isSpriteViewable( object ) === true ) {\n\n\t\t\t\t\t\tsprites.push( object );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( object.isLensFlare ) {\n\n\t\t\t\t\tlensFlares.push( object );\n\n\t\t\t\t} else if ( object.isImmediateRenderObject ) {\n\n\t\t\t\t\tif ( _this.sortObjects === true ) {\n\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\n\t\t\t\t\t\t_vector3.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tpushRenderItem( object, null, object.material, _vector3.z, null );\n\n\t\t\t\t} else if ( object.isMesh || object.isLine || object.isPoints ) {\n\n\t\t\t\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\t\t\t\tobject.skeleton.update();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( object.frustumCulled === false || isObjectViewable( object ) === true ) {\n\n\t\t\t\t\t\tvar material = object.material;\n\n\t\t\t\t\t\tif ( material.visible === true ) {\n\n\t\t\t\t\t\t\tif ( _this.sortObjects === true ) {\n\n\t\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\n\t\t\t\t\t\t\t\t_vector3.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar geometry = objects.update( object );\n\n\t\t\t\t\t\t\tif ( material.isMultiMaterial ) {\n\n\t\t\t\t\t\t\t\tvar groups = geometry.groups;\n\t\t\t\t\t\t\t\tvar materials = material.materials;\n\n\t\t\t\t\t\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t\t\t\tvar group = groups[ i ];\n\t\t\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\n\n\t\t\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\n\n\t\t\t\t\t\t\t\t\t\tpushRenderItem( object, geometry, groupMaterial, _vector3.z, group );\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tpushRenderItem( object, geometry, material, _vector3.z, null );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar children = object.children;\n\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tprojectObject( children[ i ], camera );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction renderObjects( renderList, scene, camera, overrideMaterial ) {\n\n\t\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\n\n\t\t\t\tvar renderItem = renderList[ i ];\n\n\t\t\t\tvar object = renderItem.object;\n\t\t\t\tvar geometry = renderItem.geometry;\n\t\t\t\tvar material = overrideMaterial === undefined ? renderItem.material : overrideMaterial;\n\t\t\t\tvar group = renderItem.group;\n\n\t\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\t\t\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\n\n\t\t\t\tobject.onBeforeRender( _this, scene, camera, geometry, material, group );\n\n\t\t\t\tif ( object.isImmediateRenderObject ) {\n\n\t\t\t\t\tsetMaterial( material );\n\n\t\t\t\t\tvar program = setProgram( camera, scene.fog, material, object );\n\n\t\t\t\t\t_currentGeometryProgram = '';\n\n\t\t\t\t\tobject.render( function ( object ) {\n\n\t\t\t\t\t\t_this.renderBufferImmediate( object, program, material );\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_this.renderBufferDirect( camera, scene.fog, geometry, material, object, group );\n\n\t\t\t\t}\n\n\t\t\t\tobject.onAfterRender( _this, scene, camera, geometry, material, group );\n\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction initMaterial( material, fog, object ) {\n\n\t\t\tvar materialProperties = properties.get( material );\n\n\t\t\tvar parameters = programCache.getParameters(\n\t\t\t\tmaterial, _lights, fog, _clipping.numPlanes, _clipping.numIntersection, object );\n\n\t\t\tvar code = programCache.getProgramCode( material, parameters );\n\n\t\t\tvar program = materialProperties.program;\n\t\t\tvar programChange = true;\n\n\t\t\tif ( program === undefined ) {\n\n\t\t\t\t// new material\n\t\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\n\n\t\t\t} else if ( program.code !== code ) {\n\n\t\t\t\t// changed glsl or parameters\n\t\t\t\treleaseMaterialProgramReference( material );\n\n\t\t\t} else if ( parameters.shaderID !== undefined ) {\n\n\t\t\t\t// same glsl and uniform list\n\t\t\t\treturn;\n\n\t\t\t} else {\n\n\t\t\t\t// only rebuild uniform list\n\t\t\t\tprogramChange = false;\n\n\t\t\t}\n\n\t\t\tif ( programChange ) {\n\n\t\t\t\tif ( parameters.shaderID ) {\n\n\t\t\t\t\tvar shader = ShaderLib[ parameters.shaderID ];\n\n\t\t\t\t\tmaterialProperties.__webglShader = {\n\t\t\t\t\t\tname: material.type,\n\t\t\t\t\t\tuniforms: UniformsUtils.clone( shader.uniforms ),\n\t\t\t\t\t\tvertexShader: shader.vertexShader,\n\t\t\t\t\t\tfragmentShader: shader.fragmentShader\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\tmaterialProperties.__webglShader = {\n\t\t\t\t\t\tname: material.type,\n\t\t\t\t\t\tuniforms: material.uniforms,\n\t\t\t\t\t\tvertexShader: material.vertexShader,\n\t\t\t\t\t\tfragmentShader: material.fragmentShader\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tmaterial.__webglShader = materialProperties.__webglShader;\n\n\t\t\t\tprogram = programCache.acquireProgram( material, parameters, code );\n\n\t\t\t\tmaterialProperties.program = program;\n\t\t\t\tmaterial.program = program;\n\n\t\t\t}\n\n\t\t\tvar attributes = program.getAttributes();\n\n\t\t\tif ( material.morphTargets ) {\n\n\t\t\t\tmaterial.numSupportedMorphTargets = 0;\n\n\t\t\t\tfor ( var i = 0; i < _this.maxMorphTargets; i ++ ) {\n\n\t\t\t\t\tif ( attributes[ 'morphTarget' + i ] >= 0 ) {\n\n\t\t\t\t\t\tmaterial.numSupportedMorphTargets ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( material.morphNormals ) {\n\n\t\t\t\tmaterial.numSupportedMorphNormals = 0;\n\n\t\t\t\tfor ( var i = 0; i < _this.maxMorphNormals; i ++ ) {\n\n\t\t\t\t\tif ( attributes[ 'morphNormal' + i ] >= 0 ) {\n\n\t\t\t\t\t\tmaterial.numSupportedMorphNormals ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar uniforms = materialProperties.__webglShader.uniforms;\n\n\t\t\tif ( ! material.isShaderMaterial &&\n\t\t\t\t! material.isRawShaderMaterial ||\n\t\t\t\tmaterial.clipping === true ) {\n\n\t\t\t\tmaterialProperties.numClippingPlanes = _clipping.numPlanes;\n\t\t\t\tmaterialProperties.numIntersection = _clipping.numIntersection;\n\t\t\t\tuniforms.clippingPlanes = _clipping.uniform;\n\n\t\t\t}\n\n\t\t\tmaterialProperties.fog = fog;\n\n\t\t\t// store the light setup it was created for\n\n\t\t\tmaterialProperties.lightsHash = _lights.hash;\n\n\t\t\tif ( material.lights ) {\n\n\t\t\t\t// wire up the material to this renderer's lighting state\n\n\t\t\t\tuniforms.ambientLightColor.value = _lights.ambient;\n\t\t\t\tuniforms.directionalLights.value = _lights.directional;\n\t\t\t\tuniforms.spotLights.value = _lights.spot;\n\t\t\t\tuniforms.rectAreaLights.value = _lights.rectArea;\n\t\t\t\tuniforms.pointLights.value = _lights.point;\n\t\t\t\tuniforms.hemisphereLights.value = _lights.hemi;\n\n\t\t\t\tuniforms.directionalShadowMap.value = _lights.directionalShadowMap;\n\t\t\t\tuniforms.directionalShadowMatrix.value = _lights.directionalShadowMatrix;\n\t\t\t\tuniforms.spotShadowMap.value = _lights.spotShadowMap;\n\t\t\t\tuniforms.spotShadowMatrix.value = _lights.spotShadowMatrix;\n\t\t\t\tuniforms.pointShadowMap.value = _lights.pointShadowMap;\n\t\t\t\tuniforms.pointShadowMatrix.value = _lights.pointShadowMatrix;\n\t\t\t\t// TODO (abelnation): add area lights shadow info to uniforms\n\n\t\t\t}\n\n\t\t\tvar progUniforms = materialProperties.program.getUniforms(),\n\t\t\t\tuniformsList =\n\t\t\t\t\tWebGLUniforms.seqWithValue( progUniforms.seq, uniforms );\n\n\t\t\tmaterialProperties.uniformsList = uniformsList;\n\n\t\t}\n\n\t\tfunction setMaterial( material ) {\n\n\t\t\tmaterial.side === DoubleSide\n\t\t\t\t? state.disable( _gl.CULL_FACE )\n\t\t\t\t: state.enable( _gl.CULL_FACE );\n\n\t\t\tstate.setFlipSided( material.side === BackSide );\n\n\t\t\tmaterial.transparent === true\n\t\t\t\t? state.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha )\n\t\t\t\t: state.setBlending( NoBlending );\n\n\t\t\tstate.setDepthFunc( material.depthFunc );\n\t\t\tstate.setDepthTest( material.depthTest );\n\t\t\tstate.setDepthWrite( material.depthWrite );\n\t\t\tstate.setColorWrite( material.colorWrite );\n\t\t\tstate.setPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\n\n\t\t}\n\n\t\tfunction setProgram( camera, fog, material, object ) {\n\n\t\t\t_usedTextureUnits = 0;\n\n\t\t\tvar materialProperties = properties.get( material );\n\n\t\t\tif ( _clippingEnabled ) {\n\n\t\t\t\tif ( _localClippingEnabled || camera !== _currentCamera ) {\n\n\t\t\t\t\tvar useCache =\n\t\t\t\t\t\tcamera === _currentCamera &&\n\t\t\t\t\t\tmaterial.id === _currentMaterialId;\n\n\t\t\t\t\t// we might want to call this function with some ClippingGroup\n\t\t\t\t\t// object instead of the material, once it becomes feasible\n\t\t\t\t\t// (#8465, #8379)\n\t\t\t\t\t_clipping.setState(\n\t\t\t\t\t\tmaterial.clippingPlanes, material.clipIntersection, material.clipShadows,\n\t\t\t\t\t\tcamera, materialProperties, useCache );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( material.needsUpdate === false ) {\n\n\t\t\t\tif ( materialProperties.program === undefined ) {\n\n\t\t\t\t\tmaterial.needsUpdate = true;\n\n\t\t\t\t} else if ( material.fog && materialProperties.fog !== fog ) {\n\n\t\t\t\t\tmaterial.needsUpdate = true;\n\n\t\t\t\t} else if ( material.lights && materialProperties.lightsHash !== _lights.hash ) {\n\n\t\t\t\t\tmaterial.needsUpdate = true;\n\n\t\t\t\t} else if ( materialProperties.numClippingPlanes !== undefined &&\n\t\t\t\t\t( materialProperties.numClippingPlanes !== _clipping.numPlanes ||\n\t\t\t\t\tmaterialProperties.numIntersection  !== _clipping.numIntersection ) ) {\n\n\t\t\t\t\tmaterial.needsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( material.needsUpdate ) {\n\n\t\t\t\tinitMaterial( material, fog, object );\n\t\t\t\tmaterial.needsUpdate = false;\n\n\t\t\t}\n\n\t\t\tvar refreshProgram = false;\n\t\t\tvar refreshMaterial = false;\n\t\t\tvar refreshLights = false;\n\n\t\t\tvar program = materialProperties.program,\n\t\t\t\tp_uniforms = program.getUniforms(),\n\t\t\t\tm_uniforms = materialProperties.__webglShader.uniforms;\n\n\t\t\tif ( program.id !== _currentProgram ) {\n\n\t\t\t\t_gl.useProgram( program.program );\n\t\t\t\t_currentProgram = program.id;\n\n\t\t\t\trefreshProgram = true;\n\t\t\t\trefreshMaterial = true;\n\t\t\t\trefreshLights = true;\n\n\t\t\t}\n\n\t\t\tif ( material.id !== _currentMaterialId ) {\n\n\t\t\t\t_currentMaterialId = material.id;\n\n\t\t\t\trefreshMaterial = true;\n\n\t\t\t}\n\n\t\t\tif ( refreshProgram || camera !== _currentCamera ) {\n\n\t\t\t\tp_uniforms.set( _gl, camera, 'projectionMatrix' );\n\n\t\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\n\n\t\t\t\t\tp_uniforms.setValue( _gl, 'logDepthBufFC',\n\t\t\t\t\t\t2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\n\n\t\t\t\t}\n\n\n\t\t\t\tif ( camera !== _currentCamera ) {\n\n\t\t\t\t\t_currentCamera = camera;\n\n\t\t\t\t\t// lighting uniforms depend on the camera so enforce an update\n\t\t\t\t\t// now, in case this material supports lights - or later, when\n\t\t\t\t\t// the next material that does gets activated:\n\n\t\t\t\t\trefreshMaterial = true;\t\t// set to true on material change\n\t\t\t\t\trefreshLights = true;\t\t// remains set until update done\n\n\t\t\t\t}\n\n\t\t\t\t// load material specific uniforms\n\t\t\t\t// (shader material also gets them for the sake of genericity)\n\n\t\t\t\tif ( material.isShaderMaterial ||\n\t\t\t\t\tmaterial.isMeshPhongMaterial ||\n\t\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\t\tmaterial.envMap ) {\n\n\t\t\t\t\tvar uCamPos = p_uniforms.map.cameraPosition;\n\n\t\t\t\t\tif ( uCamPos !== undefined ) {\n\n\t\t\t\t\t\tuCamPos.setValue( _gl,\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( material.isMeshPhongMaterial ||\n\t\t\t\t\tmaterial.isMeshLambertMaterial ||\n\t\t\t\t\tmaterial.isMeshBasicMaterial ||\n\t\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\t\tmaterial.isShaderMaterial ||\n\t\t\t\t\tmaterial.skinning ) {\n\n\t\t\t\t\tp_uniforms.setValue( _gl, 'viewMatrix', camera.matrixWorldInverse );\n\n\t\t\t\t}\n\n\t\t\t\tp_uniforms.set( _gl, _this, 'toneMappingExposure' );\n\t\t\t\tp_uniforms.set( _gl, _this, 'toneMappingWhitePoint' );\n\n\t\t\t}\n\n\t\t\t// skinning uniforms must be set even if material didn't change\n\t\t\t// auto-setting of texture unit for bone texture must go before other textures\n\t\t\t// not sure why, but otherwise weird things happen\n\n\t\t\tif ( material.skinning ) {\n\n\t\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrix' );\n\t\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrixInverse' );\n\n\t\t\t\tvar skeleton = object.skeleton;\n\n\t\t\t\tif ( skeleton ) {\n\n\t\t\t\t\tif ( capabilities.floatVertexTextures && skeleton.useVertexTexture ) {\n\n\t\t\t\t\t\tp_uniforms.set( _gl, skeleton, 'boneTexture' );\n\t\t\t\t\t\tp_uniforms.set( _gl, skeleton, 'boneTextureWidth' );\n\t\t\t\t\t\tp_uniforms.set( _gl, skeleton, 'boneTextureHeight' );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tp_uniforms.setOptional( _gl, skeleton, 'boneMatrices' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( refreshMaterial ) {\n\n\t\t\t\tif ( material.lights ) {\n\n\t\t\t\t\t// the current material requires lighting info\n\n\t\t\t\t\t// note: all lighting uniforms are always set correctly\n\t\t\t\t\t// they simply reference the renderer's state for their\n\t\t\t\t\t// values\n\t\t\t\t\t//\n\t\t\t\t\t// use the current material's .needsUpdate flags to set\n\t\t\t\t\t// the GL state when required\n\n\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, refreshLights );\n\n\t\t\t\t}\n\n\t\t\t\t// refresh uniforms common to several materials\n\n\t\t\t\tif ( fog && material.fog ) {\n\n\t\t\t\t\trefreshUniformsFog( m_uniforms, fog );\n\n\t\t\t\t}\n\n\t\t\t\tif ( material.isMeshBasicMaterial ||\n\t\t\t\t\tmaterial.isMeshLambertMaterial ||\n\t\t\t\t\tmaterial.isMeshPhongMaterial ||\n\t\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\t\tmaterial.isMeshDepthMaterial ||\n\t\t\t\t\tmaterial.isMeshNormalMaterial ||\n\t\t\t\t\tmaterial.isMeshCubeMaterial ) {\n\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\n\n\t\t\t\t}\n\n\t\t\t\t// refresh single material specific uniforms\n\n\t\t\t\tif ( material.isLineBasicMaterial ) {\n\n\t\t\t\t\trefreshUniformsLine( m_uniforms, material );\n\n\t\t\t\t} else if ( material.isLineDashedMaterial ) {\n\n\t\t\t\t\trefreshUniformsLine( m_uniforms, material );\n\t\t\t\t\trefreshUniformsDash( m_uniforms, material );\n\n\t\t\t\t} else if ( material.isPointsMaterial ) {\n\n\t\t\t\t\trefreshUniformsPoints( m_uniforms, material );\n\n\t\t\t\t} else if ( material.isMeshCubeMaterial ) {\n\n\t\t\t\t\trefreshUniformsCube( m_uniforms, material );\n\n\t\t\t\t} else if ( material.isMeshLambertMaterial ) {\n\n\t\t\t\t\trefreshUniformsLambert( m_uniforms, material );\n\n\t\t\t\t} else if ( material.isMeshToonMaterial ) {\n\n\t\t\t\t\trefreshUniformsToon( m_uniforms, material );\n\n\t\t\t\t} else if ( material.isMeshPhongMaterial ) {\n\n\t\t\t\t\trefreshUniformsPhong( m_uniforms, material );\n\n\t\t\t\t} else if ( material.isMeshPhysicalMaterial ) {\n\n\t\t\t\t\trefreshUniformsPhysical( m_uniforms, material );\n\n\t\t\t\t} else if ( material.isMeshStandardMaterial ) {\n\n\t\t\t\t\trefreshUniformsStandard( m_uniforms, material );\n\n\t\t\t\t} else if ( material.isMeshDepthMaterial ) {\n\n\t\t\t\t\tif ( material.displacementMap ) {\n\n\t\t\t\t\t\tm_uniforms.displacementMap.value = material.displacementMap;\n\t\t\t\t\t\tm_uniforms.displacementScale.value = material.displacementScale;\n\t\t\t\t\t\tm_uniforms.displacementBias.value = material.displacementBias;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( material.isMeshNormalMaterial ) {\n\n\t\t\t\t\trefreshUniformsNormal( m_uniforms, material );\n\n\t\t\t\t}\n\n\t\t\t\t// RectAreaLight Texture\n\t\t\t\t// TODO (mrdoob): Find a nicer implementation\n\n\t\t\t\tif ( m_uniforms.ltcMat !== undefined ) m_uniforms.ltcMat.value = THREE.UniformsLib.LTC_MAT_TEXTURE;\n\t\t\t\tif ( m_uniforms.ltcMag !== undefined ) m_uniforms.ltcMag.value = THREE.UniformsLib.LTC_MAG_TEXTURE;\n\n\t\t\t\tWebGLUniforms.upload(\n\t\t\t\t\t_gl, materialProperties.uniformsList, m_uniforms, _this );\n\n\t\t\t}\n\n\n\t\t\t// common matrices\n\n\t\t\tp_uniforms.set( _gl, object, 'modelViewMatrix' );\n\t\t\tp_uniforms.set( _gl, object, 'normalMatrix' );\n\t\t\tp_uniforms.setValue( _gl, 'modelMatrix', object.matrixWorld );\n\n\t\t\treturn program;\n\n\t\t}\n\n\t\t// Uniforms (refresh uniforms objects)\n\n\t\tvar texelTransform = { texelScale: 0, texelOffset: 0 };\n\n\t\tfunction refreshUniformsCommon( uniforms, material ) {\n\n\t\t\tuniforms.opacity.value = material.opacity;\n\n\t\t\tuniforms.diffuse.value = material.color;\n\n\t\t\tif ( material.emissive ) {\n\n\t\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\n\n\t\t\t}\n\n\t\t\tvar supportedMapNames = MaterialMap.SupportedMapNames;\n\t\t\tvar supportedMapSlotNames = MaterialMap.SupportedMapSlotNames;\n\t\t\tvar supportedMapUVNames = MaterialMap.SupportedMapUVNames;\n\t\t\tvar supportedMapTexelNames = MaterialMap.SupportedMapTexelNames;\n\n\t\t\tif( ! material.usedSlots || material.usedSlotsVersion != material.version ) {\n\t\t\t\tmaterial.usedSlots = [];\n\t\t\t\tfor( var i = 0, il = supportedMapNames.length; i < il; i ++ ) {\n\t\t\t\t\tvar mapName = supportedMapNames[i];\n\t\t\t\t\tvar mapSlotName = supportedMapSlotNames[i];\n\n\t\t\t\t\tvar map = material[ mapSlotName ];\n\n\t\t\t\t\tmaterial.usedSlots.push( {\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tmapUniform: uniforms[mapName],\n\t\t\t\t\t\tuvUniform: uniforms[ supportedMapUVNames[i] ],\n\t\t\t\t\t\ttexelUniform: uniforms[ supportedMapTexelNames[i] ]\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tmaterial.usedSlotsVersion = material.version;\n\t\t\t}\n\n\t\t\tfor( var j = 0, jl = material.usedSlots.length; j < jl; j ++ ) {\n\t\t\t\tvar usedSlots = material.usedSlots[j];\n\t\t\t\tvar i = usedSlots.index;\n\n\t\t\t\tvar mapName = supportedMapNames[i];\n\t\t\t\tvar mapSlotName = supportedMapSlotNames[i];\n\n\t\t\t\tvar map = material[ mapSlotName ];\n\t\t\t\tif( map ) {\n\t\t\t\t\tusedSlots.mapUniform.value = map.texture;\n\t\t\t\t\tif( map.texture ) {\n\t\t\t\t\t\tif( map.uvTransform ) {\n\t\t\t\t\t\t\tvar value = usedSlots.uvUniform.value;\n\t\t\t\t\t\t\tvalue.set(\n\t\t\t\t\t\t\t\tmap.uvRepeat.x,\n\t\t\t\t\t\t\t\tmap.uvRepeat.y,\n\t\t\t\t\t\t\t\tmap.uvOffset.x,\n\t\t\t\t\t\t\t\tmap.uvOffset.y );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( map.texelTransform ) {\n\t\t\t\t\t\t\ttexelTransform = map.getFlattenedTexelTransform( texelTransform );\n\t\t\t\t\t\t\tusedSlots.texelUniform.value.set( texelTransform.texelScale, texelTransform.texelOffset );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if( material[ mapName ] ) {\n\t\t\t\t\tuniforms[mapName].value = material[mapName];\n\t\t\t\t}\n\t\t\t}\n\t\t\t//uniforms.map.value = material.map;\n\t\t\t//uniforms.specularMap.value = material.specularMap;\n\t\t\t//uniforms.alphaMap.value = material.alphaMap;\n\n\t\t\tif ( material.lightMap ) {\n\n\t\t\t\tuniforms.lightMap.value = material.lightMap;\n\t\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n\t\t\t}\n\n\t\t\tif ( material.aoMap ) {\n\n\t\t\t\t//uniforms.aoMap.value = material.aoMap;\n\t\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n\t\t\t}\n\n\t\t\t// uv repeat and offset setting priorities\n\t\t\t// 1. color map\n\t\t\t// 2. specular map\n\t\t\t// 3. normal map\n\t\t\t// 4. bump map\n\t\t\t// 5. alpha map\n\t\t\t// 6. emissive map\n\n\t\t\tvar uvScaleMap;\n\n\t\t\tif ( material.map ) {\n\n\t\t\t\tuvScaleMap = material.map;\n\n\t\t\t} else if ( material.specularMap ) {\n\n\t\t\t\tuvScaleMap = material.specularMap;\n\n\t\t\t} else if ( material.displacementMap ) {\n\n\t\t\t\tuvScaleMap = material.displacementMap;\n\n\t\t\t} else if ( material.normalMap ) {\n\n\t\t\t\tuvScaleMap = material.normalMap;\n\n\t\t\t} else if ( material.bumpMap ) {\n\n\t\t\t\tuvScaleMap = material.bumpMap;\n\n\t\t\t} else if ( material.roughnessMap ) {\n\n\t\t\t\tuvScaleMap = material.roughnessMap;\n\n\t\t\t} else if ( material.metalnessMap ) {\n\n\t\t\t\tuvScaleMap = material.metalnessMap;\n\n\t\t\t} else if ( material.alphaMap ) {\n\n\t\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t\t} else if ( material.emissiveMap ) {\n\n\t\t\t\tuvScaleMap = material.emissiveMap;\n\n\t\t\t}\n\n\t\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\t\t// backwards compatibility\n\t\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\t\tuvScaleMap = uvScaleMap.texture;\n\n\t\t\t\t}\n\n\t\t\t\tvar offset = uvScaleMap.offset;\n\t\t\t\tvar repeat = uvScaleMap.repeat;\n\n\t\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\n\n\t\t\t}\n\n\t\t\tuniforms.envMap.value = material.envMap;\n\n\t\t\t// don't flip CubeTexture envMaps, flip everything else:\n\t\t\t//  WebGLRenderTargetCube will be flipped for backwards compatibility\n\t\t\t//  WebGLRenderTargetCube.texture will be flipped because it's a Texture and NOT a CubeTexture\n\t\t\t// this check must be handled differently, or removed entirely, if WebGLRenderTargetCube uses a CubeTexture in the future\n\t\t\tuniforms.flipEnvMap.value = ( ! ( material.envMap && material.envMap.isCubeTexture ) ) ? 1 : - 1;\n\n\t\t\tuniforms.reflectivity.value = material.reflectivity;\n\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\n\n\t\t}\n\n\t\tfunction refreshUniformsCube ( uniforms, material ) {\n\n\t\t\tuniforms.roughness.value = material.roughness;\n\t\t\tuniforms.opacity.value = material.opacity;\n\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\n\n\t\t}\n\n\t\tfunction refreshUniformsLine( uniforms, material ) {\n\n\t\t\tuniforms.diffuse.value = material.color;\n\t\t\tuniforms.opacity.value = material.opacity;\n\n\t\t}\n\n\t\tfunction refreshUniformsDash( uniforms, material ) {\n\n\t\t\tuniforms.dashSize.value = material.dashSize;\n\t\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\n\t\t\tuniforms.scale.value = material.scale;\n\n\t\t}\n\n\t\tfunction refreshUniformsPoints( uniforms, material ) {\n\n\t\t\tuniforms.diffuse.value = material.color;\n\t\t\tuniforms.opacity.value = material.opacity;\n\t\t\tuniforms.size.value = material.size * _pixelRatio;\n\t\t\tuniforms.scale.value = _height * 0.5;\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t\tif ( material.map !== null ) {\n\n\t\t\t\tvar offset = material.map.offset;\n\t\t\t\tvar repeat = material.map.repeat;\n\n\t\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction refreshUniformsFog( uniforms, fog ) {\n\n\t\t\tuniforms.fogColor.value = fog.color;\n\n\t\t\tif ( fog.isFog ) {\n\n\t\t\t\tuniforms.fogNear.value = fog.near;\n\t\t\t\tuniforms.fogFar.value = fog.far;\n\n\t\t\t} else if ( fog.isFogExp2 ) {\n\n\t\t\t\tuniforms.fogDensity.value = fog.density;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction refreshUniformsLambert( uniforms, material ) {\n\n\t\t\tif ( material.emissiveMap ) {\n\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction refreshUniformsPhong( uniforms, material ) {\n\n\t\t\tuniforms.specular.value = material.specular;\n\t\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\n\n\t\t\tif ( material.emissiveMap ) {\n\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t\t}\n\n\t\t\tif ( material.bumpMap ) {\n\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\n\t\t\t}\n\n\t\t\tif ( material.normalMap ) {\n\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\n\t\t\t}\n\n\t\t\tif ( material.displacementMap ) {\n\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction refreshUniformsToon( uniforms, material ) {\n\n\t\t\trefreshUniformsPhong( uniforms, material );\n\n\t\t\tif ( material.gradientMap ) {\n\n\t\t\t\tuniforms.gradientMap.value = material.gradientMap;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction refreshUniformsStandard( uniforms, material ) {\n\n\t\t\tuniforms.roughness.value = material.roughness;\n\t\t\tuniforms.metalness.value = material.metalness;\n\n\t\t\tif ( material.roughnessMap ) {\n\n\t\t\t\tuniforms.roughnessMap.value = material.roughnessMap;\n\n\t\t\t}\n\n\t\t\tif ( material.metalnessMap ) {\n\n\t\t\t\tuniforms.metalnessMap.value = material.metalnessMap;\n\n\t\t\t}\n\n\t\t\tif ( material.emissiveMap ) {\n\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t\t}\n\n\t\t\tif ( material.bumpMap ) {\n\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\n\t\t\t}\n\n\t\t\tif ( material.normalMap ) {\n\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\n\t\t\t}\n\n\t\t\tif ( material.displacementMap ) {\n\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t\t}\n\n\t\t\tif ( material.envMap ) {\n\n\t\t\t\t//uniforms.envMap.value = material.envMap; // part of uniforms common\n\t\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction refreshUniformsPhysical( uniforms, material ) {\n\n\t\t\tuniforms.falloffDiffuse.value = material.falloffColor;\n\t\t\tif ( material.falloffMap ) {\n\t\t\t\tuniforms.falloffMap.value = material.falloffMap;\n\t\t\t}\n\n\t\t\tuniforms.falloffOpacity.value = material.falloffOpacity;\n\t\t\tif ( material.falloffAlphaMap ) {\n\t\t\t\tuniforms.falloffAlphaMap.value = material.falloffAlphaMap;\n\t\t\t}\n\n\t\t\tuniforms.clearCoat.value = material.clearCoat;\n\t\t\tuniforms.clearCoatRoughness.value = material.clearCoatRoughness;\n\n\t\t\trefreshUniformsStandard( uniforms, material );\n\n\t\t}\n\n\t\tfunction refreshUniformsNormal( uniforms, material ) {\n\n\t\t\tif ( material.bumpMap ) {\n\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\n\t\t\t}\n\n\t\t\tif ( material.normalMap ) {\n\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\n\t\t\t}\n\n\t\t\tif ( material.displacementMap ) {\n\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\n\n\t\tfunction markUniformsLightsNeedsUpdate( uniforms, value ) {\n\n\t\t\tuniforms.ambientLightColor.needsUpdate = value;\n\n\t\t\tuniforms.directionalLights.needsUpdate = value;\n\t\t\tuniforms.pointLights.needsUpdate = value;\n\t\t\tuniforms.spotLights.needsUpdate = value;\n\t\t\tuniforms.rectAreaLights.needsUpdate = value;\n\t\t\tuniforms.hemisphereLights.needsUpdate = value;\n\n\t\t}\n\n\t\t// Lighting\n\n\t\tfunction setupShadows( lights ) {\n\n\t\t\tvar lightShadowsLength = 0;\n\n\t\t\tfor ( var i = 0, l = lights.length; i < l; i ++ ) {\n\n\t\t\t\tvar light = lights[ i ];\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\t_lights.shadows[ lightShadowsLength ++ ] = light;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_lights.shadows.length = lightShadowsLength;\n\n\t\t}\n\n\t\tfunction setupLights( lights, camera ) {\n\n\t\t\tvar l, ll, light,\n\t\t\t\tr = 0, g = 0, b = 0,\n\t\t\t\tcolor,\n\t\t\t\tintensity,\n\t\t\t\tdistance,\n\t\t\t\tshadowMap,\n\n\t\t\t\tviewMatrix = camera.matrixWorldInverse,\n\n\t\t\tdirectionalLength = 0,\n\t\t\tpointLength = 0,\n\t\t\tspotLength = 0,\n\t\t\trectAreaLength = 0,\n\t\t\themiLength = 0;\n\n\t\t\tfor ( l = 0, ll = lights.length; l < ll; l ++ ) {\n\n\t\t\t\tlight = lights[ l ];\n\n\t\t\t\tcolor = light.color;\n\t\t\t\tintensity = light.intensity;\n\t\t\t\tdistance = light.distance;\n\n\t\t\t\tshadowMap = ( light.shadow && light.shadow.map ) ? light.shadow.map.texture : null;\n\n\t\t\t\tif ( light.isAmbientLight ) {\n\n\t\t\t\t\tr += color.r * intensity;\n\t\t\t\t\tg += color.g * intensity;\n\t\t\t\t\tb += color.b * intensity;\n\n\t\t\t\t} else if ( light.isDirectionalLight ) {\n\n\t\t\t\t\tvar uniforms = lightCache.get( light );\n\n\t\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\n\t\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\t\tuniforms.direction.sub( _vector3 );\n\t\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\n\t\t\t\t\tuniforms.shadow = light.castShadow;\n\n\t\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\t\tuniforms.shadowBias = light.shadow.bias;\n\t\t\t\t\t\tuniforms.spreadAngle = light.shadow.spreadAngle;\n\t\t\t\t\t\tuniforms.shadowMapSize = light.shadow.mapSize;\n\t\t\t\t\t\tuniforms.shadowCameraParams = light.shadow.cameraParams;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_lights.directionalShadowMap[ directionalLength ] = shadowMap;\n\t\t\t\t\t_lights.directionalShadowMatrix[ directionalLength ] = light.shadow.matrix;\n\t\t\t\t\t_lights.directional[ directionalLength ++ ] = uniforms;\n\n\t\t\t\t} else if ( light.isSpotLight ) {\n\n\t\t\t\t\tvar uniforms = lightCache.get( light );\n\n\t\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\n\t\t\t\t\tuniforms.distance = distance;\n\n\t\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\t\tuniforms.direction.sub( _vector3 );\n\t\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\n\t\t\t\t\tuniforms.coneCos = Math.cos( light.angle );\n\t\t\t\t\tuniforms.penumbraCos = Math.cos( light.angle * ( 1 - light.penumbra ) );\n\t\t\t\t\tuniforms.decay = ( light.distance === 0 ) ? 0.0 : light.decay;\n\n\t\t\t\t\tuniforms.shadow = light.castShadow;\n\n\t\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\t\tuniforms.shadowBias = light.shadow.bias;\n\t\t\t\t\t\tuniforms.shadowRadius = light.shadow.radius;\n\t\t\t\t\t\tuniforms.shadowMapSize = light.shadow.mapSize;\n\t\t\t\t\t\tuniforms.shadowCameraParams = light.shadow.cameraParams;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_lights.spotShadowMap[ spotLength ] = shadowMap;\n\t\t\t\t\t_lights.spotShadowMatrix[ spotLength ] = light.shadow.matrix;\n\t\t\t\t\t_lights.spot[ spotLength ++ ] = uniforms;\n\n\t\t\t\t} else if ( light.isRectAreaLight ) {\n\n\t\t\t\t\tvar uniforms = lightCache.get( light );\n\n\t\t\t\t\t// (a) intensity controls irradiance of entire light\n\t\t\t\t\tuniforms.color\n\t\t\t\t\t\t.copy( color )\n\t\t\t\t\t\t.multiplyScalar( intensity / ( light.width * light.height ) );\n\n\t\t\t\t\t// (b) intensity controls the radiance per light area\n\t\t\t\t\t// uniforms.color.copy( color ).multiplyScalar( intensity );\n\n\t\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\t\t// extract local rotation of light to derive width/height half vectors\n\t\t\t\t\t_matrix42.identity();\n\t\t\t\t\t_matrix4.copy( light.matrixWorld );\n\t\t\t\t\t_matrix4.premultiply( viewMatrix );\n\t\t\t\t\t_matrix42.extractRotation( _matrix4 );\n\n\t\t\t\t\tuniforms.halfWidth.set( light.width * 0.5,                0.0, 0.0 );\n\t\t\t\t\tuniforms.halfHeight.set(              0.0, light.height * 0.5, 0.0 );\n\n\t\t\t\t\tuniforms.halfWidth.applyMatrix4( _matrix42 );\n\t\t\t\t\tuniforms.halfHeight.applyMatrix4( _matrix42 );\n\n\t\t\t\t\t// TODO (abelnation): RectAreaLight distance?\n\t\t\t\t\t// uniforms.distance = distance;\n\n\t\t\t\t\t_lights.rectArea[ rectAreaLength ++ ] = uniforms;\n\n\t\t\t\t} else if ( light.isPointLight ) {\n\n\t\t\t\t\tvar uniforms = lightCache.get( light );\n\n\t\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\n\t\t\t\t\tuniforms.distance = light.distance;\n\t\t\t\t\tuniforms.decay = ( light.distance === 0 ) ? 0.0 : light.decay;\n\n\t\t\t\t\tuniforms.shadow = light.castShadow;\n\n\t\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\t\tuniforms.shadowBias = light.shadow.bias;\n\t\t\t\t\t\tuniforms.shadowRadius = light.shadow.radius;\n\t\t\t\t\t\tuniforms.shadowMapSize = light.shadow.mapSize;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_lights.pointShadowMap[ pointLength ] = shadowMap;\n\n\t\t\t\t\tif ( _lights.pointShadowMatrix[ pointLength ] === undefined ) {\n\n\t\t\t\t\t\t_lights.pointShadowMatrix[ pointLength ] = new Matrix4();\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// for point lights we set the shadow matrix to be a translation-only matrix\n\t\t\t\t\t// equal to inverse of the light's position\n\t\t\t\t\t_vector3.setFromMatrixPosition( light.matrixWorld ).negate();\n\t\t\t\t\t_lights.pointShadowMatrix[ pointLength ].identity().setPosition( _vector3 );\n\n\t\t\t\t\t_lights.point[ pointLength ++ ] = uniforms;\n\n\t\t\t\t} else if ( light.isHemisphereLight ) {\n\n\t\t\t\t\tvar uniforms = lightCache.get( light );\n\n\t\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\t\t\t\t\tuniforms.direction.normalize();\n\n\t\t\t\t\tuniforms.skyColor.copy( light.color ).multiplyScalar( intensity );\n\t\t\t\t\tuniforms.groundColor.copy( light.groundColor ).multiplyScalar( intensity );\n\n\t\t\t\t\t_lights.hemi[ hemiLength ++ ] = uniforms;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_lights.ambient[ 0 ] = r;\n\t\t\t_lights.ambient[ 1 ] = g;\n\t\t\t_lights.ambient[ 2 ] = b;\n\n\t\t\t_lights.directional.length = directionalLength;\n\t\t\t_lights.spot.length = spotLength;\n\t\t\t_lights.rectArea.length = rectAreaLength;\n\t\t\t_lights.point.length = pointLength;\n\t\t\t_lights.hemi.length = hemiLength;\n\n\t\t\t// TODO (sam-g-steel) why aren't we using join\n\t\t\t_lights.hash = directionalLength + ',' + pointLength + ',' + spotLength + ',' + rectAreaLength + ',' + hemiLength + ',' + _lights.shadows.length;\n\n\t\t}\n\n\t\t// GL state setting\n\n\t\tthis.setFaceCulling = function ( cullFace, frontFaceDirection ) {\n\n\t\t\tstate.setCullFace( cullFace );\n\t\t\tstate.setFlipSided( frontFaceDirection === FrontFaceDirectionCW );\n\n\t\t};\n\n\t\t// Textures\n\n\t\tfunction allocTextureUnit() {\n\n\t\t\tvar textureUnit = _usedTextureUnits;\n\n\t\t\tif ( textureUnit >= capabilities.maxTextures ) {\n\n\t\t\t\tconsole.warn( 'WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + capabilities.maxTextures );\n\n\t\t\t}\n\n\t\t\t_usedTextureUnits += 1;\n\n\t\t\treturn textureUnit;\n\n\t\t}\n\n\t\tthis.allocTextureUnit = allocTextureUnit;\n\n\t\t// this.setTexture2D = setTexture2D;\n\t\tthis.setTexture2D = ( function() {\n\n\t\t\tvar warned = false;\n\n\t\t\t// backwards compatibility: peel texture.texture\n\t\t\treturn function setTexture2D( texture, slot ) {\n\n\t\t\t\tif ( texture && texture.isWebGLRenderTarget ) {\n\n\t\t\t\t\tif ( ! warned ) {\n\n\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead.\", texture );\n\t\t\t\t\t\twarned = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture = texture.texture;\n\n\t\t\t\t}\n\n\t\t\t\ttextures.setTexture2D( texture, slot );\n\n\t\t\t};\n\n\t\t}() );\n\n\t\tthis.setTexture = ( function() {\n\n\t\t\tvar warned = false;\n\n\t\t\treturn function setTexture( texture, slot ) {\n\n\t\t\t\tif ( ! warned ) {\n\n\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.\" );\n\t\t\t\t\twarned = true;\n\n\t\t\t\t}\n\n\t\t\t\ttextures.setTexture2D( texture, slot );\n\n\t\t\t};\n\n\t\t}() );\n\n\t\tthis.setTextureCube = ( function() {\n\n\t\t\tvar warned = false;\n\n\t\t\treturn function setTextureCube( texture, slot ) {\n\n\t\t\t\t// backwards compatibility: peel texture.texture\n\t\t\t\tif ( texture && texture.isWebGLRenderTargetCube ) {\n\n\t\t\t\t\tif ( ! warned ) {\n\n\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead.\", texture );\n\t\t\t\t\t\twarned = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture = texture.texture;\n\n\t\t\t\t}\n\n\t\t\t\t// currently relying on the fact that WebGLRenderTargetCube.texture is a Texture and NOT a CubeTexture\n\t\t\t\t// TODO: unify these code paths\n\t\t\t\tif ( ( texture && texture.isCubeTexture ) ||\n\t\t\t\t\t( Array.isArray( texture.image ) && texture.image.length === 6 ) ) {\n\n\t\t\t\t\t// CompressedTexture can have Array in image :/\n\n\t\t\t\t\t// this function alone should take care of cube textures\n\t\t\t\t\ttextures.setTextureCube( texture, slot );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// assumed: texture property of THREE.WebGLRenderTargetCube\n\n\t\t\t\t\ttextures.setTextureCubeDynamic( texture, slot );\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}() );\n\n\t\tthis.getCurrentRenderTarget = function() {\n\n\t\t\treturn _currentRenderTarget;\n\n\t\t};\n\n\t\tthis.setRenderTarget = function ( renderTarget ) {\n\n\t\t\t_currentRenderTarget = renderTarget;\n\n\t\t\tif ( renderTarget && properties.get( renderTarget ).__webglFramebuffer === undefined ) {\n\n\t\t\t\ttextures.setupRenderTarget( renderTarget );\n\n\t\t\t}\n\n\t\t\tvar isCube = ( renderTarget && renderTarget.isWebGLRenderTargetCube );\n\t\t\tvar framebuffer;\n\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\tvar renderTargetProperties = properties.get( renderTarget );\n\n\t\t\t\tif ( isCube ) {\n\n\t\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer[ renderTarget.activeCubeFace ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer;\n\n\t\t\t\t}\n\n\t\t\t\t_currentScissor.copy( renderTarget.scissor );\n\t\t\t\t_currentScissorTest = renderTarget.scissorTest;\n\n\t\t\t\t_currentViewport.copy( renderTarget.viewport );\n\n\t\t\t} else {\n\n\t\t\t\tframebuffer = null;\n\n\t\t\t\t_currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio );\n\t\t\t\t_currentScissorTest = _scissorTest;\n\n\t\t\t\t_currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio );\n\n\t\t\t}\n\n\t\t\tif ( _currentFramebuffer !== framebuffer ) {\n\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\t\t\t\t_currentFramebuffer = framebuffer;\n\n\t\t\t}\n\n\t\t\tstate.scissor( _currentScissor );\n\t\t\tstate.setScissorTest( _currentScissorTest );\n\n\t\t\tstate.viewport( _currentViewport );\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\tvar textureProperties = properties.get( renderTarget.texture );\n\t\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + renderTarget.activeCubeFace, textureProperties.__webglTexture, renderTarget.activeMipMapLevel );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer ) {\n\n\t\t\tif ( ( renderTarget && renderTarget.isWebGLRenderTarget ) === false ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tvar framebuffer = properties.get( renderTarget ).__webglFramebuffer;\n\n\t\t\tif ( framebuffer ) {\n\n\t\t\t\tvar restore = false;\n\n\t\t\t\tif ( framebuffer !== _currentFramebuffer ) {\n\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\n\t\t\t\t\trestore = true;\n\n\t\t\t\t}\n\n\t\t\t\ttry {\n\n\t\t\t\t\tvar texture = renderTarget.texture;\n\t\t\t\t\tvar textureFormat = texture.format;\n\t\t\t\t\tvar textureType = texture.type;\n\n\t\t\t\t\tif ( textureFormat !== RGBAFormat && paramThreeToGL( textureFormat ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_FORMAT ) ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( textureType !== UnsignedByteType && paramThreeToGL( textureType ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_TYPE ) && // IE11, Edge and Chrome Mac < 52 (#9513)\n\t\t\t\t\t\t! ( textureType === FloatType && ( extensions.get( 'OES_texture_float' ) || extensions.get( 'WEBGL_color_buffer_float' ) ) ) && // Chrome Mac >= 52 and Firefox\n\t\t\t\t\t\t! ( textureType === HalfFloatType && extensions.get( 'EXT_color_buffer_half_float' ) ) ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( _gl.checkFramebufferStatus( _gl.FRAMEBUFFER ) === _gl.FRAMEBUFFER_COMPLETE ) {\n\n\t\t\t\t\t\t// the following if statement ensures valid read requests (no out-of-bounds pixels, see #8604)\n\n\t\t\t\t\t\tif ( ( x >= 0 && x <= ( renderTarget.width - width ) ) && ( y >= 0 && y <= ( renderTarget.height - height ) ) ) {\n\n\t\t\t\t\t\t\t_gl.readPixels( x, y, width, height, paramThreeToGL( textureFormat ), paramThreeToGL( textureType ), buffer );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t} finally {\n\n\t\t\t\t\tif ( restore ) {\n\n\t\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, _currentFramebuffer );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\t// MaterialMap three.js constants to WebGL constants\n\n\t\tfunction paramThreeToGL( p ) {\n\n\t\t\tvar extension;\n\n\t\t\tif ( p === RepeatWrapping ) return _gl.REPEAT;\n\t\t\tif ( p === ClampToEdgeWrapping ) return _gl.CLAMP_TO_EDGE;\n\t\t\tif ( p === MirroredRepeatWrapping ) return _gl.MIRRORED_REPEAT;\n\n\t\t\tif ( p === NearestFilter ) return _gl.NEAREST;\n\t\t\tif ( p === NearestMipMapNearestFilter ) return _gl.NEAREST_MIPMAP_NEAREST;\n\t\t\tif ( p === NearestMipMapLinearFilter ) return _gl.NEAREST_MIPMAP_LINEAR;\n\n\t\t\tif ( p === LinearFilter ) return _gl.LINEAR;\n\t\t\tif ( p === LinearMipMapNearestFilter ) return _gl.LINEAR_MIPMAP_NEAREST;\n\t\t\tif ( p === LinearMipMapLinearFilter ) return _gl.LINEAR_MIPMAP_LINEAR;\n\n\t\t\tif ( p === UnsignedByteType ) return _gl.UNSIGNED_BYTE;\n\t\t\tif ( p === UnsignedShort4444Type ) return _gl.UNSIGNED_SHORT_4_4_4_4;\n\t\t\tif ( p === UnsignedShort5551Type ) return _gl.UNSIGNED_SHORT_5_5_5_1;\n\t\t\tif ( p === UnsignedShort565Type ) return _gl.UNSIGNED_SHORT_5_6_5;\n\n\t\t\tif ( p === ByteType ) return _gl.BYTE;\n\t\t\tif ( p === ShortType ) return _gl.SHORT;\n\t\t\tif ( p === UnsignedShortType ) return _gl.UNSIGNED_SHORT;\n\t\t\tif ( p === IntType ) return _gl.INT;\n\t\t\tif ( p === UnsignedIntType ) return _gl.UNSIGNED_INT;\n\t\t\tif ( p === FloatType ) return _gl.FLOAT;\n\n\t\t\tif ( p === HalfFloatType ) {\n\n\t\t\t\textension = extensions.get( 'OES_texture_half_float' );\n\n\t\t\t\tif ( extension !== null ) return extension.HALF_FLOAT_OES;\n\n\t\t\t}\n\n\t\t\tif ( p === AlphaFormat ) return _gl.ALPHA;\n\t\t\tif ( p === RGBFormat ) return _gl.RGB;\n\t\t\tif ( p === RGBAFormat ) return _gl.RGBA;\n\t\t\tif ( p === LuminanceFormat ) return _gl.LUMINANCE;\n\t\t\tif ( p === LuminanceAlphaFormat ) return _gl.LUMINANCE_ALPHA;\n\t\t\tif ( p === DepthFormat ) return _gl.DEPTH_COMPONENT;\n\t\t\tif ( p === DepthStencilFormat ) return _gl.DEPTH_STENCIL;\n\n\t\t\tif ( p === AddEquation ) return _gl.FUNC_ADD;\n\t\t\tif ( p === SubtractEquation ) return _gl.FUNC_SUBTRACT;\n\t\t\tif ( p === ReverseSubtractEquation ) return _gl.FUNC_REVERSE_SUBTRACT;\n\n\t\t\tif ( p === ZeroFactor ) return _gl.ZERO;\n\t\t\tif ( p === OneFactor ) return _gl.ONE;\n\t\t\tif ( p === SrcColorFactor ) return _gl.SRC_COLOR;\n\t\t\tif ( p === OneMinusSrcColorFactor ) return _gl.ONE_MINUS_SRC_COLOR;\n\t\t\tif ( p === SrcAlphaFactor ) return _gl.SRC_ALPHA;\n\t\t\tif ( p === OneMinusSrcAlphaFactor ) return _gl.ONE_MINUS_SRC_ALPHA;\n\t\t\tif ( p === DstAlphaFactor ) return _gl.DST_ALPHA;\n\t\t\tif ( p === OneMinusDstAlphaFactor ) return _gl.ONE_MINUS_DST_ALPHA;\n\n\t\t\tif ( p === DstColorFactor ) return _gl.DST_COLOR;\n\t\t\tif ( p === OneMinusDstColorFactor ) return _gl.ONE_MINUS_DST_COLOR;\n\t\t\tif ( p === SrcAlphaSaturateFactor ) return _gl.SRC_ALPHA_SATURATE;\n\n\t\t\tif ( p === RGB_S3TC_DXT1_Format || p === RGBA_S3TC_DXT1_Format ||\n\t\t\t\tp === RGBA_S3TC_DXT3_Format || p === RGBA_S3TC_DXT5_Format ) {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format || p === RGB_PVRTC_2BPPV1_Format ||\n\t\t\t\tp === RGBA_PVRTC_4BPPV1_Format || p === RGBA_PVRTC_2BPPV1_Format ) {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\n\t\t\t\t\tif ( p === RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\n\t\t\t\t\tif ( p === RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\n\t\t\t\t\tif ( p === RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( p === RGB_ETC1_Format ) {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc1' );\n\n\t\t\t\tif ( extension !== null ) return extension.COMPRESSED_RGB_ETC1_WEBGL;\n\n\t\t\t}\n\n\t\t\tif ( p === MinEquation || p === MaxEquation ) {\n\n\t\t\t\textension = extensions.get( 'EXT_blend_minmax' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === MinEquation ) return extension.MIN_EXT;\n\t\t\t\t\tif ( p === MaxEquation ) return extension.MAX_EXT;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( p === UnsignedInt248Type ) {\n\n\t\t\t\textension = extensions.get( 'WEBGL_depth_texture' );\n\n\t\t\t\tif ( extension !== null ) return extension.UNSIGNED_INT_24_8_WEBGL;\n\n\t\t\t}\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction FogExp2 ( color, density ) {\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\t\tthis.density = ( density !== undefined ) ? density : 0.00025;\n\n\t}\n\n\tFogExp2.prototype.isFogExp2 = true;\n\n\tFogExp2.prototype.clone = function () {\n\n\t\treturn new FogExp2( this.color.getHex(), this.density );\n\n\t};\n\n\tFogExp2.prototype.toJSON = function ( meta ) {\n\n\t\treturn {\n\t\t\ttype: 'FogExp2',\n\t\t\tcolor: this.color.getHex(),\n\t\t\tdensity: this.density\n\t\t};\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction Fog ( color, near, far ) {\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\n\t\tthis.near = ( near !== undefined ) ? near : 1;\n\t\tthis.far = ( far !== undefined ) ? far : 1000;\n\n\t}\n\n\tFog.prototype.isFog = true;\n\n\tFog.prototype.clone = function () {\n\n\t\treturn new Fog( this.color.getHex(), this.near, this.far );\n\n\t};\n\n\tFog.prototype.toJSON = function ( meta ) {\n\n\t\treturn {\n\t\t\ttype: 'Fog',\n\t\t\tcolor: this.color.getHex(),\n\t\t\tnear: this.near,\n\t\t\tfar: this.far\n\t\t};\n\n\t};\n\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction LensFlare( texture, size, distance, blending, color ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.lensFlares = [];\n\n\t\tthis.positionScreen = new Vector3();\n\t\tthis.customUpdateCallback = undefined;\n\n\t\tif ( texture !== undefined ) {\n\n\t\t\tthis.add( texture, size, distance, blending, color );\n\n\t\t}\n\n\t}\n\n\tLensFlare.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: LensFlare,\n\n\t\tisLensFlare: true,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tObject3D.prototype.copy.call( this, source );\n\n\t\t\tthis.positionScreen.copy( source.positionScreen );\n\t\t\tthis.customUpdateCallback = source.customUpdateCallback;\n\n\t\t\tfor ( var i = 0, l = source.lensFlares.length; i < l; i ++ ) {\n\n\t\t\t\tthis.lensFlares.push( source.lensFlares[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tadd: function ( texture, size, distance, blending, color, opacity ) {\n\n\t\t\tif ( size === undefined ) size = - 1;\n\t\t\tif ( distance === undefined ) distance = 0;\n\t\t\tif ( opacity === undefined ) opacity = 1;\n\t\t\tif ( color === undefined ) color = new Color( 0xffffff );\n\t\t\tif ( blending === undefined ) blending = NormalBlending;\n\n\t\t\tdistance = Math.min( distance, Math.max( 0, distance ) );\n\n\t\t\tthis.lensFlares.push( {\n\t\t\t\ttexture: texture,\t// THREE.Texture\n\t\t\t\tsize: size, \t\t// size in pixels (-1 = use texture.width)\n\t\t\t\tdistance: distance, \t// distance (0-1) from light source (0=at light source)\n\t\t\t\tx: 0, y: 0, z: 0,\t// screen position (-1 => 1) z = 0 is in front z = 1 is back\n\t\t\t\tscale: 1, \t\t// scale\n\t\t\t\trotation: 0, \t\t// rotation\n\t\t\t\topacity: opacity,\t// opacity\n\t\t\t\tcolor: color,\t\t// color\n\t\t\t\tblending: blending\t// blending\n\t\t\t} );\n\n\t\t},\n\n\t\t/*\n\t\t * Update lens flares update positions on all flares based on the screen position\n\t\t * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\n\t\t */\n\n\t\tupdateLensFlares: function () {\n\n\t\t\tvar f, fl = this.lensFlares.length;\n\t\t\tvar flare;\n\t\t\tvar vecX = - this.positionScreen.x * 2;\n\t\t\tvar vecY = - this.positionScreen.y * 2;\n\n\t\t\tfor ( f = 0; f < fl; f ++ ) {\n\n\t\t\t\tflare = this.lensFlares[ f ];\n\n\t\t\t\tflare.x = this.positionScreen.x + vecX * flare.distance;\n\t\t\t\tflare.y = this.positionScreen.y + vecY * flare.distance;\n\n\t\t\t\tflare.wantedRotation = flare.x * Math.PI * 0.25;\n\t\t\t\tflare.rotation += ( flare.wantedRotation - flare.rotation ) * 0.25;\n\n\t\t\t}\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *\tuvOffset: new THREE.Vector2(),\n\t *\tuvScale: new THREE.Vector2()\n\t * }\n\t */\n\n\tfunction SpriteMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'SpriteMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\t\tthis.map = null;\n\n\t\tthis.rotation = 0;\n\n\t\tthis.fog = false;\n\t\tthis.lights = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tSpriteMaterial.prototype = Object.create( Material.prototype );\n\tSpriteMaterial.prototype.constructor = SpriteMaterial;\n\n\tSpriteMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.map = source.map;\n\n\t\tthis.rotation = source.rotation;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction Sprite( material ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Sprite';\n\n\t\tthis.material = ( material !== undefined ) ? material : new SpriteMaterial();\n\n\t}\n\n\tSprite.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: Sprite,\n\n\t\tisSprite: true,\n\n\t\traycast: ( function () {\n\n\t\t\tvar matrixPosition = new Vector3();\n\n\t\t\treturn function raycast( raycaster, intersects ) {\n\n\t\t\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\t\tvar distanceSq = raycaster.ray.distanceSqToPoint( matrixPosition );\n\t\t\t\tvar guessSizeSq = this.scale.x * this.scale.y / 4;\n\n\t\t\t\tif ( distanceSq > guessSizeSq ) {\n\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tintersects.push( {\n\n\t\t\t\t\tdistance: Math.sqrt( distanceSq ),\n\t\t\t\t\tpoint: this.position,\n\t\t\t\t\tface: null,\n\t\t\t\t\tobject: this\n\n\t\t\t\t} );\n\n\t\t\t};\n\n\t\t}() ),\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this.material ).copy( this );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction LOD() {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'LOD';\n\n\t\tObject.defineProperties( this, {\n\t\t\tlevels: {\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: []\n\t\t\t}\n\t\t} );\n\n\t}\n\n\n\tLOD.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: LOD,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tObject3D.prototype.copy.call( this, source, false );\n\n\t\t\tvar levels = source.levels;\n\n\t\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tvar level = levels[ i ];\n\n\t\t\t\tthis.addLevel( level.object.clone(), level.distance );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\taddLevel: function ( object, distance ) {\n\n\t\t\tif ( distance === undefined ) distance = 0;\n\n\t\t\tdistance = Math.abs( distance );\n\n\t\t\tvar levels = this.levels;\n\n\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\n\n\t\t\t\tif ( distance < levels[ l ].distance ) {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlevels.splice( l, 0, { distance: distance, object: object } );\n\n\t\t\tthis.add( object );\n\n\t\t},\n\n\t\tgetObjectForDistance: function ( distance ) {\n\n\t\t\tvar levels = this.levels;\n\n\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tif ( distance < levels[ i ].distance ) {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn levels[ i - 1 ].object;\n\n\t\t},\n\n\t\traycast: ( function () {\n\n\t\t\tvar matrixPosition = new Vector3();\n\n\t\t\treturn function raycast( raycaster, intersects ) {\n\n\t\t\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( matrixPosition );\n\n\t\t\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\n\n\t\t\t};\n\n\t\t}() ),\n\n\t\tupdate: function () {\n\n\t\t\tvar v1 = new Vector3();\n\t\t\tvar v2 = new Vector3();\n\n\t\t\treturn function update( camera ) {\n\n\t\t\t\tvar levels = this.levels;\n\n\t\t\t\tif ( levels.length > 1 ) {\n\n\t\t\t\t\tv1.setFromMatrixPosition( camera.matrixWorld );\n\t\t\t\t\tv2.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\t\t\tvar distance = v1.distanceTo( v2 );\n\n\t\t\t\t\tlevels[ 0 ].object.visible = true;\n\n\t\t\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tif ( distance >= levels[ i ].distance ) {\n\n\t\t\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\n\t\t\t\t\t\t\tlevels[ i ].object.visible = true;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( ; i < l; i ++ ) {\n\n\t\t\t\t\t\tlevels[ i ].object.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}(),\n\n\t\ttoJSON: function ( meta ) {\n\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\n\n\t\t\tdata.object.levels = [];\n\n\t\t\tvar levels = this.levels;\n\n\t\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tvar level = levels[ i ];\n\n\t\t\t\tdata.object.levels.push( {\n\t\t\t\t\tobject: level.object.uuid,\n\t\t\t\t\tdistance: level.distance\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author michael guerrero / http://realitymeltdown.com\n\t * @author ikerr / http://verold.com\n\t */\n\n\tfunction Skeleton( bones, boneInverses, useVertexTexture ) {\n\n\t\tthis.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\n\n\t\tthis.identityMatrix = new Matrix4();\n\n\t\t// copy the bone array\n\n\t\tbones = bones || [];\n\n\t\tthis.bones = bones.slice( 0 );\n\n\t\t// create a bone texture or an array of floats\n\n\t\tif ( this.useVertexTexture ) {\n\n\t\t\t// layout (1 matrix = 4 pixels)\n\t\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\n\t\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\n\t\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\n\t\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\n\n\n\t\t\tvar size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\n\t\t\tsize = _Math.nextPowerOfTwo( Math.ceil( size ) );\n\t\t\tsize = Math.max( size, 4 );\n\n\t\t\tthis.boneTextureWidth = size;\n\t\t\tthis.boneTextureHeight = size;\n\n\t\t\tthis.boneMatrices = new Float32Array( this.boneTextureWidth * this.boneTextureHeight * 4 ); // 4 floats per RGBA pixel\n\t\t\tthis.boneTexture = new DataTexture( this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, RGBAFormat, FloatType );\n\n\t\t} else {\n\n\t\t\tthis.boneMatrices = new Float32Array( 16 * this.bones.length );\n\n\t\t}\n\n\t\t// use the supplied bone inverses or calculate the inverses\n\n\t\tif ( boneInverses === undefined ) {\n\n\t\t\tthis.calculateInverses();\n\n\t\t} else {\n\n\t\t\tif ( this.bones.length === boneInverses.length ) {\n\n\t\t\t\tthis.boneInverses = boneInverses.slice( 0 );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton bonInverses is the wrong length.' );\n\n\t\t\t\tthis.boneInverses = [];\n\n\t\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\t\t\t\tthis.boneInverses.push( new Matrix4() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tObject.assign( Skeleton.prototype, {\n\n\t\tcalculateInverses: function () {\n\n\t\t\tthis.boneInverses = [];\n\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\t\t\tvar inverse = new Matrix4();\n\n\t\t\t\tif ( this.bones[ b ] ) {\n\n\t\t\t\t\tinverse.getInverse( this.bones[ b ].matrixWorld );\n\n\t\t\t\t}\n\n\t\t\t\tthis.boneInverses.push( inverse );\n\n\t\t\t}\n\n\t\t},\n\n\t\tpose: function () {\n\n\t\t\tvar bone;\n\n\t\t\t// recover the bind-time world matrices\n\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\t\t\tbone = this.bones[ b ];\n\n\t\t\t\tif ( bone ) {\n\n\t\t\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ b ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// compute the local matrices, positions, rotations and scales\n\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\t\t\tbone = this.bones[ b ];\n\n\t\t\t\tif ( bone ) {\n\n\t\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\n\t\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\tupdate: ( function () {\n\n\t\t\tvar offsetMatrix = new Matrix4();\n\n\t\t\treturn function update() {\n\n\t\t\t\t// flatten bone matrices to array\n\n\t\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\t\t\t\t// compute the offset between the current and the original transform\n\n\t\t\t\t\tvar matrix = this.bones[ b ] ? this.bones[ b ].matrixWorld : this.identityMatrix;\n\n\t\t\t\t\toffsetMatrix.multiplyMatrices( matrix, this.boneInverses[ b ] );\n\t\t\t\t\toffsetMatrix.toArray( this.boneMatrices, b * 16 );\n\n\t\t\t\t}\n\n\t\t\t\tif ( this.useVertexTexture ) {\n\n\t\t\t\t\tthis.boneTexture.needsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t} )(),\n\n\t\tclone: function () {\n\n\t\t\treturn new Skeleton( this.bones, this.boneInverses, this.useVertexTexture );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author ikerr / http://verold.com\n\t */\n\n\tfunction Bone() {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Bone';\n\n\t}\n\n\tBone.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: Bone,\n\n\t\tisBone: true\n\n\t} );\n\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author ikerr / http://verold.com\n\t */\n\n\tfunction SkinnedMesh( geometry, material, useVertexTexture ) {\n\n\t\tMesh.call( this, geometry, material );\n\n\t\tthis.type = 'SkinnedMesh';\n\n\t\tthis.bindMode = \"attached\";\n\t\tthis.bindMatrix = new Matrix4();\n\t\tthis.bindMatrixInverse = new Matrix4();\n\n\t\t// init bones\n\n\t\t// TODO: remove bone creation as there is no reason (other than\n\t\t// convenience) for THREE.SkinnedMesh to do this.\n\n\t\tvar bones = [];\n\n\t\tif ( this.geometry && this.geometry.bones !== undefined ) {\n\n\t\t\tvar bone, gbone;\n\n\t\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\n\n\t\t\t\tgbone = this.geometry.bones[ b ];\n\n\t\t\t\tbone = new Bone();\n\t\t\t\tbones.push( bone );\n\n\t\t\t\tbone.name = gbone.name;\n\t\t\t\tbone.position.fromArray( gbone.pos );\n\t\t\t\tbone.quaternion.fromArray( gbone.rotq );\n\t\t\t\tif ( gbone.scl !== undefined ) bone.scale.fromArray( gbone.scl );\n\n\t\t\t}\n\n\t\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\n\n\t\t\t\tgbone = this.geometry.bones[ b ];\n\n\t\t\t\tif ( gbone.parent !== - 1 && gbone.parent !== null &&\n\t\t\t\t\t\tbones[ gbone.parent ] !== undefined ) {\n\n\t\t\t\t\tbones[ gbone.parent ].add( bones[ b ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.add( bones[ b ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.normalizeSkinWeights();\n\n\t\tthis.updateMatrixWorld( true );\n\t\tthis.bind( new Skeleton( bones, undefined, useVertexTexture ), this.matrixWorld );\n\n\t}\n\n\n\tSkinnedMesh.prototype = Object.assign( Object.create( Mesh.prototype ), {\n\n\t\tconstructor: SkinnedMesh,\n\n\t\tisSkinnedMesh: true,\n\n\t\tbind: function( skeleton, bindMatrix ) {\n\n\t\t\tthis.skeleton = skeleton;\n\n\t\t\tif ( bindMatrix === undefined ) {\n\n\t\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\t\tthis.skeleton.calculateInverses();\n\n\t\t\t\tbindMatrix = this.matrixWorld;\n\n\t\t\t}\n\n\t\t\tthis.bindMatrix.copy( bindMatrix );\n\t\t\tthis.bindMatrixInverse.getInverse( bindMatrix );\n\n\t\t},\n\n\t\tpose: function () {\n\n\t\t\tthis.skeleton.pose();\n\n\t\t},\n\n\t\tnormalizeSkinWeights: function () {\n\n\t\t\tif ( this.geometry && this.geometry.isGeometry ) {\n\n\t\t\t\tfor ( var i = 0; i < this.geometry.skinWeights.length; i ++ ) {\n\n\t\t\t\t\tvar sw = this.geometry.skinWeights[ i ];\n\n\t\t\t\t\tvar scale = 1.0 / sw.lengthManhattan();\n\n\t\t\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\t\t\tsw.multiplyScalar( scale );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tsw.set( 1, 0, 0, 0 ); // do something reasonable\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( this.geometry && this.geometry.isBufferGeometry ) {\n\n\t\t\t\tvar vec = new Vector4();\n\n\t\t\t\tvar skinWeight = this.geometry.attributes.skinWeight;\n\n\t\t\t\tfor ( var i = 0; i < skinWeight.count; i ++ ) {\n\n\t\t\t\t\tvec.x = skinWeight.getX( i );\n\t\t\t\t\tvec.y = skinWeight.getY( i );\n\t\t\t\t\tvec.z = skinWeight.getZ( i );\n\t\t\t\t\tvec.w = skinWeight.getW( i );\n\n\t\t\t\t\tvar scale = 1.0 / vec.lengthManhattan();\n\n\t\t\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\t\t\tvec.multiplyScalar( scale );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tvec.set( 1, 0, 0, 0 ); // do something reasonable\n\n\t\t\t\t\t}\n\n\t\t\t\t\tskinWeight.setXYZW( i, vec.x, vec.y, vec.z, vec.w );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\tupdateMatrixWorld: function( force ) {\n\n\t\t\tMesh.prototype.updateMatrixWorld.call( this, true );\n\n\t\t\tif ( this.bindMode === \"attached\" ) {\n\n\t\t\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\n\n\t\t\t} else if ( this.bindMode === \"detached\" ) {\n\n\t\t\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.SkinnedMesh unrecognized bindMode: ' + this.bindMode );\n\n\t\t\t}\n\n\t\t},\n\n\t\tclone: function() {\n\n\t\t\treturn new this.constructor( this.geometry, this.material, this.skeleton.useVertexTexture ).copy( this );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *\n\t *  linewidth: <float>,\n\t *  linecap: \"round\",\n\t *  linejoin: \"round\"\n\t * }\n\t */\n\n\tfunction LineBasicMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'LineBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.linewidth = 1;\n\t\tthis.linecap = 'round';\n\t\tthis.linejoin = 'round';\n\n\t\tthis.lights = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tLineBasicMaterial.prototype = Object.create( Material.prototype );\n\tLineBasicMaterial.prototype.constructor = LineBasicMaterial;\n\n\tLineBasicMaterial.prototype.isLineBasicMaterial = true;\n\n\tLineBasicMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.linewidth = source.linewidth;\n\t\tthis.linecap = source.linecap;\n\t\tthis.linejoin = source.linejoin;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Line( geometry, material, mode ) {\n\n\t\tif ( mode === 1 ) {\n\n\t\t\tconsole.warn( 'THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.' );\n\t\t\treturn new LineSegments( geometry, material );\n\n\t\t}\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Line';\n\n\t\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\n\t\tthis.material = material !== undefined ? material : new LineBasicMaterial( { color: Math.random() * 0xffffff } );\n\n\t}\n\n\tLine.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: Line,\n\n\t\tisLine: true,\n\n\t\traycast: ( function () {\n\n\t\t\tvar inverseMatrix = new Matrix4();\n\t\t\tvar ray = new Ray();\n\t\t\tvar sphere = new Sphere();\n\n\t\t\treturn function raycast( raycaster, intersects ) {\n\n\t\t\t\tvar precision = raycaster.linePrecision;\n\t\t\t\tvar precisionSq = precision * precision;\n\n\t\t\t\tvar geometry = this.geometry;\n\t\t\t\tvar matrixWorld = this.matrixWorld;\n\n\t\t\t\t// Checking boundingSphere distance to ray\n\n\t\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t\t\tsphere.copy( geometry.boundingSphere );\n\t\t\t\tsphere.applyMatrix4( matrixWorld );\n\n\t\t\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\n\n\t\t\t\t//\n\n\t\t\t\tinverseMatrix.getInverse( matrixWorld );\n\t\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\n\n\t\t\t\tvar vStart = new Vector3();\n\t\t\t\tvar vEnd = new Vector3();\n\t\t\t\tvar interSegment = new Vector3();\n\t\t\t\tvar interRay = new Vector3();\n\t\t\t\tvar step = (this && this.isLineSegments) ? 2 : 1;\n\n\t\t\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t\t\tvar index = geometry.index;\n\t\t\t\t\tvar attributes = geometry.attributes;\n\t\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\t\tif ( index !== null ) {\n\n\t\t\t\t\t\tvar indices = index.array;\n\n\t\t\t\t\t\tfor ( var i = 0, l = indices.length - 1; i < l; i += step ) {\n\n\t\t\t\t\t\t\tvar a = indices[ i ];\n\t\t\t\t\t\t\tvar b = indices[ i + 1 ];\n\n\t\t\t\t\t\t\tvStart.fromArray( positions, a * 3 );\n\t\t\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\n\n\t\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\n\n\t\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\t\tface: null,\n\t\t\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tfor ( var i = 0, l = positions.length / 3 - 1; i < l; i += step ) {\n\n\t\t\t\t\t\t\tvStart.fromArray( positions, 3 * i );\n\t\t\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\n\n\t\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\n\n\t\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\t\tface: null,\n\t\t\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\t\t\tvar vertices = geometry.vertices;\n\t\t\t\t\tvar nbVertices = vertices.length;\n\n\t\t\t\t\tfor ( var i = 0; i < nbVertices - 1; i += step ) {\n\n\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\n\n\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\n\n\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\tface: null,\n\t\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}() ),\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction LineSegments( geometry, material ) {\n\n\t\tLine.call( this, geometry, material );\n\n\t\tthis.type = 'LineSegments';\n\n\t}\n\n\tLineSegments.prototype = Object.assign( Object.create( Line.prototype ), {\n\n\t\tconstructor: LineSegments,\n\n\t\tisLineSegments: true\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  size: <float>,\n\t *  sizeAttenuation: <bool>\n\t * }\n\t */\n\n\tfunction PointsMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'PointsMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.size = 1;\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.lights = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tPointsMaterial.prototype = Object.create( Material.prototype );\n\tPointsMaterial.prototype.constructor = PointsMaterial;\n\n\tPointsMaterial.prototype.isPointsMaterial = true;\n\n\tPointsMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.size = source.size;\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction Points( geometry, material ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Points';\n\n\t\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\n\t\tthis.material = material !== undefined ? material : new PointsMaterial( { color: Math.random() * 0xffffff } );\n\n\t}\n\n\tPoints.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: Points,\n\n\t\tisPoints: true,\n\n\t\traycast: ( function () {\n\n\t\t\tvar inverseMatrix = new Matrix4();\n\t\t\tvar ray = new Ray();\n\t\t\tvar sphere = new Sphere();\n\n\t\t\treturn function raycast( raycaster, intersects ) {\n\n\t\t\t\tvar object = this;\n\t\t\t\tvar geometry = this.geometry;\n\t\t\t\tvar matrixWorld = this.matrixWorld;\n\t\t\t\tvar threshold = raycaster.params.Points.threshold;\n\n\t\t\t\t// Checking boundingSphere distance to ray\n\n\t\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t\t\tsphere.copy( geometry.boundingSphere );\n\t\t\t\tsphere.applyMatrix4( matrixWorld );\n\n\t\t\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\n\n\t\t\t\t//\n\n\t\t\t\tinverseMatrix.getInverse( matrixWorld );\n\t\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\n\n\t\t\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\t\t\tvar localThresholdSq = localThreshold * localThreshold;\n\t\t\t\tvar position = new Vector3();\n\n\t\t\t\tfunction testPoint( point, index ) {\n\n\t\t\t\t\tvar rayPointDistanceSq = ray.distanceSqToPoint( point );\n\n\t\t\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\n\n\t\t\t\t\t\tvar intersectPoint = ray.closestPointToPoint( point );\n\t\t\t\t\t\tintersectPoint.applyMatrix4( matrixWorld );\n\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\n\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\n\t\t\t\t\t\t\tpoint: intersectPoint.clone(),\n\t\t\t\t\t\t\tindex: index,\n\t\t\t\t\t\t\tface: null,\n\t\t\t\t\t\t\tobject: object\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t\t\tvar index = geometry.index;\n\t\t\t\t\tvar attributes = geometry.attributes;\n\t\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\t\tif ( index !== null ) {\n\n\t\t\t\t\t\tvar indices = index.array;\n\n\t\t\t\t\t\tfor ( var i = 0, il = indices.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\tvar a = indices[ i ];\n\n\t\t\t\t\t\t\tposition.fromArray( positions, a * 3 );\n\n\t\t\t\t\t\t\ttestPoint( position, a );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tfor ( var i = 0, l = positions.length / 3; i < l; i ++ ) {\n\n\t\t\t\t\t\t\tposition.fromArray( positions, i * 3 );\n\n\t\t\t\t\t\t\ttestPoint( position, i );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar vertices = geometry.vertices;\n\n\t\t\t\t\tfor ( var i = 0, l = vertices.length; i < l; i ++ ) {\n\n\t\t\t\t\t\ttestPoint( vertices[ i ], i );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}() ),\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Group() {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Group';\n\n\t}\n\n\tGroup.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: Group\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction VideoTexture( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tTexture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.generateMipmaps = false;\n\n\t\tvar scope = this;\n\n\t\tfunction update() {\n\n\t\t\trequestAnimationFrame( update );\n\n\t\t\tif ( video.readyState >= video.HAVE_CURRENT_DATA ) {\n\n\t\t\t\tscope.needsUpdate = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tupdate();\n\n\t}\n\n\tVideoTexture.prototype = Object.create( Texture.prototype );\n\tVideoTexture.prototype.constructor = VideoTexture;\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction CompressedTexture( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\n\n\t\tTexture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.image = { width: width, height: height };\n\t\tthis.mipmaps = mipmaps;\n\n\t\t// no flipping for cube textures\n\t\t// (also flipping doesn't work for compressed textures )\n\n\t\tthis.flipY = false;\n\n\t\t// can't generate mipmaps for compressed textures\n\t\t// mips must be embedded in DDS files\n\n\t\tthis.generateMipmaps = false;\n\n\t}\n\n\tCompressedTexture.prototype = Object.create( Texture.prototype );\n\tCompressedTexture.prototype.constructor = CompressedTexture;\n\n\tCompressedTexture.prototype.isCompressedTexture = true;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction CanvasTexture( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tTexture.call( this, canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n\tCanvasTexture.prototype = Object.create( Texture.prototype );\n\tCanvasTexture.prototype.constructor = CanvasTexture;\n\n\t/**\n\t * @author Matt DesLauriers / @mattdesl\n\t * @author atix / arthursilber.de\n\t */\n\n\tfunction DepthTexture( width, height, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, format ) {\n\n\t\tformat = format !== undefined ? format : DepthFormat;\n\n\t\tif ( format !== DepthFormat && format !== DepthStencilFormat ) {\n\n\t\t\tthrow new Error( 'DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat' )\n\n\t\t}\n\n\t\tif ( type === undefined && format === DepthFormat ) type = UnsignedShortType;\n\t\tif ( type === undefined && format === DepthStencilFormat ) type = UnsignedInt248Type;\n\n\t\tTexture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.image = { width: width, height: height };\n\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\n\n\t\tthis.flipY = false;\n\t\tthis.generateMipmaps\t= false;\n\n\t}\n\n\tDepthTexture.prototype = Object.create( Texture.prototype );\n\tDepthTexture.prototype.constructor = DepthTexture;\n\tDepthTexture.prototype.isDepthTexture = true;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction WireframeGeometry( geometry ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tvar edge = [ 0, 0 ], hash = {};\n\n\t\tfunction sortFunction( a, b ) {\n\n\t\t\treturn a - b;\n\n\t\t}\n\n\t\tvar keys = [ 'a', 'b', 'c' ];\n\n\t\tif ( geometry && geometry.isGeometry ) {\n\n\t\t\tvar vertices = geometry.vertices;\n\t\t\tvar faces = geometry.faces;\n\t\t\tvar numEdges = 0;\n\n\t\t\t// allocate maximal size\n\t\t\tvar edges = new Uint32Array( 6 * faces.length );\n\n\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\tvar face = faces[ i ];\n\n\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\tedge[ 0 ] = face[ keys[ j ] ];\n\t\t\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\n\t\t\t\t\tedge.sort( sortFunction );\n\n\t\t\t\t\tvar key = edge.toString();\n\n\t\t\t\t\tif ( hash[ key ] === undefined ) {\n\n\t\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\n\t\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\n\t\t\t\t\t\thash[ key ] = true;\n\t\t\t\t\t\tnumEdges ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\n\n\t\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\n\n\t\t\t\tfor ( var j = 0; j < 2; j ++ ) {\n\n\t\t\t\t\tvar vertex = vertices[ edges [ 2 * i + j ] ];\n\n\t\t\t\t\tvar index = 6 * i + 3 * j;\n\t\t\t\t\tcoords[ index + 0 ] = vertex.x;\n\t\t\t\t\tcoords[ index + 1 ] = vertex.y;\n\t\t\t\t\tcoords[ index + 2 ] = vertex.z;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.addAttribute( 'position', new BufferAttribute( coords, 3 ) );\n\n\t\t} else if ( geometry && geometry.isBufferGeometry ) {\n\n\t\t\tif ( geometry.index !== null ) {\n\n\t\t\t\t// Indexed BufferGeometry\n\n\t\t\t\tvar indices = geometry.index.array;\n\t\t\t\tvar vertices = geometry.attributes.position;\n\t\t\t\tvar groups = geometry.groups;\n\t\t\t\tvar numEdges = 0;\n\n\t\t\t\tif ( groups.length === 0 ) {\n\n\t\t\t\t\tgeometry.addGroup( 0, indices.length );\n\n\t\t\t\t}\n\n\t\t\t\t// allocate maximal size\n\t\t\t\tvar edges = new Uint32Array( 2 * indices.length );\n\n\t\t\t\tfor ( var o = 0, ol = groups.length; o < ol; ++ o ) {\n\n\t\t\t\t\tvar group = groups[ o ];\n\n\t\t\t\t\tvar start = group.start;\n\t\t\t\t\tvar count = group.count;\n\n\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\n\n\t\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t\tedge[ 0 ] = indices[ i + j ];\n\t\t\t\t\t\t\tedge[ 1 ] = indices[ i + ( j + 1 ) % 3 ];\n\t\t\t\t\t\t\tedge.sort( sortFunction );\n\n\t\t\t\t\t\t\tvar key = edge.toString();\n\n\t\t\t\t\t\t\tif ( hash[ key ] === undefined ) {\n\n\t\t\t\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\n\t\t\t\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\n\t\t\t\t\t\t\t\thash[ key ] = true;\n\t\t\t\t\t\t\t\tnumEdges ++;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\n\n\t\t\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\n\n\t\t\t\t\tfor ( var j = 0; j < 2; j ++ ) {\n\n\t\t\t\t\t\tvar index = 6 * i + 3 * j;\n\t\t\t\t\t\tvar index2 = edges[ 2 * i + j ];\n\n\t\t\t\t\t\tcoords[ index + 0 ] = vertices.getX( index2 );\n\t\t\t\t\t\tcoords[ index + 1 ] = vertices.getY( index2 );\n\t\t\t\t\t\tcoords[ index + 2 ] = vertices.getZ( index2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tthis.addAttribute( 'position', new BufferAttribute( coords, 3 ) );\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed BufferGeometry\n\n\t\t\t\tvar vertices = geometry.attributes.position.array;\n\t\t\t\tvar numEdges = vertices.length / 3;\n\t\t\t\tvar numTris = numEdges / 3;\n\n\t\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\n\n\t\t\t\tfor ( var i = 0, l = numTris; i < l; i ++ ) {\n\n\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\tvar index = 18 * i + 6 * j;\n\n\t\t\t\t\t\tvar index1 = 9 * i + 3 * j;\n\t\t\t\t\t\tcoords[ index + 0 ] = vertices[ index1 ];\n\t\t\t\t\t\tcoords[ index + 1 ] = vertices[ index1 + 1 ];\n\t\t\t\t\t\tcoords[ index + 2 ] = vertices[ index1 + 2 ];\n\n\t\t\t\t\t\tvar index2 = 9 * i + 3 * ( ( j + 1 ) % 3 );\n\t\t\t\t\t\tcoords[ index + 3 ] = vertices[ index2 ];\n\t\t\t\t\t\tcoords[ index + 4 ] = vertices[ index2 + 1 ];\n\t\t\t\t\t\tcoords[ index + 5 ] = vertices[ index2 + 2 ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tthis.addAttribute( 'position', new BufferAttribute( coords, 3 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tWireframeGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tWireframeGeometry.prototype.constructor = WireframeGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t *\n\t * Parametric Surfaces Geometry\n\t * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\n\t */\n\n\tfunction ParametricBufferGeometry( func, slices, stacks ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'ParametricBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tfunc: func,\n\t\t\tslices: slices,\n\t\t\tstacks: stacks\n\t\t};\n\n\t\t// generate vertices and uvs\n\n\t\tvar vertices = [];\n\t\tvar uvs = [];\n\n\t\tvar i, j, p;\n\t\tvar u, v;\n\n\t\tvar sliceCount = slices + 1;\n\n\t\tfor ( i = 0; i <= stacks; i ++ ) {\n\n\t\t\tv = i / stacks;\n\n\t\t\tfor ( j = 0; j <= slices; j ++ ) {\n\n\t\t\t\tu = j / slices;\n\n\t\t\t\tp = func( u, v );\n\t\t\t\tvertices.push( p.x, p.y, p.z );\n\n\t\t\t\tuvs.push( u, v );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tvar indices = [];\n\t\tvar a, b, c, d;\n\n\t\tfor ( i = 0; i < stacks; i ++ ) {\n\n\t\t\tfor ( j = 0; j < slices; j ++ ) {\n\n\t\t\t\ta = i * sliceCount + j;\n\t\t\t\tb = i * sliceCount + j + 1;\n\t\t\t\tc = ( i + 1 ) * sliceCount + j + 1;\n\t\t\t\td = ( i + 1 ) * sliceCount + j;\n\n\t\t\t\t// faces one and two\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( new ( indices.length > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 ) );\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// generate normals\n\n\t\tthis.computeVertexNormals();\n\n\t}\n\n\tParametricBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tParametricBufferGeometry.prototype.constructor = ParametricBufferGeometry;\n\n\t/**\n\t * @author zz85 / https://github.com/zz85\n\t *\n\t * Parametric Surfaces Geometry\n\t * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\n\t */\n\n\tfunction ParametricGeometry( func, slices, stacks ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'ParametricGeometry';\n\n\t\tthis.parameters = {\n\t\t\tfunc: func,\n\t\t\tslices: slices,\n\t\t\tstacks: stacks\n\t\t};\n\n\t\tthis.fromBufferGeometry( new ParametricBufferGeometry( func, slices, stacks ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tParametricGeometry.prototype = Object.create( Geometry.prototype );\n\tParametricGeometry.prototype.constructor = ParametricGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction PolyhedronBufferGeometry( vertices, indices, radius, detail ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'PolyhedronBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tvertices: vertices,\n\t\t\tindices: indices,\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\tradius = radius || 1;\n\t\tdetail = detail || 0;\n\n\t\t// default buffer data\n\n\t\tvar vertexBuffer = [];\n\t\tvar uvBuffer = [];\n\n\t\t// the subdivision creates the vertex buffer data\n\n\t\tsubdivide( detail );\n\n\t\t// all vertices should lie on a conceptual sphere with a given radius\n\n\t\tappplyRadius( radius );\n\n\t\t// finally, create the uv data\n\n\t\tgenerateUVs();\n\n\t\t// build non-indexed geometry\n\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertexBuffer, 3 ) );\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( vertexBuffer.slice(), 3 ) );\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvBuffer, 2 ) );\n\t\tthis.normalizeNormals();\n\n\t\tthis.boundingSphere = new Sphere( new Vector3(), radius );\n\n\t\t// helper functions\n\n\t\tfunction subdivide( detail ) {\n\n\t\t\tvar a = new Vector3();\n\t\t\tvar b = new Vector3();\n\t\t\tvar c = new Vector3();\n\n\t\t\t// iterate over all faces and apply a subdivison with the given detail value\n\n\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\n\n\t\t\t\t// get the vertices of the face\n\n\t\t\t\tgetVertexByIndex( indices[ i + 0 ], a );\n\t\t\t\tgetVertexByIndex( indices[ i + 1 ], b );\n\t\t\t\tgetVertexByIndex( indices[ i + 2 ], c );\n\n\t\t\t\t// perform subdivision\n\n\t\t\t\tsubdivideFace( a, b, c, detail );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction subdivideFace( a, b, c, detail ) {\n\n\t\t\tvar cols = Math.pow( 2, detail );\n\n\t\t\t// we use this multidimensional array as a data structure for creating the subdivision\n\n\t\t\tvar v = [];\n\n\t\t\tvar i, j;\n\n\t\t\t// construct all of the vertices for this subdivision\n\n\t\t\tfor ( i = 0 ; i <= cols; i ++ ) {\n\n\t\t\t\tv[ i ] = [];\n\n\t\t\t\tvar aj = a.clone().lerp( c, i / cols );\n\t\t\t\tvar bj = b.clone().lerp( c, i / cols );\n\n\t\t\t\tvar rows = cols - i;\n\n\t\t\t\tfor ( j = 0; j <= rows; j ++ ) {\n\n\t\t\t\t\tif ( j === 0 && i === cols ) {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj.clone().lerp( bj, j / rows );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// construct all of the faces\n\n\t\t\tfor ( i = 0; i < cols ; i ++ ) {\n\n\t\t\t\tfor ( j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\n\n\t\t\t\t\tvar k = Math.floor( j / 2 );\n\n\t\t\t\t\tif ( j % 2 === 0 ) {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\t\t\t\t\t\tpushVertex( v[ i ][ k ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction appplyRadius( radius ) {\n\n\t\t\tvar vertex = new Vector3();\n\n\t\t\t// iterate over the entire buffer and apply the radius to each vertex\n\n\t\t\tfor ( var i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tvertex.normalize().multiplyScalar( radius );\n\n\t\t\t\tvertexBuffer[ i + 0 ] = vertex.x;\n\t\t\t\tvertexBuffer[ i + 1 ] = vertex.y;\n\t\t\t\tvertexBuffer[ i + 2 ] = vertex.z;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tvar vertex = new Vector3();\n\n\t\t\tfor ( var i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tvar u = azimuth( vertex ) / 2 / Math.PI + 0.5;\n\t\t\t\tvar v = inclination( vertex ) / Math.PI + 0.5;\n\t\t\t\tuvBuffer.push( u, 1 - v );\n\n\t\t\t}\n\n\t\t\tcorrectUVs();\n\n\t\t\tcorrectSeam();\n\n\t\t}\n\n\t\tfunction correctSeam() {\n\n\t\t\t// handle case when face straddles the seam, see #3269\n\n\t\t\tfor ( var i = 0; i < uvBuffer.length; i += 6 ) {\n\n\t\t\t\t// uv data of a single face\n\n\t\t\t\tvar x0 = uvBuffer[ i + 0 ];\n\t\t\t\tvar x1 = uvBuffer[ i + 2 ];\n\t\t\t\tvar x2 = uvBuffer[ i + 4 ];\n\n\t\t\t\tvar max = Math.max( x0, x1, x2 );\n\t\t\t\tvar min = Math.min( x0, x1, x2 );\n\n\t\t\t\t// 0.9 is somewhat arbitrary\n\n\t\t\t\tif ( max > 0.9 && min < 0.1 ) {\n\n\t\t\t\t\tif ( x0 < 0.2 ) uvBuffer[ i + 0 ] += 1;\n\t\t\t\t\tif ( x1 < 0.2 ) uvBuffer[ i + 2 ] += 1;\n\t\t\t\t\tif ( x2 < 0.2 ) uvBuffer[ i + 4 ] += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction pushVertex( vertex ) {\n\n\t\t\tvertexBuffer.push( vertex.x, vertex.y, vertex.z );\n\n\t\t}\n\n\t\tfunction getVertexByIndex( index, vertex ) {\n\n\t\t\tvar stride = index * 3;\n\n\t\t\tvertex.x = vertices[ stride + 0 ];\n\t\t\tvertex.y = vertices[ stride + 1 ];\n\t\t\tvertex.z = vertices[ stride + 2 ];\n\n\t\t}\n\n\t\tfunction correctUVs() {\n\n\t\t\tvar a = new Vector3();\n\t\t\tvar b = new Vector3();\n\t\t\tvar c = new Vector3();\n\n\t\t\tvar centroid = new Vector3();\n\n\t\t\tvar uvA = new Vector2();\n\t\t\tvar uvB = new Vector2();\n\t\t\tvar uvC = new Vector2();\n\n\t\t\tfor ( var i = 0, j = 0; i < vertexBuffer.length; i += 9, j += 6 ) {\n\n\t\t\t\ta.set( vertexBuffer[ i + 0 ], vertexBuffer[ i + 1 ], vertexBuffer[ i + 2 ] );\n\t\t\t\tb.set( vertexBuffer[ i + 3 ], vertexBuffer[ i + 4 ], vertexBuffer[ i + 5 ] );\n\t\t\t\tc.set( vertexBuffer[ i + 6 ], vertexBuffer[ i + 7 ], vertexBuffer[ i + 8 ] );\n\n\t\t\t\tuvA.set( uvBuffer[ j + 0 ], uvBuffer[ j + 1 ] );\n\t\t\t\tuvB.set( uvBuffer[ j + 2 ], uvBuffer[ j + 3 ] );\n\t\t\t\tuvC.set( uvBuffer[ j + 4 ], uvBuffer[ j + 5 ] );\n\n\t\t\t\tcentroid.copy( a ).add( b ).add( c ).divideScalar( 3 );\n\n\t\t\t\tvar azi = azimuth( centroid );\n\n\t\t\t\tcorrectUV( uvA, j + 0, a, azi );\n\t\t\t\tcorrectUV( uvB, j + 2, b, azi );\n\t\t\t\tcorrectUV( uvC, j + 4, c, azi );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction correctUV( uv, stride, vector, azimuth  ) {\n\n\t\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] =  uv.x - 1;\n\n\t\t\t}\n\n\t\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] = azimuth / 2 / Math.PI + 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Angle around the Y axis, counter-clockwise when looking from above.\n\n\t\tfunction azimuth( vector ) {\n\n\t\t\treturn Math.atan2( vector.z, - vector.x );\n\n\t\t}\n\n\n\t\t// Angle above the XZ plane.\n\n\t\tfunction inclination( vector ) {\n\n\t\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\n\n\t\t}\n\n\t}\n\n\tPolyhedronBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tPolyhedronBufferGeometry.prototype.constructor = PolyhedronBufferGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction TetrahedronBufferGeometry( radius, detail ) {\n\n\t\tvar vertices = [\n\t\t\t1,  1,  1,   - 1, - 1,  1,   - 1,  1, - 1,    1, - 1, - 1\n\t\t];\n\n\t\tvar indices = [\n\t\t\t2,  1,  0,    0,  3,  2,    1,  3,  0,    2,  3,  1\n\t\t];\n\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\n\n\t\tthis.type = 'TetrahedronBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tTetrahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\n\tTetrahedronBufferGeometry.prototype.constructor = TetrahedronBufferGeometry;\n\n\t/**\n\t * @author timothypratley / https://github.com/timothypratley\n\t */\n\n\tfunction TetrahedronGeometry( radius, detail ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'TetrahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\tthis.fromBufferGeometry( new TetrahedronBufferGeometry( radius, detail ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tTetrahedronGeometry.prototype = Object.create( Geometry.prototype );\n\tTetrahedronGeometry.prototype.constructor = TetrahedronGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction OctahedronBufferGeometry( radius,detail ) {\n\n\t\tvar vertices = [\n\t\t\t1, 0, 0,   - 1, 0, 0,    0, 1, 0,    0, - 1, 0,    0, 0, 1,    0, 0, - 1\n\t\t];\n\n\t\tvar indices = [\n\t\t\t0, 2, 4,    0, 4, 3,    0, 3, 5,    0, 5, 2,    1, 2, 5,    1, 5, 3,    1, 3, 4,    1, 4, 2\n\t\t];\n\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\n\n\t\tthis.type = 'OctahedronBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tOctahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\n\tOctahedronBufferGeometry.prototype.constructor = OctahedronBufferGeometry;\n\n\t/**\n\t * @author timothypratley / https://github.com/timothypratley\n\t */\n\n\tfunction OctahedronGeometry( radius, detail ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'OctahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\tthis.fromBufferGeometry( new OctahedronBufferGeometry( radius, detail ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tOctahedronGeometry.prototype = Object.create( Geometry.prototype );\n\tOctahedronGeometry.prototype.constructor = OctahedronGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction IcosahedronBufferGeometry( radius, detail ) {\n\n\t\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\n\t\tvar vertices = [\n\t\t\t- 1,  t,  0,    1,  t,  0,   - 1, - t,  0,    1, - t,  0,\n\t\t\t 0, - 1,  t,    0,  1,  t,    0, - 1, - t,    0,  1, - t,\n\t\t\t t,  0, - 1,    t,  0,  1,   - t,  0, - 1,   - t,  0,  1\n\t\t];\n\n\t\tvar indices = [\n\t\t\t 0, 11,  5,    0,  5,  1,    0,  1,  7,    0,  7, 10,    0, 10, 11,\n\t\t\t 1,  5,  9,    5, 11,  4,   11, 10,  2,   10,  7,  6,    7,  1,  8,\n\t\t\t 3,  9,  4,    3,  4,  2,    3,  2,  6,    3,  6,  8,    3,  8,  9,\n\t\t\t 4,  9,  5,    2,  4, 11,    6,  2, 10,    8,  6,  7,    9,  8,  1\n\t\t];\n\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\n\n\t\tthis.type = 'IcosahedronBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tIcosahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\n\tIcosahedronBufferGeometry.prototype.constructor = IcosahedronBufferGeometry;\n\n\t/**\n\t * @author timothypratley / https://github.com/timothypratley\n\t */\n\n\tfunction IcosahedronGeometry( radius, detail ) {\n\n\t \tGeometry.call( this );\n\n\t\tthis.type = 'IcosahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\tthis.fromBufferGeometry( new IcosahedronBufferGeometry( radius, detail ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tIcosahedronGeometry.prototype = Object.create( Geometry.prototype );\n\tIcosahedronGeometry.prototype.constructor = IcosahedronGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction DodecahedronBufferGeometry( radius, detail ) {\n\n\t\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\t\tvar r = 1 / t;\n\n\t\tvar vertices = [\n\n\t\t\t// (±1, ±1, ±1)\n\t\t\t- 1, - 1, - 1,    - 1, - 1,  1,\n\t\t\t- 1,  1, - 1,    - 1,  1,  1,\n\t\t\t 1, - 1, - 1,     1, - 1,  1,\n\t\t\t 1,  1, - 1,     1,  1,  1,\n\n\t\t\t// (0, ±1/φ, ±φ)\n\t\t\t 0, - r, - t,     0, - r,  t,\n\t\t\t 0,  r, - t,     0,  r,  t,\n\n\t\t\t// (±1/φ, ±φ, 0)\n\t\t\t- r, - t,  0,    - r,  t,  0,\n\t\t\t r, - t,  0,     r,  t,  0,\n\n\t\t\t// (±φ, 0, ±1/φ)\n\t\t\t- t,  0, - r,     t,  0, - r,\n\t\t\t- t,  0,  r,     t,  0,  r\n\t\t];\n\n\t\tvar indices = [\n\t\t\t 3, 11,  7,      3,  7, 15,      3, 15, 13,\n\t\t\t 7, 19, 17,      7, 17,  6,      7,  6, 15,\n\t\t\t17,  4,  8,     17,  8, 10,     17, 10,  6,\n\t\t\t 8,  0, 16,      8, 16,  2,      8,  2, 10,\n\t\t\t 0, 12,  1,      0,  1, 18,      0, 18, 16,\n\t\t\t 6, 10,  2,      6,  2, 13,      6, 13, 15,\n\t\t\t 2, 16, 18,      2, 18,  3,      2,  3, 13,\n\t\t\t18,  1,  9,     18,  9, 11,     18, 11,  3,\n\t\t\t 4, 14, 12,      4, 12,  0,      4,  0,  8,\n\t\t\t11,  9,  5,     11,  5, 19,     11, 19,  7,\n\t\t\t19,  5, 14,     19, 14,  4,     19,  4, 17,\n\t\t\t 1, 12, 14,      1, 14,  5,      1,  5,  9\n\t\t];\n\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\n\n\t\tthis.type = 'DodecahedronBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tDodecahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\n\tDodecahedronBufferGeometry.prototype.constructor = DodecahedronBufferGeometry;\n\n\t/**\n\t * @author Abe Pazos / https://hamoid.com\n\t */\n\n\tfunction DodecahedronGeometry( radius, detail ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'DodecahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\tthis.fromBufferGeometry( new DodecahedronBufferGeometry( radius, detail ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tDodecahedronGeometry.prototype = Object.create( Geometry.prototype );\n\tDodecahedronGeometry.prototype.constructor = DodecahedronGeometry;\n\n\t/**\n\t * @author clockworkgeek / https://github.com/clockworkgeek\n\t * @author timothypratley / https://github.com/timothypratley\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/\n\n\tfunction PolyhedronGeometry( vertices, indices, radius, detail ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'PolyhedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tvertices: vertices,\n\t\t\tindices: indices,\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\tthis.fromBufferGeometry( new PolyhedronBufferGeometry( vertices, indices, radius, detail ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tPolyhedronGeometry.prototype = Object.create( Geometry.prototype );\n\tPolyhedronGeometry.prototype.constructor = PolyhedronGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t *\n\t * Creates a tube which extrudes along a 3d spline.\n\t *\n\t */\n\n\tfunction TubeBufferGeometry( path, tubularSegments, radius, radialSegments, closed ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'TubeBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpath: path,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradius: radius,\n\t\t\tradialSegments: radialSegments,\n\t\t\tclosed: closed\n\t\t};\n\n\t\ttubularSegments = tubularSegments || 64;\n\t\tradius = radius || 1;\n\t\tradialSegments = radialSegments || 8;\n\t\tclosed = closed || false;\n\n\t\tvar frames = path.computeFrenetFrames( tubularSegments, closed );\n\n\t\t// expose internals\n\n\t\tthis.tangents = frames.tangents;\n\t\tthis.normals = frames.normals;\n\t\tthis.binormals = frames.binormals;\n\n\t\t// helper variables\n\n\t\tvar vertex = new Vector3();\n\t\tvar normal = new Vector3();\n\t\tvar uv = new Vector2();\n\n\t\tvar i, j;\n\n\t\t// buffer\n\n\t\tvar vertices = [];\n\t\tvar normals = [];\n\t\tvar uvs = [];\n\t\tvar indices = [];\n\n\t\t// create buffer data\n\n\t\tgenerateBufferData();\n\n\t\t// build geometry\n\n\t\tthis.setIndex( new ( indices.length > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 ) );\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// functions\n\n\t\tfunction generateBufferData() {\n\n\t\t\tfor ( i = 0; i < tubularSegments; i ++ ) {\n\n\t\t\t\tgenerateSegment( i );\n\n\t\t\t}\n\n\t\t\t// if the geometry is not closed, generate the last row of vertices and normals\n\t\t\t// at the regular position on the given path\n\t\t\t//\n\t\t\t// if the geometry is closed, duplicate the first row of vertices and normals (uvs will differ)\n\n\t\t\tgenerateSegment( ( closed === false ) ? tubularSegments : 0 );\n\n\t\t\t// uvs are generated in a separate function.\n\t\t\t// this makes it easy compute correct values for closed geometries\n\n\t\t\tgenerateUVs();\n\n\t\t\t// finally create faces\n\n\t\t\tgenerateIndices();\n\n\t\t}\n\n\t\tfunction generateSegment( i ) {\n\n\t\t\t// we use getPointAt to sample evenly distributed points from the given path\n\n\t\t\tvar P = path.getPointAt( i / tubularSegments );\n\n\t\t\t// retrieve corresponding normal and binormal\n\n\t\t\tvar N = frames.normals[ i ];\n\t\t\tvar B = frames.binormals[ i ];\n\n\t\t\t// generate normals and vertices for the current segment\n\n\t\t\tfor ( j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\tvar sin =   Math.sin( v );\n\t\t\t\tvar cos = - Math.cos( v );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.x = ( cos * N.x + sin * B.x );\n\t\t\t\tnormal.y = ( cos * N.y + sin * B.y );\n\t\t\t\tnormal.z = ( cos * N.z + sin * B.z );\n\t\t\t\tnormal.normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = P.x + radius * normal.x;\n\t\t\t\tvertex.y = P.y + radius * normal.y;\n\t\t\t\tvertex.z = P.z + radius * normal.z;\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateIndices() {\n\n\t\t\tfor ( j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\t\tfor ( i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t\tvar a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\t\tvar b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\t\tvar c = ( radialSegments + 1 ) * j + i;\n\t\t\t\t\tvar d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tfor ( i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tfor ( j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\t\tuv.x = i / tubularSegments;\n\t\t\t\t\tuv.y = j / radialSegments;\n\n\t\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tTubeBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tTubeBufferGeometry.prototype.constructor = TubeBufferGeometry;\n\n\t/**\n\t * @author oosmoxiecode / https://github.com/oosmoxiecode\n\t * @author WestLangley / https://github.com/WestLangley\n\t * @author zz85 / https://github.com/zz85\n\t * @author miningold / https://github.com/miningold\n\t * @author jonobr1 / https://github.com/jonobr1\n\t *\n\t * Creates a tube which extrudes along a 3d spline.\n\t */\n\n\tfunction TubeGeometry( path, tubularSegments, radius, radialSegments, closed, taper ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'TubeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpath: path,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradius: radius,\n\t\t\tradialSegments: radialSegments,\n\t\t\tclosed: closed\n\t\t};\n\n\t\tif ( taper !== undefined ) console.warn( 'THREE.TubeGeometry: taper has been removed.' );\n\n\t\tvar bufferGeometry = new TubeBufferGeometry( path, tubularSegments, radius, radialSegments, closed );\n\n\t\t// expose internals\n\n\t\tthis.tangents = bufferGeometry.tangents;\n\t\tthis.normals = bufferGeometry.normals;\n\t\tthis.binormals = bufferGeometry.binormals;\n\n\t\t// create geometry\n\n\t\tthis.fromBufferGeometry( bufferGeometry );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tTubeGeometry.prototype = Object.create( Geometry.prototype );\n\tTubeGeometry.prototype.constructor = TubeGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t *\n\t * see: http://www.blackpawn.com/texts/pqtorus/\n\t */\n\tfunction TorusKnotBufferGeometry( radius, tube, tubularSegments, radialSegments, p, q ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'TorusKnotBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradialSegments: radialSegments,\n\t\t\tp: p,\n\t\t\tq: q\n\t\t};\n\n\t\tradius = radius || 100;\n\t\ttube = tube || 40;\n\t\ttubularSegments = Math.floor( tubularSegments ) || 64;\n\t\tradialSegments = Math.floor( radialSegments ) || 8;\n\t\tp = p || 2;\n\t\tq = q || 3;\n\n\t\t// used to calculate buffer length\n\t\tvar vertexCount = ( ( radialSegments + 1 ) * ( tubularSegments + 1 ) );\n\t\tvar indexCount = radialSegments * tubularSegments * 2 * 3;\n\n\t\t// buffers\n\t\tvar indices = new BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ) , 1 );\n\t\tvar vertices = new BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\t\tvar normals = new BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\t\tvar uvs = new BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\n\n\t\t// helper variables\n\t\tvar i, j, index = 0, indexOffset = 0;\n\n\t\tvar vertex = new Vector3();\n\t\tvar normal = new Vector3();\n\t\tvar uv = new Vector2();\n\n\t\tvar P1 = new Vector3();\n\t\tvar P2 = new Vector3();\n\n\t\tvar B = new Vector3();\n\t\tvar T = new Vector3();\n\t\tvar N = new Vector3();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( i = 0; i <= tubularSegments; ++ i ) {\n\n\t\t\t// the radian \"u\" is used to calculate the position on the torus curve of the current tubular segement\n\n\t\t\tvar u = i / tubularSegments * p * Math.PI * 2;\n\n\t\t\t// now we calculate two points. P1 is our current position on the curve, P2 is a little farther ahead.\n\t\t\t// these points are used to create a special \"coordinate space\", which is necessary to calculate the correct vertex positions\n\n\t\t\tcalculatePositionOnCurve( u, p, q, radius, P1 );\n\t\t\tcalculatePositionOnCurve( u + 0.01, p, q, radius, P2 );\n\n\t\t\t// calculate orthonormal basis\n\n\t\t\tT.subVectors( P2, P1 );\n\t\t\tN.addVectors( P2, P1 );\n\t\t\tB.crossVectors( T, N );\n\t\t\tN.crossVectors( B, T );\n\n\t\t\t// normalize B, N. T can be ignored, we don't use it\n\n\t\t\tB.normalize();\n\t\t\tN.normalize();\n\n\t\t\tfor ( j = 0; j <= radialSegments; ++ j ) {\n\n\t\t\t\t// now calculate the vertices. they are nothing more than an extrusion of the torus curve.\n\t\t\t\t// because we extrude a shape in the xy-plane, there is no need to calculate a z-value.\n\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\n\t\t\t\tvar cx = - tube * Math.cos( v );\n\t\t\t\tvar cy = tube * Math.sin( v );\n\n\t\t\t\t// now calculate the final vertex position.\n\t\t\t\t// first we orient the extrusion with our basis vectos, then we add it to the current position on the curve\n\n\t\t\t\tvertex.x = P1.x + ( cx * N.x + cy * B.x );\n\t\t\t\tvertex.y = P1.y + ( cx * N.y + cy * B.y );\n\t\t\t\tvertex.z = P1.z + ( cx * N.z + cy * B.z );\n\n\t\t\t\t// vertex\n\t\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal (P1 is always the center/origin of the extrusion, thus we can use it to calculate the normal)\n\t\t\t\tnormal.subVectors( vertex, P1 ).normalize();\n\t\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\t\t\t\tuv.x = i / tubularSegments;\n\t\t\t\tuv.y = j / radialSegments;\n\t\t\t\tuvs.setXY( index, uv.x, uv.y );\n\n\t\t\t\t// increase index\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\tfor ( i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t// indices\n\t\t\t\tvar a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\tvar b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\tvar c = ( radialSegments + 1 ) * j + i;\n\t\t\t\tvar d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t// face one\n\t\t\t\tindices.setX( indexOffset, a ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, b ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, d ); indexOffset++;\n\n\t\t\t\t// face two\n\t\t\t\tindices.setX( indexOffset, b ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, c ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, d ); indexOffset++;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.addAttribute( 'position', vertices );\n\t\tthis.addAttribute( 'normal', normals );\n\t\tthis.addAttribute( 'uv', uvs );\n\n\t\t// this function calculates the current position on the torus curve\n\n\t\tfunction calculatePositionOnCurve( u, p, q, radius, position ) {\n\n\t\t\tvar cu = Math.cos( u );\n\t\t\tvar su = Math.sin( u );\n\t\t\tvar quOverP = q / p * u;\n\t\t\tvar cs = Math.cos( quOverP );\n\n\t\t\tposition.x = radius * ( 2 + cs ) * 0.5 * cu;\n\t\t\tposition.y = radius * ( 2 + cs ) * su * 0.5;\n\t\t\tposition.z = radius * Math.sin( quOverP ) * 0.5;\n\n\t\t}\n\n\t}\n\n\tTorusKnotBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tTorusKnotBufferGeometry.prototype.constructor = TorusKnotBufferGeometry;\n\n\t/**\n\t * @author oosmoxiecode\n\t */\n\n\tfunction TorusKnotGeometry( radius, tube, tubularSegments, radialSegments, p, q, heightScale ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'TorusKnotGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradialSegments: radialSegments,\n\t\t\tp: p,\n\t\t\tq: q\n\t\t};\n\n\t\tif( heightScale !== undefined ) console.warn( 'THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.' );\n\n\t\tthis.fromBufferGeometry( new TorusKnotBufferGeometry( radius, tube, tubularSegments, radialSegments, p, q ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tTorusKnotGeometry.prototype = Object.create( Geometry.prototype );\n\tTorusKnotGeometry.prototype.constructor = TorusKnotGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction TorusBufferGeometry( radius, tube, radialSegments, tubularSegments, arc ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'TorusBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\tradialSegments: radialSegments,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tarc: arc\n\t\t};\n\n\t\tradius = radius || 100;\n\t\ttube = tube || 40;\n\t\tradialSegments = Math.floor( radialSegments ) || 8;\n\t\ttubularSegments = Math.floor( tubularSegments ) || 6;\n\t\tarc = arc || Math.PI * 2;\n\n\t\t// used to calculate buffer length\n\t\tvar vertexCount = ( ( radialSegments + 1 ) * ( tubularSegments + 1 ) );\n\t\tvar indexCount = radialSegments * tubularSegments * 2 * 3;\n\n\t\t// buffers\n\t\tvar indices = new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount );\n\t\tvar vertices = new Float32Array( vertexCount * 3 );\n\t\tvar normals = new Float32Array( vertexCount * 3 );\n\t\tvar uvs = new Float32Array( vertexCount * 2 );\n\n\t\t// offset variables\n\t\tvar vertexBufferOffset = 0;\n\t\tvar uvBufferOffset = 0;\n\t\tvar indexBufferOffset = 0;\n\n\t\t// helper variables\n\t\tvar center = new Vector3();\n\t\tvar vertex = new Vector3();\n\t\tvar normal = new Vector3();\n\n\t\tvar j, i;\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tvar u = i / tubularSegments * arc;\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\t// vertex\n\t\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\n\t\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\n\t\t\t\tvertex.z = tube * Math.sin( v );\n\n\t\t\t\tvertices[ vertexBufferOffset ] = vertex.x;\n\t\t\t\tvertices[ vertexBufferOffset + 1 ] = vertex.y;\n\t\t\t\tvertices[ vertexBufferOffset + 2 ] = vertex.z;\n\n\t\t\t\t// this vector is used to calculate the normal\n\t\t\t\tcenter.x = radius * Math.cos( u );\n\t\t\t\tcenter.y = radius * Math.sin( u );\n\n\t\t\t\t// normal\n\t\t\t\tnormal.subVectors( vertex, center ).normalize();\n\n\t\t\t\tnormals[ vertexBufferOffset ] = normal.x;\n\t\t\t\tnormals[ vertexBufferOffset + 1 ] = normal.y;\n\t\t\t\tnormals[ vertexBufferOffset + 2 ] = normal.z;\n\n\t\t\t\t// uv\n\t\t\t\tuvs[ uvBufferOffset ] = i / tubularSegments;\n\t\t\t\tuvs[ uvBufferOffset + 1 ] = j / radialSegments;\n\n\t\t\t\t// update offsets\n\t\t\t\tvertexBufferOffset += 3;\n\t\t\t\tuvBufferOffset += 2;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( j = 1; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( i = 1; i <= tubularSegments; i ++ ) {\n\n\t\t\t\t// indices\n\t\t\t\tvar a = ( tubularSegments + 1 ) * j + i - 1;\n\t\t\t\tvar b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\n\t\t\t\tvar c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\n\t\t\t\tvar d = ( tubularSegments + 1 ) * j + i;\n\n\t\t\t\t// face one\n\t\t\t\tindices[ indexBufferOffset ] = a;\n\t\t\t\tindices[ indexBufferOffset + 1 ] = b;\n\t\t\t\tindices[ indexBufferOffset + 2 ] = d;\n\n\t\t\t\t// face two\n\t\t\t\tindices[ indexBufferOffset + 3 ] = b;\n\t\t\t\tindices[ indexBufferOffset + 4 ] = c;\n\t\t\t\tindices[ indexBufferOffset + 5 ] = d;\n\n\t\t\t\t// update offset\n\t\t\t\tindexBufferOffset += 6;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\t\tthis.setIndex( new BufferAttribute( indices, 1 ) );\n\t\tthis.addAttribute( 'position', new BufferAttribute( vertices, 3 ) );\n\t\tthis.addAttribute( 'normal', new BufferAttribute( normals, 3 ) );\n\t\tthis.addAttribute( 'uv', new BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tTorusBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tTorusBufferGeometry.prototype.constructor = TorusBufferGeometry;\n\n\t/**\n\t * @author oosmoxiecode\n\t * @author mrdoob / http://mrdoob.com/\n\t * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\n\t */\n\n\tfunction TorusGeometry( radius, tube, radialSegments, tubularSegments, arc ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'TorusGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\tradialSegments: radialSegments,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tarc: arc\n\t\t};\n\n\t\tthis.fromBufferGeometry( new TorusBufferGeometry( radius, tube, radialSegments, tubularSegments, arc ) );\n\n\t}\n\n\tTorusGeometry.prototype = Object.create( Geometry.prototype );\n\tTorusGeometry.prototype.constructor = TorusGeometry;\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t */\n\n\tvar ShapeUtils = {\n\n\t\t// calculate area of the contour polygon\n\n\t\tarea: function ( contour ) {\n\n\t\t\tvar n = contour.length;\n\t\t\tvar a = 0.0;\n\n\t\t\tfor ( var p = n - 1, q = 0; q < n; p = q ++ ) {\n\n\t\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\n\n\t\t\t}\n\n\t\t\treturn a * 0.5;\n\n\t\t},\n\n\t\ttriangulate: ( function () {\n\n\t\t\t/**\n\t\t\t * This code is a quick port of code written in C++ which was submitted to\n\t\t\t * flipcode.com by John W. Ratcliff  // July 22, 2000\n\t\t\t * See original code and more information here:\n\t\t\t * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\n\t\t\t *\n\t\t\t * ported to actionscript by Zevan Rosser\n\t\t\t * www.actionsnippet.com\n\t\t\t *\n\t\t\t * ported to javascript by Joshua Koo\n\t\t\t * http://www.lab4games.net/zz85/blog\n\t\t\t *\n\t\t\t */\n\n\t\t\tfunction snip( contour, u, v, w, n, verts ) {\n\n\t\t\t\tvar p;\n\t\t\t\tvar ax, ay, bx, by;\n\t\t\t\tvar cx, cy, px, py;\n\n\t\t\t\tax = contour[ verts[ u ] ].x;\n\t\t\t\tay = contour[ verts[ u ] ].y;\n\n\t\t\t\tbx = contour[ verts[ v ] ].x;\n\t\t\t\tby = contour[ verts[ v ] ].y;\n\n\t\t\t\tcx = contour[ verts[ w ] ].x;\n\t\t\t\tcy = contour[ verts[ w ] ].y;\n\n\t\t\t\tif ( ( bx - ax ) * ( cy - ay ) - ( by - ay ) * ( cx - ax ) <= 0 ) return false;\n\n\t\t\t\tvar aX, aY, bX, bY, cX, cY;\n\t\t\t\tvar apx, apy, bpx, bpy, cpx, cpy;\n\t\t\t\tvar cCROSSap, bCROSScp, aCROSSbp;\n\n\t\t\t\taX = cx - bx;  aY = cy - by;\n\t\t\t\tbX = ax - cx;  bY = ay - cy;\n\t\t\t\tcX = bx - ax;  cY = by - ay;\n\n\t\t\t\tfor ( p = 0; p < n; p ++ ) {\n\n\t\t\t\t\tpx = contour[ verts[ p ] ].x;\n\t\t\t\t\tpy = contour[ verts[ p ] ].y;\n\n\t\t\t\t\tif ( ( ( px === ax ) && ( py === ay ) ) ||\n\t\t\t\t\t\t ( ( px === bx ) && ( py === by ) ) ||\n\t\t\t\t\t\t ( ( px === cx ) && ( py === cy ) ) )\tcontinue;\n\n\t\t\t\t\tapx = px - ax;  apy = py - ay;\n\t\t\t\t\tbpx = px - bx;  bpy = py - by;\n\t\t\t\t\tcpx = px - cx;  cpy = py - cy;\n\n\t\t\t\t\t// see if p is inside triangle abc\n\n\t\t\t\t\taCROSSbp = aX * bpy - aY * bpx;\n\t\t\t\t\tcCROSSap = cX * apy - cY * apx;\n\t\t\t\t\tbCROSScp = bX * cpy - bY * cpx;\n\n\t\t\t\t\tif ( ( aCROSSbp >= - Number.EPSILON ) && ( bCROSScp >= - Number.EPSILON ) && ( cCROSSap >= - Number.EPSILON ) ) return false;\n\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\t// takes in an contour array and returns\n\n\t\t\treturn function triangulate( contour, indices ) {\n\n\t\t\t\tvar n = contour.length;\n\n\t\t\t\tif ( n < 3 ) return null;\n\n\t\t\t\tvar result = [],\n\t\t\t\t\tverts = [],\n\t\t\t\t\tvertIndices = [];\n\n\t\t\t\t/* we want a counter-clockwise polygon in verts */\n\n\t\t\t\tvar u, v, w;\n\n\t\t\t\tif ( ShapeUtils.area( contour ) > 0.0 ) {\n\n\t\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = v;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = ( n - 1 ) - v;\n\n\t\t\t\t}\n\n\t\t\t\tvar nv = n;\n\n\t\t\t\t/*  remove nv - 2 vertices, creating 1 triangle every time */\n\n\t\t\t\tvar count = 2 * nv;   /* error detection */\n\n\t\t\t\tfor ( v = nv - 1; nv > 2; ) {\n\n\t\t\t\t\t/* if we loop, it is probably a non-simple polygon */\n\n\t\t\t\t\tif ( ( count -- ) <= 0 ) {\n\n\t\t\t\t\t\t//** Triangulate: ERROR - probable bad polygon!\n\n\t\t\t\t\t\t//throw ( \"Warning, unable to triangulate polygon!\" );\n\t\t\t\t\t\t//return null;\n\t\t\t\t\t\t// Sometimes warning is fine, especially polygons are triangulated in reverse.\n\t\t\t\t\t\tconsole.warn( 'THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()' );\n\n\t\t\t\t\t\tif ( indices ) return vertIndices;\n\t\t\t\t\t\treturn result;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t/* three consecutive vertices in current polygon, <u,v,w> */\n\n\t\t\t\t\tu = v; \t \tif ( nv <= u ) u = 0;     /* previous */\n\t\t\t\t\tv = u + 1;  if ( nv <= v ) v = 0;     /* new v    */\n\t\t\t\t\tw = v + 1;  if ( nv <= w ) w = 0;     /* next     */\n\n\t\t\t\t\tif ( snip( contour, u, v, w, nv, verts ) ) {\n\n\t\t\t\t\t\tvar a, b, c, s, t;\n\n\t\t\t\t\t\t/* true names of the vertices */\n\n\t\t\t\t\t\ta = verts[ u ];\n\t\t\t\t\t\tb = verts[ v ];\n\t\t\t\t\t\tc = verts[ w ];\n\n\t\t\t\t\t\t/* output Triangle */\n\n\t\t\t\t\t\tresult.push( [ contour[ a ],\n\t\t\t\t\t\t\tcontour[ b ],\n\t\t\t\t\t\t\tcontour[ c ] ] );\n\n\n\t\t\t\t\t\tvertIndices.push( [ verts[ u ], verts[ v ], verts[ w ] ] );\n\n\t\t\t\t\t\t/* remove v from the remaining polygon */\n\n\t\t\t\t\t\tfor ( s = v, t = v + 1; t < nv; s ++, t ++ ) {\n\n\t\t\t\t\t\t\tverts[ s ] = verts[ t ];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnv --;\n\n\t\t\t\t\t\t/* reset error detection counter */\n\n\t\t\t\t\t\tcount = 2 * nv;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( indices ) return vertIndices;\n\t\t\t\treturn result;\n\n\t\t\t}\n\n\t\t} )(),\n\n\t\ttriangulateShape: function ( contour, holes ) {\n\n\t\t\tfunction removeDupEndPts(points) {\n\n\t\t\t\tvar l = points.length;\n\n\t\t\t\tif ( l > 2 && points[ l - 1 ].equals( points[ 0 ] ) ) {\n\n\t\t\t\t\tpoints.pop();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tremoveDupEndPts( contour );\n\t\t\tholes.forEach( removeDupEndPts );\n\n\t\t\tfunction point_in_segment_2D_colin( inSegPt1, inSegPt2, inOtherPt ) {\n\n\t\t\t\t// inOtherPt needs to be collinear to the inSegment\n\t\t\t\tif ( inSegPt1.x !== inSegPt2.x ) {\n\n\t\t\t\t\tif ( inSegPt1.x < inSegPt2.x ) {\n\n\t\t\t\t\t\treturn\t( ( inSegPt1.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt2.x ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\treturn\t( ( inSegPt2.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt1.x ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( inSegPt1.y < inSegPt2.y ) {\n\n\t\t\t\t\t\treturn\t( ( inSegPt1.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt2.y ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\treturn\t( ( inSegPt2.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt1.y ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction intersect_segments_2D( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs ) {\n\n\t\t\t\tvar seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,   seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\n\t\t\t\tvar seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,   seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\n\n\t\t\t\tvar seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\n\t\t\t\tvar seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\n\n\t\t\t\tvar limit\t\t= seg1dy * seg2dx - seg1dx * seg2dy;\n\t\t\t\tvar perpSeg1\t= seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\n\n\t\t\t\tif ( Math.abs( limit ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not parallel\n\n\t\t\t\t\tvar perpSeg2;\n\t\t\t\t\tif ( limit > 0 ) {\n\n\t\t\t\t\t\tif ( ( perpSeg1 < 0 ) || ( perpSeg1 > limit ) ) \t\treturn [];\n\t\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\n\t\t\t\t\t\tif ( ( perpSeg2 < 0 ) || ( perpSeg2 > limit ) ) \t\treturn [];\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( ( perpSeg1 > 0 ) || ( perpSeg1 < limit ) ) \t\treturn [];\n\t\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\n\t\t\t\t\t\tif ( ( perpSeg2 > 0 ) || ( perpSeg2 < limit ) ) \t\treturn [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// i.e. to reduce rounding errors\n\t\t\t\t\t// intersection at endpoint of segment#1?\n\t\t\t\t\tif ( perpSeg2 === 0 ) {\n\n\t\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\n\t\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\n\t\t\t\t\t\treturn [ inSeg1Pt1 ];\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( perpSeg2 === limit ) {\n\n\t\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\n\t\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\n\t\t\t\t\t\treturn [ inSeg1Pt2 ];\n\n\t\t\t\t\t}\n\t\t\t\t\t// intersection at endpoint of segment#2?\n\t\t\t\t\tif ( perpSeg1 === 0 )\t\treturn [ inSeg2Pt1 ];\n\t\t\t\t\tif ( perpSeg1 === limit )\treturn [ inSeg2Pt2 ];\n\n\t\t\t\t\t// return real intersection point\n\t\t\t\t\tvar factorSeg1 = perpSeg2 / limit;\n\t\t\t\t\treturn\t[ { x: inSeg1Pt1.x + factorSeg1 * seg1dx,\n\t\t\t\t\t\t\t\ty: inSeg1Pt1.y + factorSeg1 * seg1dy } ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// parallel or collinear\n\t\t\t\t\tif ( ( perpSeg1 !== 0 ) ||\n\t\t\t\t\t\t ( seg2dy * seg1seg2dx !== seg2dx * seg1seg2dy ) ) \t\t\treturn [];\n\n\t\t\t\t\t// they are collinear or degenerate\n\t\t\t\t\tvar seg1Pt = ( ( seg1dx === 0 ) && ( seg1dy === 0 ) );\t// segment1 is just a point?\n\t\t\t\t\tvar seg2Pt = ( ( seg2dx === 0 ) && ( seg2dy === 0 ) );\t// segment2 is just a point?\n\t\t\t\t\t// both segments are points\n\t\t\t\t\tif ( seg1Pt && seg2Pt ) {\n\n\t\t\t\t\t\tif ( ( inSeg1Pt1.x !== inSeg2Pt1.x ) ||\n\t\t\t\t\t\t\t ( inSeg1Pt1.y !== inSeg2Pt1.y ) )\t\treturn [];\t// they are distinct  points\n\t\t\t\t\t\treturn [ inSeg1Pt1 ];                 \t\t\t\t\t\t// they are the same point\n\n\t\t\t\t\t}\n\t\t\t\t\t// segment#1  is a single point\n\t\t\t\t\tif ( seg1Pt ) {\n\n\t\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg2Pt1, inSeg2Pt2, inSeg1Pt1 ) )\t\treturn [];\t\t// but not in segment#2\n\t\t\t\t\t\treturn [ inSeg1Pt1 ];\n\n\t\t\t\t\t}\n\t\t\t\t\t// segment#2  is a single point\n\t\t\t\t\tif ( seg2Pt ) {\n\n\t\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1 ) )\t\treturn [];\t\t// but not in segment#1\n\t\t\t\t\t\treturn [ inSeg2Pt1 ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// they are collinear segments, which might overlap\n\t\t\t\t\tvar seg1min, seg1max, seg1minVal, seg1maxVal;\n\t\t\t\t\tvar seg2min, seg2max, seg2minVal, seg2maxVal;\n\t\t\t\t\tif ( seg1dx !== 0 ) {\n\n\t\t\t\t\t\t// the segments are NOT on a vertical line\n\t\t\t\t\t\tif ( inSeg1Pt1.x < inSeg1Pt2.x ) {\n\n\t\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.x;\n\t\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.x;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.x;\n\t\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.x;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( inSeg2Pt1.x < inSeg2Pt2.x ) {\n\n\t\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.x;\n\t\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.x;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.x;\n\t\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.x;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// the segments are on a vertical line\n\t\t\t\t\t\tif ( inSeg1Pt1.y < inSeg1Pt2.y ) {\n\n\t\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.y;\n\t\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.y;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.y;\n\t\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.y;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( inSeg2Pt1.y < inSeg2Pt2.y ) {\n\n\t\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.y;\n\t\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.y;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.y;\n\t\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.y;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( seg1minVal <= seg2minVal ) {\n\n\t\t\t\t\t\tif ( seg1maxVal <  seg2minVal )\treturn [];\n\t\t\t\t\t\tif ( seg1maxVal === seg2minVal )\t{\n\n\t\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\n\t\t\t\t\t\t\treturn [ seg2min ];\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg2min, seg1max ];\n\t\t\t\t\t\treturn\t[ seg2min, seg2max ];\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( seg1minVal >  seg2maxVal )\treturn [];\n\t\t\t\t\t\tif ( seg1minVal === seg2maxVal )\t{\n\n\t\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\n\t\t\t\t\t\t\treturn [ seg1min ];\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg1min, seg1max ];\n\t\t\t\t\t\treturn\t[ seg1min, seg2max ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction isPointInsideAngle( inVertex, inLegFromPt, inLegToPt, inOtherPt ) {\n\n\t\t\t\t// The order of legs is important\n\n\t\t\t\t// translation of all points, so that Vertex is at (0,0)\n\t\t\t\tvar legFromPtX\t= inLegFromPt.x - inVertex.x,  legFromPtY\t= inLegFromPt.y - inVertex.y;\n\t\t\t\tvar legToPtX\t= inLegToPt.x\t- inVertex.x,  legToPtY\t\t= inLegToPt.y\t- inVertex.y;\n\t\t\t\tvar otherPtX\t= inOtherPt.x\t- inVertex.x,  otherPtY\t\t= inOtherPt.y\t- inVertex.y;\n\n\t\t\t\t// main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\n\t\t\t\tvar from2toAngle\t= legFromPtX * legToPtY - legFromPtY * legToPtX;\n\t\t\t\tvar from2otherAngle\t= legFromPtX * otherPtY - legFromPtY * otherPtX;\n\n\t\t\t\tif ( Math.abs( from2toAngle ) > Number.EPSILON ) {\n\n\t\t\t\t\t// angle != 180 deg.\n\n\t\t\t\t\tvar other2toAngle\t\t= otherPtX * legToPtY - otherPtY * legToPtX;\n\t\t\t\t\t// console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\n\n\t\t\t\t\tif ( from2toAngle > 0 ) {\n\n\t\t\t\t\t\t// main angle < 180 deg.\n\t\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) && ( other2toAngle >= 0 ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// main angle > 180 deg.\n\t\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) || ( other2toAngle >= 0 ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// angle == 180 deg.\n\t\t\t\t\t// console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\n\t\t\t\t\treturn\t( from2otherAngle > 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tfunction removeHoles( contour, holes ) {\n\n\t\t\t\tvar shape = contour.concat(); // work on this shape\n\t\t\t\tvar hole;\n\n\t\t\t\tfunction isCutLineInsideAngles( inShapeIdx, inHoleIdx ) {\n\n\t\t\t\t\t// Check if hole point lies within angle around shape point\n\t\t\t\t\tvar lastShapeIdx = shape.length - 1;\n\n\t\t\t\t\tvar prevShapeIdx = inShapeIdx - 1;\n\t\t\t\t\tif ( prevShapeIdx < 0 )\t\t\tprevShapeIdx = lastShapeIdx;\n\n\t\t\t\t\tvar nextShapeIdx = inShapeIdx + 1;\n\t\t\t\t\tif ( nextShapeIdx > lastShapeIdx )\tnextShapeIdx = 0;\n\n\t\t\t\t\tvar insideAngle = isPointInsideAngle( shape[ inShapeIdx ], shape[ prevShapeIdx ], shape[ nextShapeIdx ], hole[ inHoleIdx ] );\n\t\t\t\t\tif ( ! insideAngle ) {\n\n\t\t\t\t\t\t// console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\n\t\t\t\t\t\treturn\tfalse;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if shape point lies within angle around hole point\n\t\t\t\t\tvar lastHoleIdx = hole.length - 1;\n\n\t\t\t\t\tvar prevHoleIdx = inHoleIdx - 1;\n\t\t\t\t\tif ( prevHoleIdx < 0 )\t\t\tprevHoleIdx = lastHoleIdx;\n\n\t\t\t\t\tvar nextHoleIdx = inHoleIdx + 1;\n\t\t\t\t\tif ( nextHoleIdx > lastHoleIdx )\tnextHoleIdx = 0;\n\n\t\t\t\t\tinsideAngle = isPointInsideAngle( hole[ inHoleIdx ], hole[ prevHoleIdx ], hole[ nextHoleIdx ], shape[ inShapeIdx ] );\n\t\t\t\t\tif ( ! insideAngle ) {\n\n\t\t\t\t\t\t// console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\n\t\t\t\t\t\treturn\tfalse;\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn\ttrue;\n\n\t\t\t\t}\n\n\t\t\t\tfunction intersectsShapeEdge( inShapePt, inHolePt ) {\n\n\t\t\t\t\t// checks for intersections with shape edges\n\t\t\t\t\tvar sIdx, nextIdx, intersection;\n\t\t\t\t\tfor ( sIdx = 0; sIdx < shape.length; sIdx ++ ) {\n\n\t\t\t\t\t\tnextIdx = sIdx + 1; nextIdx %= shape.length;\n\t\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, shape[ sIdx ], shape[ nextIdx ], true );\n\t\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn\tfalse;\n\n\t\t\t\t}\n\n\t\t\t\tvar indepHoles = [];\n\n\t\t\t\tfunction intersectsHoleEdge( inShapePt, inHolePt ) {\n\n\t\t\t\t\t// checks for intersections with hole edges\n\t\t\t\t\tvar ihIdx, chkHole,\n\t\t\t\t\t\thIdx, nextIdx, intersection;\n\t\t\t\t\tfor ( ihIdx = 0; ihIdx < indepHoles.length; ihIdx ++ ) {\n\n\t\t\t\t\t\tchkHole = holes[ indepHoles[ ihIdx ]];\n\t\t\t\t\t\tfor ( hIdx = 0; hIdx < chkHole.length; hIdx ++ ) {\n\n\t\t\t\t\t\t\tnextIdx = hIdx + 1; nextIdx %= chkHole.length;\n\t\t\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, chkHole[ hIdx ], chkHole[ nextIdx ], true );\n\t\t\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\treturn\tfalse;\n\n\t\t\t\t}\n\n\t\t\t\tvar holeIndex, shapeIndex,\n\t\t\t\t\tshapePt, holePt,\n\t\t\t\t\tholeIdx, cutKey, failedCuts = [],\n\t\t\t\t\ttmpShape1, tmpShape2,\n\t\t\t\t\ttmpHole1, tmpHole2;\n\n\t\t\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tindepHoles.push( h );\n\n\t\t\t\t}\n\n\t\t\t\tvar minShapeIndex = 0;\n\t\t\t\tvar counter = indepHoles.length * 2;\n\t\t\t\twhile ( indepHoles.length > 0 ) {\n\n\t\t\t\t\tcounter --;\n\t\t\t\t\tif ( counter < 0 ) {\n\n\t\t\t\t\t\tconsole.log( \"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\" );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// search for shape-vertex and hole-vertex,\n\t\t\t\t\t// which can be connected without intersections\n\t\t\t\t\tfor ( shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex ++ ) {\n\n\t\t\t\t\t\tshapePt = shape[ shapeIndex ];\n\t\t\t\t\t\tholeIndex\t= - 1;\n\n\t\t\t\t\t\t// search for hole which can be reached without intersections\n\t\t\t\t\t\tfor ( var h = 0; h < indepHoles.length; h ++ ) {\n\n\t\t\t\t\t\t\tholeIdx = indepHoles[ h ];\n\n\t\t\t\t\t\t\t// prevent multiple checks\n\t\t\t\t\t\t\tcutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\n\t\t\t\t\t\t\tif ( failedCuts[ cutKey ] !== undefined )\t\t\tcontinue;\n\n\t\t\t\t\t\t\thole = holes[ holeIdx ];\n\t\t\t\t\t\t\tfor ( var h2 = 0; h2 < hole.length; h2 ++ ) {\n\n\t\t\t\t\t\t\t\tholePt = hole[ h2 ];\n\t\t\t\t\t\t\t\tif ( ! isCutLineInsideAngles( shapeIndex, h2 ) )\t\tcontinue;\n\t\t\t\t\t\t\t\tif ( intersectsShapeEdge( shapePt, holePt ) )\t\tcontinue;\n\t\t\t\t\t\t\t\tif ( intersectsHoleEdge( shapePt, holePt ) )\t\tcontinue;\n\n\t\t\t\t\t\t\t\tholeIndex = h2;\n\t\t\t\t\t\t\t\tindepHoles.splice( h, 1 );\n\n\t\t\t\t\t\t\t\ttmpShape1 = shape.slice( 0, shapeIndex + 1 );\n\t\t\t\t\t\t\t\ttmpShape2 = shape.slice( shapeIndex );\n\t\t\t\t\t\t\t\ttmpHole1 = hole.slice( holeIndex );\n\t\t\t\t\t\t\t\ttmpHole2 = hole.slice( 0, holeIndex + 1 );\n\n\t\t\t\t\t\t\t\tshape = tmpShape1.concat( tmpHole1 ).concat( tmpHole2 ).concat( tmpShape2 );\n\n\t\t\t\t\t\t\t\tminShapeIndex = shapeIndex;\n\n\t\t\t\t\t\t\t\t// Debug only, to show the selected cuts\n\t\t\t\t\t\t\t\t// glob_CutLines.push( [ shapePt, holePt ] );\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\n\n\t\t\t\t\t\t\tfailedCuts[ cutKey ] = true;\t\t\t// remember failure\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn shape; \t\t\t/* shape with no holes */\n\n\t\t\t}\n\n\n\t\t\tvar i, il, f, face,\n\t\t\t\tkey, index,\n\t\t\t\tallPointsMap = {};\n\n\t\t\t// To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\n\n\t\t\tvar allpoints = contour.concat();\n\n\t\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tArray.prototype.push.apply( allpoints, holes[ h ] );\n\n\t\t\t}\n\n\t\t\t//console.log( \"allpoints\",allpoints, allpoints.length );\n\n\t\t\t// prepare all points map\n\n\t\t\tfor ( i = 0, il = allpoints.length; i < il; i ++ ) {\n\n\t\t\t\tkey = allpoints[ i ].x + \":\" + allpoints[ i ].y;\n\n\t\t\t\tif ( allPointsMap[ key ] !== undefined ) {\n\n\t\t\t\t\tconsole.warn( \"THREE.ShapeUtils: Duplicate point\", key, i );\n\n\t\t\t\t}\n\n\t\t\t\tallPointsMap[ key ] = i;\n\n\t\t\t}\n\n\t\t\t// remove holes by cutting paths to holes and adding them to the shape\n\t\t\tvar shapeWithoutHoles = removeHoles( contour, holes );\n\n\t\t\tvar triangles = ShapeUtils.triangulate( shapeWithoutHoles, false ); // True returns indices for points of spooled shape\n\t\t\t//console.log( \"triangles\",triangles, triangles.length );\n\n\t\t\t// check all face vertices against all points map\n\n\t\t\tfor ( i = 0, il = triangles.length; i < il; i ++ ) {\n\n\t\t\t\tface = triangles[ i ];\n\n\t\t\t\tfor ( f = 0; f < 3; f ++ ) {\n\n\t\t\t\t\tkey = face[ f ].x + \":\" + face[ f ].y;\n\n\t\t\t\t\tindex = allPointsMap[ key ];\n\n\t\t\t\t\tif ( index !== undefined ) {\n\n\t\t\t\t\t\tface[ f ] = index;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn triangles.concat();\n\n\t\t},\n\n\t\tisClockWise: function ( pts ) {\n\n\t\t\treturn ShapeUtils.area( pts ) < 0;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t *\n\t * Creates extruded geometry from a path shape.\n\t *\n\t * parameters = {\n\t *\n\t *  curveSegments: <int>, // number of points on the curves\n\t *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\n\t *  amount: <int>, // Depth to extrude the shape\n\t *\n\t *  bevelEnabled: <bool>, // turn on bevel\n\t *  bevelThickness: <float>, // how deep into the original shape bevel goes\n\t *  bevelSize: <float>, // how far from shape outline is bevel\n\t *  bevelSegments: <int>, // number of bevel layers\n\t *\n\t *  extrudePath: <THREE.Curve> // curve to extrude shape along\n\t *  frames: <Object> // containing arrays of tangents, normals, binormals\n\t *\n\t *  uvGenerator: <Object> // object that provides UV generator functions\n\t *\n\t * }\n\t **/\n\n\tfunction ExtrudeGeometry( shapes, options ) {\n\n\t\tif ( typeof( shapes ) === \"undefined\" ) {\n\n\t\t\tshapes = [];\n\t\t\treturn;\n\n\t\t}\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'ExtrudeGeometry';\n\n\t\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\n\n\t\tthis.addShapeList( shapes, options );\n\n\t\tthis.computeFaceNormals();\n\n\t\t// can't really use automatic vertex normals\n\t\t// as then front and back sides get smoothed too\n\t\t// should do separate smoothing just for sides\n\n\t\t//this.computeVertexNormals();\n\n\t\t//console.log( \"took\", ( Date.now() - startTime ) );\n\n\t}\n\n\tExtrudeGeometry.prototype = Object.create( Geometry.prototype );\n\tExtrudeGeometry.prototype.constructor = ExtrudeGeometry;\n\n\tExtrudeGeometry.prototype.addShapeList = function ( shapes, options ) {\n\n\t\tvar sl = shapes.length;\n\n\t\tfor ( var s = 0; s < sl; s ++ ) {\n\n\t\t\tvar shape = shapes[ s ];\n\t\t\tthis.addShape( shape, options );\n\n\t\t}\n\n\t};\n\n\tExtrudeGeometry.prototype.addShape = function ( shape, options ) {\n\n\t\tvar amount = options.amount !== undefined ? options.amount : 100;\n\n\t\tvar bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\n\t\tvar bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\n\t\tvar bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\n\n\t\tvar bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\n\n\t\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\n\n\t\tvar steps = options.steps !== undefined ? options.steps : 1;\n\n\t\tvar extrudePath = options.extrudePath;\n\t\tvar extrudePts, extrudeByPath = false;\n\n\t\t// Use default WorldUVGenerator if no UV generators are specified.\n\t\tvar uvgen = options.UVGenerator !== undefined ? options.UVGenerator : ExtrudeGeometry.WorldUVGenerator;\n\n\t\tvar splineTube, binormal, normal, position2;\n\t\tif ( extrudePath ) {\n\n\t\t\textrudePts = extrudePath.getSpacedPoints( steps );\n\n\t\t\textrudeByPath = true;\n\t\t\tbevelEnabled = false; // bevels not supported for path extrusion\n\n\t\t\t// SETUP TNB variables\n\n\t\t\t// TODO1 - have a .isClosed in spline?\n\n\t\t\tsplineTube = options.frames !== undefined ? options.frames : extrudePath.computeFrenetFrames( steps, false );\n\n\t\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\n\n\t\t\tbinormal = new Vector3();\n\t\t\tnormal = new Vector3();\n\t\t\tposition2 = new Vector3();\n\n\t\t}\n\n\t\t// Safeguards if bevels are not enabled\n\n\t\tif ( ! bevelEnabled ) {\n\n\t\t\tbevelSegments = 0;\n\t\t\tbevelThickness = 0;\n\t\t\tbevelSize = 0;\n\n\t\t}\n\n\t\t// Variables initialization\n\n\t\tvar ahole, h, hl; // looping of holes\n\t\tvar scope = this;\n\n\t\tvar shapesOffset = this.vertices.length;\n\n\t\tvar shapePoints = shape.extractPoints( curveSegments );\n\n\t\tvar vertices = shapePoints.shape;\n\t\tvar holes = shapePoints.holes;\n\n\t\tvar reverse = ! ShapeUtils.isClockWise( vertices );\n\n\t\tif ( reverse ) {\n\n\t\t\tvertices = vertices.reverse();\n\n\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\n\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tahole = holes[ h ];\n\n\t\t\t\tif ( ShapeUtils.isClockWise( ahole ) ) {\n\n\t\t\t\t\tholes[ h ] = ahole.reverse();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\n\n\t\t}\n\n\n\t\tvar faces = ShapeUtils.triangulateShape( vertices, holes );\n\n\t\t/* Vertices */\n\n\t\tvar contour = vertices; // vertices has all points but contour has only points of circumference\n\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\tahole = holes[ h ];\n\n\t\t\tvertices = vertices.concat( ahole );\n\n\t\t}\n\n\n\t\tfunction scalePt2( pt, vec, size ) {\n\n\t\t\tif ( ! vec ) console.error( \"THREE.ExtrudeGeometry: vec does not exist\" );\n\n\t\t\treturn vec.clone().multiplyScalar( size ).add( pt );\n\n\t\t}\n\n\t\tvar b, bs, t, z,\n\t\t\tvert, vlen = vertices.length,\n\t\t\tface, flen = faces.length;\n\n\n\t\t// Find directions for point movement\n\n\n\t\tfunction getBevelVec( inPt, inPrev, inNext ) {\n\n\t\t\t// computes for inPt the corresponding point inPt' on a new contour\n\t\t\t//   shifted by 1 unit (length of normalized vector) to the left\n\t\t\t// if we walk along contour clockwise, this new contour is outside the old one\n\t\t\t//\n\t\t\t// inPt' is the intersection of the two lines parallel to the two\n\t\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\n\n\t\t\tvar v_trans_x, v_trans_y, shrink_by = 1;\t\t// resulting translation vector for inPt\n\n\t\t\t// good reading for geometry algorithms (here: line-line intersection)\n\t\t\t// http://geomalgorithms.com/a05-_intersect-1.html\n\n\t\t\tvar v_prev_x = inPt.x - inPrev.x, v_prev_y = inPt.y - inPrev.y;\n\t\t\tvar v_next_x = inNext.x - inPt.x, v_next_y = inNext.y - inPt.y;\n\n\t\t\tvar v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\n\n\t\t\t// check for collinear edges\n\t\t\tvar collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\n\n\t\t\t\t// not collinear\n\n\t\t\t\t// length of vectors for normalizing\n\n\t\t\t\tvar v_prev_len = Math.sqrt( v_prev_lensq );\n\t\t\t\tvar v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\n\n\t\t\t\t// shift adjacent points by unit vectors to the left\n\n\t\t\t\tvar ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\n\t\t\t\tvar ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\n\n\t\t\t\tvar ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\n\t\t\t\tvar ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\n\n\t\t\t\t// scaling factor for v_prev to intersection point\n\n\t\t\t\tvar sf = (  ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\n\t\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x    ) /\n\t\t\t\t\t\t  ( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\t// vector from inPt to intersection point\n\n\t\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\n\t\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\n\n\t\t\t\t// Don't normalize!, otherwise sharp corners become ugly\n\t\t\t\t//  but prevent crazy spikes\n\t\t\t\tvar v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\n\t\t\t\tif ( v_trans_lensq <= 2 ) {\n\n\t\t\t\t\treturn\tnew Vector2( v_trans_x, v_trans_y );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// handle special case of collinear edges\n\n\t\t\t\tvar direction_eq = false;\t\t// assumes: opposite\n\t\t\t\tif ( v_prev_x > Number.EPSILON ) {\n\n\t\t\t\t\tif ( v_next_x > Number.EPSILON ) {\n\n\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\n\n\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( direction_eq ) {\n\n\t\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\n\t\t\t\t\tv_trans_x = - v_prev_y;\n\t\t\t\t\tv_trans_y =  v_prev_x;\n\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\n\t\t\t\t\tv_trans_x = v_prev_x;\n\t\t\t\t\tv_trans_y = v_prev_y;\n\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn\tnew Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\n\n\t\t}\n\n\n\t\tvar contourMovements = [];\n\n\t\tfor ( var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\tif ( j === il ) j = 0;\n\t\t\tif ( k === il ) k = 0;\n\n\t\t\t//  (j)---(i)---(k)\n\t\t\t// console.log('i,j,k', i, j , k)\n\n\t\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\n\n\t\t}\n\n\t\tvar holesMovements = [], oneHoleMovements, verticesMovements = contourMovements.concat();\n\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\tahole = holes[ h ];\n\n\t\t\toneHoleMovements = [];\n\n\t\t\tfor ( i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\n\n\t\t\t}\n\n\t\t\tholesMovements.push( oneHoleMovements );\n\t\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\n\n\t\t}\n\n\n\t\t// Loop bevelSegments, 1 for the front, 1 for the back\n\n\t\tfor ( b = 0; b < bevelSegments; b ++ ) {\n\n\t\t\t//for ( b = bevelSegments; b > 0; b -- ) {\n\n\t\t\tt = b / bevelSegments;\n\t\t\tz = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\tbs = bevelSize * Math.sin( t * Math.PI / 2 );\n\n\t\t\t// contract shape\n\n\t\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\n\t\t\t\tv( vert.x, vert.y,  - z );\n\n\t\t\t}\n\n\t\t\t// expand holes\n\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tahole = holes[ h ];\n\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\tv( vert.x, vert.y,  - z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tbs = bevelSize;\n\n\t\t// Back facing vertices\n\n\t\tfor ( i = 0; i < vlen; i ++ ) {\n\n\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\tv( vert.x, vert.y, 0 );\n\n\t\t\t} else {\n\n\t\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\n\n\t\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\n\t\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\n\n\t\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\n\n\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Add stepped vertices...\n\t\t// Including front facing vertices\n\n\t\tvar s;\n\n\t\tfor ( s = 1; s <= steps; s ++ ) {\n\n\t\t\tfor ( i = 0; i < vlen; i ++ ) {\n\n\t\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\tv( vert.x, vert.y, amount / steps * s );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\n\n\t\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\n\t\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\n\n\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\t\t// Add bevel segments planes\n\n\t\t//for ( b = 1; b <= bevelSegments; b ++ ) {\n\t\tfor ( b = bevelSegments - 1; b >= 0; b -- ) {\n\n\t\t\tt = b / bevelSegments;\n\t\t\tz = bevelThickness * Math.cos ( t * Math.PI / 2 );\n\t\t\tbs = bevelSize * Math.sin( t * Math.PI / 2 );\n\n\t\t\t// contract shape\n\n\t\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\t\t\t\tv( vert.x, vert.y,  amount + z );\n\n\t\t\t}\n\n\t\t\t// expand holes\n\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tahole = holes[ h ];\n\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\tv( vert.x, vert.y,  amount + z );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t/* Faces */\n\n\t\t// Top and bottom faces\n\n\t\tbuildLidFaces();\n\n\t\t// Sides faces\n\n\t\tbuildSideFaces();\n\n\n\t\t/////  Internal functions\n\n\t\tfunction buildLidFaces() {\n\n\t\t\tif ( bevelEnabled ) {\n\n\t\t\t\tvar layer = 0; // steps + 1\n\t\t\t\tvar offset = vlen * layer;\n\n\t\t\t\t// Bottom faces\n\n\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\tface = faces[ i ];\n\t\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\n\n\t\t\t\t}\n\n\t\t\t\tlayer = steps + bevelSegments * 2;\n\t\t\t\toffset = vlen * layer;\n\n\t\t\t\t// Top faces\n\n\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\tface = faces[ i ];\n\t\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// Bottom faces\n\n\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\tface = faces[ i ];\n\t\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\n\n\t\t\t\t}\n\n\t\t\t\t// Top faces\n\n\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\tface = faces[ i ];\n\t\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Create faces for the z-sides of the shape\n\n\t\tfunction buildSideFaces() {\n\n\t\t\tvar layeroffset = 0;\n\t\t\tsidewalls( contour, layeroffset );\n\t\t\tlayeroffset += contour.length;\n\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tahole = holes[ h ];\n\t\t\t\tsidewalls( ahole, layeroffset );\n\n\t\t\t\t//, true\n\t\t\t\tlayeroffset += ahole.length;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction sidewalls( contour, layeroffset ) {\n\n\t\t\tvar j, k;\n\t\t\ti = contour.length;\n\n\t\t\twhile ( -- i >= 0 ) {\n\n\t\t\t\tj = i;\n\t\t\t\tk = i - 1;\n\t\t\t\tif ( k < 0 ) k = contour.length - 1;\n\n\t\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\n\n\t\t\t\tvar s = 0, sl = steps  + bevelSegments * 2;\n\n\t\t\t\tfor ( s = 0; s < sl; s ++ ) {\n\n\t\t\t\t\tvar slen1 = vlen * s;\n\t\t\t\t\tvar slen2 = vlen * ( s + 1 );\n\n\t\t\t\t\tvar a = layeroffset + j + slen1,\n\t\t\t\t\t\tb = layeroffset + k + slen1,\n\t\t\t\t\t\tc = layeroffset + k + slen2,\n\t\t\t\t\t\td = layeroffset + j + slen2;\n\n\t\t\t\t\tf4( a, b, c, d, contour, s, sl, j, k );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\t\tfunction v( x, y, z ) {\n\n\t\t\tscope.vertices.push( new Vector3( x, y, z ) );\n\n\t\t}\n\n\t\tfunction f3( a, b, c ) {\n\n\t\t\ta += shapesOffset;\n\t\t\tb += shapesOffset;\n\t\t\tc += shapesOffset;\n\n\t\t\tscope.faces.push( new Face3( a, b, c, null, null, 0 ) );\n\n\t\t\tvar uvs = uvgen.generateTopUV( scope, a, b, c );\n\n\t\t\tscope.faceVertexUvs[ 0 ].push( uvs );\n\n\t\t}\n\n\t\tfunction f4( a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2 ) {\n\n\t\t\ta += shapesOffset;\n\t\t\tb += shapesOffset;\n\t\t\tc += shapesOffset;\n\t\t\td += shapesOffset;\n\n\t\t\tscope.faces.push( new Face3( a, b, d, null, null, 1 ) );\n\t\t\tscope.faces.push( new Face3( b, c, d, null, null, 1 ) );\n\n\t\t\tvar uvs = uvgen.generateSideWallUV( scope, a, b, c, d );\n\n\t\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 0 ], uvs[ 1 ], uvs[ 3 ] ] );\n\t\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 1 ], uvs[ 2 ], uvs[ 3 ] ] );\n\n\t\t}\n\n\t};\n\n\tExtrudeGeometry.WorldUVGenerator = {\n\n\t\tgenerateTopUV: function ( geometry, indexA, indexB, indexC ) {\n\n\t\t\tvar vertices = geometry.vertices;\n\n\t\t\tvar a = vertices[ indexA ];\n\t\t\tvar b = vertices[ indexB ];\n\t\t\tvar c = vertices[ indexC ];\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a.x, a.y ),\n\t\t\t\tnew Vector2( b.x, b.y ),\n\t\t\t\tnew Vector2( c.x, c.y )\n\t\t\t];\n\n\t\t},\n\n\t\tgenerateSideWallUV: function ( geometry, indexA, indexB, indexC, indexD ) {\n\n\t\t\tvar vertices = geometry.vertices;\n\n\t\t\tvar a = vertices[ indexA ];\n\t\t\tvar b = vertices[ indexB ];\n\t\t\tvar c = vertices[ indexC ];\n\t\t\tvar d = vertices[ indexD ];\n\n\t\t\tif ( Math.abs( a.y - b.y ) < 0.01 ) {\n\n\t\t\t\treturn [\n\t\t\t\t\tnew Vector2( a.x, 1 - a.z ),\n\t\t\t\t\tnew Vector2( b.x, 1 - b.z ),\n\t\t\t\t\tnew Vector2( c.x, 1 - c.z ),\n\t\t\t\t\tnew Vector2( d.x, 1 - d.z )\n\t\t\t\t];\n\n\t\t\t} else {\n\n\t\t\t\treturn [\n\t\t\t\t\tnew Vector2( a.y, 1 - a.z ),\n\t\t\t\t\tnew Vector2( b.y, 1 - b.z ),\n\t\t\t\t\tnew Vector2( c.y, 1 - c.z ),\n\t\t\t\t\tnew Vector2( d.y, 1 - d.z )\n\t\t\t\t];\n\n\t\t\t}\n\n\t\t}\n\t};\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * Text = 3D Text\n\t *\n\t * parameters = {\n\t *  font: <THREE.Font>, // font\n\t *\n\t *  size: <float>, // size of the text\n\t *  height: <float>, // thickness to extrude text\n\t *  curveSegments: <int>, // number of points on the curves\n\t *\n\t *  bevelEnabled: <bool>, // turn on bevel\n\t *  bevelThickness: <float>, // how deep into text bevel goes\n\t *  bevelSize: <float> // how far from text outline is bevel\n\t * }\n\t */\n\n\tfunction TextGeometry( text, parameters ) {\n\n\t\tparameters = parameters || {};\n\n\t\tvar font = parameters.font;\n\n\t\tif ( (font && font.isFont) === false ) {\n\n\t\t\tconsole.error( 'THREE.TextGeometry: font parameter is not an instance of THREE.Font.' );\n\t\t\treturn new Geometry();\n\n\t\t}\n\n\t\tvar shapes = font.generateShapes( text, parameters.size, parameters.curveSegments );\n\n\t\t// translate parameters to ExtrudeGeometry API\n\n\t\tparameters.amount = parameters.height !== undefined ? parameters.height : 50;\n\n\t\t// defaults\n\n\t\tif ( parameters.bevelThickness === undefined ) parameters.bevelThickness = 10;\n\t\tif ( parameters.bevelSize === undefined ) parameters.bevelSize = 8;\n\t\tif ( parameters.bevelEnabled === undefined ) parameters.bevelEnabled = false;\n\n\t\tExtrudeGeometry.call( this, shapes, parameters );\n\n\t\tthis.type = 'TextGeometry';\n\n\t}\n\n\tTextGeometry.prototype = Object.create( ExtrudeGeometry.prototype );\n\tTextGeometry.prototype.constructor = TextGeometry;\n\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t * based on THREE.SphereGeometry\n\t */\n\n\tfunction SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'SphereBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tradius = radius || 50;\n\n\t\twidthSegments = Math.max( 3, Math.floor( widthSegments ) || 8 );\n\t\theightSegments = Math.max( 2, Math.floor( heightSegments ) || 6 );\n\n\t\tphiStart = phiStart !== undefined ? phiStart : 0;\n\t\tphiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\n\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\n\n\t\tvar thetaEnd = thetaStart + thetaLength;\n\n\t\tvar vertexCount = ( ( widthSegments + 1 ) * ( heightSegments + 1 ) );\n\n\t\tvar positions = new BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\t\tvar normals = new BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\t\tvar uvs = new BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\n\n\t\tvar index = 0, vertices = [], normal = new Vector3();\n\n\t\tfor ( var y = 0; y <= heightSegments; y ++ ) {\n\n\t\t\tvar verticesRow = [];\n\n\t\t\tvar v = y / heightSegments;\n\n\t\t\tfor ( var x = 0; x <= widthSegments; x ++ ) {\n\n\t\t\t\tvar u = x / widthSegments;\n\n\t\t\t\tvar px = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\t\t\t\tvar py = radius * Math.cos( thetaStart + v * thetaLength );\n\t\t\t\tvar pz = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\n\t\t\t\tnormal.set( px, py, pz ).normalize();\n\n\t\t\t\tpositions.setXYZ( index, px, py, pz );\n\t\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\n\t\t\t\tuvs.setXY( index, u, 1 - v );\n\n\t\t\t\tverticesRow.push( index );\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\tvertices.push( verticesRow );\n\n\t\t}\n\n\t\tvar indices = [];\n\n\t\tfor ( var y = 0; y < heightSegments; y ++ ) {\n\n\t\t\tfor ( var x = 0; x < widthSegments; x ++ ) {\n\n\t\t\t\tvar v1 = vertices[ y ][ x + 1 ];\n\t\t\t\tvar v2 = vertices[ y ][ x ];\n\t\t\t\tvar v3 = vertices[ y + 1 ][ x ];\n\t\t\t\tvar v4 = vertices[ y + 1 ][ x + 1 ];\n\n\t\t\t\tif ( y !== 0 || thetaStart > 0 ) indices.push( v1, v2, v4 );\n\t\t\t\tif ( y !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( v2, v3, v4 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setIndex( new ( positions.count > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 ) );\n\t\tthis.addAttribute( 'position', positions );\n\t\tthis.addAttribute( 'normal', normals );\n\t\tthis.addAttribute( 'uv', uvs );\n\n\t\tthis.boundingSphere = new Sphere( new Vector3(), radius );\n\n\t}\n\n\tSphereBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tSphereBufferGeometry.prototype.constructor = SphereBufferGeometry;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction SphereGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'SphereGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tthis.fromBufferGeometry( new SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) );\n\n\t}\n\n\tSphereGeometry.prototype = Object.create( Geometry.prototype );\n\tSphereGeometry.prototype.constructor = SphereGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction RingBufferGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'RingBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tinnerRadius: innerRadius,\n\t\t\touterRadius: outerRadius,\n\t\t\tthetaSegments: thetaSegments,\n\t\t\tphiSegments: phiSegments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tinnerRadius = innerRadius || 20;\n\t\touterRadius = outerRadius || 50;\n\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\n\n\t\tthetaSegments = thetaSegments !== undefined ? Math.max( 3, thetaSegments ) : 8;\n\t\tphiSegments = phiSegments !== undefined ? Math.max( 1, phiSegments ) : 1;\n\n\t\t// these are used to calculate buffer length\n\t\tvar vertexCount = ( thetaSegments + 1 ) * ( phiSegments + 1 );\n\t\tvar indexCount = thetaSegments * phiSegments * 2 * 3;\n\n\t\t// buffers\n\t\tvar indices = new BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ) , 1 );\n\t\tvar vertices = new BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\t\tvar normals = new BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\t\tvar uvs = new BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\n\n\t\t// some helper variables\n\t\tvar index = 0, indexOffset = 0, segment;\n\t\tvar radius = innerRadius;\n\t\tvar radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\n\t\tvar vertex = new Vector3();\n\t\tvar uv = new Vector2();\n\t\tvar j, i;\n\n\t\t// generate vertices, normals and uvs\n\n\t\t// values are generate from the inside of the ring to the outside\n\n\t\tfor ( j = 0; j <= phiSegments; j ++ ) {\n\n\t\t\tfor ( i = 0; i <= thetaSegments; i ++ ) {\n\n\t\t\t\tsegment = thetaStart + i / thetaSegments * thetaLength;\n\n\t\t\t\t// vertex\n\t\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\t\tvertex.y = radius * Math.sin( segment );\n\t\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\t\t\t\tnormals.setXYZ( index, 0, 0, 1 );\n\n\t\t\t\t// uv\n\t\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\n\t\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\n\t\t\t\tuvs.setXY( index, uv.x, uv.y );\n\n\t\t\t\t// increase index\n\t\t\t\tindex++;\n\n\t\t\t}\n\n\t\t\t// increase the radius for next row of vertices\n\t\t\tradius += radiusStep;\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( j = 0; j < phiSegments; j ++ ) {\n\n\t\t\tvar thetaSegmentLevel = j * ( thetaSegments + 1 );\n\n\t\t\tfor ( i = 0; i < thetaSegments; i ++ ) {\n\n\t\t\t\tsegment = i + thetaSegmentLevel;\n\n\t\t\t\t// indices\n\t\t\t\tvar a = segment;\n\t\t\t\tvar b = segment + thetaSegments + 1;\n\t\t\t\tvar c = segment + thetaSegments + 2;\n\t\t\t\tvar d = segment + 1;\n\n\t\t\t\t// face one\n\t\t\t\tindices.setX( indexOffset, a ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, b ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, c ); indexOffset++;\n\n\t\t\t\t// face two\n\t\t\t\tindices.setX( indexOffset, a ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, c ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, d ); indexOffset++;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.addAttribute( 'position', vertices );\n\t\tthis.addAttribute( 'normal', normals );\n\t\tthis.addAttribute( 'uv', uvs );\n\n\t}\n\n\tRingBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tRingBufferGeometry.prototype.constructor = RingBufferGeometry;\n\n\t/**\n\t * @author Kaleb Murphy\n\t */\n\n\tfunction RingGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'RingGeometry';\n\n\t\tthis.parameters = {\n\t\t\tinnerRadius: innerRadius,\n\t\t\touterRadius: outerRadius,\n\t\t\tthetaSegments: thetaSegments,\n\t\t\tphiSegments: phiSegments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tthis.fromBufferGeometry( new RingBufferGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) );\n\n\t}\n\n\tRingGeometry.prototype = Object.create( Geometry.prototype );\n\tRingGeometry.prototype.constructor = RingGeometry;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\n\t */\n\n\tfunction PlaneGeometry( width, height, widthSegments, heightSegments ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'PlaneGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments\n\t\t};\n\n\t\tthis.fromBufferGeometry( new PlaneBufferGeometry( width, height, widthSegments, heightSegments ) );\n\n\t}\n\n\tPlaneGeometry.prototype = Object.create( Geometry.prototype );\n\tPlaneGeometry.prototype.constructor = PlaneGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\t // points - to create a closed torus, one must use a set of points\n\t //    like so: [ a, b, c, d, a ], see first is the same as last.\n\t // segments - the number of circumference segments to create\n\t // phiStart - the starting radian\n\t // phiLength - the radian (0 to 2PI) range of the lathed section\n\t //    2PI is a closed lathe, less than 2PI is a portion.\n\n\tfunction LatheBufferGeometry( points, segments, phiStart, phiLength ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'LatheBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpoints: points,\n\t\t\tsegments: segments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength\n\t\t};\n\n\t\tsegments = Math.floor( segments ) || 12;\n\t\tphiStart = phiStart || 0;\n\t\tphiLength = phiLength || Math.PI * 2;\n\n\t\t// clamp phiLength so it's in range of [ 0, 2PI ]\n\t\tphiLength = _Math.clamp( phiLength, 0, Math.PI * 2 );\n\n\t\t// these are used to calculate buffer length\n\t\tvar vertexCount = ( segments + 1 ) * points.length;\n\t\tvar indexCount = segments * points.length * 2 * 3;\n\n\t\t// buffers\n\t\tvar indices = new BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ) , 1 );\n\t\tvar vertices = new BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\t\tvar uvs = new BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\n\n\t\t// helper variables\n\t\tvar index = 0, indexOffset = 0, base;\n\t\tvar inverseSegments = 1.0 / segments;\n\t\tvar vertex = new Vector3();\n\t\tvar uv = new Vector2();\n\t\tvar i, j;\n\n\t\t// generate vertices and uvs\n\n\t\tfor ( i = 0; i <= segments; i ++ ) {\n\n\t\t\tvar phi = phiStart + i * inverseSegments * phiLength;\n\n\t\t\tvar sin = Math.sin( phi );\n\t\t\tvar cos = Math.cos( phi );\n\n\t\t\tfor ( j = 0; j <= ( points.length - 1 ); j ++ ) {\n\n\t\t\t\t// vertex\n\t\t\t\tvertex.x = points[ j ].x * sin;\n\t\t\t\tvertex.y = points[ j ].y;\n\t\t\t\tvertex.z = points[ j ].x * cos;\n\t\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// uv\n\t\t\t\tuv.x = i / segments;\n\t\t\t\tuv.y = j / ( points.length - 1 );\n\t\t\t\tuvs.setXY( index, uv.x, uv.y );\n\n\t\t\t\t// increase index\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( i = 0; i < segments; i ++ ) {\n\n\t\t\tfor ( j = 0; j < ( points.length - 1 ); j ++ ) {\n\n\t\t\t\tbase = j + i * points.length;\n\n\t\t\t\t// indices\n\t\t\t\tvar a = base;\n\t\t\t\tvar b = base + points.length;\n\t\t\t\tvar c = base + points.length + 1;\n\t\t\t\tvar d = base + 1;\n\n\t\t\t\t// face one\n\t\t\t\tindices.setX( indexOffset, a ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, b ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, d ); indexOffset++;\n\n\t\t\t\t// face two\n\t\t\t\tindices.setX( indexOffset, b ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, c ); indexOffset++;\n\t\t\t\tindices.setX( indexOffset, d ); indexOffset++;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.addAttribute( 'position', vertices );\n\t\tthis.addAttribute( 'uv', uvs );\n\n\t\t// generate normals\n\n\t\tthis.computeVertexNormals();\n\n\t\t// if the geometry is closed, we need to average the normals along the seam.\n\t\t// because the corresponding vertices are identical (but still have different UVs).\n\n\t\tif( phiLength === Math.PI * 2 ) {\n\n\t\t\tvar normals = this.attributes.normal.array;\n\t\t\tvar n1 = new Vector3();\n\t\t\tvar n2 = new Vector3();\n\t\t\tvar n = new Vector3();\n\n\t\t\t// this is the buffer offset for the last line of vertices\n\t\t\tbase = segments * points.length * 3;\n\n\t\t\tfor( i = 0, j = 0; i < points.length; i ++, j += 3 ) {\n\n\t\t\t\t// select the normal of the vertex in the first line\n\t\t\t\tn1.x = normals[ j + 0 ];\n\t\t\t\tn1.y = normals[ j + 1 ];\n\t\t\t\tn1.z = normals[ j + 2 ];\n\n\t\t\t\t// select the normal of the vertex in the last line\n\t\t\t\tn2.x = normals[ base + j + 0 ];\n\t\t\t\tn2.y = normals[ base + j + 1 ];\n\t\t\t\tn2.z = normals[ base + j + 2 ];\n\n\t\t\t\t// average normals\n\t\t\t\tn.addVectors( n1, n2 ).normalize();\n\n\t\t\t\t// assign the new values to both normals\n\t\t\t\tnormals[ j + 0 ] = normals[ base + j + 0 ] = n.x;\n\t\t\t\tnormals[ j + 1 ] = normals[ base + j + 1 ] = n.y;\n\t\t\t\tnormals[ j + 2 ] = normals[ base + j + 2 ] = n.z;\n\n\t\t\t} // next row\n\n\t\t}\n\n\t}\n\n\tLatheBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tLatheBufferGeometry.prototype.constructor = LatheBufferGeometry;\n\n\t/**\n\t * @author astrodud / http://astrodud.isgreat.org/\n\t * @author zz85 / https://github.com/zz85\n\t * @author bhouston / http://clara.io\n\t */\n\n\t// points - to create a closed torus, one must use a set of points\n\t//    like so: [ a, b, c, d, a ], see first is the same as last.\n\t// segments - the number of circumference segments to create\n\t// phiStart - the starting radian\n\t// phiLength - the radian (0 to 2PI) range of the lathed section\n\t//    2PI is a closed lathe, less than 2PI is a portion.\n\n\tfunction LatheGeometry( points, segments, phiStart, phiLength ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'LatheGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpoints: points,\n\t\t\tsegments: segments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength\n\t\t};\n\n\t\tthis.fromBufferGeometry( new LatheBufferGeometry( points, segments, phiStart, phiLength ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tLatheGeometry.prototype = Object.create( Geometry.prototype );\n\tLatheGeometry.prototype.constructor = LatheGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t *\n\t * Creates a one-sided polygonal geometry from one or more shapes.\n\t *\n\t **/\n\n\tfunction ShapeBufferGeometry( shapes, curveSegments ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'ShapeBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\tcurveSegments: curveSegments\n\t\t};\n\n\t\tcurveSegments = curveSegments || 12;\n\n\t\tvar vertices = [];\n\t\tvar normals = [];\n\t\tvar uvs = [];\n\t\tvar indices = [];\n\n\t\tvar groupStart = 0;\n\t\tvar groupCount = 0;\n\n\t\t// allow single and array values for \"shapes\" parameter\n\n\t\tif ( Array.isArray( shapes ) === false ) {\n\n\t\t\taddShape( shapes );\n\n\t\t} else {\n\n\t\t\tfor ( var i = 0; i < shapes.length; i++ ) {\n\n\t\t\t\taddShape( shapes[ i ] );\n\n\t\t\t\tthis.addGroup( groupStart, groupCount, i ); // enables MultiMaterial support\n\n\t\t\t\tgroupStart += groupCount;\n\t\t\t\tgroupCount = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( new ( indices.length > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 ) );\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\n\t\t// helper functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tvar i, l, shapeHole;\n\n\t\t\tvar indexOffset = vertices.length / 3;\n\t\t\tvar points = shape.extractPoints( curveSegments );\n\n\t\t\tvar shapeVertices = points.shape;\n\t\t\tvar shapeHoles = points.holes;\n\n\t\t\t// check direction of vertices\n\n\t\t\tif ( ShapeUtils.isClockWise( shapeVertices ) === false ) {\n\n\t\t\t\tshapeVertices = shapeVertices.reverse();\n\n\t\t\t\t// also check if holes are in the opposite direction\n\n\t\t\t\tfor ( i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\t\tshapeHole = shapeHoles[ i ];\n\n\t\t\t\t\tif ( ShapeUtils.isClockWise( shapeHole ) === true ) {\n\n\t\t\t\t\t\tshapeHoles[ i ] = shapeHole.reverse();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar faces = ShapeUtils.triangulateShape( shapeVertices, shapeHoles );\n\n\t\t\t// join vertices of inner and outer paths to a single array\n\n\t\t\tfor ( i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\tshapeHole = shapeHoles[ i ];\n\t\t\t\tshapeVertices = shapeVertices.concat( shapeHole );\n\n\t\t\t}\n\n\t\t\t// vertices, normals, uvs\n\n\t\t\tfor ( i = 0, l = shapeVertices.length; i < l; i ++ ) {\n\n\t\t\t\tvar vertex = shapeVertices[ i ];\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, 0 );\n\t\t\t\tnormals.push( 0, 0, 1 );\n\t\t\t\tuvs.push( vertex.x, vertex.y ); // world uvs\n\n\t\t\t}\n\n\t\t\t// incides\n\n\t\t\tfor ( i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\tvar face = faces[ i ];\n\n\t\t\t\tvar a = face[ 0 ] + indexOffset;\n\t\t\t\tvar b = face[ 1 ] + indexOffset;\n\t\t\t\tvar c = face[ 2 ] + indexOffset;\n\n\t\t\t\tindices.push( a, b, c );\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tShapeBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tShapeBufferGeometry.prototype.constructor = ShapeBufferGeometry;\n\n\t/**\n\t * @author jonobr1 / http://jonobr1.com\n\t *\n\t * Creates a one-sided polygonal geometry from a path shape.\n\t *\n\t **/\n\n\tfunction ShapeGeometry( shapes, curveSegments ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'ShapeGeometry';\n\n\t\tif ( typeof curveSegments === 'object' ) {\n\n\t\t\tconsole.warn( 'THREE.ShapeGeometry: Options parameter has been removed.' );\n\n\t\t\tcurveSegments = curveSegments.curveSegments;\n\n\t\t}\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\tcurveSegments: curveSegments\n\t\t};\n\n\t\tthis.fromBufferGeometry( new ShapeBufferGeometry( shapes, curveSegments ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tShapeGeometry.prototype = Object.create( Geometry.prototype );\n\tShapeGeometry.prototype.constructor = ShapeGeometry;\n\n\t/**\n\t * @author WestLangley / http://github.com/WestLangley\n\t */\n\n\tfunction EdgesGeometry( geometry, thresholdAngle ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthresholdAngle = ( thresholdAngle !== undefined ) ? thresholdAngle : 1;\n\n\t\tvar thresholdDot = Math.cos( _Math.DEG2RAD * thresholdAngle );\n\n\t\tvar edge = [ 0, 0 ], hash = {};\n\n\t\tfunction sortFunction( a, b ) {\n\n\t\t\treturn a - b;\n\n\t\t}\n\n\t\tvar keys = [ 'a', 'b', 'c' ];\n\n\t\tvar geometry2;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tgeometry2 = new Geometry();\n\t\t\tgeometry2.fromBufferGeometry( geometry );\n\n\t\t} else {\n\n\t\t\tgeometry2 = geometry.clone();\n\n\t\t}\n\n\t\tgeometry2.mergeVertices();\n\t\tgeometry2.computeFaceNormals();\n\n\t\tvar vertices = geometry2.vertices;\n\t\tvar faces = geometry2.faces;\n\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\tvar face = faces[ i ];\n\n\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\tedge[ 0 ] = face[ keys[ j ] ];\n\t\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\n\t\t\t\tedge.sort( sortFunction );\n\n\t\t\t\tvar key = edge.toString();\n\n\t\t\t\tif ( hash[ key ] === undefined ) {\n\n\t\t\t\t\thash[ key ] = { vert1: edge[ 0 ], vert2: edge[ 1 ], face1: i, face2: undefined };\n\n\t\t\t\t} else {\n\n\t\t\t\t\thash[ key ].face2 = i;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar coords = [];\n\n\t\tfor ( var key in hash ) {\n\n\t\t\tvar h = hash[ key ];\n\n\t\t\t// An edge is only rendered if the angle (in degrees) between the face normals of the adjoining faces exceeds this value. default = 1 degree.\n\n\t\t\tif ( h.face2 === undefined || faces[ h.face1 ].normal.dot( faces[ h.face2 ].normal ) <= thresholdDot ) {\n\n\t\t\t\tvar vertex = vertices[ h.vert1 ];\n\t\t\t\tcoords.push( vertex.x );\n\t\t\t\tcoords.push( vertex.y );\n\t\t\t\tcoords.push( vertex.z );\n\n\t\t\t\tvertex = vertices[ h.vert2 ];\n\t\t\t\tcoords.push( vertex.x );\n\t\t\t\tcoords.push( vertex.y );\n\t\t\t\tcoords.push( vertex.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( coords, 3 ) );\n\n\t}\n\n\tEdgesGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tEdgesGeometry.prototype.constructor = EdgesGeometry;\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction CylinderBufferGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'CylinderBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradiusTop: radiusTop,\n\t\t\tradiusBottom: radiusBottom,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tvar scope = this;\n\n\t\tradiusTop = radiusTop !== undefined ? radiusTop : 20;\n\t\tradiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\n\t\theight = height !== undefined ? height : 100;\n\n\t\tradialSegments = Math.floor( radialSegments ) || 8;\n\t\theightSegments = Math.floor( heightSegments ) || 1;\n\n\t\topenEnded = openEnded !== undefined ? openEnded : false;\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0.0;\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : 2.0 * Math.PI;\n\n\t\t// used to calculate buffer length\n\n\t\tvar nbCap = 0;\n\n\t\tif ( openEnded === false ) {\n\n\t\t\tif ( radiusTop > 0 ) nbCap ++;\n\t\t\tif ( radiusBottom > 0 ) nbCap ++;\n\n\t\t}\n\n\t\tvar vertexCount = calculateVertexCount();\n\t\tvar indexCount = calculateIndexCount();\n\n\t\t// buffers\n\n\t\tvar indices = new BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ), 1 );\n\t\tvar vertices = new BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\t\tvar normals = new BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\t\tvar uvs = new BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\n\n\t\t// helper variables\n\n\t\tvar index = 0,\n\t\t    indexOffset = 0,\n\t\t    indexArray = [],\n\t\t    halfHeight = height / 2;\n\n\t\t// group variables\n\t\tvar groupStart = 0;\n\n\t\t// generate geometry\n\n\t\tgenerateTorso();\n\n\t\tif ( openEnded === false ) {\n\n\t\t\tif ( radiusTop > 0 ) generateCap( true );\n\t\t\tif ( radiusBottom > 0 ) generateCap( false );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.addAttribute( 'position', vertices );\n\t\tthis.addAttribute( 'normal', normals );\n\t\tthis.addAttribute( 'uv', uvs );\n\n\t\t// helper functions\n\n\t\tfunction calculateVertexCount() {\n\n\t\t\tvar count = ( radialSegments + 1 ) * ( heightSegments + 1 );\n\n\t\t\tif ( openEnded === false ) {\n\n\t\t\t\tcount += ( ( radialSegments + 1 ) * nbCap ) + ( radialSegments * nbCap );\n\n\t\t\t}\n\n\t\t\treturn count;\n\n\t\t}\n\n\t\tfunction calculateIndexCount() {\n\n\t\t\tvar count = radialSegments * heightSegments * 2 * 3;\n\n\t\t\tif ( openEnded === false ) {\n\n\t\t\t\tcount += radialSegments * nbCap * 3;\n\n\t\t\t}\n\n\t\t\treturn count;\n\n\t\t}\n\n\t\tfunction generateTorso() {\n\n\t\t\tvar x, y;\n\t\t\tvar normal = new Vector3();\n\t\t\tvar vertex = new Vector3();\n\n\t\t\tvar groupCount = 0;\n\n\t\t\t// this will be used to calculate the normal\n\t\t\tvar slope = ( radiusBottom - radiusTop ) / height;\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( y = 0; y <= heightSegments; y ++ ) {\n\n\t\t\t\tvar indexRow = [];\n\n\t\t\t\tvar v = y / heightSegments;\n\n\t\t\t\t// calculate the radius of the current row\n\t\t\t\tvar radius = v * ( radiusBottom - radiusTop ) + radiusTop;\n\n\t\t\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\t\tvar u = x / radialSegments;\n\n\t\t\t\t\tvar theta = u * thetaLength + thetaStart;\n\n\t\t\t\t\tvar sinTheta = Math.sin( theta );\n\t\t\t\t\tvar cosTheta = Math.cos( theta );\n\n\t\t\t\t\t// vertex\n\t\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\t\tvertex.y = - v * height + halfHeight;\n\t\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t\t// normal\n\t\t\t\t\tnormal.set( sinTheta, slope, cosTheta ).normalize();\n\t\t\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\n\n\t\t\t\t\t// uv\n\t\t\t\t\tuvs.setXY( index, u, 1 - v );\n\n\t\t\t\t\t// save index of vertex in respective row\n\t\t\t\t\tindexRow.push( index );\n\n\t\t\t\t\t// increase index\n\t\t\t\t\tindex ++;\n\n\t\t\t\t}\n\n\t\t\t\t// now save vertices of the row in our index array\n\t\t\t\tindexArray.push( indexRow );\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tfor ( y = 0; y < heightSegments; y ++ ) {\n\n\t\t\t\t\t// we use the index array to access the correct indices\n\t\t\t\t\tvar i1 = indexArray[ y ][ x ];\n\t\t\t\t\tvar i2 = indexArray[ y + 1 ][ x ];\n\t\t\t\t\tvar i3 = indexArray[ y + 1 ][ x + 1 ];\n\t\t\t\t\tvar i4 = indexArray[ y ][ x + 1 ];\n\n\t\t\t\t\t// face one\n\t\t\t\t\tindices.setX( indexOffset, i1 ); indexOffset ++;\n\t\t\t\t\tindices.setX( indexOffset, i2 ); indexOffset ++;\n\t\t\t\t\tindices.setX( indexOffset, i4 ); indexOffset ++;\n\n\t\t\t\t\t// face two\n\t\t\t\t\tindices.setX( indexOffset, i2 ); indexOffset ++;\n\t\t\t\t\tindices.setX( indexOffset, i3 ); indexOffset ++;\n\t\t\t\t\tindices.setX( indexOffset, i4 ); indexOffset ++;\n\n\t\t\t\t\t// update counters\n\t\t\t\t\tgroupCount += 6;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\t\t\tscope.addGroup( groupStart, groupCount, 0 );\n\n\t\t\t// calculate new start value for groups\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t\tfunction generateCap( top ) {\n\n\t\t\tvar x, centerIndexStart, centerIndexEnd;\n\n\t\t\tvar uv = new Vector2();\n\t\t\tvar vertex = new Vector3();\n\n\t\t\tvar groupCount = 0;\n\n\t\t\tvar radius = ( top === true ) ? radiusTop : radiusBottom;\n\t\t\tvar sign = ( top === true ) ? 1 : - 1;\n\n\t\t\t// save the index of the first center vertex\n\t\t\tcenterIndexStart = index;\n\n\t\t\t// first we generate the center vertex data of the cap.\n\t\t\t// because the geometry needs one set of uvs per face,\n\t\t\t// we must generate a center vertex per face/segment\n\n\t\t\tfor ( x = 1; x <= radialSegments; x ++ ) {\n\n\t\t\t\t// vertex\n\t\t\t\tvertices.setXYZ( index, 0, halfHeight * sign, 0 );\n\n\t\t\t\t// normal\n\t\t\t\tnormals.setXYZ( index, 0, sign, 0 );\n\n\t\t\t\t// uv\n\t\t\t\tuv.x = 0.5;\n\t\t\t\tuv.y = 0.5;\n\n\t\t\t\tuvs.setXY( index, uv.x, uv.y );\n\n\t\t\t\t// increase index\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// save the index of the last center vertex\n\t\t\tcenterIndexEnd = index;\n\n\t\t\t// now we generate the surrounding vertices, normals and uvs\n\n\t\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\tvar u = x / radialSegments;\n\t\t\t\tvar theta = u * thetaLength + thetaStart;\n\n\t\t\t\tvar cosTheta = Math.cos( theta );\n\t\t\t\tvar sinTheta = Math.sin( theta );\n\n\t\t\t\t// vertex\n\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\tvertex.y = halfHeight * sign;\n\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\t\t\t\tnormals.setXYZ( index, 0, sign, 0 );\n\n\t\t\t\t// uv\n\t\t\t\tuv.x = ( cosTheta * 0.5 ) + 0.5;\n\t\t\t\tuv.y = ( sinTheta * 0.5 * sign ) + 0.5;\n\t\t\t\tuvs.setXY( index, uv.x, uv.y );\n\n\t\t\t\t// increase index\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tvar c = centerIndexStart + x;\n\t\t\t\tvar i = centerIndexEnd + x;\n\n\t\t\t\tif ( top === true ) {\n\n\t\t\t\t\t// face top\n\t\t\t\t\tindices.setX( indexOffset, i ); indexOffset ++;\n\t\t\t\t\tindices.setX( indexOffset, i + 1 ); indexOffset ++;\n\t\t\t\t\tindices.setX( indexOffset, c ); indexOffset ++;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// face bottom\n\t\t\t\t\tindices.setX( indexOffset, i + 1 ); indexOffset ++;\n\t\t\t\t\tindices.setX( indexOffset, i ); indexOffset ++;\n\t\t\t\t\tindices.setX( indexOffset, c ); indexOffset ++;\n\n\t\t\t\t}\n\n\t\t\t\t// update counters\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\t\t\tscope.addGroup( groupStart, groupCount, top === true ? 1 : 2 );\n\n\t\t\t// calculate new start value for groups\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t}\n\n\tCylinderBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tCylinderBufferGeometry.prototype.constructor = CylinderBufferGeometry;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction CylinderGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'CylinderGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradiusTop: radiusTop,\n\t\t\tradiusBottom: radiusBottom,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tthis.fromBufferGeometry( new CylinderBufferGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tCylinderGeometry.prototype = Object.create( Geometry.prototype );\n\tCylinderGeometry.prototype.constructor = CylinderGeometry;\n\n\t/**\n\t * @author abelnation / http://github.com/abelnation\n\t */\n\n\tfunction ConeGeometry( radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\n\n\t\tCylinderGeometry.call( this, 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\n\n\t\tthis.type = 'ConeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t}\n\n\tConeGeometry.prototype = Object.create( CylinderGeometry.prototype );\n\tConeGeometry.prototype.constructor = ConeGeometry;\n\n\t/**\n\t * @author: abelnation / http://github.com/abelnation\n\t */\n\n\tfunction ConeBufferGeometry( radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\n\n\t\tCylinderBufferGeometry.call( this, 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\n\n\t\tthis.type = 'ConeBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t}\n\n\tConeBufferGeometry.prototype = Object.create( CylinderBufferGeometry.prototype );\n\tConeBufferGeometry.prototype.constructor = ConeBufferGeometry;\n\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */\n\n\tfunction CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'CircleBufferGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tsegments: segments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tradius = radius || 50;\n\t\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\n\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\n\n\t\tvar vertices = segments + 2;\n\n\t\tvar positions = new Float32Array( vertices * 3 );\n\t\tvar normals = new Float32Array( vertices * 3 );\n\t\tvar uvs = new Float32Array( vertices * 2 );\n\n\t\t// center data is already zero, but need to set a few extras\n\t\tnormals[ 2 ] = 1.0;\n\t\tuvs[ 0 ] = 0.5;\n\t\tuvs[ 1 ] = 0.5;\n\n\t\tfor ( var s = 0, i = 3, ii = 2 ; s <= segments; s ++, i += 3, ii += 2 ) {\n\n\t\t\tvar segment = thetaStart + s / segments * thetaLength;\n\n\t\t\tpositions[ i ] = radius * Math.cos( segment );\n\t\t\tpositions[ i + 1 ] = radius * Math.sin( segment );\n\n\t\t\tnormals[ i + 2 ] = 1; // normal z\n\n\t\t\tuvs[ ii ] = ( positions[ i ] / radius + 1 ) / 2;\n\t\t\tuvs[ ii + 1 ] = ( positions[ i + 1 ] / radius + 1 ) / 2;\n\n\t\t}\n\n\t\tvar indices = [];\n\n\t\tfor ( var i = 1; i <= segments; i ++ ) {\n\n\t\t\tindices.push( i, i + 1, 0 );\n\n\t\t}\n\n\t\tthis.setIndex( new BufferAttribute( new Uint16Array( indices ), 1 ) );\n\t\tthis.addAttribute( 'position', new BufferAttribute( positions, 3 ) );\n\t\tthis.addAttribute( 'normal', new BufferAttribute( normals, 3 ) );\n\t\tthis.addAttribute( 'uv', new BufferAttribute( uvs, 2 ) );\n\n\t\tthis.boundingSphere = new Sphere( new Vector3(), radius );\n\n\t}\n\n\tCircleBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tCircleBufferGeometry.prototype.constructor = CircleBufferGeometry;\n\n\t/**\n\t * @author hughes\n\t */\n\n\tfunction CircleGeometry( radius, segments, thetaStart, thetaLength ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'CircleGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tsegments: segments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tthis.fromBufferGeometry( new CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) );\n\n\t}\n\n\tCircleGeometry.prototype = Object.create( Geometry.prototype );\n\tCircleGeometry.prototype.constructor = CircleGeometry;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\n\t */\n\n\tfunction BoxGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) {\n\n\t\tGeometry.call( this );\n\n\t\tthis.type = 'BoxGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\tdepth: depth,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tdepthSegments: depthSegments\n\t\t};\n\n\t\tthis.fromBufferGeometry( new BoxBufferGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) );\n\t\tthis.mergeVertices();\n\n\t}\n\n\tBoxGeometry.prototype = Object.create( Geometry.prototype );\n\tBoxGeometry.prototype.constructor = BoxGeometry;\n\n\n\n\tvar Geometries = Object.freeze({\n\t\tWireframeGeometry: WireframeGeometry,\n\t\tParametricGeometry: ParametricGeometry,\n\t\tParametricBufferGeometry: ParametricBufferGeometry,\n\t\tTetrahedronGeometry: TetrahedronGeometry,\n\t\tTetrahedronBufferGeometry: TetrahedronBufferGeometry,\n\t\tOctahedronGeometry: OctahedronGeometry,\n\t\tOctahedronBufferGeometry: OctahedronBufferGeometry,\n\t\tIcosahedronGeometry: IcosahedronGeometry,\n\t\tIcosahedronBufferGeometry: IcosahedronBufferGeometry,\n\t\tDodecahedronGeometry: DodecahedronGeometry,\n\t\tDodecahedronBufferGeometry: DodecahedronBufferGeometry,\n\t\tPolyhedronGeometry: PolyhedronGeometry,\n\t\tPolyhedronBufferGeometry: PolyhedronBufferGeometry,\n\t\tTubeGeometry: TubeGeometry,\n\t\tTubeBufferGeometry: TubeBufferGeometry,\n\t\tTorusKnotGeometry: TorusKnotGeometry,\n\t\tTorusKnotBufferGeometry: TorusKnotBufferGeometry,\n\t\tTorusGeometry: TorusGeometry,\n\t\tTorusBufferGeometry: TorusBufferGeometry,\n\t\tTextGeometry: TextGeometry,\n\t\tSphereBufferGeometry: SphereBufferGeometry,\n\t\tSphereGeometry: SphereGeometry,\n\t\tRingGeometry: RingGeometry,\n\t\tRingBufferGeometry: RingBufferGeometry,\n\t\tPlaneBufferGeometry: PlaneBufferGeometry,\n\t\tPlaneGeometry: PlaneGeometry,\n\t\tLatheGeometry: LatheGeometry,\n\t\tLatheBufferGeometry: LatheBufferGeometry,\n\t\tShapeGeometry: ShapeGeometry,\n\t\tShapeBufferGeometry: ShapeBufferGeometry,\n\t\tExtrudeGeometry: ExtrudeGeometry,\n\t\tEdgesGeometry: EdgesGeometry,\n\t\tConeGeometry: ConeGeometry,\n\t\tConeBufferGeometry: ConeBufferGeometry,\n\t\tCylinderGeometry: CylinderGeometry,\n\t\tCylinderBufferGeometry: CylinderBufferGeometry,\n\t\tCircleBufferGeometry: CircleBufferGeometry,\n\t\tCircleGeometry: CircleGeometry,\n\t\tBoxBufferGeometry: BoxBufferGeometry,\n\t\tBoxGeometry: BoxGeometry\n\t});\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction ShadowMaterial() {\n\n\t\tShaderMaterial.call( this, {\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib.lights,\n\t\t\t\t{\n\t\t\t\t\topacity: { value: 1.0 }\n\t\t\t\t}\n\t\t\t] ),\n\t\t\tvertexShader: ShaderChunk[ 'shadow_vert' ],\n\t\t\tfragmentShader: ShaderChunk[ 'shadow_frag' ]\n\t\t} );\n\n\t\tthis.lights = true;\n\t\tthis.transparent = true;\n\n\t\tObject.defineProperties( this, {\n\t\t\topacity: {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this.uniforms.opacity.value;\n\t\t\t\t},\n\t\t\t\tset: function ( value ) {\n\t\t\t\t\tthis.uniforms.opacity.value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t}\n\n\tShadowMaterial.prototype = Object.create( ShaderMaterial.prototype );\n\tShadowMaterial.prototype.constructor = ShadowMaterial;\n\n\tShadowMaterial.prototype.isShadowMaterial = true;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction RawShaderMaterial( parameters ) {\n\n\t\tShaderMaterial.call( this, parameters );\n\n\t\tthis.type = 'RawShaderMaterial';\n\n\t}\n\n\tRawShaderMaterial.prototype = Object.create( ShaderMaterial.prototype );\n\tRawShaderMaterial.prototype.constructor = RawShaderMaterial;\n\n\tRawShaderMaterial.prototype.isRawShaderMaterial = true;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction MultiMaterial( materials ) {\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.type = 'MultiMaterial';\n\n\t\tthis.materials = Array.isArray( materials ) ? materials : [];\n\n\t\tthis.visible = true;\n\n\t}\n\n\tMultiMaterial.prototype = {\n\n\t\tconstructor: MultiMaterial,\n\n\t\tisMultiMaterial: true,\n\n\t\ttoJSON: function ( meta ) {\n\n\t\t\tvar output = {\n\t\t\t\tmetadata: {\n\t\t\t\t\tversion: 4.2,\n\t\t\t\t\ttype: 'material',\n\t\t\t\t\tgenerator: 'MaterialExporter'\n\t\t\t\t},\n\t\t\t\tuuid: this.uuid,\n\t\t\t\ttype: this.type,\n\t\t\t\tmaterials: []\n\t\t\t};\n\n\t\t\tvar materials = this.materials;\n\n\t\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\n\n\t\t\t\tvar material = materials[ i ].toJSON( meta );\n\t\t\t\tdelete material.metadata;\n\n\t\t\t\toutput.materials.push( material );\n\n\t\t\t}\n\n\t\t\toutput.visible = this.visible;\n\n\t\t\treturn output;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\tvar material = new this.constructor();\n\n\t\t\tfor ( var i = 0; i < this.materials.length; i ++ ) {\n\n\t\t\t\tmaterial.materials.push( this.materials[ i ].clone() );\n\n\t\t\t}\n\n\t\t\tmaterial.visible = this.visible;\n\n\t\t\treturn material;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author Ben Houston / bhouston / http://clara.io\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  roughness: <float>,\n\t *  metalness: <float>,\n\t *  opacity: <float>,\n\t *\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  lightMap: new THREE.Texture( <Image> ),\n\t *  lightMapIntensity: <float>\n\t *\n\t *  aoMap: new THREE.Texture( <Image> ),\n\t *  aoMapIntensity: <float>\n\t *\n\t *  emissive: <hex>,\n\t *  emissiveIntensity: <float>\n\t *  emissiveMap: new THREE.Texture( <Image> ),\n\t *\n\t *  bumpMap: new THREE.Texture( <Image> ),\n\t *  bumpScale: <float>,\n\t *\n\t *  normalMap: new THREE.Texture( <Image> ),\n\t *  normalScale: <Vector2>,\n\t *\n\t *  displacementMap: new THREE.Texture( <Image> ),\n\t *  displacementScale: <float>,\n\t *  displacementBias: <float>,\n\t *\n\t *  roughnessMap: new THREE.Texture( <Image> ),\n\t *\n\t *  metalnessMap: new THREE.Texture( <Image> ),\n\t *\n\t *  alphaMap: new THREE.Texture( <Image> ),\n\t *\n\t *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n\t *  envMapIntensity: <float>\n\t *\n\t *  refractionRatio: <float>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>,\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>,\n\t *  morphNormals: <bool>\n\t * }\n\t */\n\n\tfunction MeshStandardMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.type = 'MeshStandardMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\t//this.map = null;\n\t\tthis.mapSlot = new MaterialMap( \"map\", 0, false, false );\n\n\t\tthis.reflectivity = 0.5;\n\n\t\tthis.roughness = 0.5;\n\t\t//this.roughnessMap = null;\n\t\tthis.roughnessMapSlot = new MaterialMap( \"roughnessMap\", 0, false, false );\n\n\t\tthis.metalness = 0.5;\n\t\t//this.metalnessMap = null;\n\t\tthis.metalnessMapSlot = new MaterialMap( \"metalnessMap\", 0, false, false );\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\t//this.emissiveMap = null;\n\t\tthis.emissiveMapSlot = new MaterialMap( \"emissiveMap\", 0, false, false );\n\n\t\t//this.bumpMap = null;\n\t\t//this.bumpScale = 1;\n\t\tthis.bumpMapSlot = new MaterialMap( \"bumpMap\", 0, false, true );\n\n\t\t//this.normalMap = null;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\t\tthis.normalMapSlot = new MaterialMap( \"normalMap\", 0, false, false );\n\n\t\t//this.displacementMap = null;\n\t\t//this.displacementScale = 1;\n\t\t//this.displacementBias = 0;\n\t\tthis.displacementMapSlot = new MaterialMap( \"displacementMap\", 0, false, true );\n\n\t\t//this.lightMap = null;\n\t\t//this.lightMapIntensity = 1.0;\n\t\tthis.lightMapSlot = new MaterialMap( \"lightMap\", 1, false, true );\n\n\t\t//this.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\t\tthis.aoMapSlot = new MaterialMap( \"aoMap\", 1, false, true );\n\n\t\t//this.alphaMap = null;\n\t\tthis.alphaMapSlot = new MaterialMap( \"alphaMap\", 0, false, false );\n\n\t\tthis.envMap = null;\n\t\tthis.envMapIntensity = 1.0;\n\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.skinning = false;\n\t\tthis.morphTargets = false;\n\t\tthis.morphNormals = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tMeshStandardMaterial.prototype = Object.create( Material.prototype );\n\tMeshStandardMaterial.prototype.constructor = MeshStandardMaterial;\n\n\tMeshStandardMaterial.prototype.isMeshStandardMaterial = true;\n\n\tvar closure$1 = function () {\n\t\tvar propertyMappings = {\n\t\t\t\"map\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.mapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.mapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"lightMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.lightMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.lightMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"lightMapIntensity\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.lightMapSlot.texelScale;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.lightMapSlot.texelTransform = true;\n\t\t\t\t\tthis.lightMapSlot.texelScale = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"aoMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.aoMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.aoMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"emissiveMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.emissiveMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.emissiveMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"bumpMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.bumpMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.bumpMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"bumpScale\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.bumpMapSlot.texelScale;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.bumpMapSlot.texelTransform = true;\n\t\t\t\t\tthis.bumpMapSlot.texelScale = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"normalMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.normalMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.normalMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"displacementMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.displacementMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.displacementMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"displacementScale\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.displacementMapSlot.texelScale;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.displacementMapSlot.texelTransform = true;\n\t\t\t\t\tthis.displacementMapSlot.texelScale = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"displacementBias\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.displacementMapSlot.texelOffset;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.displacementMapSlot.texelTransform = true;\n\t\t\t\t\tthis.displacementMapSlot.texelOffset = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"roughnessMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.roughnessMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.roughnessMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"metalnessMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.metalnessMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.metalnessMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"alphaMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.alphaMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.alphaMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tfor( var propertyName in propertyMappings ) {\n\t\t\tObject.defineProperty( MeshStandardMaterial.prototype, propertyName, propertyMappings[ propertyName ] );\n\t\t}\n\t}();\n\n\tMeshStandardMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.color.copy( source.color );\n\t\tthis.mapSlot.copy( source.mapSlot );\n\n\t\tthis.reflectivity = source.reflectivity;\n\n\t\tthis.roughness = source.roughness;\n\t\tthis.roughnessMapSlot.copy( source.roughnessMapSlot );\n\n\t\tthis.metalness = source.metalness;\n\t\tthis.metalnessMapSlot.copy( source.metalnessMapSlot );\n\n\t\tthis.lightMapSlot.copy( source.lightMapSlot );\n\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\t\tthis.aoMapSlot.copy( source.aoMapSlot );\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\t\tthis.emissiveMapSlot.copy( source.emissiveMapSlot );\n\n\t\tthis.bumpMapSlot.copy( source.bumpMapSlot );\n\n\t\tthis.normalScale.copy( source.normalScale );\n\t\tthis.normalMapSlot.copy( source.normalMapSlot );\n\n\t\tthis.displacementMapSlot.copy( source.displacementMapSlot );\n\n\t\tthis.alphaMapSlot.copy( source.alphaMapSlot );\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapIntensity = source.envMapIntensity;\n\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.skinning = source.skinning;\n\t\tthis.morphTargets = source.morphTargets;\n\t\tthis.morphNormals = source.morphNormals;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author WestLangley / http://github.com/WestLangley\n\t *\n\t * parameters = {\n\t *  reflectivity: <float>\n\t * }\n\t */\n\n\tfunction MeshPhysicalMaterial( parameters ) {\n\n\t\tMeshStandardMaterial.call( this );\n\n\t\tthis.defines = { 'PHYSICAL': '' };\n\n\t\tthis.type = 'MeshPhysicalMaterial';\n\n\t\tthis.reflectivity = 0.5; // maps to F0 = 0.04\n\n\t\tthis.falloff = false;\n\t\tthis.falloffColor = new Color( 0xffffff );\n\t\tthis.falloffMapSlot = new MaterialMap( \"falloffMap\", 0, false, false );\n\t\tthis.falloffOpacity = 1.0;\n\t\tthis.falloffAlphaMapSlot = new MaterialMap( \"falloffAlphaMap\", 0, false, false );\n\n\t\tthis.clearCoat = 0.0;\n\t\tthis.clearCoatRoughness = 0.0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tMeshPhysicalMaterial.prototype = Object.create( MeshStandardMaterial.prototype );\n\tMeshPhysicalMaterial.prototype.constructor = MeshPhysicalMaterial;\n\n\tMeshPhysicalMaterial.prototype.isMeshPhysicalMaterial = true;\n\n\n\tvar closure = function () {\n\t\tvar propertyMappings = {\n\t\t\t\"falloffMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.falloffMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.falloffMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"falloffAlphaMap\": {\n\t\t\t  get: function() {\n\t\t\t\t\treturn this.falloffAlphaMapSlot.texture;\n\t\t\t  },\n\t\t\t\tset: function( value ) {\n\t\t\t\t\tthis.falloffAlphaMapSlot.texture = value;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tfor( var propertyName in propertyMappings ) {\n\t\t\tObject.defineProperty( MeshPhysicalMaterial.prototype, propertyName, propertyMappings[ propertyName ] );\n\t\t}\n\t}();\n\n\tMeshPhysicalMaterial.prototype.copy = function ( source ) {\n\n\t\tMeshStandardMaterial.prototype.copy.call( this, source );\n\n\t\tthis.defines = { 'PHYSICAL': '' };\n\n\t\tthis.reflectivity = source.reflectivity;\n\n\t\tthis.falloff = source.falloff;\n\t\tthis.falloffColor.copy( source.falloffColor );\n\t\tthis.falloffMapSlot.copy( source.falloffMapSlot );\n\t\tthis.falloffOpacity = source.falloffOpacity;\n\t\tthis.falloffAlphaMapSlot.copy( source.falloffAlphaMapSlot );\n\n\t\tthis.clearCoat = source.clearCoat;\n\t\tthis.clearCoatRoughness = source.clearCoatRoughness;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  specular: <hex>,\n\t *  shininess: <float>,\n\t *  opacity: <float>,\n\t *\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  lightMap: new THREE.Texture( <Image> ),\n\t *  lightMapIntensity: <float>\n\t *\n\t *  aoMap: new THREE.Texture( <Image> ),\n\t *  aoMapIntensity: <float>\n\t *\n\t *  emissive: <hex>,\n\t *  emissiveIntensity: <float>\n\t *  emissiveMap: new THREE.Texture( <Image> ),\n\t *\n\t *  bumpMap: new THREE.Texture( <Image> ),\n\t *  bumpScale: <float>,\n\t *\n\t *  normalMap: new THREE.Texture( <Image> ),\n\t *  normalScale: <Vector2>,\n\t *\n\t *  displacementMap: new THREE.Texture( <Image> ),\n\t *  displacementScale: <float>,\n\t *  displacementBias: <float>,\n\t *\n\t *  specularMap: new THREE.Texture( <Image> ),\n\t *\n\t *  alphaMap: new THREE.Texture( <Image> ),\n\t *\n\t *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\n\t *  combine: THREE.Multiply,\n\t *  reflectivity: <float>,\n\t *  refractionRatio: <float>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>,\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>,\n\t *  morphNormals: <bool>\n\t * }\n\t */\n\n\tfunction MeshPhongMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'MeshPhongMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.specular = new Color( 0x111111 );\n\t\tthis.shininess = 30;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.skinning = false;\n\t\tthis.morphTargets = false;\n\t\tthis.morphNormals = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tMeshPhongMaterial.prototype = Object.create( Material.prototype );\n\tMeshPhongMaterial.prototype.constructor = MeshPhongMaterial;\n\n\tMeshPhongMaterial.prototype.isMeshPhongMaterial = true;\n\n\tMeshPhongMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.specular.copy( source.specular );\n\t\tthis.shininess = source.shininess;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.skinning = source.skinning;\n\t\tthis.morphTargets = source.morphTargets;\n\t\tthis.morphNormals = source.morphNormals;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author takahirox / http://github.com/takahirox\n\t *\n\t * parameters = {\n\t *  gradientMap: new THREE.Texture( <Image> )\n\t * }\n\t */\n\n\tfunction MeshToonMaterial( parameters ) {\n\n\t\tMeshPhongMaterial.call( this );\n\n\t\tthis.defines = { 'TOON': '' };\n\n\t\tthis.type = 'MeshToonMaterial';\n\n\t\tthis.gradientMap = null;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tMeshToonMaterial.prototype = Object.create( MeshPhongMaterial.prototype );\n\tMeshToonMaterial.prototype.constructor = MeshToonMaterial;\n\n\tMeshToonMaterial.prototype.isMeshToonMaterial = true;\n\n\tMeshToonMaterial.prototype.copy = function ( source ) {\n\n\t\tMeshPhongMaterial.prototype.copy.call( this, source );\n\n\t\tthis.gradientMap = source.gradientMap;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t *\n\t * parameters = {\n\t *  opacity: <float>,\n\t *\n\t *  bumpMap: new THREE.Texture( <Image> ),\n\t *  bumpScale: <float>,\n\t *\n\t *  normalMap: new THREE.Texture( <Image> ),\n\t *  normalScale: <Vector2>,\n\t *\n\t *  displacementMap: new THREE.Texture( <Image> ),\n\t *  displacementScale: <float>,\n\t *  displacementBias: <float>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>,\n\t *  morphNormals: <bool>\n\t * }\n\t */\n\n\tfunction MeshNormalMaterial( parameters ) {\n\n\t\tMaterial.call( this, parameters );\n\n\t\tthis.type = 'MeshNormalMaterial';\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false;\n\t\tthis.lights = false;\n\n\t\tthis.skinning = false;\n\t\tthis.morphTargets = false;\n\t\tthis.morphNormals = false;\n\n\t\t// default normal is facing the camera.\n\t\tthis.clearColor = new Color( 0.5, 0.5, 1.0 );\n\t\tthis.clearAlpha = 1.0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tMeshNormalMaterial.prototype = Object.create( Material.prototype );\n\tMeshNormalMaterial.prototype.constructor = MeshNormalMaterial;\n\n\tMeshNormalMaterial.prototype.isMeshNormalMaterial = true;\n\n\tMeshNormalMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.clearColor = source.clearColor;\n\t\tthis.clearAlpha = source.clearAlpha;\n\n\t\tthis.skinning = source.skinning;\n\t\tthis.morphTargets = source.morphTargets;\n\t\tthis.morphNormals = source.morphNormals;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  lightMap: new THREE.Texture( <Image> ),\n\t *  lightMapIntensity: <float>\n\t *\n\t *  aoMap: new THREE.Texture( <Image> ),\n\t *  aoMapIntensity: <float>\n\t *\n\t *  emissive: <hex>,\n\t *  emissiveIntensity: <float>\n\t *  emissiveMap: new THREE.Texture( <Image> ),\n\t *\n\t *  specularMap: new THREE.Texture( <Image> ),\n\t *\n\t *  alphaMap: new THREE.Texture( <Image> ),\n\t *\n\t *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\n\t *  combine: THREE.Multiply,\n\t *  reflectivity: <float>,\n\t *  refractionRatio: <float>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>,\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>,\n\t *  morphNormals: <bool>\n\t * }\n\t */\n\n\tfunction MeshLambertMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'MeshLambertMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.skinning = false;\n\t\tthis.morphTargets = false;\n\t\tthis.morphNormals = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tMeshLambertMaterial.prototype = Object.create( Material.prototype );\n\tMeshLambertMaterial.prototype.constructor = MeshLambertMaterial;\n\n\tMeshLambertMaterial.prototype.isMeshLambertMaterial = true;\n\n\tMeshLambertMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.skinning = source.skinning;\n\t\tthis.morphTargets = source.morphTargets;\n\t\tthis.morphNormals = source.morphNormals;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author bhouston / https://clara.io\n\t *\n\t * parameters = {\n\t *\n\t * }\n\t */\n\n\tfunction MeshCubeMaterial ( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'MeshCubeMaterial';\n\n\t\tthis.envMap = null;\n\t\tthis.envMapIntensity = 1.0;\n\n\t\tthis.roughness = 0.0;\n\n\t\tthis.depthTest = false;\n\t\tthis.depthWrite = false;\n\t\tthis.side = BackSide;\n\n\t\tthis.lights = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tMeshCubeMaterial.prototype = Object.create( Material.prototype );\n\tMeshCubeMaterial.prototype.constructor = MeshCubeMaterial;\n\n\tMeshCubeMaterial.prototype.isMeshCubeMaterial = true;\n\n\tMeshCubeMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapIntensity = source.envMapIntensity;\n\n\t\tthis.roughness = source.roughness;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *\n\t *  linewidth: <float>,\n\t *\n\t *  scale: <float>,\n\t *  dashSize: <float>,\n\t *  gapSize: <float>\n\t * }\n\t */\n\n\tfunction LineDashedMaterial( parameters ) {\n\n\t\tMaterial.call( this );\n\n\t\tthis.type = 'LineDashedMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.linewidth = 1;\n\n\t\tthis.scale = 1;\n\t\tthis.dashSize = 3;\n\t\tthis.gapSize = 1;\n\n\t\tthis.lights = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tLineDashedMaterial.prototype = Object.create( Material.prototype );\n\tLineDashedMaterial.prototype.constructor = LineDashedMaterial;\n\n\tLineDashedMaterial.prototype.isLineDashedMaterial = true;\n\n\tLineDashedMaterial.prototype.copy = function ( source ) {\n\n\t\tMaterial.prototype.copy.call( this, source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.linewidth = source.linewidth;\n\n\t\tthis.scale = source.scale;\n\t\tthis.dashSize = source.dashSize;\n\t\tthis.gapSize = source.gapSize;\n\n\t\treturn this;\n\n\t};\n\n\n\n\tvar Materials = Object.freeze({\n\t\tShadowMaterial: ShadowMaterial,\n\t\tSpriteMaterial: SpriteMaterial,\n\t\tRawShaderMaterial: RawShaderMaterial,\n\t\tShaderMaterial: ShaderMaterial,\n\t\tPointsMaterial: PointsMaterial,\n\t\tMultiMaterial: MultiMaterial,\n\t\tMeshPhysicalMaterial: MeshPhysicalMaterial,\n\t\tMeshStandardMaterial: MeshStandardMaterial,\n\t\tMeshPhongMaterial: MeshPhongMaterial,\n\t\tMeshToonMaterial: MeshToonMaterial,\n\t\tMeshNormalMaterial: MeshNormalMaterial,\n\t\tMeshLambertMaterial: MeshLambertMaterial,\n\t\tMeshDepthMaterial: MeshDepthMaterial,\n\t\tMeshBasicMaterial: MeshBasicMaterial,\n\t\tMeshCubeMaterial: MeshCubeMaterial,\n\t\tLineDashedMaterial: LineDashedMaterial,\n\t\tLineBasicMaterial: LineBasicMaterial,\n\t\tMaterialMap: MaterialMap,\n\t\tMaterial: Material\n\t});\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tvar Cache = {\n\n\t\tenabled: false,\n\n\t\tfiles: {},\n\n\t\tadd: function ( key, file ) {\n\n\t\t\tif ( this.enabled === false ) return;\n\n\t\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\n\n\t\t\tthis.files[ key ] = file;\n\n\t\t},\n\n\t\tget: function ( key ) {\n\n\t\t\tif ( this.enabled === false ) return;\n\n\t\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\n\n\t\t\treturn this.files[ key ];\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete this.files[ key ];\n\n\t\t},\n\n\t\tclear: function () {\n\n\t\t\tthis.files = {};\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction LoadingManager( onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar isLoading = false, itemsLoaded = 0, itemsTotal = 0;\n\n\t\tthis.onStart = undefined;\n\t\tthis.onLoad = onLoad;\n\t\tthis.onProgress = onProgress;\n\t\tthis.onError = onError;\n\n\t\tthis.itemStart = function ( url ) {\n\n\t\t\titemsTotal ++;\n\n\t\t\tif ( isLoading === false ) {\n\n\t\t\t\tif ( scope.onStart !== undefined ) {\n\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tisLoading = true;\n\n\t\t};\n\n\t\tthis.itemEnd = function ( url ) {\n\n\t\t\titemsLoaded ++;\n\n\t\t\tif ( scope.onProgress !== undefined ) {\n\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\n\n\t\t\t}\n\n\t\t\tif ( itemsLoaded === itemsTotal ) {\n\n\t\t\t\tisLoading = false;\n\n\t\t\t\tif ( scope.onLoad !== undefined ) {\n\n\t\t\t\t\tscope.onLoad();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.itemError = function ( url ) {\n\n\t\t\tif ( scope.onError !== undefined ) {\n\n\t\t\t\tscope.onError( url );\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tvar DefaultLoadingManager = new LoadingManager();\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction FileLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t}\n\n\tObject.assign( FileLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tif ( url === undefined ) url = '';\n\n\t\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\t\tvar scope = this;\n\n\t\t\tvar cached = Cache.get( url );\n\n\t\t\tif ( cached !== undefined ) {\n\n\t\t\t\tscope.manager.itemStart( url );\n\n\t\t\t\tsetTimeout( function () {\n\n\t\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, 0 );\n\n\t\t\t\treturn cached;\n\n\t\t\t}\n\n\t\t\t// Check for data: URI\n\t\t\tvar dataUriRegex = /^data:(.*?)(;base64)?,(.*)$/;\n\t\t\tvar dataUriRegexResult = url.match( dataUriRegex );\n\n\t\t\t// Safari can not handle Data URIs through XMLHttpRequest so process manually\n\t\t\tif ( dataUriRegexResult ) {\n\n\t\t\t\tvar mimeType = dataUriRegexResult[ 1 ];\n\t\t\t\tvar isBase64 = !! dataUriRegexResult[ 2 ];\n\t\t\t\tvar data = dataUriRegexResult[ 3 ];\n\n\t\t\t\tdata = window.decodeURIComponent( data );\n\n\t\t\t\tif ( isBase64 ) data = window.atob( data );\n\n\t\t\t\ttry {\n\n\t\t\t\t\tvar response;\n\t\t\t\t\tvar responseType = ( this.responseType || '' ).toLowerCase();\n\n\t\t\t\t\tswitch ( responseType ) {\n\n\t\t\t\t\t\tcase 'arraybuffer':\n\t\t\t\t\t\tcase 'blob':\n\n\t\t\t\t\t\t \tresponse = new ArrayBuffer( data.length );\n\n\t\t\t\t\t\t\tvar view = new Uint8Array( response );\n\n\t\t\t\t\t\t\tfor ( var i = 0; i < data.length; i ++ ) {\n\n\t\t\t\t\t\t\t\tview[ i ] = data.charCodeAt( i );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( responseType === 'blob' ) {\n\n\t\t\t\t\t\t\t\tresponse = new Blob( [ response ], { type: mimeType } );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'document':\n\n\t\t\t\t\t\t\tvar parser = new DOMParser();\n\t\t\t\t\t\t\tresponse = parser.parseFromString( data, mimeType );\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'json':\n\n\t\t\t\t\t\t\tresponse = JSON.parse( data );\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault: // 'text' or other\n\n\t\t\t\t\t\t\tresponse = data;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Wait for next browser tick\n\t\t\t\t\twindow.setTimeout( function () {\n\n\t\t\t\t\t\tif ( onLoad ) onLoad( response );\n\n\t\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t\t}, 0 );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t// Wait for next browser tick\n\t\t\t\t\twindow.setTimeout( function () {\n\n\t\t\t\t\t\tif ( onError ) onError( error );\n\n\t\t\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t\t\t}, 0 );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tvar request = new XMLHttpRequest();\n\t\t\t\trequest.open( 'GET', url, true );\n\n\t\t\t\trequest.addEventListener( 'load', function ( event ) {\n\n\t\t\t\t\tvar response = event.target.response;\n\n\t\t\t\t\tCache.add( url, response );\n\n\t\t\t\t\tif ( this.status === 200 ) {\n\n\t\t\t\t\t\tif ( onLoad ) onLoad( response );\n\n\t\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t\t} else if ( this.status === 0 ) {\n\n\t\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\n\t\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\n\n\t\t\t\t\t\tif ( onLoad ) onLoad( response );\n\n\t\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( onError ) onError( event );\n\n\t\t\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t\t\t}\n\n\t\t\t\t}, false );\n\n\t\t\t\tif ( onProgress !== undefined ) {\n\n\t\t\t\t\trequest.addEventListener( 'progress', function ( event ) {\n\n\t\t\t\t\t\tonProgress( event );\n\n\t\t\t\t\t}, false );\n\n\t\t\t\t}\n\n\t\t\t\trequest.addEventListener( 'error', function ( event ) {\n\n\t\t\t\t\tif ( onError ) onError( event );\n\n\t\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t\t}, false );\n\n\t\t\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\n\t\t\t\tif ( this.withCredentials !== undefined ) request.withCredentials = this.withCredentials;\n\n\t\t\t\tif ( request.overrideMimeType ) request.overrideMimeType( this.mimeType !== undefined ? this.mimeType : 'text/plain' );\n\n\t\t\t\trequest.send( null );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\treturn request;\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetResponseType: function ( value ) {\n\n\t\t\tthis.responseType = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetWithCredentials: function ( value ) {\n\n\t\t\tthis.withCredentials = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetMimeType: function ( value ) {\n\n\t\t\tthis.mimeType = value;\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t *\n\t * Abstract Base class to block based textures loader (dds, pvr, ...)\n\t */\n\n\tfunction CompressedTextureLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t\t// override in sub classes\n\t\tthis._parser = null;\n\n\t}\n\n\tObject.assign( CompressedTextureLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar images = [];\n\n\t\t\tvar texture = new CompressedTexture();\n\t\t\ttexture.image = images;\n\n\t\t\tvar loader = new FileLoader( this.manager );\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\t\tfunction loadTexture( i ) {\n\n\t\t\t\tloader.load( url[ i ], function ( buffer ) {\n\n\t\t\t\t\tvar texDatas = scope._parser( buffer, true );\n\n\t\t\t\t\timages[ i ] = {\n\t\t\t\t\t\twidth: texDatas.width,\n\t\t\t\t\t\theight: texDatas.height,\n\t\t\t\t\t\tformat: texDatas.format,\n\t\t\t\t\t\tmipmaps: texDatas.mipmaps\n\t\t\t\t\t};\n\n\t\t\t\t\tloaded += 1;\n\n\t\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\t\tif ( texDatas.mipmapCount === 1 )\n\t\t\t\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t\t}\n\n\t\t\t\t}, onProgress, onError );\n\n\t\t\t}\n\n\t\t\tif ( Array.isArray( url ) ) {\n\n\t\t\t\tvar loaded = 0;\n\n\t\t\t\tfor ( var i = 0, il = url.length; i < il; ++ i ) {\n\n\t\t\t\t\tloadTexture( i );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// compressed cubemap texture stored in a single DDS file\n\n\t\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\t\tvar texDatas = scope._parser( buffer, true );\n\n\t\t\t\t\tif ( texDatas.isCubemap ) {\n\n\t\t\t\t\t\tvar faces = texDatas.mipmaps.length / texDatas.mipmapCount;\n\n\t\t\t\t\t\tfor ( var f = 0; f < faces; f ++ ) {\n\n\t\t\t\t\t\t\timages[ f ] = { mipmaps : [] };\n\n\t\t\t\t\t\t\tfor ( var i = 0; i < texDatas.mipmapCount; i ++ ) {\n\n\t\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\n\t\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\n\t\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\n\t\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttexture.image.width = texDatas.width;\n\t\t\t\t\t\ttexture.image.height = texDatas.height;\n\t\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\n\n\t\t\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}, onProgress, onError );\n\n\t\t\t}\n\n\t\t\treturn texture;\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author Nikos M. / https://github.com/foo123/\n\t *\n\t * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\n\t */\n\n\tfunction DataTextureLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t\t// override in sub classes\n\t\tthis._parser = null;\n\n\t}\n\n\tObject.assign( DataTextureLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar texture = new DataTexture();\n\n\t\t\tvar loader = new FileLoader( this.manager );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\tvar texData = scope._parser( buffer );\n\n\t\t\t\tif ( ! texData ) return;\n\n\t\t\t\tif ( undefined !== texData.image ) {\n\n\t\t\t\t\ttexture.image = texData.image;\n\n\t\t\t\t} else if ( undefined !== texData.data ) {\n\n\t\t\t\t\ttexture.image.width = texData.width;\n\t\t\t\t\ttexture.image.height = texData.height;\n\t\t\t\t\ttexture.image.data = texData.data;\n\n\t\t\t\t}\n\n\t\t\t\ttexture.wrapS = undefined !== texData.wrapS ? texData.wrapS : ClampToEdgeWrapping;\n\t\t\t\ttexture.wrapT = undefined !== texData.wrapT ? texData.wrapT : ClampToEdgeWrapping;\n\n\t\t\t\ttexture.magFilter = undefined !== texData.magFilter ? texData.magFilter : LinearFilter;\n\t\t\t\ttexture.minFilter = undefined !== texData.minFilter ? texData.minFilter : LinearMipMapLinearFilter;\n\n\t\t\t\ttexture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\n\n\t\t\t\tif ( undefined !== texData.format ) {\n\n\t\t\t\t\ttexture.format = texData.format;\n\n\t\t\t\t}\n\t\t\t\tif ( undefined !== texData.type ) {\n\n\t\t\t\t\ttexture.type = texData.type;\n\n\t\t\t\t}\n\n\t\t\t\tif ( undefined !== texData.mipmaps ) {\n\n\t\t\t\t\ttexture.mipmaps = texData.mipmaps;\n\n\t\t\t\t}\n\n\t\t\t\tif ( 1 === texData.mipmapCount ) {\n\n\t\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t\t}\n\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\tif ( onLoad ) onLoad( texture, texData );\n\n\t\t\t}, onProgress, onError );\n\n\n\t\t\treturn texture;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction ImageLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t}\n\n\tObject.assign( ImageLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tif ( url === undefined ) url = '';\n\n\t\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\t\tvar scope = this;\n\n\t\t\tvar cached = Cache.get( url );\n\n\t\t\tif ( cached !== undefined ) {\n\n\t\t\t\tscope.manager.itemStart( url );\n\n\t\t\t\tsetTimeout( function () {\n\n\t\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, 0 );\n\n\t\t\t\treturn cached;\n\n\t\t\t}\n\n\t\t\tvar image = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'img' );\n\n\t\t\timage.addEventListener( 'load', function () {\n\n\t\t\t\tCache.add( url, this );\n\n\t\t\t\tif ( onLoad ) onLoad( this );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, false );\n\n\t\t\t/*\n\t\t\timage.addEventListener( 'progress', function ( event ) {\n\n\t\t\t\tif ( onProgress ) onProgress( event );\n\n\t\t\t}, false );\n\t\t\t*/\n\n\t\t\timage.addEventListener( 'error', function ( event ) {\n\n\t\t\t\tif ( onError ) onError( event );\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}, false );\n\n\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\timage.src = url;\n\n\t\t\treturn image;\n\n\t\t},\n\n\t\tsetCrossOrigin: function ( value ) {\n\n\t\t\tthis.crossOrigin = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction CubeTextureLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t}\n\n\tObject.assign( CubeTextureLoader.prototype, {\n\n\t\tload: function ( urls, onLoad, onProgress, onError ) {\n\n\t\t\tvar texture = new CubeTexture();\n\n\t\t\tvar loader = new ImageLoader( this.manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\t\tloader.setPath( this.path );\n\n\t\t\tvar loaded = 0;\n\n\t\t\tfunction loadTexture( i ) {\n\n\t\t\t\tloader.load( urls[ i ], function ( image ) {\n\n\t\t\t\t\ttexture.images[ i ] = image;\n\n\t\t\t\t\tloaded ++;\n\n\t\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t\t}\n\n\t\t\t\t}, undefined, onError );\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < urls.length; ++ i ) {\n\n\t\t\t\tloadTexture( i );\n\n\t\t\t}\n\n\t\t\treturn texture;\n\n\t\t},\n\n\t\tsetCrossOrigin: function ( value ) {\n\n\t\t\tthis.crossOrigin = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction TextureLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t}\n\n\tObject.assign( TextureLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar texture = new Texture();\n\n\t\t\tvar loader = new ImageLoader( this.manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.load( url, function ( image ) {\n\n\t\t\t\t// JPEGs can't have an alpha channel, so memory can be saved by storing them as RGB.\n\t\t\t\tvar isJPEG = url.search( /\\.(jpg|jpeg)$/ ) > 0 || url.search( /^data\\:image\\/jpeg/ ) === 0;\n\n\t\t\t\ttexture.format = isJPEG ? RGBFormat : RGBAFormat;\n\t\t\t\ttexture.image = image;\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\tif ( onLoad !== undefined ) {\n\n\t\t\t\t\tonLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, onError );\n\n\t\t\treturn texture;\n\n\t\t},\n\n\t\tsetCrossOrigin: function ( value ) {\n\n\t\t\tthis.crossOrigin = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction Light( color, intensity ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Light';\n\n\t\tthis.color = new Color( color );\n\t\tthis.intensity = intensity !== undefined ? intensity : 1;\n\n\t\tthis.receiveShadow = undefined;\n\n\t}\n\n\tLight.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: Light,\n\n\t\tisLight: true,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tObject3D.prototype.copy.call( this, source );\n\n\t\t\tthis.color.copy( source.color );\n\t\t\tthis.intensity = source.intensity;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\ttoJSON: function ( meta ) {\n\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\n\n\t\t\tdata.object.color = this.color.getHex();\n\t\t\tdata.object.intensity = this.intensity;\n\n\t\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\n\n\t\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\n\t\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\n\t\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\n\t\t\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\n\n\t\t\tif ( this.shadow !== undefined ) data.object.shadow = this.shadow.toJSON();\n\n\t\t\treturn data;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction HemisphereLight( skyColor, groundColor, intensity ) {\n\n\t\tLight.call( this, skyColor, intensity );\n\n\t\tthis.type = 'HemisphereLight';\n\n\t\tthis.castShadow = undefined;\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.groundColor = new Color( groundColor );\n\n\t}\n\n\tHemisphereLight.prototype = Object.assign( Object.create( Light.prototype ), {\n\n\t\tconstructor: HemisphereLight,\n\n\t\tisHemisphereLight: true,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tLight.prototype.copy.call( this, source );\n\n\t\t\tthis.groundColor.copy( source.groundColor );\n\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author bhouston / http://clara.io/\n\t */\n\n\tfunction LightShadow( camera ) {\n\n\t\tthis.camera = camera;\n\n\t\tthis.bias = 0;\n\t\tthis.radius = 1;\n\n\t\tthis.mapSize = new Vector2( 512, 512 );\n\n\t\tthis.map = null;\n\t\tthis.matrix = new Matrix4();\n\n\t\tthis.cameraFovNearFar = new Vector3( 2 * _Math.DEG2RAD, 0.5, 500 );\n\n\t}\n\n\tObject.assign( LightShadow.prototype, {\n\n\t\tcopy: function ( source ) {\n\n\t\t\tthis.camera = source.camera.clone();\n\n\t\t\tthis.bias = source.bias;\n\t\t\tthis.radius = source.radius;\n\n\t\t\tthis.mapSize.copy( source.mapSize );\n\n\t\t\tthis.cameraFovNearFar.copy( source.cameraFovNearFar );\n\n\t\t\treturn this;\n\n\t\t},\n\n\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\ttoJSON: function () {\n\n\t\t\tvar object = {};\n\n\t\t\tif ( this.bias !== 0 ) object.bias = this.bias;\n\t\t\tif ( this.radius !== 1 ) object.radius = this.radius;\n\t\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) object.mapSize = this.mapSize.toArray();\n\n\t\t\tobject.camera = this.camera.toJSON( false ).object;\n\t\t\tdelete object.camera.matrix;\n\n\t\t\treturn object;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction SpotLightShadow() {\n\n\t\tvar fov = 50;\n\t\tthis.cameraParams = new Vector3( fov, 10.5, 1000 );\n\t\tLightShadow.call( this, new PerspectiveCamera( this.cameraParams.x, 1, this.cameraParams.y, this.cameraParams.z ) );\n\n\t}\n\n\tSpotLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\n\n\t\tconstructor: SpotLightShadow,\n\n\t\tisSpotLightShadow: true,\n\n\t\tupdate: function ( light ) {\n\n\t\t\tvar fov = _Math.RAD2DEG * 2 * light.angle;\n\t\t\tvar aspect = this.mapSize.width / this.mapSize.height;\n\t\t\tvar far = light.distance || 500;\n\n\t\t\tvar camera = this.camera;\n\n\t\t\tthis.cameraParams.x = fov * _Math.DEG2RAD;\n\t\t\tthis.cameraParams.y = light.shadow.camera.near;\n\t\t\tthis.cameraParams.z = far;\n\n\t\t\tcamera.fov = fov;\n\t\t\tcamera.aspect = aspect;\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction SpotLight( color, intensity, distance, angle, penumbra, decay ) {\n\n\t\tLight.call( this, color, intensity );\n\n\t\tthis.type = 'SpotLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tObject.defineProperty( this, 'power', {\n\t\t\tget: function () {\n\t\t\t\t// intensity = power per solid angle.\n\t\t\t\t// ref: equation (17) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\n\t\t\t\treturn this.intensity * Math.PI;\n\t\t\t},\n\t\t\tset: function ( power ) {\n\t\t\t\t// intensity = power per solid angle.\n\t\t\t\t// ref: equation (17) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\n\t\t\t\tthis.intensity = power / Math.PI;\n\t\t\t}\n\t\t} );\n\n\t\tthis.distance = ( distance !== undefined ) ? distance : 0;\n\t\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\n\t\tthis.penumbra = ( penumbra !== undefined ) ? penumbra : 0;\n\t\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\n\n\t\tthis.shadow = new SpotLightShadow();\n\n\t}\n\n\tSpotLight.prototype = Object.assign( Object.create( Light.prototype ), {\n\n\t\tconstructor: SpotLight,\n\n\t\tisSpotLight: true,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tLight.prototype.copy.call( this, source );\n\n\t\t\tthis.distance = source.distance;\n\t\t\tthis.angle = source.angle;\n\t\t\tthis.penumbra = source.penumbra;\n\t\t\tthis.decay = source.decay;\n\n\t\t\tthis.target = source.target.clone();\n\n\t\t\tthis.shadow = source.shadow.clone();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\n\tfunction PointLight( color, intensity, distance, decay ) {\n\n\t\tLight.call( this, color, intensity );\n\n\t\tthis.type = 'PointLight';\n\n\t\tObject.defineProperty( this, 'power', {\n\t\t\tget: function () {\n\t\t\t\t// intensity = power per solid angle.\n\t\t\t\t// ref: equation (15) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\n\t\t\t\treturn this.intensity * 4 * Math.PI;\n\n\t\t\t},\n\t\t\tset: function ( power ) {\n\t\t\t\t// intensity = power per solid angle.\n\t\t\t\t// ref: equation (15) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\n\t\t\t\tthis.intensity = power / ( 4 * Math.PI );\n\t\t\t}\n\t\t} );\n\n\t\tthis.distance = ( distance !== undefined ) ? distance : 0;\n\t\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\n\n\t\tthis.shadow = new LightShadow( new PerspectiveCamera( 90, 1, 0.5, 500 ) );\n\n\t}\n\n\tPointLight.prototype = Object.assign( Object.create( Light.prototype ), {\n\n\t\tconstructor: PointLight,\n\n\t\tisPointLight: true,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tLight.prototype.copy.call( this, source );\n\n\t\t\tthis.distance = source.distance;\n\t\t\tthis.decay = source.decay;\n\n\t\t\tthis.shadow = source.shadow.clone();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author bhouston / http://clara.io\n\t */\n\n\tfunction DirectionalLightShadow( ) {\n\n\t\tvar frustrumWidth = 300;\n\t\tthis.spreadAngle = 0.0;\n\t\tthis.cameraParams = new Vector3( 2*frustrumWidth, 0.5, 1000 );\n\t\tLightShadow.call( this, new OrthographicCamera( - frustrumWidth, frustrumWidth, frustrumWidth, - frustrumWidth, this.cameraParams.y, this.cameraParams.z ) );\n\n\t}\n\n\tDirectionalLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\n\n\t\tconstructor: DirectionalLightShadow\n\n\t} );\n\n\tDirectionalLightShadow.prototype.update = function ( light ) {\n\n\t\tvar camera = this.camera;\n\t\tvar frustrumWidth = Math.abs(camera.left - camera.right);\n\t\tif ( this.cameraParams.x !== frustrumWidth || this.cameraParams.y !== camera.near || this.cameraParams.z !== camera.far ) {\n\n\t\t\tthis.cameraParams.x = frustrumWidth;\n\t\t\tthis.cameraParams.y = camera.near;\n\t\t\tthis.cameraParams.z = camera.far;\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction DirectionalLight( color, intensity ) {\n\n\t\tLight.call( this, color, intensity );\n\n\t\tthis.type = 'DirectionalLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.shadow = new DirectionalLightShadow();\n\n\t}\n\n\tDirectionalLight.prototype = Object.assign( Object.create( Light.prototype ), {\n\n\t\tconstructor: DirectionalLight,\n\n\t\tisDirectionalLight: true,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tLight.prototype.copy.call( this, source );\n\n\t\t\tthis.target = source.target.clone();\n\n\t\t\tthis.shadow = source.shadow.clone();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction AmbientLight( color, intensity ) {\n\n\t\tLight.call( this, color, intensity );\n\n\t\tthis.type = 'AmbientLight';\n\n\t\tthis.castShadow = undefined;\n\n\t}\n\n\tAmbientLight.prototype = Object.assign( Object.create( Light.prototype ), {\n\n\t\tconstructor: AmbientLight,\n\n\t\tisAmbientLight: true\n\n\t} );\n\n\t/**\n\t * @author tschw\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t */\n\n\tvar AnimationUtils = {\n\n\t\t// same as Array.prototype.slice, but also works on typed arrays\n\t\tarraySlice: function( array, from, to ) {\n\n\t\t\tif ( AnimationUtils.isTypedArray( array ) ) {\n\n\t\t\t\treturn new array.constructor( array.subarray( from, to ) );\n\n\t\t\t}\n\n\t\t\treturn array.slice( from, to );\n\n\t\t},\n\n\t\t// converts an array to a specific type\n\t\tconvertArray: function( array, type, forceClone ) {\n\n\t\t\tif ( ! array || // let 'undefined' and 'null' pass\n\t\t\t\t\t! forceClone && array.constructor === type ) return array;\n\n\t\t\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\n\n\t\t\t\treturn new type( array ); // create typed array\n\n\t\t\t}\n\n\t\t\treturn Array.prototype.slice.call( array ); // create Array\n\n\t\t},\n\n\t\tisTypedArray: function( object ) {\n\n\t\t\treturn ArrayBuffer.isView( object ) &&\n\t\t\t\t\t! ( object instanceof DataView );\n\n\t\t},\n\n\t\t// returns an array by which times and values can be sorted\n\t\tgetKeyframeOrder: function( times ) {\n\n\t\t\tfunction compareTime( i, j ) {\n\n\t\t\t\treturn times[ i ] - times[ j ];\n\n\t\t\t}\n\n\t\t\tvar n = times.length;\n\t\t\tvar result = new Array( n );\n\t\t\tfor ( var i = 0; i !== n; ++ i ) result[ i ] = i;\n\n\t\t\tresult.sort( compareTime );\n\n\t\t\treturn result;\n\n\t\t},\n\n\t\t// uses the array previously returned by 'getKeyframeOrder' to sort data\n\t\tsortedArray: function( values, stride, order ) {\n\n\t\t\tvar nValues = values.length;\n\t\t\tvar result = new values.constructor( nValues );\n\n\t\t\tfor ( var i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\n\n\t\t\t\tvar srcOffset = order[ i ] * stride;\n\n\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t},\n\n\t\t// function for parsing AOS keyframe formats\n\t\tflattenJSON: function( jsonKeys, times, values, valuePropertyName ) {\n\n\t\t\tvar i = 1, key = jsonKeys[ 0 ];\n\n\t\t\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t}\n\n\t\t\tif ( key === undefined ) return; // no data\n\n\t\t\tvar value = key[ valuePropertyName ];\n\t\t\tif ( value === undefined ) return; // no data\n\n\t\t\tif ( Array.isArray( value ) ) {\n\n\t\t\t\tdo {\n\n\t\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\t\tvalues.push.apply( values, value ); // push all elements\n\n\t\t\t\t\t}\n\n\t\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t\t} while ( key !== undefined );\n\n\t\t\t} else if ( value.toArray !== undefined ) {\n\t\t\t\t// ...assume THREE.Math-ish\n\n\t\t\t\tdo {\n\n\t\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\t\tvalue.toArray( values, values.length );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t\t} while ( key !== undefined );\n\n\t\t\t} else {\n\t\t\t\t// otherwise push as-is\n\n\t\t\t\tdo {\n\n\t\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\t\tvalues.push( value );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t\t} while ( key !== undefined );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\t/**\n\t * Abstract base class of interpolants over parametric samples.\n\t *\n\t * The parameter domain is one dimensional, typically the time or a path\n\t * along a curve defined by the data.\n\t *\n\t * The sample values can have any dimensionality and derived classes may\n\t * apply special interpretations to the data.\n\t *\n\t * This class provides the interval seek in a Template Method, deferring\n\t * the actual interpolation to derived classes.\n\t *\n\t * Time complexity is O(1) for linear access crossing at most two points\n\t * and O(log N) for random access, where N is the number of positions.\n\t *\n\t * References:\n\t *\n\t * \t\thttp://www.oodesign.com/template-method-pattern.html\n\t *\n\t * @author tschw\n\t */\n\n\tfunction Interpolant(\n\t\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tthis.parameterPositions = parameterPositions;\n\t\tthis._cachedIndex = 0;\n\n\t\tthis.resultBuffer = resultBuffer !== undefined ?\n\t\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\n\t\tthis.sampleValues = sampleValues;\n\t\tthis.valueSize = sampleSize;\n\n\t}\n\n\tInterpolant.prototype = {\n\n\t\tconstructor: Interpolant,\n\n\t\tevaluate: function( t ) {\n\n\t\t\tvar pp = this.parameterPositions,\n\t\t\t\ti1 = this._cachedIndex,\n\n\t\t\t\tt1 = pp[   i1   ],\n\t\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\t\tvalidate_interval: {\n\n\t\t\t\tseek: {\n\n\t\t\t\t\tvar right;\n\n\t\t\t\t\tlinear_scan: {\n\t//- See http://jsperf.com/comparison-to-undefined/3\n\t//- slower code:\n\t//-\n\t//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\n\t\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\n\n\t\t\t\t\t\t\tfor ( var giveUpAt = i1 + 2; ;) {\n\n\t\t\t\t\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\n\n\t\t\t\t\t\t\t\t\t// after end\n\n\t\t\t\t\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t, t0 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\t\tt0 = t1;\n\t\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\n\n\t\t\t\t\t\t\t\tif ( t < t1 ) {\n\n\t\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// prepare binary search on the right side of the index\n\t\t\t\t\t\t\tright = pp.length;\n\t\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t\t}\n\n\t//- slower code:\n\t//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\n\t\t\t\t\t\tif ( ! ( t >= t0 ) ) {\n\n\t\t\t\t\t\t\t// looping?\n\n\t\t\t\t\t\t\tvar t1global = pp[ 1 ];\n\n\t\t\t\t\t\t\tif ( t < t1global ) {\n\n\t\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\n\t\t\t\t\t\t\t\tt0 = t1global;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// linear reverse scan\n\n\t\t\t\t\t\t\tfor ( var giveUpAt = i1 - 2; ;) {\n\n\t\t\t\t\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\t\t\t\t\t// before start\n\n\t\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\t\tt1 = t0;\n\t\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\n\n\t\t\t\t\t\t\t\tif ( t >= t0 ) {\n\n\t\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// prepare binary search on the left side of the index\n\t\t\t\t\t\t\tright = i1;\n\t\t\t\t\t\t\ti1 = 0;\n\t\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// the interval is valid\n\n\t\t\t\t\t\tbreak validate_interval;\n\n\t\t\t\t\t} // linear scan\n\n\t\t\t\t\t// binary search\n\n\t\t\t\t\twhile ( i1 < right ) {\n\n\t\t\t\t\t\tvar mid = ( i1 + right ) >>> 1;\n\n\t\t\t\t\t\tif ( t < pp[ mid ] ) {\n\n\t\t\t\t\t\t\tright = mid;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ti1 = mid + 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tt1 = pp[   i1   ];\n\t\t\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\t\t\t\t// check boundary cases, again\n\n\t\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t0, t );\n\n\t\t\t\t\t}\n\n\t\t\t\t} // seek\n\n\t\t\t\tthis._cachedIndex = i1;\n\n\t\t\t\tthis.intervalChanged_( i1, t0, t1 );\n\n\t\t\t} // validate_interval\n\n\t\t\treturn this.interpolate_( i1, t0, t, t1 );\n\n\t\t},\n\n\t\tsettings: null, // optional, subclass-specific settings structure\n\t\t// Note: The indirection allows central control of many interpolants.\n\n\t\t// --- Protected interface\n\n\t\tDefaultSettings_: {},\n\n\t\tgetSettings_: function() {\n\n\t\t\treturn this.settings || this.DefaultSettings_;\n\n\t\t},\n\n\t\tcopySampleValue_: function( index ) {\n\n\t\t\t// copies a sample value to the result buffer\n\n\t\t\tvar result = this.resultBuffer,\n\t\t\t\tvalues = this.sampleValues,\n\t\t\t\tstride = this.valueSize,\n\t\t\t\toffset = index * stride;\n\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t},\n\n\t\t// Template methods for derived classes:\n\n\t\tinterpolate_: function( i1, t0, t, t1 ) {\n\n\t\t\tthrow new Error( \"call to abstract method\" );\n\t\t\t// implementations shall return this.resultBuffer\n\n\t\t},\n\n\t\tintervalChanged_: function( i1, t0, t1 ) {\n\n\t\t\t// empty\n\n\t\t}\n\n\t};\n\n\tObject.assign( Interpolant.prototype, {\n\n\t\tbeforeStart_: //( 0, t, t0 ), returns this.resultBuffer\n\t\t\tInterpolant.prototype.copySampleValue_,\n\n\t\tafterEnd_: //( N-1, tN-1, t ), returns this.resultBuffer\n\t\t\tInterpolant.prototype.copySampleValue_\n\n\t} );\n\n\t/**\n\t * Fast and simple cubic spline interpolant.\n\t *\n\t * It was derived from a Hermitian construction setting the first derivative\n\t * at each sample position to the linear slope between neighboring positions\n\t * over their parameter interval.\n\t *\n\t * @author tschw\n\t */\n\n\tfunction CubicInterpolant(\n\t\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tInterpolant.call(\n\t\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t\tthis._weightPrev = -0;\n\t\tthis._offsetPrev = -0;\n\t\tthis._weightNext = -0;\n\t\tthis._offsetNext = -0;\n\n\t}\n\n\tCubicInterpolant.prototype =\n\t\t\tObject.assign( Object.create( Interpolant.prototype ), {\n\n\t\tconstructor: CubicInterpolant,\n\n\t\tDefaultSettings_: {\n\n\t\t\tendingStart: \tZeroCurvatureEnding,\n\t\t\tendingEnd:\t\tZeroCurvatureEnding\n\n\t\t},\n\n\t\tintervalChanged_: function( i1, t0, t1 ) {\n\n\t\t\tvar pp = this.parameterPositions,\n\t\t\t\tiPrev = i1 - 2,\n\t\t\t\tiNext = i1 + 1,\n\n\t\t\t\ttPrev = pp[ iPrev ],\n\t\t\t\ttNext = pp[ iNext ];\n\n\t\t\tif ( tPrev === undefined ) {\n\n\t\t\t\tswitch ( this.getSettings_().endingStart ) {\n\n\t\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t\t// f'(t0) = 0\n\t\t\t\t\t\tiPrev = i1;\n\t\t\t\t\t\ttPrev = 2 * t0 - t1;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\t\tiPrev = pp.length - 2;\n\t\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\n\t\t\t\t\t\tiPrev = i1;\n\t\t\t\t\t\ttPrev = t1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( tNext === undefined ) {\n\n\t\t\t\tswitch ( this.getSettings_().endingEnd ) {\n\n\t\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t\t// f'(tN) = 0\n\t\t\t\t\t\tiNext = i1;\n\t\t\t\t\t\ttNext = 2 * t1 - t0;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\t\tiNext = 1;\n\t\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\n\t\t\t\t\t\tiNext = i1 - 1;\n\t\t\t\t\t\ttNext = t0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar halfDt = ( t1 - t0 ) * 0.5,\n\t\t\t\tstride = this.valueSize;\n\n\t\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\n\t\t\tthis._weightNext = halfDt / ( tNext - t1 );\n\t\t\tthis._offsetPrev = iPrev * stride;\n\t\t\tthis._offsetNext = iNext * stride;\n\n\t\t},\n\n\t\tinterpolate_: function( i1, t0, t, t1 ) {\n\n\t\t\tvar result = this.resultBuffer,\n\t\t\t\tvalues = this.sampleValues,\n\t\t\t\tstride = this.valueSize,\n\n\t\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\n\t\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\n\t\t\t\twP = this._weightPrev,\twN = this._weightNext,\n\n\t\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\n\t\t\t\tpp = p * p,\n\t\t\t\tppp = pp * p;\n\n\t\t\t// evaluate polynomials\n\n\t\t\tvar sP =     - wP   * ppp   +         2 * wP    * pp    -          wP   * p;\n\t\t\tvar s0 = ( 1 + wP ) * ppp   + (-1.5 - 2 * wP )  * pp    + ( -0.5 + wP ) * p     + 1;\n\t\t\tvar s1 = (-1 - wN ) * ppp   + ( 1.5 +   wN   )  * pp    +    0.5        * p;\n\t\t\tvar sN =       wN   * ppp   -           wN      * pp;\n\n\t\t\t// combine data linearly\n\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tresult[ i ] =\n\t\t\t\t\t\tsP * values[ oP + i ] +\n\t\t\t\t\t\ts0 * values[ o0 + i ] +\n\t\t\t\t\t\ts1 * values[ o1 + i ] +\n\t\t\t\t\t\tsN * values[ oN + i ];\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author tschw\n\t */\n\n\tfunction LinearInterpolant(\n\t\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tInterpolant.call(\n\t\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tLinearInterpolant.prototype =\n\t\t\tObject.assign( Object.create( Interpolant.prototype ), {\n\n\t\tconstructor: LinearInterpolant,\n\n\t\tinterpolate_: function( i1, t0, t, t1 ) {\n\n\t\t\tvar result = this.resultBuffer,\n\t\t\t\tvalues = this.sampleValues,\n\t\t\t\tstride = this.valueSize,\n\n\t\t\t\toffset1 = i1 * stride,\n\t\t\t\toffset0 = offset1 - stride,\n\n\t\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\n\t\t\t\tweight0 = 1 - weight1;\n\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tresult[ i ] =\n\t\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\n\t\t\t\t\t\tvalues[ offset1 + i ] * weight1;\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t *\n\t * Interpolant that evaluates to the sample value at the position preceeding\n\t * the parameter.\n\t *\n\t * @author tschw\n\t */\n\n\tfunction DiscreteInterpolant(\n\t\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tInterpolant.call(\n\t\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tDiscreteInterpolant.prototype =\n\t\t\tObject.assign( Object.create( Interpolant.prototype ), {\n\n\t\tconstructor: DiscreteInterpolant,\n\n\t\tinterpolate_: function( i1, t0, t, t1 ) {\n\n\t\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t\t}\n\n\t} );\n\n\tvar KeyframeTrackPrototype;\n\n\tKeyframeTrackPrototype = {\n\n\t\tTimeBufferType: Float32Array,\n\t\tValueBufferType: Float32Array,\n\n\t\tDefaultInterpolation: InterpolateLinear,\n\n\t\tInterpolantFactoryMethodDiscrete: function ( result ) {\n\n\t\t\treturn new DiscreteInterpolant(\n\t\t\t\t\tthis.times, this.values, this.getValueSize(), result );\n\n\t\t},\n\n\t\tInterpolantFactoryMethodLinear: function ( result ) {\n\n\t\t\treturn new LinearInterpolant(\n\t\t\t\t\tthis.times, this.values, this.getValueSize(), result );\n\n\t\t},\n\n\t\tInterpolantFactoryMethodSmooth: function ( result ) {\n\n\t\t\treturn new CubicInterpolant(\n\t\t\t\t\tthis.times, this.values, this.getValueSize(), result );\n\n\t\t},\n\n\t\tsetInterpolation: function ( interpolation ) {\n\n\t\t\tvar factoryMethod;\n\n\t\t\tswitch ( interpolation ) {\n\n\t\t\t\tcase InterpolateDiscrete:\n\n\t\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase InterpolateLinear:\n\n\t\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase InterpolateSmooth:\n\n\t\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( factoryMethod === undefined ) {\n\n\t\t\t\tvar message = \"unsupported interpolation for \" +\n\t\t\t\t\t\tthis.ValueTypeName + \" keyframe track named \" + this.name;\n\n\t\t\t\tif ( this.createInterpolant === undefined ) {\n\n\t\t\t\t\t// fall back to default, unless the default itself is messed up\n\t\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\n\n\t\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthrow new Error( message ); // fatal, in this case\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tconsole.warn( message );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tthis.createInterpolant = factoryMethod;\n\n\t\t},\n\n\t\tgetInterpolation: function () {\n\n\t\t\tswitch ( this.createInterpolant ) {\n\n\t\t\t\tcase this.InterpolantFactoryMethodDiscrete:\n\n\t\t\t\t\treturn InterpolateDiscrete;\n\n\t\t\t\tcase this.InterpolantFactoryMethodLinear:\n\n\t\t\t\t\treturn InterpolateLinear;\n\n\t\t\t\tcase this.InterpolantFactoryMethodSmooth:\n\n\t\t\t\t\treturn InterpolateSmooth;\n\n\t\t\t}\n\n\t\t},\n\n\t\tgetValueSize: function () {\n\n\t\t\treturn this.values.length / this.times.length;\n\n\t\t},\n\n\t\t// move all keyframes either forwards or backwards in time\n\t\tshift: function ( timeOffset ) {\n\n\t\t\tif ( timeOffset !== 0.0 ) {\n\n\t\t\t\tvar times = this.times;\n\n\t\t\t\tfor ( var i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\t\ttimes[ i ] += timeOffset;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\n\t\tscale: function ( timeScale ) {\n\n\t\t\tif ( timeScale !== 1.0 ) {\n\n\t\t\t\tvar times = this.times;\n\n\t\t\t\tfor ( var i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\t\ttimes[ i ] *= timeScale;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\n\t\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\n\t\ttrim: function ( startTime, endTime ) {\n\n\t\t\tvar times = this.times,\n\t\t\t\tnKeys = times.length,\n\t\t\t\tfrom = 0,\n\t\t\t\tto = nKeys - 1;\n\n\t\t\twhile ( from !== nKeys && times[ from ] < startTime ) ++ from;\n\t\t\twhile ( to !== - 1 && times[ to ] > endTime ) -- to;\n\n\t\t\t++ to; // inclusive -> exclusive bound\n\n\t\t\tif ( from !== 0 || to !== nKeys ) {\n\n\t\t\t\t// empty tracks are forbidden, so keep at least one keyframe\n\t\t\t\tif ( from >= to ) to = Math.max( to, 1 ), from = to - 1;\n\n\t\t\t\tvar stride = this.getValueSize();\n\t\t\t\tthis.times = AnimationUtils.arraySlice( times, from, to );\n\t\t\t\tthis.values = AnimationUtils.\n\t\t\t\t\t\tarraySlice( this.values, from * stride, to * stride );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\n\t\tvalidate: function () {\n\n\t\t\tvar valid = true;\n\n\t\t\tvar valueSize = this.getValueSize();\n\t\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\n\n\t\t\t\tconsole.error( \"invalid value size in track\", this );\n\t\t\t\tvalid = false;\n\n\t\t\t}\n\n\t\t\tvar times = this.times,\n\t\t\t\tvalues = this.values,\n\n\t\t\t\tnKeys = times.length;\n\n\t\t\tif ( nKeys === 0 ) {\n\n\t\t\t\tconsole.error( \"track is empty\", this );\n\t\t\t\tvalid = false;\n\n\t\t\t}\n\n\t\t\tvar prevTime = null;\n\n\t\t\tfor ( var i = 0; i !== nKeys; i ++ ) {\n\n\t\t\t\tvar currTime = times[ i ];\n\n\t\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\n\n\t\t\t\t\tconsole.error( \"time is not a valid number\", this, i, currTime );\n\t\t\t\t\tvalid = false;\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tif ( prevTime !== null && prevTime > currTime ) {\n\n\t\t\t\t\tconsole.error( \"out of order keys\", this, i, currTime, prevTime );\n\t\t\t\t\tvalid = false;\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tprevTime = currTime;\n\n\t\t\t}\n\n\t\t\tif ( values !== undefined ) {\n\n\t\t\t\tif ( AnimationUtils.isTypedArray( values ) ) {\n\n\t\t\t\t\tfor ( var i = 0, n = values.length; i !== n; ++ i ) {\n\n\t\t\t\t\t\tvar value = values[ i ];\n\n\t\t\t\t\t\tif ( isNaN( value ) ) {\n\n\t\t\t\t\t\t\tconsole.error( \"value is not a valid number\", this, i, value );\n\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn valid;\n\n\t\t},\n\n\t\t// removes equivalent sequential keys as common in morph target sequences\n\t\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\n\t\toptimize: function () {\n\n\t\t\tvar times = this.times,\n\t\t\t\tvalues = this.values,\n\t\t\t\tstride = this.getValueSize(),\n\n\t\t\t\tsmoothInterpolation = this.getInterpolation() === InterpolateSmooth,\n\n\t\t\t\twriteIndex = 1,\n\t\t\t\tlastIndex = times.length - 1;\n\n\t\t\tfor ( var i = 1; i < lastIndex; ++ i ) {\n\n\t\t\t\tvar keep = false;\n\n\t\t\t\tvar time = times[ i ];\n\t\t\t\tvar timeNext = times[ i + 1 ];\n\n\t\t\t\t// remove adjacent keyframes scheduled at the same time\n\n\t\t\t\tif ( time !== timeNext && ( i !== 1 || time !== time[ 0 ] ) ) {\n\n\t\t\t\t\tif ( ! smoothInterpolation ) {\n\n\t\t\t\t\t\t// remove unnecessary keyframes same as their neighbors\n\n\t\t\t\t\t\tvar offset = i * stride,\n\t\t\t\t\t\t\toffsetP = offset - stride,\n\t\t\t\t\t\t\toffsetN = offset + stride;\n\n\t\t\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\t\tvar value = values[ offset + j ];\n\n\t\t\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\n\t\t\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\n\n\t\t\t\t\t\t\t\tkeep = true;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else keep = true;\n\n\t\t\t\t}\n\n\t\t\t\t// in-place compaction\n\n\t\t\t\tif ( keep ) {\n\n\t\t\t\t\tif ( i !== writeIndex ) {\n\n\t\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\n\n\t\t\t\t\t\tvar readOffset = i * stride,\n\t\t\t\t\t\t\twriteOffset = writeIndex * stride;\n\n\t\t\t\t\t\tfor ( var j = 0; j !== stride; ++ j )\n\n\t\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\t++ writeIndex;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// flush last keyframe (compaction looks ahead)\n\n\t\t\tif ( lastIndex > 0 ) {\n\n\t\t\t\ttimes[ writeIndex ] = times[ lastIndex ];\n\n\t\t\t\tfor ( var readOffset = lastIndex * stride, writeOffset = writeIndex * stride, j = 0; j !== stride; ++ j )\n\n\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t\t++ writeIndex;\n\n\t\t\t}\n\n\t\t\tif ( writeIndex !== times.length ) {\n\n\t\t\t\tthis.times = AnimationUtils.arraySlice( times, 0, writeIndex );\n\t\t\t\tthis.values = AnimationUtils.arraySlice( values, 0, writeIndex * stride );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\tfunction KeyframeTrackConstructor( name, times, values, interpolation ) {\n\n\t\tif( name === undefined ) throw new Error( \"track name is undefined\" );\n\n\t\tif( times === undefined || times.length === 0 ) {\n\n\t\t\tthrow new Error( \"no keyframes in track named \" + name );\n\n\t\t}\n\n\t\tthis.name = name;\n\n\t\tthis.times = AnimationUtils.convertArray( times, this.TimeBufferType );\n\t\tthis.values = AnimationUtils.convertArray( values, this.ValueBufferType );\n\n\t\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\n\n\t\tthis.validate();\n\t\tthis.optimize();\n\n\t}\n\n\t/**\n\t *\n\t * A Track of vectored keyframe values.\n\t *\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction VectorKeyframeTrack( name, times, values, interpolation ) {\n\n\t\tKeyframeTrackConstructor.call( this, name, times, values, interpolation );\n\n\t}\n\n\tVectorKeyframeTrack.prototype =\n\t\t\tObject.assign( Object.create( KeyframeTrackPrototype ), {\n\n\t\tconstructor: VectorKeyframeTrack,\n\n\t\tValueTypeName: 'vector'\n\n\t\t// ValueBufferType is inherited\n\n\t\t// DefaultInterpolation is inherited\n\n\t} );\n\n\t/**\n\t * Spherical linear unit quaternion interpolant.\n\t *\n\t * @author tschw\n\t */\n\n\tfunction QuaternionLinearInterpolant(\n\t\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tInterpolant.call(\n\t\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tQuaternionLinearInterpolant.prototype =\n\t\t\tObject.assign( Object.create( Interpolant.prototype ), {\n\n\t\tconstructor: QuaternionLinearInterpolant,\n\n\t\tinterpolate_: function( i1, t0, t, t1 ) {\n\n\t\t\tvar result = this.resultBuffer,\n\t\t\t\tvalues = this.sampleValues,\n\t\t\t\tstride = this.valueSize,\n\n\t\t\t\toffset = i1 * stride,\n\n\t\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\n\n\t\t\tfor ( var end = offset + stride; offset !== end; offset += 4 ) {\n\n\t\t\t\tQuaternion.slerpFlat( result, 0,\n\t\t\t\t\t\tvalues, offset - stride, values, offset, alpha );\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t *\n\t * A Track of quaternion keyframe values.\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction QuaternionKeyframeTrack( name, times, values, interpolation ) {\n\n\t\tKeyframeTrackConstructor.call( this, name, times, values, interpolation );\n\n\t}\n\n\tQuaternionKeyframeTrack.prototype =\n\t\t\tObject.assign( Object.create( KeyframeTrackPrototype ), {\n\n\t\tconstructor: QuaternionKeyframeTrack,\n\n\t\tValueTypeName: 'quaternion',\n\n\t\t// ValueBufferType is inherited\n\n\t\tDefaultInterpolation: InterpolateLinear,\n\n\t\tInterpolantFactoryMethodLinear: function( result ) {\n\n\t\t\treturn new QuaternionLinearInterpolant(\n\t\t\t\t\tthis.times, this.values, this.getValueSize(), result );\n\n\t\t},\n\n\t\tInterpolantFactoryMethodSmooth: undefined // not yet implemented\n\n\t} );\n\n\t/**\n\t *\n\t * A Track of numeric keyframe values.\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction NumberKeyframeTrack( name, times, values, interpolation ) {\n\n\t\tKeyframeTrackConstructor.call( this, name, times, values, interpolation );\n\n\t}\n\n\tNumberKeyframeTrack.prototype =\n\t\t\tObject.assign( Object.create( KeyframeTrackPrototype ), {\n\n\t\tconstructor: NumberKeyframeTrack,\n\n\t\tValueTypeName: 'number'\n\n\t\t// ValueBufferType is inherited\n\n\t\t// DefaultInterpolation is inherited\n\n\t} );\n\n\t/**\n\t *\n\t * A Track that interpolates Strings\n\t *\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction StringKeyframeTrack( name, times, values, interpolation ) {\n\n\t\tKeyframeTrackConstructor.call( this, name, times, values, interpolation );\n\n\t}\n\n\tStringKeyframeTrack.prototype =\n\t\t\tObject.assign( Object.create( KeyframeTrackPrototype ), {\n\n\t\tconstructor: StringKeyframeTrack,\n\n\t\tValueTypeName: 'string',\n\t\tValueBufferType: Array,\n\n\t\tDefaultInterpolation: InterpolateDiscrete,\n\n\t\tInterpolantFactoryMethodLinear: undefined,\n\n\t\tInterpolantFactoryMethodSmooth: undefined\n\n\t} );\n\n\t/**\n\t *\n\t * A Track of Boolean keyframe values.\n\t *\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction BooleanKeyframeTrack( name, times, values ) {\n\n\t\tKeyframeTrackConstructor.call( this, name, times, values );\n\n\t}\n\n\tBooleanKeyframeTrack.prototype =\n\t\t\tObject.assign( Object.create( KeyframeTrackPrototype ), {\n\n\t\tconstructor: BooleanKeyframeTrack,\n\n\t\tValueTypeName: 'bool',\n\t\tValueBufferType: Array,\n\n\t\tDefaultInterpolation: InterpolateDiscrete,\n\n\t\tInterpolantFactoryMethodLinear: undefined,\n\t\tInterpolantFactoryMethodSmooth: undefined\n\n\t\t// Note: Actually this track could have a optimized / compressed\n\t\t// representation of a single value and a custom interpolant that\n\t\t// computes \"firstValue ^ isOdd( index )\".\n\n\t} );\n\n\t/**\n\t *\n\t * A Track of keyframe values that represent color.\n\t *\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction ColorKeyframeTrack( name, times, values, interpolation ) {\n\n\t\tKeyframeTrackConstructor.call( this, name, times, values, interpolation );\n\n\t}\n\n\tColorKeyframeTrack.prototype =\n\t\t\tObject.assign( Object.create( KeyframeTrackPrototype ), {\n\n\t\tconstructor: ColorKeyframeTrack,\n\n\t\tValueTypeName: 'color'\n\n\t\t// ValueBufferType is inherited\n\n\t\t// DefaultInterpolation is inherited\n\n\n\t\t// Note: Very basic implementation and nothing special yet.\n\t\t// However, this is the place for color space parameterization.\n\n\t} );\n\n\t/**\n\t *\n\t * A timed sequence of keyframes for a specific property.\n\t *\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction KeyframeTrack( name, times, values, interpolation ) {\n\n\t\tKeyframeTrackConstructor.apply( this, arguments );\n\n\t}\n\n\tKeyframeTrack.prototype = KeyframeTrackPrototype;\n\tKeyframeTrackPrototype.constructor = KeyframeTrack;\n\n\t// Static methods:\n\n\tObject.assign( KeyframeTrack, {\n\n\t\t// Serialization (in static context, because of constructor invocation\n\t\t// and automatic invocation of .toJSON):\n\n\t\tparse: function( json ) {\n\n\t\t\tif( json.type === undefined ) {\n\n\t\t\t\tthrow new Error( \"track type undefined, can not parse\" );\n\n\t\t\t}\n\n\t\t\tvar trackType = KeyframeTrack._getTrackTypeForValueTypeName( json.type );\n\n\t\t\tif ( json.times === undefined ) {\n\n\t\t\t\tvar times = [], values = [];\n\n\t\t\t\tAnimationUtils.flattenJSON( json.keys, times, values, 'value' );\n\n\t\t\t\tjson.times = times;\n\t\t\t\tjson.values = values;\n\n\t\t\t}\n\n\t\t\t// derived classes can define a static parse method\n\t\t\tif ( trackType.parse !== undefined ) {\n\n\t\t\t\treturn trackType.parse( json );\n\n\t\t\t} else {\n\n\t\t\t\t// by default, we asssume a constructor compatible with the base\n\t\t\t\treturn new trackType(\n\t\t\t\t\t\tjson.name, json.times, json.values, json.interpolation );\n\n\t\t\t}\n\n\t\t},\n\n\t\ttoJSON: function( track ) {\n\n\t\t\tvar trackType = track.constructor;\n\n\t\t\tvar json;\n\n\t\t\t// derived classes can define a static toJSON method\n\t\t\tif ( trackType.toJSON !== undefined ) {\n\n\t\t\t\tjson = trackType.toJSON( track );\n\n\t\t\t} else {\n\n\t\t\t\t// by default, we assume the data can be serialized as-is\n\t\t\t\tjson = {\n\n\t\t\t\t\t'name': track.name,\n\t\t\t\t\t'times': AnimationUtils.convertArray( track.times, Array ),\n\t\t\t\t\t'values': AnimationUtils.convertArray( track.values, Array )\n\n\t\t\t\t};\n\n\t\t\t\tvar interpolation = track.getInterpolation();\n\n\t\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\n\n\t\t\t\t\tjson.interpolation = interpolation;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tjson.type = track.ValueTypeName; // mandatory\n\n\t\t\treturn json;\n\n\t\t},\n\n\t\t_getTrackTypeForValueTypeName: function( typeName ) {\n\n\t\t\tswitch( typeName.toLowerCase() ) {\n\n\t\t\t\tcase \"scalar\":\n\t\t\t\tcase \"double\":\n\t\t\t\tcase \"float\":\n\t\t\t\tcase \"number\":\n\t\t\t\tcase \"integer\":\n\n\t\t\t\t\treturn NumberKeyframeTrack;\n\n\t\t\t\tcase \"vector\":\n\t\t\t\tcase \"vector2\":\n\t\t\t\tcase \"vector3\":\n\t\t\t\tcase \"vector4\":\n\n\t\t\t\t\treturn VectorKeyframeTrack;\n\n\t\t\t\tcase \"color\":\n\n\t\t\t\t\treturn ColorKeyframeTrack;\n\n\t\t\t\tcase \"quaternion\":\n\n\t\t\t\t\treturn QuaternionKeyframeTrack;\n\n\t\t\t\tcase \"bool\":\n\t\t\t\tcase \"boolean\":\n\n\t\t\t\t\treturn BooleanKeyframeTrack;\n\n\t\t\t\tcase \"string\":\n\n\t\t\t\t\treturn StringKeyframeTrack;\n\n\t\t\t}\n\n\t\t\tthrow new Error( \"Unsupported typeName: \" + typeName );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t *\n\t * Reusable set of Tracks that represent an animation.\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t */\n\n\tfunction AnimationClip( name, duration, tracks ) {\n\n\t\tthis.name = name;\n\t\tthis.tracks = tracks;\n\t\tthis.duration = ( duration !== undefined ) ? duration : -1;\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\t// this means it should figure out its duration by scanning the tracks\n\t\tif ( this.duration < 0 ) {\n\n\t\t\tthis.resetDuration();\n\n\t\t}\n\n\t\tthis.optimize();\n\n\t}\n\n\tAnimationClip.prototype = {\n\n\t\tconstructor: AnimationClip,\n\n\t\tresetDuration: function() {\n\n\t\t\tvar tracks = this.tracks,\n\t\t\t\tduration = 0;\n\n\t\t\tfor ( var i = 0, n = tracks.length; i !== n; ++ i ) {\n\n\t\t\t\tvar track = this.tracks[ i ];\n\n\t\t\t\tduration = Math.max( duration, track.times[ track.times.length - 1 ] );\n\n\t\t\t}\n\n\t\t\tthis.duration = duration;\n\n\t\t},\n\n\t\ttrim: function() {\n\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\t\tthis.tracks[ i ].trim( 0, this.duration );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\toptimize: function() {\n\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\t\tthis.tracks[ i ].optimize();\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t// Static methods:\n\n\tObject.assign( AnimationClip, {\n\n\t\tparse: function( json ) {\n\n\t\t\tvar tracks = [],\n\t\t\t\tjsonTracks = json.tracks,\n\t\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\n\n\t\t\tfor ( var i = 0, n = jsonTracks.length; i !== n; ++ i ) {\n\n\t\t\t\ttracks.push( KeyframeTrack.parse( jsonTracks[ i ] ).scale( frameTime ) );\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( json.name, json.duration, tracks );\n\n\t\t},\n\n\n\t\ttoJSON: function( clip ) {\n\n\t\t\tvar tracks = [],\n\t\t\t\tclipTracks = clip.tracks;\n\n\t\t\tvar json = {\n\n\t\t\t\t'name': clip.name,\n\t\t\t\t'duration': clip.duration,\n\t\t\t\t'tracks': tracks\n\n\t\t\t};\n\n\t\t\tfor ( var i = 0, n = clipTracks.length; i !== n; ++ i ) {\n\n\t\t\t\ttracks.push( KeyframeTrack.toJSON( clipTracks[ i ] ) );\n\n\t\t\t}\n\n\t\t\treturn json;\n\n\t\t},\n\n\n\t\tCreateFromMorphTargetSequence: function( name, morphTargetSequence, fps, noLoop ) {\n\n\t\t\tvar numMorphTargets = morphTargetSequence.length;\n\t\t\tvar tracks = [];\n\n\t\t\tfor ( var i = 0; i < numMorphTargets; i ++ ) {\n\n\t\t\t\tvar times = [];\n\t\t\t\tvar values = [];\n\n\t\t\t\ttimes.push(\n\t\t\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\n\t\t\t\t\t\ti,\n\t\t\t\t\t\t( i + 1 ) % numMorphTargets );\n\n\t\t\t\tvalues.push( 0, 1, 0 );\n\n\t\t\t\tvar order = AnimationUtils.getKeyframeOrder( times );\n\t\t\t\ttimes = AnimationUtils.sortedArray( times, 1, order );\n\t\t\t\tvalues = AnimationUtils.sortedArray( values, 1, order );\n\n\t\t\t\t// if there is a key at the first frame, duplicate it as the\n\t\t\t\t// last frame as well for perfect loop.\n\t\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\n\n\t\t\t\t\ttimes.push( numMorphTargets );\n\t\t\t\t\tvalues.push( values[ 0 ] );\n\n\t\t\t\t}\n\n\t\t\t\ttracks.push(\n\t\t\t\t\t\tnew NumberKeyframeTrack(\n\t\t\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\n\t\t\t\t\t\t\ttimes, values\n\t\t\t\t\t\t).scale( 1.0 / fps ) );\n\t\t\t}\n\n\t\t\treturn new AnimationClip( name, -1, tracks );\n\n\t\t},\n\n\t\tfindByName: function( objectOrClipArray, name ) {\n\n\t\t\tvar clipArray = objectOrClipArray;\n\n\t\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\n\n\t\t\t\tvar o = objectOrClipArray;\n\t\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < clipArray.length; i ++ ) {\n\n\t\t\t\tif ( clipArray[ i ].name === name ) {\n\n\t\t\t\t\treturn clipArray[ i ];\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t},\n\n\t\tCreateClipsFromMorphTargetSequences: function( morphTargets, fps, noLoop ) {\n\n\t\t\tvar animationToMorphTargets = {};\n\n\t\t\t// tested with https://regex101.com/ on trick sequences\n\t\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\n\t\t\tvar pattern = /^([\\w-]*?)([\\d]+)$/;\n\n\t\t\t// sort morph target names into animation groups based\n\t\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\n\t\t\tfor ( var i = 0, il = morphTargets.length; i < il; i ++ ) {\n\n\t\t\t\tvar morphTarget = morphTargets[ i ];\n\t\t\t\tvar parts = morphTarget.name.match( pattern );\n\n\t\t\t\tif ( parts && parts.length > 1 ) {\n\n\t\t\t\t\tvar name = parts[ 1 ];\n\n\t\t\t\t\tvar animationMorphTargets = animationToMorphTargets[ name ];\n\t\t\t\t\tif ( ! animationMorphTargets ) {\n\n\t\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tanimationMorphTargets.push( morphTarget );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar clips = [];\n\n\t\t\tfor ( var name in animationToMorphTargets ) {\n\n\t\t\t\tclips.push( AnimationClip.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\n\n\t\t\t}\n\n\t\t\treturn clips;\n\n\t\t},\n\n\t\t// parse the animation.hierarchy format\n\t\tparseAnimation: function( animation, bones ) {\n\n\t\t\tif ( ! animation ) {\n\n\t\t\t\tconsole.error( \"  no animation in JSONLoader data\" );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tvar addNonemptyTrack = function(\n\t\t\t\t\ttrackType, trackName, animationKeys, propertyName, destTracks ) {\n\n\t\t\t\t// only return track if there are actually keys.\n\t\t\t\tif ( animationKeys.length !== 0 ) {\n\n\t\t\t\t\tvar times = [];\n\t\t\t\t\tvar values = [];\n\n\t\t\t\t\tAnimationUtils.flattenJSON(\n\t\t\t\t\t\t\tanimationKeys, times, values, propertyName );\n\n\t\t\t\t\t// empty keys are filtered out, so check again\n\t\t\t\t\tif ( times.length !== 0 ) {\n\n\t\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\tvar tracks = [];\n\n\t\t\tvar clipName = animation.name || 'default';\n\t\t\t// automatic length determination in AnimationClip.\n\t\t\tvar duration = animation.length || -1;\n\t\t\tvar fps = animation.fps || 30;\n\n\t\t\tvar hierarchyTracks = animation.hierarchy || [];\n\n\t\t\tfor ( var h = 0; h < hierarchyTracks.length; h ++ ) {\n\n\t\t\t\tvar animationKeys = hierarchyTracks[ h ].keys;\n\n\t\t\t\t// skip empty tracks\n\t\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) continue;\n\n\t\t\t\t// process morph targets in a way exactly compatible\n\t\t\t\t// with AnimationHandler.init( animation )\n\t\t\t\tif ( animationKeys[0].morphTargets ) {\n\n\t\t\t\t\t// figure out all morph targets used in this track\n\t\t\t\t\tvar morphTargetNames = {};\n\t\t\t\t\tfor ( var k = 0; k < animationKeys.length; k ++ ) {\n\n\t\t\t\t\t\tif ( animationKeys[k].morphTargets ) {\n\n\t\t\t\t\t\t\tfor ( var m = 0; m < animationKeys[k].morphTargets.length; m ++ ) {\n\n\t\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[k].morphTargets[m] ] = -1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// create a track for each morph target with all zero\n\t\t\t\t\t// morphTargetInfluences except for the keys in which\n\t\t\t\t\t// the morphTarget is named.\n\t\t\t\t\tfor ( var morphTargetName in morphTargetNames ) {\n\n\t\t\t\t\t\tvar times = [];\n\t\t\t\t\t\tvar values = [];\n\n\t\t\t\t\t\tfor ( var m = 0; m !== animationKeys[k].morphTargets.length; ++ m ) {\n\n\t\t\t\t\t\t\tvar animationKey = animationKeys[k];\n\n\t\t\t\t\t\t\ttimes.push( animationKey.time );\n\t\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttracks.push( new NumberKeyframeTrack('.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tduration = morphTargetNames.length * ( fps || 1.0 );\n\n\t\t\t\t} else {\n\t\t\t\t\t// ...assume skeletal animation\n\n\t\t\t\t\tvar boneName = '.bones[' + bones[ h ].name + ']';\n\n\t\t\t\t\taddNonemptyTrack(\n\t\t\t\t\t\t\tVectorKeyframeTrack, boneName + '.position',\n\t\t\t\t\t\t\tanimationKeys, 'pos', tracks );\n\n\t\t\t\t\taddNonemptyTrack(\n\t\t\t\t\t\t\tQuaternionKeyframeTrack, boneName + '.quaternion',\n\t\t\t\t\t\t\tanimationKeys, 'rot', tracks );\n\n\t\t\t\t\taddNonemptyTrack(\n\t\t\t\t\t\t\tVectorKeyframeTrack, boneName + '.scale',\n\t\t\t\t\t\t\tanimationKeys, 'scl', tracks );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( tracks.length === 0 ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tvar clip = new AnimationClip( clipName, duration, tracks );\n\n\t\t\treturn clip;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction MaterialLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\t\tthis.textures = {};\n\n\t}\n\n\tObject.assign( MaterialLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar loader = new FileLoader( scope.manager );\n\t\t\tloader.load( url, function ( text ) {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\tsetTextures: function ( value ) {\n\n\t\t\tthis.textures = value;\n\n\t\t},\n\n\t\tparse: function ( json ) {\n\n\t\t\tvar textures = this.textures;\n\n\t\t\tfunction getTexture( name ) {\n\n\t\t\t\tif ( textures[ name ] === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\n\n\t\t\t\t}\n\n\t\t\t\treturn textures[ name ];\n\n\t\t\t}\n\n\t\t\tvar material = new Materials[ json.type ]();\n\n\t\t\tif ( json.uuid !== undefined ) material.uuid = json.uuid;\n\t\t\tif ( json.name !== undefined ) material.name = json.name;\n\t\t\tif ( json.color !== undefined ) material.color.setHex( json.color );\n\t\t\tif ( json.roughness !== undefined ) material.roughness = json.roughness;\n\t\t\tif ( json.metalness !== undefined ) material.metalness = json.metalness;\n\t\t\tif ( json.emissive !== undefined ) material.emissive.setHex( json.emissive );\n\t\t\tif ( json.specular !== undefined ) material.specular.setHex( json.specular );\n\t\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\n\t\t\tif ( json.clearCoat !== undefined ) material.clearCoat = json.clearCoat;\n\t\t\tif ( json.clearCoatRoughness !== undefined ) material.clearCoatRoughness = json.clearCoatRoughness;\n\t\t\tif ( json.uniforms !== undefined ) material.uniforms = json.uniforms;\n\t\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\n\t\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\n\t\t\tif ( json.vertexColors !== undefined ) material.vertexColors = json.vertexColors;\n\t\t\tif ( json.fog !== undefined ) material.fog = json.fog;\n\t\t\tif ( json.shading !== undefined ) material.shading = json.shading;\n\t\t\tif ( json.blending !== undefined ) material.blending = json.blending;\n\t\t\tif ( json.side !== undefined ) material.side = json.side;\n\t\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\n\t\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\n\t\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\n\t\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\n\t\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\n\t\t\tif ( json.colorWrite !== undefined ) material.colorWrite = json.colorWrite;\n\t\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\n\t\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\n\t\t\tif ( json.wireframeLinecap !== undefined ) material.wireframeLinecap = json.wireframeLinecap;\n\t\t\tif ( json.wireframeLinejoin !== undefined ) material.wireframeLinejoin = json.wireframeLinejoin;\n\t\t\tif ( json.skinning !== undefined ) material.skinning = json.skinning;\n\t\t\tif ( json.morphTargets !== undefined ) material.morphTargets = json.morphTargets;\n\n\t\t\t// for PointsMaterial\n\n\t\t\tif ( json.size !== undefined ) material.size = json.size;\n\t\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\n\n\t\t\t// maps\n\n\t\t\tif ( json.map !== undefined ) material.map = getTexture( json.map );\n\n\t\t\tif ( json.alphaMap !== undefined ) {\n\n\t\t\t\tmaterial.alphaMap = getTexture( json.alphaMap );\n\t\t\t\tmaterial.transparent = true;\n\n\t\t\t}\n\n\t\t\tif ( json.bumpMap !== undefined ) material.bumpMap = getTexture( json.bumpMap );\n\t\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\n\n\t\t\tif ( json.normalMap !== undefined ) material.normalMap = getTexture( json.normalMap );\n\t\t\tif ( json.normalScale !== undefined ) {\n\n\t\t\t\tvar normalScale = json.normalScale;\n\n\t\t\t\tif ( Array.isArray( normalScale ) === false ) {\n\n\t\t\t\t\t// Blender exporter used to export a scalar. See #7459\n\n\t\t\t\t\tnormalScale = [ normalScale, normalScale ];\n\n\t\t\t\t}\n\n\t\t\t\tmaterial.normalScale = new Vector2().fromArray( normalScale );\n\n\t\t\t}\n\n\t\t\tif ( json.displacementMap !== undefined ) material.displacementMap = getTexture( json.displacementMap );\n\t\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\n\t\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\n\n\t\t\tif ( json.roughnessMap !== undefined ) material.roughnessMap = getTexture( json.roughnessMap );\n\t\t\tif ( json.metalnessMap !== undefined ) material.metalnessMap = getTexture( json.metalnessMap );\n\n\t\t\tif ( json.emissiveMap !== undefined ) material.emissiveMap = getTexture( json.emissiveMap );\n\t\t\tif ( json.emissiveIntensity !== undefined ) material.emissiveIntensity = json.emissiveIntensity;\n\n\t\t\tif ( json.specularMap !== undefined ) material.specularMap = getTexture( json.specularMap );\n\n\t\t\tif ( json.envMap !== undefined ) material.envMap = getTexture( json.envMap );\n\n\t\t\tif ( json.reflectivity !== undefined ) material.reflectivity = json.reflectivity;\n\n\t\t\tif ( json.lightMap !== undefined ) material.lightMap = getTexture( json.lightMap );\n\t\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\n\n\t\t\tif ( json.aoMap !== undefined ) material.aoMap = getTexture( json.aoMap );\n\t\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\n\n\t\t\tif ( json.gradientMap !== undefined ) material.gradientMap = getTexture( json.gradientMap );\n\n\t\t\t// MultiMaterial\n\n\t\t\tif ( json.materials !== undefined ) {\n\n\t\t\t\tfor ( var i = 0, l = json.materials.length; i < l; i ++ ) {\n\n\t\t\t\t\tmaterial.materials.push( this.parse( json.materials[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn material;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction BufferGeometryLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t}\n\n\tObject.assign( BufferGeometryLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar loader = new FileLoader( scope.manager );\n\t\t\tloader.load( url, function ( text ) {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\tparse: function ( json ) {\n\n\t\t\tvar geometry = new BufferGeometry();\n\n\t\t\tvar index = json.data.index;\n\n\t\t\tvar TYPED_ARRAYS = {\n\t\t\t\t'Int8Array': Int8Array,\n\t\t\t\t'Uint8Array': Uint8Array,\n\t\t\t\t'Uint8ClampedArray': Uint8ClampedArray,\n\t\t\t\t'Int16Array': Int16Array,\n\t\t\t\t'Uint16Array': Uint16Array,\n\t\t\t\t'Int32Array': Int32Array,\n\t\t\t\t'Uint32Array': Uint32Array,\n\t\t\t\t'Float32Array': Float32Array,\n\t\t\t\t'Float64Array': Float64Array\n\t\t\t};\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tvar typedArray = new TYPED_ARRAYS[ index.type ]( index.array );\n\t\t\t\tgeometry.setIndex( new BufferAttribute( typedArray, 1 ) );\n\n\t\t\t}\n\n\t\t\tvar attributes = json.data.attributes;\n\n\t\t\tfor ( var key in attributes ) {\n\n\t\t\t\tvar attribute = attributes[ key ];\n\t\t\t\tvar typedArray = new TYPED_ARRAYS[ attribute.type ]( attribute.array );\n\n\t\t\t\tgeometry.addAttribute( key, new BufferAttribute( typedArray, attribute.itemSize, attribute.normalized ) );\n\n\t\t\t}\n\n\t\t\tvar groups = json.data.groups || json.data.drawcalls || json.data.offsets;\n\n\t\t\tif ( groups !== undefined ) {\n\n\t\t\t\tfor ( var i = 0, n = groups.length; i !== n; ++ i ) {\n\n\t\t\t\t\tvar group = groups[ i ];\n\n\t\t\t\t\tgeometry.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar boundingSphere = json.data.boundingSphere;\n\n\t\t\tif ( boundingSphere !== undefined ) {\n\n\t\t\t\tvar center = new Vector3();\n\n\t\t\t\tif ( boundingSphere.center !== undefined ) {\n\n\t\t\t\t\tcenter.fromArray( boundingSphere.center );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.boundingSphere = new Sphere( center, boundingSphere.radius );\n\n\t\t\t}\n\n\t\t\treturn geometry;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction Loader() {\n\n\t\tthis.onLoadStart = function () {};\n\t\tthis.onLoadProgress = function () {};\n\t\tthis.onLoadComplete = function () {};\n\n\t}\n\n\tLoader.prototype = {\n\n\t\tconstructor: Loader,\n\n\t\tcrossOrigin: undefined,\n\n\t\textractUrlBase: function ( url ) {\n\n\t\t\tvar parts = url.split( '/' );\n\n\t\t\tif ( parts.length === 1 ) return './';\n\n\t\t\tparts.pop();\n\n\t\t\treturn parts.join( '/' ) + '/';\n\n\t\t},\n\n\t\tinitMaterials: function ( materials, texturePath, crossOrigin ) {\n\n\t\t\tvar array = [];\n\n\t\t\tfor ( var i = 0; i < materials.length; ++ i ) {\n\n\t\t\t\tarray[ i ] = this.createMaterial( materials[ i ], texturePath, crossOrigin );\n\n\t\t\t}\n\n\t\t\treturn array;\n\n\t\t},\n\n\t\tcreateMaterial: ( function () {\n\n\t\t\tvar BlendingMode = {\n\t\t\t\tNoBlending: NoBlending,\n\t\t\t\tNormalBlending: NormalBlending,\n\t\t\t\tAdditiveBlending: AdditiveBlending,\n\t\t\t\tSubtractiveBlending: SubtractiveBlending,\n\t\t\t\tMultiplyBlending: MultiplyBlending,\n\t\t\t\tCustomBlending: CustomBlending\n\t\t\t};\n\n\t\t\tvar color, textureLoader, materialLoader;\n\n\t\t\treturn function createMaterial( m, texturePath, crossOrigin ) {\n\n\t\t\t\tif ( color === undefined ) color = new Color();\n\t\t\t\tif ( textureLoader === undefined ) textureLoader = new TextureLoader();\n\t\t\t\tif ( materialLoader === undefined ) materialLoader = new MaterialLoader();\n\n\t\t\t\t// convert from old material format\n\n\t\t\t\tvar textures = {};\n\n\t\t\t\tfunction loadTexture( path, repeat, offset, wrap, anisotropy ) {\n\n\t\t\t\t\tvar fullPath = texturePath + path;\n\t\t\t\t\tvar loader = Loader.Handlers.get( fullPath );\n\n\t\t\t\t\tvar texture;\n\n\t\t\t\t\tif ( loader !== null ) {\n\n\t\t\t\t\t\ttexture = loader.load( fullPath );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttextureLoader.setCrossOrigin( crossOrigin );\n\t\t\t\t\t\ttexture = textureLoader.load( fullPath );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( repeat !== undefined ) {\n\n\t\t\t\t\t\ttexture.repeat.fromArray( repeat );\n\n\t\t\t\t\t\tif ( repeat[ 0 ] !== 1 ) texture.wrapS = RepeatWrapping;\n\t\t\t\t\t\tif ( repeat[ 1 ] !== 1 ) texture.wrapT = RepeatWrapping;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( offset !== undefined ) {\n\n\t\t\t\t\t\ttexture.offset.fromArray( offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( wrap !== undefined ) {\n\n\t\t\t\t\t\tif ( wrap[ 0 ] === 'repeat' ) texture.wrapS = RepeatWrapping;\n\t\t\t\t\t\tif ( wrap[ 0 ] === 'mirror' ) texture.wrapS = MirroredRepeatWrapping;\n\n\t\t\t\t\t\tif ( wrap[ 1 ] === 'repeat' ) texture.wrapT = RepeatWrapping;\n\t\t\t\t\t\tif ( wrap[ 1 ] === 'mirror' ) texture.wrapT = MirroredRepeatWrapping;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( anisotropy !== undefined ) {\n\n\t\t\t\t\t\ttexture.anisotropy = anisotropy;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar uuid = _Math.generateUUID();\n\n\t\t\t\t\ttextures[ uuid ] = texture;\n\n\t\t\t\t\treturn uuid;\n\n\t\t\t\t}\n\n\t\t\t\t//\n\n\t\t\t\tvar json = {\n\t\t\t\t\tuuid: _Math.generateUUID(),\n\t\t\t\t\ttype: 'MeshLambertMaterial'\n\t\t\t\t};\n\n\t\t\t\tfor ( var name in m ) {\n\n\t\t\t\t\tvar value = m[ name ];\n\n\t\t\t\t\tswitch ( name ) {\n\n\t\t\t\t\t\tcase 'DbgColor':\n\t\t\t\t\t\tcase 'DbgIndex':\n\t\t\t\t\t\tcase 'opticalDensity':\n\t\t\t\t\t\tcase 'illumination':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'DbgName':\n\t\t\t\t\t\t\tjson.name = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'blending':\n\t\t\t\t\t\t\tjson.blending = BlendingMode[ value ];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'colorAmbient':\n\t\t\t\t\t\tcase 'mapAmbient':\n\t\t\t\t\t\t\tconsole.warn( 'THREE.Loader.createMaterial:', name, 'is no longer supported.' );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'colorDiffuse':\n\t\t\t\t\t\t\tjson.color = color.fromArray( value ).getHex();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'colorSpecular':\n\t\t\t\t\t\t\tjson.specular = color.fromArray( value ).getHex();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'colorEmissive':\n\t\t\t\t\t\t\tjson.emissive = color.fromArray( value ).getHex();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'specularCoef':\n\t\t\t\t\t\t\tjson.shininess = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'shading':\n\t\t\t\t\t\t\tif ( value.toLowerCase() === 'basic' ) json.type = 'MeshBasicMaterial';\n\t\t\t\t\t\t\tif ( value.toLowerCase() === 'phong' ) json.type = 'MeshPhongMaterial';\n\t\t\t\t\t\t\tif ( value.toLowerCase() === 'standard' ) json.type = 'MeshStandardMaterial';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapDiffuse':\n\t\t\t\t\t\t\tjson.map = loadTexture( value, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapDiffuseRepeat':\n\t\t\t\t\t\tcase 'mapDiffuseOffset':\n\t\t\t\t\t\tcase 'mapDiffuseWrap':\n\t\t\t\t\t\tcase 'mapDiffuseAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapEmissive':\n\t\t\t\t\t\t\tjson.emissiveMap = loadTexture( value, m.mapEmissiveRepeat, m.mapEmissiveOffset, m.mapEmissiveWrap, m.mapEmissiveAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapEmissiveRepeat':\n\t\t\t\t\t\tcase 'mapEmissiveOffset':\n\t\t\t\t\t\tcase 'mapEmissiveWrap':\n\t\t\t\t\t\tcase 'mapEmissiveAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapLight':\n\t\t\t\t\t\t\tjson.lightMap = loadTexture( value, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapLightRepeat':\n\t\t\t\t\t\tcase 'mapLightOffset':\n\t\t\t\t\t\tcase 'mapLightWrap':\n\t\t\t\t\t\tcase 'mapLightAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapAO':\n\t\t\t\t\t\t\tjson.aoMap = loadTexture( value, m.mapAORepeat, m.mapAOOffset, m.mapAOWrap, m.mapAOAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapAORepeat':\n\t\t\t\t\t\tcase 'mapAOOffset':\n\t\t\t\t\t\tcase 'mapAOWrap':\n\t\t\t\t\t\tcase 'mapAOAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapBump':\n\t\t\t\t\t\t\tjson.bumpMap = loadTexture( value, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapBumpScale':\n\t\t\t\t\t\t\tjson.bumpScale = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapBumpRepeat':\n\t\t\t\t\t\tcase 'mapBumpOffset':\n\t\t\t\t\t\tcase 'mapBumpWrap':\n\t\t\t\t\t\tcase 'mapBumpAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapNormal':\n\t\t\t\t\t\t\tjson.normalMap = loadTexture( value, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapNormalFactor':\n\t\t\t\t\t\t\tjson.normalScale = [ value, value ];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapNormalRepeat':\n\t\t\t\t\t\tcase 'mapNormalOffset':\n\t\t\t\t\t\tcase 'mapNormalWrap':\n\t\t\t\t\t\tcase 'mapNormalAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapSpecular':\n\t\t\t\t\t\t\tjson.specularMap = loadTexture( value, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapSpecularRepeat':\n\t\t\t\t\t\tcase 'mapSpecularOffset':\n\t\t\t\t\t\tcase 'mapSpecularWrap':\n\t\t\t\t\t\tcase 'mapSpecularAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapMetalness':\n\t\t\t\t\t\t\tjson.metalnessMap = loadTexture( value, m.mapMetalnessRepeat, m.mapMetalnessOffset, m.mapMetalnessWrap, m.mapMetalnessAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapMetalnessRepeat':\n\t\t\t\t\t\tcase 'mapMetalnessOffset':\n\t\t\t\t\t\tcase 'mapMetalnessWrap':\n\t\t\t\t\t\tcase 'mapMetalnessAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapRoughness':\n\t\t\t\t\t\t\tjson.roughnessMap = loadTexture( value, m.mapRoughnessRepeat, m.mapRoughnessOffset, m.mapRoughnessWrap, m.mapRoughnessAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapRoughnessRepeat':\n\t\t\t\t\t\tcase 'mapRoughnessOffset':\n\t\t\t\t\t\tcase 'mapRoughnessWrap':\n\t\t\t\t\t\tcase 'mapRoughnessAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapAlpha':\n\t\t\t\t\t\t\tjson.alphaMap = loadTexture( value, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mapAlphaRepeat':\n\t\t\t\t\t\tcase 'mapAlphaOffset':\n\t\t\t\t\t\tcase 'mapAlphaWrap':\n\t\t\t\t\t\tcase 'mapAlphaAnisotropy':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'flipSided':\n\t\t\t\t\t\t\tjson.side = BackSide;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'doubleSided':\n\t\t\t\t\t\t\tjson.side = DoubleSide;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'transparency':\n\t\t\t\t\t\t\tconsole.warn( 'THREE.Loader.createMaterial: transparency has been renamed to opacity' );\n\t\t\t\t\t\t\tjson.opacity = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'depthTest':\n\t\t\t\t\t\tcase 'depthWrite':\n\t\t\t\t\t\tcase 'colorWrite':\n\t\t\t\t\t\tcase 'opacity':\n\t\t\t\t\t\tcase 'reflectivity':\n\t\t\t\t\t\tcase 'transparent':\n\t\t\t\t\t\tcase 'visible':\n\t\t\t\t\t\tcase 'wireframe':\n\t\t\t\t\t\t\tjson[ name ] = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'vertexColors':\n\t\t\t\t\t\t\tif ( value === true ) json.vertexColors = VertexColors;\n\t\t\t\t\t\t\tif ( value === 'face' ) json.vertexColors = FaceColors;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.Loader.createMaterial: Unsupported', name, value );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( json.type === 'MeshBasicMaterial' ) delete json.emissive;\n\t\t\t\tif ( json.type !== 'MeshPhongMaterial' ) delete json.specular;\n\n\t\t\t\tif ( json.opacity < 1 ) json.transparent = true;\n\n\t\t\t\tmaterialLoader.setTextures( textures );\n\n\t\t\t\treturn materialLoader.parse( json );\n\n\t\t\t};\n\n\t\t} )()\n\n\t};\n\n\tLoader.Handlers = {\n\n\t\thandlers: [],\n\n\t\tadd: function ( regex, loader ) {\n\n\t\t\tthis.handlers.push( regex, loader );\n\n\t\t},\n\n\t\tget: function ( file ) {\n\n\t\t\tvar handlers = this.handlers;\n\n\t\t\tfor ( var i = 0, l = handlers.length; i < l; i += 2 ) {\n\n\t\t\t\tvar regex = handlers[ i ];\n\t\t\t\tvar loader = handlers[ i + 1 ];\n\n\t\t\t\tif ( regex.test( file ) ) {\n\n\t\t\t\t\treturn loader;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction JSONLoader( manager ) {\n\n\t\tif ( typeof manager === 'boolean' ) {\n\n\t\t\tconsole.warn( 'THREE.JSONLoader: showStatus parameter has been removed from constructor.' );\n\t\t\tmanager = undefined;\n\n\t\t}\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t\tthis.withCredentials = false;\n\n\t}\n\n\tObject.assign( JSONLoader.prototype, {\n\n\t\tload: function( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar texturePath = this.texturePath && ( typeof this.texturePath === \"string\" ) ? this.texturePath : Loader.prototype.extractUrlBase( url );\n\n\t\t\tvar loader = new FileLoader( this.manager );\n\t\t\tloader.setWithCredentials( this.withCredentials );\n\t\t\tloader.load( url, function ( text ) {\n\n\t\t\t\tvar json = JSON.parse( text );\n\t\t\t\tvar metadata = json.metadata;\n\n\t\t\t\tif ( metadata !== undefined ) {\n\n\t\t\t\t\tvar type = metadata.type;\n\n\t\t\t\t\tif ( type !== undefined ) {\n\n\t\t\t\t\t\tif ( type.toLowerCase() === 'object' ) {\n\n\t\t\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.' );\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( type.toLowerCase() === 'scene' ) {\n\n\t\t\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.SceneLoader instead.' );\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvar object = scope.parse( json, texturePath );\n\t\t\t\tonLoad( object.geometry, object.materials );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\tsetTexturePath: function ( value ) {\n\n\t\t\tthis.texturePath = value;\n\n\t\t},\n\n\t\tparse: function ( json, texturePath ) {\n\n\t\t\tvar geometry = new Geometry(),\n\t\t\tscale = ( json.scale !== undefined ) ? 1.0 / json.scale : 1.0;\n\n\t\t\tparseModel( scale );\n\n\t\t\tparseSkin();\n\t\t\tparseMorphing( scale );\n\t\t\tparseAnimations();\n\n\t\t\tgeometry.computeFaceNormals();\n\t\t\tgeometry.computeBoundingSphere();\n\n\t\t\tfunction parseModel( scale ) {\n\n\t\t\t\tfunction isBitSet( value, position ) {\n\n\t\t\t\t\treturn value & ( 1 << position );\n\n\t\t\t\t}\n\n\t\t\t\tvar i, j, fi,\n\n\t\t\t\toffset, zLength,\n\n\t\t\tcolorIndex, normalIndex, uvIndex, materialIndex,\n\n\t\t\t\ttype,\n\t\t\t\tisQuad,\n\t\t\t\thasMaterial,\n\t\t\t\thasFaceVertexUv,\n\t\t\t\thasFaceNormal, hasFaceVertexNormal,\n\t\t\t\thasFaceColor, hasFaceVertexColor,\n\n\t\t\tvertex, face, faceA, faceB, hex, normal,\n\n\t\t\t\tuvLayer, uv, u, v,\n\n\t\t\t\tfaces = json.faces,\n\t\t\t\tvertices = json.vertices,\n\t\t\t\tnormals = json.normals,\n\t\t\t\tcolors = json.colors,\n\n\t\t\t\tnUvLayers = 0;\n\n\t\t\t\tif ( json.uvs !== undefined ) {\n\n\t\t\t\t\t// disregard empty arrays\n\n\t\t\t\t\tfor ( i = 0; i < json.uvs.length; i ++ ) {\n\n\t\t\t\t\t\tif ( json.uvs[ i ].length ) nUvLayers ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\n\n\t\t\t\t\t\tgeometry.faceVertexUvs[ i ] = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\toffset = 0;\n\t\t\t\tzLength = vertices.length;\n\n\t\t\t\twhile ( offset < zLength ) {\n\n\t\t\t\t\tvertex = new Vector3();\n\n\t\t\t\t\tvertex.x = vertices[ offset ++ ] * scale;\n\t\t\t\t\tvertex.y = vertices[ offset ++ ] * scale;\n\t\t\t\t\tvertex.z = vertices[ offset ++ ] * scale;\n\n\t\t\t\t\tgeometry.vertices.push( vertex );\n\n\t\t\t\t}\n\n\t\t\t\toffset = 0;\n\t\t\t\tzLength = faces.length;\n\n\t\t\t\twhile ( offset < zLength ) {\n\n\t\t\t\t\ttype = faces[ offset ++ ];\n\n\n\t\t\t\t\tisQuad              = isBitSet( type, 0 );\n\t\t\t\t\thasMaterial         = isBitSet( type, 1 );\n\t\t\t\t\thasFaceVertexUv     = isBitSet( type, 3 );\n\t\t\t\t\thasFaceNormal       = isBitSet( type, 4 );\n\t\t\t\t\thasFaceVertexNormal = isBitSet( type, 5 );\n\t\t\t\t\thasFaceColor\t     = isBitSet( type, 6 );\n\t\t\t\t\thasFaceVertexColor  = isBitSet( type, 7 );\n\n\t\t\t\t\t// console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\n\n\t\t\t\t\tif ( isQuad ) {\n\n\t\t\t\t\t\tfaceA = new Face3();\n\t\t\t\t\t\tfaceA.a = faces[ offset ];\n\t\t\t\t\t\tfaceA.b = faces[ offset + 1 ];\n\t\t\t\t\t\tfaceA.c = faces[ offset + 3 ];\n\n\t\t\t\t\t\tfaceB = new Face3();\n\t\t\t\t\t\tfaceB.a = faces[ offset + 1 ];\n\t\t\t\t\t\tfaceB.b = faces[ offset + 2 ];\n\t\t\t\t\t\tfaceB.c = faces[ offset + 3 ];\n\n\t\t\t\t\t\toffset += 4;\n\n\t\t\t\t\t\tif ( hasMaterial ) {\n\n\t\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\n\t\t\t\t\t\t\tfaceA.materialIndex = materialIndex;\n\t\t\t\t\t\t\tfaceB.materialIndex = materialIndex;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// to get face <=> uv index correspondence\n\n\t\t\t\t\t\tfi = geometry.faces.length;\n\n\t\t\t\t\t\tif ( hasFaceVertexUv ) {\n\n\t\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\n\n\t\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\n\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi + 1 ] = [];\n\n\t\t\t\t\t\t\t\tfor ( j = 0; j < 4; j ++ ) {\n\n\t\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\n\n\t\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\n\t\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\n\n\t\t\t\t\t\t\t\t\tuv = new Vector2( u, v );\n\n\t\t\t\t\t\t\t\t\tif ( j !== 2 ) geometry.faceVertexUvs[ i ][ fi ].push( uv );\n\t\t\t\t\t\t\t\t\tif ( j !== 0 ) geometry.faceVertexUvs[ i ][ fi + 1 ].push( uv );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( hasFaceNormal ) {\n\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\n\n\t\t\t\t\t\t\tfaceA.normal.set(\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tfaceB.normal.copy( faceA.normal );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( hasFaceVertexNormal ) {\n\n\t\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\n\n\t\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\n\n\t\t\t\t\t\t\t\tnormal = new Vector3(\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ]\n\t\t\t\t\t\t\t\t);\n\n\n\t\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexNormals.push( normal );\n\t\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexNormals.push( normal );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tif ( hasFaceColor ) {\n\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\n\t\t\t\t\t\t\thex = colors[ colorIndex ];\n\n\t\t\t\t\t\t\tfaceA.color.setHex( hex );\n\t\t\t\t\t\t\tfaceB.color.setHex( hex );\n\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tif ( hasFaceVertexColor ) {\n\n\t\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\n\n\t\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\n\t\t\t\t\t\t\t\thex = colors[ colorIndex ];\n\n\t\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexColors.push( new Color( hex ) );\n\t\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexColors.push( new Color( hex ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgeometry.faces.push( faceA );\n\t\t\t\t\t\tgeometry.faces.push( faceB );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tface = new Face3();\n\t\t\t\t\t\tface.a = faces[ offset ++ ];\n\t\t\t\t\t\tface.b = faces[ offset ++ ];\n\t\t\t\t\t\tface.c = faces[ offset ++ ];\n\n\t\t\t\t\t\tif ( hasMaterial ) {\n\n\t\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\n\t\t\t\t\t\t\tface.materialIndex = materialIndex;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// to get face <=> uv index correspondence\n\n\t\t\t\t\t\tfi = geometry.faces.length;\n\n\t\t\t\t\t\tif ( hasFaceVertexUv ) {\n\n\t\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\n\n\t\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\n\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\n\n\t\t\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\n\n\t\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\n\t\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\n\n\t\t\t\t\t\t\t\t\tuv = new Vector2( u, v );\n\n\t\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ].push( uv );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( hasFaceNormal ) {\n\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\n\n\t\t\t\t\t\t\tface.normal.set(\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( hasFaceVertexNormal ) {\n\n\t\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\n\n\t\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\n\n\t\t\t\t\t\t\t\tnormal = new Vector3(\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ]\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tface.vertexNormals.push( normal );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tif ( hasFaceColor ) {\n\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\n\t\t\t\t\t\t\tface.color.setHex( colors[ colorIndex ] );\n\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tif ( hasFaceVertexColor ) {\n\n\t\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\n\n\t\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\n\t\t\t\t\t\t\t\tface.vertexColors.push( new Color( colors[ colorIndex ] ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgeometry.faces.push( face );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction parseSkin() {\n\n\t\t\t\tvar influencesPerVertex = ( json.influencesPerVertex !== undefined ) ? json.influencesPerVertex : 2;\n\n\t\t\t\tif ( json.skinWeights ) {\n\n\t\t\t\t\tfor ( var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex ) {\n\n\t\t\t\t\t\tvar x =                               json.skinWeights[ i ];\n\t\t\t\t\t\tvar y = ( influencesPerVertex > 1 ) ? json.skinWeights[ i + 1 ] : 0;\n\t\t\t\t\t\tvar z = ( influencesPerVertex > 2 ) ? json.skinWeights[ i + 2 ] : 0;\n\t\t\t\t\t\tvar w = ( influencesPerVertex > 3 ) ? json.skinWeights[ i + 3 ] : 0;\n\n\t\t\t\t\t\tgeometry.skinWeights.push( new Vector4( x, y, z, w ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( json.skinIndices ) {\n\n\t\t\t\t\tfor ( var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex ) {\n\n\t\t\t\t\t\tvar a =                               json.skinIndices[ i ];\n\t\t\t\t\t\tvar b = ( influencesPerVertex > 1 ) ? json.skinIndices[ i + 1 ] : 0;\n\t\t\t\t\t\tvar c = ( influencesPerVertex > 2 ) ? json.skinIndices[ i + 2 ] : 0;\n\t\t\t\t\t\tvar d = ( influencesPerVertex > 3 ) ? json.skinIndices[ i + 3 ] : 0;\n\n\t\t\t\t\t\tgeometry.skinIndices.push( new Vector4( a, b, c, d ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.bones = json.bones;\n\n\t\t\t\tif ( geometry.bones && geometry.bones.length > 0 && ( geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length ) ) {\n\n\t\t\t\t\tconsole.warn( 'When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\n\t\t\t\t\t\tgeometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction parseMorphing( scale ) {\n\n\t\t\t\tif ( json.morphTargets !== undefined ) {\n\n\t\t\t\t\tfor ( var i = 0, l = json.morphTargets.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tgeometry.morphTargets[ i ] = {};\n\t\t\t\t\t\tgeometry.morphTargets[ i ].name = json.morphTargets[ i ].name;\n\t\t\t\t\t\tgeometry.morphTargets[ i ].vertices = [];\n\n\t\t\t\t\t\tvar dstVertices = geometry.morphTargets[ i ].vertices;\n\t\t\t\t\t\tvar srcVertices = json.morphTargets[ i ].vertices;\n\n\t\t\t\t\t\tfor ( var v = 0, vl = srcVertices.length; v < vl; v += 3 ) {\n\n\t\t\t\t\t\t\tvar vertex = new Vector3();\n\t\t\t\t\t\t\tvertex.x = srcVertices[ v ] * scale;\n\t\t\t\t\t\t\tvertex.y = srcVertices[ v + 1 ] * scale;\n\t\t\t\t\t\t\tvertex.z = srcVertices[ v + 2 ] * scale;\n\n\t\t\t\t\t\t\tdstVertices.push( vertex );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( json.morphColors !== undefined && json.morphColors.length > 0 ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors.' );\n\n\t\t\t\t\tvar faces = geometry.faces;\n\t\t\t\t\tvar morphColors = json.morphColors[ 0 ].colors;\n\n\t\t\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tfaces[ i ].color.fromArray( morphColors, i * 3 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction parseAnimations() {\n\n\t\t\t\tvar outputAnimations = [];\n\n\t\t\t\t// parse old style Bone/Hierarchy animations\n\t\t\t\tvar animations = [];\n\n\t\t\t\tif ( json.animation !== undefined ) {\n\n\t\t\t\t\tanimations.push( json.animation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( json.animations !== undefined ) {\n\n\t\t\t\t\tif ( json.animations.length ) {\n\n\t\t\t\t\t\tanimations = animations.concat( json.animations );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tanimations.push( json.animations );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = 0; i < animations.length; i ++ ) {\n\n\t\t\t\t\tvar clip = AnimationClip.parseAnimation( animations[ i ], geometry.bones );\n\t\t\t\t\tif ( clip ) outputAnimations.push( clip );\n\n\t\t\t\t}\n\n\t\t\t\t// parse implicit morph animations\n\t\t\t\tif ( geometry.morphTargets ) {\n\n\t\t\t\t\t// TODO: Figure out what an appropraite FPS is for morph target animations -- defaulting to 10, but really it is completely arbitrary.\n\t\t\t\t\tvar morphAnimationClips = AnimationClip.CreateClipsFromMorphTargetSequences( geometry.morphTargets, 10 );\n\t\t\t\t\toutputAnimations = outputAnimations.concat( morphAnimationClips );\n\n\t\t\t\t}\n\n\t\t\t\tif ( outputAnimations.length > 0 ) geometry.animations = outputAnimations;\n\n\t\t\t}\n\n\t\t\tif ( json.materials === undefined || json.materials.length === 0 ) {\n\n\t\t\t\treturn { geometry: geometry };\n\n\t\t\t} else {\n\n\t\t\t\tvar materials = Loader.prototype.initMaterials( json.materials, texturePath, this.crossOrigin );\n\n\t\t\t\treturn { geometry: geometry, materials: materials };\n\n\t\t\t}\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction ObjectLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\t\tthis.texturePath = '';\n\n\t}\n\n\tObject.assign( ObjectLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tif ( this.texturePath === '' ) {\n\n\t\t\t\tthis.texturePath = url.substring( 0, url.lastIndexOf( '/' ) + 1 );\n\n\t\t\t}\n\n\t\t\tvar scope = this;\n\n\t\t\tvar loader = new FileLoader( scope.manager );\n\t\t\tloader.load( url, function ( text ) {\n\n\t\t\t\tvar json = null;\n\n\t\t\t\ttry {\n\n\t\t\t\t\tjson = JSON.parse( text );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tconsole.error( 'THREE:ObjectLoader: Can\\'t parse ' + url + '.', error.message );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tvar metadata = json.metadata;\n\n\t\t\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\n\n\t\t\t\t\tconsole.error( 'THREE.ObjectLoader: Can\\'t load ' + url + '. Use THREE.JSONLoader instead.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tscope.parse( json, onLoad );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\tsetTexturePath: function ( value ) {\n\n\t\t\tthis.texturePath = value;\n\n\t\t},\n\n\t\tsetCrossOrigin: function ( value ) {\n\n\t\t\tthis.crossOrigin = value;\n\n\t\t},\n\n\t\tparse: function ( json, onLoad ) {\n\n\t\t\tvar geometries = this.parseGeometries( json.geometries );\n\n\t\t\tvar images = this.parseImages( json.images, function () {\n\n\t\t\t\tif ( onLoad !== undefined ) onLoad( object );\n\n\t\t\t} );\n\n\t\t\tvar textures = this.parseTextures( json.textures, images );\n\t\t\tvar materials = this.parseMaterials( json.materials, textures );\n\n\t\t\tvar object = this.parseObject( json.object, geometries, materials );\n\n\t\t\tif ( json.animations ) {\n\n\t\t\t\tobject.animations = this.parseAnimations( json.animations );\n\n\t\t\t}\n\n\t\t\tif ( json.images === undefined || json.images.length === 0 ) {\n\n\t\t\t\tif ( onLoad !== undefined ) onLoad( object );\n\n\t\t\t}\n\n\t\t\treturn object;\n\n\t\t},\n\n\t\tparseGeometries: function ( json ) {\n\n\t\t\tvar geometries = {};\n\n\t\t\tif ( json !== undefined ) {\n\n\t\t\t\tvar geometryLoader = new JSONLoader();\n\t\t\t\tvar bufferGeometryLoader = new BufferGeometryLoader();\n\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar geometry;\n\t\t\t\t\tvar data = json[ i ];\n\n\t\t\t\t\tswitch ( data.type ) {\n\n\t\t\t\t\t\tcase 'PlaneGeometry':\n\t\t\t\t\t\tcase 'PlaneBufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.width,\n\t\t\t\t\t\t\t\tdata.height,\n\t\t\t\t\t\t\t\tdata.widthSegments,\n\t\t\t\t\t\t\t\tdata.heightSegments\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'BoxGeometry':\n\t\t\t\t\t\tcase 'BoxBufferGeometry':\n\t\t\t\t\t\tcase 'CubeGeometry': // backwards compatible\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.width,\n\t\t\t\t\t\t\t\tdata.height,\n\t\t\t\t\t\t\t\tdata.depth,\n\t\t\t\t\t\t\t\tdata.widthSegments,\n\t\t\t\t\t\t\t\tdata.heightSegments,\n\t\t\t\t\t\t\t\tdata.depthSegments\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'CircleGeometry':\n\t\t\t\t\t\tcase 'CircleBufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\t\tdata.segments,\n\t\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'CylinderGeometry':\n\t\t\t\t\t\tcase 'CylinderBufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.radiusTop,\n\t\t\t\t\t\t\t\tdata.radiusBottom,\n\t\t\t\t\t\t\t\tdata.height,\n\t\t\t\t\t\t\t\tdata.radialSegments,\n\t\t\t\t\t\t\t\tdata.heightSegments,\n\t\t\t\t\t\t\t\tdata.openEnded,\n\t\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'ConeGeometry':\n\t\t\t\t\t\tcase 'ConeBufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\t\tdata.height,\n\t\t\t\t\t\t\t\tdata.radialSegments,\n\t\t\t\t\t\t\t\tdata.heightSegments,\n\t\t\t\t\t\t\t\tdata.openEnded,\n\t\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'SphereGeometry':\n\t\t\t\t\t\tcase 'SphereBufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\t\tdata.widthSegments,\n\t\t\t\t\t\t\t\tdata.heightSegments,\n\t\t\t\t\t\t\t\tdata.phiStart,\n\t\t\t\t\t\t\t\tdata.phiLength,\n\t\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'DodecahedronGeometry':\n\t\t\t\t\t\tcase 'IcosahedronGeometry':\n\t\t\t\t\t\tcase 'OctahedronGeometry':\n\t\t\t\t\t\tcase 'TetrahedronGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\t\tdata.detail\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'RingGeometry':\n\t\t\t\t\t\tcase 'RingBufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.innerRadius,\n\t\t\t\t\t\t\t\tdata.outerRadius,\n\t\t\t\t\t\t\t\tdata.thetaSegments,\n\t\t\t\t\t\t\t\tdata.phiSegments,\n\t\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'TorusGeometry':\n\t\t\t\t\t\tcase 'TorusBufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\t\tdata.tube,\n\t\t\t\t\t\t\t\tdata.radialSegments,\n\t\t\t\t\t\t\t\tdata.tubularSegments,\n\t\t\t\t\t\t\t\tdata.arc\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'TorusKnotGeometry':\n\t\t\t\t\t\tcase 'TorusKnotBufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\t\tdata.tube,\n\t\t\t\t\t\t\t\tdata.tubularSegments,\n\t\t\t\t\t\t\t\tdata.radialSegments,\n\t\t\t\t\t\t\t\tdata.p,\n\t\t\t\t\t\t\t\tdata.q\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'LatheGeometry':\n\t\t\t\t\t\tcase 'LatheBufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\n\t\t\t\t\t\t\t\tdata.points,\n\t\t\t\t\t\t\t\tdata.segments,\n\t\t\t\t\t\t\t\tdata.phiStart,\n\t\t\t\t\t\t\t\tdata.phiLength\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'BufferGeometry':\n\n\t\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'Geometry':\n\n\t\t\t\t\t\t\tgeometry = geometryLoader.parse( data.data, this.texturePath ).geometry;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Unsupported geometry type \"' + data.type + '\"' );\n\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tgeometry.uuid = data.uuid;\n\n\t\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\n\n\t\t\t\t\tgeometries[ data.uuid ] = geometry;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn geometries;\n\n\t\t},\n\n\t\tparseMaterials: function ( json, textures ) {\n\n\t\t\tvar materials = {};\n\n\t\t\tif ( json !== undefined ) {\n\n\t\t\t\tvar loader = new MaterialLoader();\n\t\t\t\tloader.setTextures( textures );\n\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar material = loader.parse( json[ i ] );\n\t\t\t\t\tmaterials[ material.uuid ] = material;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn materials;\n\n\t\t},\n\n\t\tparseAnimations: function ( json ) {\n\n\t\t\tvar animations = [];\n\n\t\t\tfor ( var i = 0; i < json.length; i ++ ) {\n\n\t\t\t\tvar clip = AnimationClip.parse( json[ i ] );\n\n\t\t\t\tanimations.push( clip );\n\n\t\t\t}\n\n\t\t\treturn animations;\n\n\t\t},\n\n\t\tparseImages: function ( json, onLoad ) {\n\n\t\t\tvar scope = this;\n\t\t\tvar images = {};\n\n\t\t\tfunction loadImage( url ) {\n\n\t\t\t\tscope.manager.itemStart( url );\n\n\t\t\t\treturn loader.load( url, function () {\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, undefined, function () {\n\n\t\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\t\tvar manager = new LoadingManager( onLoad );\n\n\t\t\t\tvar loader = new ImageLoader( manager );\n\t\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar image = json[ i ];\n\t\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( image.url ) ? image.url : scope.texturePath + image.url;\n\n\t\t\t\t\timages[ image.uuid ] = loadImage( path );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn images;\n\n\t\t},\n\n\t\tparseTextures: function ( json, images ) {\n\n\t\t\tvar TextureMapping = {\n\t\t\t\tUVMapping: UVMapping,\n\t\t\t\tCubeReflectionMapping: CubeReflectionMapping,\n\t\t\t\tCubeRefractionMapping: CubeRefractionMapping,\n\t\t\t\tEquirectangularReflectionMapping: EquirectangularReflectionMapping,\n\t\t\t\tEquirectangularRefractionMapping: EquirectangularRefractionMapping,\n\t\t\t\tSphericalReflectionMapping: SphericalReflectionMapping,\n\t\t\t\tCubeUVReflectionMapping: CubeUVReflectionMapping,\n\t\t\t\tCubeUVRefractionMapping: CubeUVRefractionMapping\n\t\t\t};\n\n\t\t\tvar TextureWrapping = {\n\t\t\t\tRepeatWrapping: RepeatWrapping,\n\t\t\t\tClampToEdgeWrapping: ClampToEdgeWrapping,\n\t\t\t\tMirroredRepeatWrapping: MirroredRepeatWrapping\n\t\t\t};\n\n\t\t\tvar TextureFilter = {\n\t\t\t\tNearestFilter: NearestFilter,\n\t\t\t\tNearestMipMapNearestFilter: NearestMipMapNearestFilter,\n\t\t\t\tNearestMipMapLinearFilter: NearestMipMapLinearFilter,\n\t\t\t\tLinearFilter: LinearFilter,\n\t\t\t\tLinearMipMapNearestFilter: LinearMipMapNearestFilter,\n\t\t\t\tLinearMipMapLinearFilter: LinearMipMapLinearFilter\n\t\t\t};\n\n\t\t\tfunction parseConstant( value, type ) {\n\n\t\t\t\tif ( typeof( value ) === 'number' ) return value;\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\n\n\t\t\t\treturn type[ value ];\n\n\t\t\t}\n\n\t\t\tvar textures = {};\n\n\t\t\tif ( json !== undefined ) {\n\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar data = json[ i ];\n\n\t\t\t\t\tif ( data.image === undefined ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( images[ data.image ] === undefined ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar texture = new Texture( images[ data.image ] );\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\ttexture.uuid = data.uuid;\n\n\t\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\n\n\t\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping, TextureMapping );\n\n\t\t\t\t\tif ( data.offset !== undefined ) texture.offset.fromArray( data.offset );\n\t\t\t\t\tif ( data.repeat !== undefined ) texture.repeat.fromArray( data.repeat );\n\t\t\t\t\tif ( data.wrap !== undefined ) {\n\n\t\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ], TextureWrapping );\n\t\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ], TextureWrapping );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter, TextureFilter );\n\t\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter, TextureFilter );\n\t\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\n\n\t\t\t\t\tif ( data.flipY !== undefined ) texture.flipY = data.flipY;\n\n\t\t\t\t\ttextures[ data.uuid ] = texture;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn textures;\n\n\t\t},\n\n\t\tparseObject: function () {\n\n\t\t\tvar matrix = new Matrix4();\n\n\t\t\treturn function parseObject( data, geometries, materials ) {\n\n\t\t\t\tvar object;\n\n\t\t\t\tfunction getGeometry( name ) {\n\n\t\t\t\t\tif ( geometries[ name ] === undefined ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn geometries[ name ];\n\n\t\t\t\t}\n\n\t\t\t\tfunction getMaterial( name ) {\n\n\t\t\t\t\tif ( name === undefined ) return undefined;\n\n\t\t\t\t\tif ( materials[ name ] === undefined ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn materials[ name ];\n\n\t\t\t\t}\n\n\t\t\t\tswitch ( data.type ) {\n\n\t\t\t\t\tcase 'Scene':\n\n\t\t\t\t\t\tobject = new Scene();\n\n\t\t\t\t\t\tif ( data.background !== undefined ) {\n\n\t\t\t\t\t\t\tif ( Number.isInteger( data.background ) ) {\n\n\t\t\t\t\t\t\t\tobject.background = new Color( data.background );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( data.fog !== undefined ) {\n\n\t\t\t\t\t\t\tif ( data.fog.type === 'Fog' ) {\n\n\t\t\t\t\t\t\t\tobject.fog = new Fog( data.fog.color, data.fog.near, data.fog.far );\n\n\t\t\t\t\t\t\t} else if ( data.fog.type === 'FogExp2' ) {\n\n\t\t\t\t\t\t\t\tobject.fog = new FogExp2( data.fog.color, data.fog.density );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'PerspectiveCamera':\n\n\t\t\t\t\t\tobject = new PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\n\n\t\t\t\t\t\tif ( data.focus !== undefined ) object.focus = data.focus;\n\t\t\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\n\t\t\t\t\t\tif ( data.filmGauge !== undefined ) object.filmGauge = data.filmGauge;\n\t\t\t\t\t\tif ( data.filmOffset !== undefined ) object.filmOffset = data.filmOffset;\n\t\t\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'OrthographicCamera':\n\n\t\t\t\t\t\tobject = new OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'AmbientLight':\n\n\t\t\t\t\t\tobject = new AmbientLight( data.color, data.intensity );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'DirectionalLight':\n\n\t\t\t\t\t\tobject = new DirectionalLight( data.color, data.intensity );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'PointLight':\n\n\t\t\t\t\t\tobject = new PointLight( data.color, data.intensity, data.distance, data.decay );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'SpotLight':\n\n\t\t\t\t\t\tobject = new SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'HemisphereLight':\n\n\t\t\t\t\t\tobject = new HemisphereLight( data.color, data.groundColor, data.intensity );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Mesh':\n\n\t\t\t\t\t\tvar geometry = getGeometry( data.geometry );\n\t\t\t\t\t\tvar material = getMaterial( data.material );\n\n\t\t\t\t\t\tif ( geometry.bones && geometry.bones.length > 0 ) {\n\n\t\t\t\t\t\t\tobject = new SkinnedMesh( geometry, material );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tobject = new Mesh( geometry, material );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'LOD':\n\n\t\t\t\t\t\tobject = new LOD();\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Line':\n\n\t\t\t\t\t\tobject = new Line( getGeometry( data.geometry ), getMaterial( data.material ), data.mode );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'LineSegments':\n\n\t\t\t\t\t\tobject = new LineSegments( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'PointCloud':\n\t\t\t\t\tcase 'Points':\n\n\t\t\t\t\t\tobject = new Points( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Sprite':\n\n\t\t\t\t\t\tobject = new Sprite( getMaterial( data.material ) );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Group':\n\n\t\t\t\t\t\tobject = new Group();\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'SkinnedMesh':\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader.parseObject() does not support SkinnedMesh type. Instantiates Object3D instead.' );\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tobject = new Object3D();\n\n\t\t\t\t}\n\n\t\t\t\tobject.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) object.name = data.name;\n\t\t\t\tif ( data.matrix !== undefined ) {\n\n\t\t\t\t\tmatrix.fromArray( data.matrix );\n\t\t\t\t\tmatrix.decompose( object.position, object.quaternion, object.scale );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\n\t\t\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\n\t\t\t\t\tif ( data.quaternion !== undefined ) object.quaternion.fromArray( data.quaternion );\n\t\t\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\n\t\t\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\n\n\t\t\t\tif ( data.shadow ) {\n\n\t\t\t\t\tif ( data.shadow.bias !== undefined ) object.shadow.bias = data.shadow.bias;\n\t\t\t\t\tif ( data.shadow.radius !== undefined ) object.shadow.radius = data.shadow.radius;\n\t\t\t\t\tif ( data.shadow.mapSize !== undefined ) object.shadow.mapSize.fromArray( data.shadow.mapSize );\n\t\t\t\t\tif ( data.shadow.camera !== undefined ) object.shadow.camera = this.parseObject( data.shadow.camera );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.visible !== undefined ) object.visible = data.visible;\n\t\t\t\tif ( data.userData !== undefined ) object.userData = data.userData;\n\n\t\t\t\tif ( data.children !== undefined ) {\n\n\t\t\t\t\tfor ( var child in data.children ) {\n\n\t\t\t\t\t\tobject.add( this.parseObject( data.children[ child ], geometries, materials ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.type === 'LOD' ) {\n\n\t\t\t\t\tvar levels = data.levels;\n\n\t\t\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\n\n\t\t\t\t\t\tvar level = levels[ l ];\n\t\t\t\t\t\tvar child = object.getObjectByProperty( 'uuid', level.object );\n\n\t\t\t\t\t\tif ( child !== undefined ) {\n\n\t\t\t\t\t\t\tobject.addLevel( child, level.distance );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn object;\n\n\t\t\t};\n\n\t\t}()\n\n\t} );\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t *\n\t * Bezier Curves formulas obtained from\n\t * http://en.wikipedia.org/wiki/Bézier_curve\n\t */\n\n\tfunction CatmullRom( t, p0, p1, p2, p3 ) {\n\n\t\tvar v0 = ( p2 - p0 ) * 0.5;\n\t\tvar v1 = ( p3 - p1 ) * 0.5;\n\t\tvar t2 = t * t;\n\t\tvar t3 = t * t2;\n\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n\t}\n\n\t//\n\n\tfunction QuadraticBezierP0( t, p ) {\n\n\t\tvar k = 1 - t;\n\t\treturn k * k * p;\n\n\t}\n\n\tfunction QuadraticBezierP1( t, p ) {\n\n\t\treturn 2 * ( 1 - t ) * t * p;\n\n\t}\n\n\tfunction QuadraticBezierP2( t, p ) {\n\n\t\treturn t * t * p;\n\n\t}\n\n\tfunction QuadraticBezier( t, p0, p1, p2 ) {\n\n\t\treturn QuadraticBezierP0( t, p0 ) + QuadraticBezierP1( t, p1 ) +\n\t\t\tQuadraticBezierP2( t, p2 );\n\n\t}\n\n\t//\n\n\tfunction CubicBezierP0( t, p ) {\n\n\t\tvar k = 1 - t;\n\t\treturn k * k * k * p;\n\n\t}\n\n\tfunction CubicBezierP1( t, p ) {\n\n\t\tvar k = 1 - t;\n\t\treturn 3 * k * k * t * p;\n\n\t}\n\n\tfunction CubicBezierP2( t, p ) {\n\n\t\treturn 3 * ( 1 - t ) * t * t * p;\n\n\t}\n\n\tfunction CubicBezierP3( t, p ) {\n\n\t\treturn t * t * t * p;\n\n\t}\n\n\tfunction CubicBezier( t, p0, p1, p2, p3 ) {\n\n\t\treturn CubicBezierP0( t, p0 ) + CubicBezierP1( t, p1 ) + CubicBezierP2( t, p2 ) +\n\t\t\tCubicBezierP3( t, p3 );\n\n\t}\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * Extensible curve object\n\t *\n\t * Some common of Curve methods\n\t * .getPoint(t), getTangent(t)\n\t * .getPointAt(u), getTangentAt(u)\n\t * .getPoints(), .getSpacedPoints()\n\t * .getLength()\n\t * .updateArcLengths()\n\t *\n\t * This following classes subclasses THREE.Curve:\n\t *\n\t * -- 2d classes --\n\t * THREE.LineCurve\n\t * THREE.QuadraticBezierCurve\n\t * THREE.CubicBezierCurve\n\t * THREE.SplineCurve\n\t * THREE.ArcCurve\n\t * THREE.EllipseCurve\n\t *\n\t * -- 3d classes --\n\t * THREE.LineCurve3\n\t * THREE.QuadraticBezierCurve3\n\t * THREE.CubicBezierCurve3\n\t * THREE.CatmullRomCurve3\n\t *\n\t * A series of curves can be represented as a THREE.CurvePath\n\t *\n\t **/\n\n\t/**************************************************************\n\t *\tAbstract Curve base class\n\t **************************************************************/\n\n\tfunction Curve() {}\n\n\tCurve.prototype = {\n\n\t\tconstructor: Curve,\n\n\t\t// Virtual base class method to overwrite and implement in subclasses\n\t\t//\t- t [0 .. 1]\n\n\t\tgetPoint: function ( t ) {\n\n\t\t\tconsole.warn( \"THREE.Curve: Warning, getPoint() not implemented!\" );\n\t\t\treturn null;\n\n\t\t},\n\n\t\t// Get point at relative position in curve according to arc length\n\t\t// - u [0 .. 1]\n\n\t\tgetPointAt: function ( u ) {\n\n\t\t\tvar t = this.getUtoTmapping( u );\n\t\t\treturn this.getPoint( t );\n\n\t\t},\n\n\t\t// Get sequence of points using getPoint( t )\n\n\t\tgetPoints: function ( divisions ) {\n\n\t\t\tif ( ! divisions ) divisions = 5;\n\n\t\t\tvar points = [];\n\n\t\t\tfor ( var d = 0; d <= divisions; d ++ ) {\n\n\t\t\t\tpoints.push( this.getPoint( d / divisions ) );\n\n\t\t\t}\n\n\t\t\treturn points;\n\n\t\t},\n\n\t\t// Get sequence of points using getPointAt( u )\n\n\t\tgetSpacedPoints: function ( divisions ) {\n\n\t\t\tif ( ! divisions ) divisions = 5;\n\n\t\t\tvar points = [];\n\n\t\t\tfor ( var d = 0; d <= divisions; d ++ ) {\n\n\t\t\t\tpoints.push( this.getPointAt( d / divisions ) );\n\n\t\t\t}\n\n\t\t\treturn points;\n\n\t\t},\n\n\t\t// Get total curve arc length\n\n\t\tgetLength: function () {\n\n\t\t\tvar lengths = this.getLengths();\n\t\t\treturn lengths[ lengths.length - 1 ];\n\n\t\t},\n\n\t\t// Get list of cumulative segment lengths\n\n\t\tgetLengths: function ( divisions ) {\n\n\t\t\tif ( ! divisions ) divisions = ( this.__arcLengthDivisions ) ? ( this.__arcLengthDivisions ) : 200;\n\n\t\t\tif ( this.cacheArcLengths\n\t\t\t\t&& ( this.cacheArcLengths.length === divisions + 1 )\n\t\t\t\t&& ! this.needsUpdate ) {\n\n\t\t\t\t//console.log( \"cached\", this.cacheArcLengths );\n\t\t\t\treturn this.cacheArcLengths;\n\n\t\t\t}\n\n\t\t\tthis.needsUpdate = false;\n\n\t\t\tvar cache = [];\n\t\t\tvar current, last = this.getPoint( 0 );\n\t\t\tvar p, sum = 0;\n\n\t\t\tcache.push( 0 );\n\n\t\t\tfor ( p = 1; p <= divisions; p ++ ) {\n\n\t\t\t\tcurrent = this.getPoint ( p / divisions );\n\t\t\t\tsum += current.distanceTo( last );\n\t\t\t\tcache.push( sum );\n\t\t\t\tlast = current;\n\n\t\t\t}\n\n\t\t\tthis.cacheArcLengths = cache;\n\n\t\t\treturn cache; // { sums: cache, sum:sum }; Sum is in the last element.\n\n\t\t},\n\n\t\tupdateArcLengths: function() {\n\n\t\t\tthis.needsUpdate = true;\n\t\t\tthis.getLengths();\n\n\t\t},\n\n\t\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\n\n\t\tgetUtoTmapping: function ( u, distance ) {\n\n\t\t\tvar arcLengths = this.getLengths();\n\n\t\t\tvar i = 0, il = arcLengths.length;\n\n\t\t\tvar targetArcLength; // The targeted u distance value to get\n\n\t\t\tif ( distance ) {\n\n\t\t\t\ttargetArcLength = distance;\n\n\t\t\t} else {\n\n\t\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\n\n\t\t\t}\n\n\t\t\t//var time = Date.now();\n\n\t\t\t// binary search for the index with largest value smaller than target u distance\n\n\t\t\tvar low = 0, high = il - 1, comparison;\n\n\t\t\twhile ( low <= high ) {\n\n\t\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\n\n\t\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\n\n\t\t\t\tif ( comparison < 0 ) {\n\n\t\t\t\t\tlow = i + 1;\n\n\t\t\t\t} else if ( comparison > 0 ) {\n\n\t\t\t\t\thigh = i - 1;\n\n\t\t\t\t} else {\n\n\t\t\t\t\thigh = i;\n\t\t\t\t\tbreak;\n\n\t\t\t\t\t// DONE\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ti = high;\n\n\t\t\t//console.log('b' , i, low, high, Date.now()- time);\n\n\t\t\tif ( arcLengths[ i ] === targetArcLength ) {\n\n\t\t\t\tvar t = i / ( il - 1 );\n\t\t\t\treturn t;\n\n\t\t\t}\n\n\t\t\t// we could get finer grain at lengths, or use simple interpolation between two points\n\n\t\t\tvar lengthBefore = arcLengths[ i ];\n\t\t\tvar lengthAfter = arcLengths[ i + 1 ];\n\n\t\t\tvar segmentLength = lengthAfter - lengthBefore;\n\n\t\t\t// determine where we are between the 'before' and 'after' points\n\n\t\t\tvar segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\n\n\t\t\t// add that fractional amount to t\n\n\t\t\tvar t = ( i + segmentFraction ) / ( il - 1 );\n\n\t\t\treturn t;\n\n\t\t},\n\n\t\t// Returns a unit vector tangent at t\n\t\t// In case any sub curve does not implement its tangent derivation,\n\t\t// 2 points a small delta apart will be used to find its gradient\n\t\t// which seems to give a reasonable approximation\n\n\t\tgetTangent: function( t ) {\n\n\t\t\tvar delta = 0.0001;\n\t\t\tvar t1 = t - delta;\n\t\t\tvar t2 = t + delta;\n\n\t\t\t// Capping in case of danger\n\n\t\t\tif ( t1 < 0 ) t1 = 0;\n\t\t\tif ( t2 > 1 ) t2 = 1;\n\n\t\t\tvar pt1 = this.getPoint( t1 );\n\t\t\tvar pt2 = this.getPoint( t2 );\n\n\t\t\tvar vec = pt2.clone().sub( pt1 );\n\t\t\treturn vec.normalize();\n\n\t\t},\n\n\t\tgetTangentAt: function ( u ) {\n\n\t\t\tvar t = this.getUtoTmapping( u );\n\t\t\treturn this.getTangent( t );\n\n\t\t},\n\n\t\tcomputeFrenetFrames: function ( segments, closed ) {\n\n\t\t\t// see http://www.cs.indiana.edu/pub/techreports/TR425.pdf\n\n\t\t\tvar normal = new Vector3();\n\n\t\t\tvar tangents = [];\n\t\t\tvar normals = [];\n\t\t\tvar binormals = [];\n\n\t\t\tvar vec = new Vector3();\n\t\t\tvar mat = new Matrix4();\n\n\t\t\tvar i, u, theta;\n\n\t\t\t// compute the tangent vectors for each segment on the curve\n\n\t\t\tfor ( i = 0; i <= segments; i ++ ) {\n\n\t\t\t\tu = i / segments;\n\n\t\t\t\ttangents[ i ] = this.getTangentAt( u );\n\t\t\t\ttangents[ i ].normalize();\n\n\t\t\t}\n\n\t\t\t// select an initial normal vector perpendicular to the first tangent vector,\n\t\t\t// and in the direction of the minimum tangent xyz component\n\n\t\t\tnormals[ 0 ] = new Vector3();\n\t\t\tbinormals[ 0 ] = new Vector3();\n\t\t\tvar min = Number.MAX_VALUE;\n\t\t\tvar tx = Math.abs( tangents[ 0 ].x );\n\t\t\tvar ty = Math.abs( tangents[ 0 ].y );\n\t\t\tvar tz = Math.abs( tangents[ 0 ].z );\n\n\t\t\tif ( tx <= min ) {\n\n\t\t\t\tmin = tx;\n\t\t\t\tnormal.set( 1, 0, 0 );\n\n\t\t\t}\n\n\t\t\tif ( ty <= min ) {\n\n\t\t\t\tmin = ty;\n\t\t\t\tnormal.set( 0, 1, 0 );\n\n\t\t\t}\n\n\t\t\tif ( tz <= min ) {\n\n\t\t\t\tnormal.set( 0, 0, 1 );\n\n\t\t\t}\n\n\t\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\n\n\t\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\n\t\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\n\n\n\t\t\t// compute the slowly-varying normal and binormal vectors for each segment on the curve\n\n\t\t\tfor ( i = 1; i <= segments; i ++ ) {\n\n\t\t\t\tnormals[ i ] = normals[ i - 1 ].clone();\n\n\t\t\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\n\n\t\t\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\n\n\t\t\t\tif ( vec.length() > Number.EPSILON ) {\n\n\t\t\t\t\tvec.normalize();\n\n\t\t\t\t\ttheta = Math.acos( _Math.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\n\n\t\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\n\n\t\t\t\t}\n\n\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t\t}\n\n\t\t\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\n\n\t\t\tif ( closed === true ) {\n\n\t\t\t\ttheta = Math.acos( _Math.clamp( normals[ 0 ].dot( normals[ segments ] ), - 1, 1 ) );\n\t\t\t\ttheta /= segments;\n\n\t\t\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ segments ] ) ) > 0 ) {\n\n\t\t\t\t\ttheta = - theta;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( i = 1; i <= segments; i ++ ) {\n\n\t\t\t\t\t// twist a little...\n\t\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\n\t\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttangents: tangents,\n\t\t\t\tnormals: normals,\n\t\t\t\tbinormals: binormals\n\t\t\t};\n\n\t\t}\n\n\t};\n\n\tfunction LineCurve( v1, v2 ) {\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tLineCurve.prototype = Object.create( Curve.prototype );\n\tLineCurve.prototype.constructor = LineCurve;\n\n\tLineCurve.prototype.isLineCurve = true;\n\n\tLineCurve.prototype.getPoint = function ( t ) {\n\n\t\tif ( t === 1 ) {\n\n\t\t\treturn this.v2.clone();\n\n\t\t}\n\n\t\tvar point = this.v2.clone().sub( this.v1 );\n\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\treturn point;\n\n\t};\n\n\t// Line curve is linear, so we can overwrite default getPointAt\n\n\tLineCurve.prototype.getPointAt = function ( u ) {\n\n\t\treturn this.getPoint( u );\n\n\t};\n\n\tLineCurve.prototype.getTangent = function ( t ) {\n\n\t\tvar tangent = this.v2.clone().sub( this.v1 );\n\n\t\treturn tangent.normalize();\n\n\t};\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t *\n\t **/\n\n\t/**************************************************************\n\t *\tCurved Path - a curve path is simply a array of connected\n\t *  curves, but retains the api of a curve\n\t **************************************************************/\n\n\tfunction CurvePath() {\n\n\t\tthis.curves = [];\n\n\t\tthis.autoClose = false; // Automatically closes the path\n\n\t}\n\n\tCurvePath.prototype = Object.assign( Object.create( Curve.prototype ), {\n\n\t\tconstructor: CurvePath,\n\n\t\tadd: function ( curve ) {\n\n\t\t\tthis.curves.push( curve );\n\n\t\t},\n\n\t\tclosePath: function () {\n\n\t\t\t// Add a line curve if start and end of lines are not connected\n\t\t\tvar startPoint = this.curves[ 0 ].getPoint( 0 );\n\t\t\tvar endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\n\n\t\t\tif ( ! startPoint.equals( endPoint ) ) {\n\n\t\t\t\tthis.curves.push( new LineCurve( endPoint, startPoint ) );\n\n\t\t\t}\n\n\t\t},\n\n\t\t// To get accurate point with reference to\n\t\t// entire path distance at time t,\n\t\t// following has to be done:\n\n\t\t// 1. Length of each sub path have to be known\n\t\t// 2. Locate and identify type of curve\n\t\t// 3. Get t for the curve\n\t\t// 4. Return curve.getPointAt(t')\n\n\t\tgetPoint: function ( t ) {\n\n\t\t\tvar d = t * this.getLength();\n\t\t\tvar curveLengths = this.getCurveLengths();\n\t\t\tvar i = 0;\n\n\t\t\t// To think about boundaries points.\n\n\t\t\twhile ( i < curveLengths.length ) {\n\n\t\t\t\tif ( curveLengths[ i ] >= d ) {\n\n\t\t\t\t\tvar diff = curveLengths[ i ] - d;\n\t\t\t\t\tvar curve = this.curves[ i ];\n\n\t\t\t\t\tvar segmentLength = curve.getLength();\n\t\t\t\t\tvar u = segmentLength === 0 ? 0 : 1 - diff / segmentLength;\n\n\t\t\t\t\treturn curve.getPointAt( u );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t\t// loop where sum != 0, sum > d , sum+1 <d\n\n\t\t},\n\n\t\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\n\t\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\n\t\t// getPoint() depends on getLength\n\n\t\tgetLength: function () {\n\n\t\t\tvar lens = this.getCurveLengths();\n\t\t\treturn lens[ lens.length - 1 ];\n\n\t\t},\n\n\t\t// cacheLengths must be recalculated.\n\t\tupdateArcLengths: function () {\n\n\t\t\tthis.needsUpdate = true;\n\t\t\tthis.cacheLengths = null;\n\t\t\tthis.getLengths();\n\n\t\t},\n\n\t\t// Compute lengths and cache them\n\t\t// We cannot overwrite getLengths() because UtoT mapping uses it.\n\n\t\tgetCurveLengths: function () {\n\n\t\t\t// We use cache values if curves and cache array are same length\n\n\t\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\n\n\t\t\t\treturn this.cacheLengths;\n\n\t\t\t}\n\n\t\t\t// Get length of sub-curve\n\t\t\t// Push sums into cached array\n\n\t\t\tvar lengths = [], sums = 0;\n\n\t\t\tfor ( var i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\t\tsums += this.curves[ i ].getLength();\n\t\t\t\tlengths.push( sums );\n\n\t\t\t}\n\n\t\t\tthis.cacheLengths = lengths;\n\n\t\t\treturn lengths;\n\n\t\t},\n\n\t\tgetSpacedPoints: function ( divisions ) {\n\n\t\t\tif ( ! divisions ) divisions = 40;\n\n\t\t\tvar points = [];\n\n\t\t\tfor ( var i = 0; i <= divisions; i ++ ) {\n\n\t\t\t\tpoints.push( this.getPoint( i / divisions ) );\n\n\t\t\t}\n\n\t\t\tif ( this.autoClose ) {\n\n\t\t\t\tpoints.push( points[ 0 ] );\n\n\t\t\t}\n\n\t\t\treturn points;\n\n\t\t},\n\n\t\tgetPoints: function ( divisions ) {\n\n\t\t\tdivisions = divisions || 12;\n\n\t\t\tvar points = [], last;\n\n\t\t\tfor ( var i = 0, curves = this.curves; i < curves.length; i ++ ) {\n\n\t\t\t\tvar curve = curves[ i ];\n\t\t\t\tvar resolution = (curve && curve.isEllipseCurve) ? divisions * 2\n\t\t\t\t\t: (curve && curve.isLineCurve) ? 1\n\t\t\t\t\t: (curve && curve.isSplineCurve) ? divisions * curve.points.length\n\t\t\t\t\t: divisions;\n\n\t\t\t\tvar pts = curve.getPoints( resolution );\n\n\t\t\t\tfor ( var j = 0; j < pts.length; j++ ) {\n\n\t\t\t\t\tvar point = pts[ j ];\n\n\t\t\t\t\tif ( last && last.equals( point ) ) continue; // ensures no consecutive points are duplicates\n\n\t\t\t\t\tpoints.push( point );\n\t\t\t\t\tlast = point;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.autoClose && points.length > 1 && !points[ points.length - 1 ].equals( points[ 0 ] ) ) {\n\n\t\t\t\tpoints.push( points[ 0 ] );\n\n\t\t\t}\n\n\t\t\treturn points;\n\n\t\t},\n\n\t\t/**************************************************************\n\t\t *\tCreate Geometries Helpers\n\t\t **************************************************************/\n\n\t\t/// Generate geometry from path points (for Line or Points objects)\n\n\t\tcreatePointsGeometry: function ( divisions ) {\n\n\t\t\tvar pts = this.getPoints( divisions );\n\t\t\treturn this.createGeometry( pts );\n\n\t\t},\n\n\t\t// Generate geometry from equidistant sampling along the path\n\n\t\tcreateSpacedPointsGeometry: function ( divisions ) {\n\n\t\t\tvar pts = this.getSpacedPoints( divisions );\n\t\t\treturn this.createGeometry( pts );\n\n\t\t},\n\n\t\tcreateGeometry: function ( points ) {\n\n\t\t\tvar geometry = new Geometry();\n\n\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\t\tvar point = points[ i ];\n\t\t\t\tgeometry.vertices.push( new Vector3( point.x, point.y, point.z || 0 ) );\n\n\t\t\t}\n\n\t\t\treturn geometry;\n\n\t\t}\n\n\t} );\n\n\tfunction EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tthis.aX = aX;\n\t\tthis.aY = aY;\n\n\t\tthis.xRadius = xRadius;\n\t\tthis.yRadius = yRadius;\n\n\t\tthis.aStartAngle = aStartAngle;\n\t\tthis.aEndAngle = aEndAngle;\n\n\t\tthis.aClockwise = aClockwise;\n\n\t\tthis.aRotation = aRotation || 0;\n\n\t}\n\n\tEllipseCurve.prototype = Object.create( Curve.prototype );\n\tEllipseCurve.prototype.constructor = EllipseCurve;\n\n\tEllipseCurve.prototype.isEllipseCurve = true;\n\n\tEllipseCurve.prototype.getPoint = function ( t ) {\n\n\t\tvar twoPi = Math.PI * 2;\n\t\tvar deltaAngle = this.aEndAngle - this.aStartAngle;\n\t\tvar samePoints = Math.abs( deltaAngle ) < Number.EPSILON;\n\n\t\t// ensures that deltaAngle is 0 .. 2 PI\n\t\twhile ( deltaAngle < 0 ) deltaAngle += twoPi;\n\t\twhile ( deltaAngle > twoPi ) deltaAngle -= twoPi;\n\n\t\tif ( deltaAngle < Number.EPSILON ) {\n\n\t\t\tif ( samePoints ) {\n\n\t\t\t\tdeltaAngle = 0;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.aClockwise === true && ! samePoints ) {\n\n\t\t\tif ( deltaAngle === twoPi ) {\n\n\t\t\t\tdeltaAngle = - twoPi;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = deltaAngle - twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar angle = this.aStartAngle + t * deltaAngle;\n\t\tvar x = this.aX + this.xRadius * Math.cos( angle );\n\t\tvar y = this.aY + this.yRadius * Math.sin( angle );\n\n\t\tif ( this.aRotation !== 0 ) {\n\n\t\t\tvar cos = Math.cos( this.aRotation );\n\t\t\tvar sin = Math.sin( this.aRotation );\n\n\t\t\tvar tx = x - this.aX;\n\t\t\tvar ty = y - this.aY;\n\n\t\t\t// Rotate the point about the center of the ellipse.\n\t\t\tx = tx * cos - ty * sin + this.aX;\n\t\t\ty = tx * sin + ty * cos + this.aY;\n\n\t\t}\n\n\t\treturn new Vector2( x, y );\n\n\t};\n\n\tfunction SplineCurve( points /* array of Vector2 */ ) {\n\n\t\tthis.points = ( points === undefined ) ? [] : points;\n\n\t}\n\n\tSplineCurve.prototype = Object.create( Curve.prototype );\n\tSplineCurve.prototype.constructor = SplineCurve;\n\n\tSplineCurve.prototype.isSplineCurve = true;\n\n\tSplineCurve.prototype.getPoint = function ( t ) {\n\n\t\tvar points = this.points;\n\t\tvar point = ( points.length - 1 ) * t;\n\n\t\tvar intPoint = Math.floor( point );\n\t\tvar weight = point - intPoint;\n\n\t\tvar point0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\n\t\tvar point1 = points[ intPoint ];\n\t\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\n\t\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\n\n\t\treturn new Vector2(\n\t\t\tCatmullRom( weight, point0.x, point1.x, point2.x, point3.x ),\n\t\t\tCatmullRom( weight, point0.y, point1.y, point2.y, point3.y )\n\t\t);\n\n\t};\n\n\tfunction CubicBezierCurve( v0, v1, v2, v3 ) {\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tCubicBezierCurve.prototype = Object.create( Curve.prototype );\n\tCubicBezierCurve.prototype.constructor = CubicBezierCurve;\n\n\tCubicBezierCurve.prototype.getPoint = function ( t ) {\n\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\treturn new Vector2(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y )\n\t\t);\n\n\t};\n\n\tfunction QuadraticBezierCurve( v0, v1, v2 ) {\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tQuadraticBezierCurve.prototype = Object.create( Curve.prototype );\n\tQuadraticBezierCurve.prototype.constructor = QuadraticBezierCurve;\n\n\tQuadraticBezierCurve.prototype.getPoint = function ( t ) {\n\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\treturn new Vector2(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y )\n\t\t);\n\n\t};\n\n\tvar PathPrototype = Object.assign( Object.create( CurvePath.prototype ), {\n\n\t\tfromPoints: function ( vectors ) {\n\n\t\t\tthis.moveTo( vectors[ 0 ].x, vectors[ 0 ].y );\n\n\t\t\tfor ( var i = 1, l = vectors.length; i < l; i ++ ) {\n\n\t\t\t\tthis.lineTo( vectors[ i ].x, vectors[ i ].y );\n\n\t\t\t}\n\n\t\t},\n\n\t\tmoveTo: function ( x, y ) {\n\n\t\t\tthis.currentPoint.set( x, y ); // TODO consider referencing vectors instead of copying?\n\n\t\t},\n\n\t\tlineTo: function ( x, y ) {\n\n\t\t\tvar curve = new LineCurve( this.currentPoint.clone(), new Vector2( x, y ) );\n\t\t\tthis.curves.push( curve );\n\n\t\t\tthis.currentPoint.set( x, y );\n\n\t\t},\n\n\t\tquadraticCurveTo: function ( aCPx, aCPy, aX, aY ) {\n\n\t\t\tvar curve = new QuadraticBezierCurve(\n\t\t\t\tthis.currentPoint.clone(),\n\t\t\t\tnew Vector2( aCPx, aCPy ),\n\t\t\t\tnew Vector2( aX, aY )\n\t\t\t);\n\n\t\t\tthis.curves.push( curve );\n\n\t\t\tthis.currentPoint.set( aX, aY );\n\n\t\t},\n\n\t\tbezierCurveTo: function ( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\t\tvar curve = new CubicBezierCurve(\n\t\t\t\tthis.currentPoint.clone(),\n\t\t\t\tnew Vector2( aCP1x, aCP1y ),\n\t\t\t\tnew Vector2( aCP2x, aCP2y ),\n\t\t\t\tnew Vector2( aX, aY )\n\t\t\t);\n\n\t\t\tthis.curves.push( curve );\n\n\t\t\tthis.currentPoint.set( aX, aY );\n\n\t\t},\n\n\t\tsplineThru: function ( pts /*Array of Vector*/ ) {\n\n\t\t\tvar npts = [ this.currentPoint.clone() ].concat( pts );\n\n\t\t\tvar curve = new SplineCurve( npts );\n\t\t\tthis.curves.push( curve );\n\n\t\t\tthis.currentPoint.copy( pts[ pts.length - 1 ] );\n\n\t\t},\n\n\t\tarc: function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\t\tvar x0 = this.currentPoint.x;\n\t\t\tvar y0 = this.currentPoint.y;\n\n\t\t\tthis.absarc( aX + x0, aY + y0, aRadius,\n\t\t\t\taStartAngle, aEndAngle, aClockwise );\n\n\t\t},\n\n\t\tabsarc: function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\t},\n\n\t\tellipse: function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\t\tvar x0 = this.currentPoint.x;\n\t\t\tvar y0 = this.currentPoint.y;\n\n\t\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\t},\n\n\t\tabsellipse: function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\t\tvar curve = new EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\t\tif ( this.curves.length > 0 ) {\n\n\t\t\t\t// if a previous curve is present, attempt to join\n\t\t\t\tvar firstPoint = curve.getPoint( 0 );\n\n\t\t\t\tif ( ! firstPoint.equals( this.currentPoint ) ) {\n\n\t\t\t\t\tthis.lineTo( firstPoint.x, firstPoint.y );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.curves.push( curve );\n\n\t\t\tvar lastPoint = curve.getPoint( 1 );\n\t\t\tthis.currentPoint.copy( lastPoint );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * Creates free form 2d path using series of points, lines or curves.\n\t **/\n\n\tfunction Path( points ) {\n\n\t\tCurvePath.call( this );\n\t\tthis.currentPoint = new Vector2();\n\n\t\tif ( points ) {\n\n\t\t\tthis.fromPoints( points );\n\n\t\t}\n\n\t}\n\n\tPath.prototype = PathPrototype;\n\tPathPrototype.constructor = Path;\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * Defines a 2d shape plane using paths.\n\t **/\n\n\t// STEP 1 Create a path.\n\t// STEP 2 Turn path into shape.\n\t// STEP 3 ExtrudeGeometry takes in Shape/Shapes\n\t// STEP 3a - Extract points from each shape, turn to vertices\n\t// STEP 3b - Triangulate each shape, add faces.\n\n\tfunction Shape() {\n\n\t\tPath.apply( this, arguments );\n\n\t\tthis.holes = [];\n\n\t}\n\n\tShape.prototype = Object.assign( Object.create( PathPrototype ), {\n\n\t\tconstructor: Shape,\n\n\t\tgetPointsHoles: function ( divisions ) {\n\n\t\t\tvar holesPts = [];\n\n\t\t\tfor ( var i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\n\n\t\t\t}\n\n\t\t\treturn holesPts;\n\n\t\t},\n\n\t\t// Get points of shape and holes (keypoints based on segments parameter)\n\n\t\textractAllPoints: function ( divisions ) {\n\n\t\t\treturn {\n\n\t\t\t\tshape: this.getPoints( divisions ),\n\t\t\t\tholes: this.getPointsHoles( divisions )\n\n\t\t\t};\n\n\t\t},\n\n\t\textractPoints: function ( divisions ) {\n\n\t\t\treturn this.extractAllPoints( divisions );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * minimal class for proxing functions to Path. Replaces old \"extractSubpaths()\"\n\t **/\n\n\tfunction ShapePath() {\n\n\t\tthis.subPaths = [];\n\t\tthis.currentPath = null;\n\n\t}\n\n\tShapePath.prototype = {\n\n\t\tmoveTo: function ( x, y ) {\n\n\t\t\tthis.currentPath = new Path();\n\t\t\tthis.subPaths.push( this.currentPath );\n\t\t\tthis.currentPath.moveTo( x, y );\n\n\t\t},\n\n\t\tlineTo: function ( x, y ) {\n\n\t\t\tthis.currentPath.lineTo( x, y );\n\n\t\t},\n\n\t\tquadraticCurveTo: function ( aCPx, aCPy, aX, aY ) {\n\n\t\t\tthis.currentPath.quadraticCurveTo( aCPx, aCPy, aX, aY );\n\n\t\t},\n\n\t\tbezierCurveTo: function ( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\t\tthis.currentPath.bezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY );\n\n\t\t},\n\n\t\tsplineThru: function ( pts ) {\n\n\t\t\tthis.currentPath.splineThru( pts );\n\n\t\t},\n\n\t\ttoShapes: function ( isCCW, noHoles ) {\n\n\t\t\tfunction toShapesNoHoles( inSubpaths ) {\n\n\t\t\t\tvar shapes = [];\n\n\t\t\t\tfor ( var i = 0, l = inSubpaths.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar tmpPath = inSubpaths[ i ];\n\n\t\t\t\t\tvar tmpShape = new Shape();\n\t\t\t\t\ttmpShape.curves = tmpPath.curves;\n\n\t\t\t\t\tshapes.push( tmpShape );\n\n\t\t\t\t}\n\n\t\t\t\treturn shapes;\n\n\t\t\t}\n\n\t\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\n\n\t\t\t\tvar polyLen = inPolygon.length;\n\n\t\t\t\t// inPt on polygon contour => immediate success    or\n\t\t\t\t// toggling of inside/outside at every single! intersection point of an edge\n\t\t\t\t//  with the horizontal line through inPt, left of inPt\n\t\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\n\t\t\t\tvar inside = false;\n\t\t\t\tfor ( var p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\n\n\t\t\t\t\tvar edgeLowPt  = inPolygon[ p ];\n\t\t\t\t\tvar edgeHighPt = inPolygon[ q ];\n\n\t\t\t\t\tvar edgeDx = edgeHighPt.x - edgeLowPt.x;\n\t\t\t\t\tvar edgeDy = edgeHighPt.y - edgeLowPt.y;\n\n\t\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\n\n\t\t\t\t\t\t// not parallel\n\t\t\t\t\t\tif ( edgeDy < 0 ) {\n\n\t\t\t\t\t\t\tedgeLowPt  = inPolygon[ q ]; edgeDx = - edgeDx;\n\t\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\n\n\t\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\n\n\t\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tvar perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\n\t\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\n\t\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// parallel or collinear\n\t\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\n\t\t\t\t\t\t// edge lies on the same horizontal line as inPt\n\t\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\n\t\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\n\t\t\t\t\t\t// continue;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn\tinside;\n\n\t\t\t}\n\n\t\t\tvar isClockWise = ShapeUtils.isClockWise;\n\n\t\t\tvar subPaths = this.subPaths;\n\t\t\tif ( subPaths.length === 0 ) return [];\n\n\t\t\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\t\t\tvar solid, tmpPath, tmpShape, shapes = [];\n\n\t\t\tif ( subPaths.length === 1 ) {\n\n\t\t\t\ttmpPath = subPaths[ 0 ];\n\t\t\t\ttmpShape = new Shape();\n\t\t\t\ttmpShape.curves = tmpPath.curves;\n\t\t\t\tshapes.push( tmpShape );\n\t\t\t\treturn shapes;\n\n\t\t\t}\n\n\t\t\tvar holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\n\t\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\n\n\t\t\t// console.log(\"Holes first\", holesFirst);\n\n\t\t\tvar betterShapeHoles = [];\n\t\t\tvar newShapes = [];\n\t\t\tvar newShapeHoles = [];\n\t\t\tvar mainIdx = 0;\n\t\t\tvar tmpPoints;\n\n\t\t\tnewShapes[ mainIdx ] = undefined;\n\t\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\t\tfor ( var i = 0, l = subPaths.length; i < l; i ++ ) {\n\n\t\t\t\ttmpPath = subPaths[ i ];\n\t\t\t\ttmpPoints = tmpPath.getPoints();\n\t\t\t\tsolid = isClockWise( tmpPoints );\n\t\t\t\tsolid = isCCW ? ! solid : solid;\n\n\t\t\t\tif ( solid ) {\n\n\t\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\n\n\t\t\t\t\tnewShapes[ mainIdx ] = { s: new Shape(), p: tmpPoints };\n\t\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\n\n\t\t\t\t\tif ( holesFirst )\tmainIdx ++;\n\t\t\t\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\t\t\t\t//console.log('cw', i);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\n\n\t\t\t\t\t//console.log('ccw', i);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// only Holes? -> probably all Shapes with wrong orientation\n\t\t\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\t\t\tif ( newShapes.length > 1 ) {\n\n\t\t\t\tvar ambiguous = false;\n\t\t\t\tvar toChange = [];\n\n\t\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\t\tbetterShapeHoles[ sIdx ] = [];\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\t\tvar sho = newShapeHoles[ sIdx ];\n\n\t\t\t\t\tfor ( var hIdx = 0; hIdx < sho.length; hIdx ++ ) {\n\n\t\t\t\t\t\tvar ho = sho[ hIdx ];\n\t\t\t\t\t\tvar hole_unassigned = true;\n\n\t\t\t\t\t\tfor ( var s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\n\n\t\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\n\n\t\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\n\t\t\t\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\t\t\t\thole_unassigned = false;\n\t\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\tambiguous = true;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t// console.log(\"ambiguous: \", ambiguous);\n\t\t\t\tif ( toChange.length > 0 ) {\n\n\t\t\t\t\t// console.log(\"to change: \", toChange);\n\t\t\t\t\tif ( ! ambiguous )\tnewShapeHoles = betterShapeHoles;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar tmpHoles;\n\n\t\t\tfor ( var i = 0, il = newShapes.length; i < il; i ++ ) {\n\n\t\t\t\ttmpShape = newShapes[ i ].s;\n\t\t\t\tshapes.push( tmpShape );\n\t\t\t\ttmpHoles = newShapeHoles[ i ];\n\n\t\t\t\tfor ( var j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\n\n\t\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//console.log(\"shape\", shapes);\n\n\t\t\treturn shapes;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Font( data ) {\n\n\t\tthis.data = data;\n\n\t}\n\n\tObject.assign( Font.prototype, {\n\n\t\tisFont: true,\n\n\t\tgenerateShapes: function ( text, size, divisions ) {\n\n\t\t\tfunction createPaths( text ) {\n\n\t\t\t\tvar chars = String( text ).split( '' );\n\t\t\t\tvar scale = size / data.resolution;\n\t\t\t\tvar offset = 0;\n\n\t\t\t\tvar paths = [];\n\n\t\t\t\tfor ( var i = 0; i < chars.length; i ++ ) {\n\n\t\t\t\t\tvar ret = createPath( chars[ i ], scale, offset );\n\t\t\t\t\toffset += ret.offset;\n\n\t\t\t\t\tpaths.push( ret.path );\n\n\t\t\t\t}\n\n\t\t\t\treturn paths;\n\n\t\t\t}\n\n\t\t\tfunction createPath( c, scale, offset ) {\n\n\t\t\t\tvar glyph = data.glyphs[ c ] || data.glyphs[ '?' ];\n\n\t\t\t\tif ( ! glyph ) return;\n\n\t\t\t\tvar path = new ShapePath();\n\n\t\t\t\tvar pts = [];\n\t\t\t\tvar x, y, cpx, cpy, cpx0, cpy0, cpx1, cpy1, cpx2, cpy2, laste;\n\n\t\t\t\tif ( glyph.o ) {\n\n\t\t\t\t\tvar outline = glyph._cachedOutline || ( glyph._cachedOutline = glyph.o.split( ' ' ) );\n\n\t\t\t\t\tfor ( var i = 0, l = outline.length; i < l; ) {\n\n\t\t\t\t\t\tvar action = outline[ i ++ ];\n\n\t\t\t\t\t\tswitch ( action ) {\n\n\t\t\t\t\t\t\tcase 'm': // moveTo\n\n\t\t\t\t\t\t\t\tx = outline[ i ++ ] * scale + offset;\n\t\t\t\t\t\t\t\ty = outline[ i ++ ] * scale;\n\n\t\t\t\t\t\t\t\tpath.moveTo( x, y );\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'l': // lineTo\n\n\t\t\t\t\t\t\t\tx = outline[ i ++ ] * scale + offset;\n\t\t\t\t\t\t\t\ty = outline[ i ++ ] * scale;\n\n\t\t\t\t\t\t\t\tpath.lineTo( x, y );\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'q': // quadraticCurveTo\n\n\t\t\t\t\t\t\t\tcpx  = outline[ i ++ ] * scale + offset;\n\t\t\t\t\t\t\t\tcpy  = outline[ i ++ ] * scale;\n\t\t\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offset;\n\t\t\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale;\n\n\t\t\t\t\t\t\t\tpath.quadraticCurveTo( cpx1, cpy1, cpx, cpy );\n\n\t\t\t\t\t\t\t\tlaste = pts[ pts.length - 1 ];\n\n\t\t\t\t\t\t\t\tif ( laste ) {\n\n\t\t\t\t\t\t\t\t\tcpx0 = laste.x;\n\t\t\t\t\t\t\t\t\tcpy0 = laste.y;\n\n\t\t\t\t\t\t\t\t\tfor ( var i2 = 1; i2 <= divisions; i2 ++ ) {\n\n\t\t\t\t\t\t\t\t\t\tvar t = i2 / divisions;\n\t\t\t\t\t\t\t\t\t\tQuadraticBezier( t, cpx0, cpx1, cpx );\n\t\t\t\t\t\t\t\t\t\tQuadraticBezier( t, cpy0, cpy1, cpy );\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'b': // bezierCurveTo\n\n\t\t\t\t\t\t\t\tcpx  = outline[ i ++ ] * scale + offset;\n\t\t\t\t\t\t\t\tcpy  = outline[ i ++ ] * scale;\n\t\t\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offset;\n\t\t\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale;\n\t\t\t\t\t\t\t\tcpx2 = outline[ i ++ ] * scale + offset;\n\t\t\t\t\t\t\t\tcpy2 = outline[ i ++ ] * scale;\n\n\t\t\t\t\t\t\t\tpath.bezierCurveTo( cpx1, cpy1, cpx2, cpy2, cpx, cpy );\n\n\t\t\t\t\t\t\t\tlaste = pts[ pts.length - 1 ];\n\n\t\t\t\t\t\t\t\tif ( laste ) {\n\n\t\t\t\t\t\t\t\t\tcpx0 = laste.x;\n\t\t\t\t\t\t\t\t\tcpy0 = laste.y;\n\n\t\t\t\t\t\t\t\t\tfor ( var i2 = 1; i2 <= divisions; i2 ++ ) {\n\n\t\t\t\t\t\t\t\t\t\tvar t = i2 / divisions;\n\t\t\t\t\t\t\t\t\t\tCubicBezier( t, cpx0, cpx1, cpx2, cpx );\n\t\t\t\t\t\t\t\t\t\tCubicBezier( t, cpy0, cpy1, cpy2, cpy );\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn { offset: glyph.ha * scale, path: path };\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tif ( size === undefined ) size = 100;\n\t\t\tif ( divisions === undefined ) divisions = 4;\n\n\t\t\tvar data = this.data;\n\n\t\t\tvar paths = createPaths( text );\n\t\t\tvar shapes = [];\n\n\t\t\tfor ( var p = 0, pl = paths.length; p < pl; p ++ ) {\n\n\t\t\t\tArray.prototype.push.apply( shapes, paths[ p ].toShapes() );\n\n\t\t\t}\n\n\t\t\treturn shapes;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction FontLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t}\n\n\tObject.assign( FontLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar loader = new FileLoader( this.manager );\n\t\t\tloader.load( url, function ( text ) {\n\n\t\t\t\tvar json;\n\n\t\t\t\ttry {\n\n\t\t\t\t\tjson = JSON.parse( text );\n\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.' );\n\t\t\t\t\tjson = JSON.parse( text.substring( 65, text.length - 2 ) );\n\n\t\t\t\t}\n\n\t\t\t\tvar font = scope.parse( json );\n\n\t\t\t\tif ( onLoad ) onLoad( font );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\tparse: function ( json ) {\n\n\t\t\treturn new Font( json );\n\n\t\t}\n\n\t} );\n\n\tvar context;\n\n\tvar AudioContext = {\n\n\t\tgetContext: function () {\n\n\t\t\tif ( context === undefined ) {\n\n\t\t\t\tcontext = new ( window.AudioContext || window.webkitAudioContext )();\n\n\t\t\t}\n\n\t\t\treturn context;\n\n\t\t},\n\n\t\tsetContext: function ( value ) {\n\n\t\t\tcontext = value;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author Reece Aaron Lecrivain / http://reecenotes.com/\n\t */\n\n\tfunction AudioLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t}\n\n\tObject.assign( AudioLoader.prototype, {\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar loader = new FileLoader( this.manager );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\tvar context = AudioContext.getContext();\n\n\t\t\t\tcontext.decodeAudioData( buffer, function ( audioBuffer ) {\n\n\t\t\t\t\tonLoad( audioBuffer );\n\n\t\t\t\t} );\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author abelnation / http://github.com/abelnation\n\t */\n\n\tfunction RectAreaLight ( color, intensity, width, height ) {\n\n\t\tLight.call( this, color, intensity );\n\n\t\tthis.type = 'RectAreaLight';\n\n\t\tthis.position.set( 0, 1, 0 );\n\t\tthis.updateMatrix();\n\n\t\tthis.width = ( width !== undefined ) ? width : 10;\n\t\tthis.height = ( height !== undefined ) ? height : 10;\n\n\t\t// TODO (abelnation): distance/decay\n\n\t\t// TODO (abelnation): update method for RectAreaLight to update transform to lookat target\n\n\t\t// TODO (abelnation): shadows\n\t\t// this.shadow = new THREE.RectAreaLightShadow( new THREE.PerspectiveCamera( 90, 1, 0.5, 500 ) );\n\n\t}\n\n\t// TODO (abelnation): RectAreaLight update when light shape is changed\n\tRectAreaLight.prototype = Object.assign( Object.create( Light.prototype ), {\n\n\t\tconstructor: RectAreaLight,\n\n\t\tisRectAreaLight: true,\n\n\t\tcopy: function ( source ) {\n\n\t\t\tLight.prototype.copy.call( this, source );\n\n\t\t\tthis.width = source.width;\n\t\t\tthis.height = source.height;\n\n\t\t\t// this.shadow = source.shadow.clone();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction StereoCamera() {\n\n\t\tthis.type = 'StereoCamera';\n\n\t\tthis.aspect = 1;\n\n\t\tthis.eyeSep = 0.064;\n\n\t\tthis.cameraL = new PerspectiveCamera();\n\t\tthis.cameraL.layers.enable( 1 );\n\t\tthis.cameraL.matrixAutoUpdate = false;\n\n\t\tthis.cameraR = new PerspectiveCamera();\n\t\tthis.cameraR.layers.enable( 2 );\n\t\tthis.cameraR.matrixAutoUpdate = false;\n\n\t}\n\n\tObject.assign( StereoCamera.prototype, {\n\n\t\tupdate: ( function () {\n\n\t\t\tvar instance, focus, fov, aspect, near, far, zoom;\n\n\t\t\tvar eyeRight = new Matrix4();\n\t\t\tvar eyeLeft = new Matrix4();\n\n\t\t\treturn function update( camera ) {\n\n\t\t\t\tvar needsUpdate = instance !== this || focus !== camera.focus || fov !== camera.fov ||\n\t\t\t\t\t\t\t\t\t\t\t\t\taspect !== camera.aspect * this.aspect || near !== camera.near ||\n\t\t\t\t\t\t\t\t\t\t\t\t\tfar !== camera.far || zoom !== camera.zoom;\n\n\t\t\t\tif ( needsUpdate ) {\n\n\t\t\t\t\tinstance = this;\n\t\t\t\t\tfocus = camera.focus;\n\t\t\t\t\tfov = camera.fov;\n\t\t\t\t\taspect = camera.aspect * this.aspect;\n\t\t\t\t\tnear = camera.near;\n\t\t\t\t\tfar = camera.far;\n\t\t\t\t\tzoom = camera.zoom;\n\n\t\t\t\t\t// Off-axis stereoscopic effect based on\n\t\t\t\t\t// http://paulbourke.net/stereographics/stereorender/\n\n\t\t\t\t\tvar projectionMatrix = camera.projectionMatrix.clone();\n\t\t\t\t\tvar eyeSep = this.eyeSep / 2;\n\t\t\t\t\tvar eyeSepOnProjection = eyeSep * near / focus;\n\t\t\t\t\tvar ymax = ( near * Math.tan( _Math.DEG2RAD * fov * 0.5 ) ) / zoom;\n\t\t\t\t\tvar xmin, xmax;\n\n\t\t\t\t\t// translate xOffset\n\n\t\t\t\t\teyeLeft.elements[ 12 ] = - eyeSep;\n\t\t\t\t\teyeRight.elements[ 12 ] = eyeSep;\n\n\t\t\t\t\t// for left eye\n\n\t\t\t\t\txmin = - ymax * aspect + eyeSepOnProjection;\n\t\t\t\t\txmax = ymax * aspect + eyeSepOnProjection;\n\n\t\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * near / ( xmax - xmin );\n\t\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\t\t\tthis.cameraL.projectionMatrix.copy( projectionMatrix );\n\n\t\t\t\t\t// for right eye\n\n\t\t\t\t\txmin = - ymax * aspect - eyeSepOnProjection;\n\t\t\t\t\txmax = ymax * aspect - eyeSepOnProjection;\n\n\t\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * near / ( xmax - xmin );\n\t\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\t\t\tthis.cameraR.projectionMatrix.copy( projectionMatrix );\n\n\t\t\t\t}\n\n\t\t\t\tthis.cameraL.matrixWorld.copy( camera.matrixWorld ).multiply( eyeLeft );\n\t\t\t\tthis.cameraR.matrixWorld.copy( camera.matrixWorld ).multiply( eyeRight );\n\n\t\t\t};\n\n\t\t} )()\n\n\t} );\n\n\t/**\n\t * Camera for rendering cube maps\n\t *\t- renders scene into axis-aligned cube\n\t *\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction CubeCamera( near, far, cubeResolution ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'CubeCamera';\n\n\t\tvar fov = 90, aspect = 1;\n\n\t\tvar cameraPX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPX.up.set( 0, - 1, 0 );\n\t\tcameraPX.lookAt( new Vector3( 1, 0, 0 ) );\n\t\tthis.add( cameraPX );\n\n\t\tvar cameraNX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNX.up.set( 0, - 1, 0 );\n\t\tcameraNX.lookAt( new Vector3( - 1, 0, 0 ) );\n\t\tthis.add( cameraNX );\n\n\t\tvar cameraPY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPY.up.set( 0, 0, 1 );\n\t\tcameraPY.lookAt( new Vector3( 0, 1, 0 ) );\n\t\tthis.add( cameraPY );\n\n\t\tvar cameraNY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNY.up.set( 0, 0, - 1 );\n\t\tcameraNY.lookAt( new Vector3( 0, - 1, 0 ) );\n\t\tthis.add( cameraNY );\n\n\t\tvar cameraPZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPZ.up.set( 0, - 1, 0 );\n\t\tcameraPZ.lookAt( new Vector3( 0, 0, 1 ) );\n\t\tthis.add( cameraPZ );\n\n\t\tvar cameraNZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNZ.up.set( 0, - 1, 0 );\n\t\tcameraNZ.lookAt( new Vector3( 0, 0, - 1 ) );\n\t\tthis.add( cameraNZ );\n\n\t\tvar options = { format: RGBFormat, magFilter: LinearFilter, minFilter: LinearFilter, name: \"cubeCamera\" };\n\n\t\tthis.renderTarget = new WebGLRenderTargetCube( cubeResolution, cubeResolution, options );\n\n\t\tthis.updateCubeMap = function ( renderer, scene ) {\n\n\t\t\tif ( this.parent === null ) this.updateMatrixWorld();\n\n\t\t\tvar renderTarget = this.renderTarget;\n\t\t\tvar generateMipmaps = renderTarget.texture.generateMipmaps;\n\n\t\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\t\trenderTarget.activeCubeFace = 0;\n\t\t\trenderer.render( scene, cameraPX, renderTarget );\n\n\t\t\trenderTarget.activeCubeFace = 1;\n\t\t\trenderer.render( scene, cameraNX, renderTarget );\n\n\t\t\trenderTarget.activeCubeFace = 2;\n\t\t\trenderer.render( scene, cameraPY, renderTarget );\n\n\t\t\trenderTarget.activeCubeFace = 3;\n\t\t\trenderer.render( scene, cameraNY, renderTarget );\n\n\t\t\trenderTarget.activeCubeFace = 4;\n\t\t\trenderer.render( scene, cameraPZ, renderTarget );\n\n\t\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\n\n\t\t\trenderTarget.activeCubeFace = 5;\n\t\t\trenderer.render( scene, cameraNZ, renderTarget );\n\n\t\t\trenderer.setRenderTarget( null );\n\n\t\t};\n\n\t}\n\n\tCubeCamera.prototype = Object.create( Object3D.prototype );\n\tCubeCamera.prototype.constructor = CubeCamera;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction AudioListener() {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'AudioListener';\n\n\t\tthis.context = AudioContext.getContext();\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( this.context.destination );\n\n\t\tthis.filter = null;\n\n\t}\n\n\tAudioListener.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: AudioListener,\n\n\t\tgetInput: function () {\n\n\t\t\treturn this.gain;\n\n\t\t},\n\n\t\tremoveFilter: function ( ) {\n\n\t\t\tif ( this.filter !== null ) {\n\n\t\t\t\tthis.gain.disconnect( this.filter );\n\t\t\t\tthis.filter.disconnect( this.context.destination );\n\t\t\t\tthis.gain.connect( this.context.destination );\n\t\t\t\tthis.filter = null;\n\n\t\t\t}\n\n\t\t},\n\n\t\tgetFilter: function () {\n\n\t\t\treturn this.filter;\n\n\t\t},\n\n\t\tsetFilter: function ( value ) {\n\n\t\t\tif ( this.filter !== null ) {\n\n\t\t\t\tthis.gain.disconnect( this.filter );\n\t\t\t\tthis.filter.disconnect( this.context.destination );\n\n\t\t\t} else {\n\n\t\t\t\tthis.gain.disconnect( this.context.destination );\n\n\t\t\t}\n\n\t\t\tthis.filter = value;\n\t\t\tthis.gain.connect( this.filter );\n\t\t\tthis.filter.connect( this.context.destination );\n\n\t\t},\n\n\t\tgetMasterVolume: function () {\n\n\t\t\treturn this.gain.gain.value;\n\n\t\t},\n\n\t\tsetMasterVolume: function ( value ) {\n\n\t\t\tthis.gain.gain.value = value;\n\n\t\t},\n\n\t\tupdateMatrixWorld: ( function () {\n\n\t\t\tvar position = new Vector3();\n\t\t\tvar quaternion = new Quaternion();\n\t\t\tvar scale = new Vector3();\n\n\t\t\tvar orientation = new Vector3();\n\n\t\t\treturn function updateMatrixWorld( force ) {\n\n\t\t\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\n\n\t\t\t\tvar listener = this.context.listener;\n\t\t\t\tvar up = this.up;\n\n\t\t\t\tthis.matrixWorld.decompose( position, quaternion, scale );\n\n\t\t\t\torientation.set( 0, 0, - 1 ).applyQuaternion( quaternion );\n\n\t\t\t\tif ( listener.positionX ) {\n\n\t\t\t\t\tlistener.positionX.setValueAtTime( position.x, this.context.currentTime );\n\t\t\t\t\tlistener.positionY.setValueAtTime( position.y, this.context.currentTime );\n\t\t\t\t\tlistener.positionZ.setValueAtTime( position.z, this.context.currentTime );\n\t\t\t\t\tlistener.forwardX.setValueAtTime( orientation.x, this.context.currentTime );\n\t\t\t\t\tlistener.forwardY.setValueAtTime( orientation.y, this.context.currentTime );\n\t\t\t\t\tlistener.forwardZ.setValueAtTime( orientation.z, this.context.currentTime );\n\t\t\t\t\tlistener.upX.setValueAtTime( up.x, this.context.currentTime );\n\t\t\t\t\tlistener.upY.setValueAtTime( up.y, this.context.currentTime );\n\t\t\t\t\tlistener.upZ.setValueAtTime( up.z, this.context.currentTime );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tlistener.setPosition( position.x, position.y, position.z );\n\t\t\t\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, up.x, up.y, up.z );\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t} )()\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author Reece Aaron Lecrivain / http://reecenotes.com/\n\t */\n\n\tfunction Audio( listener ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.type = 'Audio';\n\n\t\tthis.context = listener.context;\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( listener.getInput() );\n\n\t\tthis.autoplay = false;\n\n\t\tthis.buffer = null;\n\t\tthis.loop = false;\n\t\tthis.startTime = 0;\n\t\tthis.playbackRate = 1;\n\t\tthis.isPlaying = false;\n\t\tthis.hasPlaybackControl = true;\n\t\tthis.sourceType = 'empty';\n\n\t\tthis.filters = [];\n\n\t}\n\n\tAudio.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\t\tconstructor: Audio,\n\n\t\tgetOutput: function () {\n\n\t\t\treturn this.gain;\n\n\t\t},\n\n\t\tsetNodeSource: function ( audioNode ) {\n\n\t\t\tthis.hasPlaybackControl = false;\n\t\t\tthis.sourceType = 'audioNode';\n\t\t\tthis.source = audioNode;\n\t\t\tthis.connect();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetBuffer: function ( audioBuffer ) {\n\n\t\t\tthis.buffer = audioBuffer;\n\t\t\tthis.sourceType = 'buffer';\n\n\t\t\tif ( this.autoplay ) this.play();\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tplay: function () {\n\n\t\t\tif ( this.isPlaying === true ) {\n\n\t\t\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tvar source = this.context.createBufferSource();\n\n\t\t\tsource.buffer = this.buffer;\n\t\t\tsource.loop = this.loop;\n\t\t\tsource.onended = this.onEnded.bind( this );\n\t\t\tsource.playbackRate.setValueAtTime( this.playbackRate, this.startTime );\n\t\t\tsource.start( 0, this.startTime );\n\n\t\t\tthis.isPlaying = true;\n\n\t\t\tthis.source = source;\n\n\t\t\treturn this.connect();\n\n\t\t},\n\n\t\tpause: function () {\n\n\t\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tthis.source.stop();\n\t\t\tthis.startTime = this.context.currentTime;\n\t\t\tthis.isPlaying = false;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tstop: function () {\n\n\t\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tthis.source.stop();\n\t\t\tthis.startTime = 0;\n\t\t\tthis.isPlaying = false;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tconnect: function () {\n\n\t\t\tif ( this.filters.length > 0 ) {\n\n\t\t\t\tthis.source.connect( this.filters[ 0 ] );\n\n\t\t\t\tfor ( var i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\t\tthis.filters[ i - 1 ].connect( this.filters[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\tthis.filters[ this.filters.length - 1 ].connect( this.getOutput() );\n\n\t\t\t} else {\n\n\t\t\t\tthis.source.connect( this.getOutput() );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tdisconnect: function () {\n\n\t\t\tif ( this.filters.length > 0 ) {\n\n\t\t\t\tthis.source.disconnect( this.filters[ 0 ] );\n\n\t\t\t\tfor ( var i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\t\tthis.filters[ i - 1 ].disconnect( this.filters[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\tthis.filters[ this.filters.length - 1 ].disconnect( this.getOutput() );\n\n\t\t\t} else {\n\n\t\t\t\tthis.source.disconnect( this.getOutput() );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetFilters: function () {\n\n\t\t\treturn this.filters;\n\n\t\t},\n\n\t\tsetFilters: function ( value ) {\n\n\t\t\tif ( ! value ) value = [];\n\n\t\t\tif ( this.isPlaying === true ) {\n\n\t\t\t\tthis.disconnect();\n\t\t\t\tthis.filters = value;\n\t\t\t\tthis.connect();\n\n\t\t\t} else {\n\n\t\t\t\tthis.filters = value;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetFilter: function () {\n\n\t\t\treturn this.getFilters()[ 0 ];\n\n\t\t},\n\n\t\tsetFilter: function ( filter ) {\n\n\t\t\treturn this.setFilters( filter ? [ filter ] : [] );\n\n\t\t},\n\n\t\tsetPlaybackRate: function ( value ) {\n\n\t\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tthis.playbackRate = value;\n\n\t\t\tif ( this.isPlaying === true ) {\n\n\t\t\t\tthis.source.playbackRate.setValueAtTime( this.playbackRate, this.context.currentTime );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetPlaybackRate: function () {\n\n\t\t\treturn this.playbackRate;\n\n\t\t},\n\n\t\tonEnded: function () {\n\n\t\t\tthis.isPlaying = false;\n\n\t\t},\n\n\t\tgetLoop: function () {\n\n\t\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t\treturn this.loop;\n\n\t\t},\n\n\t\tsetLoop: function ( value ) {\n\n\t\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tthis.loop = value;\n\n\t\t\tif ( this.isPlaying === true ) {\n\n\t\t\t\tthis.source.loop = this.loop;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetVolume: function () {\n\n\t\t\treturn this.gain.gain.value;\n\n\t\t},\n\n\n\t\tsetVolume: function ( value ) {\n\n\t\t\tthis.gain.gain.value = value;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction PositionalAudio( listener ) {\n\n\t\tAudio.call( this, listener );\n\n\t\tthis.panner = this.context.createPanner();\n\t\tthis.panner.connect( this.gain );\n\n\t}\n\n\tPositionalAudio.prototype = Object.assign( Object.create( Audio.prototype ), {\n\n\t\tconstructor: PositionalAudio,\n\n\t\tgetOutput: function () {\n\n\t\t\treturn this.panner;\n\n\t\t},\n\n\t\tgetRefDistance: function () {\n\n\t\t\treturn this.panner.refDistance;\n\n\t\t},\n\n\t\tsetRefDistance: function ( value ) {\n\n\t\t\tthis.panner.refDistance = value;\n\n\t\t},\n\n\t\tgetRolloffFactor: function () {\n\n\t\t\treturn this.panner.rolloffFactor;\n\n\t\t},\n\n\t\tsetRolloffFactor: function ( value ) {\n\n\t\t\tthis.panner.rolloffFactor = value;\n\n\t\t},\n\n\t\tgetDistanceModel: function () {\n\n\t\t\treturn this.panner.distanceModel;\n\n\t\t},\n\n\t\tsetDistanceModel: function ( value ) {\n\n\t\t\tthis.panner.distanceModel = value;\n\n\t\t},\n\n\t\tgetMaxDistance: function () {\n\n\t\t\treturn this.panner.maxDistance;\n\n\t\t},\n\n\t\tsetMaxDistance: function ( value ) {\n\n\t\t\tthis.panner.maxDistance = value;\n\n\t\t},\n\n\t\tupdateMatrixWorld: ( function () {\n\n\t\t\tvar position = new Vector3();\n\n\t\t\treturn function updateMatrixWorld( force ) {\n\n\t\t\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\n\n\t\t\t\tposition.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\t\tthis.panner.setPosition( position.x, position.y, position.z );\n\n\t\t\t};\n\n\t\t} )()\n\n\n\t} );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction AudioAnalyser( audio, fftSize ) {\n\n\t\tthis.analyser = audio.context.createAnalyser();\n\t\tthis.analyser.fftSize = fftSize !== undefined ? fftSize : 2048;\n\n\t\tthis.data = new Uint8Array( this.analyser.frequencyBinCount );\n\n\t\taudio.getOutput().connect( this.analyser );\n\n\t}\n\n\tObject.assign( AudioAnalyser.prototype, {\n\n\t\tgetFrequencyData: function () {\n\n\t\t\tthis.analyser.getByteFrequencyData( this.data );\n\n\t\t\treturn this.data;\n\n\t\t},\n\n\t\tgetAverageFrequency: function () {\n\n\t\t\tvar value = 0, data = this.getFrequencyData();\n\n\t\t\tfor ( var i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tvalue += data[ i ];\n\n\t\t\t}\n\n\t\t\treturn value / data.length;\n\n\t\t}\n\n\t} );\n\n\t/**\n\t *\n\t * Buffered scene graph property that allows weighted accumulation.\n\t *\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction PropertyMixer( binding, typeName, valueSize ) {\n\n\t\tthis.binding = binding;\n\t\tthis.valueSize = valueSize;\n\n\t\tvar bufferType = Float64Array,\n\t\t\tmixFunction;\n\n\t\tswitch ( typeName ) {\n\n\t\t\tcase 'quaternion':\n\t\t\t\tmixFunction = this._slerp;\n\t\t\t\tbreak;\n\n\t\t\tcase 'string':\n\t\t\tcase 'bool':\n\t\t\t\tbufferType = Array;\n\t\t\t\tmixFunction = this._select;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tmixFunction = this._lerp;\n\n\t\t}\n\n\t\tthis.buffer = new bufferType( valueSize * 4 );\n\t\t// layout: [ incoming | accu0 | accu1 | orig ]\n\t\t//\n\t\t// interpolators can use .buffer as their .result\n\t\t// the data then goes to 'incoming'\n\t\t//\n\t\t// 'accu0' and 'accu1' are used frame-interleaved for\n\t\t// the cumulative result and are compared to detect\n\t\t// changes\n\t\t//\n\t\t// 'orig' stores the original state of the property\n\n\t\tthis._mixBufferRegion = mixFunction;\n\n\t\tthis.cumulativeWeight = 0;\n\n\t\tthis.useCount = 0;\n\t\tthis.referenceCount = 0;\n\n\t}\n\n\tPropertyMixer.prototype = {\n\n\t\tconstructor: PropertyMixer,\n\n\t\t// accumulate data in the 'incoming' region into 'accu<i>'\n\t\taccumulate: function( accuIndex, weight ) {\n\n\t\t\t// note: happily accumulating nothing when weight = 0, the caller knows\n\t\t\t// the weight and shouldn't have made the call in the first place\n\n\t\t\tvar buffer = this.buffer,\n\t\t\t\tstride = this.valueSize,\n\t\t\t\toffset = accuIndex * stride + stride,\n\n\t\t\t\tcurrentWeight = this.cumulativeWeight;\n\n\t\t\tif ( currentWeight === 0 ) {\n\n\t\t\t\t// accuN := incoming * weight\n\n\t\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\n\n\t\t\t\t\tbuffer[ offset + i ] = buffer[ i ];\n\n\t\t\t\t}\n\n\t\t\t\tcurrentWeight = weight;\n\n\t\t\t} else {\n\n\t\t\t\t// accuN := accuN + incoming * weight\n\n\t\t\t\tcurrentWeight += weight;\n\t\t\t\tvar mix = weight / currentWeight;\n\t\t\t\tthis._mixBufferRegion( buffer, offset, 0, mix, stride );\n\n\t\t\t}\n\n\t\t\tthis.cumulativeWeight = currentWeight;\n\n\t\t},\n\n\t\t// apply the state of 'accu<i>' to the binding when accus differ\n\t\tapply: function( accuIndex ) {\n\n\t\t\tvar stride = this.valueSize,\n\t\t\t\tbuffer = this.buffer,\n\t\t\t\toffset = accuIndex * stride + stride,\n\n\t\t\t\tweight = this.cumulativeWeight,\n\n\t\t\t\tbinding = this.binding;\n\n\t\t\tthis.cumulativeWeight = 0;\n\n\t\t\tif ( weight < 1 ) {\n\n\t\t\t\t// accuN := accuN + original * ( 1 - cumulativeWeight )\n\n\t\t\t\tvar originalValueOffset = stride * 3;\n\n\t\t\t\tthis._mixBufferRegion(\n\t\t\t\t\t\tbuffer, offset, originalValueOffset, 1 - weight, stride );\n\n\t\t\t}\n\n\t\t\tfor ( var i = stride, e = stride + stride; i !== e; ++ i ) {\n\n\t\t\t\tif ( buffer[ i ] !== buffer[ i + stride ] ) {\n\n\t\t\t\t\t// value has changed -> update scene graph\n\n\t\t\t\t\tbinding.setValue( buffer, offset );\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\t// remember the state of the bound property and copy it to both accus\n\t\tsaveOriginalState: function() {\n\n\t\t\tvar binding = this.binding;\n\n\t\t\tvar buffer = this.buffer,\n\t\t\t\tstride = this.valueSize,\n\n\t\t\t\toriginalValueOffset = stride * 3;\n\n\t\t\tbinding.getValue( buffer, originalValueOffset );\n\n\t\t\t// accu[0..1] := orig -- initially detect changes against the original\n\t\t\tfor ( var i = stride, e = originalValueOffset; i !== e; ++ i ) {\n\n\t\t\t\tbuffer[ i ] = buffer[ originalValueOffset + ( i % stride ) ];\n\n\t\t\t}\n\n\t\t\tthis.cumulativeWeight = 0;\n\n\t\t},\n\n\t\t// apply the state previously taken via 'saveOriginalState' to the binding\n\t\trestoreOriginalState: function() {\n\n\t\t\tvar originalValueOffset = this.valueSize * 3;\n\t\t\tthis.binding.setValue( this.buffer, originalValueOffset );\n\n\t\t},\n\n\n\t\t// mix functions\n\n\t\t_select: function( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\t\tif ( t >= 0.5 ) {\n\n\t\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\n\n\t\t\t\t\tbuffer[ dstOffset + i ] = buffer[ srcOffset + i ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\t_slerp: function( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\t\tQuaternion.slerpFlat( buffer, dstOffset,\n\t\t\t\t\tbuffer, dstOffset, buffer, srcOffset, t );\n\n\t\t},\n\n\t\t_lerp: function( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\t\tvar s = 1 - t;\n\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tvar j = dstOffset + i;\n\n\t\t\t\tbuffer[ j ] = buffer[ j ] * s + buffer[ srcOffset + i ] * t;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\t/**\n\t *\n\t * A reference to a real property in the scene graph.\n\t *\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction PropertyBinding( rootNode, path, parsedPath ) {\n\n\t\tthis.path = path;\n\t\tthis.parsedPath = parsedPath ||\n\t\t\t\tPropertyBinding.parseTrackName( path );\n\n\t\tthis.node = PropertyBinding.findNode(\n\t\t\t\trootNode, this.parsedPath.nodeName ) || rootNode;\n\n\t\tthis.rootNode = rootNode;\n\n\t}\n\n\tPropertyBinding.prototype = {\n\n\t\tconstructor: PropertyBinding,\n\n\t\tgetValue: function getValue_unbound( targetArray, offset ) {\n\n\t\t\tthis.bind();\n\t\t\tthis.getValue( targetArray, offset );\n\n\t\t\t// Note: This class uses a State pattern on a per-method basis:\n\t\t\t// 'bind' sets 'this.getValue' / 'setValue' and shadows the\n\t\t\t// prototype version of these methods with one that represents\n\t\t\t// the bound state. When the property is not found, the methods\n\t\t\t// become no-ops.\n\n\t\t},\n\n\t\tsetValue: function getValue_unbound( sourceArray, offset ) {\n\n\t\t\tthis.bind();\n\t\t\tthis.setValue( sourceArray, offset );\n\n\t\t},\n\n\t\t// create getter / setter pair for a property in the scene graph\n\t\tbind: function() {\n\n\t\t\tvar targetObject = this.node,\n\t\t\t\tparsedPath = this.parsedPath,\n\n\t\t\t\tobjectName = parsedPath.objectName,\n\t\t\t\tpropertyName = parsedPath.propertyName,\n\t\t\t\tpropertyIndex = parsedPath.propertyIndex;\n\n\t\t\tif ( ! targetObject ) {\n\n\t\t\t\ttargetObject = PropertyBinding.findNode(\n\t\t\t\t\t\tthis.rootNode, parsedPath.nodeName ) || this.rootNode;\n\n\t\t\t\tthis.node = targetObject;\n\n\t\t\t}\n\n\t\t\t// set fail state so we can just 'return' on error\n\t\t\tthis.getValue = this._getValue_unavailable;\n\t\t\tthis.setValue = this._setValue_unavailable;\n\n\t \t\t// ensure there is a value node\n\t\t\tif ( ! targetObject ) {\n\n\t\t\t\tconsole.error( \"  trying to update node for track: \" + this.path + \" but it wasn't found.\" );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( objectName ) {\n\n\t\t\t\tvar objectIndex = parsedPath.objectIndex;\n\n\t\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\n\t\t\t\tswitch ( objectName ) {\n\n\t\t\t\t\tcase 'materials':\n\n\t\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\t\tconsole.error( '  can not bind to material as node does not have a material', this );\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( ! targetObject.material.materials ) {\n\n\t\t\t\t\t\t\tconsole.error( '  can not bind to material.materials as node.material does not have a materials array', this );\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttargetObject = targetObject.material.materials;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'bones':\n\n\t\t\t\t\t\tif ( ! targetObject.skeleton ) {\n\n\t\t\t\t\t\t\tconsole.error( '  can not bind to bones as node does not have a skeleton', this );\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\n\t\t\t\t\t\t// and convert the integer string to a true integer.\n\n\t\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\n\n\t\t\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\t\t\tfor ( var i = 0; i < targetObject.length; i ++ ) {\n\n\t\t\t\t\t\t\tif ( targetObject[ i ].name === objectIndex ) {\n\n\t\t\t\t\t\t\t\tobjectIndex = i;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.error( '  can not bind to objectName of node, undefined', this );\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttargetObject = targetObject[ objectName ];\n\n\t\t\t\t}\n\n\n\t\t\t\tif ( objectIndex !== undefined ) {\n\n\t\t\t\t\tif ( targetObject[ objectIndex ] === undefined ) {\n\n\t\t\t\t\t\tconsole.error( \"  trying to bind to objectIndex of objectName, but is undefined:\", this, targetObject );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject[ objectIndex ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// resolve property\n\t\t\tvar nodeProperty = targetObject[ propertyName ];\n\n\t\t\tif ( nodeProperty === undefined ) {\n\n\t\t\t\tvar nodeName = parsedPath.nodeName;\n\n\t\t\t\tconsole.error( \"  trying to update property for track: \" + nodeName +\n\t\t\t\t\t\t'.' + propertyName + \" but it wasn't found.\", targetObject );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// determine versioning scheme\n\t\t\tvar versioning = this.Versioning.None;\n\n\t\t\tif ( targetObject.needsUpdate !== undefined ) { // material\n\n\t\t\t\tversioning = this.Versioning.NeedsUpdate;\n\t\t\t\tthis.targetObject = targetObject;\n\n\t\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\n\n\t\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\n\t\t\t\tthis.targetObject = targetObject;\n\n\t\t\t}\n\n\t\t\t// determine how the property gets bound\n\t\t\tvar bindingType = this.BindingType.Direct;\n\n\t\t\tif ( propertyIndex !== undefined ) {\n\t\t\t\t// access a sub element of the property array (only primitives are supported right now)\n\n\t\t\t\tif ( propertyName === \"morphTargetInfluences\" ) {\n\t\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\n\n\t\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\t\tif ( ! targetObject.geometry ) {\n\n\t\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.geometry.morphTargets ) {\n\n\t\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var i = 0; i < this.node.geometry.morphTargets.length; i ++ ) {\n\n\t\t\t\t\t\tif ( targetObject.geometry.morphTargets[ i ].name === propertyIndex ) {\n\n\t\t\t\t\t\t\tpropertyIndex = i;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tbindingType = this.BindingType.ArrayElement;\n\n\t\t\t\tthis.resolvedProperty = nodeProperty;\n\t\t\t\tthis.propertyIndex = propertyIndex;\n\n\t\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\n\t\t\t\t// must use copy for Object3D.Euler/Quaternion\n\n\t\t\t\tbindingType = this.BindingType.HasFromToArray;\n\n\t\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t\t} else if ( nodeProperty.length !== undefined ) {\n\n\t\t\t\tbindingType = this.BindingType.EntireArray;\n\n\t\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t\t} else {\n\n\t\t\t\tthis.propertyName = propertyName;\n\n\t\t\t}\n\n\t\t\t// select getter / setter\n\t\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\n\t\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\n\n\t\t},\n\n\t\tunbind: function() {\n\n\t\t\tthis.node = null;\n\n\t\t\t// back to the prototype version of getValue / setValue\n\t\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\n\t\t\tthis.getValue = this._getValue_unbound;\n\t\t\tthis.setValue = this._setValue_unbound;\n\n\t\t}\n\n\t};\n\n\tObject.assign( PropertyBinding.prototype, { // prototype, continued\n\n\t\t// these are used to \"bind\" a nonexistent property\n\t\t_getValue_unavailable: function() {},\n\t\t_setValue_unavailable: function() {},\n\n\t\t// initial state of these methods that calls 'bind'\n\t\t_getValue_unbound: PropertyBinding.prototype.getValue,\n\t\t_setValue_unbound: PropertyBinding.prototype.setValue,\n\n\t\tBindingType: {\n\t\t\tDirect: 0,\n\t\t\tEntireArray: 1,\n\t\t\tArrayElement: 2,\n\t\t\tHasFromToArray: 3\n\t\t},\n\n\t\tVersioning: {\n\t\t\tNone: 0,\n\t\t\tNeedsUpdate: 1,\n\t\t\tMatrixWorldNeedsUpdate: 2\n\t\t},\n\n\t\tGetterByBindingType: [\n\n\t\t\tfunction getValue_direct( buffer, offset ) {\n\n\t\t\t\tbuffer[ offset ] = this.node[ this.propertyName ];\n\n\t\t\t},\n\n\t\t\tfunction getValue_array( buffer, offset ) {\n\n\t\t\t\tvar source = this.resolvedProperty;\n\n\t\t\t\tfor ( var i = 0, n = source.length; i !== n; ++ i ) {\n\n\t\t\t\t\tbuffer[ offset ++ ] = source[ i ];\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tfunction getValue_arrayElement( buffer, offset ) {\n\n\t\t\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\n\n\t\t\t},\n\n\t\t\tfunction getValue_toArray( buffer, offset ) {\n\n\t\t\t\tthis.resolvedProperty.toArray( buffer, offset );\n\n\t\t\t}\n\n\t\t],\n\n\t\tSetterByBindingTypeAndVersioning: [\n\n\t\t\t[\n\t\t\t\t// Direct\n\n\t\t\t\tfunction setValue_direct( buffer, offset ) {\n\n\t\t\t\t\tthis.node[ this.propertyName ] = buffer[ offset ];\n\n\t\t\t\t},\n\n\t\t\t\tfunction setValue_direct_setNeedsUpdate( buffer, offset ) {\n\n\t\t\t\t\tthis.node[ this.propertyName ] = buffer[ offset ];\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\n\n\t\t\t\t},\n\n\t\t\t\tfunction setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\t\t\t\tthis.node[ this.propertyName ] = buffer[ offset ];\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t], [\n\n\t\t\t\t// EntireArray\n\n\t\t\t\tfunction setValue_array( buffer, offset ) {\n\n\t\t\t\t\tvar dest = this.resolvedProperty;\n\n\t\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tfunction setValue_array_setNeedsUpdate( buffer, offset ) {\n\n\t\t\t\t\tvar dest = this.resolvedProperty;\n\n\t\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\n\n\t\t\t\t},\n\n\t\t\t\tfunction setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\t\t\t\tvar dest = this.resolvedProperty;\n\n\t\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t], [\n\n\t\t\t\t// ArrayElement\n\n\t\t\t\tfunction setValue_arrayElement( buffer, offset ) {\n\n\t\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\n\t\t\t\t},\n\n\t\t\t\tfunction setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\n\n\t\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\n\n\t\t\t\t},\n\n\t\t\t\tfunction setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t], [\n\n\t\t\t\t// HasToFromArray\n\n\t\t\t\tfunction setValue_fromArray( buffer, offset ) {\n\n\t\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\n\t\t\t\t},\n\n\t\t\t\tfunction setValue_fromArray_setNeedsUpdate( buffer, offset ) {\n\n\t\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\n\n\t\t\t\t},\n\n\t\t\t\tfunction setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t]\n\n\t\t]\n\n\t} );\n\n\tPropertyBinding.Composite =\n\t\t\tfunction( targetGroup, path, optionalParsedPath ) {\n\n\t\tvar parsedPath = optionalParsedPath ||\n\t\t\t\tPropertyBinding.parseTrackName( path );\n\n\t\tthis._targetGroup = targetGroup;\n\t\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\n\n\t};\n\n\tPropertyBinding.Composite.prototype = {\n\n\t\tconstructor: PropertyBinding.Composite,\n\n\t\tgetValue: function( array, offset ) {\n\n\t\t\tthis.bind(); // bind all binding\n\n\t\t\tvar firstValidIndex = this._targetGroup.nCachedObjects_,\n\t\t\t\tbinding = this._bindings[ firstValidIndex ];\n\n\t\t\t// and only call .getValue on the first\n\t\t\tif ( binding !== undefined ) binding.getValue( array, offset );\n\n\t\t},\n\n\t\tsetValue: function( array, offset ) {\n\n\t\t\tvar bindings = this._bindings;\n\n\t\t\tfor ( var i = this._targetGroup.nCachedObjects_,\n\t\t\t\t\tn = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tbindings[ i ].setValue( array, offset );\n\n\t\t\t}\n\n\t\t},\n\n\t\tbind: function() {\n\n\t\t\tvar bindings = this._bindings;\n\n\t\t\tfor ( var i = this._targetGroup.nCachedObjects_,\n\t\t\t\t\tn = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tbindings[ i ].bind();\n\n\t\t\t}\n\n\t\t},\n\n\t\tunbind: function() {\n\n\t\t\tvar bindings = this._bindings;\n\n\t\t\tfor ( var i = this._targetGroup.nCachedObjects_,\n\t\t\t\t\tn = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tbindings[ i ].unbind();\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tPropertyBinding.create = function( root, path, parsedPath ) {\n\n\t\tif ( ! ( root && root.isAnimationObjectGroup ) ) {\n\n\t\t\treturn new PropertyBinding( root, path, parsedPath );\n\n\t\t} else {\n\n\t\t\treturn new PropertyBinding.Composite( root, path, parsedPath );\n\n\t\t}\n\n\t};\n\n\tPropertyBinding.parseTrackName = function( trackName ) {\n\n\t\t// matches strings in the form of:\n\t\t//    nodeName.property\n\t\t//    nodeName.property[accessor]\n\t\t//    nodeName.material.property[accessor]\n\t\t//    uuid.property[accessor]\n\t\t//    uuid.objectName[objectIndex].propertyName[propertyIndex]\n\t\t//    parentName/nodeName.property\n\t\t//    parentName/parentName/nodeName.property[index]\n\t\t//    .bone[Armature.DEF_cog].position\n\t\t//    scene:helium_balloon_model:helium_balloon_model.position\n\t\t// created and tested via https://regex101.com/#javascript\n\n\t\tvar re = /^((?:[\\w-]+[\\/:])*)([\\w-]+)?(?:\\.([\\w-]+)(?:\\[(.+)\\])?)?\\.([\\w-]+)(?:\\[(.+)\\])?$/;\n\t\tvar matches = re.exec( trackName );\n\n\t\tif ( ! matches ) {\n\n\t\t\tthrow new Error( \"cannot parse trackName at all: \" + trackName );\n\n\t\t}\n\n\t\tvar results = {\n\t\t\t// directoryName: matches[ 1 ], // (tschw) currently unused\n\t\t\tnodeName: matches[ 2 ], \t// allowed to be null, specified root node.\n\t\t\tobjectName: matches[ 3 ],\n\t\t\tobjectIndex: matches[ 4 ],\n\t\t\tpropertyName: matches[ 5 ],\n\t\t\tpropertyIndex: matches[ 6 ]\t// allowed to be null, specifies that the whole property is set.\n\t\t};\n\n\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\n\n\t\t\tthrow new Error( \"can not parse propertyName from trackName: \" + trackName );\n\n\t\t}\n\n\t\treturn results;\n\n\t};\n\n\tPropertyBinding.findNode = function( root, nodeName ) {\n\n\t\tif ( ! nodeName || nodeName === \"\" || nodeName === \"root\" || nodeName === \".\" || nodeName === -1 || nodeName === root.name || nodeName === root.uuid ) {\n\n\t\t\treturn root;\n\n\t\t}\n\n\t\t// search into skeleton bones.\n\t\tif ( root.skeleton ) {\n\n\t\t\tvar searchSkeleton = function( skeleton ) {\n\n\t\t\t\tfor( var i = 0; i < skeleton.bones.length; i ++ ) {\n\n\t\t\t\t\tvar bone = skeleton.bones[ i ];\n\n\t\t\t\t\tif ( bone.name === nodeName ) {\n\n\t\t\t\t\t\treturn bone;\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t};\n\n\t\t\tvar bone = searchSkeleton( root.skeleton );\n\n\t\t\tif ( bone ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\t\t}\n\n\t\t// search into node subtree.\n\t\tif ( root.children ) {\n\n\t\t\tvar searchNodeSubtree = function( children ) {\n\n\t\t\t\tfor( var i = 0; i < children.length; i ++ ) {\n\n\t\t\t\t\tvar childNode = children[ i ];\n\n\t\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\n\n\t\t\t\t\t\treturn childNode;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar result = searchNodeSubtree( childNode.children );\n\n\t\t\t\t\tif ( result ) return result;\n\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t};\n\n\t\t\tvar subTreeNode = searchNodeSubtree( root.children );\n\n\t\t\tif ( subTreeNode ) {\n\n\t\t\t\treturn subTreeNode;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t};\n\n\t/**\n\t *\n\t * A group of objects that receives a shared animation state.\n\t *\n\t * Usage:\n\t *\n\t * \t-\tAdd objects you would otherwise pass as 'root' to the\n\t * \t\tconstructor or the .clipAction method of AnimationMixer.\n\t *\n\t * \t-\tInstead pass this object as 'root'.\n\t *\n\t * \t-\tYou can also add and remove objects later when the mixer\n\t * \t\tis running.\n\t *\n\t * Note:\n\t *\n\t *  \tObjects of this class appear as one object to the mixer,\n\t *  \tso cache control of the individual objects must be done\n\t *  \ton the group.\n\t *\n\t * Limitation:\n\t *\n\t * \t- \tThe animated properties must be compatible among the\n\t * \t\tall objects in the group.\n\t *\n\t *  -\tA single property can either be controlled through a\n\t *  \ttarget group or directly, but not both.\n\t *\n\t * @author tschw\n\t */\n\n\tfunction AnimationObjectGroup( var_args ) {\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\t// cached objects followed by the active ones\n\t\tthis._objects = Array.prototype.slice.call( arguments );\n\n\t\tthis.nCachedObjects_ = 0;\t\t\t// threshold\n\t\t// note: read by PropertyBinding.Composite\n\n\t\tvar indices = {};\n\t\tthis._indicesByUUID = indices;\t\t// for bookkeeping\n\n\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tindices[ arguments[ i ].uuid ] = i;\n\n\t\t}\n\n\t\tthis._paths = [];\t\t\t\t\t// inside: string\n\t\tthis._parsedPaths = [];\t\t\t\t// inside: { we don't care, here }\n\t\tthis._bindings = []; \t\t\t\t// inside: Array< PropertyBinding >\n\t\tthis._bindingsIndicesByPath = {}; \t// inside: indices in these arrays\n\n\t\tvar scope = this;\n\n\t\tthis.stats = {\n\n\t\t\tobjects: {\n\t\t\t\tget total() { return scope._objects.length; },\n\t\t\t\tget inUse() { return this.total - scope.nCachedObjects_;  }\n\t\t\t},\n\n\t\t\tget bindingsPerObject() { return scope._bindings.length; }\n\n\t\t};\n\n\t}\n\n\tAnimationObjectGroup.prototype = {\n\n\t\tconstructor: AnimationObjectGroup,\n\n\t\tisAnimationObjectGroup: true,\n\n\t\tadd: function( var_args ) {\n\n\t\t\tvar objects = this._objects,\n\t\t\t\tnObjects = objects.length,\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\n\t\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\t\tpaths = this._paths,\n\t\t\t\tparsedPaths = this._parsedPaths,\n\t\t\t\tbindings = this._bindings,\n\t\t\t\tnBindings = bindings.length;\n\n\t\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\t\tvar object = arguments[ i ],\n\t\t\t\t\tuuid = object.uuid,\n\t\t\t\t\tindex = indicesByUUID[ uuid ],\n\t\t\t\t\tknownObject = undefined;\n\n\t\t\t\tif ( index === undefined ) {\n\n\t\t\t\t\t// unknown object -> add it to the ACTIVE region\n\n\t\t\t\t\tindex = nObjects ++;\n\t\t\t\t\tindicesByUUID[ uuid ] = index;\n\t\t\t\t\tobjects.push( object );\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tbindings[ j ].push(\n\t\t\t\t\t\t\t\tnew PropertyBinding(\n\t\t\t\t\t\t\t\t\tobject, paths[ j ], parsedPaths[ j ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( index < nCachedObjects ) {\n\n\t\t\t\t\tknownObject = objects[ index ];\n\n\t\t\t\t\t// move existing object to the ACTIVE region\n\n\t\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ];\n\n\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\t\tindicesByUUID[ uuid ] = firstActiveIndex;\n\t\t\t\t\tobjects[ firstActiveIndex ] = object;\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\n\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\n\t\t\t\t\t\t\tbinding = bindingsForPath[ index ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\n\t\t\t\t\t\tif ( binding === undefined ) {\n\n\t\t\t\t\t\t\t// since we do not bother to create new bindings\n\t\t\t\t\t\t\t// for objects that are cached, the binding may\n\t\t\t\t\t\t\t// or may not exist\n\n\t\t\t\t\t\t\tbinding = new PropertyBinding(\n\t\t\t\t\t\t\t\t\tobject, paths[ j ], parsedPaths[ j ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = binding;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( objects[ index ] !== knownObject) {\n\n\t\t\t\t\tconsole.error( \"Different objects with the same UUID \" +\n\t\t\t\t\t\t\t\"detected. Clean the caches or recreate your \" +\n\t\t\t\t\t\t\t\"infrastructure when reloading scenes...\" );\n\n\t\t\t\t} // else the object is already where we want it to be\n\n\t\t\t} // for arguments\n\n\t\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t\t},\n\n\t\tremove: function( var_args ) {\n\n\t\t\tvar objects = this._objects,\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\n\t\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\t\tbindings = this._bindings,\n\t\t\t\tnBindings = bindings.length;\n\n\t\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\t\tvar object = arguments[ i ],\n\t\t\t\t\tuuid = object.uuid,\n\t\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\t\tif ( index !== undefined && index >= nCachedObjects ) {\n\n\t\t\t\t\t// move existing object into the CACHED region\n\n\t\t\t\t\tvar lastCachedIndex = nCachedObjects ++,\n\t\t\t\t\t\tfirstActiveObject = objects[ lastCachedIndex ];\n\n\t\t\t\t\tindicesByUUID[ firstActiveObject.uuid ] = index;\n\t\t\t\t\tobjects[ index ] = firstActiveObject;\n\n\t\t\t\t\tindicesByUUID[ uuid ] = lastCachedIndex;\n\t\t\t\t\tobjects[ lastCachedIndex ] = object;\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\n\t\t\t\t\t\t\tfirstActive = bindingsForPath[ lastCachedIndex ],\n\t\t\t\t\t\t\tbinding = bindingsForPath[ index ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = firstActive;\n\t\t\t\t\t\tbindingsForPath[ lastCachedIndex ] = binding;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} // for arguments\n\n\t\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t\t},\n\n\t\t// remove & forget\n\t\tuncache: function( var_args ) {\n\n\t\t\tvar objects = this._objects,\n\t\t\t\tnObjects = objects.length,\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\n\t\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\t\tbindings = this._bindings,\n\t\t\t\tnBindings = bindings.length;\n\n\t\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\t\tvar object = arguments[ i ],\n\t\t\t\t\tuuid = object.uuid,\n\t\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\t\tif ( index !== undefined ) {\n\n\t\t\t\t\tdelete indicesByUUID[ uuid ];\n\n\t\t\t\t\tif ( index < nCachedObjects ) {\n\n\t\t\t\t\t\t// object is cached, shrink the CACHED region\n\n\t\t\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ],\n\t\t\t\t\t\t\tlastIndex = -- nObjects,\n\t\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\t\t// last cached object takes this object's place\n\t\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\t\t\t// last object goes to the activated slot and pop\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = firstActiveIndex;\n\t\t\t\t\t\tobjects[ firstActiveIndex ] = lastObject;\n\t\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\n\t\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\n\t\t\t\t\t\t\t\tlast = bindingsForPath[ lastIndex ];\n\n\t\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\t\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = last;\n\t\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// object is active, just swap with the last and pop\n\n\t\t\t\t\t\tvar lastIndex = -- nObjects,\n\t\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = index;\n\t\t\t\t\t\tobjects[ index ] = lastObject;\n\t\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\t\tvar bindingsForPath = bindings[ j ];\n\n\t\t\t\t\t\t\tbindingsForPath[ index ] = bindingsForPath[ lastIndex ];\n\t\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} // cached or active\n\n\t\t\t\t} // if object is known\n\n\t\t\t} // for arguments\n\n\t\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t\t},\n\n\t\t// Internal interface used by befriended PropertyBinding.Composite:\n\n\t\tsubscribe_: function( path, parsedPath ) {\n\t\t\t// returns an array of bindings for the given path that is changed\n\t\t\t// according to the contained objects in the group\n\n\t\t\tvar indicesByPath = this._bindingsIndicesByPath,\n\t\t\t\tindex = indicesByPath[ path ],\n\t\t\t\tbindings = this._bindings;\n\n\t\t\tif ( index !== undefined ) return bindings[ index ];\n\n\t\t\tvar paths = this._paths,\n\t\t\t\tparsedPaths = this._parsedPaths,\n\t\t\t\tobjects = this._objects,\n\t\t\t\tnObjects = objects.length,\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\n\t\t\t\tbindingsForPath = new Array( nObjects );\n\n\t\t\tindex = bindings.length;\n\n\t\t\tindicesByPath[ path ] = index;\n\n\t\t\tpaths.push( path );\n\t\t\tparsedPaths.push( parsedPath );\n\t\t\tbindings.push( bindingsForPath );\n\n\t\t\tfor ( var i = nCachedObjects,\n\t\t\t\t\tn = objects.length; i !== n; ++ i ) {\n\n\t\t\t\tvar object = objects[ i ];\n\n\t\t\t\tbindingsForPath[ i ] =\n\t\t\t\t\t\tnew PropertyBinding( object, path, parsedPath );\n\n\t\t\t}\n\n\t\t\treturn bindingsForPath;\n\n\t\t},\n\n\t\tunsubscribe_: function( path ) {\n\t\t\t// tells the group to forget about a property path and no longer\n\t\t\t// update the array previously obtained with 'subscribe_'\n\n\t\t\tvar indicesByPath = this._bindingsIndicesByPath,\n\t\t\t\tindex = indicesByPath[ path ];\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tvar paths = this._paths,\n\t\t\t\t\tparsedPaths = this._parsedPaths,\n\t\t\t\t\tbindings = this._bindings,\n\t\t\t\t\tlastBindingsIndex = bindings.length - 1,\n\t\t\t\t\tlastBindings = bindings[ lastBindingsIndex ],\n\t\t\t\t\tlastBindingsPath = path[ lastBindingsIndex ];\n\n\t\t\t\tindicesByPath[ lastBindingsPath ] = index;\n\n\t\t\t\tbindings[ index ] = lastBindings;\n\t\t\t\tbindings.pop();\n\n\t\t\t\tparsedPaths[ index ] = parsedPaths[ lastBindingsIndex ];\n\t\t\t\tparsedPaths.pop();\n\n\t\t\t\tpaths[ index ] = paths[ lastBindingsIndex ];\n\t\t\t\tpaths.pop();\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\t/**\n\t *\n\t * Action provided by AnimationMixer for scheduling clip playback on specific\n\t * objects.\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t *\n\t */\n\n\tfunction AnimationAction( mixer, clip, localRoot ) {\n\n\t\tthis._mixer = mixer;\n\t\tthis._clip = clip;\n\t\tthis._localRoot = localRoot || null;\n\n\t\tvar tracks = clip.tracks,\n\t\t\tnTracks = tracks.length,\n\t\t\tinterpolants = new Array( nTracks );\n\n\t\tvar interpolantSettings = {\n\t\t\t\tendingStart: \tZeroCurvatureEnding,\n\t\t\t\tendingEnd:\t\tZeroCurvatureEnding\n\t\t};\n\n\t\tfor ( var i = 0; i !== nTracks; ++ i ) {\n\n\t\t\tvar interpolant = tracks[ i ].createInterpolant( null );\n\t\t\tinterpolants[ i ] = interpolant;\n\t\t\tinterpolant.settings = interpolantSettings;\n\n\t\t}\n\n\t\tthis._interpolantSettings = interpolantSettings;\n\n\t\tthis._interpolants = interpolants;\t// bound by the mixer\n\n\t\t// inside: PropertyMixer (managed by the mixer)\n\t\tthis._propertyBindings = new Array( nTracks );\n\n\t\tthis._cacheIndex = null;\t\t\t// for the memory manager\n\t\tthis._byClipCacheIndex = null;\t\t// for the memory manager\n\n\t\tthis._timeScaleInterpolant = null;\n\t\tthis._weightInterpolant = null;\n\n\t\tthis.loop = LoopRepeat;\n\t\tthis._loopCount = -1;\n\n\t\t// global mixer time when the action is to be started\n\t\t// it's set back to 'null' upon start of the action\n\t\tthis._startTime = null;\n\n\t\t// scaled local time of the action\n\t\t// gets clamped or wrapped to 0..clip.duration according to loop\n\t\tthis.time = 0;\n\n\t\tthis.timeScale = 1;\n\t\tthis._effectiveTimeScale = 1;\n\n\t\tthis.weight = 1;\n\t\tthis._effectiveWeight = 1;\n\n\t\tthis.repetitions = Infinity; \t\t// no. of repetitions when looping\n\n\t\tthis.paused = false;\t\t\t\t// false -> zero effective time scale\n\t\tthis.enabled = true;\t\t\t\t// true -> zero effective weight\n\n\t\tthis.clampWhenFinished \t= false;\t// keep feeding the last frame?\n\n\t\tthis.zeroSlopeAtStart \t= true;\t\t// for smooth interpolation w/o separate\n\t\tthis.zeroSlopeAtEnd\t\t= true;\t\t// clips for start, loop and end\n\n\t}\n\n\tAnimationAction.prototype = {\n\n\t\tconstructor: AnimationAction,\n\n\t\t// State & Scheduling\n\n\t\tplay: function() {\n\n\t\t\tthis._mixer._activateAction( this );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tstop: function() {\n\n\t\t\tthis._mixer._deactivateAction( this );\n\n\t\t\treturn this.reset();\n\n\t\t},\n\n\t\treset: function() {\n\n\t\t\tthis.paused = false;\n\t\t\tthis.enabled = true;\n\n\t\t\tthis.time = 0;\t\t\t// restart clip\n\t\t\tthis._loopCount = -1;\t// forget previous loops\n\t\t\tthis._startTime = null;\t// forget scheduling\n\n\t\t\treturn this.stopFading().stopWarping();\n\n\t\t},\n\n\t\tisRunning: function() {\n\n\t\t\treturn this.enabled && ! this.paused && this.timeScale !== 0 &&\n\t\t\t\t\tthis._startTime === null && this._mixer._isActiveAction( this );\n\n\t\t},\n\n\t\t// return true when play has been called\n\t\tisScheduled: function() {\n\n\t\t\treturn this._mixer._isActiveAction( this );\n\n\t\t},\n\n\t\tstartAt: function( time ) {\n\n\t\t\tthis._startTime = time;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetLoop: function( mode, repetitions ) {\n\n\t\t\tthis.loop = mode;\n\t\t\tthis.repetitions = repetitions;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// Weight\n\n\t\t// set the weight stopping any scheduled fading\n\t\t// although .enabled = false yields an effective weight of zero, this\n\t\t// method does *not* change .enabled, because it would be confusing\n\t\tsetEffectiveWeight: function( weight ) {\n\n\t\t\tthis.weight = weight;\n\n\t\t\t// note: same logic as when updated at runtime\n\t\t\tthis._effectiveWeight = this.enabled ? weight : 0;\n\n\t\t\treturn this.stopFading();\n\n\t\t},\n\n\t\t// return the weight considering fading and .enabled\n\t\tgetEffectiveWeight: function() {\n\n\t\t\treturn this._effectiveWeight;\n\n\t\t},\n\n\t\tfadeIn: function( duration ) {\n\n\t\t\treturn this._scheduleFading( duration, 0, 1 );\n\n\t\t},\n\n\t\tfadeOut: function( duration ) {\n\n\t\t\treturn this._scheduleFading( duration, 1, 0 );\n\n\t\t},\n\n\t\tcrossFadeFrom: function( fadeOutAction, duration, warp ) {\n\n\t\t\tfadeOutAction.fadeOut( duration );\n\t\t\tthis.fadeIn( duration );\n\n\t\t\tif( warp ) {\n\n\t\t\t\tvar fadeInDuration = this._clip.duration,\n\t\t\t\t\tfadeOutDuration = fadeOutAction._clip.duration,\n\n\t\t\t\t\tstartEndRatio = fadeOutDuration / fadeInDuration,\n\t\t\t\t\tendStartRatio = fadeInDuration / fadeOutDuration;\n\n\t\t\t\tfadeOutAction.warp( 1.0, startEndRatio, duration );\n\t\t\t\tthis.warp( endStartRatio, 1.0, duration );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcrossFadeTo: function( fadeInAction, duration, warp ) {\n\n\t\t\treturn fadeInAction.crossFadeFrom( this, duration, warp );\n\n\t\t},\n\n\t\tstopFading: function() {\n\n\t\t\tvar weightInterpolant = this._weightInterpolant;\n\n\t\t\tif ( weightInterpolant !== null ) {\n\n\t\t\t\tthis._weightInterpolant = null;\n\t\t\t\tthis._mixer._takeBackControlInterpolant( weightInterpolant );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// Time Scale Control\n\n\t\t// set the weight stopping any scheduled warping\n\t\t// although .paused = true yields an effective time scale of zero, this\n\t\t// method does *not* change .paused, because it would be confusing\n\t\tsetEffectiveTimeScale: function( timeScale ) {\n\n\t\t\tthis.timeScale = timeScale;\n\t\t\tthis._effectiveTimeScale = this.paused ? 0 :timeScale;\n\n\t\t\treturn this.stopWarping();\n\n\t\t},\n\n\t\t// return the time scale considering warping and .paused\n\t\tgetEffectiveTimeScale: function() {\n\n\t\t\treturn this._effectiveTimeScale;\n\n\t\t},\n\n\t\tsetDuration: function( duration ) {\n\n\t\t\tthis.timeScale = this._clip.duration / duration;\n\n\t\t\treturn this.stopWarping();\n\n\t\t},\n\n\t\tsyncWith: function( action ) {\n\n\t\t\tthis.time = action.time;\n\t\t\tthis.timeScale = action.timeScale;\n\n\t\t\treturn this.stopWarping();\n\n\t\t},\n\n\t\thalt: function( duration ) {\n\n\t\t\treturn this.warp( this._effectiveTimeScale, 0, duration );\n\n\t\t},\n\n\t\twarp: function( startTimeScale, endTimeScale, duration ) {\n\n\t\t\tvar mixer = this._mixer, now = mixer.time,\n\t\t\t\tinterpolant = this._timeScaleInterpolant,\n\n\t\t\t\ttimeScale = this.timeScale;\n\n\t\t\tif ( interpolant === null ) {\n\n\t\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\t\tthis._timeScaleInterpolant = interpolant;\n\n\t\t\t}\n\n\t\t\tvar times = interpolant.parameterPositions,\n\t\t\t\tvalues = interpolant.sampleValues;\n\n\t\t\ttimes[ 0 ] = now;\n\t\t\ttimes[ 1 ] = now + duration;\n\n\t\t\tvalues[ 0 ] = startTimeScale / timeScale;\n\t\t\tvalues[ 1 ] = endTimeScale / timeScale;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tstopWarping: function() {\n\n\t\t\tvar timeScaleInterpolant = this._timeScaleInterpolant;\n\n\t\t\tif ( timeScaleInterpolant !== null ) {\n\n\t\t\t\tthis._timeScaleInterpolant = null;\n\t\t\t\tthis._mixer._takeBackControlInterpolant( timeScaleInterpolant );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// Object Accessors\n\n\t\tgetMixer: function() {\n\n\t\t\treturn this._mixer;\n\n\t\t},\n\n\t\tgetClip: function() {\n\n\t\t\treturn this._clip;\n\n\t\t},\n\n\t\tgetRoot: function() {\n\n\t\t\treturn this._localRoot || this._mixer._root;\n\n\t\t},\n\n\t\t// Interna\n\n\t\t_update: function( time, deltaTime, timeDirection, accuIndex ) {\n\t\t\t// called by the mixer\n\n\t\t\tvar startTime = this._startTime;\n\n\t\t\tif ( startTime !== null ) {\n\n\t\t\t\t// check for scheduled start of action\n\n\t\t\t\tvar timeRunning = ( time - startTime ) * timeDirection;\n\t\t\t\tif ( timeRunning < 0 || timeDirection === 0 ) {\n\n\t\t\t\t\treturn; // yet to come / don't decide when delta = 0\n\n\t\t\t\t}\n\n\t\t\t\t// start\n\n\t\t\t\tthis._startTime = null; // unschedule\n\t\t\t\tdeltaTime = timeDirection * timeRunning;\n\n\t\t\t}\n\n\t\t\t// apply time scale and advance time\n\n\t\t\tdeltaTime *= this._updateTimeScale( time );\n\t\t\tvar clipTime = this._updateTime( deltaTime );\n\n\t\t\t// note: _updateTime may disable the action resulting in\n\t\t\t// an effective weight of 0\n\n\t\t\tvar weight = this._updateWeight( time );\n\n\t\t\tif ( weight > 0 ) {\n\n\t\t\t\tvar interpolants = this._interpolants;\n\t\t\t\tvar propertyMixers = this._propertyBindings;\n\n\t\t\t\tfor ( var j = 0, m = interpolants.length; j !== m; ++ j ) {\n\n\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\n\t\t\t\t\tpropertyMixers[ j ].accumulate( accuIndex, weight );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\t_updateWeight: function( time ) {\n\n\t\t\tvar weight = 0;\n\n\t\t\tif ( this.enabled ) {\n\n\t\t\t\tweight = this.weight;\n\t\t\t\tvar interpolant = this._weightInterpolant;\n\n\t\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\t\tweight *= interpolantValue;\n\n\t\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\t\tthis.stopFading();\n\n\t\t\t\t\t\tif ( interpolantValue === 0 ) {\n\n\t\t\t\t\t\t\t// faded out, disable\n\t\t\t\t\t\t\tthis.enabled = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._effectiveWeight = weight;\n\t\t\treturn weight;\n\n\t\t},\n\n\t\t_updateTimeScale: function( time ) {\n\n\t\t\tvar timeScale = 0;\n\n\t\t\tif ( ! this.paused ) {\n\n\t\t\t\ttimeScale = this.timeScale;\n\n\t\t\t\tvar interpolant = this._timeScaleInterpolant;\n\n\t\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\t\ttimeScale *= interpolantValue;\n\n\t\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\t\tthis.stopWarping();\n\n\t\t\t\t\t\tif ( timeScale === 0 ) {\n\n\t\t\t\t\t\t\t// motion has halted, pause\n\t\t\t\t\t\t\tthis.paused = true;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// warp done - apply final time scale\n\t\t\t\t\t\t\tthis.timeScale = timeScale;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._effectiveTimeScale = timeScale;\n\t\t\treturn timeScale;\n\n\t\t},\n\n\t\t_updateTime: function( deltaTime ) {\n\n\t\t\tvar time = this.time + deltaTime;\n\n\t\t\tif ( deltaTime === 0 ) return time;\n\n\t\t\tvar duration = this._clip.duration,\n\n\t\t\t\tloop = this.loop,\n\t\t\t\tloopCount = this._loopCount;\n\n\t\t\tif ( loop === LoopOnce ) {\n\n\t\t\t\tif ( loopCount === -1 ) {\n\t\t\t\t\t// just started\n\n\t\t\t\t\tthis._loopCount = 0;\n\t\t\t\t\tthis._setEndings( true, true, false );\n\n\t\t\t\t}\n\n\t\t\t\thandle_stop: {\n\n\t\t\t\t\tif ( time >= duration ) {\n\n\t\t\t\t\t\ttime = duration;\n\n\t\t\t\t\t} else if ( time < 0 ) {\n\n\t\t\t\t\t\ttime = 0;\n\n\t\t\t\t\t} else break handle_stop;\n\n\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\t\telse this.enabled = false;\n\n\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\t\tdirection: deltaTime < 0 ? -1 : 1\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else { // repetitive Repeat or PingPong\n\n\t\t\t\tvar pingPong = ( loop === LoopPingPong );\n\n\t\t\t\tif ( loopCount === -1 ) {\n\t\t\t\t\t// just started\n\n\t\t\t\t\tif ( deltaTime >= 0 ) {\n\n\t\t\t\t\t\tloopCount = 0;\n\n\t\t\t\t\t\tthis._setEndings(\n\t\t\t\t\t\t\t\ttrue, this.repetitions === 0, pingPong );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// when looping in reverse direction, the initial\n\t\t\t\t\t\t// transition through zero counts as a repetition,\n\t\t\t\t\t\t// so leave loopCount at -1\n\n\t\t\t\t\t\tthis._setEndings(\n\t\t\t\t\t\t\t\tthis.repetitions === 0, true, pingPong );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( time >= duration || time < 0 ) {\n\t\t\t\t\t// wrap around\n\n\t\t\t\t\tvar loopDelta = Math.floor( time / duration ); // signed\n\t\t\t\t\ttime -= duration * loopDelta;\n\n\t\t\t\t\tloopCount += Math.abs( loopDelta );\n\n\t\t\t\t\tvar pending = this.repetitions - loopCount;\n\n\t\t\t\t\tif ( pending < 0 ) {\n\t\t\t\t\t\t// have to stop (switch state, clamp time, fire event)\n\n\t\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\t\t\telse this.enabled = false;\n\n\t\t\t\t\t\ttime = deltaTime > 0 ? duration : 0;\n\n\t\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\t\t\tdirection: deltaTime > 0 ? 1 : -1\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// keep running\n\n\t\t\t\t\t\tif ( pending === 0 ) {\n\t\t\t\t\t\t\t// entering the last round\n\n\t\t\t\t\t\t\tvar atStart = deltaTime < 0;\n\t\t\t\t\t\t\tthis._setEndings( atStart, ! atStart, pingPong );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tthis._setEndings( false, false, pingPong );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._loopCount = loopCount;\n\n\t\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\t\ttype: 'loop', action: this, loopDelta: loopDelta\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( pingPong && ( loopCount & 1 ) === 1 ) {\n\t\t\t\t\t// invert time for the \"pong round\"\n\n\t\t\t\t\tthis.time = time;\n\t\t\t\t\treturn duration - time;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.time = time;\n\t\t\treturn time;\n\n\t\t},\n\n\t\t_setEndings: function( atStart, atEnd, pingPong ) {\n\n\t\t\tvar settings = this._interpolantSettings;\n\n\t\t\tif ( pingPong ) {\n\n\t\t\t\tsettings.endingStart \t= ZeroSlopeEnding;\n\t\t\t\tsettings.endingEnd\t\t= ZeroSlopeEnding;\n\n\t\t\t} else {\n\n\t\t\t\t// assuming for LoopOnce atStart == atEnd == true\n\n\t\t\t\tif ( atStart ) {\n\n\t\t\t\t\tsettings.endingStart = this.zeroSlopeAtStart ?\n\t\t\t\t\t\t\tZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsettings.endingStart = WrapAroundEnding;\n\n\t\t\t\t}\n\n\t\t\t\tif ( atEnd ) {\n\n\t\t\t\t\tsettings.endingEnd = this.zeroSlopeAtEnd ?\n\t\t\t\t\t\t\tZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsettings.endingEnd \t = WrapAroundEnding;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\t_scheduleFading: function( duration, weightNow, weightThen ) {\n\n\t\t\tvar mixer = this._mixer, now = mixer.time,\n\t\t\t\tinterpolant = this._weightInterpolant;\n\n\t\t\tif ( interpolant === null ) {\n\n\t\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\t\tthis._weightInterpolant = interpolant;\n\n\t\t\t}\n\n\t\t\tvar times = interpolant.parameterPositions,\n\t\t\t\tvalues = interpolant.sampleValues;\n\n\t\t\ttimes[ 0 ] = now; \t\t\t\tvalues[ 0 ] = weightNow;\n\t\t\ttimes[ 1 ] = now + duration;\tvalues[ 1 ] = weightThen;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t/**\n\t *\n\t * Player for AnimationClips.\n\t *\n\t *\n\t * @author Ben Houston / http://clara.io/\n\t * @author David Sarno / http://lighthaus.us/\n\t * @author tschw\n\t */\n\n\tfunction AnimationMixer( root ) {\n\n\t\tthis._root = root;\n\t\tthis._initMemoryManager();\n\t\tthis._accuIndex = 0;\n\n\t\tthis.time = 0;\n\n\t\tthis.timeScale = 1.0;\n\n\t}\n\n\tAnimationMixer.prototype = {\n\n\t\tconstructor: AnimationMixer,\n\n\t\t// return an action for a clip optionally using a custom root target\n\t\t// object (this method allocates a lot of dynamic memory in case a\n\t\t// previously unknown clip/root combination is specified)\n\t\tclipAction: function ( clip, optionalRoot ) {\n\n\t\t\tvar root = optionalRoot || this._root,\n\t\t\t\trootUuid = root.uuid,\n\n\t\t\t\tclipObject = typeof clip === 'string' ?\n\t\t\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\n\n\t\t\t\tclipUuid = clipObject !== null ? clipObject.uuid : clip,\n\n\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ],\n\t\t\t\tprototypeAction = null;\n\n\t\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\t\tvar existingAction =\n\t\t\t\t\t\tactionsForClip.actionByRoot[ rootUuid ];\n\n\t\t\t\tif ( existingAction !== undefined ) {\n\n\t\t\t\t\treturn existingAction;\n\n\t\t\t\t}\n\n\t\t\t\t// we know the clip, so we don't have to parse all\n\t\t\t\t// the bindings again but can just copy\n\t\t\t\tprototypeAction = actionsForClip.knownActions[ 0 ];\n\n\t\t\t\t// also, take the clip from the prototype action\n\t\t\t\tif ( clipObject === null )\n\t\t\t\t\tclipObject = prototypeAction._clip;\n\n\t\t\t}\n\n\t\t\t// clip must be known when specified via string\n\t\t\tif ( clipObject === null ) return null;\n\n\t\t\t// allocate all resources required to run it\n\t\t\tvar newAction = new AnimationAction( this, clipObject, optionalRoot );\n\n\t\t\tthis._bindAction( newAction, prototypeAction );\n\n\t\t\t// and make the action known to the memory manager\n\t\t\tthis._addInactiveAction( newAction, clipUuid, rootUuid );\n\n\t\t\treturn newAction;\n\n\t\t},\n\n\t\t// get an existing action\n\t\texistingAction: function ( clip, optionalRoot ) {\n\n\t\t\tvar root = optionalRoot || this._root,\n\t\t\t\trootUuid = root.uuid,\n\n\t\t\t\tclipObject = typeof clip === 'string' ?\n\t\t\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\n\n\t\t\t\tclipUuid = clipObject ? clipObject.uuid : clip,\n\n\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\t\treturn actionsForClip.actionByRoot[ rootUuid ] || null;\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t},\n\n\t\t// deactivates all previously scheduled actions\n\t\tstopAllAction: function () {\n\n\t\t\tvar actions = this._actions,\n\t\t\t\tnActions = this._nActiveActions,\n\t\t\t\tbindings = this._bindings,\n\t\t\t\tnBindings = this._nActiveBindings;\n\n\t\t\tthis._nActiveActions = 0;\n\t\t\tthis._nActiveBindings = 0;\n\n\t\t\tfor ( var i = 0; i !== nActions; ++ i ) {\n\n\t\t\t\tactions[ i ].reset();\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\n\n\t\t\t\tbindings[ i ].useCount = 0;\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// advance the time and update apply the animation\n\t\tupdate: function ( deltaTime ) {\n\n\t\t\tdeltaTime *= this.timeScale;\n\n\t\t\tvar actions = this._actions,\n\t\t\t\tnActions = this._nActiveActions,\n\n\t\t\t\ttime = this.time += deltaTime,\n\t\t\t\ttimeDirection = Math.sign( deltaTime ),\n\n\t\t\t\taccuIndex = this._accuIndex ^= 1;\n\n\t\t\t// run active actions\n\n\t\t\tfor ( var i = 0; i !== nActions; ++ i ) {\n\n\t\t\t\tvar action = actions[ i ];\n\n\t\t\t\tif ( action.enabled ) {\n\n\t\t\t\t\taction._update( time, deltaTime, timeDirection, accuIndex );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// update scene graph\n\n\t\t\tvar bindings = this._bindings,\n\t\t\t\tnBindings = this._nActiveBindings;\n\n\t\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\n\n\t\t\t\tbindings[ i ].apply( accuIndex );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// return this mixer's root target object\n\t\tgetRoot: function () {\n\n\t\t\treturn this._root;\n\n\t\t},\n\n\t\t// free all resources specific to a particular clip\n\t\tuncacheClip: function ( clip ) {\n\n\t\t\tvar actions = this._actions,\n\t\t\t\tclipUuid = clip.uuid,\n\t\t\t\tactionsByClip = this._actionsByClip,\n\t\t\t\tactionsForClip = actionsByClip[ clipUuid ];\n\n\t\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\t\t// note: just calling _removeInactiveAction would mess up the\n\t\t\t\t// iteration state and also require updating the state we can\n\t\t\t\t// just throw away\n\n\t\t\t\tvar actionsToRemove = actionsForClip.knownActions;\n\n\t\t\t\tfor ( var i = 0, n = actionsToRemove.length; i !== n; ++ i ) {\n\n\t\t\t\t\tvar action = actionsToRemove[ i ];\n\n\t\t\t\t\tthis._deactivateAction( action );\n\n\t\t\t\t\tvar cacheIndex = action._cacheIndex,\n\t\t\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ];\n\n\t\t\t\t\taction._cacheIndex = null;\n\t\t\t\t\taction._byClipCacheIndex = null;\n\n\t\t\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\t\t\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\t\t\t\tactions.pop();\n\n\t\t\t\t\tthis._removeInactiveBindingsForAction( action );\n\n\t\t\t\t}\n\n\t\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t\t}\n\n\t\t},\n\n\t\t// free all resources specific to a particular root target object\n\t\tuncacheRoot: function ( root ) {\n\n\t\t\tvar rootUuid = root.uuid,\n\t\t\t\tactionsByClip = this._actionsByClip;\n\n\t\t\tfor ( var clipUuid in actionsByClip ) {\n\n\t\t\t\tvar actionByRoot = actionsByClip[ clipUuid ].actionByRoot,\n\t\t\t\t\taction = actionByRoot[ rootUuid ];\n\n\t\t\t\tif ( action !== undefined ) {\n\n\t\t\t\t\tthis._deactivateAction( action );\n\t\t\t\t\tthis._removeInactiveAction( action );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar bindingsByRoot = this._bindingsByRootAndName,\n\t\t\t\tbindingByName = bindingsByRoot[ rootUuid ];\n\n\t\t\tif ( bindingByName !== undefined ) {\n\n\t\t\t\tfor ( var trackName in bindingByName ) {\n\n\t\t\t\t\tvar binding = bindingByName[ trackName ];\n\t\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\t// remove a targeted clip from the cache\n\t\tuncacheAction: function ( clip, optionalRoot ) {\n\n\t\t\tvar action = this.existingAction( clip, optionalRoot );\n\n\t\t\tif ( action !== null ) {\n\n\t\t\t\tthis._deactivateAction( action );\n\t\t\t\tthis._removeInactiveAction( action );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\t// Implementation details:\n\n\tObject.assign( AnimationMixer.prototype, {\n\n\t\t_bindAction: function ( action, prototypeAction ) {\n\n\t\t\tvar root = action._localRoot || this._root,\n\t\t\t\ttracks = action._clip.tracks,\n\t\t\t\tnTracks = tracks.length,\n\t\t\t\tbindings = action._propertyBindings,\n\t\t\t\tinterpolants = action._interpolants,\n\t\t\t\trootUuid = root.uuid,\n\t\t\t\tbindingsByRoot = this._bindingsByRootAndName,\n\t\t\t\tbindingsByName = bindingsByRoot[ rootUuid ];\n\n\t\t\tif ( bindingsByName === undefined ) {\n\n\t\t\t\tbindingsByName = {};\n\t\t\t\tbindingsByRoot[ rootUuid ] = bindingsByName;\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i !== nTracks; ++ i ) {\n\n\t\t\t\tvar track = tracks[ i ],\n\t\t\t\t\ttrackName = track.name,\n\t\t\t\t\tbinding = bindingsByName[ trackName ];\n\n\t\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbinding = bindings[ i ];\n\n\t\t\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t\t\t// existing binding, make sure the cache knows\n\n\t\t\t\t\t\tif ( binding._cacheIndex === null ) {\n\n\t\t\t\t\t\t\t++ binding.referenceCount;\n\t\t\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar path = prototypeAction && prototypeAction.\n\t\t\t\t\t\t\t_propertyBindings[ i ].binding.parsedPath;\n\n\t\t\t\t\tbinding = new PropertyMixer(\n\t\t\t\t\t\t\tPropertyBinding.create( root, trackName, path ),\n\t\t\t\t\t\t\ttrack.ValueTypeName, track.getValueSize() );\n\n\t\t\t\t\t++ binding.referenceCount;\n\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t\t}\n\n\t\t\t\tinterpolants[ i ].resultBuffer = binding.buffer;\n\n\t\t\t}\n\n\t\t},\n\n\t\t_activateAction: function ( action ) {\n\n\t\t\tif ( ! this._isActiveAction( action ) ) {\n\n\t\t\t\tif ( action._cacheIndex === null ) {\n\n\t\t\t\t\t// this action has been forgotten by the cache, but the user\n\t\t\t\t\t// appears to be still using it -> rebind\n\n\t\t\t\t\tvar rootUuid = ( action._localRoot || this._root ).uuid,\n\t\t\t\t\t\tclipUuid = action._clip.uuid,\n\t\t\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\t\t\t\tthis._bindAction( action,\n\t\t\t\t\t\t\tactionsForClip && actionsForClip.knownActions[ 0 ] );\n\n\t\t\t\t\tthis._addInactiveAction( action, clipUuid, rootUuid );\n\n\t\t\t\t}\n\n\t\t\t\tvar bindings = action._propertyBindings;\n\n\t\t\t\t// increment reference counts / sort out state\n\t\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\t\tvar binding = bindings[ i ];\n\n\t\t\t\t\tif ( binding.useCount ++ === 0 ) {\n\n\t\t\t\t\t\tthis._lendBinding( binding );\n\t\t\t\t\t\tbinding.saveOriginalState();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tthis._lendAction( action );\n\n\t\t\t}\n\n\t\t},\n\n\t\t_deactivateAction: function ( action ) {\n\n\t\t\tif ( this._isActiveAction( action ) ) {\n\n\t\t\t\tvar bindings = action._propertyBindings;\n\n\t\t\t\t// decrement reference counts / sort out state\n\t\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\t\tvar binding = bindings[ i ];\n\n\t\t\t\t\tif ( -- binding.useCount === 0 ) {\n\n\t\t\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\t\t\tthis._takeBackBinding( binding );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tthis._takeBackAction( action );\n\n\t\t\t}\n\n\t\t},\n\n\t\t// Memory manager\n\n\t\t_initMemoryManager: function () {\n\n\t\t\tthis._actions = []; // 'nActiveActions' followed by inactive ones\n\t\t\tthis._nActiveActions = 0;\n\n\t\t\tthis._actionsByClip = {};\n\t\t\t// inside:\n\t\t\t// {\n\t\t\t// \t\tknownActions: Array< AnimationAction >\t- used as prototypes\n\t\t\t// \t\tactionByRoot: AnimationAction\t\t\t- lookup\n\t\t\t// }\n\n\n\t\t\tthis._bindings = []; // 'nActiveBindings' followed by inactive ones\n\t\t\tthis._nActiveBindings = 0;\n\n\t\t\tthis._bindingsByRootAndName = {}; // inside: MaterialMap< name, PropertyMixer >\n\n\n\t\t\tthis._controlInterpolants = []; // same game as above\n\t\t\tthis._nActiveControlInterpolants = 0;\n\n\t\t\tvar scope = this;\n\n\t\t\tthis.stats = {\n\n\t\t\t\tactions: {\n\t\t\t\t\tget total() { return scope._actions.length; },\n\t\t\t\t\tget inUse() { return scope._nActiveActions; }\n\t\t\t\t},\n\t\t\t\tbindings: {\n\t\t\t\t\tget total() { return scope._bindings.length; },\n\t\t\t\t\tget inUse() { return scope._nActiveBindings; }\n\t\t\t\t},\n\t\t\t\tcontrolInterpolants: {\n\t\t\t\t\tget total() { return scope._controlInterpolants.length; },\n\t\t\t\t\tget inUse() { return scope._nActiveControlInterpolants; }\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t},\n\n\t\t// Memory management for AnimationAction objects\n\n\t\t_isActiveAction: function ( action ) {\n\n\t\t\tvar index = action._cacheIndex;\n\t\t\treturn index !== null && index < this._nActiveActions;\n\n\t\t},\n\n\t\t_addInactiveAction: function ( action, clipUuid, rootUuid ) {\n\n\t\t\tvar actions = this._actions,\n\t\t\t\tactionsByClip = this._actionsByClip,\n\t\t\t\tactionsForClip = actionsByClip[ clipUuid ];\n\n\t\t\tif ( actionsForClip === undefined ) {\n\n\t\t\t\tactionsForClip = {\n\n\t\t\t\t\tknownActions: [ action ],\n\t\t\t\t\tactionByRoot: {}\n\n\t\t\t\t};\n\n\t\t\t\taction._byClipCacheIndex = 0;\n\n\t\t\t\tactionsByClip[ clipUuid ] = actionsForClip;\n\n\t\t\t} else {\n\n\t\t\t\tvar knownActions = actionsForClip.knownActions;\n\n\t\t\t\taction._byClipCacheIndex = knownActions.length;\n\t\t\t\tknownActions.push( action );\n\n\t\t\t}\n\n\t\t\taction._cacheIndex = actions.length;\n\t\t\tactions.push( action );\n\n\t\t\tactionsForClip.actionByRoot[ rootUuid ] = action;\n\n\t\t},\n\n\t\t_removeInactiveAction: function ( action ) {\n\n\t\t\tvar actions = this._actions,\n\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ],\n\t\t\t\tcacheIndex = action._cacheIndex;\n\n\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\t\tactions.pop();\n\n\t\t\taction._cacheIndex = null;\n\n\n\t\t\tvar clipUuid = action._clip.uuid,\n\t\t\t\tactionsByClip = this._actionsByClip,\n\t\t\t\tactionsForClip = actionsByClip[ clipUuid ],\n\t\t\t\tknownActionsForClip = actionsForClip.knownActions,\n\n\t\t\t\tlastKnownAction =\n\t\t\t\t\tknownActionsForClip[ knownActionsForClip.length - 1 ],\n\n\t\t\t\tbyClipCacheIndex = action._byClipCacheIndex;\n\n\t\t\tlastKnownAction._byClipCacheIndex = byClipCacheIndex;\n\t\t\tknownActionsForClip[ byClipCacheIndex ] = lastKnownAction;\n\t\t\tknownActionsForClip.pop();\n\n\t\t\taction._byClipCacheIndex = null;\n\n\n\t\t\tvar actionByRoot = actionsForClip.actionByRoot,\n\t\t\t\trootUuid = ( actions._localRoot || this._root ).uuid;\n\n\t\t\tdelete actionByRoot[ rootUuid ];\n\n\t\t\tif ( knownActionsForClip.length === 0 ) {\n\n\t\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t\t}\n\n\t\t\tthis._removeInactiveBindingsForAction( action );\n\n\t\t},\n\n\t\t_removeInactiveBindingsForAction: function ( action ) {\n\n\t\t\tvar bindings = action._propertyBindings;\n\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tvar binding = bindings[ i ];\n\n\t\t\t\tif ( -- binding.referenceCount === 0 ) {\n\n\t\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\t_lendAction: function ( action ) {\n\n\t\t\t// [ active actions |  inactive actions  ]\n\t\t\t// [  active actions >| inactive actions ]\n\t\t\t//                 s        a\n\t\t\t//                  <-swap->\n\t\t\t//                 a        s\n\n\t\t\tvar actions = this._actions,\n\t\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\t\tlastActiveIndex = this._nActiveActions ++,\n\n\t\t\t\tfirstInactiveAction = actions[ lastActiveIndex ];\n\n\t\t\taction._cacheIndex = lastActiveIndex;\n\t\t\tactions[ lastActiveIndex ] = action;\n\n\t\t\tfirstInactiveAction._cacheIndex = prevIndex;\n\t\t\tactions[ prevIndex ] = firstInactiveAction;\n\n\t\t},\n\n\t\t_takeBackAction: function ( action ) {\n\n\t\t\t// [  active actions  | inactive actions ]\n\t\t\t// [ active actions |< inactive actions  ]\n\t\t\t//        a        s\n\t\t\t//         <-swap->\n\t\t\t//        s        a\n\n\t\t\tvar actions = this._actions,\n\t\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\t\tfirstInactiveIndex = -- this._nActiveActions,\n\n\t\t\t\tlastActiveAction = actions[ firstInactiveIndex ];\n\n\t\t\taction._cacheIndex = firstInactiveIndex;\n\t\t\tactions[ firstInactiveIndex ] = action;\n\n\t\t\tlastActiveAction._cacheIndex = prevIndex;\n\t\t\tactions[ prevIndex ] = lastActiveAction;\n\n\t\t},\n\n\t\t// Memory management for PropertyMixer objects\n\n\t\t_addInactiveBinding: function ( binding, rootUuid, trackName ) {\n\n\t\t\tvar bindingsByRoot = this._bindingsByRootAndName,\n\t\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\n\n\t\t\t\tbindings = this._bindings;\n\n\t\t\tif ( bindingByName === undefined ) {\n\n\t\t\t\tbindingByName = {};\n\t\t\t\tbindingsByRoot[ rootUuid ] = bindingByName;\n\n\t\t\t}\n\n\t\t\tbindingByName[ trackName ] = binding;\n\n\t\t\tbinding._cacheIndex = bindings.length;\n\t\t\tbindings.push( binding );\n\n\t\t},\n\n\t\t_removeInactiveBinding: function ( binding ) {\n\n\t\t\tvar bindings = this._bindings,\n\t\t\t\tpropBinding = binding.binding,\n\t\t\t\trootUuid = propBinding.rootNode.uuid,\n\t\t\t\ttrackName = propBinding.path,\n\t\t\t\tbindingsByRoot = this._bindingsByRootAndName,\n\t\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\n\n\t\t\t\tlastInactiveBinding = bindings[ bindings.length - 1 ],\n\t\t\t\tcacheIndex = binding._cacheIndex;\n\n\t\t\tlastInactiveBinding._cacheIndex = cacheIndex;\n\t\t\tbindings[ cacheIndex ] = lastInactiveBinding;\n\t\t\tbindings.pop();\n\n\t\t\tdelete bindingByName[ trackName ];\n\n\t\t\tremove_empty_map: {\n\n\t\t\t\tfor ( var _ in bindingByName ) break remove_empty_map;\n\n\t\t\t\tdelete bindingsByRoot[ rootUuid ];\n\n\t\t\t}\n\n\t\t},\n\n\t\t_lendBinding: function ( binding ) {\n\n\t\t\tvar bindings = this._bindings,\n\t\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\t\tlastActiveIndex = this._nActiveBindings ++,\n\n\t\t\t\tfirstInactiveBinding = bindings[ lastActiveIndex ];\n\n\t\t\tbinding._cacheIndex = lastActiveIndex;\n\t\t\tbindings[ lastActiveIndex ] = binding;\n\n\t\t\tfirstInactiveBinding._cacheIndex = prevIndex;\n\t\t\tbindings[ prevIndex ] = firstInactiveBinding;\n\n\t\t},\n\n\t\t_takeBackBinding: function ( binding ) {\n\n\t\t\tvar bindings = this._bindings,\n\t\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\t\tfirstInactiveIndex = -- this._nActiveBindings,\n\n\t\t\t\tlastActiveBinding = bindings[ firstInactiveIndex ];\n\n\t\t\tbinding._cacheIndex = firstInactiveIndex;\n\t\t\tbindings[ firstInactiveIndex ] = binding;\n\n\t\t\tlastActiveBinding._cacheIndex = prevIndex;\n\t\t\tbindings[ prevIndex ] = lastActiveBinding;\n\n\t\t},\n\n\n\t\t// Memory management of Interpolants for weight and time scale\n\n\t\t_lendControlInterpolant: function () {\n\n\t\t\tvar interpolants = this._controlInterpolants,\n\t\t\t\tlastActiveIndex = this._nActiveControlInterpolants ++,\n\t\t\t\tinterpolant = interpolants[ lastActiveIndex ];\n\n\t\t\tif ( interpolant === undefined ) {\n\n\t\t\t\tinterpolant = new LinearInterpolant(\n\t\t\t\t\t\tnew Float32Array( 2 ), new Float32Array( 2 ),\n\t\t\t\t\t\t\t1, this._controlInterpolantsResultBuffer );\n\n\t\t\t\tinterpolant.__cacheIndex = lastActiveIndex;\n\t\t\t\tinterpolants[ lastActiveIndex ] = interpolant;\n\n\t\t\t}\n\n\t\t\treturn interpolant;\n\n\t\t},\n\n\t\t_takeBackControlInterpolant: function ( interpolant ) {\n\n\t\t\tvar interpolants = this._controlInterpolants,\n\t\t\t\tprevIndex = interpolant.__cacheIndex,\n\n\t\t\t\tfirstInactiveIndex = -- this._nActiveControlInterpolants,\n\n\t\t\t\tlastActiveInterpolant = interpolants[ firstInactiveIndex ];\n\n\t\t\tinterpolant.__cacheIndex = firstInactiveIndex;\n\t\t\tinterpolants[ firstInactiveIndex ] = interpolant;\n\n\t\t\tlastActiveInterpolant.__cacheIndex = prevIndex;\n\t\t\tinterpolants[ prevIndex ] = lastActiveInterpolant;\n\n\t\t},\n\n\t\t_controlInterpolantsResultBuffer: new Float32Array( 1 )\n\n\t} );\n\n\tObject.assign( AnimationMixer.prototype, EventDispatcher.prototype );\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Uniform( value ) {\n\n\t\tif ( typeof value === 'string' ) {\n\n\t\t\tconsole.warn( 'THREE.Uniform: Type parameter is no longer needed.' );\n\t\t\tvalue = arguments[ 1 ];\n\n\t\t}\n\n\t\tthis.value = value;\n\n\t}\n\n\tUniform.prototype.clone = function () {\n\n\t\treturn new Uniform( this.value.clone === undefined ? this.value : this.value.clone() );\n\n\t};\n\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */\n\n\tfunction InstancedBufferGeometry() {\n\n\t\tBufferGeometry.call( this );\n\n\t\tthis.type = 'InstancedBufferGeometry';\n\t\tthis.maxInstancedCount = undefined;\n\n\t}\n\n\tInstancedBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\n\tInstancedBufferGeometry.prototype.constructor = InstancedBufferGeometry;\n\n\tInstancedBufferGeometry.prototype.isInstancedBufferGeometry = true;\n\n\tInstancedBufferGeometry.prototype.addGroup = function ( start, count, materialIndex ) {\n\n\t\tthis.groups.push( {\n\n\t\t\tstart: start,\n\t\t\tcount: count,\n\t\t\tmaterialIndex: materialIndex\n\n\t\t} );\n\n\t};\n\n\tInstancedBufferGeometry.prototype.copy = function ( source ) {\n\n\t\tvar index = source.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.setIndex( index.clone() );\n\n\t\t}\n\n\t\tvar attributes = source.attributes;\n\n\t\tfor ( var name in attributes ) {\n\n\t\t\tvar attribute = attributes[ name ];\n\t\t\tthis.addAttribute( name, attribute.clone() );\n\n\t\t}\n\n\t\tvar groups = source.groups;\n\n\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tvar group = groups[ i ];\n\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */\n\n\tfunction InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, normalized ) {\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.data = interleavedBuffer;\n\t\tthis.itemSize = itemSize;\n\t\tthis.offset = offset;\n\n\t\tthis.normalized = normalized === true;\n\n\t}\n\n\n\tInterleavedBufferAttribute.prototype = {\n\n\t\tconstructor: InterleavedBufferAttribute,\n\n\t\tisInterleavedBufferAttribute: true,\n\n\t\tget count() {\n\n\t\t\treturn this.data.count;\n\n\t\t},\n\n\t\tget array() {\n\n\t\t\treturn this.data.array;\n\n\t\t},\n\n\t\tsetX: function ( index, x ) {\n\n\t\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetY: function ( index, y ) {\n\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetZ: function ( index, z ) {\n\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetW: function ( index, w ) {\n\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tgetX: function ( index ) {\n\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset ];\n\n\t\t},\n\n\t\tgetY: function ( index ) {\n\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\n\n\t\t},\n\n\t\tgetZ: function ( index ) {\n\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\n\n\t\t},\n\n\t\tgetW: function ( index ) {\n\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\n\n\t\t},\n\n\t\tsetXY: function ( index, x, y ) {\n\n\t\t\tindex = index * this.data.stride + this.offset;\n\n\t\t\tthis.data.array[ index + 0 ] = x;\n\t\t\tthis.data.array[ index + 1 ] = y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetXYZ: function ( index, x, y, z ) {\n\n\t\t\tindex = index * this.data.stride + this.offset;\n\n\t\t\tthis.data.array[ index + 0 ] = x;\n\t\t\tthis.data.array[ index + 1 ] = y;\n\t\t\tthis.data.array[ index + 2 ] = z;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetXYZW: function ( index, x, y, z, w ) {\n\n\t\t\tindex = index * this.data.stride + this.offset;\n\n\t\t\tthis.data.array[ index + 0 ] = x;\n\t\t\tthis.data.array[ index + 1 ] = y;\n\t\t\tthis.data.array[ index + 2 ] = z;\n\t\t\tthis.data.array[ index + 3 ] = w;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */\n\n\tfunction InterleavedBuffer( array, stride ) {\n\n\t\tthis.uuid = _Math.generateUUID();\n\n\t\tthis.array = array;\n\t\tthis.stride = stride;\n\t\tthis.count = array !== undefined ? array.length / stride : 0;\n\n\t\tthis.dynamic = false;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.onUploadCallback = function () {};\n\n\t\tthis.version = 0;\n\n\t}\n\n\tInterleavedBuffer.prototype = {\n\n\t\tconstructor: InterleavedBuffer,\n\n\t\tisInterleavedBuffer: true,\n\n\t\tset needsUpdate( value ) {\n\n\t\t\tif ( value === true ) this.version ++;\n\n\t\t},\n\n\t\tsetArray: function ( array ) {\n\n\t\t\tif ( Array.isArray( array ) ) {\n\n\t\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\n\n\t\t\t}\n\n\t\t\tthis.count = array !== undefined ? array.length / this.stride : 0;\n\t\t\tthis.array = array;\n\n\t\t},\n\n\t\tsetDynamic: function ( value ) {\n\n\t\t\tthis.dynamic = value;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopy: function ( source ) {\n\n\t\t\tthis.array = new source.array.constructor( source.array );\n\t\t\tthis.count = source.count;\n\t\t\tthis.stride = source.stride;\n\t\t\tthis.dynamic = source.dynamic;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tcopyAt: function ( index1, attribute, index2 ) {\n\n\t\t\tindex1 *= this.stride;\n\t\t\tindex2 *= attribute.stride;\n\n\t\t\tfor ( var i = 0, l = this.stride; i < l; i ++ ) {\n\n\t\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tset: function ( value, offset ) {\n\n\t\t\tif ( offset === undefined ) offset = 0;\n\n\t\t\tthis.array.set( value, offset );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tonUpload: function ( callback ) {\n\n\t\t\tthis.onUploadCallback = callback;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */\n\n\tfunction InstancedInterleavedBuffer( array, stride, meshPerAttribute ) {\n\n\t\tInterleavedBuffer.call( this, array, stride );\n\n\t\tthis.meshPerAttribute = meshPerAttribute || 1;\n\n\t}\n\n\tInstancedInterleavedBuffer.prototype = Object.create( InterleavedBuffer.prototype );\n\tInstancedInterleavedBuffer.prototype.constructor = InstancedInterleavedBuffer;\n\n\tInstancedInterleavedBuffer.prototype.isInstancedInterleavedBuffer = true;\n\n\tInstancedInterleavedBuffer.prototype.copy = function ( source ) {\n\n\t\tInterleavedBuffer.prototype.copy.call( this, source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */\n\n\tfunction InstancedBufferAttribute( array, itemSize, meshPerAttribute ) {\n\n\t\tBufferAttribute.call( this, array, itemSize );\n\n\t\tthis.meshPerAttribute = meshPerAttribute || 1;\n\n\t}\n\n\tInstancedBufferAttribute.prototype = Object.create( BufferAttribute.prototype );\n\tInstancedBufferAttribute.prototype.constructor = InstancedBufferAttribute;\n\n\tInstancedBufferAttribute.prototype.isInstancedBufferAttribute = true;\n\n\tInstancedBufferAttribute.prototype.copy = function ( source ) {\n\n\t\tBufferAttribute.prototype.copy.call( this, source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author bhouston / http://clara.io/\n\t * @author stephomi / http://stephaneginier.com/\n\t */\n\n\tfunction Raycaster( origin, direction, near, far ) {\n\n\t\tthis.ray = new Ray( origin, direction );\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.near = near || 0;\n\t\tthis.far = far || Infinity;\n\n\t\tthis.params = {\n\t\t\tMesh: {},\n\t\t\tLine: {},\n\t\t\tLOD: {},\n\t\t\tPoints: { threshold: 1 },\n\t\t\tSprite: {}\n\t\t};\n\n\t\tObject.defineProperties( this.params, {\n\t\t\tPointCloud: {\n\t\t\t\tget: function () {\n\t\t\t\t\tconsole.warn( 'THREE.Raycaster: params.PointCloud has been renamed to params.Points.' );\n\t\t\t\t\treturn this.Points;\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t}\n\n\tfunction ascSort( a, b ) {\n\n\t\treturn a.distance - b.distance;\n\n\t}\n\n\tfunction intersectObject( object, raycaster, intersects, recursive ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tobject.raycast( raycaster, intersects );\n\n\t\tif ( recursive === true ) {\n\n\t\t\tvar children = object.children;\n\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t//\n\n\tRaycaster.prototype = {\n\n\t\tconstructor: Raycaster,\n\n\t\tlinePrecision: 1,\n\n\t\tset: function ( origin, direction ) {\n\n\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\t\tthis.ray.set( origin, direction );\n\n\t\t},\n\n\t\tsetFromCamera: function ( coords, camera ) {\n\n\t\t\tif ( (camera && camera.isPerspectiveCamera) ) {\n\n\t\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\n\t\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\n\n\t\t\t} else if ( (camera && camera.isOrthographicCamera) ) {\n\n\t\t\t\tthis.ray.origin.set( coords.x, coords.y, ( camera.near + camera.far ) / ( camera.near - camera.far ) ).unproject( camera ); // set origin in plane of camera\n\t\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type.' );\n\n\t\t\t}\n\n\t\t},\n\n\t\tintersectObject: function ( object, recursive ) {\n\n\t\t\tvar intersects = [];\n\n\t\t\tintersectObject( object, this, intersects, recursive );\n\n\t\t\tintersects.sort( ascSort );\n\n\t\t\treturn intersects;\n\n\t\t},\n\n\t\tintersectObjects: function ( objects, recursive ) {\n\n\t\t\tvar intersects = [];\n\n\t\t\tif ( Array.isArray( objects ) === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.Raycaster.intersectObjects: objects is not an Array.' );\n\t\t\t\treturn intersects;\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\n\n\t\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\n\n\t\t\t}\n\n\t\t\tintersects.sort( ascSort );\n\n\t\t\treturn intersects;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction Clock( autoStart ) {\n\n\t\tthis.autoStart = ( autoStart !== undefined ) ? autoStart : true;\n\n\t\tthis.startTime = 0;\n\t\tthis.oldTime = 0;\n\t\tthis.elapsedTime = 0;\n\n\t\tthis.running = false;\n\n\t}\n\n\tClock.prototype = {\n\n\t\tconstructor: Clock,\n\n\t\tstart: function () {\n\n\t\t\tthis.startTime = ( performance || Date ).now();\n\n\t\t\tthis.oldTime = this.startTime;\n\t\t\tthis.elapsedTime = 0;\n\t\t\tthis.running = true;\n\n\t\t},\n\n\t\tstop: function () {\n\n\t\t\tthis.getElapsedTime();\n\t\t\tthis.running = false;\n\n\t\t},\n\n\t\tgetElapsedTime: function () {\n\n\t\t\tthis.getDelta();\n\t\t\treturn this.elapsedTime;\n\n\t\t},\n\n\t\tgetDelta: function () {\n\n\t\t\tvar diff = 0;\n\n\t\t\tif ( this.autoStart && ! this.running ) {\n\n\t\t\t\tthis.start();\n\n\t\t\t}\n\n\t\t\tif ( this.running ) {\n\n\t\t\t\tvar newTime = ( performance || Date ).now();\n\n\t\t\t\tdiff = ( newTime - this.oldTime ) / 1000;\n\t\t\t\tthis.oldTime = newTime;\n\n\t\t\t\tthis.elapsedTime += diff;\n\n\t\t\t}\n\n\t\t\treturn diff;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author bhouston / http://clara.io\n\t * @author WestLangley / http://github.com/WestLangley\n\t *\n\t * Ref: https://en.wikipedia.org/wiki/Spherical_coordinate_system\n\t *\n\t * The poles (phi) are at the positive and negative y axis.\n\t * The equator starts at positive z.\n\t */\n\n\tfunction Spherical( radius, phi, theta ) {\n\n\t\tthis.radius = ( radius !== undefined ) ? radius : 1.0;\n\t\tthis.phi = ( phi !== undefined ) ? phi : 0; // up / down towards top and bottom pole\n\t\tthis.theta = ( theta !== undefined ) ? theta : 0; // around the equator of the sphere\n\n\t\treturn this;\n\n\t}\n\n\tSpherical.prototype = {\n\n\t\tconstructor: Spherical,\n\n\t\tset: function ( radius, phi, theta ) {\n\n\t\t\tthis.radius = radius;\n\t\t\tthis.phi = phi;\n\t\t\tthis.theta = theta;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( other ) {\n\n\t\t\tthis.radius = other.radius;\n\t\t\tthis.phi = other.phi;\n\t\t\tthis.theta = other.theta;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// restrict phi to be betwee EPS and PI-EPS\n\t\tmakeSafe: function() {\n\n\t\t\tvar EPS = 0.000001;\n\t\t\tthis.phi = Math.max( EPS, Math.min( Math.PI - EPS, this.phi ) );\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromVector3: function( vec3 ) {\n\n\t\t\tthis.radius = vec3.length();\n\n\t\t\tif ( this.radius === 0 ) {\n\n\t\t\t\tthis.theta = 0;\n\t\t\t\tthis.phi = 0;\n\n\t\t\t} else {\n\n\t\t\t\tthis.theta = Math.atan2( vec3.x, vec3.z ); // equator angle around y-up axis\n\t\t\t\tthis.phi = Math.acos( _Math.clamp( vec3.y / this.radius, - 1, 1 ) ); // polar angle\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author Mugen87 / https://github.com/Mugen87\n\t *\n\t * Ref: https://en.wikipedia.org/wiki/Cylindrical_coordinate_system\n\t *\n\t */\n\n\tfunction Cylindrical( radius, theta, y ) {\n\n\t\tthis.radius = ( radius !== undefined ) ? radius : 1.0; // distance from the origin to a point in the x-z plane\n\t\tthis.theta = ( theta !== undefined ) ? theta : 0; // counterclockwise angle in the x-z plane measured in radians from the positive z-axis\n\t\tthis.y = ( y !== undefined ) ? y : 0; // height above the x-z plane\n\n\t\treturn this;\n\n\t}\n\n\tCylindrical.prototype = {\n\n\t\tconstructor: Cylindrical,\n\n\t\tset: function ( radius, theta, y ) {\n\n\t\t\tthis.radius = radius;\n\t\t\tthis.theta = theta;\n\t\t\tthis.y = y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tclone: function () {\n\n\t\t\treturn new this.constructor().copy( this );\n\n\t\t},\n\n\t\tcopy: function ( other ) {\n\n\t\t\tthis.radius = other.radius;\n\t\t\tthis.theta = other.theta;\n\t\t\tthis.y = other.y;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetFromVector3: function( vec3 ) {\n\n\t\t\tthis.radius = Math.sqrt( vec3.x * vec3.x + vec3.z * vec3.z );\n\t\t\tthis.theta = Math.atan2( vec3.x, vec3.z );\n\t\t\tthis.y = vec3.y;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction MorphBlendMesh( geometry, material ) {\n\n\t\tMesh.call( this, geometry, material );\n\n\t\tthis.animationsMap = {};\n\t\tthis.animationsList = [];\n\n\t\t// prepare default animation\n\t\t// (all frames played together in 1 second)\n\n\t\tvar numFrames = this.geometry.morphTargets.length;\n\n\t\tvar name = \"__default\";\n\n\t\tvar startFrame = 0;\n\t\tvar endFrame = numFrames - 1;\n\n\t\tvar fps = numFrames / 1;\n\n\t\tthis.createAnimation( name, startFrame, endFrame, fps );\n\t\tthis.setAnimationWeight( name, 1 );\n\n\t}\n\n\tMorphBlendMesh.prototype = Object.create( Mesh.prototype );\n\tMorphBlendMesh.prototype.constructor = MorphBlendMesh;\n\n\tMorphBlendMesh.prototype.createAnimation = function ( name, start, end, fps ) {\n\n\t\tvar animation = {\n\n\t\t\tstart: start,\n\t\t\tend: end,\n\n\t\t\tlength: end - start + 1,\n\n\t\t\tfps: fps,\n\t\t\tduration: ( end - start ) / fps,\n\n\t\t\tlastFrame: 0,\n\t\t\tcurrentFrame: 0,\n\n\t\t\tactive: false,\n\n\t\t\ttime: 0,\n\t\t\tdirection: 1,\n\t\t\tweight: 1,\n\n\t\t\tdirectionBackwards: false,\n\t\t\tmirroredLoop: false\n\n\t\t};\n\n\t\tthis.animationsMap[ name ] = animation;\n\t\tthis.animationsList.push( animation );\n\n\t};\n\n\tMorphBlendMesh.prototype.autoCreateAnimations = function ( fps ) {\n\n\t\tvar pattern = /([a-z]+)_?(\\d+)/i;\n\n\t\tvar firstAnimation, frameRanges = {};\n\n\t\tvar geometry = this.geometry;\n\n\t\tfor ( var i = 0, il = geometry.morphTargets.length; i < il; i ++ ) {\n\n\t\t\tvar morph = geometry.morphTargets[ i ];\n\t\t\tvar chunks = morph.name.match( pattern );\n\n\t\t\tif ( chunks && chunks.length > 1 ) {\n\n\t\t\t\tvar name = chunks[ 1 ];\n\n\t\t\t\tif ( ! frameRanges[ name ] ) frameRanges[ name ] = { start: Infinity, end: - Infinity };\n\n\t\t\t\tvar range = frameRanges[ name ];\n\n\t\t\t\tif ( i < range.start ) range.start = i;\n\t\t\t\tif ( i > range.end ) range.end = i;\n\n\t\t\t\tif ( ! firstAnimation ) firstAnimation = name;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( var name in frameRanges ) {\n\n\t\t\tvar range = frameRanges[ name ];\n\t\t\tthis.createAnimation( name, range.start, range.end, fps );\n\n\t\t}\n\n\t\tthis.firstAnimation = firstAnimation;\n\n\t};\n\n\tMorphBlendMesh.prototype.setAnimationDirectionForward = function ( name ) {\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\tanimation.direction = 1;\n\t\t\tanimation.directionBackwards = false;\n\n\t\t}\n\n\t};\n\n\tMorphBlendMesh.prototype.setAnimationDirectionBackward = function ( name ) {\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\tanimation.direction = - 1;\n\t\t\tanimation.directionBackwards = true;\n\n\t\t}\n\n\t};\n\n\tMorphBlendMesh.prototype.setAnimationFPS = function ( name, fps ) {\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\tanimation.fps = fps;\n\t\t\tanimation.duration = ( animation.end - animation.start ) / animation.fps;\n\n\t\t}\n\n\t};\n\n\tMorphBlendMesh.prototype.setAnimationDuration = function ( name, duration ) {\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\tanimation.duration = duration;\n\t\t\tanimation.fps = ( animation.end - animation.start ) / animation.duration;\n\n\t\t}\n\n\t};\n\n\tMorphBlendMesh.prototype.setAnimationWeight = function ( name, weight ) {\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\tanimation.weight = weight;\n\n\t\t}\n\n\t};\n\n\tMorphBlendMesh.prototype.setAnimationTime = function ( name, time ) {\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\tanimation.time = time;\n\n\t\t}\n\n\t};\n\n\tMorphBlendMesh.prototype.getAnimationTime = function ( name ) {\n\n\t\tvar time = 0;\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\ttime = animation.time;\n\n\t\t}\n\n\t\treturn time;\n\n\t};\n\n\tMorphBlendMesh.prototype.getAnimationDuration = function ( name ) {\n\n\t\tvar duration = - 1;\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\tduration = animation.duration;\n\n\t\t}\n\n\t\treturn duration;\n\n\t};\n\n\tMorphBlendMesh.prototype.playAnimation = function ( name ) {\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\tanimation.time = 0;\n\t\t\tanimation.active = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( \"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\" );\n\n\t\t}\n\n\t};\n\n\tMorphBlendMesh.prototype.stopAnimation = function ( name ) {\n\n\t\tvar animation = this.animationsMap[ name ];\n\n\t\tif ( animation ) {\n\n\t\t\tanimation.active = false;\n\n\t\t}\n\n\t};\n\n\tMorphBlendMesh.prototype.update = function ( delta ) {\n\n\t\tfor ( var i = 0, il = this.animationsList.length; i < il; i ++ ) {\n\n\t\t\tvar animation = this.animationsList[ i ];\n\n\t\t\tif ( ! animation.active ) continue;\n\n\t\t\tvar frameTime = animation.duration / animation.length;\n\n\t\t\tanimation.time += animation.direction * delta;\n\n\t\t\tif ( animation.mirroredLoop ) {\n\n\t\t\t\tif ( animation.time > animation.duration || animation.time < 0 ) {\n\n\t\t\t\t\tanimation.direction *= - 1;\n\n\t\t\t\t\tif ( animation.time > animation.duration ) {\n\n\t\t\t\t\t\tanimation.time = animation.duration;\n\t\t\t\t\t\tanimation.directionBackwards = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( animation.time < 0 ) {\n\n\t\t\t\t\t\tanimation.time = 0;\n\t\t\t\t\t\tanimation.directionBackwards = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tanimation.time = animation.time % animation.duration;\n\n\t\t\t\tif ( animation.time < 0 ) animation.time += animation.duration;\n\n\t\t\t}\n\n\t\t\tvar keyframe = animation.start + _Math.clamp( Math.floor( animation.time / frameTime ), 0, animation.length - 1 );\n\t\t\tvar weight = animation.weight;\n\n\t\t\tif ( keyframe !== animation.currentFrame ) {\n\n\t\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = 0;\n\t\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = 1 * weight;\n\n\t\t\t\tthis.morphTargetInfluences[ keyframe ] = 0;\n\n\t\t\t\tanimation.lastFrame = animation.currentFrame;\n\t\t\t\tanimation.currentFrame = keyframe;\n\n\t\t\t}\n\n\t\t\tvar mix = ( animation.time % frameTime ) / frameTime;\n\n\t\t\tif ( animation.directionBackwards ) mix = 1 - mix;\n\n\t\t\tif ( animation.currentFrame !== animation.lastFrame ) {\n\n\t\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = mix * weight;\n\t\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = ( 1 - mix ) * weight;\n\n\t\t\t} else {\n\n\t\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = weight;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tfunction ImmediateRenderObject( material ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.material = material;\n\t\tthis.render = function ( renderCallback ) {};\n\n\t}\n\n\tImmediateRenderObject.prototype = Object.create( Object3D.prototype );\n\tImmediateRenderObject.prototype.constructor = ImmediateRenderObject;\n\n\tImmediateRenderObject.prototype.isImmediateRenderObject = true;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/\n\n\tfunction VertexNormalsHelper( object, size, hex, linewidth ) {\n\n\t\tthis.object = object;\n\n\t\tthis.size = ( size !== undefined ) ? size : 1;\n\n\t\tvar color = ( hex !== undefined ) ? hex : 0xff0000;\n\n\t\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\n\n\t\t//\n\n\t\tvar nNormals = 0;\n\n\t\tvar objGeometry = this.object.geometry;\n\n\t\tif ( objGeometry && objGeometry.isGeometry ) {\n\n\t\t\tnNormals = objGeometry.faces.length * 3;\n\n\t\t} else if ( objGeometry && objGeometry.isBufferGeometry ) {\n\n\t\t\tnNormals = objGeometry.attributes.normal.count;\n\n\t\t}\n\n\t\t//\n\n\t\tvar geometry = new BufferGeometry();\n\n\t\tvar positions = new Float32BufferAttribute( nNormals * 2 * 3, 3 );\n\n\t\tgeometry.addAttribute( 'position', positions );\n\n\t\tLineSegments.call( this, geometry, new LineBasicMaterial( { color: color, linewidth: width } ) );\n\n\t\t//\n\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\t}\n\n\tVertexNormalsHelper.prototype = Object.create( LineSegments.prototype );\n\tVertexNormalsHelper.prototype.constructor = VertexNormalsHelper;\n\n\tVertexNormalsHelper.prototype.update = ( function () {\n\n\t\tvar v1 = new Vector3();\n\t\tvar v2 = new Vector3();\n\t\tvar normalMatrix = new Matrix3();\n\n\t\treturn function update() {\n\n\t\t\tvar keys = [ 'a', 'b', 'c' ];\n\n\t\t\tthis.object.updateMatrixWorld( true );\n\n\t\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\n\n\t\t\tvar matrixWorld = this.object.matrixWorld;\n\n\t\t\tvar position = this.geometry.attributes.position;\n\n\t\t\t//\n\n\t\t\tvar objGeometry = this.object.geometry;\n\n\t\t\tif ( objGeometry && objGeometry.isGeometry ) {\n\n\t\t\t\tvar vertices = objGeometry.vertices;\n\n\t\t\t\tvar faces = objGeometry.faces;\n\n\t\t\t\tvar idx = 0;\n\n\t\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar face = faces[ i ];\n\n\t\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar vertex = vertices[ face[ keys[ j ] ] ];\n\n\t\t\t\t\t\tvar normal = face.vertexNormals[ j ];\n\n\t\t\t\t\t\tv1.copy( vertex ).applyMatrix4( matrixWorld );\n\n\t\t\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\n\n\t\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\n\n\t\t\t\t\t\tidx = idx + 1;\n\n\t\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\n\n\t\t\t\t\t\tidx = idx + 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( objGeometry && objGeometry.isBufferGeometry ) {\n\n\t\t\t\tvar objPos = objGeometry.attributes.position;\n\n\t\t\t\tvar objNorm = objGeometry.attributes.normal;\n\n\t\t\t\tvar idx = 0;\n\n\t\t\t\t// for simplicity, ignore index and drawcalls, and render every normal\n\n\t\t\t\tfor ( var j = 0, jl = objPos.count; j < jl; j ++ ) {\n\n\t\t\t\t\tv1.set( objPos.getX( j ), objPos.getY( j ), objPos.getZ( j ) ).applyMatrix4( matrixWorld );\n\n\t\t\t\t\tv2.set( objNorm.getX( j ), objNorm.getY( j ), objNorm.getZ( j ) );\n\n\t\t\t\t\tv2.applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\n\n\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\n\n\t\t\t\t\tidx = idx + 1;\n\n\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\n\n\t\t\t\t\tidx = idx + 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}() );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/\n\n\tfunction SpotLightHelper( light ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.light = light;\n\t\tthis.light.updateMatrixWorld();\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tvar geometry = new BufferGeometry();\n\n\t\tvar positions = [\n\t\t\t0, 0, 0,   0,   0,   1,\n\t\t\t0, 0, 0,   1,   0,   1,\n\t\t\t0, 0, 0, - 1,   0,   1,\n\t\t\t0, 0, 0,   0,   1,   1,\n\t\t\t0, 0, 0,   0, - 1,   1\n\t\t];\n\n\t\tfor ( var i = 0, j = 1, l = 32; i < l; i ++, j ++ ) {\n\n\t\t\tvar p1 = ( i / l ) * Math.PI * 2;\n\t\t\tvar p2 = ( j / l ) * Math.PI * 2;\n\n\t\t\tpositions.push(\n\t\t\t\tMath.cos( p1 ), Math.sin( p1 ), 1,\n\t\t\t\tMath.cos( p2 ), Math.sin( p2 ), 1\n\t\t\t);\n\n\t\t}\n\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\n\t\tvar material = new LineBasicMaterial( { fog: false } );\n\n\t\tthis.cone = new LineSegments( geometry, material );\n\t\tthis.add( this.cone );\n\n\t\tthis.update();\n\n\t}\n\n\tSpotLightHelper.prototype = Object.create( Object3D.prototype );\n\tSpotLightHelper.prototype.constructor = SpotLightHelper;\n\n\tSpotLightHelper.prototype.dispose = function () {\n\n\t\tthis.cone.geometry.dispose();\n\t\tthis.cone.material.dispose();\n\n\t};\n\n\tSpotLightHelper.prototype.update = function () {\n\n\t\tvar vector = new Vector3();\n\t\tvar vector2 = new Vector3();\n\n\t\treturn function update() {\n\n\t\t\tvar coneLength = this.light.distance ? this.light.distance : 1000;\n\t\t\tvar coneWidth = coneLength * Math.tan( this.light.angle );\n\n\t\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\n\n\t\t\tvector.setFromMatrixPosition( this.light.matrixWorld );\n\t\t\tvector2.setFromMatrixPosition( this.light.target.matrixWorld );\n\n\t\t\tthis.cone.lookAt( vector2.sub( vector ) );\n\n\t\t\tthis.cone.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\t\t};\n\n\t}();\n\n\t/**\n\t * @author Sean Griffin / http://twitter.com/sgrif\n\t * @author Michael Guerrero / http://realitymeltdown.com\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author ikerr / http://verold.com\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction SkeletonHelper( object ) {\n\n\t\tthis.bones = this.getBoneList( object );\n\n\t\tvar geometry = new BufferGeometry();\n\n\t\tvar vertices = [];\n\t\tvar colors = [];\n\n\t\tvar color1 = new Color( 0, 0, 1 );\n\t\tvar color2 = new Color( 0, 1, 0 );\n\n\t\tfor ( var i = 0; i < this.bones.length; i ++ ) {\n\n\t\t\tvar bone = this.bones[ i ];\n\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tcolors.push( color1.r, color1.g, color1.b );\n\t\t\t\tcolors.push( color2.r, color2.g, color2.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tvar material = new LineBasicMaterial( { vertexColors: VertexColors, depthTest: false, depthWrite: false, transparent: true } );\n\n\t\tLineSegments.call( this, geometry, material );\n\n\t\tthis.root = object;\n\n\t\tthis.matrix = object.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\t}\n\n\n\tSkeletonHelper.prototype = Object.create( LineSegments.prototype );\n\tSkeletonHelper.prototype.constructor = SkeletonHelper;\n\n\tSkeletonHelper.prototype.getBoneList = function( object ) {\n\n\t\tvar boneList = [];\n\n\t\tif ( object && object.isBone ) {\n\n\t\t\tboneList.push( object );\n\n\t\t}\n\n\t\tfor ( var i = 0; i < object.children.length; i ++ ) {\n\n\t\t\tboneList.push.apply( boneList, this.getBoneList( object.children[ i ] ) );\n\n\t\t}\n\n\t\treturn boneList;\n\n\t};\n\n\tSkeletonHelper.prototype.update = function () {\n\n\t\tvar vector = new Vector3();\n\n\t\tvar boneMatrix = new Matrix4();\n\t\tvar matrixWorldInv = new Matrix4();\n\n\t\treturn function update() {\n\n\t\t\tvar geometry = this.geometry;\n\t\t\tvar position = geometry.getAttribute( 'position' );\n\n\t\t\tmatrixWorldInv.getInverse( this.root.matrixWorld );\n\n\t\t\tfor ( var i = 0, j = 0; i < this.bones.length; i ++ ) {\n\n\t\t\t\tvar bone = this.bones[ i ];\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.matrixWorld );\n\t\t\t\t\tvector.setFromMatrixPosition( boneMatrix );\n\t\t\t\t\tposition.setXYZ( j, vector.x, vector.y, vector.z );\n\n\t\t\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.parent.matrixWorld );\n\t\t\t\t\tvector.setFromMatrixPosition( boneMatrix );\n\t\t\t\t\tposition.setXYZ( j + 1, vector.x, vector.y, vector.z );\n\n\t\t\t\t\tj += 2;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t\t};\n\n\t}();\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction PointLightHelper( light, sphereSize ) {\n\n\t\tthis.light = light;\n\t\tthis.light.updateMatrixWorld();\n\n\t\tvar geometry = new SphereBufferGeometry( sphereSize, 4, 2 );\n\t\tvar material = new MeshBasicMaterial( { wireframe: true, fog: false } );\n\t\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\t\tMesh.call( this, geometry, material );\n\n\t\tthis.matrix = this.light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\t/*\n\t\tvar distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\n\t\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\n\n\t\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\n\t\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\n\n\t\tvar d = light.distance;\n\n\t\tif ( d === 0.0 ) {\n\n\t\t\tthis.lightDistance.visible = false;\n\n\t\t} else {\n\n\t\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t\t}\n\n\t\tthis.add( this.lightDistance );\n\t\t*/\n\n\t}\n\n\tPointLightHelper.prototype = Object.create( Mesh.prototype );\n\tPointLightHelper.prototype.constructor = PointLightHelper;\n\n\tPointLightHelper.prototype.dispose = function () {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t};\n\n\tPointLightHelper.prototype.update = function () {\n\n\t\tthis.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\t\t/*\n\t\tvar d = this.light.distance;\n\n\t\tif ( d === 0.0 ) {\n\n\t\t\tthis.lightDistance.visible = false;\n\n\t\t} else {\n\n\t\t\tthis.lightDistance.visible = true;\n\t\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t\t}\n\t\t*/\n\n\t};\n\n\t/**\n\t * @author abelnation / http://github.com/abelnation\n\t * @author Mugen87 / http://github.com/Mugen87\n\t */\n\n\tfunction RectAreaLightHelper( light ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.light = light;\n\t\tthis.light.updateMatrixWorld();\n\n\t\tvar materialFront = new MeshBasicMaterial( {\n\t\t\tcolor: light.color,\n\t\t\tfog: false\n\t\t} );\n\n\t\tvar materialBack = new MeshBasicMaterial( {\n\t\t\tcolor: light.color,\n\t\t\tfog: false,\n\t\t\twireframe: true\n\t\t} );\n\n\t\tvar geometry = new BufferGeometry();\n\n\t\tgeometry.addAttribute( 'position', new BufferAttribute( new Float32Array( 6 * 3 ), 3 ) );\n\n\t\t// shows the \"front\" of the light, e.g. where light comes from\n\n\t\tthis.add( new Mesh( geometry, materialFront ) );\n\n\t\t// shows the \"back\" of the light, which does not emit light\n\n\t\tthis.add( new Mesh( geometry, materialBack ) );\n\n\t\tthis.update();\n\n\t}\n\n\tRectAreaLightHelper.prototype = Object.create( Object3D.prototype );\n\tRectAreaLightHelper.prototype.constructor = RectAreaLightHelper;\n\n\tRectAreaLightHelper.prototype.dispose = function () {\n\n\t\tthis.children[ 0 ].geometry.dispose();\n\t\tthis.children[ 0 ].material.dispose();\n\t\tthis.children[ 1 ].geometry.dispose();\n\t\tthis.children[ 1 ].material.dispose();\n\n\t};\n\n\tRectAreaLightHelper.prototype.update = function () {\n\n\t\tvar vector1 = new Vector3();\n\t\tvar vector2 = new Vector3();\n\n\t\treturn function update() {\n\n\t\t\tvar mesh1 = this.children[ 0 ];\n\t\t\tvar mesh2 = this.children[ 1 ];\n\n\t\t\tif ( this.light.target ) {\n\n\t\t\t\tvector1.setFromMatrixPosition( this.light.matrixWorld );\n\t\t\t\tvector2.setFromMatrixPosition( this.light.target.matrixWorld );\n\n\t\t\t\tvar lookVec = vector2.clone().sub( vector1 );\n\t\t\t\tmesh1.lookAt( lookVec );\n\t\t\t\tmesh2.lookAt( lookVec );\n\n\t\t\t}\n\n\t\t\t// update materials\n\n\t\t\tmesh1.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\t\t\tmesh2.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\t\t\t// calculate new dimensions of the helper\n\n\t\t\tvar hx = this.light.width * 0.5;\n\t\t\tvar hy = this.light.height * 0.5;\n\n\t\t\t// because the buffer attribute is shared over both geometries, we only have to update once\n\n\t\t\tvar position = mesh1.geometry.getAttribute( 'position' );\n\t\t\tvar array = position.array;\n\n\t\t\t// first face\n\n\t\t\tarray[  0 ] =   hx; array[  1 ] = - hy; array[  2 ] = 0;\n\t\t\tarray[  3 ] =   hx; array[  4 ] =   hy; array[  5 ] = 0;\n\t\t\tarray[  6 ] = - hx; array[  7 ] =   hy; array[  8 ] = 0;\n\n\t\t\t// second face\n\n\t\t\tarray[  9 ] = - hx; array[ 10 ] =   hy; array[ 11 ] = 0;\n\t\t\tarray[ 12 ] = - hx; array[ 13 ] = - hy; array[ 14 ] = 0;\n\t\t\tarray[ 15 ] =   hx; array[ 16 ] = - hy; array[ 17 ] = 0;\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t};\n\n\t}();\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author Mugen87 / https://github.com/Mugen87\n\t */\n\n\tfunction HemisphereLightHelper( light, size ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.light = light;\n\t\tthis.light.updateMatrixWorld();\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tvar geometry = new OctahedronBufferGeometry( size );\n\t\tgeometry.rotateY( Math.PI * 0.5 );\n\n\t\tvar material = new MeshBasicMaterial( { vertexColors: VertexColors, wireframe: true } );\n\n\t\tvar position = geometry.getAttribute( 'position' );\n\t\tvar colors = new Float32Array( position.count * 3 );\n\n\t\tgeometry.addAttribute( 'color', new BufferAttribute( colors, 3 ) );\n\n\t\tthis.add( new Mesh( geometry, material ) );\n\n\t\tthis.update();\n\n\t}\n\n\tHemisphereLightHelper.prototype = Object.create( Object3D.prototype );\n\tHemisphereLightHelper.prototype.constructor = HemisphereLightHelper;\n\n\tHemisphereLightHelper.prototype.dispose = function () {\n\n\t\tthis.children[ 0 ].geometry.dispose();\n\t\tthis.children[ 0 ].material.dispose();\n\n\t};\n\n\tHemisphereLightHelper.prototype.update = function () {\n\n\t\tvar vector = new Vector3();\n\n\t\tvar color1 = new Color();\n\t\tvar color2 = new Color();\n\n\t\treturn function update() {\n\n\t\t\tvar mesh = this.children[ 0 ];\n\n\t\t\tvar colors = mesh.geometry.getAttribute( 'color' );\n\n\t\t\tcolor1.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\t\t\tcolor2.copy( this.light.groundColor ).multiplyScalar( this.light.intensity );\n\n\t\t\tfor ( var i = 0, l = colors.count; i < l; i ++ ) {\n\n\t\t\t\tvar color = ( i < ( l / 2 ) ) ? color1 : color2;\n\n\t\t\t\tcolors.setXYZ( i, color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t\tmesh.lookAt( vector.setFromMatrixPosition( this.light.matrixWorld ).negate() );\n\n\t\t\tcolors.needsUpdate = true;\n\n\t\t};\n\n\t}();\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction GridHelper( size, divisions, color1, color2 ) {\n\n\t\tsize = size || 10;\n\t\tdivisions = divisions || 10;\n\t\tcolor1 = new Color( color1 !== undefined ? color1 : 0x444444 );\n\t\tcolor2 = new Color( color2 !== undefined ? color2 : 0x888888 );\n\n\t\tvar center = divisions / 2;\n\t\tvar step = ( size * 2 ) / divisions;\n\t\tvar vertices = [], colors = [];\n\n\t\tfor ( var i = 0, j = 0, k = - size; i <= divisions; i ++, k += step ) {\n\n\t\t\tvertices.push( - size, 0, k, size, 0, k );\n\t\t\tvertices.push( k, 0, - size, k, 0, size );\n\n\t\t\tvar color = i === center ? color1 : color2;\n\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\n\t\t}\n\n\t\tvar geometry = new BufferGeometry();\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tvar material = new LineBasicMaterial( { vertexColors: VertexColors } );\n\n\t\tLineSegments.call( this, geometry, material );\n\n\t}\n\n\tGridHelper.prototype = Object.create( LineSegments.prototype );\n\tGridHelper.prototype.constructor = GridHelper;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author Mugen87 / http://github.com/Mugen87\n\t * @author Hectate / http://www.github.com/Hectate\n\t */\n\n\tfunction PolarGridHelper( radius, radials, circles, divisions, color1, color2 ) {\n\n\t\tradius = radius || 10;\n\t\tradials = radials || 16;\n\t\tcircles = circles || 8;\n\t\tdivisions = divisions || 64;\n\t\tcolor1 = new Color( color1 !== undefined ? color1 : 0x444444 );\n\t\tcolor2 = new Color( color2 !== undefined ? color2 : 0x888888 );\n\n\t\tvar vertices = [];\n\t\tvar colors = [];\n\n\t\tvar x, z;\n\t\tvar v, i, j, r, color;\n\n\t\t// create the radials\n\n\t\tfor ( i = 0; i <= radials; i ++ ) {\n\n\t\t\tv = ( i / radials ) * ( Math.PI * 2 );\n\n\t\t\tx = Math.sin( v ) * radius;\n\t\t\tz = Math.cos( v ) * radius;\n\n\t\t\tvertices.push( 0, 0, 0 );\n\t\t\tvertices.push( x, 0, z );\n\n\t\t\tcolor = ( i & 1 ) ? color1 : color2;\n\n\t\t\tcolors.push( color.r, color.g, color.b );\n\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t}\n\n\t\t// create the circles\n\n\t\tfor ( i = 0; i <= circles; i ++ ) {\n\n\t\t\tcolor = ( i & 1 ) ? color1 : color2;\n\n\t\t\tr = radius - ( radius / circles * i );\n\n\t\t\tfor ( j = 0; j < divisions; j ++ ) {\n\n\t\t\t\t// first vertex\n\n\t\t\t\tv = ( j / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tx = Math.sin( v ) * r;\n\t\t\t\tz = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t\t// second vertex\n\n\t\t\t\tv = ( ( j + 1 ) / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tx = Math.sin( v ) * r;\n\t\t\t\tz = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar geometry = new BufferGeometry();\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tvar material = new LineBasicMaterial( { vertexColors: VertexColors } );\n\n\t\tLineSegments.call( this, geometry, material );\n\n\t}\n\n\tPolarGridHelper.prototype = Object.create( LineSegments.prototype );\n\tPolarGridHelper.prototype.constructor = PolarGridHelper;\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/\n\n\tfunction FaceNormalsHelper( object, size, hex, linewidth ) {\n\n\t\t// FaceNormalsHelper only supports THREE.Geometry\n\n\t\tthis.object = object;\n\n\t\tthis.size = ( size !== undefined ) ? size : 1;\n\n\t\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\n\n\t\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\n\n\t\t//\n\n\t\tvar nNormals = 0;\n\n\t\tvar objGeometry = this.object.geometry;\n\n\t\tif ( objGeometry && objGeometry.isGeometry ) {\n\n\t\t\tnNormals = objGeometry.faces.length;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.' );\n\n\t\t}\n\n\t\t//\n\n\t\tvar geometry = new BufferGeometry();\n\n\t\tvar positions = new Float32BufferAttribute( nNormals * 2 * 3, 3 );\n\n\t\tgeometry.addAttribute( 'position', positions );\n\n\t\tLineSegments.call( this, geometry, new LineBasicMaterial( { color: color, linewidth: width } ) );\n\n\t\t//\n\n\t\tthis.matrixAutoUpdate = false;\n\t\tthis.update();\n\n\t}\n\n\tFaceNormalsHelper.prototype = Object.create( LineSegments.prototype );\n\tFaceNormalsHelper.prototype.constructor = FaceNormalsHelper;\n\n\tFaceNormalsHelper.prototype.update = ( function () {\n\n\t\tvar v1 = new Vector3();\n\t\tvar v2 = new Vector3();\n\t\tvar normalMatrix = new Matrix3();\n\n\t\treturn function update() {\n\n\t\t\tthis.object.updateMatrixWorld( true );\n\n\t\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\n\n\t\t\tvar matrixWorld = this.object.matrixWorld;\n\n\t\t\tvar position = this.geometry.attributes.position;\n\n\t\t\t//\n\n\t\t\tvar objGeometry = this.object.geometry;\n\n\t\t\tvar vertices = objGeometry.vertices;\n\n\t\t\tvar faces = objGeometry.faces;\n\n\t\t\tvar idx = 0;\n\n\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\tvar face = faces[ i ];\n\n\t\t\t\tvar normal = face.normal;\n\n\t\t\t\tv1.copy( vertices[ face.a ] )\n\t\t\t\t\t.add( vertices[ face.b ] )\n\t\t\t\t\t.add( vertices[ face.c ] )\n\t\t\t\t\t.divideScalar( 3 )\n\t\t\t\t\t.applyMatrix4( matrixWorld );\n\n\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\n\n\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\n\n\t\t\t\tidx = idx + 1;\n\n\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\n\n\t\t\t\tidx = idx + 1;\n\n\t\t\t}\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}() );\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t */\n\n\tfunction DirectionalLightHelper( light, size ) {\n\n\t\tObject3D.call( this );\n\n\t\tthis.light = light;\n\t\tthis.light.updateMatrixWorld();\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tif ( size === undefined ) size = 1;\n\n\t\tvar geometry = new BufferGeometry();\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( [\n\t\t\t- size,   size, 0,\n\t\t\t  size,   size, 0,\n\t\t\t  size, - size, 0,\n\t\t\t- size, - size, 0,\n\t\t\t- size,   size, 0\n\t\t], 3 ) );\n\n\t\tvar material = new LineBasicMaterial( { fog: false } );\n\n\t\tthis.add( new Line( geometry, material ) );\n\n\t\tgeometry = new BufferGeometry();\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 0, 1 ], 3 ) );\n\n\t\tthis.add( new Line( geometry, material ));\n\n\t\tthis.update();\n\n\t}\n\n\tDirectionalLightHelper.prototype = Object.create( Object3D.prototype );\n\tDirectionalLightHelper.prototype.constructor = DirectionalLightHelper;\n\n\tDirectionalLightHelper.prototype.dispose = function () {\n\n\t\tvar lightPlane = this.children[ 0 ];\n\t\tvar targetLine = this.children[ 1 ];\n\n\t\tlightPlane.geometry.dispose();\n\t\tlightPlane.material.dispose();\n\t\ttargetLine.geometry.dispose();\n\t\ttargetLine.material.dispose();\n\n\t};\n\n\tDirectionalLightHelper.prototype.update = function () {\n\n\t\tvar v1 = new Vector3();\n\t\tvar v2 = new Vector3();\n\t\tvar v3 = new Vector3();\n\n\t\treturn function update() {\n\n\t\t\tv1.setFromMatrixPosition( this.light.matrixWorld );\n\t\t\tv2.setFromMatrixPosition( this.light.target.matrixWorld );\n\t\t\tv3.subVectors( v2, v1 );\n\n\t\t\tvar lightPlane = this.children[ 0 ];\n\t\t\tvar targetLine = this.children[ 1 ];\n\n\t\t\tlightPlane.lookAt( v3 );\n\t\t\tlightPlane.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\t\t\ttargetLine.lookAt( v3 );\n\t\t\ttargetLine.scale.z = v3.length();\n\n\t\t};\n\n\t}();\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author Mugen87 / https://github.com/Mugen87\n\t *\n\t *\t- shows frustum, line of sight and up of the camera\n\t *\t- suitable for fast updates\n\t * \t- based on frustum visualization in lightgl.js shadowmap example\n\t *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\n\t */\n\n\tfunction CameraHelper( camera ) {\n\n\t\tvar geometry = new BufferGeometry();\n\t\tvar material = new LineBasicMaterial( { color: 0xffffff, vertexColors: FaceColors } );\n\n\t\tvar vertices = [];\n\t\tvar colors = [];\n\n\t\tvar pointMap = {};\n\n\t\t// colors\n\n\t\tvar colorFrustum = new Color( 0xffaa00 );\n\t\tvar colorCone = new Color( 0xff0000 );\n\t\tvar colorUp = new Color( 0x00aaff );\n\t\tvar colorTarget = new Color( 0xffffff );\n\t\tvar colorCross = new Color( 0x333333 );\n\n\t\t// near\n\n\t\taddLine( \"n1\", \"n2\", colorFrustum );\n\t\taddLine( \"n2\", \"n4\", colorFrustum );\n\t\taddLine( \"n4\", \"n3\", colorFrustum );\n\t\taddLine( \"n3\", \"n1\", colorFrustum );\n\n\t\t// far\n\n\t\taddLine( \"f1\", \"f2\", colorFrustum );\n\t\taddLine( \"f2\", \"f4\", colorFrustum );\n\t\taddLine( \"f4\", \"f3\", colorFrustum );\n\t\taddLine( \"f3\", \"f1\", colorFrustum );\n\n\t\t// sides\n\n\t\taddLine( \"n1\", \"f1\", colorFrustum );\n\t\taddLine( \"n2\", \"f2\", colorFrustum );\n\t\taddLine( \"n3\", \"f3\", colorFrustum );\n\t\taddLine( \"n4\", \"f4\", colorFrustum );\n\n\t\t// cone\n\n\t\taddLine( \"p\", \"n1\", colorCone );\n\t\taddLine( \"p\", \"n2\", colorCone );\n\t\taddLine( \"p\", \"n3\", colorCone );\n\t\taddLine( \"p\", \"n4\", colorCone );\n\n\t\t// up\n\n\t\taddLine( \"u1\", \"u2\", colorUp );\n\t\taddLine( \"u2\", \"u3\", colorUp );\n\t\taddLine( \"u3\", \"u1\", colorUp );\n\n\t\t// target\n\n\t\taddLine( \"c\", \"t\", colorTarget );\n\t\taddLine( \"p\", \"c\", colorCross );\n\n\t\t// cross\n\n\t\taddLine( \"cn1\", \"cn2\", colorCross );\n\t\taddLine( \"cn3\", \"cn4\", colorCross );\n\n\t\taddLine( \"cf1\", \"cf2\", colorCross );\n\t\taddLine( \"cf3\", \"cf4\", colorCross );\n\n\t\tfunction addLine( a, b, color ) {\n\n\t\t\taddPoint( a, color );\n\t\t\taddPoint( b, color );\n\n\t\t}\n\n\t\tfunction addPoint( id, color ) {\n\n\t\t\tvertices.push( 0, 0, 0 );\n\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\tif ( pointMap[ id ] === undefined ) {\n\n\t\t\t\tpointMap[ id ] = [];\n\n\t\t\t}\n\n\t\t\tpointMap[ id ].push( ( vertices.length / 3 ) - 1 );\n\n\t\t}\n\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tLineSegments.call( this, geometry, material );\n\n\t\tthis.camera = camera;\n\t\tif ( this.camera.updateProjectionMatrix ) this.camera.updateProjectionMatrix();\n\n\t\tthis.matrix = camera.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.pointMap = pointMap;\n\n\t\tthis.update();\n\n\t}\n\n\tCameraHelper.prototype = Object.create( LineSegments.prototype );\n\tCameraHelper.prototype.constructor = CameraHelper;\n\n\tCameraHelper.prototype.update = function () {\n\n\t\tvar geometry, pointMap;\n\n\t\tvar vector = new Vector3();\n\t\tvar camera = new Camera();\n\n\t\tfunction setPoint( point, x, y, z ) {\n\n\t\t\tvector.set( x, y, z ).unproject( camera );\n\n\t\t\tvar points = pointMap[ point ];\n\n\t\t\tif ( points !== undefined ) {\n\n\t\t\t\tvar position = geometry.getAttribute( 'position' );\n\n\t\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\t\t\tposition.setXYZ( points[ i ], vector.x, vector.y, vector.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn function update() {\n\n\t\t\tgeometry = this.geometry;\n\t\t\tpointMap = this.pointMap;\n\n\t\t\tvar w = 1, h = 1;\n\n\t\t\t// we need just camera projection matrix\n\t\t\t// world matrix must be identity\n\n\t\t\tcamera.projectionMatrix.copy( this.camera.projectionMatrix );\n\n\t\t\t// center / target\n\n\t\t\tsetPoint( \"c\", 0, 0, - 1 );\n\t\t\tsetPoint( \"t\", 0, 0,  1 );\n\n\t\t\t// near\n\n\t\t\tsetPoint( \"n1\", - w, - h, - 1 );\n\t\t\tsetPoint( \"n2\",   w, - h, - 1 );\n\t\t\tsetPoint( \"n3\", - w,   h, - 1 );\n\t\t\tsetPoint( \"n4\",   w,   h, - 1 );\n\n\t\t\t// far\n\n\t\t\tsetPoint( \"f1\", - w, - h, 1 );\n\t\t\tsetPoint( \"f2\",   w, - h, 1 );\n\t\t\tsetPoint( \"f3\", - w,   h, 1 );\n\t\t\tsetPoint( \"f4\",   w,   h, 1 );\n\n\t\t\t// up\n\n\t\t\tsetPoint( \"u1\",   w * 0.7, h * 1.1, - 1 );\n\t\t\tsetPoint( \"u2\", - w * 0.7, h * 1.1, - 1 );\n\t\t\tsetPoint( \"u3\",         0, h * 2,   - 1 );\n\n\t\t\t// cross\n\n\t\t\tsetPoint( \"cf1\", - w,   0, 1 );\n\t\t\tsetPoint( \"cf2\",   w,   0, 1 );\n\t\t\tsetPoint( \"cf3\",   0, - h, 1 );\n\t\t\tsetPoint( \"cf4\",   0,   h, 1 );\n\n\t\t\tsetPoint( \"cn1\", - w,   0, - 1 );\n\t\t\tsetPoint( \"cn2\",   w,   0, - 1 );\n\t\t\tsetPoint( \"cn3\",   0, - h, - 1 );\n\t\t\tsetPoint( \"cn4\",   0,   h, - 1 );\n\n\t\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t\t};\n\n\t}();\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction BoxHelper( object, color ) {\n\n\t\tif ( color === undefined ) color = 0xffff00;\n\n\t\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\t\tvar positions = new Float32Array( 8 * 3 );\n\n\t\tvar geometry = new BufferGeometry();\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\n\t\tgeometry.addAttribute( 'position', new BufferAttribute( positions, 3 ) );\n\n\t\tLineSegments.call( this, geometry, new LineBasicMaterial( { color: color } ) );\n\n\t\tif ( object !== undefined ) {\n\n\t\t\tthis.update( object );\n\n\t\t}\n\n\t}\n\n\tBoxHelper.prototype = Object.create( LineSegments.prototype );\n\tBoxHelper.prototype.constructor = BoxHelper;\n\n\tBoxHelper.prototype.update = ( function () {\n\n\t\tvar box = new Box3();\n\n\t\treturn function update( object ) {\n\n\t\t\tif ( object && object.isBox3 ) {\n\n\t\t\t\tbox.copy( object );\n\n\t\t\t} else {\n\n\t\t\t\tbox.setFromObject( object );\n\n\t\t\t}\n\n\t\t\tif ( box.isEmpty() ) return;\n\n\t\t\tvar min = box.min;\n\t\t\tvar max = box.max;\n\n\t\t\t/*\n\t\t\t  5____4\n\t\t\t1/___0/|\n\t\t\t| 6__|_7\n\t\t\t2/___3/\n\n\t\t\t0: max.x, max.y, max.z\n\t\t\t1: min.x, max.y, max.z\n\t\t\t2: min.x, min.y, max.z\n\t\t\t3: max.x, min.y, max.z\n\t\t\t4: max.x, max.y, min.z\n\t\t\t5: min.x, max.y, min.z\n\t\t\t6: min.x, min.y, min.z\n\t\t\t7: max.x, min.y, min.z\n\t\t\t*/\n\n\t\t\tvar position = this.geometry.attributes.position;\n\t\t\tvar array = position.array;\n\n\t\t\tarray[  0 ] = max.x; array[  1 ] = max.y; array[  2 ] = max.z;\n\t\t\tarray[  3 ] = min.x; array[  4 ] = max.y; array[  5 ] = max.z;\n\t\t\tarray[  6 ] = min.x; array[  7 ] = min.y; array[  8 ] = max.z;\n\t\t\tarray[  9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\n\t\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\n\t\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\n\t\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\n\t\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t\tthis.geometry.computeBoundingSphere();\n\n\t\t};\n\n\t} )();\n\n\t/**\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author zz85 / http://github.com/zz85\n\t * @author bhouston / http://clara.io\n\t *\n\t * Creates an arrow for visualizing directions\n\t *\n\t * Parameters:\n\t *  dir - Vector3\n\t *  origin - Vector3\n\t *  length - Number\n\t *  color - color in hex value\n\t *  headLength - Number\n\t *  headWidth - Number\n\t */\n\n\tvar lineGeometry = new BufferGeometry();\n\tlineGeometry.addAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 1, 0 ], 3 ) );\n\n\tvar coneGeometry = new CylinderBufferGeometry( 0, 0.5, 1, 5, 1 );\n\tconeGeometry.translate( 0, - 0.5, 0 );\n\n\tfunction ArrowHelper( dir, origin, length, color, headLength, headWidth ) {\n\n\t\t// dir is assumed to be normalized\n\n\t\tObject3D.call( this );\n\n\t\tif ( color === undefined ) color = 0xffff00;\n\t\tif ( length === undefined ) length = 1;\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\n\n\t\tthis.position.copy( origin );\n\n\t\tthis.line = new Line( lineGeometry, new LineBasicMaterial( { color: color } ) );\n\t\tthis.line.matrixAutoUpdate = false;\n\t\tthis.add( this.line );\n\n\t\tthis.cone = new Mesh( coneGeometry, new MeshBasicMaterial( { color: color } ) );\n\t\tthis.cone.matrixAutoUpdate = false;\n\t\tthis.add( this.cone );\n\n\t\tthis.setDirection( dir );\n\t\tthis.setLength( length, headLength, headWidth );\n\n\t}\n\n\tArrowHelper.prototype = Object.create( Object3D.prototype );\n\tArrowHelper.prototype.constructor = ArrowHelper;\n\n\tArrowHelper.prototype.setDirection = ( function () {\n\n\t\tvar axis = new Vector3();\n\t\tvar radians;\n\n\t\treturn function setDirection( dir ) {\n\n\t\t\t// dir is assumed to be normalized\n\n\t\t\tif ( dir.y > 0.99999 ) {\n\n\t\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\n\n\t\t\t} else if ( dir.y < - 0.99999 ) {\n\n\t\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\n\n\t\t\t} else {\n\n\t\t\t\taxis.set( dir.z, 0, - dir.x ).normalize();\n\n\t\t\t\tradians = Math.acos( dir.y );\n\n\t\t\t\tthis.quaternion.setFromAxisAngle( axis, radians );\n\n\t\t\t}\n\n\t\t};\n\n\t}() );\n\n\tArrowHelper.prototype.setLength = function ( length, headLength, headWidth ) {\n\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\n\n\t\tthis.line.scale.set( 1, Math.max( 0, length - headLength ), 1 );\n\t\tthis.line.updateMatrix();\n\n\t\tthis.cone.scale.set( headWidth, headLength, headWidth );\n\t\tthis.cone.position.y = length;\n\t\tthis.cone.updateMatrix();\n\n\t};\n\n\tArrowHelper.prototype.setColor = function ( color ) {\n\n\t\tthis.line.material.color.copy( color );\n\t\tthis.cone.material.color.copy( color );\n\n\t};\n\n\t/**\n\t * @author sroucheray / http://sroucheray.org/\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction AxisHelper( size ) {\n\n\t\tsize = size || 1;\n\n\t\tvar vertices = [\n\t\t\t0, 0, 0,  size, 0, 0,\n\t\t\t0, 0, 0,  0, size, 0,\n\t\t\t0, 0, 0,  0, 0, size\n\t\t];\n\n\t\tvar colors = [\n\t\t\t1, 0, 0,  1, 0.6, 0,\n\t\t\t0, 1, 0,  0.6, 1, 0,\n\t\t\t0, 0, 1,  0, 0.6, 1\n\t\t];\n\n\t\tvar geometry = new BufferGeometry();\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tvar material = new LineBasicMaterial( { vertexColors: VertexColors } );\n\n\t\tLineSegments.call( this, geometry, material );\n\n\t}\n\n\tAxisHelper.prototype = Object.create( LineSegments.prototype );\n\tAxisHelper.prototype.constructor = AxisHelper;\n\n\t/**\n\t * @author zz85 https://github.com/zz85\n\t *\n\t * Centripetal CatmullRom Curve - which is useful for avoiding\n\t * cusps and self-intersections in non-uniform catmull rom curves.\n\t * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\n\t *\n\t * curve.type accepts centripetal(default), chordal and catmullrom\n\t * curve.tension is used for catmullrom which defaults to 0.5\n\t */\n\n\n\t/*\n\tBased on an optimized c++ solution in\n\t - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\n\t - http://ideone.com/NoEbVM\n\n\tThis CubicPoly class could be used for reusing some variables and calculations,\n\tbut for three.js curve use, it could be possible inlined and flatten into a single function call\n\twhich can be placed in CurveUtils.\n\t*/\n\n\tfunction CubicPoly() {\n\n\t\tvar c0 = 0, c1 = 0, c2 = 0, c3 = 0;\n\n\t\t/*\n\t\t * Compute coefficients for a cubic polynomial\n\t\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\n\t\t * such that\n\t\t *   p(0) = x0, p(1) = x1\n\t\t *  and\n\t\t *   p'(0) = t0, p'(1) = t1.\n\t\t */\n\t\tfunction init( x0, x1, t0, t1 ) {\n\n\t\t\tc0 = x0;\n\t\t\tc1 = t0;\n\t\t\tc2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\n\t\t\tc3 = 2 * x0 - 2 * x1 + t0 + t1;\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tinitCatmullRom: function ( x0, x1, x2, x3, tension ) {\n\n\t\t\t\tinit( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\n\n\t\t\t},\n\n\t\t\tinitNonuniformCatmullRom: function ( x0, x1, x2, x3, dt0, dt1, dt2 ) {\n\n\t\t\t\t// compute tangents when parameterized in [t1,t2]\n\t\t\t\tvar t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\n\t\t\t\tvar t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\n\n\t\t\t\t// rescale tangents for parametrization in [0,1]\n\t\t\t\tt1 *= dt1;\n\t\t\t\tt2 *= dt1;\n\n\t\t\t\tinit( x1, x2, t1, t2 );\n\n\t\t\t},\n\n\t\t\tcalc: function ( t ) {\n\n\t\t\t\tvar t2 = t * t;\n\t\t\t\tvar t3 = t2 * t;\n\t\t\t\treturn c0 + c1 * t + c2 * t2 + c3 * t3;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t//\n\n\tvar tmp = new Vector3();\n\tvar px = new CubicPoly();\n\tvar py = new CubicPoly();\n\tvar pz = new CubicPoly();\n\n\tfunction CatmullRomCurve3( p /* array of Vector3 */ ) {\n\n\t\tthis.points = p || [];\n\t\tthis.closed = false;\n\n\t}\n\n\tCatmullRomCurve3.prototype = Object.create( Curve.prototype );\n\tCatmullRomCurve3.prototype.constructor = CatmullRomCurve3;\n\n\tCatmullRomCurve3.prototype.getPoint = function ( t ) {\n\n\t\tvar points = this.points;\n\t\tvar l = points.length;\n\n\t\tif ( l < 2 ) console.log( 'duh, you need at least 2 points' );\n\n\t\tvar point = ( l - ( this.closed ? 0 : 1 ) ) * t;\n\t\tvar intPoint = Math.floor( point );\n\t\tvar weight = point - intPoint;\n\n\t\tif ( this.closed ) {\n\n\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / points.length ) + 1 ) * points.length;\n\n\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\n\n\t\t\tintPoint = l - 2;\n\t\t\tweight = 1;\n\n\t\t}\n\n\t\tvar p0, p1, p2, p3; // 4 points\n\n\t\tif ( this.closed || intPoint > 0 ) {\n\n\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate first point\n\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\n\t\t\tp0 = tmp;\n\n\t\t}\n\n\t\tp1 = points[ intPoint % l ];\n\t\tp2 = points[ ( intPoint + 1 ) % l ];\n\n\t\tif ( this.closed || intPoint + 2 < l ) {\n\n\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate last point\n\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\n\t\t\tp3 = tmp;\n\n\t\t}\n\n\t\tif ( this.type === undefined || this.type === 'centripetal' || this.type === 'chordal' ) {\n\n\t\t\t// init Centripetal / Chordal Catmull-Rom\n\t\t\tvar pow = this.type === 'chordal' ? 0.5 : 0.25;\n\t\t\tvar dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\n\t\t\tvar dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\n\t\t\tvar dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\n\n\t\t\t// safety check for repeated points\n\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\n\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\n\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\n\n\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\n\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\n\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\n\n\t\t} else if ( this.type === 'catmullrom' ) {\n\n\t\t\tvar tension = this.tension !== undefined ? this.tension : 0.5;\n\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, tension );\n\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, tension );\n\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, tension );\n\n\t\t}\n\n\t\treturn new Vector3( px.calc( weight ), py.calc( weight ), pz.calc( weight ) );\n\n\t};\n\n\tfunction CubicBezierCurve3( v0, v1, v2, v3 ) {\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tCubicBezierCurve3.prototype = Object.create( Curve.prototype );\n\tCubicBezierCurve3.prototype.constructor = CubicBezierCurve3;\n\n\tCubicBezierCurve3.prototype.getPoint = function ( t ) {\n\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\treturn new Vector3(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y ),\n\t\t\tCubicBezier( t, v0.z, v1.z, v2.z, v3.z )\n\t\t);\n\n\t};\n\n\tfunction QuadraticBezierCurve3( v0, v1, v2 ) {\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tQuadraticBezierCurve3.prototype = Object.create( Curve.prototype );\n\tQuadraticBezierCurve3.prototype.constructor = QuadraticBezierCurve3;\n\n\tQuadraticBezierCurve3.prototype.getPoint = function ( t ) {\n\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\treturn new Vector3(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y ),\n\t\t\tQuadraticBezier( t, v0.z, v1.z, v2.z )\n\t\t);\n\n\t};\n\n\tfunction LineCurve3( v1, v2 ) {\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tLineCurve3.prototype = Object.create( Curve.prototype );\n\tLineCurve3.prototype.constructor = LineCurve3;\n\n\tLineCurve3.prototype.getPoint = function ( t ) {\n\n\t\tif ( t === 1 ) {\n\n\t\t\treturn this.v2.clone();\n\n\t\t}\n\n\t\tvar vector = new Vector3();\n\n\t\tvector.subVectors( this.v2, this.v1 ); // diff\n\t\tvector.multiplyScalar( t );\n\t\tvector.add( this.v1 );\n\n\t\treturn vector;\n\n\t};\n\n\tfunction ArcCurve( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tEllipseCurve.call( this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t}\n\n\tArcCurve.prototype = Object.create( EllipseCurve.prototype );\n\tArcCurve.prototype.constructor = ArcCurve;\n\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\n\tvar SceneUtils = {\n\n\t\tcreateMultiMaterialObject: function ( geometry, materials ) {\n\n\t\t\tvar group = new Group();\n\n\t\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\n\n\t\t\t\tgroup.add( new Mesh( geometry, materials[ i ] ) );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t},\n\n\t\tdetach: function ( child, parent, scene ) {\n\n\t\t\tchild.applyMatrix( parent.matrixWorld );\n\t\t\tparent.remove( child );\n\t\t\tscene.add( child );\n\n\t\t},\n\n\t\tattach: function ( child, scene, parent ) {\n\n\t\t\tvar matrixWorldInverse = new Matrix4();\n\t\t\tmatrixWorldInverse.getInverse( parent.matrixWorld );\n\t\t\tchild.applyMatrix( matrixWorldInverse );\n\n\t\t\tscene.remove( child );\n\t\t\tparent.add( child );\n\n\t\t}\n\n\t};\n\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tfunction Face4( a, b, c, d, normal, color, materialIndex ) {\n\n\t\tconsole.warn( 'THREE.Face4 has been removed. A THREE.Face3 will be created instead.' );\n\t\treturn new Face3( a, b, c, normal, color, materialIndex );\n\n\t}\n\n\tvar LineStrip = 0;\n\n\tvar LinePieces = 1;\n\n\tfunction MeshFaceMaterial( materials ) {\n\n\t\tconsole.warn( 'THREE.MeshFaceMaterial has been renamed to THREE.MultiMaterial.' );\n\t\treturn new MultiMaterial( materials );\n\n\t}\n\n\tfunction PointCloud( geometry, material ) {\n\n\t\tconsole.warn( 'THREE.PointCloud has been renamed to THREE.Points.' );\n\t\treturn new Points( geometry, material );\n\n\t}\n\n\tfunction Particle( material ) {\n\n\t\tconsole.warn( 'THREE.Particle has been renamed to THREE.Sprite.' );\n\t\treturn new Sprite( material );\n\n\t}\n\n\tfunction ParticleSystem( geometry, material ) {\n\n\t\tconsole.warn( 'THREE.ParticleSystem has been renamed to THREE.Points.' );\n\t\treturn new Points( geometry, material );\n\n\t}\n\n\tfunction PointCloudMaterial( parameters ) {\n\n\t\tconsole.warn( 'THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.' );\n\t\treturn new PointsMaterial( parameters );\n\n\t}\n\n\tfunction ParticleBasicMaterial( parameters ) {\n\n\t\tconsole.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.' );\n\t\treturn new PointsMaterial( parameters );\n\n\t}\n\n\tfunction ParticleSystemMaterial( parameters ) {\n\n\t\tconsole.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.' );\n\t\treturn new PointsMaterial( parameters );\n\n\t}\n\n\tfunction Vertex( x, y, z ) {\n\n\t\tconsole.warn( 'THREE.Vertex has been removed. Use THREE.Vector3 instead.' );\n\t\treturn new Vector3( x, y, z );\n\n\t}\n\n\t//\n\n\tfunction DynamicBufferAttribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.' );\n\t\treturn new BufferAttribute( array, itemSize ).setDynamic( true );\n\n\t}\n\n\tfunction Int8Attribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.' );\n\t\treturn new Int8BufferAttribute( array, itemSize );\n\n\t}\n\n\tfunction Uint8Attribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.' );\n\t\treturn new Uint8BufferAttribute( array, itemSize );\n\n\t}\n\n\tfunction Uint8ClampedAttribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.' );\n\t\treturn new Uint8ClampedBufferAttribute( array, itemSize );\n\n\t}\n\n\tfunction Int16Attribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.' );\n\t\treturn new Int16BufferAttribute( array, itemSize );\n\n\t}\n\n\tfunction Uint16Attribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.' );\n\t\treturn new Uint16BufferAttribute( array, itemSize );\n\n\t}\n\n\tfunction Int32Attribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.' );\n\t\treturn new Int32BufferAttribute( array, itemSize );\n\n\t}\n\n\tfunction Uint32Attribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.' );\n\t\treturn new Uint32BufferAttribute( array, itemSize );\n\n\t}\n\n\tfunction Float32Attribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.' );\n\t\treturn new Float32BufferAttribute( array, itemSize );\n\n\t}\n\n\tfunction Float64Attribute( array, itemSize ) {\n\n\t\tconsole.warn( 'THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.' );\n\t\treturn new Float64BufferAttribute( array, itemSize );\n\n\t}\n\n\t//\n\n\tCurve.create = function ( construct, getPoint ) {\n\n\t\tconsole.log( 'THREE.Curve.create() has been deprecated' );\n\n\t\tconstruct.prototype = Object.create( Curve.prototype );\n\t\tconstruct.prototype.constructor = construct;\n\t\tconstruct.prototype.getPoint = getPoint;\n\n\t\treturn construct;\n\n\t};\n\n\t//\n\n\tfunction ClosedSplineCurve3( points ) {\n\n\t\tconsole.warn( 'THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.' );\n\n\t\tCatmullRomCurve3.call( this, points );\n\t\tthis.type = 'catmullrom';\n\t\tthis.closed = true;\n\n\t}\n\n\tClosedSplineCurve3.prototype = Object.create( CatmullRomCurve3.prototype );\n\n\t//\n\n\tfunction SplineCurve3( points ) {\n\n\t\tconsole.warn( 'THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.' );\n\n\t\tCatmullRomCurve3.call( this, points );\n\t\tthis.type = 'catmullrom';\n\n\t}\n\n\tSplineCurve3.prototype = Object.create( CatmullRomCurve3.prototype );\n\n\t//\n\n\tfunction Spline( points ) {\n\n\t\tconsole.warn( 'THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.' );\n\n\t\tCatmullRomCurve3.call( this, points );\n\t\tthis.type = 'catmullrom';\n\n\t}\n\n\tSpline.prototype = Object.create( CatmullRomCurve3.prototype );\n\n\tObject.assign( Spline.prototype, {\n\n\t\tinitFromArray: function ( a ) {\n\n\t\t\tconsole.error( 'THREE.Spline: .initFromArray() has been removed.' );\n\n\t\t},\n\t\tgetControlPointsArray: function ( optionalTarget ) {\n\n\t\t\tconsole.error( 'THREE.Spline: .getControlPointsArray() has been removed.' );\n\n\t\t},\n\t\treparametrizeByArcLength: function ( samplingCoef ) {\n\n\t\t\tconsole.error( 'THREE.Spline: .reparametrizeByArcLength() has been removed.' );\n\n\t\t}\n\n\t} );\n\n\t//\n\tfunction BoundingBoxHelper( object, color ) {\n\n\t\tconsole.warn( 'THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.' );\n\t\treturn new BoxHelper( object, color );\n\n\t}\n\n\tfunction EdgesHelper( object, hex ) {\n\n\t\tconsole.warn( 'THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.' );\n\t\treturn new LineSegments( new EdgesGeometry( object.geometry ), new LineBasicMaterial( { color: hex !== undefined ? hex : 0xffffff } ) );\n\n\t}\n\n\tGridHelper.prototype.setColors = function () {\n\n\t\tconsole.error( 'THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.' );\n\n\t};\n\n\tfunction WireframeHelper( object, hex ) {\n\n\t\tconsole.warn( 'THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.' );\n\t\treturn new LineSegments( new WireframeGeometry( object.geometry ), new LineBasicMaterial( { color: hex !== undefined ? hex : 0xffffff } ) );\n\n\t}\n\n\t//\n\n\tfunction XHRLoader( manager ) {\n\n\t\tconsole.warn( 'THREE.XHRLoader has been renamed to THREE.FileLoader.' );\n\t\treturn new FileLoader( manager );\n\n\t}\n\n\tfunction BinaryTextureLoader( manager ) {\n\n\t\tconsole.warn( 'THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.' );\n\t\treturn new DataTextureLoader( manager );\n\n\t}\n\n\t//\n\n\tObject.assign( Box2.prototype, {\n\n\t\tcenter: function ( optionalTarget ) {\n\n\t\t\tconsole.warn( 'THREE.Box2: .center() has been renamed to .getCenter().' );\n\t\t\treturn this.getCenter( optionalTarget );\n\n\t\t},\n\t\tempty: function () {\n\n\t\t\tconsole.warn( 'THREE.Box2: .empty() has been renamed to .isEmpty().' );\n\t\t\treturn this.isEmpty();\n\n\t\t},\n\t\tisIntersectionBox: function ( box ) {\n\n\t\t\tconsole.warn( 'THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().' );\n\t\t\treturn this.intersectsBox( box );\n\n\t\t},\n\t\tsize: function ( optionalTarget ) {\n\n\t\t\tconsole.warn( 'THREE.Box2: .size() has been renamed to .getSize().' );\n\t\t\treturn this.getSize( optionalTarget );\n\n\t\t}\n\t} );\n\n\tObject.assign( Box3.prototype, {\n\n\t\tcenter: function ( optionalTarget ) {\n\n\t\t\tconsole.warn( 'THREE.Box3: .center() has been renamed to .getCenter().' );\n\t\t\treturn this.getCenter( optionalTarget );\n\n\t\t},\n\t\tempty: function () {\n\n\t\t\tconsole.warn( 'THREE.Box3: .empty() has been renamed to .isEmpty().' );\n\t\t\treturn this.isEmpty();\n\n\t\t},\n\t\tisIntersectionBox: function ( box ) {\n\n\t\t\tconsole.warn( 'THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().' );\n\t\t\treturn this.intersectsBox( box );\n\n\t\t},\n\t\tisIntersectionSphere: function ( sphere ) {\n\n\t\t\tconsole.warn( 'THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\n\t\t\treturn this.intersectsSphere( sphere );\n\n\t\t},\n\t\tsize: function ( optionalTarget ) {\n\n\t\t\tconsole.warn( 'THREE.Box3: .size() has been renamed to .getSize().' );\n\t\t\treturn this.getSize( optionalTarget );\n\n\t\t}\n\t} );\n\n\tLine3.prototype.center = function ( optionalTarget ) {\n\n\t\tconsole.warn( 'THREE.Line3: .center() has been renamed to .getCenter().' );\n\t\treturn this.getCenter( optionalTarget );\n\n\t};\n\n\t_Math.random16 = function () {\n\n\t\tconsole.warn( 'THREE.Math.random16() has been deprecated. Use Math.random() instead.' );\n\t\treturn Math.random();\n\n\t};\n\n\tObject.assign( Matrix3.prototype, {\n\n\t\tflattenToArrayOffset: function ( array, offset ) {\n\n\t\t\tconsole.warn( \"THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\" );\n\t\t\treturn this.toArray( array, offset );\n\n\t\t},\n\t\tmultiplyVector3: function ( vector ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\n\t\t\treturn vector.applyMatrix3( this );\n\n\t\t},\n\t\tmultiplyVector3Array: function ( a ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\n\t\t\treturn this.applyToVector3Array( a );\n\n\t\t},\n\t\tapplyToBuffer: function( buffer, offset, length ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.' );\n\t\t\treturn this.applyToBufferAttribute( buffer );\n\n\t\t},\n\t\tapplyToVector3Array: function( array, offset, length ) {\n\n\t\t\tconsole.error( 'THREE.Matrix3: .applyToVector3Array() has been removed.' );\n\n\t\t}\n\n\t} );\n\n\tObject.assign( Matrix4.prototype, {\n\n\t\textractPosition: function ( m ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\n\t\t\treturn this.copyPosition( m );\n\n\t\t},\n\t\tflattenToArrayOffset: function ( array, offset ) {\n\n\t\t\tconsole.warn( \"THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\" );\n\t\t\treturn this.toArray( array, offset );\n\n\t\t},\n\t\tgetPosition: function () {\n\n\t\t\tvar v1;\n\n\t\t\treturn function getPosition() {\n\n\t\t\t\tif ( v1 === undefined ) v1 = new Vector3();\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\n\t\t\t\treturn v1.setFromMatrixColumn( this, 3 );\n\n\t\t\t};\n\n\t\t}(),\n\t\tsetRotationFromQuaternion: function ( q ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\n\t\t\treturn this.makeRotationFromQuaternion( q );\n\n\t\t},\n\t\tmultiplyVector3: function ( vector ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\n\t\t\treturn vector.applyMatrix4( this );\n\n\t\t},\n\t\tmultiplyVector4: function ( vector ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\n\t\t\treturn vector.applyMatrix4( this );\n\n\t\t},\n\t\tmultiplyVector3Array: function ( a ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\n\t\t\treturn this.applyToVector3Array( a );\n\n\t\t},\n\t\trotateAxis: function ( v ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\n\t\t\tv.transformDirection( this );\n\n\t\t},\n\t\tcrossVector: function ( vector ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\n\t\t\treturn vector.applyMatrix4( this );\n\n\t\t},\n\t\ttranslate: function () {\n\n\t\t\tconsole.error( 'THREE.Matrix4: .translate() has been removed.' );\n\n\t\t},\n\t\trotateX: function () {\n\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateX() has been removed.' );\n\n\t\t},\n\t\trotateY: function () {\n\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateY() has been removed.' );\n\n\t\t},\n\t\trotateZ: function () {\n\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\n\n\t\t},\n\t\trotateByAxis: function () {\n\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\n\n\t\t},\n\t\tapplyToBuffer: function( buffer, offset, length ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.' );\n\t\t\treturn this.applyToBufferAttribute( buffer );\n\n\t\t},\n\t\tapplyToVector3Array: function( array, offset, length ) {\n\n\t\t\tconsole.error( 'THREE.Matrix4: .applyToVector3Array() has been removed.' );\n\n\t\t},\n\t\tmakeFrustum: function( left, right, bottom, top, near, far ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.' );\n\t\t\treturn this.makePerspective( left, right, top, bottom, near, far );\n\n\t\t}\n\n\t} );\n\n\tPlane.prototype.isIntersectionLine = function ( line ) {\n\n\t\tconsole.warn( 'THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().' );\n\t\treturn this.intersectsLine( line );\n\n\t};\n\n\tQuaternion.prototype.multiplyVector3 = function ( vector ) {\n\n\t\tconsole.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\n\t\treturn vector.applyQuaternion( this );\n\n\t};\n\n\tObject.assign( Ray.prototype, {\n\n\t\tisIntersectionBox: function ( box ) {\n\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().' );\n\t\t\treturn this.intersectsBox( box );\n\n\t\t},\n\t\tisIntersectionPlane: function ( plane ) {\n\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().' );\n\t\t\treturn this.intersectsPlane( plane );\n\n\t\t},\n\t\tisIntersectionSphere: function ( sphere ) {\n\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\n\t\t\treturn this.intersectsSphere( sphere );\n\n\t\t}\n\n\t} );\n\n\tObject.assign( Shape.prototype, {\n\n\t\textrude: function ( options ) {\n\n\t\t\tconsole.warn( 'THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.' );\n\t\t\treturn new ExtrudeGeometry( this, options );\n\n\t\t},\n\t\tmakeGeometry: function ( options ) {\n\n\t\t\tconsole.warn( 'THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.' );\n\t\t\treturn new ShapeGeometry( this, options );\n\n\t\t}\n\n\t} );\n\n\tObject.assign( Vector2.prototype, {\n\n\t\tfromAttribute: function ( attribute, index, offset ) {\n\n\t\t\tconsole.error( 'THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().' );\n\t\t\treturn this.fromBufferAttribute( attribute, index, offset );\n\n\t\t}\n\n\t} );\n\n\tObject.assign( Vector3.prototype, {\n\n\t\tsetEulerFromRotationMatrix: function () {\n\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\n\n\t\t},\n\t\tsetEulerFromQuaternion: function () {\n\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\n\n\t\t},\n\t\tgetPositionFromMatrix: function ( m ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\n\t\t\treturn this.setFromMatrixPosition( m );\n\n\t\t},\n\t\tgetScaleFromMatrix: function ( m ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\n\t\t\treturn this.setFromMatrixScale( m );\n\n\t\t},\n\t\tgetColumnFromMatrix: function ( index, matrix ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\n\t\t\treturn this.setFromMatrixColumn( matrix, index );\n\n\t\t},\n\t\tapplyProjection: function ( m ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.' );\n\t\t\treturn this.applyMatrix4( m );\n\n\t\t},\n\t\tfromAttribute: function ( attribute, index, offset ) {\n\n\t\t\tconsole.error( 'THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().' );\n\t\t\treturn this.fromBufferAttribute( attribute, index, offset );\n\n\t\t}\n\n\t} );\n\n\tObject.assign( Vector4.prototype, {\n\n\t\tfromAttribute: function ( attribute, index, offset ) {\n\n\t\t\tconsole.error( 'THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().' );\n\t\t\treturn this.fromBufferAttribute( attribute, index, offset );\n\n\t\t}\n\n\t} );\n\n\t//\n\n\tGeometry.prototype.computeTangents = function () {\n\n\t\tconsole.warn( 'THREE.Geometry: .computeTangents() has been removed.' );\n\n\t};\n\n\tObject.assign( Object3D.prototype, {\n\n\t\tgetChildByName: function ( name ) {\n\n\t\t\tconsole.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\n\t\t\treturn this.getObjectByName( name );\n\n\t\t},\n\t\trenderDepth: function () {\n\n\t\t\tconsole.warn( 'THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.' );\n\n\t\t},\n\t\ttranslate: function ( distance, axis ) {\n\n\t\t\tconsole.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\n\t\t\treturn this.translateOnAxis( axis, distance );\n\n\t\t}\n\n\t} );\n\n\tObject.defineProperties( Object3D.prototype, {\n\n\t\teulerOrder: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\n\t\t\t\treturn this.rotation.order;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\n\t\t\t\tthis.rotation.order = value;\n\n\t\t\t}\n\t\t},\n\t\tuseQuaternion: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\n\n\t\t\t},\n\t\t\tset: function () {\n\n\t\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\tObject.defineProperties( LOD.prototype, {\n\n\t\tobjects: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.LOD: .objects has been renamed to .levels.' );\n\t\t\t\treturn this.levels;\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\t//\n\n\tPerspectiveCamera.prototype.setLens = function ( focalLength, filmGauge ) {\n\n\t\tconsole.warn( \"THREE.PerspectiveCamera.setLens is deprecated. \" +\n\t\t\t\t\"Use .setFocalLength and .filmGauge for a photographic setup.\" );\n\n\t\tif ( filmGauge !== undefined ) this.filmGauge = filmGauge;\n\t\tthis.setFocalLength( focalLength );\n\n\t};\n\n\t//\n\n\tObject.defineProperties( Light.prototype, {\n\t\tonlyShadow: {\n\t\t\tset: function () {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .onlyShadow has been removed.' );\n\n\t\t\t}\n\t\t},\n\t\tshadowCameraFov: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFov is now .shadow.camera.fov.' );\n\t\t\t\tthis.shadow.camera.fov = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowCameraLeft: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraLeft is now .shadow.camera.left.' );\n\t\t\t\tthis.shadow.camera.left = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowCameraRight: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraRight is now .shadow.camera.right.' );\n\t\t\t\tthis.shadow.camera.right = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowCameraTop: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraTop is now .shadow.camera.top.' );\n\t\t\t\tthis.shadow.camera.top = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowCameraBottom: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.' );\n\t\t\t\tthis.shadow.camera.bottom = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowCameraNear: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraNear is now .shadow.camera.near.' );\n\t\t\t\tthis.shadow.camera.near = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowCameraFar: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFar is now .shadow.camera.far.' );\n\t\t\t\tthis.shadow.camera.far = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowCameraVisible: {\n\t\t\tset: function () {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.' );\n\n\t\t\t}\n\t\t},\n\t\tshadowBias: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowBias is now .shadow.bias.' );\n\t\t\t\tthis.shadow.bias = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowDarkness: {\n\t\t\tset: function () {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowDarkness has been removed.' );\n\n\t\t\t}\n\t\t},\n\t\tshadowMapWidth: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.' );\n\t\t\t\tthis.shadow.mapSize.width = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowMapHeight: {\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.' );\n\t\t\t\tthis.shadow.mapSize.height = value;\n\n\t\t\t}\n\t\t}\n\t} );\n\n\t//\n\n\tObject.defineProperties( BufferAttribute.prototype, {\n\n\t\tlength: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Use .count instead.' );\n\t\t\t\treturn this.array.length;\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\tObject.assign( BufferGeometry.prototype, {\n\n\t\taddIndex: function ( index ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().' );\n\t\t\tthis.setIndex( index );\n\n\t\t},\n\t\taddDrawCall: function ( start, count, indexOffset ) {\n\n\t\t\tif ( indexOffset !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.' );\n\n\t\t\t}\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() is now .addGroup().' );\n\t\t\tthis.addGroup( start, count );\n\n\t\t},\n\t\tclearDrawCalls: function () {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().' );\n\t\t\tthis.clearGroups();\n\n\t\t},\n\t\tcomputeTangents: function () {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeTangents() has been removed.' );\n\n\t\t},\n\t\tcomputeOffsets: function () {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeOffsets() has been removed.' );\n\n\t\t}\n\n\t} );\n\n\tObject.defineProperties( BufferGeometry.prototype, {\n\n\t\tdrawcalls: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry: .drawcalls has been renamed to .groups.' );\n\t\t\t\treturn this.groups;\n\n\t\t\t}\n\t\t},\n\t\toffsets: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .offsets has been renamed to .groups.' );\n\t\t\t\treturn this.groups;\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\t//\n\n\tObject.defineProperties( Uniform.prototype, {\n\n\t\tdynamic: {\n\t\t\tset: function () {\n\n\t\t\t\tconsole.warn( 'THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.' );\n\n\t\t\t}\n\t\t},\n\t\tonUpdate: {\n\t\t\tvalue: function () {\n\n\t\t\t\tconsole.warn( 'THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.' );\n\t\t\t\treturn this;\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\t//\n\n\tObject.defineProperties( Material.prototype, {\n\n\t\twrapAround: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\n\n\t\t\t},\n\t\t\tset: function () {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\n\n\t\t\t}\n\t\t},\n\t\twrapRGB: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapRGB has been removed.' );\n\t\t\t\treturn new Color();\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\tObject.defineProperties( MeshPhongMaterial.prototype, {\n\n\t\tmetal: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.' );\n\t\t\t\treturn false;\n\n\t\t\t},\n\t\t\tset: function () {\n\n\t\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead' );\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\tObject.defineProperties( ShaderMaterial.prototype, {\n\n\t\tderivatives: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\n\t\t\t\treturn this.extensions.derivatives;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\n\t\t\t\tthis.extensions.derivatives = value;\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\t//\n\n\tObject.assign( WebGLRenderer.prototype, {\n\n\t\tsupportsFloatTextures: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).' );\n\t\t\treturn this.extensions.get( 'OES_texture_float' );\n\n\t\t},\n\t\tsupportsHalfFloatTextures: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).' );\n\t\t\treturn this.extensions.get( 'OES_texture_half_float' );\n\n\t\t},\n\t\tsupportsStandardDerivatives: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).' );\n\t\t\treturn this.extensions.get( 'OES_standard_derivatives' );\n\n\t\t},\n\t\tsupportsCompressedTextureS3TC: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).' );\n\t\t\treturn this.extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n\t\t},\n\t\tsupportsCompressedTexturePVRTC: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).' );\n\t\t\treturn this.extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n\t\t},\n\t\tsupportsBlendMinMax: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).' );\n\t\t\treturn this.extensions.get( 'EXT_blend_minmax' );\n\n\t\t},\n\t\tsupportsVertexTextures: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.' );\n\t\t\treturn this.capabilities.vertexTextures;\n\n\t\t},\n\t\tsupportsInstancedArrays: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).' );\n\t\t\treturn this.extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\t},\n\t\tenableScissorTest: function ( boolean ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().' );\n\t\t\tthis.setScissorTest( boolean );\n\n\t\t},\n\t\tinitMaterial: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\n\n\t\t},\n\t\taddPrePlugin: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\n\n\t\t},\n\t\taddPostPlugin: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\n\n\t\t},\n\t\tupdateShadowMap: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\n\n\t\t}\n\n\t} );\n\n\tObject.defineProperties( WebGLRenderer.prototype, {\n\n\t\tshadowMapEnabled: {\n\t\t\tget: function () {\n\n\t\t\t\treturn this.shadowMap.enabled;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.' );\n\t\t\t\tthis.shadowMap.enabled = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowMapType: {\n\t\t\tget: function () {\n\n\t\t\t\treturn this.shadowMap.type;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.' );\n\t\t\t\tthis.shadowMap.type = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowMapCullFace: {\n\t\t\tget: function () {\n\n\t\t\t\treturn this.shadowMap.cullFace;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.' );\n\t\t\t\tthis.shadowMap.cullFace = value;\n\n\t\t\t}\n\t\t}\n\t} );\n\n\tObject.defineProperties( WebGLShadowMap.prototype, {\n\n\t\tcullFace: {\n\t\t\tget: function () {\n\n\t\t\t\treturn this.renderReverseSided ? CullFaceFront : CullFaceBack;\n\n\t\t\t},\n\t\t\tset: function ( cullFace ) {\n\n\t\t\t\tvar value = ( cullFace !== CullFaceBack );\n\t\t\t\tconsole.warn( \"WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to \" + value + \".\" );\n\t\t\t\tthis.renderReverseSided = value;\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\t//\n\n\tObject.defineProperties( WebGLRenderTarget.prototype, {\n\n\t\twrapS: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\n\t\t\t\treturn this.texture.wrapS;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\n\t\t\t\tthis.texture.wrapS = value;\n\n\t\t\t}\n\t\t},\n\t\twrapT: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\n\t\t\t\treturn this.texture.wrapT;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\n\t\t\t\tthis.texture.wrapT = value;\n\n\t\t\t}\n\t\t},\n\t\tmagFilter: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\n\t\t\t\treturn this.texture.magFilter;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\n\t\t\t\tthis.texture.magFilter = value;\n\n\t\t\t}\n\t\t},\n\t\tminFilter: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\n\t\t\t\treturn this.texture.minFilter;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\n\t\t\t\tthis.texture.minFilter = value;\n\n\t\t\t}\n\t\t},\n\t\tanisotropy: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\n\t\t\t\treturn this.texture.anisotropy;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\n\t\t\t\tthis.texture.anisotropy = value;\n\n\t\t\t}\n\t\t},\n\t\toffset: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\n\t\t\t\treturn this.texture.offset;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\n\t\t\t\tthis.texture.offset = value;\n\n\t\t\t}\n\t\t},\n\t\trepeat: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\n\t\t\t\treturn this.texture.repeat;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\n\t\t\t\tthis.texture.repeat = value;\n\n\t\t\t}\n\t\t},\n\t\tformat: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\n\t\t\t\treturn this.texture.format;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\n\t\t\t\tthis.texture.format = value;\n\n\t\t\t}\n\t\t},\n\t\ttype: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\n\t\t\t\treturn this.texture.type;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\n\t\t\t\tthis.texture.type = value;\n\n\t\t\t}\n\t\t},\n\t\tgenerateMipmaps: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\n\t\t\t\treturn this.texture.generateMipmaps;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\n\t\t\t\tthis.texture.generateMipmaps = value;\n\n\t\t\t}\n\t\t}\n\n\t} );\n\n\t//\n\n\tAudio.prototype.load = function ( file ) {\n\n\t\tconsole.warn( 'THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.' );\n\t\tvar scope = this;\n\t\tvar audioLoader = new AudioLoader();\n\t\taudioLoader.load( file, function ( buffer ) {\n\n\t\t\tscope.setBuffer( buffer );\n\n\t\t} );\n\t\treturn this;\n\n\t};\n\n\tAudioAnalyser.prototype.getData = function () {\n\n\t\tconsole.warn( 'THREE.AudioAnalyser: .getData() is now .getFrequencyData().' );\n\t\treturn this.getFrequencyData();\n\n\t};\n\n\t//\n\n\tvar GeometryUtils = {\n\n\t\tmerge: function ( geometry1, geometry2, materialIndexOffset ) {\n\n\t\t\tconsole.warn( 'THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.' );\n\t\t\tvar matrix;\n\n\t\t\tif ( geometry2.isMesh ) {\n\n\t\t\t\tgeometry2.matrixAutoUpdate && geometry2.updateMatrix();\n\n\t\t\t\tmatrix = geometry2.matrix;\n\t\t\t\tgeometry2 = geometry2.geometry;\n\n\t\t\t}\n\n\t\t\tgeometry1.merge( geometry2, matrix, materialIndexOffset );\n\n\t\t},\n\n\t\tcenter: function ( geometry ) {\n\n\t\t\tconsole.warn( 'THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.' );\n\t\t\treturn geometry.center();\n\n\t\t}\n\n\t};\n\n\tvar ImageUtils = {\n\n\t\tcrossOrigin: undefined,\n\n\t\tloadTexture: function ( url, mapping, onLoad, onError ) {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.' );\n\n\t\t\tvar loader = new TextureLoader();\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tvar texture = loader.load( url, onLoad, undefined, onError );\n\n\t\t\tif ( mapping ) texture.mapping = mapping;\n\n\t\t\treturn texture;\n\n\t\t},\n\n\t\tloadTextureCube: function ( urls, mapping, onLoad, onError ) {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.' );\n\n\t\t\tvar loader = new CubeTextureLoader();\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tvar texture = loader.load( urls, onLoad, undefined, onError );\n\n\t\t\tif ( mapping ) texture.mapping = mapping;\n\n\t\t\treturn texture;\n\n\t\t},\n\n\t\tloadCompressedTexture: function () {\n\n\t\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' );\n\n\t\t},\n\n\t\tloadCompressedTextureCube: function () {\n\n\t\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' );\n\n\t\t}\n\n\t};\n\n\tfunction Projector() {\n\n\t\tconsole.error( 'THREE.Projector has been moved to /examples/js/renderers/Projector.js.' );\n\n\t\tthis.projectVector = function ( vector, camera ) {\n\n\t\t\tconsole.warn( 'THREE.Projector: .projectVector() is now vector.project().' );\n\t\t\tvector.project( camera );\n\n\t\t};\n\n\t\tthis.unprojectVector = function ( vector, camera ) {\n\n\t\t\tconsole.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );\n\t\t\tvector.unproject( camera );\n\n\t\t};\n\n\t\tthis.pickingRay = function () {\n\n\t\t\tconsole.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );\n\n\t\t};\n\n\t}\n\n\t//\n\n\tfunction CanvasRenderer() {\n\n\t\tconsole.error( 'THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js' );\n\n\t\tthis.domElement = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\n\t\tthis.clear = function () {};\n\t\tthis.render = function () {};\n\t\tthis.setClearColor = function () {};\n\t\tthis.setSize = function () {};\n\n\t}\n\n\texports.WebGLRenderTargetCube = WebGLRenderTargetCube;\n\texports.WebGLRenderTarget = WebGLRenderTarget;\n\texports.WebGLRenderer = WebGLRenderer;\n\texports.ShaderLib = ShaderLib;\n\texports.UniformsLib = UniformsLib;\n\texports.UniformsUtils = UniformsUtils;\n\texports.ShaderChunk = ShaderChunk;\n\texports.FogExp2 = FogExp2;\n\texports.Fog = Fog;\n\texports.Scene = Scene;\n\texports.LensFlare = LensFlare;\n\texports.Sprite = Sprite;\n\texports.LOD = LOD;\n\texports.SkinnedMesh = SkinnedMesh;\n\texports.Skeleton = Skeleton;\n\texports.Bone = Bone;\n\texports.Mesh = Mesh;\n\texports.LineSegments = LineSegments;\n\texports.Line = Line;\n\texports.Points = Points;\n\texports.Group = Group;\n\texports.VideoTexture = VideoTexture;\n\texports.DataTexture = DataTexture;\n\texports.CompressedTexture = CompressedTexture;\n\texports.CubeTexture = CubeTexture;\n\texports.CanvasTexture = CanvasTexture;\n\texports.DepthTexture = DepthTexture;\n\texports.Texture = Texture;\n\texports.CompressedTextureLoader = CompressedTextureLoader;\n\texports.DataTextureLoader = DataTextureLoader;\n\texports.CubeTextureLoader = CubeTextureLoader;\n\texports.TextureLoader = TextureLoader;\n\texports.ObjectLoader = ObjectLoader;\n\texports.MaterialLoader = MaterialLoader;\n\texports.BufferGeometryLoader = BufferGeometryLoader;\n\texports.DefaultLoadingManager = DefaultLoadingManager;\n\texports.LoadingManager = LoadingManager;\n\texports.JSONLoader = JSONLoader;\n\texports.ImageLoader = ImageLoader;\n\texports.FontLoader = FontLoader;\n\texports.FileLoader = FileLoader;\n\texports.Loader = Loader;\n\texports.Cache = Cache;\n\texports.AudioLoader = AudioLoader;\n\texports.SpotLightShadow = SpotLightShadow;\n\texports.SpotLight = SpotLight;\n\texports.PointLight = PointLight;\n\texports.RectAreaLight = RectAreaLight;\n\texports.HemisphereLight = HemisphereLight;\n\texports.DirectionalLightShadow = DirectionalLightShadow;\n\texports.DirectionalLight = DirectionalLight;\n\texports.AmbientLight = AmbientLight;\n\texports.LightShadow = LightShadow;\n\texports.Light = Light;\n\texports.StereoCamera = StereoCamera;\n\texports.PerspectiveCamera = PerspectiveCamera;\n\texports.OrthographicCamera = OrthographicCamera;\n\texports.CubeCamera = CubeCamera;\n\texports.Camera = Camera;\n\texports.AudioListener = AudioListener;\n\texports.PositionalAudio = PositionalAudio;\n\texports.AudioContext = AudioContext;\n\texports.AudioAnalyser = AudioAnalyser;\n\texports.Audio = Audio;\n\texports.VectorKeyframeTrack = VectorKeyframeTrack;\n\texports.StringKeyframeTrack = StringKeyframeTrack;\n\texports.QuaternionKeyframeTrack = QuaternionKeyframeTrack;\n\texports.NumberKeyframeTrack = NumberKeyframeTrack;\n\texports.ColorKeyframeTrack = ColorKeyframeTrack;\n\texports.BooleanKeyframeTrack = BooleanKeyframeTrack;\n\texports.PropertyMixer = PropertyMixer;\n\texports.PropertyBinding = PropertyBinding;\n\texports.KeyframeTrack = KeyframeTrack;\n\texports.AnimationUtils = AnimationUtils;\n\texports.AnimationObjectGroup = AnimationObjectGroup;\n\texports.AnimationMixer = AnimationMixer;\n\texports.AnimationClip = AnimationClip;\n\texports.Uniform = Uniform;\n\texports.InstancedBufferGeometry = InstancedBufferGeometry;\n\texports.BufferGeometry = BufferGeometry;\n\texports.GeometryIdCount = GeometryIdCount;\n\texports.Geometry = Geometry;\n\texports.InterleavedBufferAttribute = InterleavedBufferAttribute;\n\texports.InstancedInterleavedBuffer = InstancedInterleavedBuffer;\n\texports.InterleavedBuffer = InterleavedBuffer;\n\texports.InstancedBufferAttribute = InstancedBufferAttribute;\n\texports.Face3 = Face3;\n\texports.Object3D = Object3D;\n\texports.Raycaster = Raycaster;\n\texports.Layers = Layers;\n\texports.EventDispatcher = EventDispatcher;\n\texports.Clock = Clock;\n\texports.QuaternionLinearInterpolant = QuaternionLinearInterpolant;\n\texports.LinearInterpolant = LinearInterpolant;\n\texports.DiscreteInterpolant = DiscreteInterpolant;\n\texports.CubicInterpolant = CubicInterpolant;\n\texports.Interpolant = Interpolant;\n\texports.Triangle = Triangle;\n\texports.Math = _Math;\n\texports.Spherical = Spherical;\n\texports.Cylindrical = Cylindrical;\n\texports.Plane = Plane;\n\texports.Frustum = Frustum;\n\texports.Sphere = Sphere;\n\texports.Ray = Ray;\n\texports.Matrix4 = Matrix4;\n\texports.Matrix3 = Matrix3;\n\texports.Box3 = Box3;\n\texports.Box2 = Box2;\n\texports.Line3 = Line3;\n\texports.Euler = Euler;\n\texports.Vector4 = Vector4;\n\texports.Vector3 = Vector3;\n\texports.Vector2 = Vector2;\n\texports.Quaternion = Quaternion;\n\texports.Color = Color;\n\texports.MorphBlendMesh = MorphBlendMesh;\n\texports.ImmediateRenderObject = ImmediateRenderObject;\n\texports.VertexNormalsHelper = VertexNormalsHelper;\n\texports.SpotLightHelper = SpotLightHelper;\n\texports.SkeletonHelper = SkeletonHelper;\n\texports.PointLightHelper = PointLightHelper;\n\texports.RectAreaLightHelper = RectAreaLightHelper;\n\texports.HemisphereLightHelper = HemisphereLightHelper;\n\texports.GridHelper = GridHelper;\n\texports.PolarGridHelper = PolarGridHelper;\n\texports.FaceNormalsHelper = FaceNormalsHelper;\n\texports.DirectionalLightHelper = DirectionalLightHelper;\n\texports.CameraHelper = CameraHelper;\n\texports.BoxHelper = BoxHelper;\n\texports.ArrowHelper = ArrowHelper;\n\texports.AxisHelper = AxisHelper;\n\texports.CatmullRomCurve3 = CatmullRomCurve3;\n\texports.CubicBezierCurve3 = CubicBezierCurve3;\n\texports.QuadraticBezierCurve3 = QuadraticBezierCurve3;\n\texports.LineCurve3 = LineCurve3;\n\texports.ArcCurve = ArcCurve;\n\texports.EllipseCurve = EllipseCurve;\n\texports.SplineCurve = SplineCurve;\n\texports.CubicBezierCurve = CubicBezierCurve;\n\texports.QuadraticBezierCurve = QuadraticBezierCurve;\n\texports.LineCurve = LineCurve;\n\texports.Shape = Shape;\n\texports.Path = Path;\n\texports.ShapePath = ShapePath;\n\texports.Font = Font;\n\texports.CurvePath = CurvePath;\n\texports.Curve = Curve;\n\texports.ShapeUtils = ShapeUtils;\n\texports.SceneUtils = SceneUtils;\n\texports.WireframeGeometry = WireframeGeometry;\n\texports.ParametricGeometry = ParametricGeometry;\n\texports.ParametricBufferGeometry = ParametricBufferGeometry;\n\texports.TetrahedronGeometry = TetrahedronGeometry;\n\texports.TetrahedronBufferGeometry = TetrahedronBufferGeometry;\n\texports.OctahedronGeometry = OctahedronGeometry;\n\texports.OctahedronBufferGeometry = OctahedronBufferGeometry;\n\texports.IcosahedronGeometry = IcosahedronGeometry;\n\texports.IcosahedronBufferGeometry = IcosahedronBufferGeometry;\n\texports.DodecahedronGeometry = DodecahedronGeometry;\n\texports.DodecahedronBufferGeometry = DodecahedronBufferGeometry;\n\texports.PolyhedronGeometry = PolyhedronGeometry;\n\texports.PolyhedronBufferGeometry = PolyhedronBufferGeometry;\n\texports.TubeGeometry = TubeGeometry;\n\texports.TubeBufferGeometry = TubeBufferGeometry;\n\texports.TorusKnotGeometry = TorusKnotGeometry;\n\texports.TorusKnotBufferGeometry = TorusKnotBufferGeometry;\n\texports.TorusGeometry = TorusGeometry;\n\texports.TorusBufferGeometry = TorusBufferGeometry;\n\texports.TextGeometry = TextGeometry;\n\texports.SphereBufferGeometry = SphereBufferGeometry;\n\texports.SphereGeometry = SphereGeometry;\n\texports.RingGeometry = RingGeometry;\n\texports.RingBufferGeometry = RingBufferGeometry;\n\texports.PlaneBufferGeometry = PlaneBufferGeometry;\n\texports.PlaneGeometry = PlaneGeometry;\n\texports.LatheGeometry = LatheGeometry;\n\texports.LatheBufferGeometry = LatheBufferGeometry;\n\texports.ShapeGeometry = ShapeGeometry;\n\texports.ShapeBufferGeometry = ShapeBufferGeometry;\n\texports.ExtrudeGeometry = ExtrudeGeometry;\n\texports.EdgesGeometry = EdgesGeometry;\n\texports.ConeGeometry = ConeGeometry;\n\texports.ConeBufferGeometry = ConeBufferGeometry;\n\texports.CylinderGeometry = CylinderGeometry;\n\texports.CylinderBufferGeometry = CylinderBufferGeometry;\n\texports.CircleBufferGeometry = CircleBufferGeometry;\n\texports.CircleGeometry = CircleGeometry;\n\texports.BoxBufferGeometry = BoxBufferGeometry;\n\texports.BoxGeometry = BoxGeometry;\n\texports.ShadowMaterial = ShadowMaterial;\n\texports.SpriteMaterial = SpriteMaterial;\n\texports.RawShaderMaterial = RawShaderMaterial;\n\texports.ShaderMaterial = ShaderMaterial;\n\texports.PointsMaterial = PointsMaterial;\n\texports.MultiMaterial = MultiMaterial;\n\texports.MeshPhysicalMaterial = MeshPhysicalMaterial;\n\texports.MeshStandardMaterial = MeshStandardMaterial;\n\texports.MeshPhongMaterial = MeshPhongMaterial;\n\texports.MeshToonMaterial = MeshToonMaterial;\n\texports.MeshNormalMaterial = MeshNormalMaterial;\n\texports.MeshLambertMaterial = MeshLambertMaterial;\n\texports.MeshDepthMaterial = MeshDepthMaterial;\n\texports.MeshBasicMaterial = MeshBasicMaterial;\n\texports.MeshCubeMaterial = MeshCubeMaterial;\n\texports.LineDashedMaterial = LineDashedMaterial;\n\texports.LineBasicMaterial = LineBasicMaterial;\n\texports.MaterialMap = MaterialMap;\n\texports.Material = Material;\n\texports.Float64BufferAttribute = Float64BufferAttribute;\n\texports.Float32BufferAttribute = Float32BufferAttribute;\n\texports.Uint32BufferAttribute = Uint32BufferAttribute;\n\texports.Int32BufferAttribute = Int32BufferAttribute;\n\texports.Uint16BufferAttribute = Uint16BufferAttribute;\n\texports.Int16BufferAttribute = Int16BufferAttribute;\n\texports.Uint8ClampedBufferAttribute = Uint8ClampedBufferAttribute;\n\texports.Uint8BufferAttribute = Uint8BufferAttribute;\n\texports.Int8BufferAttribute = Int8BufferAttribute;\n\texports.BufferAttribute = BufferAttribute;\n\texports.REVISION = REVISION;\n\texports.MOUSE = MOUSE;\n\texports.CullFaceNone = CullFaceNone;\n\texports.CullFaceBack = CullFaceBack;\n\texports.CullFaceFront = CullFaceFront;\n\texports.CullFaceFrontBack = CullFaceFrontBack;\n\texports.FrontFaceDirectionCW = FrontFaceDirectionCW;\n\texports.FrontFaceDirectionCCW = FrontFaceDirectionCCW;\n\texports.BasicShadowMap = BasicShadowMap;\n\texports.PCFShadowMap = PCFShadowMap;\n\texports.PCFSoftShadowMap = PCFSoftShadowMap;\n\texports.PCSSSoftShadowMap = PCSSSoftShadowMap;\n\texports.FrontSide = FrontSide;\n\texports.BackSide = BackSide;\n\texports.DoubleSide = DoubleSide;\n\texports.FlatShading = FlatShading;\n\texports.SmoothShading = SmoothShading;\n\texports.NoColors = NoColors;\n\texports.FaceColors = FaceColors;\n\texports.VertexColors = VertexColors;\n\texports.NoBlending = NoBlending;\n\texports.NormalBlending = NormalBlending;\n\texports.AdditiveBlending = AdditiveBlending;\n\texports.SubtractiveBlending = SubtractiveBlending;\n\texports.MultiplyBlending = MultiplyBlending;\n\texports.CustomBlending = CustomBlending;\n\texports.AddEquation = AddEquation;\n\texports.SubtractEquation = SubtractEquation;\n\texports.ReverseSubtractEquation = ReverseSubtractEquation;\n\texports.MinEquation = MinEquation;\n\texports.MaxEquation = MaxEquation;\n\texports.ZeroFactor = ZeroFactor;\n\texports.OneFactor = OneFactor;\n\texports.SrcColorFactor = SrcColorFactor;\n\texports.OneMinusSrcColorFactor = OneMinusSrcColorFactor;\n\texports.SrcAlphaFactor = SrcAlphaFactor;\n\texports.OneMinusSrcAlphaFactor = OneMinusSrcAlphaFactor;\n\texports.DstAlphaFactor = DstAlphaFactor;\n\texports.OneMinusDstAlphaFactor = OneMinusDstAlphaFactor;\n\texports.DstColorFactor = DstColorFactor;\n\texports.OneMinusDstColorFactor = OneMinusDstColorFactor;\n\texports.SrcAlphaSaturateFactor = SrcAlphaSaturateFactor;\n\texports.NeverDepth = NeverDepth;\n\texports.AlwaysDepth = AlwaysDepth;\n\texports.LessDepth = LessDepth;\n\texports.LessEqualDepth = LessEqualDepth;\n\texports.EqualDepth = EqualDepth;\n\texports.GreaterEqualDepth = GreaterEqualDepth;\n\texports.GreaterDepth = GreaterDepth;\n\texports.NotEqualDepth = NotEqualDepth;\n\texports.MultiplyOperation = MultiplyOperation;\n\texports.MixOperation = MixOperation;\n\texports.AddOperation = AddOperation;\n\texports.NoToneMapping = NoToneMapping;\n\texports.LinearToneMapping = LinearToneMapping;\n\texports.ReinhardToneMapping = ReinhardToneMapping;\n\texports.Uncharted2ToneMapping = Uncharted2ToneMapping;\n\texports.CineonToneMapping = CineonToneMapping;\n\texports.UVMapping = UVMapping;\n\texports.CubeReflectionMapping = CubeReflectionMapping;\n\texports.CubeRefractionMapping = CubeRefractionMapping;\n\texports.EquirectangularReflectionMapping = EquirectangularReflectionMapping;\n\texports.EquirectangularRefractionMapping = EquirectangularRefractionMapping;\n\texports.SphericalReflectionMapping = SphericalReflectionMapping;\n\texports.CubeUVReflectionMapping = CubeUVReflectionMapping;\n\texports.CubeUVRefractionMapping = CubeUVRefractionMapping;\n\texports.RepeatWrapping = RepeatWrapping;\n\texports.ClampToEdgeWrapping = ClampToEdgeWrapping;\n\texports.MirroredRepeatWrapping = MirroredRepeatWrapping;\n\texports.NearestFilter = NearestFilter;\n\texports.NearestMipMapNearestFilter = NearestMipMapNearestFilter;\n\texports.NearestMipMapLinearFilter = NearestMipMapLinearFilter;\n\texports.LinearFilter = LinearFilter;\n\texports.LinearMipMapNearestFilter = LinearMipMapNearestFilter;\n\texports.LinearMipMapLinearFilter = LinearMipMapLinearFilter;\n\texports.UnsignedByteType = UnsignedByteType;\n\texports.ByteType = ByteType;\n\texports.ShortType = ShortType;\n\texports.UnsignedShortType = UnsignedShortType;\n\texports.IntType = IntType;\n\texports.UnsignedIntType = UnsignedIntType;\n\texports.FloatType = FloatType;\n\texports.HalfFloatType = HalfFloatType;\n\texports.UnsignedShort4444Type = UnsignedShort4444Type;\n\texports.UnsignedShort5551Type = UnsignedShort5551Type;\n\texports.UnsignedShort565Type = UnsignedShort565Type;\n\texports.UnsignedInt248Type = UnsignedInt248Type;\n\texports.AlphaFormat = AlphaFormat;\n\texports.RGBFormat = RGBFormat;\n\texports.RGBAFormat = RGBAFormat;\n\texports.LuminanceFormat = LuminanceFormat;\n\texports.LuminanceAlphaFormat = LuminanceAlphaFormat;\n\texports.RGBEFormat = RGBEFormat;\n\texports.DepthFormat = DepthFormat;\n\texports.DepthStencilFormat = DepthStencilFormat;\n\texports.RGB_S3TC_DXT1_Format = RGB_S3TC_DXT1_Format;\n\texports.RGBA_S3TC_DXT1_Format = RGBA_S3TC_DXT1_Format;\n\texports.RGBA_S3TC_DXT3_Format = RGBA_S3TC_DXT3_Format;\n\texports.RGBA_S3TC_DXT5_Format = RGBA_S3TC_DXT5_Format;\n\texports.RGB_PVRTC_4BPPV1_Format = RGB_PVRTC_4BPPV1_Format;\n\texports.RGB_PVRTC_2BPPV1_Format = RGB_PVRTC_2BPPV1_Format;\n\texports.RGBA_PVRTC_4BPPV1_Format = RGBA_PVRTC_4BPPV1_Format;\n\texports.RGBA_PVRTC_2BPPV1_Format = RGBA_PVRTC_2BPPV1_Format;\n\texports.RGB_ETC1_Format = RGB_ETC1_Format;\n\texports.LoopOnce = LoopOnce;\n\texports.LoopRepeat = LoopRepeat;\n\texports.LoopPingPong = LoopPingPong;\n\texports.InterpolateDiscrete = InterpolateDiscrete;\n\texports.InterpolateLinear = InterpolateLinear;\n\texports.InterpolateSmooth = InterpolateSmooth;\n\texports.ZeroCurvatureEnding = ZeroCurvatureEnding;\n\texports.ZeroSlopeEnding = ZeroSlopeEnding;\n\texports.WrapAroundEnding = WrapAroundEnding;\n\texports.TrianglesDrawMode = TrianglesDrawMode;\n\texports.TriangleStripDrawMode = TriangleStripDrawMode;\n\texports.TriangleFanDrawMode = TriangleFanDrawMode;\n\texports.LinearEncoding = LinearEncoding;\n\texports.sRGBEncoding = sRGBEncoding;\n\texports.GammaEncoding = GammaEncoding;\n\texports.RGBEEncoding = RGBEEncoding;\n\texports.LogLuvEncoding = LogLuvEncoding;\n\texports.RGBM7Encoding = RGBM7Encoding;\n\texports.RGBM16Encoding = RGBM16Encoding;\n\texports.RGBDEncoding = RGBDEncoding;\n\texports.BasicDepthPacking = BasicDepthPacking;\n\texports.RGBADepthPacking = RGBADepthPacking;\n\texports.CubeGeometry = BoxGeometry;\n\texports.Face4 = Face4;\n\texports.LineStrip = LineStrip;\n\texports.LinePieces = LinePieces;\n\texports.MeshFaceMaterial = MeshFaceMaterial;\n\texports.PointCloud = PointCloud;\n\texports.Particle = Particle;\n\texports.ParticleSystem = ParticleSystem;\n\texports.PointCloudMaterial = PointCloudMaterial;\n\texports.ParticleBasicMaterial = ParticleBasicMaterial;\n\texports.ParticleSystemMaterial = ParticleSystemMaterial;\n\texports.Vertex = Vertex;\n\texports.DynamicBufferAttribute = DynamicBufferAttribute;\n\texports.Int8Attribute = Int8Attribute;\n\texports.Uint8Attribute = Uint8Attribute;\n\texports.Uint8ClampedAttribute = Uint8ClampedAttribute;\n\texports.Int16Attribute = Int16Attribute;\n\texports.Uint16Attribute = Uint16Attribute;\n\texports.Int32Attribute = Int32Attribute;\n\texports.Uint32Attribute = Uint32Attribute;\n\texports.Float32Attribute = Float32Attribute;\n\texports.Float64Attribute = Float64Attribute;\n\texports.ClosedSplineCurve3 = ClosedSplineCurve3;\n\texports.SplineCurve3 = SplineCurve3;\n\texports.Spline = Spline;\n\texports.BoundingBoxHelper = BoundingBoxHelper;\n\texports.EdgesHelper = EdgesHelper;\n\texports.WireframeHelper = WireframeHelper;\n\texports.XHRLoader = XHRLoader;\n\texports.BinaryTextureLoader = BinaryTextureLoader;\n\texports.GeometryUtils = GeometryUtils;\n\texports.ImageUtils = ImageUtils;\n\texports.Projector = Projector;\n\texports.CanvasRenderer = CanvasRenderer;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/three/three.js\n// module id = 65\n// module chunks = 0 1 2","!function(e,r){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=r();else if(\"function\"==typeof define&&define.amd)define([],r);else{var t=r();for(var n in t)(\"object\"==typeof exports?exports:e)[n]=t[n]}}(this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var t={};return r.m=e,r.c=t,r.p=\"\",r(0)}([function(e,r,t){e.exports=t(1)},function(e,r,t){\"use strict\";function n(){var e=\"undefined\"==typeof JSON?{}:JSON;o.setupJSON(e)}var o=t(2),i=t(3);n();var a=window._rollbarConfig,s=a&&a.globalAlias||\"Rollbar\",u=window[s]&&\"undefined\"!=typeof window[s].shimId;!u&&a?o.wrapper.init(a):(window.Rollbar=o.wrapper,window.RollbarNotifier=i.Notifier),e.exports=o.wrapper},function(e,r,t){\"use strict\";function n(e,r,t){!t[4]&&window._rollbarWrappedError&&(t[4]=window._rollbarWrappedError,window._rollbarWrappedError=null),e.uncaughtError.apply(e,t),r&&r.apply(window,t)}function o(e,r){if(r.hasOwnProperty&&r.hasOwnProperty(\"addEventListener\")){var t=r.addEventListener;r.addEventListener=function(r,n,o){t.call(this,r,e.wrap(n),o)};var n=r.removeEventListener;r.removeEventListener=function(e,r,t){n.call(this,e,r&&r._wrapped||r,t)}}}var i=t(3),a=t(8),s=i.Notifier;window._rollbarWrappedError=null;var u={};u.init=function(e,r){var t=new s(r);if(t.configure(e),e.captureUncaught){var i;r&&a.isType(r._rollbarOldOnError,\"function\")?i=r._rollbarOldOnError:window.onerror&&!window.onerror.belongsToShim&&(i=window.onerror),window.onerror=function(){var e=Array.prototype.slice.call(arguments,0);n(t,i,e)};var u,c,l=[\"EventTarget\",\"Window\",\"Node\",\"ApplicationCache\",\"AudioTrackList\",\"ChannelMergerNode\",\"CryptoOperation\",\"EventSource\",\"FileReader\",\"HTMLUnknownElement\",\"IDBDatabase\",\"IDBRequest\",\"IDBTransaction\",\"KeyOperation\",\"MediaController\",\"MessagePort\",\"ModalWindow\",\"Notification\",\"SVGElementInstance\",\"Screen\",\"TextTrack\",\"TextTrackCue\",\"TextTrackList\",\"WebSocket\",\"WebSocketWorker\",\"Worker\",\"XMLHttpRequest\",\"XMLHttpRequestEventTarget\",\"XMLHttpRequestUpload\"];for(u=0;u<l.length;++u)c=l[u],window[c]&&window[c].prototype&&o(t,window[c].prototype)}return e.captureUnhandledRejections&&(r&&a.isType(r._unhandledRejectionHandler,\"function\")&&window.removeEventListener(\"unhandledrejection\",r._unhandledRejectionHandler),t._unhandledRejectionHandler=function(e){var r=e.reason,n=e.promise,o=e.detail;!r&&o&&(r=o.reason,n=o.promise),t.unhandledRejection(r,n)},window.addEventListener(\"unhandledrejection\",t._unhandledRejectionHandler)),window.Rollbar=t,s.processPayloads(),t},e.exports={wrapper:u,setupJSON:i.setupJSON}},function(e,r,t){\"use strict\";function n(e){E=e,w.setupJSON(e)}function o(e,r){return function(){var t=r||this;try{return e.apply(t,arguments)}catch(n){console.error(\"[Rollbar]:\",n)}}}function i(){h||(h=setTimeout(f,1e3))}function a(){return _}function s(e){_=_||this;var r=\"https://\"+s.DEFAULT_ENDPOINT;this.options={enabled:!0,endpoint:r,environment:\"production\",scrubFields:g([],s.DEFAULT_SCRUB_FIELDS),checkIgnore:null,logLevel:s.DEFAULT_LOG_LEVEL,reportLevel:s.DEFAULT_REPORT_LEVEL,uncaughtErrorLevel:s.DEFAULT_UNCAUGHT_ERROR_LEVEL,payload:{}},this.lastError=null,this.plugins={},this.parentNotifier=e,e&&(e.hasOwnProperty(\"shimId\")?e.notifier=this:this.configure(e.options))}function u(e){window._rollbarPayloadQueue.push(e),i()}function c(e){return o(function(){var r=this._getLogArgs(arguments);return this._log(e||r.level||this.options.logLevel||s.DEFAULT_LOG_LEVEL,r.message,r.err,r.custom,r.callback)})}function l(e,r){e||(e=r?E.stringify(r):\"\");var t={body:e};return r&&(t.extra=g(!0,{},r)),{message:t}}function p(e,r,t){var n=m.guessErrorClass(r.message),o=r.name||n[0],i=n[1],a={exception:{\"class\":o,message:i}};if(e&&(a.exception.description=e||\"uncaught exception\"),r.stack){var s,u,c,p,f,d,h,w;for(a.frames=[],h=0;h<r.stack.length;++h)s=r.stack[h],u={filename:s.url?v.sanitizeUrl(s.url):\"(unknown)\",lineno:s.line||null,method:s.func&&\"?\"!==s.func?s.func:\"[anonymous]\",colno:s.column},c=p=f=null,d=s.context?s.context.length:0,d&&(w=Math.floor(d/2),p=s.context.slice(0,w),c=s.context[w],f=s.context.slice(w)),c&&(u.code=c),(p||f)&&(u.context={},p&&p.length&&(u.context.pre=p),f&&f.length&&(u.context.post=f)),s.args&&(u.args=s.args),a.frames.push(u);return a.frames.reverse(),t&&(a.extra=g(!0,{},t)),{trace:a}}return l(o+\": \"+i,t)}function f(){var e;try{for(;e=window._rollbarPayloadQueue.shift();)d(e)}finally{h=void 0}}function d(e){var r=e.endpointUrl,t=e.accessToken,n=e.payload,o=e.callback||function(){},i=(new Date).getTime();i-L>=6e4&&(L=i,R=0);var a=window._globalRollbarOptions.maxItems,c=window._globalRollbarOptions.itemsPerMinute,l=function(){return!n.ignoreRateLimit&&a>=1&&T>=a},p=function(){return!n.ignoreRateLimit&&c>=1&&R>=c};return l()?void o(new Error(a+\" max items reached\")):p()?void o(new Error(c+\" items per minute reached\")):(T++,R++,l()&&_._log(_.options.uncaughtErrorLevel,\"maxItems has been hit. Ignoring errors for the remainder of the current page load.\",null,{maxItems:a},null,!1,!0),n.ignoreRateLimit&&delete n.ignoreRateLimit,void y.post(r,t,n,function(r,t){return r?(r instanceof b&&(e.callback=function(){},setTimeout(function(){u(e)},s.RETRY_DELAY)),o(r)):o(null,t)}))}var h,g=t(4),m=t(5),v=t(8),w=t(10),y=w.XHR,b=w.ConnectionError,E=null;s.NOTIFIER_VERSION=\"1.9.2\",s.DEFAULT_ENDPOINT=\"api.rollbar.com/api/1/\",s.DEFAULT_SCRUB_FIELDS=[\"pw\",\"pass\",\"passwd\",\"password\",\"secret\",\"confirm_password\",\"confirmPassword\",\"password_confirmation\",\"passwordConfirmation\",\"access_token\",\"accessToken\",\"secret_key\",\"secretKey\",\"secretToken\"],s.DEFAULT_LOG_LEVEL=\"debug\",s.DEFAULT_REPORT_LEVEL=\"debug\",s.DEFAULT_UNCAUGHT_ERROR_LEVEL=\"error\",s.DEFAULT_ITEMS_PER_MIN=60,s.DEFAULT_MAX_ITEMS=0,s.LEVELS={debug:0,info:1,warning:2,error:3,critical:4},s.RETRY_DELAY=1e4,window._rollbarPayloadQueue=window._rollbarPayloadQueue||[],window._globalRollbarOptions={startTime:(new Date).getTime(),maxItems:s.DEFAULT_MAX_ITEMS,itemsPerMinute:s.DEFAULT_ITEMS_PER_MIN};var _,x=s.prototype;x._getLogArgs=function(e){for(var r,t,n,i,a,u,c=this.options.logLevel||s.DEFAULT_LOG_LEVEL,l=[],p=0;p<e.length;++p)u=e[p],a=v.typeName(u),\"string\"===a?r?l.push(u):r=u:\"function\"===a?i=o(u,this):\"date\"===a?l.push(u):\"error\"===a||u instanceof Error||\"undefined\"!=typeof DOMException&&u instanceof DOMException?t?l.push(u):t=u:\"object\"!==a&&\"array\"!==a||(n?l.push(u):n=u);return l.length&&(n=n||{},n.extraArgs=l),{level:c,message:r,err:t,custom:n,callback:i}},x._route=function(e){var r=this.options.endpoint,t=/\\/$/.test(r),n=/^\\//.test(e);return t&&n?e=e.substring(1):t||n||(e=\"/\"+e),r+e},x._processShimQueue=function(e){for(var r,t,n,o,i,a,u,c={};t=e.shift();)r=t.shim,n=t.method,o=t.args,i=r.parentShim,u=c[r.shimId],u||(i?(a=c[i.shimId],u=new s(a)):u=this,c[r.shimId]=u),u[n]&&v.isType(u[n],\"function\")&&u[n].apply(u,o)},x._buildPayload=function(e,r,t,n,o){var i=this.options.accessToken,a=this.options.environment,u=g(!0,{},this.options.payload),c=v.uuid4();if(void 0===s.LEVELS[r])throw new Error(\"Invalid level\");if(!t&&!n&&!o)throw new Error(\"No message, stack info or custom data\");var l={environment:a,endpoint:this.options.endpoint,uuid:c,level:r,platform:\"browser\",framework:\"browser-js\",language:\"javascript\",body:this._buildBody(t,n,o),request:{url:window.location.href,query_string:window.location.search,user_ip:\"$remote_ip\"},client:{runtime_ms:e.getTime()-window._globalRollbarOptions.startTime,timestamp:Math.round(e.getTime()/1e3),javascript:{browser:window.navigator.userAgent,language:window.navigator.language,cookie_enabled:window.navigator.cookieEnabled,screen:{width:window.screen.width,height:window.screen.height},plugins:this._getBrowserPlugins()}},server:{},notifier:{name:\"rollbar-browser-js\",version:s.NOTIFIER_VERSION}};u.body&&delete u.body;var p={access_token:i,data:g(!0,l,u)};return this._scrub(p.data),p},x._buildBody=function(e,r,t){var n;return n=r?p(e,r,t):l(e,t)},x._getBrowserPlugins=function(){if(!this._browserPlugins){var e,r,t=window.navigator.plugins||[],n=t.length,o=[];for(r=0;r<n;++r)e=t[r],o.push({name:e.name,description:e.description});this._browserPlugins=o}return this._browserPlugins},x._scrub=function(e){function r(e,r,t,n,o,i){return r+v.redact(i)}function t(e){var t;if(v.isType(e,\"string\"))for(t=0;t<s.length;++t)e=e.replace(s[t],r);return e}function n(e,r){var t;for(t=0;t<a.length;++t)if(a[t].test(e)){r=v.redact(r);break}return r}function o(e,r){var o=n(e,r);return o===r?t(o):o}var i=this.options.scrubFields,a=this._getScrubFieldRegexs(i),s=this._getScrubQueryParamRegexs(i);return v.traverse(e,o),e},x._getScrubFieldRegexs=function(e){for(var r,t=[],n=0;n<e.length;++n)r=\"\\\\[?(%5[bB])?\"+e[n]+\"\\\\[?(%5[bB])?\\\\]?(%5[dD])?\",t.push(new RegExp(r,\"i\"));return t},x._getScrubQueryParamRegexs=function(e){for(var r,t=[],n=0;n<e.length;++n)r=\"\\\\[?(%5[bB])?\"+e[n]+\"\\\\[?(%5[bB])?\\\\]?(%5[dD])?\",t.push(new RegExp(\"(\"+r+\"=)([^&\\\\n]+)\",\"igm\"));return t},x._urlIsWhitelisted=function(e){var r,t,n,o,i,a,s,u,c,l;try{if(r=this.options.hostWhiteList,t=e&&e.data&&e.data.body&&e.data.body.trace,!r||0===r.length)return!0;if(!t)return!0;for(s=r.length,i=t.frames.length,c=0;c<i;c++){if(n=t.frames[c],o=n.filename,!v.isType(o,\"string\"))return!0;for(l=0;l<s;l++)if(a=r[l],u=new RegExp(a),u.test(o))return!0}}catch(p){return this.configure({hostWhiteList:null}),console.error(\"[Rollbar]: Error while reading your configuration's hostWhiteList option. Removing custom hostWhiteList.\",p),!0}return!1},x._messageIsIgnored=function(e){var r,t,n,o,i,a,s,u,c;try{if(i=!1,n=this.options.ignoredMessages,!n||0===n.length)return!1;if(s=e&&e.data&&e.data.body,u=s&&s.trace&&s.trace.exception&&s.trace.exception.message,c=s&&s.message&&s.message.body,r=u||c,!r)return!1;for(o=n.length,t=0;t<o&&(a=new RegExp(n[t],\"gi\"),!(i=a.test(r)));t++);}catch(l){this.configure({ignoredMessages:null}),console.error(\"[Rollbar]: Error while reading your configuration's ignoredMessages option. Removing custom ignoredMessages.\")}return i},x._enqueuePayload=function(e,r,t,n){var o={callback:n,accessToken:this.options.accessToken,endpointUrl:this._route(\"item/\"),payload:e},i=function(){if(n){var e=\"This item was not sent to Rollbar because it was ignored. This can happen if a custom checkIgnore() function was used or if the item's level was less than the notifier' reportLevel. See https://rollbar.com/docs/notifier/rollbar.js/configuration for more details.\";n(null,{err:0,result:{id:null,uuid:null,message:e}})}};if(this._internalCheckIgnore(r,t,e))return void i();try{if(v.isType(this.options.checkIgnore,\"function\")&&this.options.checkIgnore(r,t,e))return void i()}catch(a){this.configure({checkIgnore:null}),console.error(\"[Rollbar]: Error while calling custom checkIgnore() function. Removing custom checkIgnore().\",a)}if(this._urlIsWhitelisted(e)&&!this._messageIsIgnored(e)){if(this.options.verbose){if(e.data&&e.data.body&&e.data.body.trace){var s=e.data.body.trace,c=s.exception.message;console.error(\"[Rollbar]: \",c)}console.info(\"[Rollbar]: \",o)}v.isType(this.options.logFunction,\"function\")&&this.options.logFunction(o);try{v.isType(this.options.transform,\"function\")&&this.options.transform(e)}catch(a){this.configure({transform:null}),console.error(\"[Rollbar]: Error while calling custom transform() function. Removing custom transform().\",a)}this.options.enabled&&u(o)}},x._internalCheckIgnore=function(e,r,t){var n=r[0],o=s.LEVELS[n]||0,i=s.LEVELS[this.options.reportLevel]||0;if(o<i)return!0;var a=this.options?this.options.plugins:{};if(a&&a.jquery&&a.jquery.ignoreAjaxErrors)try{return!!t.data.body.message.extra.isAjax}catch(u){return!1}return!1},x._log=function(e,r,t,n,o,i,a){var s=null;if(t)try{if(s=t._savedStackTrace?t._savedStackTrace:m.parse(t),t===this.lastError)return;this.lastError=t}catch(u){console.error(\"[Rollbar]: Error while parsing the error object.\",u),r=t.message||t.description||r||String(t),t=null}var c=this._buildPayload(new Date,e,r,s,n);a&&(c.ignoreRateLimit=!0),this._enqueuePayload(c,!!i,[e,r,t,n],o)},x.log=c(),x.debug=c(\"debug\"),x.info=c(\"info\"),x.warn=c(\"warning\"),x.warning=c(\"warning\"),x.error=c(\"error\"),x.critical=c(\"critical\"),x.uncaughtError=o(function(e,r,t,n,o,i){if(i=i||null,o&&v.isType(o,\"error\"))return void this._log(this.options.uncaughtErrorLevel,e,o,i,null,!0);if(r&&v.isType(r,\"error\"))return void this._log(this.options.uncaughtErrorLevel,e,r,i,null,!0);var a={url:r||\"\",line:t};a.func=m.guessFunctionName(a.url,a.line),a.context=m.gatherContext(a.url,a.line);var s={mode:\"onerror\",message:o?String(o):e||\"uncaught exception\",url:document.location.href,stack:[a],useragent:navigator.userAgent},u=this._buildPayload(new Date,this.options.uncaughtErrorLevel,e,s,i);this._enqueuePayload(u,!0,[this.options.uncaughtErrorLevel,e,r,t,n,o])}),x.unhandledRejection=o(function(e,r){if(null==e)return void _._log(_.options.uncaughtErrorLevel,\"unhandled rejection was null or undefined!\",null,{},null,!1,!1);var t=e.message||(e?String(e):\"unhandled rejection\"),n=e._rollbarContext||r._rollbarContext||null;if(e&&v.isType(e,\"error\"))return void this._log(this.options.uncaughtErrorLevel,t,e,n,null,!0);var o={url:\"\",line:0};o.func=m.guessFunctionName(o.url,o.line),o.context=m.gatherContext(o.url,o.line);var i={mode:\"unhandledrejection\",message:t,url:document.location.href,stack:[o],useragent:navigator.userAgent},a=this._buildPayload(new Date,this.options.uncaughtErrorLevel,t,i,n);this._enqueuePayload(a,!0,[this.options.uncaughtErrorLevel,t,o.url,o.line,0,e,r])}),x.global=o(function(e){e=e||{};var r={startTime:e.startTime,maxItems:e.maxItems,itemsPerMinute:e.itemsPerMinute};g(!0,window._globalRollbarOptions,r),void 0!==e.maxItems&&(T=0),void 0!==e.itemsPerMinute&&(R=0)}),x.configure=o(function(e,r){var t=g(!0,{},e);g(!r,this.options,t),this.global(t)}),x.scope=o(function(e){var r=new s(this);return g(!0,r.options.payload,e),r}),x.wrap=function(e,r){try{var t;if(t=v.isType(r,\"function\")?r:function(){return r||{}},!v.isType(e,\"function\"))return e;if(e._isWrap)return e;if(!e._wrapped){e._wrapped=function(){try{return e.apply(this,arguments)}catch(r){throw\"string\"==typeof r&&(r=new String(r)),r.stack||(r._savedStackTrace=m.parse(r)),r._rollbarContext=t()||{},r._rollbarContext._wrappedSource=e.toString(),window._rollbarWrappedError=r,r}},e._wrapped._isWrap=!0;for(var n in e)e.hasOwnProperty(n)&&(e._wrapped[n]=e[n])}return e._wrapped}catch(o){return e}},x.loadFull=function(){console.error(\"[Rollbar]: Unexpected Rollbar.loadFull() called on a Notifier instance\")},s.processPayloads=function(e){return e?void f():void i()};var L=(new Date).getTime(),T=0,R=0;e.exports={Notifier:s,setupJSON:n,topLevelNotifier:a}},function(e,r){\"use strict\";var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,o=function(e){return\"function\"==typeof Array.isArray?Array.isArray(e):\"[object Array]\"===n.call(e)},i=function(e){if(!e||\"[object Object]\"!==n.call(e))return!1;var r=t.call(e,\"constructor\"),o=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,\"isPrototypeOf\");if(e.constructor&&!r&&!o)return!1;var i;for(i in e);return\"undefined\"==typeof i||t.call(e,i)};e.exports=function a(){var e,r,t,n,s,u,c=arguments[0],l=1,p=arguments.length,f=!1;for(\"boolean\"==typeof c?(f=c,c=arguments[1]||{},l=2):(\"object\"!=typeof c&&\"function\"!=typeof c||null==c)&&(c={});l<p;++l)if(e=arguments[l],null!=e)for(r in e)t=c[r],n=e[r],c!==n&&(f&&n&&(i(n)||(s=o(n)))?(s?(s=!1,u=t&&o(t)?t:[]):u=t&&i(t)?t:{},c[r]=a(f,u,n)):\"undefined\"!=typeof n&&(c[r]=n));return c}},function(e,r,t){\"use strict\";function n(){return l}function o(){return null}function i(e){var r={};return r._stackFrame=e,r.url=e.fileName,r.line=e.lineNumber,r.func=e.functionName,r.column=e.columnNumber,r.args=e.args,r.context=o(r.url,r.line),r}function a(e){function r(){var r=[];try{r=c.parse(e)}catch(t){r=[]}for(var n=[],o=0;o<r.length;o++)n.push(new i(r[o]));return n}return{stack:r(),message:e.message,name:e.name}}function s(e){return new a(e)}function u(e){if(!e)return[\"Unknown error. There was no error message to display.\",\"\"];var r=e.match(p),t=\"(unknown)\";return r&&(t=r[r.length-1],e=e.replace((r[r.length-2]||\"\")+t+\":\",\"\"),e=e.replace(/(^[\\s]+|[\\s]+$)/g,\"\")),[t,e]}var c=t(6),l=\"?\",p=new RegExp(\"^(([a-zA-Z0-9-_$ ]*): *)?(Uncaught )?([a-zA-Z0-9-_$ ]*): \");e.exports={guessFunctionName:n,guessErrorClass:u,gatherContext:o,parse:s,Stack:a,Frame:i}},function(e,r,t){var n,o,i;!function(a,s){\"use strict\";o=[t(7)],n=s,i=\"function\"==typeof n?n.apply(r,o):n,!(void 0!==i&&(e.exports=i))}(this,function(e){\"use strict\";function r(e,r,t){if(\"function\"==typeof Array.prototype.map)return e.map(r,t);for(var n=new Array(e.length),o=0;o<e.length;o++)n[o]=r.call(t,e[o]);return n}function t(e,r,t){if(\"function\"==typeof Array.prototype.filter)return e.filter(r,t);for(var n=[],o=0;o<e.length;o++)r.call(t,e[o])&&n.push(e[o]);return n}var n=/(^|@)\\S+\\:\\d+/,o=/^\\s*at .*(\\S+\\:\\d+|\\(native\\))/m,i=/^(eval@)?(\\[native code\\])?$/;return{parse:function(e){if(\"undefined\"!=typeof e.stacktrace||\"undefined\"!=typeof e[\"opera#sourceloc\"])return this.parseOpera(e);if(e.stack&&e.stack.match(o))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error(\"Cannot parse given Error object\")},extractLocation:function(e){if(e.indexOf(\":\")===-1)return[e];var r=e.replace(/[\\(\\)\\s]/g,\"\").split(\":\"),t=r.pop(),n=r[r.length-1];if(!isNaN(parseFloat(n))&&isFinite(n)){var o=r.pop();return[r.join(\":\"),o,t]}return[r.join(\":\"),t,void 0]},parseV8OrIE:function(n){var i=t(n.stack.split(\"\\n\"),function(e){return!!e.match(o)},this);return r(i,function(r){r.indexOf(\"(eval \")>-1&&(r=r.replace(/eval code/g,\"eval\").replace(/(\\(eval at [^\\()]*)|(\\)\\,.*$)/g,\"\"));var t=r.replace(/^\\s+/,\"\").replace(/\\(eval code/g,\"(\").split(/\\s+/).slice(1),n=this.extractLocation(t.pop()),o=t.join(\" \")||void 0,i=\"eval\"===n[0]?void 0:n[0];return new e(o,(void 0),i,n[1],n[2],r)},this)},parseFFOrSafari:function(n){var o=t(n.stack.split(\"\\n\"),function(e){return!e.match(i)},this);return r(o,function(r){if(r.indexOf(\" > eval\")>-1&&(r=r.replace(/ line (\\d+)(?: > eval line \\d+)* > eval\\:\\d+\\:\\d+/g,\":$1\")),r.indexOf(\"@\")===-1&&r.indexOf(\":\")===-1)return new e(r);var t=r.split(\"@\"),n=this.extractLocation(t.pop()),o=t.shift()||void 0;return new e(o,(void 0),n[0],n[1],n[2],r)},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf(\"\\n\")>-1&&e.message.split(\"\\n\").length>e.stacktrace.split(\"\\n\").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(r){for(var t=/Line (\\d+).*script (?:in )?(\\S+)/i,n=r.message.split(\"\\n\"),o=[],i=2,a=n.length;i<a;i+=2){var s=t.exec(n[i]);s&&o.push(new e((void 0),(void 0),s[2],s[1],(void 0),n[i]))}return o},parseOpera10:function(r){for(var t=/Line (\\d+).*script (?:in )?(\\S+)(?:: In function (\\S+))?$/i,n=r.stacktrace.split(\"\\n\"),o=[],i=0,a=n.length;i<a;i+=2){var s=t.exec(n[i]);s&&o.push(new e(s[3]||void 0,(void 0),s[2],s[1],(void 0),n[i]))}return o},parseOpera11:function(o){var i=t(o.stack.split(\"\\n\"),function(e){return!!e.match(n)&&!e.match(/^Error created at/)},this);return r(i,function(r){var t,n=r.split(\"@\"),o=this.extractLocation(n.pop()),i=n.shift()||\"\",a=i.replace(/<anonymous function(: (\\w+))?>/,\"$2\").replace(/\\([^\\)]*\\)/g,\"\")||void 0;i.match(/\\(([^\\)]*)\\)/)&&(t=i.replace(/^[^\\(]+\\(([^\\)]*)\\)$/,\"$1\"));var s=void 0===t||\"[arguments not available]\"===t?void 0:t.split(\",\");return new e(a,s,o[0],o[1],o[2],r)},this)}}})},function(e,r,t){var n,o,i;!function(t,a){\"use strict\";o=[],n=a,i=\"function\"==typeof n?n.apply(r,o):n,!(void 0!==i&&(e.exports=i))}(this,function(){\"use strict\";function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function r(e,r,t,n,o,i){void 0!==e&&this.setFunctionName(e),void 0!==r&&this.setArgs(r),void 0!==t&&this.setFileName(t),void 0!==n&&this.setLineNumber(n),void 0!==o&&this.setColumnNumber(o),void 0!==i&&this.setSource(i)}return r.prototype={getFunctionName:function(){return this.functionName},setFunctionName:function(e){this.functionName=String(e)},getArgs:function(){return this.args},setArgs:function(e){if(\"[object Array]\"!==Object.prototype.toString.call(e))throw new TypeError(\"Args must be an Array\");this.args=e},getFileName:function(){return this.fileName},setFileName:function(e){this.fileName=String(e)},getLineNumber:function(){return this.lineNumber},setLineNumber:function(r){if(!e(r))throw new TypeError(\"Line Number must be a Number\");this.lineNumber=Number(r)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(r){if(!e(r))throw new TypeError(\"Column Number must be a Number\");this.columnNumber=Number(r)},getSource:function(){return this.source},setSource:function(e){this.source=String(e)},toString:function(){var r=this.getFunctionName()||\"{anonymous}\",t=\"(\"+(this.getArgs()||[]).join(\",\")+\")\",n=this.getFileName()?\"@\"+this.getFileName():\"\",o=e(this.getLineNumber())?\":\"+this.getLineNumber():\"\",i=e(this.getColumnNumber())?\":\"+this.getColumnNumber():\"\";return r+t+n+o+i}},r})},function(e,r,t){\"use strict\";function n(e){return{}.toString.call(e).match(/\\s([a-zA-Z]+)/)[1].toLowerCase()}function o(e,r){return n(e)===r}function i(e){if(!o(e,\"string\"))throw new Error(\"received invalid input\");for(var r=l,t=r.parser[r.strictMode?\"strict\":\"loose\"].exec(e),n={},i=14;i--;)n[r.key[i]]=t[i]||\"\";return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,function(e,t,o){t&&(n[r.q.name][t]=o)}),n}function a(e){var r=i(e);return\"\"===r.anchor&&(r.source=r.source.replace(\"#\",\"\")),e=r.source.replace(\"?\"+r.query,\"\")}function s(e,r){var t,n,i,a=o(e,\"object\"),u=o(e,\"array\"),c=[];if(a)for(t in e)e.hasOwnProperty(t)&&c.push(t);else if(u)for(i=0;i<e.length;++i)c.push(i);for(i=0;i<c.length;++i)t=c[i],n=e[t],a=o(n,\"object\"),u=o(n,\"array\"),a||u?e[t]=s(n,r):e[t]=r(t,n);return e}function u(e){return e=String(e),new Array(e.length+1).join(\"*\")}function c(){var e=(new Date).getTime(),r=\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,function(r){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),(\"x\"===r?t:7&t|8).toString(16)});return r}t(9);var l={strictMode:!1,key:[\"source\",\"protocol\",\"authority\",\"userInfo\",\"user\",\"password\",\"host\",\"port\",\"relative\",\"path\",\"directory\",\"file\",\"query\",\"anchor\"],q:{name:\"queryKey\",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/}},p={isType:o,parseUri:i,parseUriOptions:l,redact:u,sanitizeUrl:a,traverse:s,typeName:n,uuid4:c};e.exports=p},function(e,r){!function(e){\"use strict\";e.console=e.console||{};for(var r,t,n=e.console,o={},i=function(){},a=\"memory\".split(\",\"),s=\"assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn\".split(\",\");r=a.pop();)n[r]||(n[r]=o);for(;t=s.pop();)n[t]||(n[t]=i)}(\"undefined\"==typeof window?this:window)},function(e,r,t){\"use strict\";function n(e){a=e}function o(e){this.name=\"Connection Error\",this.message=e,this.stack=(new Error).stack}var i=t(8),a=null;o.prototype=Object.create(Error.prototype),o.prototype.constructor=o;var s={XMLHttpFactories:[function(){return new XMLHttpRequest},function(){return new ActiveXObject(\"Msxml2.XMLHTTP\")},function(){return new ActiveXObject(\"Msxml3.XMLHTTP\")},function(){return new ActiveXObject(\"Microsoft.XMLHTTP\")}],createXMLHTTPObject:function(){var e,r=!1,t=s.XMLHttpFactories,n=t.length;for(e=0;e<n;e++)try{r=t[e]();break}catch(o){}return r},post:function(e,r,t,n){if(!i.isType(t,\"object\"))throw new Error(\"Expected an object to POST\");t=a.stringify(t),n=n||function(){};var u=s.createXMLHTTPObject();if(u)try{try{var c=function(){try{if(c&&4===u.readyState){c=void 0;var e=a.parse(u.responseText);200===u.status?n(null,e):i.isType(u.status,\"number\")&&u.status>=400&&u.status<600?(403==u.status&&console.error(\"[Rollbar]:\"+e.message),n(new Error(String(u.status)))):n(new o(\"XHR response had no status code (likely connection failure)\"))}}catch(r){var t;t=r&&r.stack?r:new Error(r),n(t)}};u.open(\"POST\",e,!0),u.setRequestHeader&&(u.setRequestHeader(\"Content-Type\",\"application/json\"),u.setRequestHeader(\"X-Rollbar-Access-Token\",r)),u.onreadystatechange=c,u.send(t)}catch(l){if(\"undefined\"!=typeof XDomainRequest){\"http:\"===window.location.href.substring(0,5)&&\"https\"===e.substring(0,5)&&(e=\"http\"+e.substring(5));var p=function(){n(new o(\"Request timed out\"))},f=function(){n(new Error(\"Error during request\"))},d=function(){n(null,a.parse(u.responseText))};u=new XDomainRequest,u.onprogress=function(){},u.ontimeout=p,u.onerror=f,u.onload=d,u.open(\"POST\",e,!0),u.send(t)}}}catch(h){n(h)}}};e.exports={XHR:s,setupJSON:n,ConnectionError:o}}])});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/rollbar-browser/dist/rollbar.umd.nojson.min.js\n// module id = 66\n// module chunks = 0 1 2","/**\n *  Copyright (c) 2014-2015, Facebook, Inc.\n *  All rights reserved.\n *\n *  This source code is licensed under the BSD-style license found in the\n *  LICENSE file in the root directory of this source tree. An additional grant\n *  of patent rights can be found in the PATENTS file in the same directory.\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.Immutable = factory());\n}(this, function () { 'use strict';var SLICE$0 = Array.prototype.slice;\n\n  function createClass(ctor, superClass) {\n    if (superClass) {\n      ctor.prototype = Object.create(superClass.prototype);\n    }\n    ctor.prototype.constructor = ctor;\n  }\n\n  function Iterable(value) {\n      return isIterable(value) ? value : Seq(value);\n    }\n\n\n  createClass(KeyedIterable, Iterable);\n    function KeyedIterable(value) {\n      return isKeyed(value) ? value : KeyedSeq(value);\n    }\n\n\n  createClass(IndexedIterable, Iterable);\n    function IndexedIterable(value) {\n      return isIndexed(value) ? value : IndexedSeq(value);\n    }\n\n\n  createClass(SetIterable, Iterable);\n    function SetIterable(value) {\n      return isIterable(value) && !isAssociative(value) ? value : SetSeq(value);\n    }\n\n\n\n  function isIterable(maybeIterable) {\n    return !!(maybeIterable && maybeIterable[IS_ITERABLE_SENTINEL]);\n  }\n\n  function isKeyed(maybeKeyed) {\n    return !!(maybeKeyed && maybeKeyed[IS_KEYED_SENTINEL]);\n  }\n\n  function isIndexed(maybeIndexed) {\n    return !!(maybeIndexed && maybeIndexed[IS_INDEXED_SENTINEL]);\n  }\n\n  function isAssociative(maybeAssociative) {\n    return isKeyed(maybeAssociative) || isIndexed(maybeAssociative);\n  }\n\n  function isOrdered(maybeOrdered) {\n    return !!(maybeOrdered && maybeOrdered[IS_ORDERED_SENTINEL]);\n  }\n\n  Iterable.isIterable = isIterable;\n  Iterable.isKeyed = isKeyed;\n  Iterable.isIndexed = isIndexed;\n  Iterable.isAssociative = isAssociative;\n  Iterable.isOrdered = isOrdered;\n\n  Iterable.Keyed = KeyedIterable;\n  Iterable.Indexed = IndexedIterable;\n  Iterable.Set = SetIterable;\n\n\n  var IS_ITERABLE_SENTINEL = '@@__IMMUTABLE_ITERABLE__@@';\n  var IS_KEYED_SENTINEL = '@@__IMMUTABLE_KEYED__@@';\n  var IS_INDEXED_SENTINEL = '@@__IMMUTABLE_INDEXED__@@';\n  var IS_ORDERED_SENTINEL = '@@__IMMUTABLE_ORDERED__@@';\n\n  // Used for setting prototype methods that IE8 chokes on.\n  var DELETE = 'delete';\n\n  // Constants describing the size of trie nodes.\n  var SHIFT = 5; // Resulted in best performance after ______?\n  var SIZE = 1 << SHIFT;\n  var MASK = SIZE - 1;\n\n  // A consistent shared value representing \"not set\" which equals nothing other\n  // than itself, and nothing that could be provided externally.\n  var NOT_SET = {};\n\n  // Boolean references, Rough equivalent of `bool &`.\n  var CHANGE_LENGTH = { value: false };\n  var DID_ALTER = { value: false };\n\n  function MakeRef(ref) {\n    ref.value = false;\n    return ref;\n  }\n\n  function SetRef(ref) {\n    ref && (ref.value = true);\n  }\n\n  // A function which returns a value representing an \"owner\" for transient writes\n  // to tries. The return value will only ever equal itself, and will not equal\n  // the return of any subsequent call of this function.\n  function OwnerID() {}\n\n  // http://jsperf.com/copy-array-inline\n  function arrCopy(arr, offset) {\n    offset = offset || 0;\n    var len = Math.max(0, arr.length - offset);\n    var newArr = new Array(len);\n    for (var ii = 0; ii < len; ii++) {\n      newArr[ii] = arr[ii + offset];\n    }\n    return newArr;\n  }\n\n  function ensureSize(iter) {\n    if (iter.size === undefined) {\n      iter.size = iter.__iterate(returnTrue);\n    }\n    return iter.size;\n  }\n\n  function wrapIndex(iter, index) {\n    // This implements \"is array index\" which the ECMAString spec defines as:\n    //\n    //     A String property name P is an array index if and only if\n    //     ToString(ToUint32(P)) is equal to P and ToUint32(P) is not equal\n    //     to 2^32−1.\n    //\n    // http://www.ecma-international.org/ecma-262/6.0/#sec-array-exotic-objects\n    if (typeof index !== 'number') {\n      var uint32Index = index >>> 0; // N >>> 0 is shorthand for ToUint32\n      if ('' + uint32Index !== index || uint32Index === 4294967295) {\n        return NaN;\n      }\n      index = uint32Index;\n    }\n    return index < 0 ? ensureSize(iter) + index : index;\n  }\n\n  function returnTrue() {\n    return true;\n  }\n\n  function wholeSlice(begin, end, size) {\n    return (begin === 0 || (size !== undefined && begin <= -size)) &&\n      (end === undefined || (size !== undefined && end >= size));\n  }\n\n  function resolveBegin(begin, size) {\n    return resolveIndex(begin, size, 0);\n  }\n\n  function resolveEnd(end, size) {\n    return resolveIndex(end, size, size);\n  }\n\n  function resolveIndex(index, size, defaultIndex) {\n    return index === undefined ?\n      defaultIndex :\n      index < 0 ?\n        Math.max(0, size + index) :\n        size === undefined ?\n          index :\n          Math.min(size, index);\n  }\n\n  /* global Symbol */\n\n  var ITERATE_KEYS = 0;\n  var ITERATE_VALUES = 1;\n  var ITERATE_ENTRIES = 2;\n\n  var REAL_ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\n  var FAUX_ITERATOR_SYMBOL = '@@iterator';\n\n  var ITERATOR_SYMBOL = REAL_ITERATOR_SYMBOL || FAUX_ITERATOR_SYMBOL;\n\n\n  function Iterator(next) {\n      this.next = next;\n    }\n\n    Iterator.prototype.toString = function() {\n      return '[Iterator]';\n    };\n\n\n  Iterator.KEYS = ITERATE_KEYS;\n  Iterator.VALUES = ITERATE_VALUES;\n  Iterator.ENTRIES = ITERATE_ENTRIES;\n\n  Iterator.prototype.inspect =\n  Iterator.prototype.toSource = function () { return this.toString(); }\n  Iterator.prototype[ITERATOR_SYMBOL] = function () {\n    return this;\n  };\n\n\n  function iteratorValue(type, k, v, iteratorResult) {\n    var value = type === 0 ? k : type === 1 ? v : [k, v];\n    iteratorResult ? (iteratorResult.value = value) : (iteratorResult = {\n      value: value, done: false\n    });\n    return iteratorResult;\n  }\n\n  function iteratorDone() {\n    return { value: undefined, done: true };\n  }\n\n  function hasIterator(maybeIterable) {\n    return !!getIteratorFn(maybeIterable);\n  }\n\n  function isIterator(maybeIterator) {\n    return maybeIterator && typeof maybeIterator.next === 'function';\n  }\n\n  function getIterator(iterable) {\n    var iteratorFn = getIteratorFn(iterable);\n    return iteratorFn && iteratorFn.call(iterable);\n  }\n\n  function getIteratorFn(iterable) {\n    var iteratorFn = iterable && (\n      (REAL_ITERATOR_SYMBOL && iterable[REAL_ITERATOR_SYMBOL]) ||\n      iterable[FAUX_ITERATOR_SYMBOL]\n    );\n    if (typeof iteratorFn === 'function') {\n      return iteratorFn;\n    }\n  }\n\n  function isArrayLike(value) {\n    return value && typeof value.length === 'number';\n  }\n\n  createClass(Seq, Iterable);\n    function Seq(value) {\n      return value === null || value === undefined ? emptySequence() :\n        isIterable(value) ? value.toSeq() : seqFromValue(value);\n    }\n\n    Seq.of = function(/*...values*/) {\n      return Seq(arguments);\n    };\n\n    Seq.prototype.toSeq = function() {\n      return this;\n    };\n\n    Seq.prototype.toString = function() {\n      return this.__toString('Seq {', '}');\n    };\n\n    Seq.prototype.cacheResult = function() {\n      if (!this._cache && this.__iterateUncached) {\n        this._cache = this.entrySeq().toArray();\n        this.size = this._cache.length;\n      }\n      return this;\n    };\n\n    // abstract __iterateUncached(fn, reverse)\n\n    Seq.prototype.__iterate = function(fn, reverse) {\n      return seqIterate(this, fn, reverse, true);\n    };\n\n    // abstract __iteratorUncached(type, reverse)\n\n    Seq.prototype.__iterator = function(type, reverse) {\n      return seqIterator(this, type, reverse, true);\n    };\n\n\n\n  createClass(KeyedSeq, Seq);\n    function KeyedSeq(value) {\n      return value === null || value === undefined ?\n        emptySequence().toKeyedSeq() :\n        isIterable(value) ?\n          (isKeyed(value) ? value.toSeq() : value.fromEntrySeq()) :\n          keyedSeqFromValue(value);\n    }\n\n    KeyedSeq.prototype.toKeyedSeq = function() {\n      return this;\n    };\n\n\n\n  createClass(IndexedSeq, Seq);\n    function IndexedSeq(value) {\n      return value === null || value === undefined ? emptySequence() :\n        !isIterable(value) ? indexedSeqFromValue(value) :\n        isKeyed(value) ? value.entrySeq() : value.toIndexedSeq();\n    }\n\n    IndexedSeq.of = function(/*...values*/) {\n      return IndexedSeq(arguments);\n    };\n\n    IndexedSeq.prototype.toIndexedSeq = function() {\n      return this;\n    };\n\n    IndexedSeq.prototype.toString = function() {\n      return this.__toString('Seq [', ']');\n    };\n\n    IndexedSeq.prototype.__iterate = function(fn, reverse) {\n      return seqIterate(this, fn, reverse, false);\n    };\n\n    IndexedSeq.prototype.__iterator = function(type, reverse) {\n      return seqIterator(this, type, reverse, false);\n    };\n\n\n\n  createClass(SetSeq, Seq);\n    function SetSeq(value) {\n      return (\n        value === null || value === undefined ? emptySequence() :\n        !isIterable(value) ? indexedSeqFromValue(value) :\n        isKeyed(value) ? value.entrySeq() : value\n      ).toSetSeq();\n    }\n\n    SetSeq.of = function(/*...values*/) {\n      return SetSeq(arguments);\n    };\n\n    SetSeq.prototype.toSetSeq = function() {\n      return this;\n    };\n\n\n\n  Seq.isSeq = isSeq;\n  Seq.Keyed = KeyedSeq;\n  Seq.Set = SetSeq;\n  Seq.Indexed = IndexedSeq;\n\n  var IS_SEQ_SENTINEL = '@@__IMMUTABLE_SEQ__@@';\n\n  Seq.prototype[IS_SEQ_SENTINEL] = true;\n\n\n\n  createClass(ArraySeq, IndexedSeq);\n    function ArraySeq(array) {\n      this._array = array;\n      this.size = array.length;\n    }\n\n    ArraySeq.prototype.get = function(index, notSetValue) {\n      return this.has(index) ? this._array[wrapIndex(this, index)] : notSetValue;\n    };\n\n    ArraySeq.prototype.__iterate = function(fn, reverse) {\n      var array = this._array;\n      var maxIndex = array.length - 1;\n      for (var ii = 0; ii <= maxIndex; ii++) {\n        if (fn(array[reverse ? maxIndex - ii : ii], ii, this) === false) {\n          return ii + 1;\n        }\n      }\n      return ii;\n    };\n\n    ArraySeq.prototype.__iterator = function(type, reverse) {\n      var array = this._array;\n      var maxIndex = array.length - 1;\n      var ii = 0;\n      return new Iterator(function() \n        {return ii > maxIndex ?\n          iteratorDone() :\n          iteratorValue(type, ii, array[reverse ? maxIndex - ii++ : ii++])}\n      );\n    };\n\n\n\n  createClass(ObjectSeq, KeyedSeq);\n    function ObjectSeq(object) {\n      var keys = Object.keys(object);\n      this._object = object;\n      this._keys = keys;\n      this.size = keys.length;\n    }\n\n    ObjectSeq.prototype.get = function(key, notSetValue) {\n      if (notSetValue !== undefined && !this.has(key)) {\n        return notSetValue;\n      }\n      return this._object[key];\n    };\n\n    ObjectSeq.prototype.has = function(key) {\n      return this._object.hasOwnProperty(key);\n    };\n\n    ObjectSeq.prototype.__iterate = function(fn, reverse) {\n      var object = this._object;\n      var keys = this._keys;\n      var maxIndex = keys.length - 1;\n      for (var ii = 0; ii <= maxIndex; ii++) {\n        var key = keys[reverse ? maxIndex - ii : ii];\n        if (fn(object[key], key, this) === false) {\n          return ii + 1;\n        }\n      }\n      return ii;\n    };\n\n    ObjectSeq.prototype.__iterator = function(type, reverse) {\n      var object = this._object;\n      var keys = this._keys;\n      var maxIndex = keys.length - 1;\n      var ii = 0;\n      return new Iterator(function()  {\n        var key = keys[reverse ? maxIndex - ii : ii];\n        return ii++ > maxIndex ?\n          iteratorDone() :\n          iteratorValue(type, key, object[key]);\n      });\n    };\n\n  ObjectSeq.prototype[IS_ORDERED_SENTINEL] = true;\n\n\n  createClass(IterableSeq, IndexedSeq);\n    function IterableSeq(iterable) {\n      this._iterable = iterable;\n      this.size = iterable.length || iterable.size;\n    }\n\n    IterableSeq.prototype.__iterateUncached = function(fn, reverse) {\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var iterable = this._iterable;\n      var iterator = getIterator(iterable);\n      var iterations = 0;\n      if (isIterator(iterator)) {\n        var step;\n        while (!(step = iterator.next()).done) {\n          if (fn(step.value, iterations++, this) === false) {\n            break;\n          }\n        }\n      }\n      return iterations;\n    };\n\n    IterableSeq.prototype.__iteratorUncached = function(type, reverse) {\n      if (reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      var iterable = this._iterable;\n      var iterator = getIterator(iterable);\n      if (!isIterator(iterator)) {\n        return new Iterator(iteratorDone);\n      }\n      var iterations = 0;\n      return new Iterator(function()  {\n        var step = iterator.next();\n        return step.done ? step : iteratorValue(type, iterations++, step.value);\n      });\n    };\n\n\n\n  createClass(IteratorSeq, IndexedSeq);\n    function IteratorSeq(iterator) {\n      this._iterator = iterator;\n      this._iteratorCache = [];\n    }\n\n    IteratorSeq.prototype.__iterateUncached = function(fn, reverse) {\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var iterator = this._iterator;\n      var cache = this._iteratorCache;\n      var iterations = 0;\n      while (iterations < cache.length) {\n        if (fn(cache[iterations], iterations++, this) === false) {\n          return iterations;\n        }\n      }\n      var step;\n      while (!(step = iterator.next()).done) {\n        var val = step.value;\n        cache[iterations] = val;\n        if (fn(val, iterations++, this) === false) {\n          break;\n        }\n      }\n      return iterations;\n    };\n\n    IteratorSeq.prototype.__iteratorUncached = function(type, reverse) {\n      if (reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      var iterator = this._iterator;\n      var cache = this._iteratorCache;\n      var iterations = 0;\n      return new Iterator(function()  {\n        if (iterations >= cache.length) {\n          var step = iterator.next();\n          if (step.done) {\n            return step;\n          }\n          cache[iterations] = step.value;\n        }\n        return iteratorValue(type, iterations, cache[iterations++]);\n      });\n    };\n\n\n\n\n  // # pragma Helper functions\n\n  function isSeq(maybeSeq) {\n    return !!(maybeSeq && maybeSeq[IS_SEQ_SENTINEL]);\n  }\n\n  var EMPTY_SEQ;\n\n  function emptySequence() {\n    return EMPTY_SEQ || (EMPTY_SEQ = new ArraySeq([]));\n  }\n\n  function keyedSeqFromValue(value) {\n    var seq =\n      Array.isArray(value) ? new ArraySeq(value).fromEntrySeq() :\n      isIterator(value) ? new IteratorSeq(value).fromEntrySeq() :\n      hasIterator(value) ? new IterableSeq(value).fromEntrySeq() :\n      typeof value === 'object' ? new ObjectSeq(value) :\n      undefined;\n    if (!seq) {\n      throw new TypeError(\n        'Expected Array or iterable object of [k, v] entries, '+\n        'or keyed object: ' + value\n      );\n    }\n    return seq;\n  }\n\n  function indexedSeqFromValue(value) {\n    var seq = maybeIndexedSeqFromValue(value);\n    if (!seq) {\n      throw new TypeError(\n        'Expected Array or iterable object of values: ' + value\n      );\n    }\n    return seq;\n  }\n\n  function seqFromValue(value) {\n    var seq = maybeIndexedSeqFromValue(value) ||\n      (typeof value === 'object' && new ObjectSeq(value));\n    if (!seq) {\n      throw new TypeError(\n        'Expected Array or iterable object of values, or keyed object: ' + value\n      );\n    }\n    return seq;\n  }\n\n  function maybeIndexedSeqFromValue(value) {\n    return (\n      isArrayLike(value) ? new ArraySeq(value) :\n      isIterator(value) ? new IteratorSeq(value) :\n      hasIterator(value) ? new IterableSeq(value) :\n      undefined\n    );\n  }\n\n  function seqIterate(seq, fn, reverse, useKeys) {\n    var cache = seq._cache;\n    if (cache) {\n      var maxIndex = cache.length - 1;\n      for (var ii = 0; ii <= maxIndex; ii++) {\n        var entry = cache[reverse ? maxIndex - ii : ii];\n        if (fn(entry[1], useKeys ? entry[0] : ii, seq) === false) {\n          return ii + 1;\n        }\n      }\n      return ii;\n    }\n    return seq.__iterateUncached(fn, reverse);\n  }\n\n  function seqIterator(seq, type, reverse, useKeys) {\n    var cache = seq._cache;\n    if (cache) {\n      var maxIndex = cache.length - 1;\n      var ii = 0;\n      return new Iterator(function()  {\n        var entry = cache[reverse ? maxIndex - ii : ii];\n        return ii++ > maxIndex ?\n          iteratorDone() :\n          iteratorValue(type, useKeys ? entry[0] : ii - 1, entry[1]);\n      });\n    }\n    return seq.__iteratorUncached(type, reverse);\n  }\n\n  function fromJS(json, converter) {\n    return converter ?\n      fromJSWith(converter, json, '', {'': json}) :\n      fromJSDefault(json);\n  }\n\n  function fromJSWith(converter, json, key, parentJSON) {\n    if (Array.isArray(json)) {\n      return converter.call(parentJSON, key, IndexedSeq(json).map(function(v, k)  {return fromJSWith(converter, v, k, json)}));\n    }\n    if (isPlainObj(json)) {\n      return converter.call(parentJSON, key, KeyedSeq(json).map(function(v, k)  {return fromJSWith(converter, v, k, json)}));\n    }\n    return json;\n  }\n\n  function fromJSDefault(json) {\n    if (Array.isArray(json)) {\n      return IndexedSeq(json).map(fromJSDefault).toList();\n    }\n    if (isPlainObj(json)) {\n      return KeyedSeq(json).map(fromJSDefault).toMap();\n    }\n    return json;\n  }\n\n  function isPlainObj(value) {\n    return value && (value.constructor === Object || value.constructor === undefined);\n  }\n\n  /**\n   * An extension of the \"same-value\" algorithm as [described for use by ES6 Map\n   * and Set](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map#Key_equality)\n   *\n   * NaN is considered the same as NaN, however -0 and 0 are considered the same\n   * value, which is different from the algorithm described by\n   * [`Object.is`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is).\n   *\n   * This is extended further to allow Objects to describe the values they\n   * represent, by way of `valueOf` or `equals` (and `hashCode`).\n   *\n   * Note: because of this extension, the key equality of Immutable.Map and the\n   * value equality of Immutable.Set will differ from ES6 Map and Set.\n   *\n   * ### Defining custom values\n   *\n   * The easiest way to describe the value an object represents is by implementing\n   * `valueOf`. For example, `Date` represents a value by returning a unix\n   * timestamp for `valueOf`:\n   *\n   *     var date1 = new Date(1234567890000); // Fri Feb 13 2009 ...\n   *     var date2 = new Date(1234567890000);\n   *     date1.valueOf(); // 1234567890000\n   *     assert( date1 !== date2 );\n   *     assert( Immutable.is( date1, date2 ) );\n   *\n   * Note: overriding `valueOf` may have other implications if you use this object\n   * where JavaScript expects a primitive, such as implicit string coercion.\n   *\n   * For more complex types, especially collections, implementing `valueOf` may\n   * not be performant. An alternative is to implement `equals` and `hashCode`.\n   *\n   * `equals` takes another object, presumably of similar type, and returns true\n   * if the it is equal. Equality is symmetrical, so the same result should be\n   * returned if this and the argument are flipped.\n   *\n   *     assert( a.equals(b) === b.equals(a) );\n   *\n   * `hashCode` returns a 32bit integer number representing the object which will\n   * be used to determine how to store the value object in a Map or Set. You must\n   * provide both or neither methods, one must not exist without the other.\n   *\n   * Also, an important relationship between these methods must be upheld: if two\n   * values are equal, they *must* return the same hashCode. If the values are not\n   * equal, they might have the same hashCode; this is called a hash collision,\n   * and while undesirable for performance reasons, it is acceptable.\n   *\n   *     if (a.equals(b)) {\n   *       assert( a.hashCode() === b.hashCode() );\n   *     }\n   *\n   * All Immutable collections implement `equals` and `hashCode`.\n   *\n   */\n  function is(valueA, valueB) {\n    if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n      return true;\n    }\n    if (!valueA || !valueB) {\n      return false;\n    }\n    if (typeof valueA.valueOf === 'function' &&\n        typeof valueB.valueOf === 'function') {\n      valueA = valueA.valueOf();\n      valueB = valueB.valueOf();\n      if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n        return true;\n      }\n      if (!valueA || !valueB) {\n        return false;\n      }\n    }\n    if (typeof valueA.equals === 'function' &&\n        typeof valueB.equals === 'function' &&\n        valueA.equals(valueB)) {\n      return true;\n    }\n    return false;\n  }\n\n  function deepEqual(a, b) {\n    if (a === b) {\n      return true;\n    }\n\n    if (\n      !isIterable(b) ||\n      a.size !== undefined && b.size !== undefined && a.size !== b.size ||\n      a.__hash !== undefined && b.__hash !== undefined && a.__hash !== b.__hash ||\n      isKeyed(a) !== isKeyed(b) ||\n      isIndexed(a) !== isIndexed(b) ||\n      isOrdered(a) !== isOrdered(b)\n    ) {\n      return false;\n    }\n\n    if (a.size === 0 && b.size === 0) {\n      return true;\n    }\n\n    var notAssociative = !isAssociative(a);\n\n    if (isOrdered(a)) {\n      var entries = a.entries();\n      return b.every(function(v, k)  {\n        var entry = entries.next().value;\n        return entry && is(entry[1], v) && (notAssociative || is(entry[0], k));\n      }) && entries.next().done;\n    }\n\n    var flipped = false;\n\n    if (a.size === undefined) {\n      if (b.size === undefined) {\n        if (typeof a.cacheResult === 'function') {\n          a.cacheResult();\n        }\n      } else {\n        flipped = true;\n        var _ = a;\n        a = b;\n        b = _;\n      }\n    }\n\n    var allEqual = true;\n    var bSize = b.__iterate(function(v, k)  {\n      if (notAssociative ? !a.has(v) :\n          flipped ? !is(v, a.get(k, NOT_SET)) : !is(a.get(k, NOT_SET), v)) {\n        allEqual = false;\n        return false;\n      }\n    });\n\n    return allEqual && a.size === bSize;\n  }\n\n  createClass(Repeat, IndexedSeq);\n\n    function Repeat(value, times) {\n      if (!(this instanceof Repeat)) {\n        return new Repeat(value, times);\n      }\n      this._value = value;\n      this.size = times === undefined ? Infinity : Math.max(0, times);\n      if (this.size === 0) {\n        if (EMPTY_REPEAT) {\n          return EMPTY_REPEAT;\n        }\n        EMPTY_REPEAT = this;\n      }\n    }\n\n    Repeat.prototype.toString = function() {\n      if (this.size === 0) {\n        return 'Repeat []';\n      }\n      return 'Repeat [ ' + this._value + ' ' + this.size + ' times ]';\n    };\n\n    Repeat.prototype.get = function(index, notSetValue) {\n      return this.has(index) ? this._value : notSetValue;\n    };\n\n    Repeat.prototype.includes = function(searchValue) {\n      return is(this._value, searchValue);\n    };\n\n    Repeat.prototype.slice = function(begin, end) {\n      var size = this.size;\n      return wholeSlice(begin, end, size) ? this :\n        new Repeat(this._value, resolveEnd(end, size) - resolveBegin(begin, size));\n    };\n\n    Repeat.prototype.reverse = function() {\n      return this;\n    };\n\n    Repeat.prototype.indexOf = function(searchValue) {\n      if (is(this._value, searchValue)) {\n        return 0;\n      }\n      return -1;\n    };\n\n    Repeat.prototype.lastIndexOf = function(searchValue) {\n      if (is(this._value, searchValue)) {\n        return this.size;\n      }\n      return -1;\n    };\n\n    Repeat.prototype.__iterate = function(fn, reverse) {\n      for (var ii = 0; ii < this.size; ii++) {\n        if (fn(this._value, ii, this) === false) {\n          return ii + 1;\n        }\n      }\n      return ii;\n    };\n\n    Repeat.prototype.__iterator = function(type, reverse) {var this$0 = this;\n      var ii = 0;\n      return new Iterator(function() \n        {return ii < this$0.size ? iteratorValue(type, ii++, this$0._value) : iteratorDone()}\n      );\n    };\n\n    Repeat.prototype.equals = function(other) {\n      return other instanceof Repeat ?\n        is(this._value, other._value) :\n        deepEqual(other);\n    };\n\n\n  var EMPTY_REPEAT;\n\n  function invariant(condition, error) {\n    if (!condition) throw new Error(error);\n  }\n\n  createClass(Range, IndexedSeq);\n\n    function Range(start, end, step) {\n      if (!(this instanceof Range)) {\n        return new Range(start, end, step);\n      }\n      invariant(step !== 0, 'Cannot step a Range by 0');\n      start = start || 0;\n      if (end === undefined) {\n        end = Infinity;\n      }\n      step = step === undefined ? 1 : Math.abs(step);\n      if (end < start) {\n        step = -step;\n      }\n      this._start = start;\n      this._end = end;\n      this._step = step;\n      this.size = Math.max(0, Math.ceil((end - start) / step - 1) + 1);\n      if (this.size === 0) {\n        if (EMPTY_RANGE) {\n          return EMPTY_RANGE;\n        }\n        EMPTY_RANGE = this;\n      }\n    }\n\n    Range.prototype.toString = function() {\n      if (this.size === 0) {\n        return 'Range []';\n      }\n      return 'Range [ ' +\n        this._start + '...' + this._end +\n        (this._step !== 1 ? ' by ' + this._step : '') +\n      ' ]';\n    };\n\n    Range.prototype.get = function(index, notSetValue) {\n      return this.has(index) ?\n        this._start + wrapIndex(this, index) * this._step :\n        notSetValue;\n    };\n\n    Range.prototype.includes = function(searchValue) {\n      var possibleIndex = (searchValue - this._start) / this._step;\n      return possibleIndex >= 0 &&\n        possibleIndex < this.size &&\n        possibleIndex === Math.floor(possibleIndex);\n    };\n\n    Range.prototype.slice = function(begin, end) {\n      if (wholeSlice(begin, end, this.size)) {\n        return this;\n      }\n      begin = resolveBegin(begin, this.size);\n      end = resolveEnd(end, this.size);\n      if (end <= begin) {\n        return new Range(0, 0);\n      }\n      return new Range(this.get(begin, this._end), this.get(end, this._end), this._step);\n    };\n\n    Range.prototype.indexOf = function(searchValue) {\n      var offsetValue = searchValue - this._start;\n      if (offsetValue % this._step === 0) {\n        var index = offsetValue / this._step;\n        if (index >= 0 && index < this.size) {\n          return index\n        }\n      }\n      return -1;\n    };\n\n    Range.prototype.lastIndexOf = function(searchValue) {\n      return this.indexOf(searchValue);\n    };\n\n    Range.prototype.__iterate = function(fn, reverse) {\n      var maxIndex = this.size - 1;\n      var step = this._step;\n      var value = reverse ? this._start + maxIndex * step : this._start;\n      for (var ii = 0; ii <= maxIndex; ii++) {\n        if (fn(value, ii, this) === false) {\n          return ii + 1;\n        }\n        value += reverse ? -step : step;\n      }\n      return ii;\n    };\n\n    Range.prototype.__iterator = function(type, reverse) {\n      var maxIndex = this.size - 1;\n      var step = this._step;\n      var value = reverse ? this._start + maxIndex * step : this._start;\n      var ii = 0;\n      return new Iterator(function()  {\n        var v = value;\n        value += reverse ? -step : step;\n        return ii > maxIndex ? iteratorDone() : iteratorValue(type, ii++, v);\n      });\n    };\n\n    Range.prototype.equals = function(other) {\n      return other instanceof Range ?\n        this._start === other._start &&\n        this._end === other._end &&\n        this._step === other._step :\n        deepEqual(this, other);\n    };\n\n\n  var EMPTY_RANGE;\n\n  createClass(Collection, Iterable);\n    function Collection() {\n      throw TypeError('Abstract');\n    }\n\n\n  createClass(KeyedCollection, Collection);function KeyedCollection() {}\n\n  createClass(IndexedCollection, Collection);function IndexedCollection() {}\n\n  createClass(SetCollection, Collection);function SetCollection() {}\n\n\n  Collection.Keyed = KeyedCollection;\n  Collection.Indexed = IndexedCollection;\n  Collection.Set = SetCollection;\n\n  var imul =\n    typeof Math.imul === 'function' && Math.imul(0xffffffff, 2) === -2 ?\n    Math.imul :\n    function imul(a, b) {\n      a = a | 0; // int\n      b = b | 0; // int\n      var c = a & 0xffff;\n      var d = b & 0xffff;\n      // Shift by 0 fixes the sign on the high part.\n      return (c * d) + ((((a >>> 16) * d + c * (b >>> 16)) << 16) >>> 0) | 0; // int\n    };\n\n  // v8 has an optimization for storing 31-bit signed numbers.\n  // Values which have either 00 or 11 as the high order bits qualify.\n  // This function drops the highest order bit in a signed number, maintaining\n  // the sign bit.\n  function smi(i32) {\n    return ((i32 >>> 1) & 0x40000000) | (i32 & 0xBFFFFFFF);\n  }\n\n  function hash(o) {\n    if (o === false || o === null || o === undefined) {\n      return 0;\n    }\n    if (typeof o.valueOf === 'function') {\n      o = o.valueOf();\n      if (o === false || o === null || o === undefined) {\n        return 0;\n      }\n    }\n    if (o === true) {\n      return 1;\n    }\n    var type = typeof o;\n    if (type === 'number') {\n      if (o !== o || o === Infinity) {\n        return 0;\n      }\n      var h = o | 0;\n      if (h !== o) {\n        h ^= o * 0xFFFFFFFF;\n      }\n      while (o > 0xFFFFFFFF) {\n        o /= 0xFFFFFFFF;\n        h ^= o;\n      }\n      return smi(h);\n    }\n    if (type === 'string') {\n      return o.length > STRING_HASH_CACHE_MIN_STRLEN ? cachedHashString(o) : hashString(o);\n    }\n    if (typeof o.hashCode === 'function') {\n      return o.hashCode();\n    }\n    if (type === 'object') {\n      return hashJSObj(o);\n    }\n    if (typeof o.toString === 'function') {\n      return hashString(o.toString());\n    }\n    throw new Error('Value type ' + type + ' cannot be hashed.');\n  }\n\n  function cachedHashString(string) {\n    var hash = stringHashCache[string];\n    if (hash === undefined) {\n      hash = hashString(string);\n      if (STRING_HASH_CACHE_SIZE === STRING_HASH_CACHE_MAX_SIZE) {\n        STRING_HASH_CACHE_SIZE = 0;\n        stringHashCache = {};\n      }\n      STRING_HASH_CACHE_SIZE++;\n      stringHashCache[string] = hash;\n    }\n    return hash;\n  }\n\n  // http://jsperf.com/hashing-strings\n  function hashString(string) {\n    // This is the hash from JVM\n    // The hash code for a string is computed as\n    // s[0] * 31 ^ (n - 1) + s[1] * 31 ^ (n - 2) + ... + s[n - 1],\n    // where s[i] is the ith character of the string and n is the length of\n    // the string. We \"mod\" the result to make it between 0 (inclusive) and 2^31\n    // (exclusive) by dropping high bits.\n    var hash = 0;\n    for (var ii = 0; ii < string.length; ii++) {\n      hash = 31 * hash + string.charCodeAt(ii) | 0;\n    }\n    return smi(hash);\n  }\n\n  function hashJSObj(obj) {\n    var hash;\n    if (usingWeakMap) {\n      hash = weakMap.get(obj);\n      if (hash !== undefined) {\n        return hash;\n      }\n    }\n\n    hash = obj[UID_HASH_KEY];\n    if (hash !== undefined) {\n      return hash;\n    }\n\n    if (!canDefineProperty) {\n      hash = obj.propertyIsEnumerable && obj.propertyIsEnumerable[UID_HASH_KEY];\n      if (hash !== undefined) {\n        return hash;\n      }\n\n      hash = getIENodeHash(obj);\n      if (hash !== undefined) {\n        return hash;\n      }\n    }\n\n    hash = ++objHashUID;\n    if (objHashUID & 0x40000000) {\n      objHashUID = 0;\n    }\n\n    if (usingWeakMap) {\n      weakMap.set(obj, hash);\n    } else if (isExtensible !== undefined && isExtensible(obj) === false) {\n      throw new Error('Non-extensible objects are not allowed as keys.');\n    } else if (canDefineProperty) {\n      Object.defineProperty(obj, UID_HASH_KEY, {\n        'enumerable': false,\n        'configurable': false,\n        'writable': false,\n        'value': hash\n      });\n    } else if (obj.propertyIsEnumerable !== undefined &&\n               obj.propertyIsEnumerable === obj.constructor.prototype.propertyIsEnumerable) {\n      // Since we can't define a non-enumerable property on the object\n      // we'll hijack one of the less-used non-enumerable properties to\n      // save our hash on it. Since this is a function it will not show up in\n      // `JSON.stringify` which is what we want.\n      obj.propertyIsEnumerable = function() {\n        return this.constructor.prototype.propertyIsEnumerable.apply(this, arguments);\n      };\n      obj.propertyIsEnumerable[UID_HASH_KEY] = hash;\n    } else if (obj.nodeType !== undefined) {\n      // At this point we couldn't get the IE `uniqueID` to use as a hash\n      // and we couldn't use a non-enumerable property to exploit the\n      // dontEnum bug so we simply add the `UID_HASH_KEY` on the node\n      // itself.\n      obj[UID_HASH_KEY] = hash;\n    } else {\n      throw new Error('Unable to set a non-enumerable property on object.');\n    }\n\n    return hash;\n  }\n\n  // Get references to ES5 object methods.\n  var isExtensible = Object.isExtensible;\n\n  // True if Object.defineProperty works as expected. IE8 fails this test.\n  var canDefineProperty = (function() {\n    try {\n      Object.defineProperty({}, '@', {});\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }());\n\n  // IE has a `uniqueID` property on DOM nodes. We can construct the hash from it\n  // and avoid memory leaks from the IE cloneNode bug.\n  function getIENodeHash(node) {\n    if (node && node.nodeType > 0) {\n      switch (node.nodeType) {\n        case 1: // Element\n          return node.uniqueID;\n        case 9: // Document\n          return node.documentElement && node.documentElement.uniqueID;\n      }\n    }\n  }\n\n  // If possible, use a WeakMap.\n  var usingWeakMap = typeof WeakMap === 'function';\n  var weakMap;\n  if (usingWeakMap) {\n    weakMap = new WeakMap();\n  }\n\n  var objHashUID = 0;\n\n  var UID_HASH_KEY = '__immutablehash__';\n  if (typeof Symbol === 'function') {\n    UID_HASH_KEY = Symbol(UID_HASH_KEY);\n  }\n\n  var STRING_HASH_CACHE_MIN_STRLEN = 16;\n  var STRING_HASH_CACHE_MAX_SIZE = 255;\n  var STRING_HASH_CACHE_SIZE = 0;\n  var stringHashCache = {};\n\n  function assertNotInfinite(size) {\n    invariant(\n      size !== Infinity,\n      'Cannot perform this action with an infinite size.'\n    );\n  }\n\n  createClass(Map, KeyedCollection);\n\n    // @pragma Construction\n\n    function Map(value) {\n      return value === null || value === undefined ? emptyMap() :\n        isMap(value) && !isOrdered(value) ? value :\n        emptyMap().withMutations(function(map ) {\n          var iter = KeyedIterable(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function(v, k)  {return map.set(k, v)});\n        });\n    }\n\n    Map.of = function() {var keyValues = SLICE$0.call(arguments, 0);\n      return emptyMap().withMutations(function(map ) {\n        for (var i = 0; i < keyValues.length; i += 2) {\n          if (i + 1 >= keyValues.length) {\n            throw new Error('Missing value for key: ' + keyValues[i]);\n          }\n          map.set(keyValues[i], keyValues[i + 1]);\n        }\n      });\n    };\n\n    Map.prototype.toString = function() {\n      return this.__toString('Map {', '}');\n    };\n\n    // @pragma Access\n\n    Map.prototype.get = function(k, notSetValue) {\n      return this._root ?\n        this._root.get(0, undefined, k, notSetValue) :\n        notSetValue;\n    };\n\n    // @pragma Modification\n\n    Map.prototype.set = function(k, v) {\n      return updateMap(this, k, v);\n    };\n\n    Map.prototype.setIn = function(keyPath, v) {\n      return this.updateIn(keyPath, NOT_SET, function()  {return v});\n    };\n\n    Map.prototype.remove = function(k) {\n      return updateMap(this, k, NOT_SET);\n    };\n\n    Map.prototype.deleteIn = function(keyPath) {\n      return this.updateIn(keyPath, function()  {return NOT_SET});\n    };\n\n    Map.prototype.update = function(k, notSetValue, updater) {\n      return arguments.length === 1 ?\n        k(this) :\n        this.updateIn([k], notSetValue, updater);\n    };\n\n    Map.prototype.updateIn = function(keyPath, notSetValue, updater) {\n      if (!updater) {\n        updater = notSetValue;\n        notSetValue = undefined;\n      }\n      var updatedValue = updateInDeepMap(\n        this,\n        forceIterator(keyPath),\n        notSetValue,\n        updater\n      );\n      return updatedValue === NOT_SET ? undefined : updatedValue;\n    };\n\n    Map.prototype.clear = function() {\n      if (this.size === 0) {\n        return this;\n      }\n      if (this.__ownerID) {\n        this.size = 0;\n        this._root = null;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return emptyMap();\n    };\n\n    // @pragma Composition\n\n    Map.prototype.merge = function(/*...iters*/) {\n      return mergeIntoMapWith(this, undefined, arguments);\n    };\n\n    Map.prototype.mergeWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return mergeIntoMapWith(this, merger, iters);\n    };\n\n    Map.prototype.mergeIn = function(keyPath) {var iters = SLICE$0.call(arguments, 1);\n      return this.updateIn(\n        keyPath,\n        emptyMap(),\n        function(m ) {return typeof m.merge === 'function' ?\n          m.merge.apply(m, iters) :\n          iters[iters.length - 1]}\n      );\n    };\n\n    Map.prototype.mergeDeep = function(/*...iters*/) {\n      return mergeIntoMapWith(this, deepMerger, arguments);\n    };\n\n    Map.prototype.mergeDeepWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return mergeIntoMapWith(this, deepMergerWith(merger), iters);\n    };\n\n    Map.prototype.mergeDeepIn = function(keyPath) {var iters = SLICE$0.call(arguments, 1);\n      return this.updateIn(\n        keyPath,\n        emptyMap(),\n        function(m ) {return typeof m.mergeDeep === 'function' ?\n          m.mergeDeep.apply(m, iters) :\n          iters[iters.length - 1]}\n      );\n    };\n\n    Map.prototype.sort = function(comparator) {\n      // Late binding\n      return OrderedMap(sortFactory(this, comparator));\n    };\n\n    Map.prototype.sortBy = function(mapper, comparator) {\n      // Late binding\n      return OrderedMap(sortFactory(this, comparator, mapper));\n    };\n\n    // @pragma Mutability\n\n    Map.prototype.withMutations = function(fn) {\n      var mutable = this.asMutable();\n      fn(mutable);\n      return mutable.wasAltered() ? mutable.__ensureOwner(this.__ownerID) : this;\n    };\n\n    Map.prototype.asMutable = function() {\n      return this.__ownerID ? this : this.__ensureOwner(new OwnerID());\n    };\n\n    Map.prototype.asImmutable = function() {\n      return this.__ensureOwner();\n    };\n\n    Map.prototype.wasAltered = function() {\n      return this.__altered;\n    };\n\n    Map.prototype.__iterator = function(type, reverse) {\n      return new MapIterator(this, type, reverse);\n    };\n\n    Map.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      var iterations = 0;\n      this._root && this._root.iterate(function(entry ) {\n        iterations++;\n        return fn(entry[1], entry[0], this$0);\n      }, reverse);\n      return iterations;\n    };\n\n    Map.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this.__altered = false;\n        return this;\n      }\n      return makeMap(this.size, this._root, ownerID, this.__hash);\n    };\n\n\n  function isMap(maybeMap) {\n    return !!(maybeMap && maybeMap[IS_MAP_SENTINEL]);\n  }\n\n  Map.isMap = isMap;\n\n  var IS_MAP_SENTINEL = '@@__IMMUTABLE_MAP__@@';\n\n  var MapPrototype = Map.prototype;\n  MapPrototype[IS_MAP_SENTINEL] = true;\n  MapPrototype[DELETE] = MapPrototype.remove;\n  MapPrototype.removeIn = MapPrototype.deleteIn;\n\n\n  // #pragma Trie Nodes\n\n\n\n    function ArrayMapNode(ownerID, entries) {\n      this.ownerID = ownerID;\n      this.entries = entries;\n    }\n\n    ArrayMapNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      var entries = this.entries;\n      for (var ii = 0, len = entries.length; ii < len; ii++) {\n        if (is(key, entries[ii][0])) {\n          return entries[ii][1];\n        }\n      }\n      return notSetValue;\n    };\n\n    ArrayMapNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      var removed = value === NOT_SET;\n\n      var entries = this.entries;\n      var idx = 0;\n      for (var len = entries.length; idx < len; idx++) {\n        if (is(key, entries[idx][0])) {\n          break;\n        }\n      }\n      var exists = idx < len;\n\n      if (exists ? entries[idx][1] === value : removed) {\n        return this;\n      }\n\n      SetRef(didAlter);\n      (removed || !exists) && SetRef(didChangeSize);\n\n      if (removed && entries.length === 1) {\n        return; // undefined\n      }\n\n      if (!exists && !removed && entries.length >= MAX_ARRAY_MAP_SIZE) {\n        return createNodes(ownerID, entries, key, value);\n      }\n\n      var isEditable = ownerID && ownerID === this.ownerID;\n      var newEntries = isEditable ? entries : arrCopy(entries);\n\n      if (exists) {\n        if (removed) {\n          idx === len - 1 ? newEntries.pop() : (newEntries[idx] = newEntries.pop());\n        } else {\n          newEntries[idx] = [key, value];\n        }\n      } else {\n        newEntries.push([key, value]);\n      }\n\n      if (isEditable) {\n        this.entries = newEntries;\n        return this;\n      }\n\n      return new ArrayMapNode(ownerID, newEntries);\n    };\n\n\n\n\n    function BitmapIndexedNode(ownerID, bitmap, nodes) {\n      this.ownerID = ownerID;\n      this.bitmap = bitmap;\n      this.nodes = nodes;\n    }\n\n    BitmapIndexedNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n      var bit = (1 << ((shift === 0 ? keyHash : keyHash >>> shift) & MASK));\n      var bitmap = this.bitmap;\n      return (bitmap & bit) === 0 ? notSetValue :\n        this.nodes[popCount(bitmap & (bit - 1))].get(shift + SHIFT, keyHash, key, notSetValue);\n    };\n\n    BitmapIndexedNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n      var keyHashFrag = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n      var bit = 1 << keyHashFrag;\n      var bitmap = this.bitmap;\n      var exists = (bitmap & bit) !== 0;\n\n      if (!exists && value === NOT_SET) {\n        return this;\n      }\n\n      var idx = popCount(bitmap & (bit - 1));\n      var nodes = this.nodes;\n      var node = exists ? nodes[idx] : undefined;\n      var newNode = updateNode(node, ownerID, shift + SHIFT, keyHash, key, value, didChangeSize, didAlter);\n\n      if (newNode === node) {\n        return this;\n      }\n\n      if (!exists && newNode && nodes.length >= MAX_BITMAP_INDEXED_SIZE) {\n        return expandNodes(ownerID, nodes, bitmap, keyHashFrag, newNode);\n      }\n\n      if (exists && !newNode && nodes.length === 2 && isLeafNode(nodes[idx ^ 1])) {\n        return nodes[idx ^ 1];\n      }\n\n      if (exists && newNode && nodes.length === 1 && isLeafNode(newNode)) {\n        return newNode;\n      }\n\n      var isEditable = ownerID && ownerID === this.ownerID;\n      var newBitmap = exists ? newNode ? bitmap : bitmap ^ bit : bitmap | bit;\n      var newNodes = exists ? newNode ?\n        setIn(nodes, idx, newNode, isEditable) :\n        spliceOut(nodes, idx, isEditable) :\n        spliceIn(nodes, idx, newNode, isEditable);\n\n      if (isEditable) {\n        this.bitmap = newBitmap;\n        this.nodes = newNodes;\n        return this;\n      }\n\n      return new BitmapIndexedNode(ownerID, newBitmap, newNodes);\n    };\n\n\n\n\n    function HashArrayMapNode(ownerID, count, nodes) {\n      this.ownerID = ownerID;\n      this.count = count;\n      this.nodes = nodes;\n    }\n\n    HashArrayMapNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n      var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n      var node = this.nodes[idx];\n      return node ? node.get(shift + SHIFT, keyHash, key, notSetValue) : notSetValue;\n    };\n\n    HashArrayMapNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n      var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n      var removed = value === NOT_SET;\n      var nodes = this.nodes;\n      var node = nodes[idx];\n\n      if (removed && !node) {\n        return this;\n      }\n\n      var newNode = updateNode(node, ownerID, shift + SHIFT, keyHash, key, value, didChangeSize, didAlter);\n      if (newNode === node) {\n        return this;\n      }\n\n      var newCount = this.count;\n      if (!node) {\n        newCount++;\n      } else if (!newNode) {\n        newCount--;\n        if (newCount < MIN_HASH_ARRAY_MAP_SIZE) {\n          return packNodes(ownerID, nodes, newCount, idx);\n        }\n      }\n\n      var isEditable = ownerID && ownerID === this.ownerID;\n      var newNodes = setIn(nodes, idx, newNode, isEditable);\n\n      if (isEditable) {\n        this.count = newCount;\n        this.nodes = newNodes;\n        return this;\n      }\n\n      return new HashArrayMapNode(ownerID, newCount, newNodes);\n    };\n\n\n\n\n    function HashCollisionNode(ownerID, keyHash, entries) {\n      this.ownerID = ownerID;\n      this.keyHash = keyHash;\n      this.entries = entries;\n    }\n\n    HashCollisionNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      var entries = this.entries;\n      for (var ii = 0, len = entries.length; ii < len; ii++) {\n        if (is(key, entries[ii][0])) {\n          return entries[ii][1];\n        }\n      }\n      return notSetValue;\n    };\n\n    HashCollisionNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n\n      var removed = value === NOT_SET;\n\n      if (keyHash !== this.keyHash) {\n        if (removed) {\n          return this;\n        }\n        SetRef(didAlter);\n        SetRef(didChangeSize);\n        return mergeIntoNode(this, ownerID, shift, keyHash, [key, value]);\n      }\n\n      var entries = this.entries;\n      var idx = 0;\n      for (var len = entries.length; idx < len; idx++) {\n        if (is(key, entries[idx][0])) {\n          break;\n        }\n      }\n      var exists = idx < len;\n\n      if (exists ? entries[idx][1] === value : removed) {\n        return this;\n      }\n\n      SetRef(didAlter);\n      (removed || !exists) && SetRef(didChangeSize);\n\n      if (removed && len === 2) {\n        return new ValueNode(ownerID, this.keyHash, entries[idx ^ 1]);\n      }\n\n      var isEditable = ownerID && ownerID === this.ownerID;\n      var newEntries = isEditable ? entries : arrCopy(entries);\n\n      if (exists) {\n        if (removed) {\n          idx === len - 1 ? newEntries.pop() : (newEntries[idx] = newEntries.pop());\n        } else {\n          newEntries[idx] = [key, value];\n        }\n      } else {\n        newEntries.push([key, value]);\n      }\n\n      if (isEditable) {\n        this.entries = newEntries;\n        return this;\n      }\n\n      return new HashCollisionNode(ownerID, this.keyHash, newEntries);\n    };\n\n\n\n\n    function ValueNode(ownerID, keyHash, entry) {\n      this.ownerID = ownerID;\n      this.keyHash = keyHash;\n      this.entry = entry;\n    }\n\n    ValueNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      return is(key, this.entry[0]) ? this.entry[1] : notSetValue;\n    };\n\n    ValueNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      var removed = value === NOT_SET;\n      var keyMatch = is(key, this.entry[0]);\n      if (keyMatch ? value === this.entry[1] : removed) {\n        return this;\n      }\n\n      SetRef(didAlter);\n\n      if (removed) {\n        SetRef(didChangeSize);\n        return; // undefined\n      }\n\n      if (keyMatch) {\n        if (ownerID && ownerID === this.ownerID) {\n          this.entry[1] = value;\n          return this;\n        }\n        return new ValueNode(ownerID, this.keyHash, [key, value]);\n      }\n\n      SetRef(didChangeSize);\n      return mergeIntoNode(this, ownerID, shift, hash(key), [key, value]);\n    };\n\n\n\n  // #pragma Iterators\n\n  ArrayMapNode.prototype.iterate =\n  HashCollisionNode.prototype.iterate = function (fn, reverse) {\n    var entries = this.entries;\n    for (var ii = 0, maxIndex = entries.length - 1; ii <= maxIndex; ii++) {\n      if (fn(entries[reverse ? maxIndex - ii : ii]) === false) {\n        return false;\n      }\n    }\n  }\n\n  BitmapIndexedNode.prototype.iterate =\n  HashArrayMapNode.prototype.iterate = function (fn, reverse) {\n    var nodes = this.nodes;\n    for (var ii = 0, maxIndex = nodes.length - 1; ii <= maxIndex; ii++) {\n      var node = nodes[reverse ? maxIndex - ii : ii];\n      if (node && node.iterate(fn, reverse) === false) {\n        return false;\n      }\n    }\n  }\n\n  ValueNode.prototype.iterate = function (fn, reverse) {\n    return fn(this.entry);\n  }\n\n  createClass(MapIterator, Iterator);\n\n    function MapIterator(map, type, reverse) {\n      this._type = type;\n      this._reverse = reverse;\n      this._stack = map._root && mapIteratorFrame(map._root);\n    }\n\n    MapIterator.prototype.next = function() {\n      var type = this._type;\n      var stack = this._stack;\n      while (stack) {\n        var node = stack.node;\n        var index = stack.index++;\n        var maxIndex;\n        if (node.entry) {\n          if (index === 0) {\n            return mapIteratorValue(type, node.entry);\n          }\n        } else if (node.entries) {\n          maxIndex = node.entries.length - 1;\n          if (index <= maxIndex) {\n            return mapIteratorValue(type, node.entries[this._reverse ? maxIndex - index : index]);\n          }\n        } else {\n          maxIndex = node.nodes.length - 1;\n          if (index <= maxIndex) {\n            var subNode = node.nodes[this._reverse ? maxIndex - index : index];\n            if (subNode) {\n              if (subNode.entry) {\n                return mapIteratorValue(type, subNode.entry);\n              }\n              stack = this._stack = mapIteratorFrame(subNode, stack);\n            }\n            continue;\n          }\n        }\n        stack = this._stack = this._stack.__prev;\n      }\n      return iteratorDone();\n    };\n\n\n  function mapIteratorValue(type, entry) {\n    return iteratorValue(type, entry[0], entry[1]);\n  }\n\n  function mapIteratorFrame(node, prev) {\n    return {\n      node: node,\n      index: 0,\n      __prev: prev\n    };\n  }\n\n  function makeMap(size, root, ownerID, hash) {\n    var map = Object.create(MapPrototype);\n    map.size = size;\n    map._root = root;\n    map.__ownerID = ownerID;\n    map.__hash = hash;\n    map.__altered = false;\n    return map;\n  }\n\n  var EMPTY_MAP;\n  function emptyMap() {\n    return EMPTY_MAP || (EMPTY_MAP = makeMap(0));\n  }\n\n  function updateMap(map, k, v) {\n    var newRoot;\n    var newSize;\n    if (!map._root) {\n      if (v === NOT_SET) {\n        return map;\n      }\n      newSize = 1;\n      newRoot = new ArrayMapNode(map.__ownerID, [[k, v]]);\n    } else {\n      var didChangeSize = MakeRef(CHANGE_LENGTH);\n      var didAlter = MakeRef(DID_ALTER);\n      newRoot = updateNode(map._root, map.__ownerID, 0, undefined, k, v, didChangeSize, didAlter);\n      if (!didAlter.value) {\n        return map;\n      }\n      newSize = map.size + (didChangeSize.value ? v === NOT_SET ? -1 : 1 : 0);\n    }\n    if (map.__ownerID) {\n      map.size = newSize;\n      map._root = newRoot;\n      map.__hash = undefined;\n      map.__altered = true;\n      return map;\n    }\n    return newRoot ? makeMap(newSize, newRoot) : emptyMap();\n  }\n\n  function updateNode(node, ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n    if (!node) {\n      if (value === NOT_SET) {\n        return node;\n      }\n      SetRef(didAlter);\n      SetRef(didChangeSize);\n      return new ValueNode(ownerID, keyHash, [key, value]);\n    }\n    return node.update(ownerID, shift, keyHash, key, value, didChangeSize, didAlter);\n  }\n\n  function isLeafNode(node) {\n    return node.constructor === ValueNode || node.constructor === HashCollisionNode;\n  }\n\n  function mergeIntoNode(node, ownerID, shift, keyHash, entry) {\n    if (node.keyHash === keyHash) {\n      return new HashCollisionNode(ownerID, keyHash, [node.entry, entry]);\n    }\n\n    var idx1 = (shift === 0 ? node.keyHash : node.keyHash >>> shift) & MASK;\n    var idx2 = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n\n    var newNode;\n    var nodes = idx1 === idx2 ?\n      [mergeIntoNode(node, ownerID, shift + SHIFT, keyHash, entry)] :\n      ((newNode = new ValueNode(ownerID, keyHash, entry)), idx1 < idx2 ? [node, newNode] : [newNode, node]);\n\n    return new BitmapIndexedNode(ownerID, (1 << idx1) | (1 << idx2), nodes);\n  }\n\n  function createNodes(ownerID, entries, key, value) {\n    if (!ownerID) {\n      ownerID = new OwnerID();\n    }\n    var node = new ValueNode(ownerID, hash(key), [key, value]);\n    for (var ii = 0; ii < entries.length; ii++) {\n      var entry = entries[ii];\n      node = node.update(ownerID, 0, undefined, entry[0], entry[1]);\n    }\n    return node;\n  }\n\n  function packNodes(ownerID, nodes, count, excluding) {\n    var bitmap = 0;\n    var packedII = 0;\n    var packedNodes = new Array(count);\n    for (var ii = 0, bit = 1, len = nodes.length; ii < len; ii++, bit <<= 1) {\n      var node = nodes[ii];\n      if (node !== undefined && ii !== excluding) {\n        bitmap |= bit;\n        packedNodes[packedII++] = node;\n      }\n    }\n    return new BitmapIndexedNode(ownerID, bitmap, packedNodes);\n  }\n\n  function expandNodes(ownerID, nodes, bitmap, including, node) {\n    var count = 0;\n    var expandedNodes = new Array(SIZE);\n    for (var ii = 0; bitmap !== 0; ii++, bitmap >>>= 1) {\n      expandedNodes[ii] = bitmap & 1 ? nodes[count++] : undefined;\n    }\n    expandedNodes[including] = node;\n    return new HashArrayMapNode(ownerID, count + 1, expandedNodes);\n  }\n\n  function mergeIntoMapWith(map, merger, iterables) {\n    var iters = [];\n    for (var ii = 0; ii < iterables.length; ii++) {\n      var value = iterables[ii];\n      var iter = KeyedIterable(value);\n      if (!isIterable(value)) {\n        iter = iter.map(function(v ) {return fromJS(v)});\n      }\n      iters.push(iter);\n    }\n    return mergeIntoCollectionWith(map, merger, iters);\n  }\n\n  function deepMerger(existing, value, key) {\n    return existing && existing.mergeDeep && isIterable(value) ?\n      existing.mergeDeep(value) :\n      is(existing, value) ? existing : value;\n  }\n\n  function deepMergerWith(merger) {\n    return function(existing, value, key)  {\n      if (existing && existing.mergeDeepWith && isIterable(value)) {\n        return existing.mergeDeepWith(merger, value);\n      }\n      var nextValue = merger(existing, value, key);\n      return is(existing, nextValue) ? existing : nextValue;\n    };\n  }\n\n  function mergeIntoCollectionWith(collection, merger, iters) {\n    iters = iters.filter(function(x ) {return x.size !== 0});\n    if (iters.length === 0) {\n      return collection;\n    }\n    if (collection.size === 0 && !collection.__ownerID && iters.length === 1) {\n      return collection.constructor(iters[0]);\n    }\n    return collection.withMutations(function(collection ) {\n      var mergeIntoMap = merger ?\n        function(value, key)  {\n          collection.update(key, NOT_SET, function(existing )\n            {return existing === NOT_SET ? value : merger(existing, value, key)}\n          );\n        } :\n        function(value, key)  {\n          collection.set(key, value);\n        }\n      for (var ii = 0; ii < iters.length; ii++) {\n        iters[ii].forEach(mergeIntoMap);\n      }\n    });\n  }\n\n  function updateInDeepMap(existing, keyPathIter, notSetValue, updater) {\n    var isNotSet = existing === NOT_SET;\n    var step = keyPathIter.next();\n    if (step.done) {\n      var existingValue = isNotSet ? notSetValue : existing;\n      var newValue = updater(existingValue);\n      return newValue === existingValue ? existing : newValue;\n    }\n    invariant(\n      isNotSet || (existing && existing.set),\n      'invalid keyPath'\n    );\n    var key = step.value;\n    var nextExisting = isNotSet ? NOT_SET : existing.get(key, NOT_SET);\n    var nextUpdated = updateInDeepMap(\n      nextExisting,\n      keyPathIter,\n      notSetValue,\n      updater\n    );\n    return nextUpdated === nextExisting ? existing :\n      nextUpdated === NOT_SET ? existing.remove(key) :\n      (isNotSet ? emptyMap() : existing).set(key, nextUpdated);\n  }\n\n  function popCount(x) {\n    x = x - ((x >> 1) & 0x55555555);\n    x = (x & 0x33333333) + ((x >> 2) & 0x33333333);\n    x = (x + (x >> 4)) & 0x0f0f0f0f;\n    x = x + (x >> 8);\n    x = x + (x >> 16);\n    return x & 0x7f;\n  }\n\n  function setIn(array, idx, val, canEdit) {\n    var newArray = canEdit ? array : arrCopy(array);\n    newArray[idx] = val;\n    return newArray;\n  }\n\n  function spliceIn(array, idx, val, canEdit) {\n    var newLen = array.length + 1;\n    if (canEdit && idx + 1 === newLen) {\n      array[idx] = val;\n      return array;\n    }\n    var newArray = new Array(newLen);\n    var after = 0;\n    for (var ii = 0; ii < newLen; ii++) {\n      if (ii === idx) {\n        newArray[ii] = val;\n        after = -1;\n      } else {\n        newArray[ii] = array[ii + after];\n      }\n    }\n    return newArray;\n  }\n\n  function spliceOut(array, idx, canEdit) {\n    var newLen = array.length - 1;\n    if (canEdit && idx === newLen) {\n      array.pop();\n      return array;\n    }\n    var newArray = new Array(newLen);\n    var after = 0;\n    for (var ii = 0; ii < newLen; ii++) {\n      if (ii === idx) {\n        after = 1;\n      }\n      newArray[ii] = array[ii + after];\n    }\n    return newArray;\n  }\n\n  var MAX_ARRAY_MAP_SIZE = SIZE / 4;\n  var MAX_BITMAP_INDEXED_SIZE = SIZE / 2;\n  var MIN_HASH_ARRAY_MAP_SIZE = SIZE / 4;\n\n  createClass(List, IndexedCollection);\n\n    // @pragma Construction\n\n    function List(value) {\n      var empty = emptyList();\n      if (value === null || value === undefined) {\n        return empty;\n      }\n      if (isList(value)) {\n        return value;\n      }\n      var iter = IndexedIterable(value);\n      var size = iter.size;\n      if (size === 0) {\n        return empty;\n      }\n      assertNotInfinite(size);\n      if (size > 0 && size < SIZE) {\n        return makeList(0, size, SHIFT, null, new VNode(iter.toArray()));\n      }\n      return empty.withMutations(function(list ) {\n        list.setSize(size);\n        iter.forEach(function(v, i)  {return list.set(i, v)});\n      });\n    }\n\n    List.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    List.prototype.toString = function() {\n      return this.__toString('List [', ']');\n    };\n\n    // @pragma Access\n\n    List.prototype.get = function(index, notSetValue) {\n      index = wrapIndex(this, index);\n      if (index >= 0 && index < this.size) {\n        index += this._origin;\n        var node = listNodeFor(this, index);\n        return node && node.array[index & MASK];\n      }\n      return notSetValue;\n    };\n\n    // @pragma Modification\n\n    List.prototype.set = function(index, value) {\n      return updateList(this, index, value);\n    };\n\n    List.prototype.remove = function(index) {\n      return !this.has(index) ? this :\n        index === 0 ? this.shift() :\n        index === this.size - 1 ? this.pop() :\n        this.splice(index, 1);\n    };\n\n    List.prototype.insert = function(index, value) {\n      return this.splice(index, 0, value);\n    };\n\n    List.prototype.clear = function() {\n      if (this.size === 0) {\n        return this;\n      }\n      if (this.__ownerID) {\n        this.size = this._origin = this._capacity = 0;\n        this._level = SHIFT;\n        this._root = this._tail = null;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return emptyList();\n    };\n\n    List.prototype.push = function(/*...values*/) {\n      var values = arguments;\n      var oldSize = this.size;\n      return this.withMutations(function(list ) {\n        setListBounds(list, 0, oldSize + values.length);\n        for (var ii = 0; ii < values.length; ii++) {\n          list.set(oldSize + ii, values[ii]);\n        }\n      });\n    };\n\n    List.prototype.pop = function() {\n      return setListBounds(this, 0, -1);\n    };\n\n    List.prototype.unshift = function(/*...values*/) {\n      var values = arguments;\n      return this.withMutations(function(list ) {\n        setListBounds(list, -values.length);\n        for (var ii = 0; ii < values.length; ii++) {\n          list.set(ii, values[ii]);\n        }\n      });\n    };\n\n    List.prototype.shift = function() {\n      return setListBounds(this, 1);\n    };\n\n    // @pragma Composition\n\n    List.prototype.merge = function(/*...iters*/) {\n      return mergeIntoListWith(this, undefined, arguments);\n    };\n\n    List.prototype.mergeWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return mergeIntoListWith(this, merger, iters);\n    };\n\n    List.prototype.mergeDeep = function(/*...iters*/) {\n      return mergeIntoListWith(this, deepMerger, arguments);\n    };\n\n    List.prototype.mergeDeepWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return mergeIntoListWith(this, deepMergerWith(merger), iters);\n    };\n\n    List.prototype.setSize = function(size) {\n      return setListBounds(this, 0, size);\n    };\n\n    // @pragma Iteration\n\n    List.prototype.slice = function(begin, end) {\n      var size = this.size;\n      if (wholeSlice(begin, end, size)) {\n        return this;\n      }\n      return setListBounds(\n        this,\n        resolveBegin(begin, size),\n        resolveEnd(end, size)\n      );\n    };\n\n    List.prototype.__iterator = function(type, reverse) {\n      var index = 0;\n      var values = iterateList(this, reverse);\n      return new Iterator(function()  {\n        var value = values();\n        return value === DONE ?\n          iteratorDone() :\n          iteratorValue(type, index++, value);\n      });\n    };\n\n    List.prototype.__iterate = function(fn, reverse) {\n      var index = 0;\n      var values = iterateList(this, reverse);\n      var value;\n      while ((value = values()) !== DONE) {\n        if (fn(value, index++, this) === false) {\n          break;\n        }\n      }\n      return index;\n    };\n\n    List.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        return this;\n      }\n      return makeList(this._origin, this._capacity, this._level, this._root, this._tail, ownerID, this.__hash);\n    };\n\n\n  function isList(maybeList) {\n    return !!(maybeList && maybeList[IS_LIST_SENTINEL]);\n  }\n\n  List.isList = isList;\n\n  var IS_LIST_SENTINEL = '@@__IMMUTABLE_LIST__@@';\n\n  var ListPrototype = List.prototype;\n  ListPrototype[IS_LIST_SENTINEL] = true;\n  ListPrototype[DELETE] = ListPrototype.remove;\n  ListPrototype.setIn = MapPrototype.setIn;\n  ListPrototype.deleteIn =\n  ListPrototype.removeIn = MapPrototype.removeIn;\n  ListPrototype.update = MapPrototype.update;\n  ListPrototype.updateIn = MapPrototype.updateIn;\n  ListPrototype.mergeIn = MapPrototype.mergeIn;\n  ListPrototype.mergeDeepIn = MapPrototype.mergeDeepIn;\n  ListPrototype.withMutations = MapPrototype.withMutations;\n  ListPrototype.asMutable = MapPrototype.asMutable;\n  ListPrototype.asImmutable = MapPrototype.asImmutable;\n  ListPrototype.wasAltered = MapPrototype.wasAltered;\n\n\n\n    function VNode(array, ownerID) {\n      this.array = array;\n      this.ownerID = ownerID;\n    }\n\n    // TODO: seems like these methods are very similar\n\n    VNode.prototype.removeBefore = function(ownerID, level, index) {\n      if (index === level ? 1 << level : 0 || this.array.length === 0) {\n        return this;\n      }\n      var originIndex = (index >>> level) & MASK;\n      if (originIndex >= this.array.length) {\n        return new VNode([], ownerID);\n      }\n      var removingFirst = originIndex === 0;\n      var newChild;\n      if (level > 0) {\n        var oldChild = this.array[originIndex];\n        newChild = oldChild && oldChild.removeBefore(ownerID, level - SHIFT, index);\n        if (newChild === oldChild && removingFirst) {\n          return this;\n        }\n      }\n      if (removingFirst && !newChild) {\n        return this;\n      }\n      var editable = editableVNode(this, ownerID);\n      if (!removingFirst) {\n        for (var ii = 0; ii < originIndex; ii++) {\n          editable.array[ii] = undefined;\n        }\n      }\n      if (newChild) {\n        editable.array[originIndex] = newChild;\n      }\n      return editable;\n    };\n\n    VNode.prototype.removeAfter = function(ownerID, level, index) {\n      if (index === (level ? 1 << level : 0) || this.array.length === 0) {\n        return this;\n      }\n      var sizeIndex = ((index - 1) >>> level) & MASK;\n      if (sizeIndex >= this.array.length) {\n        return this;\n      }\n\n      var newChild;\n      if (level > 0) {\n        var oldChild = this.array[sizeIndex];\n        newChild = oldChild && oldChild.removeAfter(ownerID, level - SHIFT, index);\n        if (newChild === oldChild && sizeIndex === this.array.length - 1) {\n          return this;\n        }\n      }\n\n      var editable = editableVNode(this, ownerID);\n      editable.array.splice(sizeIndex + 1);\n      if (newChild) {\n        editable.array[sizeIndex] = newChild;\n      }\n      return editable;\n    };\n\n\n\n  var DONE = {};\n\n  function iterateList(list, reverse) {\n    var left = list._origin;\n    var right = list._capacity;\n    var tailPos = getTailOffset(right);\n    var tail = list._tail;\n\n    return iterateNodeOrLeaf(list._root, list._level, 0);\n\n    function iterateNodeOrLeaf(node, level, offset) {\n      return level === 0 ?\n        iterateLeaf(node, offset) :\n        iterateNode(node, level, offset);\n    }\n\n    function iterateLeaf(node, offset) {\n      var array = offset === tailPos ? tail && tail.array : node && node.array;\n      var from = offset > left ? 0 : left - offset;\n      var to = right - offset;\n      if (to > SIZE) {\n        to = SIZE;\n      }\n      return function()  {\n        if (from === to) {\n          return DONE;\n        }\n        var idx = reverse ? --to : from++;\n        return array && array[idx];\n      };\n    }\n\n    function iterateNode(node, level, offset) {\n      var values;\n      var array = node && node.array;\n      var from = offset > left ? 0 : (left - offset) >> level;\n      var to = ((right - offset) >> level) + 1;\n      if (to > SIZE) {\n        to = SIZE;\n      }\n      return function()  {\n        do {\n          if (values) {\n            var value = values();\n            if (value !== DONE) {\n              return value;\n            }\n            values = null;\n          }\n          if (from === to) {\n            return DONE;\n          }\n          var idx = reverse ? --to : from++;\n          values = iterateNodeOrLeaf(\n            array && array[idx], level - SHIFT, offset + (idx << level)\n          );\n        } while (true);\n      };\n    }\n  }\n\n  function makeList(origin, capacity, level, root, tail, ownerID, hash) {\n    var list = Object.create(ListPrototype);\n    list.size = capacity - origin;\n    list._origin = origin;\n    list._capacity = capacity;\n    list._level = level;\n    list._root = root;\n    list._tail = tail;\n    list.__ownerID = ownerID;\n    list.__hash = hash;\n    list.__altered = false;\n    return list;\n  }\n\n  var EMPTY_LIST;\n  function emptyList() {\n    return EMPTY_LIST || (EMPTY_LIST = makeList(0, 0, SHIFT));\n  }\n\n  function updateList(list, index, value) {\n    index = wrapIndex(list, index);\n\n    if (index !== index) {\n      return list;\n    }\n\n    if (index >= list.size || index < 0) {\n      return list.withMutations(function(list ) {\n        index < 0 ?\n          setListBounds(list, index).set(0, value) :\n          setListBounds(list, 0, index + 1).set(index, value)\n      });\n    }\n\n    index += list._origin;\n\n    var newTail = list._tail;\n    var newRoot = list._root;\n    var didAlter = MakeRef(DID_ALTER);\n    if (index >= getTailOffset(list._capacity)) {\n      newTail = updateVNode(newTail, list.__ownerID, 0, index, value, didAlter);\n    } else {\n      newRoot = updateVNode(newRoot, list.__ownerID, list._level, index, value, didAlter);\n    }\n\n    if (!didAlter.value) {\n      return list;\n    }\n\n    if (list.__ownerID) {\n      list._root = newRoot;\n      list._tail = newTail;\n      list.__hash = undefined;\n      list.__altered = true;\n      return list;\n    }\n    return makeList(list._origin, list._capacity, list._level, newRoot, newTail);\n  }\n\n  function updateVNode(node, ownerID, level, index, value, didAlter) {\n    var idx = (index >>> level) & MASK;\n    var nodeHas = node && idx < node.array.length;\n    if (!nodeHas && value === undefined) {\n      return node;\n    }\n\n    var newNode;\n\n    if (level > 0) {\n      var lowerNode = node && node.array[idx];\n      var newLowerNode = updateVNode(lowerNode, ownerID, level - SHIFT, index, value, didAlter);\n      if (newLowerNode === lowerNode) {\n        return node;\n      }\n      newNode = editableVNode(node, ownerID);\n      newNode.array[idx] = newLowerNode;\n      return newNode;\n    }\n\n    if (nodeHas && node.array[idx] === value) {\n      return node;\n    }\n\n    SetRef(didAlter);\n\n    newNode = editableVNode(node, ownerID);\n    if (value === undefined && idx === newNode.array.length - 1) {\n      newNode.array.pop();\n    } else {\n      newNode.array[idx] = value;\n    }\n    return newNode;\n  }\n\n  function editableVNode(node, ownerID) {\n    if (ownerID && node && ownerID === node.ownerID) {\n      return node;\n    }\n    return new VNode(node ? node.array.slice() : [], ownerID);\n  }\n\n  function listNodeFor(list, rawIndex) {\n    if (rawIndex >= getTailOffset(list._capacity)) {\n      return list._tail;\n    }\n    if (rawIndex < 1 << (list._level + SHIFT)) {\n      var node = list._root;\n      var level = list._level;\n      while (node && level > 0) {\n        node = node.array[(rawIndex >>> level) & MASK];\n        level -= SHIFT;\n      }\n      return node;\n    }\n  }\n\n  function setListBounds(list, begin, end) {\n    // Sanitize begin & end using this shorthand for ToInt32(argument)\n    // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n    if (begin !== undefined) {\n      begin = begin | 0;\n    }\n    if (end !== undefined) {\n      end = end | 0;\n    }\n    var owner = list.__ownerID || new OwnerID();\n    var oldOrigin = list._origin;\n    var oldCapacity = list._capacity;\n    var newOrigin = oldOrigin + begin;\n    var newCapacity = end === undefined ? oldCapacity : end < 0 ? oldCapacity + end : oldOrigin + end;\n    if (newOrigin === oldOrigin && newCapacity === oldCapacity) {\n      return list;\n    }\n\n    // If it's going to end after it starts, it's empty.\n    if (newOrigin >= newCapacity) {\n      return list.clear();\n    }\n\n    var newLevel = list._level;\n    var newRoot = list._root;\n\n    // New origin might need creating a higher root.\n    var offsetShift = 0;\n    while (newOrigin + offsetShift < 0) {\n      newRoot = new VNode(newRoot && newRoot.array.length ? [undefined, newRoot] : [], owner);\n      newLevel += SHIFT;\n      offsetShift += 1 << newLevel;\n    }\n    if (offsetShift) {\n      newOrigin += offsetShift;\n      oldOrigin += offsetShift;\n      newCapacity += offsetShift;\n      oldCapacity += offsetShift;\n    }\n\n    var oldTailOffset = getTailOffset(oldCapacity);\n    var newTailOffset = getTailOffset(newCapacity);\n\n    // New size might need creating a higher root.\n    while (newTailOffset >= 1 << (newLevel + SHIFT)) {\n      newRoot = new VNode(newRoot && newRoot.array.length ? [newRoot] : [], owner);\n      newLevel += SHIFT;\n    }\n\n    // Locate or create the new tail.\n    var oldTail = list._tail;\n    var newTail = newTailOffset < oldTailOffset ?\n      listNodeFor(list, newCapacity - 1) :\n      newTailOffset > oldTailOffset ? new VNode([], owner) : oldTail;\n\n    // Merge Tail into tree.\n    if (oldTail && newTailOffset > oldTailOffset && newOrigin < oldCapacity && oldTail.array.length) {\n      newRoot = editableVNode(newRoot, owner);\n      var node = newRoot;\n      for (var level = newLevel; level > SHIFT; level -= SHIFT) {\n        var idx = (oldTailOffset >>> level) & MASK;\n        node = node.array[idx] = editableVNode(node.array[idx], owner);\n      }\n      node.array[(oldTailOffset >>> SHIFT) & MASK] = oldTail;\n    }\n\n    // If the size has been reduced, there's a chance the tail needs to be trimmed.\n    if (newCapacity < oldCapacity) {\n      newTail = newTail && newTail.removeAfter(owner, 0, newCapacity);\n    }\n\n    // If the new origin is within the tail, then we do not need a root.\n    if (newOrigin >= newTailOffset) {\n      newOrigin -= newTailOffset;\n      newCapacity -= newTailOffset;\n      newLevel = SHIFT;\n      newRoot = null;\n      newTail = newTail && newTail.removeBefore(owner, 0, newOrigin);\n\n    // Otherwise, if the root has been trimmed, garbage collect.\n    } else if (newOrigin > oldOrigin || newTailOffset < oldTailOffset) {\n      offsetShift = 0;\n\n      // Identify the new top root node of the subtree of the old root.\n      while (newRoot) {\n        var beginIndex = (newOrigin >>> newLevel) & MASK;\n        if (beginIndex !== (newTailOffset >>> newLevel) & MASK) {\n          break;\n        }\n        if (beginIndex) {\n          offsetShift += (1 << newLevel) * beginIndex;\n        }\n        newLevel -= SHIFT;\n        newRoot = newRoot.array[beginIndex];\n      }\n\n      // Trim the new sides of the new root.\n      if (newRoot && newOrigin > oldOrigin) {\n        newRoot = newRoot.removeBefore(owner, newLevel, newOrigin - offsetShift);\n      }\n      if (newRoot && newTailOffset < oldTailOffset) {\n        newRoot = newRoot.removeAfter(owner, newLevel, newTailOffset - offsetShift);\n      }\n      if (offsetShift) {\n        newOrigin -= offsetShift;\n        newCapacity -= offsetShift;\n      }\n    }\n\n    if (list.__ownerID) {\n      list.size = newCapacity - newOrigin;\n      list._origin = newOrigin;\n      list._capacity = newCapacity;\n      list._level = newLevel;\n      list._root = newRoot;\n      list._tail = newTail;\n      list.__hash = undefined;\n      list.__altered = true;\n      return list;\n    }\n    return makeList(newOrigin, newCapacity, newLevel, newRoot, newTail);\n  }\n\n  function mergeIntoListWith(list, merger, iterables) {\n    var iters = [];\n    var maxSize = 0;\n    for (var ii = 0; ii < iterables.length; ii++) {\n      var value = iterables[ii];\n      var iter = IndexedIterable(value);\n      if (iter.size > maxSize) {\n        maxSize = iter.size;\n      }\n      if (!isIterable(value)) {\n        iter = iter.map(function(v ) {return fromJS(v)});\n      }\n      iters.push(iter);\n    }\n    if (maxSize > list.size) {\n      list = list.setSize(maxSize);\n    }\n    return mergeIntoCollectionWith(list, merger, iters);\n  }\n\n  function getTailOffset(size) {\n    return size < SIZE ? 0 : (((size - 1) >>> SHIFT) << SHIFT);\n  }\n\n  createClass(OrderedMap, Map);\n\n    // @pragma Construction\n\n    function OrderedMap(value) {\n      return value === null || value === undefined ? emptyOrderedMap() :\n        isOrderedMap(value) ? value :\n        emptyOrderedMap().withMutations(function(map ) {\n          var iter = KeyedIterable(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function(v, k)  {return map.set(k, v)});\n        });\n    }\n\n    OrderedMap.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    OrderedMap.prototype.toString = function() {\n      return this.__toString('OrderedMap {', '}');\n    };\n\n    // @pragma Access\n\n    OrderedMap.prototype.get = function(k, notSetValue) {\n      var index = this._map.get(k);\n      return index !== undefined ? this._list.get(index)[1] : notSetValue;\n    };\n\n    // @pragma Modification\n\n    OrderedMap.prototype.clear = function() {\n      if (this.size === 0) {\n        return this;\n      }\n      if (this.__ownerID) {\n        this.size = 0;\n        this._map.clear();\n        this._list.clear();\n        return this;\n      }\n      return emptyOrderedMap();\n    };\n\n    OrderedMap.prototype.set = function(k, v) {\n      return updateOrderedMap(this, k, v);\n    };\n\n    OrderedMap.prototype.remove = function(k) {\n      return updateOrderedMap(this, k, NOT_SET);\n    };\n\n    OrderedMap.prototype.wasAltered = function() {\n      return this._map.wasAltered() || this._list.wasAltered();\n    };\n\n    OrderedMap.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return this._list.__iterate(\n        function(entry ) {return entry && fn(entry[1], entry[0], this$0)},\n        reverse\n      );\n    };\n\n    OrderedMap.prototype.__iterator = function(type, reverse) {\n      return this._list.fromEntrySeq().__iterator(type, reverse);\n    };\n\n    OrderedMap.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      var newMap = this._map.__ensureOwner(ownerID);\n      var newList = this._list.__ensureOwner(ownerID);\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this._map = newMap;\n        this._list = newList;\n        return this;\n      }\n      return makeOrderedMap(newMap, newList, ownerID, this.__hash);\n    };\n\n\n  function isOrderedMap(maybeOrderedMap) {\n    return isMap(maybeOrderedMap) && isOrdered(maybeOrderedMap);\n  }\n\n  OrderedMap.isOrderedMap = isOrderedMap;\n\n  OrderedMap.prototype[IS_ORDERED_SENTINEL] = true;\n  OrderedMap.prototype[DELETE] = OrderedMap.prototype.remove;\n\n\n\n  function makeOrderedMap(map, list, ownerID, hash) {\n    var omap = Object.create(OrderedMap.prototype);\n    omap.size = map ? map.size : 0;\n    omap._map = map;\n    omap._list = list;\n    omap.__ownerID = ownerID;\n    omap.__hash = hash;\n    return omap;\n  }\n\n  var EMPTY_ORDERED_MAP;\n  function emptyOrderedMap() {\n    return EMPTY_ORDERED_MAP || (EMPTY_ORDERED_MAP = makeOrderedMap(emptyMap(), emptyList()));\n  }\n\n  function updateOrderedMap(omap, k, v) {\n    var map = omap._map;\n    var list = omap._list;\n    var i = map.get(k);\n    var has = i !== undefined;\n    var newMap;\n    var newList;\n    if (v === NOT_SET) { // removed\n      if (!has) {\n        return omap;\n      }\n      if (list.size >= SIZE && list.size >= map.size * 2) {\n        newList = list.filter(function(entry, idx)  {return entry !== undefined && i !== idx});\n        newMap = newList.toKeyedSeq().map(function(entry ) {return entry[0]}).flip().toMap();\n        if (omap.__ownerID) {\n          newMap.__ownerID = newList.__ownerID = omap.__ownerID;\n        }\n      } else {\n        newMap = map.remove(k);\n        newList = i === list.size - 1 ? list.pop() : list.set(i, undefined);\n      }\n    } else {\n      if (has) {\n        if (v === list.get(i)[1]) {\n          return omap;\n        }\n        newMap = map;\n        newList = list.set(i, [k, v]);\n      } else {\n        newMap = map.set(k, list.size);\n        newList = list.set(list.size, [k, v]);\n      }\n    }\n    if (omap.__ownerID) {\n      omap.size = newMap.size;\n      omap._map = newMap;\n      omap._list = newList;\n      omap.__hash = undefined;\n      return omap;\n    }\n    return makeOrderedMap(newMap, newList);\n  }\n\n  createClass(ToKeyedSequence, KeyedSeq);\n    function ToKeyedSequence(indexed, useKeys) {\n      this._iter = indexed;\n      this._useKeys = useKeys;\n      this.size = indexed.size;\n    }\n\n    ToKeyedSequence.prototype.get = function(key, notSetValue) {\n      return this._iter.get(key, notSetValue);\n    };\n\n    ToKeyedSequence.prototype.has = function(key) {\n      return this._iter.has(key);\n    };\n\n    ToKeyedSequence.prototype.valueSeq = function() {\n      return this._iter.valueSeq();\n    };\n\n    ToKeyedSequence.prototype.reverse = function() {var this$0 = this;\n      var reversedSequence = reverseFactory(this, true);\n      if (!this._useKeys) {\n        reversedSequence.valueSeq = function()  {return this$0._iter.toSeq().reverse()};\n      }\n      return reversedSequence;\n    };\n\n    ToKeyedSequence.prototype.map = function(mapper, context) {var this$0 = this;\n      var mappedSequence = mapFactory(this, mapper, context);\n      if (!this._useKeys) {\n        mappedSequence.valueSeq = function()  {return this$0._iter.toSeq().map(mapper, context)};\n      }\n      return mappedSequence;\n    };\n\n    ToKeyedSequence.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      var ii;\n      return this._iter.__iterate(\n        this._useKeys ?\n          function(v, k)  {return fn(v, k, this$0)} :\n          ((ii = reverse ? resolveSize(this) : 0),\n            function(v ) {return fn(v, reverse ? --ii : ii++, this$0)}),\n        reverse\n      );\n    };\n\n    ToKeyedSequence.prototype.__iterator = function(type, reverse) {\n      if (this._useKeys) {\n        return this._iter.__iterator(type, reverse);\n      }\n      var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n      var ii = reverse ? resolveSize(this) : 0;\n      return new Iterator(function()  {\n        var step = iterator.next();\n        return step.done ? step :\n          iteratorValue(type, reverse ? --ii : ii++, step.value, step);\n      });\n    };\n\n  ToKeyedSequence.prototype[IS_ORDERED_SENTINEL] = true;\n\n\n  createClass(ToIndexedSequence, IndexedSeq);\n    function ToIndexedSequence(iter) {\n      this._iter = iter;\n      this.size = iter.size;\n    }\n\n    ToIndexedSequence.prototype.includes = function(value) {\n      return this._iter.includes(value);\n    };\n\n    ToIndexedSequence.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      var iterations = 0;\n      return this._iter.__iterate(function(v ) {return fn(v, iterations++, this$0)}, reverse);\n    };\n\n    ToIndexedSequence.prototype.__iterator = function(type, reverse) {\n      var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n      var iterations = 0;\n      return new Iterator(function()  {\n        var step = iterator.next();\n        return step.done ? step :\n          iteratorValue(type, iterations++, step.value, step)\n      });\n    };\n\n\n\n  createClass(ToSetSequence, SetSeq);\n    function ToSetSequence(iter) {\n      this._iter = iter;\n      this.size = iter.size;\n    }\n\n    ToSetSequence.prototype.has = function(key) {\n      return this._iter.includes(key);\n    };\n\n    ToSetSequence.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return this._iter.__iterate(function(v ) {return fn(v, v, this$0)}, reverse);\n    };\n\n    ToSetSequence.prototype.__iterator = function(type, reverse) {\n      var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n      return new Iterator(function()  {\n        var step = iterator.next();\n        return step.done ? step :\n          iteratorValue(type, step.value, step.value, step);\n      });\n    };\n\n\n\n  createClass(FromEntriesSequence, KeyedSeq);\n    function FromEntriesSequence(entries) {\n      this._iter = entries;\n      this.size = entries.size;\n    }\n\n    FromEntriesSequence.prototype.entrySeq = function() {\n      return this._iter.toSeq();\n    };\n\n    FromEntriesSequence.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return this._iter.__iterate(function(entry ) {\n        // Check if entry exists first so array access doesn't throw for holes\n        // in the parent iteration.\n        if (entry) {\n          validateEntry(entry);\n          var indexedIterable = isIterable(entry);\n          return fn(\n            indexedIterable ? entry.get(1) : entry[1],\n            indexedIterable ? entry.get(0) : entry[0],\n            this$0\n          );\n        }\n      }, reverse);\n    };\n\n    FromEntriesSequence.prototype.__iterator = function(type, reverse) {\n      var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n      return new Iterator(function()  {\n        while (true) {\n          var step = iterator.next();\n          if (step.done) {\n            return step;\n          }\n          var entry = step.value;\n          // Check if entry exists first so array access doesn't throw for holes\n          // in the parent iteration.\n          if (entry) {\n            validateEntry(entry);\n            var indexedIterable = isIterable(entry);\n            return iteratorValue(\n              type,\n              indexedIterable ? entry.get(0) : entry[0],\n              indexedIterable ? entry.get(1) : entry[1],\n              step\n            );\n          }\n        }\n      });\n    };\n\n\n  ToIndexedSequence.prototype.cacheResult =\n  ToKeyedSequence.prototype.cacheResult =\n  ToSetSequence.prototype.cacheResult =\n  FromEntriesSequence.prototype.cacheResult =\n    cacheResultThrough;\n\n\n  function flipFactory(iterable) {\n    var flipSequence = makeSequence(iterable);\n    flipSequence._iter = iterable;\n    flipSequence.size = iterable.size;\n    flipSequence.flip = function()  {return iterable};\n    flipSequence.reverse = function () {\n      var reversedSequence = iterable.reverse.apply(this); // super.reverse()\n      reversedSequence.flip = function()  {return iterable.reverse()};\n      return reversedSequence;\n    };\n    flipSequence.has = function(key ) {return iterable.includes(key)};\n    flipSequence.includes = function(key ) {return iterable.has(key)};\n    flipSequence.cacheResult = cacheResultThrough;\n    flipSequence.__iterateUncached = function (fn, reverse) {var this$0 = this;\n      return iterable.__iterate(function(v, k)  {return fn(k, v, this$0) !== false}, reverse);\n    }\n    flipSequence.__iteratorUncached = function(type, reverse) {\n      if (type === ITERATE_ENTRIES) {\n        var iterator = iterable.__iterator(type, reverse);\n        return new Iterator(function()  {\n          var step = iterator.next();\n          if (!step.done) {\n            var k = step.value[0];\n            step.value[0] = step.value[1];\n            step.value[1] = k;\n          }\n          return step;\n        });\n      }\n      return iterable.__iterator(\n        type === ITERATE_VALUES ? ITERATE_KEYS : ITERATE_VALUES,\n        reverse\n      );\n    }\n    return flipSequence;\n  }\n\n\n  function mapFactory(iterable, mapper, context) {\n    var mappedSequence = makeSequence(iterable);\n    mappedSequence.size = iterable.size;\n    mappedSequence.has = function(key ) {return iterable.has(key)};\n    mappedSequence.get = function(key, notSetValue)  {\n      var v = iterable.get(key, NOT_SET);\n      return v === NOT_SET ?\n        notSetValue :\n        mapper.call(context, v, key, iterable);\n    };\n    mappedSequence.__iterateUncached = function (fn, reverse) {var this$0 = this;\n      return iterable.__iterate(\n        function(v, k, c)  {return fn(mapper.call(context, v, k, c), k, this$0) !== false},\n        reverse\n      );\n    }\n    mappedSequence.__iteratorUncached = function (type, reverse) {\n      var iterator = iterable.__iterator(ITERATE_ENTRIES, reverse);\n      return new Iterator(function()  {\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        var key = entry[0];\n        return iteratorValue(\n          type,\n          key,\n          mapper.call(context, entry[1], key, iterable),\n          step\n        );\n      });\n    }\n    return mappedSequence;\n  }\n\n\n  function reverseFactory(iterable, useKeys) {\n    var reversedSequence = makeSequence(iterable);\n    reversedSequence._iter = iterable;\n    reversedSequence.size = iterable.size;\n    reversedSequence.reverse = function()  {return iterable};\n    if (iterable.flip) {\n      reversedSequence.flip = function () {\n        var flipSequence = flipFactory(iterable);\n        flipSequence.reverse = function()  {return iterable.flip()};\n        return flipSequence;\n      };\n    }\n    reversedSequence.get = function(key, notSetValue) \n      {return iterable.get(useKeys ? key : -1 - key, notSetValue)};\n    reversedSequence.has = function(key )\n      {return iterable.has(useKeys ? key : -1 - key)};\n    reversedSequence.includes = function(value ) {return iterable.includes(value)};\n    reversedSequence.cacheResult = cacheResultThrough;\n    reversedSequence.__iterate = function (fn, reverse) {var this$0 = this;\n      return iterable.__iterate(function(v, k)  {return fn(v, k, this$0)}, !reverse);\n    };\n    reversedSequence.__iterator =\n      function(type, reverse)  {return iterable.__iterator(type, !reverse)};\n    return reversedSequence;\n  }\n\n\n  function filterFactory(iterable, predicate, context, useKeys) {\n    var filterSequence = makeSequence(iterable);\n    if (useKeys) {\n      filterSequence.has = function(key ) {\n        var v = iterable.get(key, NOT_SET);\n        return v !== NOT_SET && !!predicate.call(context, v, key, iterable);\n      };\n      filterSequence.get = function(key, notSetValue)  {\n        var v = iterable.get(key, NOT_SET);\n        return v !== NOT_SET && predicate.call(context, v, key, iterable) ?\n          v : notSetValue;\n      };\n    }\n    filterSequence.__iterateUncached = function (fn, reverse) {var this$0 = this;\n      var iterations = 0;\n      iterable.__iterate(function(v, k, c)  {\n        if (predicate.call(context, v, k, c)) {\n          iterations++;\n          return fn(v, useKeys ? k : iterations - 1, this$0);\n        }\n      }, reverse);\n      return iterations;\n    };\n    filterSequence.__iteratorUncached = function (type, reverse) {\n      var iterator = iterable.__iterator(ITERATE_ENTRIES, reverse);\n      var iterations = 0;\n      return new Iterator(function()  {\n        while (true) {\n          var step = iterator.next();\n          if (step.done) {\n            return step;\n          }\n          var entry = step.value;\n          var key = entry[0];\n          var value = entry[1];\n          if (predicate.call(context, value, key, iterable)) {\n            return iteratorValue(type, useKeys ? key : iterations++, value, step);\n          }\n        }\n      });\n    }\n    return filterSequence;\n  }\n\n\n  function countByFactory(iterable, grouper, context) {\n    var groups = Map().asMutable();\n    iterable.__iterate(function(v, k)  {\n      groups.update(\n        grouper.call(context, v, k, iterable),\n        0,\n        function(a ) {return a + 1}\n      );\n    });\n    return groups.asImmutable();\n  }\n\n\n  function groupByFactory(iterable, grouper, context) {\n    var isKeyedIter = isKeyed(iterable);\n    var groups = (isOrdered(iterable) ? OrderedMap() : Map()).asMutable();\n    iterable.__iterate(function(v, k)  {\n      groups.update(\n        grouper.call(context, v, k, iterable),\n        function(a ) {return (a = a || [], a.push(isKeyedIter ? [k, v] : v), a)}\n      );\n    });\n    var coerce = iterableClass(iterable);\n    return groups.map(function(arr ) {return reify(iterable, coerce(arr))});\n  }\n\n\n  function sliceFactory(iterable, begin, end, useKeys) {\n    var originalSize = iterable.size;\n\n    // Sanitize begin & end using this shorthand for ToInt32(argument)\n    // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n    if (begin !== undefined) {\n      begin = begin | 0;\n    }\n    if (end !== undefined) {\n      if (end === Infinity) {\n        end = originalSize;\n      } else {\n        end = end | 0;\n      }\n    }\n\n    if (wholeSlice(begin, end, originalSize)) {\n      return iterable;\n    }\n\n    var resolvedBegin = resolveBegin(begin, originalSize);\n    var resolvedEnd = resolveEnd(end, originalSize);\n\n    // begin or end will be NaN if they were provided as negative numbers and\n    // this iterable's size is unknown. In that case, cache first so there is\n    // a known size and these do not resolve to NaN.\n    if (resolvedBegin !== resolvedBegin || resolvedEnd !== resolvedEnd) {\n      return sliceFactory(iterable.toSeq().cacheResult(), begin, end, useKeys);\n    }\n\n    // Note: resolvedEnd is undefined when the original sequence's length is\n    // unknown and this slice did not supply an end and should contain all\n    // elements after resolvedBegin.\n    // In that case, resolvedSize will be NaN and sliceSize will remain undefined.\n    var resolvedSize = resolvedEnd - resolvedBegin;\n    var sliceSize;\n    if (resolvedSize === resolvedSize) {\n      sliceSize = resolvedSize < 0 ? 0 : resolvedSize;\n    }\n\n    var sliceSeq = makeSequence(iterable);\n\n    // If iterable.size is undefined, the size of the realized sliceSeq is\n    // unknown at this point unless the number of items to slice is 0\n    sliceSeq.size = sliceSize === 0 ? sliceSize : iterable.size && sliceSize || undefined;\n\n    if (!useKeys && isSeq(iterable) && sliceSize >= 0) {\n      sliceSeq.get = function (index, notSetValue) {\n        index = wrapIndex(this, index);\n        return index >= 0 && index < sliceSize ?\n          iterable.get(index + resolvedBegin, notSetValue) :\n          notSetValue;\n      }\n    }\n\n    sliceSeq.__iterateUncached = function(fn, reverse) {var this$0 = this;\n      if (sliceSize === 0) {\n        return 0;\n      }\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var skipped = 0;\n      var isSkipping = true;\n      var iterations = 0;\n      iterable.__iterate(function(v, k)  {\n        if (!(isSkipping && (isSkipping = skipped++ < resolvedBegin))) {\n          iterations++;\n          return fn(v, useKeys ? k : iterations - 1, this$0) !== false &&\n                 iterations !== sliceSize;\n        }\n      });\n      return iterations;\n    };\n\n    sliceSeq.__iteratorUncached = function(type, reverse) {\n      if (sliceSize !== 0 && reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      // Don't bother instantiating parent iterator if taking 0.\n      var iterator = sliceSize !== 0 && iterable.__iterator(type, reverse);\n      var skipped = 0;\n      var iterations = 0;\n      return new Iterator(function()  {\n        while (skipped++ < resolvedBegin) {\n          iterator.next();\n        }\n        if (++iterations > sliceSize) {\n          return iteratorDone();\n        }\n        var step = iterator.next();\n        if (useKeys || type === ITERATE_VALUES) {\n          return step;\n        } else if (type === ITERATE_KEYS) {\n          return iteratorValue(type, iterations - 1, undefined, step);\n        } else {\n          return iteratorValue(type, iterations - 1, step.value[1], step);\n        }\n      });\n    }\n\n    return sliceSeq;\n  }\n\n\n  function takeWhileFactory(iterable, predicate, context) {\n    var takeSequence = makeSequence(iterable);\n    takeSequence.__iterateUncached = function(fn, reverse) {var this$0 = this;\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var iterations = 0;\n      iterable.__iterate(function(v, k, c) \n        {return predicate.call(context, v, k, c) && ++iterations && fn(v, k, this$0)}\n      );\n      return iterations;\n    };\n    takeSequence.__iteratorUncached = function(type, reverse) {var this$0 = this;\n      if (reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      var iterator = iterable.__iterator(ITERATE_ENTRIES, reverse);\n      var iterating = true;\n      return new Iterator(function()  {\n        if (!iterating) {\n          return iteratorDone();\n        }\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        var k = entry[0];\n        var v = entry[1];\n        if (!predicate.call(context, v, k, this$0)) {\n          iterating = false;\n          return iteratorDone();\n        }\n        return type === ITERATE_ENTRIES ? step :\n          iteratorValue(type, k, v, step);\n      });\n    };\n    return takeSequence;\n  }\n\n\n  function skipWhileFactory(iterable, predicate, context, useKeys) {\n    var skipSequence = makeSequence(iterable);\n    skipSequence.__iterateUncached = function (fn, reverse) {var this$0 = this;\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var isSkipping = true;\n      var iterations = 0;\n      iterable.__iterate(function(v, k, c)  {\n        if (!(isSkipping && (isSkipping = predicate.call(context, v, k, c)))) {\n          iterations++;\n          return fn(v, useKeys ? k : iterations - 1, this$0);\n        }\n      });\n      return iterations;\n    };\n    skipSequence.__iteratorUncached = function(type, reverse) {var this$0 = this;\n      if (reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      var iterator = iterable.__iterator(ITERATE_ENTRIES, reverse);\n      var skipping = true;\n      var iterations = 0;\n      return new Iterator(function()  {\n        var step, k, v;\n        do {\n          step = iterator.next();\n          if (step.done) {\n            if (useKeys || type === ITERATE_VALUES) {\n              return step;\n            } else if (type === ITERATE_KEYS) {\n              return iteratorValue(type, iterations++, undefined, step);\n            } else {\n              return iteratorValue(type, iterations++, step.value[1], step);\n            }\n          }\n          var entry = step.value;\n          k = entry[0];\n          v = entry[1];\n          skipping && (skipping = predicate.call(context, v, k, this$0));\n        } while (skipping);\n        return type === ITERATE_ENTRIES ? step :\n          iteratorValue(type, k, v, step);\n      });\n    };\n    return skipSequence;\n  }\n\n\n  function concatFactory(iterable, values) {\n    var isKeyedIterable = isKeyed(iterable);\n    var iters = [iterable].concat(values).map(function(v ) {\n      if (!isIterable(v)) {\n        v = isKeyedIterable ?\n          keyedSeqFromValue(v) :\n          indexedSeqFromValue(Array.isArray(v) ? v : [v]);\n      } else if (isKeyedIterable) {\n        v = KeyedIterable(v);\n      }\n      return v;\n    }).filter(function(v ) {return v.size !== 0});\n\n    if (iters.length === 0) {\n      return iterable;\n    }\n\n    if (iters.length === 1) {\n      var singleton = iters[0];\n      if (singleton === iterable ||\n          isKeyedIterable && isKeyed(singleton) ||\n          isIndexed(iterable) && isIndexed(singleton)) {\n        return singleton;\n      }\n    }\n\n    var concatSeq = new ArraySeq(iters);\n    if (isKeyedIterable) {\n      concatSeq = concatSeq.toKeyedSeq();\n    } else if (!isIndexed(iterable)) {\n      concatSeq = concatSeq.toSetSeq();\n    }\n    concatSeq = concatSeq.flatten(true);\n    concatSeq.size = iters.reduce(\n      function(sum, seq)  {\n        if (sum !== undefined) {\n          var size = seq.size;\n          if (size !== undefined) {\n            return sum + size;\n          }\n        }\n      },\n      0\n    );\n    return concatSeq;\n  }\n\n\n  function flattenFactory(iterable, depth, useKeys) {\n    var flatSequence = makeSequence(iterable);\n    flatSequence.__iterateUncached = function(fn, reverse) {\n      var iterations = 0;\n      var stopped = false;\n      function flatDeep(iter, currentDepth) {var this$0 = this;\n        iter.__iterate(function(v, k)  {\n          if ((!depth || currentDepth < depth) && isIterable(v)) {\n            flatDeep(v, currentDepth + 1);\n          } else if (fn(v, useKeys ? k : iterations++, this$0) === false) {\n            stopped = true;\n          }\n          return !stopped;\n        }, reverse);\n      }\n      flatDeep(iterable, 0);\n      return iterations;\n    }\n    flatSequence.__iteratorUncached = function(type, reverse) {\n      var iterator = iterable.__iterator(type, reverse);\n      var stack = [];\n      var iterations = 0;\n      return new Iterator(function()  {\n        while (iterator) {\n          var step = iterator.next();\n          if (step.done !== false) {\n            iterator = stack.pop();\n            continue;\n          }\n          var v = step.value;\n          if (type === ITERATE_ENTRIES) {\n            v = v[1];\n          }\n          if ((!depth || stack.length < depth) && isIterable(v)) {\n            stack.push(iterator);\n            iterator = v.__iterator(type, reverse);\n          } else {\n            return useKeys ? step : iteratorValue(type, iterations++, v, step);\n          }\n        }\n        return iteratorDone();\n      });\n    }\n    return flatSequence;\n  }\n\n\n  function flatMapFactory(iterable, mapper, context) {\n    var coerce = iterableClass(iterable);\n    return iterable.toSeq().map(\n      function(v, k)  {return coerce(mapper.call(context, v, k, iterable))}\n    ).flatten(true);\n  }\n\n\n  function interposeFactory(iterable, separator) {\n    var interposedSequence = makeSequence(iterable);\n    interposedSequence.size = iterable.size && iterable.size * 2 -1;\n    interposedSequence.__iterateUncached = function(fn, reverse) {var this$0 = this;\n      var iterations = 0;\n      iterable.__iterate(function(v, k) \n        {return (!iterations || fn(separator, iterations++, this$0) !== false) &&\n        fn(v, iterations++, this$0) !== false},\n        reverse\n      );\n      return iterations;\n    };\n    interposedSequence.__iteratorUncached = function(type, reverse) {\n      var iterator = iterable.__iterator(ITERATE_VALUES, reverse);\n      var iterations = 0;\n      var step;\n      return new Iterator(function()  {\n        if (!step || iterations % 2) {\n          step = iterator.next();\n          if (step.done) {\n            return step;\n          }\n        }\n        return iterations % 2 ?\n          iteratorValue(type, iterations++, separator) :\n          iteratorValue(type, iterations++, step.value, step);\n      });\n    };\n    return interposedSequence;\n  }\n\n\n  function sortFactory(iterable, comparator, mapper) {\n    if (!comparator) {\n      comparator = defaultComparator;\n    }\n    var isKeyedIterable = isKeyed(iterable);\n    var index = 0;\n    var entries = iterable.toSeq().map(\n      function(v, k)  {return [k, v, index++, mapper ? mapper(v, k, iterable) : v]}\n    ).toArray();\n    entries.sort(function(a, b)  {return comparator(a[3], b[3]) || a[2] - b[2]}).forEach(\n      isKeyedIterable ?\n      function(v, i)  { entries[i].length = 2; } :\n      function(v, i)  { entries[i] = v[1]; }\n    );\n    return isKeyedIterable ? KeyedSeq(entries) :\n      isIndexed(iterable) ? IndexedSeq(entries) :\n      SetSeq(entries);\n  }\n\n\n  function maxFactory(iterable, comparator, mapper) {\n    if (!comparator) {\n      comparator = defaultComparator;\n    }\n    if (mapper) {\n      var entry = iterable.toSeq()\n        .map(function(v, k)  {return [v, mapper(v, k, iterable)]})\n        .reduce(function(a, b)  {return maxCompare(comparator, a[1], b[1]) ? b : a});\n      return entry && entry[0];\n    } else {\n      return iterable.reduce(function(a, b)  {return maxCompare(comparator, a, b) ? b : a});\n    }\n  }\n\n  function maxCompare(comparator, a, b) {\n    var comp = comparator(b, a);\n    // b is considered the new max if the comparator declares them equal, but\n    // they are not equal and b is in fact a nullish value.\n    return (comp === 0 && b !== a && (b === undefined || b === null || b !== b)) || comp > 0;\n  }\n\n\n  function zipWithFactory(keyIter, zipper, iters) {\n    var zipSequence = makeSequence(keyIter);\n    zipSequence.size = new ArraySeq(iters).map(function(i ) {return i.size}).min();\n    // Note: this a generic base implementation of __iterate in terms of\n    // __iterator which may be more generically useful in the future.\n    zipSequence.__iterate = function(fn, reverse) {\n      /* generic:\n      var iterator = this.__iterator(ITERATE_ENTRIES, reverse);\n      var step;\n      var iterations = 0;\n      while (!(step = iterator.next()).done) {\n        iterations++;\n        if (fn(step.value[1], step.value[0], this) === false) {\n          break;\n        }\n      }\n      return iterations;\n      */\n      // indexed:\n      var iterator = this.__iterator(ITERATE_VALUES, reverse);\n      var step;\n      var iterations = 0;\n      while (!(step = iterator.next()).done) {\n        if (fn(step.value, iterations++, this) === false) {\n          break;\n        }\n      }\n      return iterations;\n    };\n    zipSequence.__iteratorUncached = function(type, reverse) {\n      var iterators = iters.map(function(i )\n        {return (i = Iterable(i), getIterator(reverse ? i.reverse() : i))}\n      );\n      var iterations = 0;\n      var isDone = false;\n      return new Iterator(function()  {\n        var steps;\n        if (!isDone) {\n          steps = iterators.map(function(i ) {return i.next()});\n          isDone = steps.some(function(s ) {return s.done});\n        }\n        if (isDone) {\n          return iteratorDone();\n        }\n        return iteratorValue(\n          type,\n          iterations++,\n          zipper.apply(null, steps.map(function(s ) {return s.value}))\n        );\n      });\n    };\n    return zipSequence\n  }\n\n\n  // #pragma Helper Functions\n\n  function reify(iter, seq) {\n    return isSeq(iter) ? seq : iter.constructor(seq);\n  }\n\n  function validateEntry(entry) {\n    if (entry !== Object(entry)) {\n      throw new TypeError('Expected [K, V] tuple: ' + entry);\n    }\n  }\n\n  function resolveSize(iter) {\n    assertNotInfinite(iter.size);\n    return ensureSize(iter);\n  }\n\n  function iterableClass(iterable) {\n    return isKeyed(iterable) ? KeyedIterable :\n      isIndexed(iterable) ? IndexedIterable :\n      SetIterable;\n  }\n\n  function makeSequence(iterable) {\n    return Object.create(\n      (\n        isKeyed(iterable) ? KeyedSeq :\n        isIndexed(iterable) ? IndexedSeq :\n        SetSeq\n      ).prototype\n    );\n  }\n\n  function cacheResultThrough() {\n    if (this._iter.cacheResult) {\n      this._iter.cacheResult();\n      this.size = this._iter.size;\n      return this;\n    } else {\n      return Seq.prototype.cacheResult.call(this);\n    }\n  }\n\n  function defaultComparator(a, b) {\n    return a > b ? 1 : a < b ? -1 : 0;\n  }\n\n  function forceIterator(keyPath) {\n    var iter = getIterator(keyPath);\n    if (!iter) {\n      // Array might not be iterable in this environment, so we need a fallback\n      // to our wrapped type.\n      if (!isArrayLike(keyPath)) {\n        throw new TypeError('Expected iterable or array-like: ' + keyPath);\n      }\n      iter = getIterator(Iterable(keyPath));\n    }\n    return iter;\n  }\n\n  createClass(Record, KeyedCollection);\n\n    function Record(defaultValues, name) {\n      var hasInitialized;\n\n      var RecordType = function Record(values) {\n        if (values instanceof RecordType) {\n          return values;\n        }\n        if (!(this instanceof RecordType)) {\n          return new RecordType(values);\n        }\n        if (!hasInitialized) {\n          hasInitialized = true;\n          var keys = Object.keys(defaultValues);\n          setProps(RecordTypePrototype, keys);\n          RecordTypePrototype.size = keys.length;\n          RecordTypePrototype._name = name;\n          RecordTypePrototype._keys = keys;\n          RecordTypePrototype._defaultValues = defaultValues;\n        }\n        this._map = Map(values);\n      };\n\n      var RecordTypePrototype = RecordType.prototype = Object.create(RecordPrototype);\n      RecordTypePrototype.constructor = RecordType;\n\n      return RecordType;\n    }\n\n    Record.prototype.toString = function() {\n      return this.__toString(recordName(this) + ' {', '}');\n    };\n\n    // @pragma Access\n\n    Record.prototype.has = function(k) {\n      return this._defaultValues.hasOwnProperty(k);\n    };\n\n    Record.prototype.get = function(k, notSetValue) {\n      if (!this.has(k)) {\n        return notSetValue;\n      }\n      var defaultVal = this._defaultValues[k];\n      return this._map ? this._map.get(k, defaultVal) : defaultVal;\n    };\n\n    // @pragma Modification\n\n    Record.prototype.clear = function() {\n      if (this.__ownerID) {\n        this._map && this._map.clear();\n        return this;\n      }\n      var RecordType = this.constructor;\n      return RecordType._empty || (RecordType._empty = makeRecord(this, emptyMap()));\n    };\n\n    Record.prototype.set = function(k, v) {\n      if (!this.has(k)) {\n        throw new Error('Cannot set unknown key \"' + k + '\" on ' + recordName(this));\n      }\n      if (this._map && !this._map.has(k)) {\n        var defaultVal = this._defaultValues[k];\n        if (v === defaultVal) {\n          return this;\n        }\n      }\n      var newMap = this._map && this._map.set(k, v);\n      if (this.__ownerID || newMap === this._map) {\n        return this;\n      }\n      return makeRecord(this, newMap);\n    };\n\n    Record.prototype.remove = function(k) {\n      if (!this.has(k)) {\n        return this;\n      }\n      var newMap = this._map && this._map.remove(k);\n      if (this.__ownerID || newMap === this._map) {\n        return this;\n      }\n      return makeRecord(this, newMap);\n    };\n\n    Record.prototype.wasAltered = function() {\n      return this._map.wasAltered();\n    };\n\n    Record.prototype.__iterator = function(type, reverse) {var this$0 = this;\n      return KeyedIterable(this._defaultValues).map(function(_, k)  {return this$0.get(k)}).__iterator(type, reverse);\n    };\n\n    Record.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return KeyedIterable(this._defaultValues).map(function(_, k)  {return this$0.get(k)}).__iterate(fn, reverse);\n    };\n\n    Record.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      var newMap = this._map && this._map.__ensureOwner(ownerID);\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this._map = newMap;\n        return this;\n      }\n      return makeRecord(this, newMap, ownerID);\n    };\n\n\n  var RecordPrototype = Record.prototype;\n  RecordPrototype[DELETE] = RecordPrototype.remove;\n  RecordPrototype.deleteIn =\n  RecordPrototype.removeIn = MapPrototype.removeIn;\n  RecordPrototype.merge = MapPrototype.merge;\n  RecordPrototype.mergeWith = MapPrototype.mergeWith;\n  RecordPrototype.mergeIn = MapPrototype.mergeIn;\n  RecordPrototype.mergeDeep = MapPrototype.mergeDeep;\n  RecordPrototype.mergeDeepWith = MapPrototype.mergeDeepWith;\n  RecordPrototype.mergeDeepIn = MapPrototype.mergeDeepIn;\n  RecordPrototype.setIn = MapPrototype.setIn;\n  RecordPrototype.update = MapPrototype.update;\n  RecordPrototype.updateIn = MapPrototype.updateIn;\n  RecordPrototype.withMutations = MapPrototype.withMutations;\n  RecordPrototype.asMutable = MapPrototype.asMutable;\n  RecordPrototype.asImmutable = MapPrototype.asImmutable;\n\n\n  function makeRecord(likeRecord, map, ownerID) {\n    var record = Object.create(Object.getPrototypeOf(likeRecord));\n    record._map = map;\n    record.__ownerID = ownerID;\n    return record;\n  }\n\n  function recordName(record) {\n    return record._name || record.constructor.name || 'Record';\n  }\n\n  function setProps(prototype, names) {\n    try {\n      names.forEach(setProp.bind(undefined, prototype));\n    } catch (error) {\n      // Object.defineProperty failed. Probably IE8.\n    }\n  }\n\n  function setProp(prototype, name) {\n    Object.defineProperty(prototype, name, {\n      get: function() {\n        return this.get(name);\n      },\n      set: function(value) {\n        invariant(this.__ownerID, 'Cannot set on an immutable record.');\n        this.set(name, value);\n      }\n    });\n  }\n\n  createClass(Set, SetCollection);\n\n    // @pragma Construction\n\n    function Set(value) {\n      return value === null || value === undefined ? emptySet() :\n        isSet(value) && !isOrdered(value) ? value :\n        emptySet().withMutations(function(set ) {\n          var iter = SetIterable(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function(v ) {return set.add(v)});\n        });\n    }\n\n    Set.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    Set.fromKeys = function(value) {\n      return this(KeyedIterable(value).keySeq());\n    };\n\n    Set.prototype.toString = function() {\n      return this.__toString('Set {', '}');\n    };\n\n    // @pragma Access\n\n    Set.prototype.has = function(value) {\n      return this._map.has(value);\n    };\n\n    // @pragma Modification\n\n    Set.prototype.add = function(value) {\n      return updateSet(this, this._map.set(value, true));\n    };\n\n    Set.prototype.remove = function(value) {\n      return updateSet(this, this._map.remove(value));\n    };\n\n    Set.prototype.clear = function() {\n      return updateSet(this, this._map.clear());\n    };\n\n    // @pragma Composition\n\n    Set.prototype.union = function() {var iters = SLICE$0.call(arguments, 0);\n      iters = iters.filter(function(x ) {return x.size !== 0});\n      if (iters.length === 0) {\n        return this;\n      }\n      if (this.size === 0 && !this.__ownerID && iters.length === 1) {\n        return this.constructor(iters[0]);\n      }\n      return this.withMutations(function(set ) {\n        for (var ii = 0; ii < iters.length; ii++) {\n          SetIterable(iters[ii]).forEach(function(value ) {return set.add(value)});\n        }\n      });\n    };\n\n    Set.prototype.intersect = function() {var iters = SLICE$0.call(arguments, 0);\n      if (iters.length === 0) {\n        return this;\n      }\n      iters = iters.map(function(iter ) {return SetIterable(iter)});\n      var originalSet = this;\n      return this.withMutations(function(set ) {\n        originalSet.forEach(function(value ) {\n          if (!iters.every(function(iter ) {return iter.includes(value)})) {\n            set.remove(value);\n          }\n        });\n      });\n    };\n\n    Set.prototype.subtract = function() {var iters = SLICE$0.call(arguments, 0);\n      if (iters.length === 0) {\n        return this;\n      }\n      iters = iters.map(function(iter ) {return SetIterable(iter)});\n      var originalSet = this;\n      return this.withMutations(function(set ) {\n        originalSet.forEach(function(value ) {\n          if (iters.some(function(iter ) {return iter.includes(value)})) {\n            set.remove(value);\n          }\n        });\n      });\n    };\n\n    Set.prototype.merge = function() {\n      return this.union.apply(this, arguments);\n    };\n\n    Set.prototype.mergeWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return this.union.apply(this, iters);\n    };\n\n    Set.prototype.sort = function(comparator) {\n      // Late binding\n      return OrderedSet(sortFactory(this, comparator));\n    };\n\n    Set.prototype.sortBy = function(mapper, comparator) {\n      // Late binding\n      return OrderedSet(sortFactory(this, comparator, mapper));\n    };\n\n    Set.prototype.wasAltered = function() {\n      return this._map.wasAltered();\n    };\n\n    Set.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return this._map.__iterate(function(_, k)  {return fn(k, k, this$0)}, reverse);\n    };\n\n    Set.prototype.__iterator = function(type, reverse) {\n      return this._map.map(function(_, k)  {return k}).__iterator(type, reverse);\n    };\n\n    Set.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      var newMap = this._map.__ensureOwner(ownerID);\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this._map = newMap;\n        return this;\n      }\n      return this.__make(newMap, ownerID);\n    };\n\n\n  function isSet(maybeSet) {\n    return !!(maybeSet && maybeSet[IS_SET_SENTINEL]);\n  }\n\n  Set.isSet = isSet;\n\n  var IS_SET_SENTINEL = '@@__IMMUTABLE_SET__@@';\n\n  var SetPrototype = Set.prototype;\n  SetPrototype[IS_SET_SENTINEL] = true;\n  SetPrototype[DELETE] = SetPrototype.remove;\n  SetPrototype.mergeDeep = SetPrototype.merge;\n  SetPrototype.mergeDeepWith = SetPrototype.mergeWith;\n  SetPrototype.withMutations = MapPrototype.withMutations;\n  SetPrototype.asMutable = MapPrototype.asMutable;\n  SetPrototype.asImmutable = MapPrototype.asImmutable;\n\n  SetPrototype.__empty = emptySet;\n  SetPrototype.__make = makeSet;\n\n  function updateSet(set, newMap) {\n    if (set.__ownerID) {\n      set.size = newMap.size;\n      set._map = newMap;\n      return set;\n    }\n    return newMap === set._map ? set :\n      newMap.size === 0 ? set.__empty() :\n      set.__make(newMap);\n  }\n\n  function makeSet(map, ownerID) {\n    var set = Object.create(SetPrototype);\n    set.size = map ? map.size : 0;\n    set._map = map;\n    set.__ownerID = ownerID;\n    return set;\n  }\n\n  var EMPTY_SET;\n  function emptySet() {\n    return EMPTY_SET || (EMPTY_SET = makeSet(emptyMap()));\n  }\n\n  createClass(OrderedSet, Set);\n\n    // @pragma Construction\n\n    function OrderedSet(value) {\n      return value === null || value === undefined ? emptyOrderedSet() :\n        isOrderedSet(value) ? value :\n        emptyOrderedSet().withMutations(function(set ) {\n          var iter = SetIterable(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function(v ) {return set.add(v)});\n        });\n    }\n\n    OrderedSet.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    OrderedSet.fromKeys = function(value) {\n      return this(KeyedIterable(value).keySeq());\n    };\n\n    OrderedSet.prototype.toString = function() {\n      return this.__toString('OrderedSet {', '}');\n    };\n\n\n  function isOrderedSet(maybeOrderedSet) {\n    return isSet(maybeOrderedSet) && isOrdered(maybeOrderedSet);\n  }\n\n  OrderedSet.isOrderedSet = isOrderedSet;\n\n  var OrderedSetPrototype = OrderedSet.prototype;\n  OrderedSetPrototype[IS_ORDERED_SENTINEL] = true;\n\n  OrderedSetPrototype.__empty = emptyOrderedSet;\n  OrderedSetPrototype.__make = makeOrderedSet;\n\n  function makeOrderedSet(map, ownerID) {\n    var set = Object.create(OrderedSetPrototype);\n    set.size = map ? map.size : 0;\n    set._map = map;\n    set.__ownerID = ownerID;\n    return set;\n  }\n\n  var EMPTY_ORDERED_SET;\n  function emptyOrderedSet() {\n    return EMPTY_ORDERED_SET || (EMPTY_ORDERED_SET = makeOrderedSet(emptyOrderedMap()));\n  }\n\n  createClass(Stack, IndexedCollection);\n\n    // @pragma Construction\n\n    function Stack(value) {\n      return value === null || value === undefined ? emptyStack() :\n        isStack(value) ? value :\n        emptyStack().unshiftAll(value);\n    }\n\n    Stack.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    Stack.prototype.toString = function() {\n      return this.__toString('Stack [', ']');\n    };\n\n    // @pragma Access\n\n    Stack.prototype.get = function(index, notSetValue) {\n      var head = this._head;\n      index = wrapIndex(this, index);\n      while (head && index--) {\n        head = head.next;\n      }\n      return head ? head.value : notSetValue;\n    };\n\n    Stack.prototype.peek = function() {\n      return this._head && this._head.value;\n    };\n\n    // @pragma Modification\n\n    Stack.prototype.push = function(/*...values*/) {\n      if (arguments.length === 0) {\n        return this;\n      }\n      var newSize = this.size + arguments.length;\n      var head = this._head;\n      for (var ii = arguments.length - 1; ii >= 0; ii--) {\n        head = {\n          value: arguments[ii],\n          next: head\n        };\n      }\n      if (this.__ownerID) {\n        this.size = newSize;\n        this._head = head;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return makeStack(newSize, head);\n    };\n\n    Stack.prototype.pushAll = function(iter) {\n      iter = IndexedIterable(iter);\n      if (iter.size === 0) {\n        return this;\n      }\n      assertNotInfinite(iter.size);\n      var newSize = this.size;\n      var head = this._head;\n      iter.reverse().forEach(function(value ) {\n        newSize++;\n        head = {\n          value: value,\n          next: head\n        };\n      });\n      if (this.__ownerID) {\n        this.size = newSize;\n        this._head = head;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return makeStack(newSize, head);\n    };\n\n    Stack.prototype.pop = function() {\n      return this.slice(1);\n    };\n\n    Stack.prototype.unshift = function(/*...values*/) {\n      return this.push.apply(this, arguments);\n    };\n\n    Stack.prototype.unshiftAll = function(iter) {\n      return this.pushAll(iter);\n    };\n\n    Stack.prototype.shift = function() {\n      return this.pop.apply(this, arguments);\n    };\n\n    Stack.prototype.clear = function() {\n      if (this.size === 0) {\n        return this;\n      }\n      if (this.__ownerID) {\n        this.size = 0;\n        this._head = undefined;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return emptyStack();\n    };\n\n    Stack.prototype.slice = function(begin, end) {\n      if (wholeSlice(begin, end, this.size)) {\n        return this;\n      }\n      var resolvedBegin = resolveBegin(begin, this.size);\n      var resolvedEnd = resolveEnd(end, this.size);\n      if (resolvedEnd !== this.size) {\n        // super.slice(begin, end);\n        return IndexedCollection.prototype.slice.call(this, begin, end);\n      }\n      var newSize = this.size - resolvedBegin;\n      var head = this._head;\n      while (resolvedBegin--) {\n        head = head.next;\n      }\n      if (this.__ownerID) {\n        this.size = newSize;\n        this._head = head;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return makeStack(newSize, head);\n    };\n\n    // @pragma Mutability\n\n    Stack.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this.__altered = false;\n        return this;\n      }\n      return makeStack(this.size, this._head, ownerID, this.__hash);\n    };\n\n    // @pragma Iteration\n\n    Stack.prototype.__iterate = function(fn, reverse) {\n      if (reverse) {\n        return this.reverse().__iterate(fn);\n      }\n      var iterations = 0;\n      var node = this._head;\n      while (node) {\n        if (fn(node.value, iterations++, this) === false) {\n          break;\n        }\n        node = node.next;\n      }\n      return iterations;\n    };\n\n    Stack.prototype.__iterator = function(type, reverse) {\n      if (reverse) {\n        return this.reverse().__iterator(type);\n      }\n      var iterations = 0;\n      var node = this._head;\n      return new Iterator(function()  {\n        if (node) {\n          var value = node.value;\n          node = node.next;\n          return iteratorValue(type, iterations++, value);\n        }\n        return iteratorDone();\n      });\n    };\n\n\n  function isStack(maybeStack) {\n    return !!(maybeStack && maybeStack[IS_STACK_SENTINEL]);\n  }\n\n  Stack.isStack = isStack;\n\n  var IS_STACK_SENTINEL = '@@__IMMUTABLE_STACK__@@';\n\n  var StackPrototype = Stack.prototype;\n  StackPrototype[IS_STACK_SENTINEL] = true;\n  StackPrototype.withMutations = MapPrototype.withMutations;\n  StackPrototype.asMutable = MapPrototype.asMutable;\n  StackPrototype.asImmutable = MapPrototype.asImmutable;\n  StackPrototype.wasAltered = MapPrototype.wasAltered;\n\n\n  function makeStack(size, head, ownerID, hash) {\n    var map = Object.create(StackPrototype);\n    map.size = size;\n    map._head = head;\n    map.__ownerID = ownerID;\n    map.__hash = hash;\n    map.__altered = false;\n    return map;\n  }\n\n  var EMPTY_STACK;\n  function emptyStack() {\n    return EMPTY_STACK || (EMPTY_STACK = makeStack(0));\n  }\n\n  /**\n   * Contributes additional methods to a constructor\n   */\n  function mixin(ctor, methods) {\n    var keyCopier = function(key ) { ctor.prototype[key] = methods[key]; };\n    Object.keys(methods).forEach(keyCopier);\n    Object.getOwnPropertySymbols &&\n      Object.getOwnPropertySymbols(methods).forEach(keyCopier);\n    return ctor;\n  }\n\n  Iterable.Iterator = Iterator;\n\n  mixin(Iterable, {\n\n    // ### Conversion to other types\n\n    toArray: function() {\n      assertNotInfinite(this.size);\n      var array = new Array(this.size || 0);\n      this.valueSeq().__iterate(function(v, i)  { array[i] = v; });\n      return array;\n    },\n\n    toIndexedSeq: function() {\n      return new ToIndexedSequence(this);\n    },\n\n    toJS: function() {\n      return this.toSeq().map(\n        function(value ) {return value && typeof value.toJS === 'function' ? value.toJS() : value}\n      ).__toJS();\n    },\n\n    toJSON: function() {\n      return this.toSeq().map(\n        function(value ) {return value && typeof value.toJSON === 'function' ? value.toJSON() : value}\n      ).__toJS();\n    },\n\n    toKeyedSeq: function() {\n      return new ToKeyedSequence(this, true);\n    },\n\n    toMap: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return Map(this.toKeyedSeq());\n    },\n\n    toObject: function() {\n      assertNotInfinite(this.size);\n      var object = {};\n      this.__iterate(function(v, k)  { object[k] = v; });\n      return object;\n    },\n\n    toOrderedMap: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return OrderedMap(this.toKeyedSeq());\n    },\n\n    toOrderedSet: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return OrderedSet(isKeyed(this) ? this.valueSeq() : this);\n    },\n\n    toSet: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return Set(isKeyed(this) ? this.valueSeq() : this);\n    },\n\n    toSetSeq: function() {\n      return new ToSetSequence(this);\n    },\n\n    toSeq: function() {\n      return isIndexed(this) ? this.toIndexedSeq() :\n        isKeyed(this) ? this.toKeyedSeq() :\n        this.toSetSeq();\n    },\n\n    toStack: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return Stack(isKeyed(this) ? this.valueSeq() : this);\n    },\n\n    toList: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return List(isKeyed(this) ? this.valueSeq() : this);\n    },\n\n\n    // ### Common JavaScript methods and properties\n\n    toString: function() {\n      return '[Iterable]';\n    },\n\n    __toString: function(head, tail) {\n      if (this.size === 0) {\n        return head + tail;\n      }\n      return head + ' ' + this.toSeq().map(this.__toStringMapper).join(', ') + ' ' + tail;\n    },\n\n\n    // ### ES6 Collection methods (ES6 Array and Map)\n\n    concat: function() {var values = SLICE$0.call(arguments, 0);\n      return reify(this, concatFactory(this, values));\n    },\n\n    includes: function(searchValue) {\n      return this.some(function(value ) {return is(value, searchValue)});\n    },\n\n    entries: function() {\n      return this.__iterator(ITERATE_ENTRIES);\n    },\n\n    every: function(predicate, context) {\n      assertNotInfinite(this.size);\n      var returnValue = true;\n      this.__iterate(function(v, k, c)  {\n        if (!predicate.call(context, v, k, c)) {\n          returnValue = false;\n          return false;\n        }\n      });\n      return returnValue;\n    },\n\n    filter: function(predicate, context) {\n      return reify(this, filterFactory(this, predicate, context, true));\n    },\n\n    find: function(predicate, context, notSetValue) {\n      var entry = this.findEntry(predicate, context);\n      return entry ? entry[1] : notSetValue;\n    },\n\n    forEach: function(sideEffect, context) {\n      assertNotInfinite(this.size);\n      return this.__iterate(context ? sideEffect.bind(context) : sideEffect);\n    },\n\n    join: function(separator) {\n      assertNotInfinite(this.size);\n      separator = separator !== undefined ? '' + separator : ',';\n      var joined = '';\n      var isFirst = true;\n      this.__iterate(function(v ) {\n        isFirst ? (isFirst = false) : (joined += separator);\n        joined += v !== null && v !== undefined ? v.toString() : '';\n      });\n      return joined;\n    },\n\n    keys: function() {\n      return this.__iterator(ITERATE_KEYS);\n    },\n\n    map: function(mapper, context) {\n      return reify(this, mapFactory(this, mapper, context));\n    },\n\n    reduce: function(reducer, initialReduction, context) {\n      assertNotInfinite(this.size);\n      var reduction;\n      var useFirst;\n      if (arguments.length < 2) {\n        useFirst = true;\n      } else {\n        reduction = initialReduction;\n      }\n      this.__iterate(function(v, k, c)  {\n        if (useFirst) {\n          useFirst = false;\n          reduction = v;\n        } else {\n          reduction = reducer.call(context, reduction, v, k, c);\n        }\n      });\n      return reduction;\n    },\n\n    reduceRight: function(reducer, initialReduction, context) {\n      var reversed = this.toKeyedSeq().reverse();\n      return reversed.reduce.apply(reversed, arguments);\n    },\n\n    reverse: function() {\n      return reify(this, reverseFactory(this, true));\n    },\n\n    slice: function(begin, end) {\n      return reify(this, sliceFactory(this, begin, end, true));\n    },\n\n    some: function(predicate, context) {\n      return !this.every(not(predicate), context);\n    },\n\n    sort: function(comparator) {\n      return reify(this, sortFactory(this, comparator));\n    },\n\n    values: function() {\n      return this.__iterator(ITERATE_VALUES);\n    },\n\n\n    // ### More sequential methods\n\n    butLast: function() {\n      return this.slice(0, -1);\n    },\n\n    isEmpty: function() {\n      return this.size !== undefined ? this.size === 0 : !this.some(function()  {return true});\n    },\n\n    count: function(predicate, context) {\n      return ensureSize(\n        predicate ? this.toSeq().filter(predicate, context) : this\n      );\n    },\n\n    countBy: function(grouper, context) {\n      return countByFactory(this, grouper, context);\n    },\n\n    equals: function(other) {\n      return deepEqual(this, other);\n    },\n\n    entrySeq: function() {\n      var iterable = this;\n      if (iterable._cache) {\n        // We cache as an entries array, so we can just return the cache!\n        return new ArraySeq(iterable._cache);\n      }\n      var entriesSequence = iterable.toSeq().map(entryMapper).toIndexedSeq();\n      entriesSequence.fromEntrySeq = function()  {return iterable.toSeq()};\n      return entriesSequence;\n    },\n\n    filterNot: function(predicate, context) {\n      return this.filter(not(predicate), context);\n    },\n\n    findEntry: function(predicate, context, notSetValue) {\n      var found = notSetValue;\n      this.__iterate(function(v, k, c)  {\n        if (predicate.call(context, v, k, c)) {\n          found = [k, v];\n          return false;\n        }\n      });\n      return found;\n    },\n\n    findKey: function(predicate, context) {\n      var entry = this.findEntry(predicate, context);\n      return entry && entry[0];\n    },\n\n    findLast: function(predicate, context, notSetValue) {\n      return this.toKeyedSeq().reverse().find(predicate, context, notSetValue);\n    },\n\n    findLastEntry: function(predicate, context, notSetValue) {\n      return this.toKeyedSeq().reverse().findEntry(predicate, context, notSetValue);\n    },\n\n    findLastKey: function(predicate, context) {\n      return this.toKeyedSeq().reverse().findKey(predicate, context);\n    },\n\n    first: function() {\n      return this.find(returnTrue);\n    },\n\n    flatMap: function(mapper, context) {\n      return reify(this, flatMapFactory(this, mapper, context));\n    },\n\n    flatten: function(depth) {\n      return reify(this, flattenFactory(this, depth, true));\n    },\n\n    fromEntrySeq: function() {\n      return new FromEntriesSequence(this);\n    },\n\n    get: function(searchKey, notSetValue) {\n      return this.find(function(_, key)  {return is(key, searchKey)}, undefined, notSetValue);\n    },\n\n    getIn: function(searchKeyPath, notSetValue) {\n      var nested = this;\n      // Note: in an ES6 environment, we would prefer:\n      // for (var key of searchKeyPath) {\n      var iter = forceIterator(searchKeyPath);\n      var step;\n      while (!(step = iter.next()).done) {\n        var key = step.value;\n        nested = nested && nested.get ? nested.get(key, NOT_SET) : NOT_SET;\n        if (nested === NOT_SET) {\n          return notSetValue;\n        }\n      }\n      return nested;\n    },\n\n    groupBy: function(grouper, context) {\n      return groupByFactory(this, grouper, context);\n    },\n\n    has: function(searchKey) {\n      return this.get(searchKey, NOT_SET) !== NOT_SET;\n    },\n\n    hasIn: function(searchKeyPath) {\n      return this.getIn(searchKeyPath, NOT_SET) !== NOT_SET;\n    },\n\n    isSubset: function(iter) {\n      iter = typeof iter.includes === 'function' ? iter : Iterable(iter);\n      return this.every(function(value ) {return iter.includes(value)});\n    },\n\n    isSuperset: function(iter) {\n      iter = typeof iter.isSubset === 'function' ? iter : Iterable(iter);\n      return iter.isSubset(this);\n    },\n\n    keyOf: function(searchValue) {\n      return this.findKey(function(value ) {return is(value, searchValue)});\n    },\n\n    keySeq: function() {\n      return this.toSeq().map(keyMapper).toIndexedSeq();\n    },\n\n    last: function() {\n      return this.toSeq().reverse().first();\n    },\n\n    lastKeyOf: function(searchValue) {\n      return this.toKeyedSeq().reverse().keyOf(searchValue);\n    },\n\n    max: function(comparator) {\n      return maxFactory(this, comparator);\n    },\n\n    maxBy: function(mapper, comparator) {\n      return maxFactory(this, comparator, mapper);\n    },\n\n    min: function(comparator) {\n      return maxFactory(this, comparator ? neg(comparator) : defaultNegComparator);\n    },\n\n    minBy: function(mapper, comparator) {\n      return maxFactory(this, comparator ? neg(comparator) : defaultNegComparator, mapper);\n    },\n\n    rest: function() {\n      return this.slice(1);\n    },\n\n    skip: function(amount) {\n      return this.slice(Math.max(0, amount));\n    },\n\n    skipLast: function(amount) {\n      return reify(this, this.toSeq().reverse().skip(amount).reverse());\n    },\n\n    skipWhile: function(predicate, context) {\n      return reify(this, skipWhileFactory(this, predicate, context, true));\n    },\n\n    skipUntil: function(predicate, context) {\n      return this.skipWhile(not(predicate), context);\n    },\n\n    sortBy: function(mapper, comparator) {\n      return reify(this, sortFactory(this, comparator, mapper));\n    },\n\n    take: function(amount) {\n      return this.slice(0, Math.max(0, amount));\n    },\n\n    takeLast: function(amount) {\n      return reify(this, this.toSeq().reverse().take(amount).reverse());\n    },\n\n    takeWhile: function(predicate, context) {\n      return reify(this, takeWhileFactory(this, predicate, context));\n    },\n\n    takeUntil: function(predicate, context) {\n      return this.takeWhile(not(predicate), context);\n    },\n\n    valueSeq: function() {\n      return this.toIndexedSeq();\n    },\n\n\n    // ### Hashable Object\n\n    hashCode: function() {\n      return this.__hash || (this.__hash = hashIterable(this));\n    }\n\n\n    // ### Internal\n\n    // abstract __iterate(fn, reverse)\n\n    // abstract __iterator(type, reverse)\n  });\n\n  // var IS_ITERABLE_SENTINEL = '@@__IMMUTABLE_ITERABLE__@@';\n  // var IS_KEYED_SENTINEL = '@@__IMMUTABLE_KEYED__@@';\n  // var IS_INDEXED_SENTINEL = '@@__IMMUTABLE_INDEXED__@@';\n  // var IS_ORDERED_SENTINEL = '@@__IMMUTABLE_ORDERED__@@';\n\n  var IterablePrototype = Iterable.prototype;\n  IterablePrototype[IS_ITERABLE_SENTINEL] = true;\n  IterablePrototype[ITERATOR_SYMBOL] = IterablePrototype.values;\n  IterablePrototype.__toJS = IterablePrototype.toArray;\n  IterablePrototype.__toStringMapper = quoteString;\n  IterablePrototype.inspect =\n  IterablePrototype.toSource = function() { return this.toString(); };\n  IterablePrototype.chain = IterablePrototype.flatMap;\n  IterablePrototype.contains = IterablePrototype.includes;\n\n  mixin(KeyedIterable, {\n\n    // ### More sequential methods\n\n    flip: function() {\n      return reify(this, flipFactory(this));\n    },\n\n    mapEntries: function(mapper, context) {var this$0 = this;\n      var iterations = 0;\n      return reify(this,\n        this.toSeq().map(\n          function(v, k)  {return mapper.call(context, [k, v], iterations++, this$0)}\n        ).fromEntrySeq()\n      );\n    },\n\n    mapKeys: function(mapper, context) {var this$0 = this;\n      return reify(this,\n        this.toSeq().flip().map(\n          function(k, v)  {return mapper.call(context, k, v, this$0)}\n        ).flip()\n      );\n    }\n\n  });\n\n  var KeyedIterablePrototype = KeyedIterable.prototype;\n  KeyedIterablePrototype[IS_KEYED_SENTINEL] = true;\n  KeyedIterablePrototype[ITERATOR_SYMBOL] = IterablePrototype.entries;\n  KeyedIterablePrototype.__toJS = IterablePrototype.toObject;\n  KeyedIterablePrototype.__toStringMapper = function(v, k)  {return JSON.stringify(k) + ': ' + quoteString(v)};\n\n\n\n  mixin(IndexedIterable, {\n\n    // ### Conversion to other types\n\n    toKeyedSeq: function() {\n      return new ToKeyedSequence(this, false);\n    },\n\n\n    // ### ES6 Collection methods (ES6 Array and Map)\n\n    filter: function(predicate, context) {\n      return reify(this, filterFactory(this, predicate, context, false));\n    },\n\n    findIndex: function(predicate, context) {\n      var entry = this.findEntry(predicate, context);\n      return entry ? entry[0] : -1;\n    },\n\n    indexOf: function(searchValue) {\n      var key = this.keyOf(searchValue);\n      return key === undefined ? -1 : key;\n    },\n\n    lastIndexOf: function(searchValue) {\n      var key = this.lastKeyOf(searchValue);\n      return key === undefined ? -1 : key;\n    },\n\n    reverse: function() {\n      return reify(this, reverseFactory(this, false));\n    },\n\n    slice: function(begin, end) {\n      return reify(this, sliceFactory(this, begin, end, false));\n    },\n\n    splice: function(index, removeNum /*, ...values*/) {\n      var numArgs = arguments.length;\n      removeNum = Math.max(removeNum | 0, 0);\n      if (numArgs === 0 || (numArgs === 2 && !removeNum)) {\n        return this;\n      }\n      // If index is negative, it should resolve relative to the size of the\n      // collection. However size may be expensive to compute if not cached, so\n      // only call count() if the number is in fact negative.\n      index = resolveBegin(index, index < 0 ? this.count() : this.size);\n      var spliced = this.slice(0, index);\n      return reify(\n        this,\n        numArgs === 1 ?\n          spliced :\n          spliced.concat(arrCopy(arguments, 2), this.slice(index + removeNum))\n      );\n    },\n\n\n    // ### More collection methods\n\n    findLastIndex: function(predicate, context) {\n      var entry = this.findLastEntry(predicate, context);\n      return entry ? entry[0] : -1;\n    },\n\n    first: function() {\n      return this.get(0);\n    },\n\n    flatten: function(depth) {\n      return reify(this, flattenFactory(this, depth, false));\n    },\n\n    get: function(index, notSetValue) {\n      index = wrapIndex(this, index);\n      return (index < 0 || (this.size === Infinity ||\n          (this.size !== undefined && index > this.size))) ?\n        notSetValue :\n        this.find(function(_, key)  {return key === index}, undefined, notSetValue);\n    },\n\n    has: function(index) {\n      index = wrapIndex(this, index);\n      return index >= 0 && (this.size !== undefined ?\n        this.size === Infinity || index < this.size :\n        this.indexOf(index) !== -1\n      );\n    },\n\n    interpose: function(separator) {\n      return reify(this, interposeFactory(this, separator));\n    },\n\n    interleave: function(/*...iterables*/) {\n      var iterables = [this].concat(arrCopy(arguments));\n      var zipped = zipWithFactory(this.toSeq(), IndexedSeq.of, iterables);\n      var interleaved = zipped.flatten(true);\n      if (zipped.size) {\n        interleaved.size = zipped.size * iterables.length;\n      }\n      return reify(this, interleaved);\n    },\n\n    keySeq: function() {\n      return Range(0, this.size);\n    },\n\n    last: function() {\n      return this.get(-1);\n    },\n\n    skipWhile: function(predicate, context) {\n      return reify(this, skipWhileFactory(this, predicate, context, false));\n    },\n\n    zip: function(/*, ...iterables */) {\n      var iterables = [this].concat(arrCopy(arguments));\n      return reify(this, zipWithFactory(this, defaultZipper, iterables));\n    },\n\n    zipWith: function(zipper/*, ...iterables */) {\n      var iterables = arrCopy(arguments);\n      iterables[0] = this;\n      return reify(this, zipWithFactory(this, zipper, iterables));\n    }\n\n  });\n\n  IndexedIterable.prototype[IS_INDEXED_SENTINEL] = true;\n  IndexedIterable.prototype[IS_ORDERED_SENTINEL] = true;\n\n\n\n  mixin(SetIterable, {\n\n    // ### ES6 Collection methods (ES6 Array and Map)\n\n    get: function(value, notSetValue) {\n      return this.has(value) ? value : notSetValue;\n    },\n\n    includes: function(value) {\n      return this.has(value);\n    },\n\n\n    // ### More sequential methods\n\n    keySeq: function() {\n      return this.valueSeq();\n    }\n\n  });\n\n  SetIterable.prototype.has = IterablePrototype.includes;\n  SetIterable.prototype.contains = SetIterable.prototype.includes;\n\n\n  // Mixin subclasses\n\n  mixin(KeyedSeq, KeyedIterable.prototype);\n  mixin(IndexedSeq, IndexedIterable.prototype);\n  mixin(SetSeq, SetIterable.prototype);\n\n  mixin(KeyedCollection, KeyedIterable.prototype);\n  mixin(IndexedCollection, IndexedIterable.prototype);\n  mixin(SetCollection, SetIterable.prototype);\n\n\n  // #pragma Helper functions\n\n  function keyMapper(v, k) {\n    return k;\n  }\n\n  function entryMapper(v, k) {\n    return [k, v];\n  }\n\n  function not(predicate) {\n    return function() {\n      return !predicate.apply(this, arguments);\n    }\n  }\n\n  function neg(predicate) {\n    return function() {\n      return -predicate.apply(this, arguments);\n    }\n  }\n\n  function quoteString(value) {\n    return typeof value === 'string' ? JSON.stringify(value) : String(value);\n  }\n\n  function defaultZipper() {\n    return arrCopy(arguments);\n  }\n\n  function defaultNegComparator(a, b) {\n    return a < b ? 1 : a > b ? -1 : 0;\n  }\n\n  function hashIterable(iterable) {\n    if (iterable.size === Infinity) {\n      return 0;\n    }\n    var ordered = isOrdered(iterable);\n    var keyed = isKeyed(iterable);\n    var h = ordered ? 1 : 0;\n    var size = iterable.__iterate(\n      keyed ?\n        ordered ?\n          function(v, k)  { h = 31 * h + hashMerge(hash(v), hash(k)) | 0; } :\n          function(v, k)  { h = h + hashMerge(hash(v), hash(k)) | 0; } :\n        ordered ?\n          function(v ) { h = 31 * h + hash(v) | 0; } :\n          function(v ) { h = h + hash(v) | 0; }\n    );\n    return murmurHashOfSize(size, h);\n  }\n\n  function murmurHashOfSize(size, h) {\n    h = imul(h, 0xCC9E2D51);\n    h = imul(h << 15 | h >>> -15, 0x1B873593);\n    h = imul(h << 13 | h >>> -13, 5);\n    h = (h + 0xE6546B64 | 0) ^ size;\n    h = imul(h ^ h >>> 16, 0x85EBCA6B);\n    h = imul(h ^ h >>> 13, 0xC2B2AE35);\n    h = smi(h ^ h >>> 16);\n    return h;\n  }\n\n  function hashMerge(a, b) {\n    return a ^ b + 0x9E3779B9 + (a << 6) + (a >> 2) | 0; // int\n  }\n\n  var Immutable = {\n\n    Iterable: Iterable,\n\n    Seq: Seq,\n    Collection: Collection,\n    Map: Map,\n    OrderedMap: OrderedMap,\n    List: List,\n    Stack: Stack,\n    Set: Set,\n    OrderedSet: OrderedSet,\n\n    Record: Record,\n    Range: Range,\n    Repeat: Repeat,\n\n    is: is,\n    fromJS: fromJS\n\n  };\n\n  return Immutable;\n\n}));\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/immutable/dist/immutable.js\n// module id = 67\n// module chunks = 0 1 2","// jshint newcap: false\n/* global require, module, document, Element */\n'use strict';\n\nvar VNode = require('./vnode');\nvar is = require('./is');\n\nfunction isUndef(s) { return s === undefined; }\nfunction isDef(s) { return s !== undefined; }\n\nfunction emptyNodeAt(elm) {\n  return VNode(elm.tagName, {}, [], undefined, elm);\n}\n\nvar emptyNode = VNode('', {}, [], undefined, undefined);\n\nfunction sameVnode(vnode1, vnode2) {\n  return vnode1.key === vnode2.key && vnode1.sel === vnode2.sel;\n}\n\nfunction createKeyToOldIdx(children, beginIdx, endIdx) {\n  var i, map = {}, key;\n  for (i = beginIdx; i <= endIdx; ++i) {\n    key = children[i].key;\n    if (isDef(key)) map[key] = i;\n  }\n  return map;\n}\n\nfunction createRmCb(childElm, listeners) {\n  return function() {\n    if (--listeners === 0) childElm.parentElement.removeChild(childElm);\n  };\n}\n\nvar hooks = ['create', 'update', 'remove', 'destroy', 'pre', 'post'];\n\nfunction init(modules) {\n  var i, j, cbs = {};\n  for (i = 0; i < hooks.length; ++i) {\n    cbs[hooks[i]] = [];\n    for (j = 0; j < modules.length; ++j) {\n      if (modules[j][hooks[i]] !== undefined) cbs[hooks[i]].push(modules[j][hooks[i]]);\n    }\n  }\n\n  function createElm(vnode, insertedVnodeQueue) {\n    var i, data = vnode.data;\n    if (isDef(data)) {\n      if (isDef(i = data.hook) && isDef(i = i.init)) i(vnode);\n      if (isDef(i = data.vnode)) vnode = i;\n    }\n    var elm, children = vnode.children, sel = vnode.sel;\n    if (isDef(sel)) {\n      // Parse selector\n      var hashIdx = sel.indexOf('#');\n      var dotIdx = sel.indexOf('.', hashIdx);\n      var hash = hashIdx > 0 ? hashIdx : sel.length;\n      var dot = dotIdx > 0 ? dotIdx : sel.length;\n      var tag = hashIdx !== -1 || dotIdx !== -1 ? sel.slice(0, Math.min(hash, dot)) : sel;\n      elm = vnode.elm = isDef(data) && isDef(i = data.ns) ? document.createElementNS(i, tag)\n                                                          : document.createElement(tag);\n      if (hash < dot) elm.id = sel.slice(hash + 1, dot);\n      if (dotIdx > 0) elm.className = sel.slice(dot+1).replace(/\\./g, ' ');\n      if (is.array(children)) {\n        for (i = 0; i < children.length; ++i) {\n          elm.appendChild(createElm(children[i], insertedVnodeQueue));\n        }\n      } else if (is.primitive(vnode.text)) {\n        elm.appendChild(document.createTextNode(vnode.text));\n      }\n      for (i = 0; i < cbs.create.length; ++i) cbs.create[i](emptyNode, vnode);\n      i = vnode.data.hook; // Reuse variable\n      if (isDef(i)) {\n        if (i.create) i.create(emptyNode, vnode);\n        if (i.insert) insertedVnodeQueue.push(vnode);\n      }\n    } else {\n      elm = vnode.elm = document.createTextNode(vnode.text);\n    }\n    return vnode.elm;\n  }\n\n  function addVnodes(parentElm, before, vnodes, startIdx, endIdx, insertedVnodeQueue) {\n    for (; startIdx <= endIdx; ++startIdx) {\n      parentElm.insertBefore(createElm(vnodes[startIdx], insertedVnodeQueue), before);\n    }\n  }\n\n  function invokeDestroyHook(vnode) {\n    var i = vnode.data, j;\n    if (isDef(i)) {\n      if (isDef(i = i.hook) && isDef(i = i.destroy)) i(vnode);\n      for (i = 0; i < cbs.destroy.length; ++i) cbs.destroy[i](vnode);\n      if (isDef(i = vnode.children)) {\n        for (j = 0; j < vnode.children.length; ++j) {\n          invokeDestroyHook(vnode.children[j]);\n        }\n      }\n    }\n  }\n\n  function removeVnodes(parentElm, vnodes, startIdx, endIdx) {\n    for (; startIdx <= endIdx; ++startIdx) {\n      var i, listeners, rm, ch = vnodes[startIdx];\n      if (isDef(ch)) {\n        if (isDef(ch.sel)) {\n          invokeDestroyHook(ch);\n          listeners = cbs.remove.length + 1;\n          rm = createRmCb(ch.elm, listeners);\n          for (i = 0; i < cbs.remove.length; ++i) cbs.remove[i](ch, rm);\n          if (isDef(i = ch.data) && isDef(i = i.hook) && isDef(i = i.remove)) {\n            i(ch, rm);\n          } else {\n            rm();\n          }\n        } else { // Text node\n          parentElm.removeChild(ch.elm);\n        }\n      }\n    }\n  }\n\n  function updateChildren(parentElm, oldCh, newCh, insertedVnodeQueue) {\n    var oldStartIdx = 0, newStartIdx = 0;\n    var oldEndIdx = oldCh.length - 1;\n    var oldStartVnode = oldCh[0];\n    var oldEndVnode = oldCh[oldEndIdx];\n    var newEndIdx = newCh.length - 1;\n    var newStartVnode = newCh[0];\n    var newEndVnode = newCh[newEndIdx];\n    var oldKeyToIdx, idxInOld, elmToMove, before;\n\n    while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\n      if (isUndef(oldStartVnode)) {\n        oldStartVnode = oldCh[++oldStartIdx]; // Vnode has been moved left\n      } else if (isUndef(oldEndVnode)) {\n        oldEndVnode = oldCh[--oldEndIdx];\n      } else if (sameVnode(oldStartVnode, newStartVnode)) {\n        patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue);\n        oldStartVnode = oldCh[++oldStartIdx];\n        newStartVnode = newCh[++newStartIdx];\n      } else if (sameVnode(oldEndVnode, newEndVnode)) {\n        patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue);\n        oldEndVnode = oldCh[--oldEndIdx];\n        newEndVnode = newCh[--newEndIdx];\n      } else if (sameVnode(oldStartVnode, newEndVnode)) { // Vnode moved right\n        patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue);\n        parentElm.insertBefore(oldStartVnode.elm, oldEndVnode.elm.nextSibling);\n        oldStartVnode = oldCh[++oldStartIdx];\n        newEndVnode = newCh[--newEndIdx];\n      } else if (sameVnode(oldEndVnode, newStartVnode)) { // Vnode moved left\n        patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue);\n        parentElm.insertBefore(oldEndVnode.elm, oldStartVnode.elm);\n        oldEndVnode = oldCh[--oldEndIdx];\n        newStartVnode = newCh[++newStartIdx];\n      } else {\n        if (isUndef(oldKeyToIdx)) oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);\n        idxInOld = oldKeyToIdx[newStartVnode.key];\n        if (isUndef(idxInOld)) { // New element\n          parentElm.insertBefore(createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);\n          newStartVnode = newCh[++newStartIdx];\n        } else {\n          elmToMove = oldCh[idxInOld];\n          patchVnode(elmToMove, newStartVnode, insertedVnodeQueue);\n          oldCh[idxInOld] = undefined;\n          parentElm.insertBefore(elmToMove.elm, oldStartVnode.elm);\n          newStartVnode = newCh[++newStartIdx];\n        }\n      }\n    }\n    if (oldStartIdx > oldEndIdx) {\n      before = isUndef(newCh[newEndIdx+1]) ? null : newCh[newEndIdx+1].elm;\n      addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx, insertedVnodeQueue);\n    } else if (newStartIdx > newEndIdx) {\n      removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx);\n    }\n  }\n\n  function patchVnode(oldVnode, vnode, insertedVnodeQueue) {\n    var i, hook;\n    if (isDef(i = vnode.data) && isDef(hook = i.hook) && isDef(i = hook.prepatch)) {\n      i(oldVnode, vnode);\n    }\n    if (isDef(i = oldVnode.data) && isDef(i = i.vnode)) oldVnode = i;\n    if (isDef(i = vnode.data) && isDef(i = i.vnode)) vnode = i;\n    var elm = vnode.elm = oldVnode.elm, oldCh = oldVnode.children, ch = vnode.children;\n    if (oldVnode === vnode) return;\n    if (isDef(vnode.data)) {\n      for (i = 0; i < cbs.update.length; ++i) cbs.update[i](oldVnode, vnode);\n      i = vnode.data.hook;\n      if (isDef(i) && isDef(i = i.update)) i(oldVnode, vnode);\n    }\n    if (isUndef(vnode.text)) {\n      if (isDef(oldCh) && isDef(ch)) {\n        if (oldCh !== ch) updateChildren(elm, oldCh, ch, insertedVnodeQueue);\n      } else if (isDef(ch)) {\n        addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue);\n      } else if (isDef(oldCh)) {\n        removeVnodes(elm, oldCh, 0, oldCh.length - 1);\n      }\n    } else if (oldVnode.text !== vnode.text) {\n      elm.textContent = vnode.text;\n    }\n    if (isDef(hook) && isDef(i = hook.postpatch)) {\n      i(oldVnode, vnode);\n    }\n  }\n\n  return function(oldVnode, vnode) {\n    var i;\n    var insertedVnodeQueue = [];\n    for (i = 0; i < cbs.pre.length; ++i) cbs.pre[i]();\n    if (oldVnode instanceof Element) {\n      if (oldVnode.parentElement !== null) {\n        createElm(vnode, insertedVnodeQueue);\n        oldVnode.parentElement.replaceChild(vnode.elm, oldVnode);\n      } else {\n        oldVnode = emptyNodeAt(oldVnode);\n        patchVnode(oldVnode, vnode, insertedVnodeQueue);\n      }\n    } else {\n      patchVnode(oldVnode, vnode, insertedVnodeQueue);\n    }\n    for (i = 0; i < insertedVnodeQueue.length; ++i) {\n      insertedVnodeQueue[i].data.hook.insert(insertedVnodeQueue[i]);\n    }\n    for (i = 0; i < cbs.post.length; ++i) cbs.post[i]();\n    return vnode;\n  };\n}\n\nmodule.exports = {init: init};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/snabbdom/snabbdom.js\n// module id = 68\n// module chunks = 0 1 2","module.exports = function(sel, data, children, text, elm) {\n  var key = data === undefined ? undefined : data.key;\n  return {sel: sel, data: data, children: children,\n          text: text, elm: elm, key: key};\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/snabbdom/vnode.js\n// module id = 69\n// module chunks = 0 1 2","module.exports = {\n  array: Array.isArray,\n  primitive: function(s) { return typeof s === 'string' || typeof s === 'number'; },\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/snabbdom/is.js\n// module id = 70\n// module chunks = 0 1 2","var VNode = require('./vnode');\nvar is = require('./is');\n\nfunction addNS(data, children) {\n  data.ns = 'http://www.w3.org/2000/svg';\n  if (children !== undefined) {\n    for (var i = 0; i < children.length; ++i) {\n      addNS(children[i].data, children[i].children);\n    }\n  }\n}\n\nmodule.exports = function h(sel, b, c) {\n  var data = {}, children, text, i;\n  if (arguments.length === 3) {\n    data = b;\n    if (is.array(c)) { children = c; }\n    else if (is.primitive(c)) { text = c; }\n  } else if (arguments.length === 2) {\n    if (is.array(b)) { children = b; }\n    else if (is.primitive(b)) { text = b; }\n    else { data = b; }\n  }\n  if (is.array(children)) {\n    for (i = 0; i < children.length; ++i) {\n      if (is.primitive(children[i])) children[i] = VNode(undefined, undefined, undefined, children[i]);\n    }\n  }\n  if (sel[0] === 's' && sel[1] === 'v' && sel[2] === 'g') {\n    addNS(data, children);\n  }\n  return VNode(sel, data, children, text, undefined);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/snabbdom/h.js\n// module id = 71\n// module chunks = 0 1 2","function updateClass(oldVnode, vnode) {\n  var cur, name, elm = vnode.elm,\n      oldClass = oldVnode.data.class || {},\n      klass = vnode.data.class || {};\n  for (name in klass) {\n    cur = klass[name];\n    if (cur !== oldClass[name]) {\n      elm.classList[cur ? 'add' : 'remove'](name);\n    }\n  }\n}\n\nmodule.exports = {create: updateClass, update: updateClass};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/snabbdom/modules/class.js\n// module id = 72\n// module chunks = 0 1 2","function updateProps(oldVnode, vnode) {\n  var key, cur, old, elm = vnode.elm,\n      oldProps = oldVnode.data.props || {}, props = vnode.data.props || {};\n  for (key in props) {\n    cur = props[key];\n    old = oldProps[key];\n    if (old !== cur) {\n      elm[key] = cur;\n    }\n  }\n}\n\nmodule.exports = {create: updateProps, update: updateProps};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/snabbdom/modules/props.js\n// module id = 73\n// module chunks = 0 1 2","var booleanAttrs = [\"allowfullscreen\", \"async\", \"autofocus\", \"autoplay\", \"checked\", \"compact\", \"controls\", \"declare\", \n                \"default\", \"defaultchecked\", \"defaultmuted\", \"defaultselected\", \"defer\", \"disabled\", \"draggable\", \n                \"enabled\", \"formnovalidate\", \"hidden\", \"indeterminate\", \"inert\", \"ismap\", \"itemscope\", \"loop\", \"multiple\", \n                \"muted\", \"nohref\", \"noresize\", \"noshade\", \"novalidate\", \"nowrap\", \"open\", \"pauseonexit\", \"readonly\", \n                \"required\", \"reversed\", \"scoped\", \"seamless\", \"selected\", \"sortable\", \"spellcheck\", \"translate\", \n                \"truespeed\", \"typemustmatch\", \"visible\"];\n    \nvar booleanAttrsDict = {};\nfor(var i=0, len = booleanAttrs.length; i < len; i++) {\n  booleanAttrsDict[booleanAttrs[i]] = true;\n}\n    \nfunction updateAttrs(oldVnode, vnode) {\n  var key, cur, old, elm = vnode.elm,\n      oldAttrs = oldVnode.data.attrs || {}, attrs = vnode.data.attrs || {};\n  \n  // update modified attributes, add new attributes\n  for (key in attrs) {\n    cur = attrs[key];\n    old = oldAttrs[key];\n    if (old !== cur) {\n      // TODO: add support to namespaced attributes (setAttributeNS)\n      if(!cur && booleanAttrsDict[key])\n        elm.removeAttribute(key);\n      else\n        elm.setAttribute(key, cur);\n    }\n  }\n  //remove removed attributes\n  // use `in` operator since the previous `for` iteration uses it (.i.e. add even attributes with undefined value)\n  // the other option is to remove all attributes with value == undefined\n  for (key in oldAttrs) {\n    if (!(key in attrs)) {\n      elm.removeAttribute(key);\n    }\n  }\n}\n\nmodule.exports = {create: updateAttrs, update: updateAttrs};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/snabbdom/modules/attributes.js\n// module id = 74\n// module chunks = 0 1 2","var raf = requestAnimationFrame || setTimeout;\nvar nextFrame = function(fn) { raf(function() { raf(fn); }); };\n\nfunction setNextFrame(obj, prop, val) {\n  nextFrame(function() { obj[prop] = val; });\n}\n\nfunction updateStyle(oldVnode, vnode) {\n  var cur, name, elm = vnode.elm,\n      oldStyle = oldVnode.data.style || {},\n      style = vnode.data.style || {},\n      oldHasDel = 'delayed' in oldStyle;\n  for (name in style) {\n    cur = style[name];\n    if (name === 'delayed') {\n      for (name in style.delayed) {\n        cur = style.delayed[name];\n        if (!oldHasDel || cur !== oldStyle.delayed[name]) {\n          setNextFrame(elm.style, name, cur);\n        }\n      }\n    } else if (name !== 'remove' && cur !== oldStyle[name]) {\n      elm.style[name] = cur;\n    }\n  }\n}\n\nfunction applyDestroyStyle(vnode) {\n  var style, name, elm = vnode.elm, s = vnode.data.style;\n  if (!s || !(style = s.destroy)) return;\n  for (name in style) {\n    elm.style[name] = style[name];\n  }\n}\n\nfunction applyRemoveStyle(vnode, rm) {\n  var s = vnode.data.style;\n  if (!s || !s.remove) {\n    rm();\n    return;\n  }\n  var name, elm = vnode.elm, idx, i = 0, maxDur = 0,\n      compStyle, style = s.remove, amount = 0, applied = [];\n  for (name in style) {\n    applied.push(name);\n    elm.style[name] = style[name];\n  }\n  compStyle = getComputedStyle(elm);\n  var props = compStyle['transition-property'].split(', ');\n  for (; i < props.length; ++i) {\n    if(applied.indexOf(props[i]) !== -1) amount++;\n  }\n  elm.addEventListener('transitionend', function(ev) {\n    if (ev.target === elm) --amount;\n    if (amount === 0) rm();\n  });\n}\n\nmodule.exports = {create: updateStyle, update: updateStyle, destroy: applyDestroyStyle, remove: applyRemoveStyle};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/snabbdom/modules/style.js\n// module id = 75\n// module chunks = 0 1 2","var is = require('../is');\n\nfunction arrInvoker(arr) {\n  return function() {\n    // Special case when length is two, for performance\n    arr.length === 2 ? arr[0](arr[1]) : arr[0].apply(undefined, arr.slice(1));\n  };\n}\n\nfunction fnInvoker(o) {\n  return function(ev) { o.fn(ev); };\n}\n\nfunction updateEventListeners(oldVnode, vnode) {\n  var name, cur, old, elm = vnode.elm,\n      oldOn = oldVnode.data.on || {}, on = vnode.data.on;\n  if (!on) return;\n  for (name in on) {\n    cur = on[name];\n    old = oldOn[name];\n    if (old === undefined) {\n      if (is.array(cur)) {\n        elm.addEventListener(name, arrInvoker(cur));\n      } else {\n        cur = {fn: cur};\n        on[name] = cur;\n        elm.addEventListener(name, fnInvoker(cur));\n      }\n    } else if (is.array(old)) {\n      // Deliberately modify old array since it's captured in closure created with `arrInvoker`\n      old.length = cur.length;\n      for (var i = 0; i < old.length; ++i) old[i] = cur[i];\n      on[name]  = old;\n    } else {\n      old.fn = cur;\n      on[name] = old;\n    }\n  }\n}\n\nmodule.exports = {create: updateEventListeners, update: updateEventListeners};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/snabbdom/modules/eventlisteners.js\n// module id = 76\n// module chunks = 0 1 2","// Fork of: https://github.com/scottcorgan/tiny-emitter\n\n/**\n * Event Emitter\n * @mixin\n * @public\n */\nexport default function eventEmitter() {\n  const e = {};\n\n  /**\n   *\n   * Subscribe to an event.\n   *\n   * @param {string} name\n   * @param {function} callback\n   * @param {any} [context]\n   * @public\n   * @instance\n   * @memberof eventEmitter\n   */\n  function on(name, callback, context) {\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: context,\n    });\n    return this;\n  }\n\n  /**\n   *\n   * Subscribe to an event only once.\n   *\n   * @param {string} name\n   * @param {function} callback\n   * @param {any} [context]\n   * @memberof eventEmitter\n   * @instance\n   * @public\n   */\n  function once(name, callback, context) {\n    function listener() {\n      off(name, listener);\n      callback.apply(context, arguments);\n    }\n\n    listener._ = callback;\n\n    return on(name, listener, context);\n  }\n\n  /**\n   *\n   * Emit an event\n   *\n   * @param {string} name\n   * @param {any} ...rest arguments for the event\n   * @memberof eventEmitter\n   * @instance\n   * @public\n   */\n  function emit(name) {\n    const data = [].slice.call(arguments, 1);\n    const evtArr = (e[name] || []).slice();\n    let i = 0;\n    const len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  }\n\n  /**\n   * Unsubscribe from an event or all events.\n   * If no callback is provided, it unsubscribes all callback from this event.\n   *\n   * @param {string} name\n   * @param {function} callback\n   * @memberof eventEmitter\n   * @instance\n   * @public\n   */\n  function off(name, callback) {\n    const evts = e[name];\n    const liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n\n  return { on, once, emit, off };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/eventEmitter.js",";(function() {\n\n  'use strict';\n\n  // jshint unused:vars\n    var _arity = function _arity(n, fn) {\n        // jshint unused:vars\n        switch (n) {\n        case 0:\n            return function () {\n                return fn.apply(this, arguments);\n            };\n        case 1:\n            return function (a0) {\n                return fn.apply(this, arguments);\n            };\n        case 2:\n            return function (a0, a1) {\n                return fn.apply(this, arguments);\n            };\n        case 3:\n            return function (a0, a1, a2) {\n                return fn.apply(this, arguments);\n            };\n        case 4:\n            return function (a0, a1, a2, a3) {\n                return fn.apply(this, arguments);\n            };\n        case 5:\n            return function (a0, a1, a2, a3, a4) {\n                return fn.apply(this, arguments);\n            };\n        case 6:\n            return function (a0, a1, a2, a3, a4, a5) {\n                return fn.apply(this, arguments);\n            };\n        case 7:\n            return function (a0, a1, a2, a3, a4, a5, a6) {\n                return fn.apply(this, arguments);\n            };\n        case 8:\n            return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n                return fn.apply(this, arguments);\n            };\n        case 9:\n            return function (a0, a1, a2, a3, a4, a5, a6, a7, a8) {\n                return fn.apply(this, arguments);\n            };\n        case 10:\n            return function (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9) {\n                return fn.apply(this, arguments);\n            };\n        default:\n            throw new Error('First argument to _arity must be a non-negative integer no greater than ten');\n        }\n    };\n\n    var _arrayFromIterator = function _arrayFromIterator(iter) {\n        var list = [];\n        var next;\n        while (!(next = iter.next()).done) {\n            list.push(next.value);\n        }\n        return list;\n    };\n\n    /**\n     * Private `concat` function to merge two array-like objects.\n     *\n     * @private\n     * @param {Array|Arguments} [set1=[]] An array-like object.\n     * @param {Array|Arguments} [set2=[]] An array-like object.\n     * @return {Array} A new, merged array.\n     * @example\n     *\n     *      _concat([4, 5, 6], [1, 2, 3]); //=> [4, 5, 6, 1, 2, 3]\n     */\n    var _concat = function _concat(set1, set2) {\n        set1 = set1 || [];\n        set2 = set2 || [];\n        var idx;\n        var len1 = set1.length;\n        var len2 = set2.length;\n        var result = [];\n        idx = 0;\n        while (idx < len1) {\n            result[result.length] = set1[idx];\n            idx += 1;\n        }\n        idx = 0;\n        while (idx < len2) {\n            result[result.length] = set2[idx];\n            idx += 1;\n        }\n        return result;\n    };\n\n    var _filter = function _filter(fn, list) {\n        var idx = 0, len = list.length, result = [];\n        while (idx < len) {\n            if (fn(list[idx])) {\n                result[result.length] = list[idx];\n            }\n            idx += 1;\n        }\n        return result;\n    };\n\n    var _forceReduced = function _forceReduced(x) {\n        return {\n            '@@transducer/value': x,\n            '@@transducer/reduced': true\n        };\n    };\n\n    var _has = function _has(prop, obj) {\n        return Object.prototype.hasOwnProperty.call(obj, prop);\n    };\n\n    /**\n     * Tests whether or not an object is an array.\n     *\n     * @private\n     * @param {*} val The object to test.\n     * @return {Boolean} `true` if `val` is an array, `false` otherwise.\n     * @example\n     *\n     *      _isArray([]); //=> true\n     *      _isArray(null); //=> false\n     *      _isArray({}); //=> false\n     */\n    var _isArray = Array.isArray || function _isArray(val) {\n        return val != null && val.length >= 0 && Object.prototype.toString.call(val) === '[object Array]';\n    };\n\n    var _isPlaceholder = function _isPlaceholder(a) {\n        return a != null && typeof a === 'object' && a['@@functional/placeholder'] === true;\n    };\n\n    var _isString = function _isString(x) {\n        return Object.prototype.toString.call(x) === '[object String]';\n    };\n\n    var _isTransformer = function _isTransformer(obj) {\n        return typeof obj['@@transducer/step'] === 'function';\n    };\n\n    var _map = function _map(fn, functor) {\n        var idx = 0;\n        var len = functor.length;\n        var result = Array(len);\n        while (idx < len) {\n            result[idx] = fn(functor[idx]);\n            idx += 1;\n        }\n        return result;\n    };\n\n    var _pipe = function _pipe(f, g) {\n        return function () {\n            return g.call(this, f.apply(this, arguments));\n        };\n    };\n\n    var _reduced = function _reduced(x) {\n        return x && x['@@transducer/reduced'] ? x : {\n            '@@transducer/value': x,\n            '@@transducer/reduced': true\n        };\n    };\n\n    /**\n     * An optimized, private array `slice` implementation.\n     *\n     * @private\n     * @param {Arguments|Array} args The array or arguments object to consider.\n     * @param {Number} [from=0] The array index to slice from, inclusive.\n     * @param {Number} [to=args.length] The array index to slice to, exclusive.\n     * @return {Array} A new, sliced array.\n     * @example\n     *\n     *      _slice([1, 2, 3, 4, 5], 1, 3); //=> [2, 3]\n     *\n     *      var firstThreeArgs = function(a, b, c, d) {\n     *        return _slice(arguments, 0, 3);\n     *      };\n     *      firstThreeArgs(1, 2, 3, 4); //=> [1, 2, 3]\n     */\n    var _slice = function _slice(args, from, to) {\n        switch (arguments.length) {\n        case 1:\n            return _slice(args, 0, args.length);\n        case 2:\n            return _slice(args, from, args.length);\n        default:\n            var list = [];\n            var idx = 0;\n            var len = Math.max(0, Math.min(args.length, to) - from);\n            while (idx < len) {\n                list[idx] = args[from + idx];\n                idx += 1;\n            }\n            return list;\n        }\n    };\n\n    var _xfBase = {\n        init: function () {\n            return this.xf['@@transducer/init']();\n        },\n        result: function (result) {\n            return this.xf['@@transducer/result'](result);\n        }\n    };\n\n    var _xwrap = function () {\n        function XWrap(fn) {\n            this.f = fn;\n        }\n        XWrap.prototype['@@transducer/init'] = function () {\n            throw new Error('init not implemented on XWrap');\n        };\n        XWrap.prototype['@@transducer/result'] = function (acc) {\n            return acc;\n        };\n        XWrap.prototype['@@transducer/step'] = function (acc, x) {\n            return this.f(acc, x);\n        };\n        return function _xwrap(fn) {\n            return new XWrap(fn);\n        };\n    }();\n\n    /**\n     * Similar to hasMethod, this checks whether a function has a [methodname]\n     * function. If it isn't an array it will execute that function otherwise it\n     * will default to the ramda implementation.\n     *\n     * @private\n     * @param {Function} fn ramda implemtation\n     * @param {String} methodname property to check for a custom implementation\n     * @return {Object} Whatever the return value of the method is.\n     */\n    var _checkForMethod = function _checkForMethod(methodname, fn) {\n        return function () {\n            var length = arguments.length;\n            if (length === 0) {\n                return fn();\n            }\n            var obj = arguments[length - 1];\n            return _isArray(obj) || typeof obj[methodname] !== 'function' ? fn.apply(this, arguments) : obj[methodname].apply(obj, _slice(arguments, 0, length - 1));\n        };\n    };\n\n    /**\n     * Optimized internal one-arity curry function.\n     *\n     * @private\n     * @category Function\n     * @param {Function} fn The function to curry.\n     * @return {Function} The curried function.\n     */\n    var _curry1 = function _curry1(fn) {\n        return function f1(a) {\n            if (arguments.length === 0 || _isPlaceholder(a)) {\n                return f1;\n            } else {\n                return fn.apply(this, arguments);\n            }\n        };\n    };\n\n    /**\n     * Optimized internal two-arity curry function.\n     *\n     * @private\n     * @category Function\n     * @param {Function} fn The function to curry.\n     * @return {Function} The curried function.\n     */\n    var _curry2 = function _curry2(fn) {\n        return function f2(a, b) {\n            switch (arguments.length) {\n            case 0:\n                return f2;\n            case 1:\n                return _isPlaceholder(a) ? f2 : _curry1(function (_b) {\n                    return fn(a, _b);\n                });\n            default:\n                return _isPlaceholder(a) && _isPlaceholder(b) ? f2 : _isPlaceholder(a) ? _curry1(function (_a) {\n                    return fn(_a, b);\n                }) : _isPlaceholder(b) ? _curry1(function (_b) {\n                    return fn(a, _b);\n                }) : fn(a, b);\n            }\n        };\n    };\n\n    /**\n     * Optimized internal three-arity curry function.\n     *\n     * @private\n     * @category Function\n     * @param {Function} fn The function to curry.\n     * @return {Function} The curried function.\n     */\n    var _curry3 = function _curry3(fn) {\n        return function f3(a, b, c) {\n            switch (arguments.length) {\n            case 0:\n                return f3;\n            case 1:\n                return _isPlaceholder(a) ? f3 : _curry2(function (_b, _c) {\n                    return fn(a, _b, _c);\n                });\n            case 2:\n                return _isPlaceholder(a) && _isPlaceholder(b) ? f3 : _isPlaceholder(a) ? _curry2(function (_a, _c) {\n                    return fn(_a, b, _c);\n                }) : _isPlaceholder(b) ? _curry2(function (_b, _c) {\n                    return fn(a, _b, _c);\n                }) : _curry1(function (_c) {\n                    return fn(a, b, _c);\n                });\n            default:\n                return _isPlaceholder(a) && _isPlaceholder(b) && _isPlaceholder(c) ? f3 : _isPlaceholder(a) && _isPlaceholder(b) ? _curry2(function (_a, _b) {\n                    return fn(_a, _b, c);\n                }) : _isPlaceholder(a) && _isPlaceholder(c) ? _curry2(function (_a, _c) {\n                    return fn(_a, b, _c);\n                }) : _isPlaceholder(b) && _isPlaceholder(c) ? _curry2(function (_b, _c) {\n                    return fn(a, _b, _c);\n                }) : _isPlaceholder(a) ? _curry1(function (_a) {\n                    return fn(_a, b, c);\n                }) : _isPlaceholder(b) ? _curry1(function (_b) {\n                    return fn(a, _b, c);\n                }) : _isPlaceholder(c) ? _curry1(function (_c) {\n                    return fn(a, b, _c);\n                }) : fn(a, b, c);\n            }\n        };\n    };\n\n    /**\n     * Internal curryN function.\n     *\n     * @private\n     * @category Function\n     * @param {Number} length The arity of the curried function.\n     * @param {Array} received An array of arguments received thus far.\n     * @param {Function} fn The function to curry.\n     * @return {Function} The curried function.\n     */\n    var _curryN = function _curryN(length, received, fn) {\n        return function () {\n            var combined = [];\n            var argsIdx = 0;\n            var left = length;\n            var combinedIdx = 0;\n            while (combinedIdx < received.length || argsIdx < arguments.length) {\n                var result;\n                if (combinedIdx < received.length && (!_isPlaceholder(received[combinedIdx]) || argsIdx >= arguments.length)) {\n                    result = received[combinedIdx];\n                } else {\n                    result = arguments[argsIdx];\n                    argsIdx += 1;\n                }\n                combined[combinedIdx] = result;\n                if (!_isPlaceholder(result)) {\n                    left -= 1;\n                }\n                combinedIdx += 1;\n            }\n            return left <= 0 ? fn.apply(this, combined) : _arity(left, _curryN(length, combined, fn));\n        };\n    };\n\n    /**\n     * Returns a function that dispatches with different strategies based on the\n     * object in list position (last argument). If it is an array, executes [fn].\n     * Otherwise, if it has a function with [methodname], it will execute that\n     * function (functor case). Otherwise, if it is a transformer, uses transducer\n     * [xf] to return a new transformer (transducer case). Otherwise, it will\n     * default to executing [fn].\n     *\n     * @private\n     * @param {String} methodname property to check for a custom implementation\n     * @param {Function} xf transducer to initialize if object is transformer\n     * @param {Function} fn default ramda implementation\n     * @return {Function} A function that dispatches on object in list position\n     */\n    var _dispatchable = function _dispatchable(methodname, xf, fn) {\n        return function () {\n            var length = arguments.length;\n            if (length === 0) {\n                return fn();\n            }\n            var obj = arguments[length - 1];\n            if (!_isArray(obj)) {\n                var args = _slice(arguments, 0, length - 1);\n                if (typeof obj[methodname] === 'function') {\n                    return obj[methodname].apply(obj, args);\n                }\n                if (_isTransformer(obj)) {\n                    var transducer = xf.apply(null, args);\n                    return transducer(obj);\n                }\n            }\n            return fn.apply(this, arguments);\n        };\n    };\n\n    var _xall = function () {\n        function XAll(f, xf) {\n            this.xf = xf;\n            this.f = f;\n            this.all = true;\n        }\n        XAll.prototype['@@transducer/init'] = _xfBase.init;\n        XAll.prototype['@@transducer/result'] = function (result) {\n            if (this.all) {\n                result = this.xf['@@transducer/step'](result, true);\n            }\n            return this.xf['@@transducer/result'](result);\n        };\n        XAll.prototype['@@transducer/step'] = function (result, input) {\n            if (!this.f(input)) {\n                this.all = false;\n                result = _reduced(this.xf['@@transducer/step'](result, false));\n            }\n            return result;\n        };\n        return _curry2(function _xall(f, xf) {\n            return new XAll(f, xf);\n        });\n    }();\n\n    var _xfilter = function () {\n        function XFilter(f, xf) {\n            this.xf = xf;\n            this.f = f;\n        }\n        XFilter.prototype['@@transducer/init'] = _xfBase.init;\n        XFilter.prototype['@@transducer/result'] = _xfBase.result;\n        XFilter.prototype['@@transducer/step'] = function (result, input) {\n            return this.f(input) ? this.xf['@@transducer/step'](result, input) : result;\n        };\n        return _curry2(function _xfilter(f, xf) {\n            return new XFilter(f, xf);\n        });\n    }();\n\n    var _xfind = function () {\n        function XFind(f, xf) {\n            this.xf = xf;\n            this.f = f;\n            this.found = false;\n        }\n        XFind.prototype['@@transducer/init'] = _xfBase.init;\n        XFind.prototype['@@transducer/result'] = function (result) {\n            if (!this.found) {\n                result = this.xf['@@transducer/step'](result, void 0);\n            }\n            return this.xf['@@transducer/result'](result);\n        };\n        XFind.prototype['@@transducer/step'] = function (result, input) {\n            if (this.f(input)) {\n                this.found = true;\n                result = _reduced(this.xf['@@transducer/step'](result, input));\n            }\n            return result;\n        };\n        return _curry2(function _xfind(f, xf) {\n            return new XFind(f, xf);\n        });\n    }();\n\n    var _xfindIndex = function () {\n        function XFindIndex(f, xf) {\n            this.xf = xf;\n            this.f = f;\n            this.idx = -1;\n            this.found = false;\n        }\n        XFindIndex.prototype['@@transducer/init'] = _xfBase.init;\n        XFindIndex.prototype['@@transducer/result'] = function (result) {\n            if (!this.found) {\n                result = this.xf['@@transducer/step'](result, -1);\n            }\n            return this.xf['@@transducer/result'](result);\n        };\n        XFindIndex.prototype['@@transducer/step'] = function (result, input) {\n            this.idx += 1;\n            if (this.f(input)) {\n                this.found = true;\n                result = _reduced(this.xf['@@transducer/step'](result, this.idx));\n            }\n            return result;\n        };\n        return _curry2(function _xfindIndex(f, xf) {\n            return new XFindIndex(f, xf);\n        });\n    }();\n\n    var _xmap = function () {\n        function XMap(f, xf) {\n            this.xf = xf;\n            this.f = f;\n        }\n        XMap.prototype['@@transducer/init'] = _xfBase.init;\n        XMap.prototype['@@transducer/result'] = _xfBase.result;\n        XMap.prototype['@@transducer/step'] = function (result, input) {\n            return this.xf['@@transducer/step'](result, this.f(input));\n        };\n        return _curry2(function _xmap(f, xf) {\n            return new XMap(f, xf);\n        });\n    }();\n\n    /**\n     * Returns `true` if all elements of the list match the predicate, `false` if\n     * there are any that don't.\n     *\n     * Dispatches to the `all` method of the second argument, if present.\n     *\n     * Acts as a transducer if a transformer is given in list position.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category List\n     * @sig (a -> Boolean) -> [a] -> Boolean\n     * @param {Function} fn The predicate function.\n     * @param {Array} list The array to consider.\n     * @return {Boolean} `true` if the predicate is satisfied by every element, `false`\n     *         otherwise.\n     * @see R.any, R.none, R.transduce\n     * @example\n     *\n     *      var lessThan2 = R.flip(R.lt)(2);\n     *      var lessThan3 = R.flip(R.lt)(3);\n     *      R.all(lessThan2)([1, 2]); //=> false\n     *      R.all(lessThan3)([1, 2]); //=> true\n     */\n    var all = _curry2(_dispatchable('all', _xall, function all(fn, list) {\n        var idx = 0;\n        while (idx < list.length) {\n            if (!fn(list[idx])) {\n                return false;\n            }\n            idx += 1;\n        }\n        return true;\n    }));\n\n    /**\n     * Creates a function that is bound to a context.\n     * Note: `R.bind` does not provide the additional argument-binding capabilities of\n     * [Function.prototype.bind](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n     *\n     * @func\n     * @memberOf R\n     * @since v0.6.0\n     * @category Function\n     * @category Object\n     * @sig (* -> *) -> {*} -> (* -> *)\n     * @param {Function} fn The function to bind to context\n     * @param {Object} thisObj The context to bind `fn` to\n     * @return {Function} A function that will execute in the context of `thisObj`.\n     * @see R.partial\n     */\n    var bind = _curry2(function bind(fn, thisObj) {\n        return _arity(fn.length, function () {\n            return fn.apply(thisObj, arguments);\n        });\n    });\n\n    /**\n     * Returns a curried equivalent of the provided function, with the specified\n     * arity. The curried function has two unusual capabilities. First, its\n     * arguments needn't be provided one at a time. If `g` is `R.curryN(3, f)`, the\n     * following are equivalent:\n     *\n     *   - `g(1)(2)(3)`\n     *   - `g(1)(2, 3)`\n     *   - `g(1, 2)(3)`\n     *   - `g(1, 2, 3)`\n     *\n     * Secondly, the special placeholder value `R.__` may be used to specify\n     * \"gaps\", allowing partial application of any combination of arguments,\n     * regardless of their positions. If `g` is as above and `_` is `R.__`, the\n     * following are equivalent:\n     *\n     *   - `g(1, 2, 3)`\n     *   - `g(_, 2, 3)(1)`\n     *   - `g(_, _, 3)(1)(2)`\n     *   - `g(_, _, 3)(1, 2)`\n     *   - `g(_, 2)(1)(3)`\n     *   - `g(_, 2)(1, 3)`\n     *   - `g(_, 2)(_, 3)(1)`\n     *\n     * @func\n     * @memberOf R\n     * @since v0.5.0\n     * @category Function\n     * @sig Number -> (* -> a) -> (* -> a)\n     * @param {Number} length The arity for the returned function.\n     * @param {Function} fn The function to curry.\n     * @return {Function} A new, curried function.\n     * @see R.curry\n     * @example\n     *\n     *      var sumArgs = (...args) => R.sum(args);\n     *\n     *      var curriedAddFourNumbers = R.curryN(4, sumArgs);\n     *      var f = curriedAddFourNumbers(1, 2);\n     *      var g = f(3);\n     *      g(4); //=> 10\n     */\n    var curryN = _curry2(function curryN(length, fn) {\n        if (length === 1) {\n            return _curry1(fn);\n        }\n        return _arity(length, _curryN(length, [], fn));\n    });\n\n    /**\n     * Returns a new list containing only those items that match a given predicate\n     * function. The predicate function is passed one argument: *(value)*.\n     *\n     * Note that `R.filter` does not skip deleted or unassigned indices, unlike the\n     * native `Array.prototype.filter` method. For more details on this behavior,\n     * see:\n     * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter#Description\n     *\n     * Dispatches to the `filter` method of the second argument, if present.\n     *\n     * Acts as a transducer if a transformer is given in list position.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category List\n     * @sig (a -> Boolean) -> [a] -> [a]\n     * @param {Function} fn The function called per iteration.\n     * @param {Array} list The collection to iterate over.\n     * @return {Array} The new filtered array.\n     * @see R.reject, R.transduce, R.addIndex\n     * @example\n     *\n     *      var isEven = n => n % 2 === 0;\n     *\n     *      R.filter(isEven, [1, 2, 3, 4]); //=> [2, 4]\n     */\n    var filter = _curry2(_dispatchable('filter', _xfilter, _filter));\n\n    /**\n     * Returns the first element of the list which matches the predicate, or\n     * `undefined` if no element matches.\n     *\n     * Dispatches to the `find` method of the second argument, if present.\n     *\n     * Acts as a transducer if a transformer is given in list position.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category List\n     * @sig (a -> Boolean) -> [a] -> a | undefined\n     * @param {Function} fn The predicate function used to determine if the element is the\n     *        desired one.\n     * @param {Array} list The array to consider.\n     * @return {Object} The element found, or `undefined`.\n     * @see R.transduce\n     * @example\n     *\n     *      var xs = [{a: 1}, {a: 2}, {a: 3}];\n     *      R.find(R.propEq('a', 2))(xs); //=> {a: 2}\n     *      R.find(R.propEq('a', 4))(xs); //=> undefined\n     */\n    var find = _curry2(_dispatchable('find', _xfind, function find(fn, list) {\n        var idx = 0;\n        var len = list.length;\n        while (idx < len) {\n            if (fn(list[idx])) {\n                return list[idx];\n            }\n            idx += 1;\n        }\n    }));\n\n    /**\n     * Returns the index of the first element of the list which matches the\n     * predicate, or `-1` if no element matches.\n     *\n     * Dispatches to the `findIndex` method of the second argument, if present.\n     *\n     * Acts as a transducer if a transformer is given in list position.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.1\n     * @category List\n     * @sig (a -> Boolean) -> [a] -> Number\n     * @param {Function} fn The predicate function used to determine if the element is the\n     * desired one.\n     * @param {Array} list The array to consider.\n     * @return {Number} The index of the element found, or `-1`.\n     * @see R.transduce\n     * @example\n     *\n     *      var xs = [{a: 1}, {a: 2}, {a: 3}];\n     *      R.findIndex(R.propEq('a', 2))(xs); //=> 1\n     *      R.findIndex(R.propEq('a', 4))(xs); //=> -1\n     */\n    var findIndex = _curry2(_dispatchable('findIndex', _xfindIndex, function findIndex(fn, list) {\n        var idx = 0;\n        var len = list.length;\n        while (idx < len) {\n            if (fn(list[idx])) {\n                return idx;\n            }\n            idx += 1;\n        }\n        return -1;\n    }));\n\n    /**\n     * Iterate over an input `list`, calling a provided function `fn` for each\n     * element in the list.\n     *\n     * `fn` receives one argument: *(value)*.\n     *\n     * Note: `R.forEach` does not skip deleted or unassigned indices (sparse\n     * arrays), unlike the native `Array.prototype.forEach` method. For more\n     * details on this behavior, see:\n     * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach#Description\n     *\n     * Also note that, unlike `Array.prototype.forEach`, Ramda's `forEach` returns\n     * the original array. In some libraries this function is named `each`.\n     *\n     * Dispatches to the `forEach` method of the second argument, if present.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.1\n     * @category List\n     * @sig (a -> *) -> [a] -> [a]\n     * @param {Function} fn The function to invoke. Receives one argument, `value`.\n     * @param {Array} list The list to iterate over.\n     * @return {Array} The original list.\n     * @see R.addIndex\n     * @example\n     *\n     *      var printXPlusFive = x => console.log(x + 5);\n     *      R.forEach(printXPlusFive, [1, 2, 3]); //=> [1, 2, 3]\n     *      //-> 6\n     *      //-> 7\n     *      //-> 8\n     */\n    var forEach = _curry2(_checkForMethod('forEach', function forEach(fn, list) {\n        var len = list.length;\n        var idx = 0;\n        while (idx < len) {\n            fn(list[idx]);\n            idx += 1;\n        }\n        return list;\n    }));\n\n    /**\n     * Returns true if its arguments are identical, false otherwise. Values are\n     * identical if they reference the same memory. `NaN` is identical to `NaN`;\n     * `0` and `-0` are not identical.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.15.0\n     * @category Relation\n     * @sig a -> a -> Boolean\n     * @param {*} a\n     * @param {*} b\n     * @return {Boolean}\n     * @example\n     *\n     *      var o = {};\n     *      R.identical(o, o); //=> true\n     *      R.identical(1, 1); //=> true\n     *      R.identical(1, '1'); //=> false\n     *      R.identical([], []); //=> false\n     *      R.identical(0, -0); //=> false\n     *      R.identical(NaN, NaN); //=> true\n     */\n    // SameValue algorithm\n    // Steps 1-5, 7-10\n    // Steps 6.b-6.e: +0 != -0\n    // Step 6.a: NaN == NaN\n    var identical = _curry2(function identical(a, b) {\n        // SameValue algorithm\n        if (a === b) {\n            // Steps 1-5, 7-10\n            // Steps 6.b-6.e: +0 != -0\n            return a !== 0 || 1 / a === 1 / b;\n        } else {\n            // Step 6.a: NaN == NaN\n            return a !== a && b !== b;\n        }\n    });\n\n    /**\n     * See if an object (`val`) is an instance of the supplied constructor. This\n     * function will check up the inheritance chain, if any.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.3.0\n     * @category Type\n     * @sig (* -> {*}) -> a -> Boolean\n     * @param {Object} ctor A constructor\n     * @param {*} val The value to test\n     * @return {Boolean}\n     * @example\n     *\n     *      R.is(Object, {}); //=> true\n     *      R.is(Number, 1); //=> true\n     *      R.is(Object, 1); //=> false\n     *      R.is(String, 's'); //=> true\n     *      R.is(String, new String('')); //=> true\n     *      R.is(Object, new String('')); //=> true\n     *      R.is(Object, 's'); //=> false\n     *      R.is(Number, {}); //=> false\n     */\n    var is = _curry2(function is(Ctor, val) {\n        return val != null && val.constructor === Ctor || val instanceof Ctor;\n    });\n\n    /**\n     * Tests whether or not an object is similar to an array.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.5.0\n     * @category Type\n     * @category List\n     * @sig * -> Boolean\n     * @param {*} x The object to test.\n     * @return {Boolean} `true` if `x` has a numeric length property and extreme indices defined; `false` otherwise.\n     * @example\n     *\n     *      R.isArrayLike([]); //=> true\n     *      R.isArrayLike(true); //=> false\n     *      R.isArrayLike({}); //=> false\n     *      R.isArrayLike({length: 10}); //=> false\n     *      R.isArrayLike({0: 'zero', 9: 'nine', length: 10}); //=> true\n     */\n    var isArrayLike = _curry1(function isArrayLike(x) {\n        if (_isArray(x)) {\n            return true;\n        }\n        if (!x) {\n            return false;\n        }\n        if (typeof x !== 'object') {\n            return false;\n        }\n        if (x instanceof String) {\n            return false;\n        }\n        if (x.nodeType === 1) {\n            return !!x.length;\n        }\n        if (x.length === 0) {\n            return true;\n        }\n        if (x.length > 0) {\n            return x.hasOwnProperty(0) && x.hasOwnProperty(x.length - 1);\n        }\n        return false;\n    });\n\n    /**\n     * Returns a list containing the names of all the enumerable own properties of\n     * the supplied object.\n     * Note that the order of the output array is not guaranteed to be consistent\n     * across different JS platforms.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category Object\n     * @sig {k: v} -> [k]\n     * @param {Object} obj The object to extract properties from\n     * @return {Array} An array of the object's own properties.\n     * @example\n     *\n     *      R.keys({a: 1, b: 2, c: 3}); //=> ['a', 'b', 'c']\n     */\n    // cover IE < 9 keys issues\n    var keys = function () {\n        // cover IE < 9 keys issues\n        var hasEnumBug = !{ toString: null }.propertyIsEnumerable('toString');\n        var nonEnumerableProps = [\n            'constructor',\n            'valueOf',\n            'isPrototypeOf',\n            'toString',\n            'propertyIsEnumerable',\n            'hasOwnProperty',\n            'toLocaleString'\n        ];\n        var contains = function contains(list, item) {\n            var idx = 0;\n            while (idx < list.length) {\n                if (list[idx] === item) {\n                    return true;\n                }\n                idx += 1;\n            }\n            return false;\n        };\n        return typeof Object.keys === 'function' ? _curry1(function keys(obj) {\n            return Object(obj) !== obj ? [] : Object.keys(obj);\n        }) : _curry1(function keys(obj) {\n            if (Object(obj) !== obj) {\n                return [];\n            }\n            var prop, ks = [], nIdx;\n            for (prop in obj) {\n                if (_has(prop, obj)) {\n                    ks[ks.length] = prop;\n                }\n            }\n            if (hasEnumBug) {\n                nIdx = nonEnumerableProps.length - 1;\n                while (nIdx >= 0) {\n                    prop = nonEnumerableProps[nIdx];\n                    if (_has(prop, obj) && !contains(ks, prop)) {\n                        ks[ks.length] = prop;\n                    }\n                    nIdx -= 1;\n                }\n            }\n            return ks;\n        });\n    }();\n\n    /**\n     * Returns a partial copy of an object containing only the keys specified. If\n     * the key does not exist, the property is ignored.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category Object\n     * @sig [k] -> {k: v} -> {k: v}\n     * @param {Array} names an array of String property names to copy onto a new object\n     * @param {Object} obj The object to copy from\n     * @return {Object} A new object with only properties from `names` on it.\n     * @see R.omit, R.props\n     * @example\n     *\n     *      R.pick(['a', 'd'], {a: 1, b: 2, c: 3, d: 4}); //=> {a: 1, d: 4}\n     *      R.pick(['a', 'e', 'f'], {a: 1, b: 2, c: 3, d: 4}); //=> {a: 1}\n     */\n    var pick = _curry2(function pick(names, obj) {\n        var result = {};\n        var idx = 0;\n        while (idx < names.length) {\n            if (names[idx] in obj) {\n                result[names[idx]] = obj[names[idx]];\n            }\n            idx += 1;\n        }\n        return result;\n    });\n\n    /**\n     * Returns a partial copy of an object containing only the keys that satisfy\n     * the supplied predicate.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.8.0\n     * @category Object\n     * @sig (v, k -> Boolean) -> {k: v} -> {k: v}\n     * @param {Function} pred A predicate to determine whether or not a key\n     *        should be included on the output object.\n     * @param {Object} obj The object to copy from\n     * @return {Object} A new object with only properties that satisfy `pred`\n     *         on it.\n     * @see R.pick\n     * @example\n     *\n     *      var isUpperCase = (val, key) => key.toUpperCase() === key;\n     *      R.pickBy(isUpperCase, {a: 1, b: 2, A: 3, B: 4}); //=> {A: 3, B: 4}\n     */\n    var pickBy = _curry2(function pickBy(test, obj) {\n        var result = {};\n        for (var prop in obj) {\n            if (test(obj[prop], prop, obj)) {\n                result[prop] = obj[prop];\n            }\n        }\n        return result;\n    });\n\n    /**\n     * Returns a function that when supplied an object returns the indicated\n     * property of that object, if it exists.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category Object\n     * @sig s -> {s: a} -> a | Undefined\n     * @param {String} p The property name\n     * @param {Object} obj The object to query\n     * @return {*} The value at `obj.p`.\n     * @example\n     *\n     *      R.prop('x', {x: 100}); //=> 100\n     *      R.prop('x', {}); //=> undefined\n     */\n    var prop = _curry2(function prop(p, obj) {\n        return obj[p];\n    });\n\n    /**\n     * Acts as multiple `prop`: array of keys in, array of values out. Preserves\n     * order.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category Object\n     * @sig [k] -> {k: v} -> [v]\n     * @param {Array} ps The property names to fetch\n     * @param {Object} obj The object to query\n     * @return {Array} The corresponding values or partially applied function.\n     * @example\n     *\n     *      R.props(['x', 'y'], {x: 1, y: 2}); //=> [1, 2]\n     *      R.props(['c', 'a', 'b'], {b: 2, a: 1}); //=> [undefined, 1, 2]\n     *\n     *      var fullName = R.compose(R.join(' '), R.props(['first', 'last']));\n     *      fullName({last: 'Bullet-Tooth', age: 33, first: 'Tony'}); //=> 'Tony Bullet-Tooth'\n     */\n    var props = _curry2(function props(ps, obj) {\n        var len = ps.length;\n        var out = [];\n        var idx = 0;\n        while (idx < len) {\n            out[idx] = obj[ps[idx]];\n            idx += 1;\n        }\n        return out;\n    });\n\n    /**\n     * Returns a new list or string with the elements or characters in reverse\n     * order.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category List\n     * @sig [a] -> [a]\n     * @sig String -> String\n     * @param {Array|String} list\n     * @return {Array|String}\n     * @example\n     *\n     *      R.reverse([1, 2, 3]);  //=> [3, 2, 1]\n     *      R.reverse([1, 2]);     //=> [2, 1]\n     *      R.reverse([1]);        //=> [1]\n     *      R.reverse([]);         //=> []\n     *\n     *      R.reverse('abc');      //=> 'cba'\n     *      R.reverse('ab');       //=> 'ba'\n     *      R.reverse('a');        //=> 'a'\n     *      R.reverse('');         //=> ''\n     */\n    var reverse = _curry1(function reverse(list) {\n        return _isString(list) ? list.split('').reverse().join('') : _slice(list).reverse();\n    });\n\n    /**\n     * Returns the elements of the given list or string (or object with a `slice`\n     * method) from `fromIndex` (inclusive) to `toIndex` (exclusive).\n     *\n     * Dispatches to the `slice` method of the third argument, if present.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.4\n     * @category List\n     * @sig Number -> Number -> [a] -> [a]\n     * @sig Number -> Number -> String -> String\n     * @param {Number} fromIndex The start index (inclusive).\n     * @param {Number} toIndex The end index (exclusive).\n     * @param {*} list\n     * @return {*}\n     * @example\n     *\n     *      R.slice(1, 3, ['a', 'b', 'c', 'd']);        //=> ['b', 'c']\n     *      R.slice(1, Infinity, ['a', 'b', 'c', 'd']); //=> ['b', 'c', 'd']\n     *      R.slice(0, -1, ['a', 'b', 'c', 'd']);       //=> ['a', 'b', 'c']\n     *      R.slice(-3, -1, ['a', 'b', 'c', 'd']);      //=> ['b', 'c']\n     *      R.slice(0, 3, 'ramda');                     //=> 'ram'\n     */\n    var slice = _curry3(_checkForMethod('slice', function slice(fromIndex, toIndex, list) {\n        return Array.prototype.slice.call(list, fromIndex, toIndex);\n    }));\n\n    /**\n     * Returns all but the first element of the given list or string (or object\n     * with a `tail` method).\n     *\n     * Dispatches to the `slice` method of the first argument, if present.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category List\n     * @sig [a] -> [a]\n     * @sig String -> String\n     * @param {*} list\n     * @return {*}\n     * @see R.head, R.init, R.last\n     * @example\n     *\n     *      R.tail([1, 2, 3]);  //=> [2, 3]\n     *      R.tail([1, 2]);     //=> [2]\n     *      R.tail([1]);        //=> []\n     *      R.tail([]);         //=> []\n     *\n     *      R.tail('abc');  //=> 'bc'\n     *      R.tail('ab');   //=> 'b'\n     *      R.tail('a');    //=> ''\n     *      R.tail('');     //=> ''\n     */\n    var tail = _checkForMethod('tail', slice(1, Infinity));\n\n    /**\n     * Gives a single-word string description of the (native) type of a value,\n     * returning such answers as 'Object', 'Number', 'Array', or 'Null'. Does not\n     * attempt to distinguish user Object types any further, reporting them all as\n     * 'Object'.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.8.0\n     * @category Type\n     * @sig (* -> {*}) -> String\n     * @param {*} val The value to test\n     * @return {String}\n     * @example\n     *\n     *      R.type({}); //=> \"Object\"\n     *      R.type(1); //=> \"Number\"\n     *      R.type(false); //=> \"Boolean\"\n     *      R.type('s'); //=> \"String\"\n     *      R.type(null); //=> \"Null\"\n     *      R.type([]); //=> \"Array\"\n     *      R.type(/[A-z]/); //=> \"RegExp\"\n     */\n    var type = _curry1(function type(val) {\n        return val === null ? 'Null' : val === undefined ? 'Undefined' : Object.prototype.toString.call(val).slice(8, -1);\n    });\n\n    /**\n     * Returns a list of all the enumerable own properties of the supplied object.\n     * Note that the order of the output array is not guaranteed across different\n     * JS platforms.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category Object\n     * @sig {k: v} -> [v]\n     * @param {Object} obj The object to extract values from\n     * @return {Array} An array of the values of the object's own properties.\n     * @example\n     *\n     *      R.values({a: 1, b: 2, c: 3}); //=> [1, 2, 3]\n     */\n    var values = _curry1(function values(obj) {\n        var props = keys(obj);\n        var len = props.length;\n        var vals = [];\n        var idx = 0;\n        while (idx < len) {\n            vals[idx] = obj[props[idx]];\n            idx += 1;\n        }\n        return vals;\n    });\n\n    // Values of other types are only equal if identical.\n    var _equals = function _equals(a, b, stackA, stackB) {\n        if (identical(a, b)) {\n            return true;\n        }\n        if (type(a) !== type(b)) {\n            return false;\n        }\n        if (a == null || b == null) {\n            return false;\n        }\n        if (typeof a.equals === 'function' || typeof b.equals === 'function') {\n            return typeof a.equals === 'function' && a.equals(b) && typeof b.equals === 'function' && b.equals(a);\n        }\n        switch (type(a)) {\n        case 'Arguments':\n        case 'Array':\n        case 'Object':\n            break;\n        case 'Boolean':\n        case 'Number':\n        case 'String':\n            if (!(typeof a === typeof b && identical(a.valueOf(), b.valueOf()))) {\n                return false;\n            }\n            break;\n        case 'Date':\n            if (!identical(a.valueOf(), b.valueOf())) {\n                return false;\n            }\n            break;\n        case 'Error':\n            if (!(a.name === b.name && a.message === b.message)) {\n                return false;\n            }\n            break;\n        case 'RegExp':\n            if (!(a.source === b.source && a.global === b.global && a.ignoreCase === b.ignoreCase && a.multiline === b.multiline && a.sticky === b.sticky && a.unicode === b.unicode)) {\n                return false;\n            }\n            break;\n        case 'Map':\n        case 'Set':\n            if (!_equals(_arrayFromIterator(a.entries()), _arrayFromIterator(b.entries()), stackA, stackB)) {\n                return false;\n            }\n            break;\n        case 'Int8Array':\n        case 'Uint8Array':\n        case 'Uint8ClampedArray':\n        case 'Int16Array':\n        case 'Uint16Array':\n        case 'Int32Array':\n        case 'Uint32Array':\n        case 'Float32Array':\n        case 'Float64Array':\n            break;\n        case 'ArrayBuffer':\n            break;\n        default:\n            // Values of other types are only equal if identical.\n            return false;\n        }\n        var keysA = keys(a);\n        if (keysA.length !== keys(b).length) {\n            return false;\n        }\n        var idx = stackA.length - 1;\n        while (idx >= 0) {\n            if (stackA[idx] === a) {\n                return stackB[idx] === b;\n            }\n            idx -= 1;\n        }\n        stackA.push(a);\n        stackB.push(b);\n        idx = keysA.length - 1;\n        while (idx >= 0) {\n            var key = keysA[idx];\n            if (!(_has(key, b) && _equals(b[key], a[key], stackA, stackB))) {\n                return false;\n            }\n            idx -= 1;\n        }\n        stackA.pop();\n        stackB.pop();\n        return true;\n    };\n\n    /**\n     * `_makeFlat` is a helper function that returns a one-level or fully recursive\n     * function based on the flag passed in.\n     *\n     * @private\n     */\n    var _makeFlat = function _makeFlat(recursive) {\n        return function flatt(list) {\n            var value, result = [], idx = 0, j, ilen = list.length, jlen;\n            while (idx < ilen) {\n                if (isArrayLike(list[idx])) {\n                    value = recursive ? flatt(list[idx]) : list[idx];\n                    j = 0;\n                    jlen = value.length;\n                    while (j < jlen) {\n                        result[result.length] = value[j];\n                        j += 1;\n                    }\n                } else {\n                    result[result.length] = list[idx];\n                }\n                idx += 1;\n            }\n            return result;\n        };\n    };\n\n    var _reduce = function () {\n        function _arrayReduce(xf, acc, list) {\n            var idx = 0, len = list.length;\n            while (idx < len) {\n                acc = xf['@@transducer/step'](acc, list[idx]);\n                if (acc && acc['@@transducer/reduced']) {\n                    acc = acc['@@transducer/value'];\n                    break;\n                }\n                idx += 1;\n            }\n            return xf['@@transducer/result'](acc);\n        }\n        function _iterableReduce(xf, acc, iter) {\n            var step = iter.next();\n            while (!step.done) {\n                acc = xf['@@transducer/step'](acc, step.value);\n                if (acc && acc['@@transducer/reduced']) {\n                    acc = acc['@@transducer/value'];\n                    break;\n                }\n                step = iter.next();\n            }\n            return xf['@@transducer/result'](acc);\n        }\n        function _methodReduce(xf, acc, obj) {\n            return xf['@@transducer/result'](obj.reduce(bind(xf['@@transducer/step'], xf), acc));\n        }\n        var symIterator = typeof Symbol !== 'undefined' ? Symbol.iterator : '@@iterator';\n        return function _reduce(fn, acc, list) {\n            if (typeof fn === 'function') {\n                fn = _xwrap(fn);\n            }\n            if (isArrayLike(list)) {\n                return _arrayReduce(fn, acc, list);\n            }\n            if (typeof list.reduce === 'function') {\n                return _methodReduce(fn, acc, list);\n            }\n            if (list[symIterator] != null) {\n                return _iterableReduce(fn, acc, list[symIterator]());\n            }\n            if (typeof list.next === 'function') {\n                return _iterableReduce(fn, acc, list);\n            }\n            throw new TypeError('reduce: list must be array or iterable');\n        };\n    }();\n\n    /**\n     * Creates a new list iteration function from an existing one by adding two new\n     * parameters to its callback function: the current index, and the entire list.\n     *\n     * This would turn, for instance, Ramda's simple `map` function into one that\n     * more closely resembles `Array.prototype.map`. Note that this will only work\n     * for functions in which the iteration callback function is the first\n     * parameter, and where the list is the last parameter. (This latter might be\n     * unimportant if the list parameter is not used.)\n     *\n     * @func\n     * @memberOf R\n     * @since v0.15.0\n     * @category Function\n     * @category List\n     * @sig ((a ... -> b) ... -> [a] -> *) -> (a ..., Int, [a] -> b) ... -> [a] -> *)\n     * @param {Function} fn A list iteration function that does not pass index or list to its callback\n     * @return {Function} An altered list iteration function that passes (item, index, list) to its callback\n     * @example\n     *\n     *      var mapIndexed = R.addIndex(R.map);\n     *      mapIndexed((val, idx) => idx + '-' + val, ['f', 'o', 'o', 'b', 'a', 'r']);\n     *      //=> ['0-f', '1-o', '2-o', '3-b', '4-a', '5-r']\n     */\n    var addIndex = _curry1(function addIndex(fn) {\n        return curryN(fn.length, function () {\n            var idx = 0;\n            var origFn = arguments[0];\n            var list = arguments[arguments.length - 1];\n            var args = _slice(arguments);\n            args[0] = function () {\n                var result = origFn.apply(this, _concat(arguments, [\n                    idx,\n                    list\n                ]));\n                idx += 1;\n                return result;\n            };\n            return fn.apply(this, args);\n        });\n    });\n\n    /**\n     * Returns a curried equivalent of the provided function. The curried function\n     * has two unusual capabilities. First, its arguments needn't be provided one\n     * at a time. If `f` is a ternary function and `g` is `R.curry(f)`, the\n     * following are equivalent:\n     *\n     *   - `g(1)(2)(3)`\n     *   - `g(1)(2, 3)`\n     *   - `g(1, 2)(3)`\n     *   - `g(1, 2, 3)`\n     *\n     * Secondly, the special placeholder value `R.__` may be used to specify\n     * \"gaps\", allowing partial application of any combination of arguments,\n     * regardless of their positions. If `g` is as above and `_` is `R.__`, the\n     * following are equivalent:\n     *\n     *   - `g(1, 2, 3)`\n     *   - `g(_, 2, 3)(1)`\n     *   - `g(_, _, 3)(1)(2)`\n     *   - `g(_, _, 3)(1, 2)`\n     *   - `g(_, 2)(1)(3)`\n     *   - `g(_, 2)(1, 3)`\n     *   - `g(_, 2)(_, 3)(1)`\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category Function\n     * @sig (* -> a) -> (* -> a)\n     * @param {Function} fn The function to curry.\n     * @return {Function} A new, curried function.\n     * @see R.curryN\n     * @example\n     *\n     *      var addFourNumbers = (a, b, c, d) => a + b + c + d;\n     *\n     *      var curriedAddFourNumbers = R.curry(addFourNumbers);\n     *      var f = curriedAddFourNumbers(1, 2);\n     *      var g = f(3);\n     *      g(4); //=> 10\n     */\n    var curry = _curry1(function curry(fn) {\n        return curryN(fn.length, fn);\n    });\n\n    /**\n     * Returns `true` if its arguments are equivalent, `false` otherwise. Handles\n     * cyclical data structures.\n     *\n     * Dispatches symmetrically to the `equals` methods of both arguments, if\n     * present.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.15.0\n     * @category Relation\n     * @sig a -> b -> Boolean\n     * @param {*} a\n     * @param {*} b\n     * @return {Boolean}\n     * @example\n     *\n     *      R.equals(1, 1); //=> true\n     *      R.equals(1, '1'); //=> false\n     *      R.equals([1, 2, 3], [1, 2, 3]); //=> true\n     *\n     *      var a = {}; a.v = a;\n     *      var b = {}; b.v = b;\n     *      R.equals(a, b); //=> true\n     */\n    var equals = _curry2(function equals(a, b) {\n        return _equals(a, b, [], []);\n    });\n\n    /**\n     * Returns a new list by pulling every item out of it (and all its sub-arrays)\n     * and putting them in a new array, depth-first.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category List\n     * @sig [a] -> [b]\n     * @param {Array} list The array to consider.\n     * @return {Array} The flattened list.\n     * @see R.unnest\n     * @example\n     *\n     *      R.flatten([1, 2, [3, 4], 5, [6, [7, 8, [9, [10, 11], 12]]]]);\n     *      //=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]\n     */\n    var flatten = _curry1(_makeFlat(true));\n\n    /**\n     * Returns a new list, constructed by applying the supplied function to every\n     * element of the supplied list.\n     *\n     * Note: `R.map` does not skip deleted or unassigned indices (sparse arrays),\n     * unlike the native `Array.prototype.map` method. For more details on this\n     * behavior, see:\n     * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map#Description\n     *\n     * Dispatches to the `map` method of the second argument, if present.\n     *\n     * Acts as a transducer if a transformer is given in list position.\n     *\n     * Also treats functions as functors and will compose them together.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category List\n     * @sig Functor f => (a -> b) -> f a -> f b\n     * @param {Function} fn The function to be called on every element of the input `list`.\n     * @param {Array} list The list to be iterated over.\n     * @return {Array} The new list.\n     * @see R.transduce, R.addIndex\n     * @example\n     *\n     *      var double = x => x * 2;\n     *\n     *      R.map(double, [1, 2, 3]); //=> [2, 4, 6]\n     *\n     *      R.map(double, {x: 1, y: 2, z: 3}); //=> {x: 2, y: 4, z: 6}\n     */\n    var map = _curry2(_dispatchable('map', _xmap, function map(fn, functor) {\n        switch (Object.prototype.toString.call(functor)) {\n        case '[object Function]':\n            return curryN(functor.length, function () {\n                return fn.call(this, functor.apply(this, arguments));\n            });\n        case '[object Object]':\n            return _reduce(function (acc, key) {\n                acc[key] = fn(functor[key]);\n                return acc;\n            }, {}, keys(functor));\n        default:\n            return _map(fn, functor);\n        }\n    }));\n\n    /**\n     * Like `mapObj`, but passes additional arguments to the predicate function.\n     * The predicate function is passed three arguments: *(value, key, obj)*.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.9.0\n     * @category Object\n     * @sig (v, k, {k: v} -> v) -> {k: v} -> {k: v}\n     * @param {Function} fn A function called for each property in `obj`. Its return value will\n     *        become a new property on the return object.\n     * @param {Object} obj The object to iterate over.\n     * @return {Object} A new object with the same keys as `obj` and values that are the result\n     *         of running each property through `fn`.\n     * @example\n     *\n     *      var values = { x: 1, y: 2, z: 3 };\n     *      var prependKeyAndDouble = (num, key, obj) => key + (num * 2);\n     *\n     *      R.mapObjIndexed(prependKeyAndDouble, values); //=> { x: 'x2', y: 'y4', z: 'z6' }\n     */\n    var mapObjIndexed = _curry2(function mapObjIndexed(fn, obj) {\n        return _reduce(function (acc, key) {\n            acc[key] = fn(obj[key], key, obj);\n            return acc;\n        }, {}, keys(obj));\n    });\n\n    /**\n     * Returns a single item by iterating through the list, successively calling\n     * the iterator function and passing it an accumulator value and the current\n     * value from the array, and then passing the result to the next call.\n     *\n     * The iterator function receives two values: *(acc, value)*. It may use\n     * `R.reduced` to shortcut the iteration.\n     *\n     * Note: `R.reduce` does not skip deleted or unassigned indices (sparse\n     * arrays), unlike the native `Array.prototype.reduce` method. For more details\n     * on this behavior, see:\n     * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce#Description\n     *\n     * Dispatches to the `reduce` method of the third argument, if present.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category List\n     * @sig ((a, b) -> a) -> a -> [b] -> a\n     * @param {Function} fn The iterator function. Receives two values, the accumulator and the\n     *        current element from the array.\n     * @param {*} acc The accumulator value.\n     * @param {Array} list The list to iterate over.\n     * @return {*} The final, accumulated value.\n     * @see R.reduced, R.addIndex\n     * @example\n     *\n     *      var numbers = [1, 2, 3];\n     *      var add = (a, b) => a + b;\n     *\n     *      R.reduce(add, 10, numbers); //=> 16\n     */\n    var reduce = _curry3(_reduce);\n\n    var _flatCat = function () {\n        var preservingReduced = function (xf) {\n            return {\n                '@@transducer/init': _xfBase.init,\n                '@@transducer/result': function (result) {\n                    return xf['@@transducer/result'](result);\n                },\n                '@@transducer/step': function (result, input) {\n                    var ret = xf['@@transducer/step'](result, input);\n                    return ret['@@transducer/reduced'] ? _forceReduced(ret) : ret;\n                }\n            };\n        };\n        return function _xcat(xf) {\n            var rxf = preservingReduced(xf);\n            return {\n                '@@transducer/init': _xfBase.init,\n                '@@transducer/result': function (result) {\n                    return rxf['@@transducer/result'](result);\n                },\n                '@@transducer/step': function (result, input) {\n                    return !isArrayLike(input) ? _reduce(rxf, result, [input]) : _reduce(rxf, result, input);\n                }\n            };\n        };\n    }();\n\n    var _indexOf = function _indexOf(list, item, from) {\n        var idx = from;\n        while (idx < list.length) {\n            if (equals(list[idx], item)) {\n                return idx;\n            }\n            idx += 1;\n        }\n        return -1;\n    };\n\n    var _xchain = _curry2(function _xchain(f, xf) {\n        return map(f, _flatCat(xf));\n    });\n\n    /**\n     * `chain` maps a function over a list and concatenates the results. `chain`\n     * is also known as `flatMap` in some libraries\n     *\n     * Dispatches to the `chain` method of the second argument, if present.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.3.0\n     * @category List\n     * @sig (a -> [b]) -> [a] -> [b]\n     * @param {Function} fn\n     * @param {Array} list\n     * @return {Array}\n     * @example\n     *\n     *      var duplicate = n => [n, n];\n     *      R.chain(duplicate, [1, 2, 3]); //=> [1, 1, 2, 2, 3, 3]\n     */\n    var chain = _curry2(_dispatchable('chain', _xchain, function chain(fn, monad) {\n        if (typeof monad === 'function') {\n            return function () {\n                return monad.call(this, fn.apply(this, arguments)).apply(this, arguments);\n            };\n        }\n        return _makeFlat(false)(map(fn, monad));\n    }));\n\n    /**\n     * Performs left-to-right function composition. The leftmost function may have\n     * any arity; the remaining functions must be unary.\n     *\n     * In some libraries this function is named `sequence`.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category Function\n     * @sig (((a, b, ..., n) -> o), (o -> p), ..., (x -> y), (y -> z)) -> ((a, b, ..., n) -> z)\n     * @param {...Function} functions\n     * @return {Function}\n     * @see R.compose\n     * @example\n     *\n     *      var f = R.pipe(Math.pow, R.negate, R.inc);\n     *\n     *      f(3, 4); // -(3^4) + 1\n     */\n    var pipe = function pipe() {\n        if (arguments.length === 0) {\n            throw new Error('pipe requires at least one argument');\n        }\n        return _arity(arguments[0].length, reduce(_pipe, arguments[0], tail(arguments)));\n    };\n\n    /* globals Set */\n    // manually crawl the list to distinguish between +0 and -0\n    // non-zero numbers can utilise Set\n    // all these types can utilise Set\n    // null can utilise Set\n    // other objects need R.equals for equality\n    // anything else not covered above, defer to R.equals\n    var _contains = typeof Set === 'undefined' ? function _contains(a, list) {\n        return _indexOf(list, a, 0) >= 0;\n    } : function _containsSet(a, list) {\n        var idx, inf, item;\n        switch (typeof a) {\n        case 'number':\n            if (a === 0) {\n                // manually crawl the list to distinguish between +0 and -0\n                idx = 0;\n                inf = 1 / a;\n                while (idx < list.length) {\n                    item = list[idx];\n                    if (item === 0 && 1 / item === inf) {\n                        return true;\n                    }\n                    idx += 1;\n                }\n                return false;\n            }\n            // non-zero numbers can utilise Set\n            return new Set(list).has(a);\n        // all these types can utilise Set\n        case 'string':\n        case 'boolean':\n        case 'function':\n        case 'undefined':\n            return new Set(list).has(a);\n        case 'object':\n            if (a === null) {\n                // null can utilise Set\n                return new Set(list).has(a);\n            }\n            // other objects need R.equals for equality\n            return _indexOf(list, a, 0) >= 0;\n        default:\n            // anything else not covered above, defer to R.equals\n            return _indexOf(list, a, 0) >= 0;\n        }\n    };\n\n    /**\n     * Performs right-to-left function composition. The rightmost function may have\n     * any arity; the remaining functions must be unary.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category Function\n     * @sig ((y -> z), (x -> y), ..., (o -> p), ((a, b, ..., n) -> o)) -> ((a, b, ..., n) -> z)\n     * @param {...Function} functions\n     * @return {Function}\n     * @see R.pipe\n     * @example\n     *\n     *      var f = R.compose(R.inc, R.negate, Math.pow);\n     *\n     *      f(3, 4); // -(3^4) + 1\n     */\n    var compose = function compose() {\n        if (arguments.length === 0) {\n            throw new Error('compose requires at least one argument');\n        }\n        return pipe.apply(this, reverse(arguments));\n    };\n\n    /**\n     * Returns `true` if the specified value is equal, in `R.equals` terms, to at\n     * least one element of the given list; `false` otherwise.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category List\n     * @sig a -> [a] -> Boolean\n     * @param {Object} a The item to compare against.\n     * @param {Array} list The array to consider.\n     * @return {Boolean} `true` if the item is in the list, `false` otherwise.\n     * @see R.any\n     * @example\n     *\n     *      R.contains(3, [1, 2, 3]); //=> true\n     *      R.contains(4, [1, 2, 3]); //=> false\n     *      R.contains([42], [[42]]); //=> true\n     */\n    var contains = _curry2(_contains);\n\n    /**\n     * Returns a partial copy of an object omitting the keys specified.\n     *\n     * @func\n     * @memberOf R\n     * @since v0.1.0\n     * @category Object\n     * @sig [String] -> {String: *} -> {String: *}\n     * @param {Array} names an array of String property names to omit from the new object\n     * @param {Object} obj The object to copy from\n     * @return {Object} A new object with properties from `names` not on it.\n     * @see R.pick\n     * @example\n     *\n     *      R.omit(['a', 'd'], {a: 1, b: 2, c: 3, d: 4}); //=> {b: 2, c: 3}\n     */\n    var omit = _curry2(function omit(names, obj) {\n        var result = {};\n        for (var prop in obj) {\n            if (!_contains(prop, names)) {\n                result[prop] = obj[prop];\n            }\n        }\n        return result;\n    });\n\n    var R = {\n        addIndex: addIndex,\n        all: all,\n        chain: chain,\n        compose: compose,\n        contains: contains,\n        curry: curry,\n        curryN: curryN,\n        filter: filter,\n        find: find,\n        findIndex: findIndex,\n        flatten: flatten,\n        forEach: forEach,\n        is: is,\n        map: map,\n        mapObjIndexed: mapObjIndexed,\n        omit: omit,\n        pick: pick,\n        pickBy: pickBy,\n        prop: prop,\n        props: props,\n        reduce: reduce,\n        values: values\n    };\n\n  /* TEST_ENTRY_POINT */\n\n  if (typeof exports === 'object') {\n    module.exports = R;\n  } else if (typeof define === 'function' && define.amd) {\n    define(function() { return R; });\n  } else {\n    this.R = R;\n  }\n\n}.call(this));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./vendor/ramda.js\n// module id = 78\n// module chunks = 0 1 2","import apiBase from './apiBase';\n\nfunction fetchNext(url, urls, success, failure, { contentType, method, body }) {\n  function tryNext(err) {\n    if (urls.length) {\n      return fetchNext(urls[0], urls.slice(1), success, failure, { contentType, method, body });\n    } else {\n      failure(err);\n    }\n  }\n\n  if (contentType === 'img') {\n    let img = new Image();\n    img.crossOrigin = 'anonymous'; // don't send cookies, but do send Origin: header\n    img.addEventListener('load', (e) => {\n      success(img);\n    });\n    img.addEventListener('error', tryNext);\n    img.src = url; //s.shift();\n  } else if (contentType === 'external') {\n    // This will need to use JSONP in some fashion (either dynamic function,\n    // or some sort of global plugin namespace in order to work, since\n    // CORS prevents us from just loading the file via xhr\n    throw new Error('External Script support not allowed in the browser');\n  } else {\n    let request = new XMLHttpRequest();\n    const requestMethod = method || 'GET';\n    if (requestMethod !== 'GET') request.withCredentials = true;\n    request.open(requestMethod, url, true);\n    if (body) request.setRequestHeader('Content-Type', 'application/json');\n\n    if (contentType === 'binary') request.responseType = 'arraybuffer';\n    request.onload = (xhr) => {\n      let response = request.response;\n\n      if (request.status >= 200 && request.status < 400) {\n        if (contentType === 'json') response = JSON.parse(response);\n        success(response);\n      } else {\n        tryNext(request);\n      }\n    };\n\n    request.onerror = tryNext;\n    request.send(body);\n  }\n}\n\nconst callApi = apiBase(fetchNext);\n\nexport default callApi;\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/api.js","import { lzmaDecompressor } from './utils/lzmaDecompressor';\nimport { forEach } from 'ramda';\nimport rsvp from 'rsvp';\n\n// Simple, persistent api cache for now.\nconst apiCache = {};\nconst fetchingCache = {};\n\nexport default function apiBase(fetchNext) {\n  return (store, { types, url, fireAndForget, payload, queryKey, requestPayload, cache, method, contentType, body, files, success, failure, decompress }) => {\n    let urls = Array.isArray(url) ? url : [url];\n    if (!contentType) contentType = 'json';\n    const [requestType, successType, failureType] = types || ['IGN', 'IGN', 'IGN'];\n\n    // If we provide a 'queryKey', there can be only one query at once\n    if (queryKey) {\n      if (apiCache[queryKey]) {\n        return fireAndForget ? apiCache[queryKey] : Promise.resolve(apiCache[queryKey]);\n      }\n\n      if (fetchingCache[queryKey]) {\n        if (fireAndForget) {\n          fetchingCache[queryKey].push({ payload, store });\n          store.dispatch({ type: requestType, payload });\n          return;\n        } else {\n          return new rsvp.Promise((resolve, reject) => {\n            fetchingCache[queryKey].push({ payload, store, resolve, reject });\n            store.dispatch({ type: requestType, payload });\n          });\n        }\n      }\n\n      fetchingCache[queryKey] = [{ payload, store }];\n    }\n\n    store.dispatch({ type: requestType, payload });\n\n    var promise = new rsvp.Promise((resolve, reject) => {\n      const meta = {\n        queryKey,\n        payload,\n        successType,\n        success,\n        failureType,\n        failure,\n      };\n\n      function onFailure(error, workerMeta) {\n        const { failureType, failure, queryKey, payload } = workerMeta || meta;\n\n        if (queryKey) {\n          forEach(({ payload, store, reject }) => {\n            store.dispatch({ type: failureType, payload, error });\n            if (reject) reject(error);\n          }, fetchingCache[queryKey]);\n          delete fetchingCache[queryKey];\n        } else {\n          store.dispatch({ type: failureType, payload: payload, error });\n        }\n\n        if (failure) failure(error);\n        reject(error);\n      };\n\n      function onSuccessEnd(buffer, workerMeta) {\n        const { successType, sucess, queryKey, payload } = workerMeta || meta;\n        if (queryKey) {\n          apiCache[queryKey] = buffer;\n          forEach(({ payload, store, resolve }) => {\n            store.dispatch({ type: successType, payload, response: buffer });\n            if (resolve) resolve(buffer);\n          }, fetchingCache[queryKey]);\n          delete fetchingCache[queryKey];\n        } else {\n          store.dispatch({ type: successType, payload: payload, response: buffer });\n        }\n\n        if (success) success(buffer);\n        resolve(buffer);\n      }\n\n      function onSuccess(response) {\n        if (decompress) {\n          lzmaDecompressor(response, meta, onSuccessEnd, onFailure);\n        } else {\n          onSuccessEnd(response);\n        }\n      };\n\n      fetchNext(urls[0], urls.slice(1), onSuccess, onFailure, { contentType, method, body, files });\n    });\n\n    return fireAndForget ? null : promise;\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/apiBase.js","module.exports = { \"default\": require(\"core-js/library/fn/promise\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/promise.js\n// module id = 81\n// module chunks = 0 1 2","require('../modules/es6.object.to-string');\nrequire('../modules/es6.string.iterator');\nrequire('../modules/web.dom.iterable');\nrequire('../modules/es6.promise');\nmodule.exports = require('../modules/_core').Promise;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/promise.js\n// module id = 82\n// module chunks = 0 1 2","require('./es6.array.iterator');\nvar global        = require('./_global')\n  , hide          = require('./_hide')\n  , Iterators     = require('./_iterators')\n  , TO_STRING_TAG = require('./_wks')('toStringTag');\n\nfor(var collections = ['NodeList', 'DOMTokenList', 'MediaList', 'StyleSheetList', 'CSSRuleList'], i = 0; i < 5; i++){\n  var NAME       = collections[i]\n    , Collection = global[NAME]\n    , proto      = Collection && Collection.prototype;\n  if(proto && !proto[TO_STRING_TAG])hide(proto, TO_STRING_TAG, NAME);\n  Iterators[NAME] = Iterators.Array;\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/web.dom.iterable.js\n// module id = 84\n// module chunks = 0 1 2","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables')\n  , step             = require('./_iter-step')\n  , Iterators        = require('./_iterators')\n  , toIObject        = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function(iterated, kind){\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , kind  = this._k\n    , index = this._i++;\n  if(!O || index >= O.length){\n    this._t = undefined;\n    return step(1);\n  }\n  if(kind == 'keys'  )return step(0, index);\n  if(kind == 'values')return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.array.iterator.js\n// module id = 85\n// module chunks = 0 1 2","module.exports = function(){ /* empty */ };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_add-to-unscopables.js\n// module id = 86\n// module chunks = 0 1 2","module.exports = function(done, value){\n  return {value: value, done: !!done};\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_iter-step.js\n// module id = 87\n// module chunks = 0 1 2","'use strict';\nvar LIBRARY            = require('./_library')\n  , global             = require('./_global')\n  , ctx                = require('./_ctx')\n  , classof            = require('./_classof')\n  , $export            = require('./_export')\n  , isObject           = require('./_is-object')\n  , aFunction          = require('./_a-function')\n  , anInstance         = require('./_an-instance')\n  , forOf              = require('./_for-of')\n  , speciesConstructor = require('./_species-constructor')\n  , task               = require('./_task').set\n  , microtask          = require('./_microtask')()\n  , PROMISE            = 'Promise'\n  , TypeError          = global.TypeError\n  , process            = global.process\n  , $Promise           = global[PROMISE]\n  , process            = global.process\n  , isNode             = classof(process) == 'process'\n  , empty              = function(){ /* empty */ }\n  , Internal, GenericPromiseCapability, Wrapper;\n\nvar USE_NATIVE = !!function(){\n  try {\n    // correct subclassing with @@species support\n    var promise     = $Promise.resolve(1)\n      , FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function(exec){ exec(empty, empty); };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function') && promise.then(empty) instanceof FakePromise;\n  } catch(e){ /* empty */ }\n}();\n\n// helpers\nvar sameConstructor = function(a, b){\n  // with library wrapper special case\n  return a === b || a === $Promise && b === Wrapper;\n};\nvar isThenable = function(it){\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar newPromiseCapability = function(C){\n  return sameConstructor($Promise, C)\n    ? new PromiseCapability(C)\n    : new GenericPromiseCapability(C);\n};\nvar PromiseCapability = GenericPromiseCapability = function(C){\n  var resolve, reject;\n  this.promise = new C(function($$resolve, $$reject){\n    if(resolve !== undefined || reject !== undefined)throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject  = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject  = aFunction(reject);\n};\nvar perform = function(exec){\n  try {\n    exec();\n  } catch(e){\n    return {error: e};\n  }\n};\nvar notify = function(promise, isReject){\n  if(promise._n)return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function(){\n    var value = promise._v\n      , ok    = promise._s == 1\n      , i     = 0;\n    var run = function(reaction){\n      var handler = ok ? reaction.ok : reaction.fail\n        , resolve = reaction.resolve\n        , reject  = reaction.reject\n        , domain  = reaction.domain\n        , result, then;\n      try {\n        if(handler){\n          if(!ok){\n            if(promise._h == 2)onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if(handler === true)result = value;\n          else {\n            if(domain)domain.enter();\n            result = handler(value);\n            if(domain)domain.exit();\n          }\n          if(result === reaction.promise){\n            reject(TypeError('Promise-chain cycle'));\n          } else if(then = isThenable(result)){\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch(e){\n        reject(e);\n      }\n    };\n    while(chain.length > i)run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if(isReject && !promise._h)onUnhandled(promise);\n  });\n};\nvar onUnhandled = function(promise){\n  task.call(global, function(){\n    var value = promise._v\n      , abrupt, handler, console;\n    if(isUnhandled(promise)){\n      abrupt = perform(function(){\n        if(isNode){\n          process.emit('unhandledRejection', value, promise);\n        } else if(handler = global.onunhandledrejection){\n          handler({promise: promise, reason: value});\n        } else if((console = global.console) && console.error){\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if(abrupt)throw abrupt.error;\n  });\n};\nvar isUnhandled = function(promise){\n  if(promise._h == 1)return false;\n  var chain = promise._a || promise._c\n    , i     = 0\n    , reaction;\n  while(chain.length > i){\n    reaction = chain[i++];\n    if(reaction.fail || !isUnhandled(reaction.promise))return false;\n  } return true;\n};\nvar onHandleUnhandled = function(promise){\n  task.call(global, function(){\n    var handler;\n    if(isNode){\n      process.emit('rejectionHandled', promise);\n    } else if(handler = global.onrejectionhandled){\n      handler({promise: promise, reason: promise._v});\n    }\n  });\n};\nvar $reject = function(value){\n  var promise = this;\n  if(promise._d)return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if(!promise._a)promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function(value){\n  var promise = this\n    , then;\n  if(promise._d)return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if(promise === value)throw TypeError(\"Promise can't be resolved itself\");\n    if(then = isThenable(value)){\n      microtask(function(){\n        var wrapper = {_w: promise, _d: false}; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch(e){\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch(e){\n    $reject.call({_w: promise, _d: false}, e); // wrap\n  }\n};\n\n// constructor polyfill\nif(!USE_NATIVE){\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor){\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch(err){\n      $reject.call(this, err);\n    }\n  };\n  Internal = function Promise(executor){\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = require('./_redefine-all')($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected){\n      var reaction    = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok     = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail   = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if(this._a)this._a.push(reaction);\n      if(this._s)notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function(onRejected){\n      return this.then(undefined, onRejected);\n    }\n  });\n  PromiseCapability = function(){\n    var promise  = new Internal;\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject  = ctx($reject, promise, 1);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, {Promise: $Promise});\nrequire('./_set-to-string-tag')($Promise, PROMISE);\nrequire('./_set-species')(PROMISE);\nWrapper = require('./_core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r){\n    var capability = newPromiseCapability(this)\n      , $$reject   = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x){\n    // instanceof instead of internal slot check because we should fix it without replacement native Promise core\n    if(x instanceof $Promise && sameConstructor(x.constructor, this))return x;\n    var capability = newPromiseCapability(this)\n      , $$resolve  = capability.resolve;\n    $$resolve(x);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function(iter){\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable){\n    var C          = this\n      , capability = newPromiseCapability(C)\n      , resolve    = capability.resolve\n      , reject     = capability.reject;\n    var abrupt = perform(function(){\n      var values    = []\n        , index     = 0\n        , remaining = 1;\n      forOf(iterable, false, function(promise){\n        var $index        = index++\n          , alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function(value){\n          if(alreadyCalled)return;\n          alreadyCalled  = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable){\n    var C          = this\n      , capability = newPromiseCapability(C)\n      , reject     = capability.reject;\n    var abrupt = perform(function(){\n      forOf(iterable, false, function(promise){\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.promise.js\n// module id = 88\n// module chunks = 0 1 2","module.exports = function(it, Constructor, name, forbiddenField){\n  if(!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)){\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_an-instance.js\n// module id = 89\n// module chunks = 0 1 2","var ctx         = require('./_ctx')\n  , call        = require('./_iter-call')\n  , isArrayIter = require('./_is-array-iter')\n  , anObject    = require('./_an-object')\n  , toLength    = require('./_to-length')\n  , getIterFn   = require('./core.get-iterator-method')\n  , BREAK       = {}\n  , RETURN      = {};\nvar exports = module.exports = function(iterable, entries, fn, that, ITERATOR){\n  var iterFn = ITERATOR ? function(){ return iterable; } : getIterFn(iterable)\n    , f      = ctx(fn, that, entries ? 2 : 1)\n    , index  = 0\n    , length, step, iterator, result;\n  if(typeof iterFn != 'function')throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if(isArrayIter(iterFn))for(length = toLength(iterable.length); length > index; index++){\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if(result === BREAK || result === RETURN)return result;\n  } else for(iterator = iterFn.call(iterable); !(step = iterator.next()).done; ){\n    result = call(iterator, f, step.value, entries);\n    if(result === BREAK || result === RETURN)return result;\n  }\n};\nexports.BREAK  = BREAK;\nexports.RETURN = RETURN;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_for-of.js\n// module id = 90\n// module chunks = 0 1 2","// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject  = require('./_an-object')\n  , aFunction = require('./_a-function')\n  , SPECIES   = require('./_wks')('species');\nmodule.exports = function(O, D){\n  var C = anObject(O).constructor, S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_species-constructor.js\n// module id = 91\n// module chunks = 0 1 2","var ctx                = require('./_ctx')\n  , invoke             = require('./_invoke')\n  , html               = require('./_html')\n  , cel                = require('./_dom-create')\n  , global             = require('./_global')\n  , process            = global.process\n  , setTask            = global.setImmediate\n  , clearTask          = global.clearImmediate\n  , MessageChannel     = global.MessageChannel\n  , counter            = 0\n  , queue              = {}\n  , ONREADYSTATECHANGE = 'onreadystatechange'\n  , defer, channel, port;\nvar run = function(){\n  var id = +this;\n  if(queue.hasOwnProperty(id)){\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function(event){\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif(!setTask || !clearTask){\n  setTask = function setImmediate(fn){\n    var args = [], i = 1;\n    while(arguments.length > i)args.push(arguments[i++]);\n    queue[++counter] = function(){\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id){\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if(require('./_cof')(process) == 'process'){\n    defer = function(id){\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if(MessageChannel){\n    channel = new MessageChannel;\n    port    = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if(global.addEventListener && typeof postMessage == 'function' && !global.importScripts){\n    defer = function(id){\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if(ONREADYSTATECHANGE in cel('script')){\n    defer = function(id){\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function(){\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function(id){\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set:   setTask,\n  clear: clearTask\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_task.js\n// module id = 92\n// module chunks = 0 1 2","// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function(fn, args, that){\n  var un = that === undefined;\n  switch(args.length){\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return              fn.apply(that, args);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_invoke.js\n// module id = 93\n// module chunks = 0 1 2","var global    = require('./_global')\n  , macrotask = require('./_task').set\n  , Observer  = global.MutationObserver || global.WebKitMutationObserver\n  , process   = global.process\n  , Promise   = global.Promise\n  , isNode    = require('./_cof')(process) == 'process';\n\nmodule.exports = function(){\n  var head, last, notify;\n\n  var flush = function(){\n    var parent, fn;\n    if(isNode && (parent = process.domain))parent.exit();\n    while(head){\n      fn   = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch(e){\n        if(head)notify();\n        else last = undefined;\n        throw e;\n      }\n    } last = undefined;\n    if(parent)parent.enter();\n  };\n\n  // Node.js\n  if(isNode){\n    notify = function(){\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver\n  } else if(Observer){\n    var toggle = true\n      , node   = document.createTextNode('');\n    new Observer(flush).observe(node, {characterData: true}); // eslint-disable-line no-new\n    notify = function(){\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if(Promise && Promise.resolve){\n    var promise = Promise.resolve();\n    notify = function(){\n      promise.then(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function(){\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n\n  return function(fn){\n    var task = {fn: fn, next: undefined};\n    if(last)last.next = task;\n    if(!head){\n      head = task;\n      notify();\n    } last = task;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_microtask.js\n// module id = 94\n// module chunks = 0 1 2","var hide = require('./_hide');\nmodule.exports = function(target, src, safe){\n  for(var key in src){\n    if(safe && target[key])target[key] = src[key];\n    else hide(target, key, src[key]);\n  } return target;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_redefine-all.js\n// module id = 95\n// module chunks = 0 1 2","'use strict';\nvar global      = require('./_global')\n  , core        = require('./_core')\n  , dP          = require('./_object-dp')\n  , DESCRIPTORS = require('./_descriptors')\n  , SPECIES     = require('./_wks')('species');\n\nmodule.exports = function(KEY){\n  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];\n  if(DESCRIPTORS && C && !C[SPECIES])dP.f(C, SPECIES, {\n    configurable: true,\n    get: function(){ return this; }\n  });\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_set-species.js\n// module id = 96\n// module chunks = 0 1 2","\"use strict\";\n\nexports.__esModule = true;\n\nvar _isIterable2 = require(\"../core-js/is-iterable\");\n\nvar _isIterable3 = _interopRequireDefault(_isIterable2);\n\nvar _getIterator2 = require(\"../core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = (0, _getIterator3.default)(arr), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if ((0, _isIterable3.default)(Object(arr))) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/slicedToArray.js\n// module id = 97\n// module chunks = 0 1 2","module.exports = { \"default\": require(\"core-js/library/fn/is-iterable\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/is-iterable.js\n// module id = 98\n// module chunks = 0 1 2","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.is-iterable');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/is-iterable.js\n// module id = 99\n// module chunks = 0 1 2","var classof   = require('./_classof')\n  , ITERATOR  = require('./_wks')('iterator')\n  , Iterators = require('./_iterators');\nmodule.exports = require('./_core').isIterable = function(it){\n  var O = Object(it);\n  return O[ITERATOR] !== undefined\n    || '@@iterator' in O\n    || Iterators.hasOwnProperty(classof(O));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/core.is-iterable.js\n// module id = 100\n// module chunks = 0 1 2","module.exports = { \"default\": require(\"core-js/library/fn/get-iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/get-iterator.js\n// module id = 101\n// module chunks = 0 1 2","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/get-iterator.js\n// module id = 102\n// module chunks = 0 1 2","var anObject = require('./_an-object')\n  , get      = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function(it){\n  var iterFn = get(it);\n  if(typeof iterFn != 'function')throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/core.get-iterator.js\n// module id = 103\n// module chunks = 0 1 2","import LZMA from '../../../vendor/lzma';\n\nconst LZMARaw = `\n//From Repository: https://github.com/jcmellado/js-lzma\n/*\nCopyright (c) 2011 Juan Mellado\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n*/\n\n/*\nReferences:\n- \"LZMA SDK\" by Igor Pavlov\n  http://www.7-zip.org/sdk.html\n*/\n\nvar LZMA = LZMA || {};\n\nLZMA.OutWindow = function(){\n  this._windowSize = 0;\n};\n\nLZMA.OutWindow.prototype.create = function(windowSize){\n  if ( (!this._buffer) || (this._windowSize !== windowSize) ){\n    this._buffer = [];\n  }\n  this._windowSize = windowSize;\n  this._pos = 0;\n  this._streamPos = 0;\n};\n\nLZMA.OutWindow.prototype.flush = function(){\n  var size = this._pos - this._streamPos;\n  if (size !== 0){\n    while(size --){\n      this._stream.writeByte(this._buffer[this._streamPos ++]);\n    }\n    if (this._pos >= this._windowSize){\n      this._pos = 0;\n    }\n    this._streamPos = this._pos;\n  }\n};\n\nLZMA.OutWindow.prototype.releaseStream = function(){\n  this.flush();\n  this._stream = null;\n};\n\nLZMA.OutWindow.prototype.setStream = function(stream){\n  this.releaseStream();\n  this._stream = stream;\n};\n\nLZMA.OutWindow.prototype.init = function(solid){\n  if (!solid){\n    this._streamPos = 0;\n    this._pos = 0;\n  }\n};\n\nLZMA.OutWindow.prototype.copyBlock = function(distance, len){\n  var pos = this._pos - distance - 1;\n  if (pos < 0){\n    pos += this._windowSize;\n  }\n  while(len --){\n    if (pos >= this._windowSize){\n      pos = 0;\n    }\n    this._buffer[this._pos ++] = this._buffer[pos ++];\n    if (this._pos >= this._windowSize){\n      this.flush();\n    }\n  }\n};\n\nLZMA.OutWindow.prototype.putByte = function(b){\n  this._buffer[this._pos ++] = b;\n  if (this._pos >= this._windowSize){\n    this.flush();\n  }\n};\n\nLZMA.OutWindow.prototype.getByte = function(distance){\n  var pos = this._pos - distance - 1;\n  if (pos < 0){\n    pos += this._windowSize;\n  }\n  return this._buffer[pos];\n};\n\nLZMA.RangeDecoder = function(){\n};\n\nLZMA.RangeDecoder.prototype.setStream = function(stream){\n  this._stream = stream;\n};\n\nLZMA.RangeDecoder.prototype.releaseStream = function(){\n  this._stream = null;\n};\n\nLZMA.RangeDecoder.prototype.init = function(){\n  var i = 5;\n\n  this._code = 0;\n  this._range = -1;\n\n  while(i --){\n    this._code = (this._code << 8) | this._stream.readByte();\n  }\n};\n\nLZMA.RangeDecoder.prototype.decodeDirectBits = function(numTotalBits){\n  var result = 0, i = numTotalBits, t;\n\n  while(i --){\n    this._range >>>= 1;\n    t = (this._code - this._range) >>> 31;\n    this._code -= this._range & (t - 1);\n    result = (result << 1) | (1 - t);\n\n    if ( (this._range & 0xff000000) === 0){\n      this._code = (this._code << 8) | this._stream.readByte();\n      this._range <<= 8;\n    }\n  }\n\n  return result;\n};\n\nLZMA.RangeDecoder.prototype.decodeBit = function(probs, index){\n  var prob = probs[index],\n      newBound = (this._range >>> 11) * prob;\n\n  if ( (this._code ^ 0x80000000) < (newBound ^ 0x80000000) ){\n    this._range = newBound;\n    probs[index] += (2048 - prob) >>> 5;\n    if ( (this._range & 0xff000000) === 0){\n      this._code = (this._code << 8) | this._stream.readByte();\n      this._range <<= 8;\n    }\n    return 0;\n  }\n\n  this._range -= newBound;\n  this._code -= newBound;\n  probs[index] -= prob >>> 5;\n  if ( (this._range & 0xff000000) === 0){\n    this._code = (this._code << 8) | this._stream.readByte();\n    this._range <<= 8;\n  }\n  return 1;\n};\n\nLZMA.initBitModels = function(probs, len){\n  while(len --){\n    probs[len] = 1024;\n  }\n};\n\nLZMA.BitTreeDecoder = function(numBitLevels){\n  this._models = [];\n  this._numBitLevels = numBitLevels;\n};\n\nLZMA.BitTreeDecoder.prototype.init = function(){\n  LZMA.initBitModels(this._models, 1 << this._numBitLevels);\n};\n\nLZMA.BitTreeDecoder.prototype.decode = function(rangeDecoder){\n  var m = 1, i = this._numBitLevels;\n\n  while(i --){\n    m = (m << 1) | rangeDecoder.decodeBit(this._models, m);\n  }\n  return m - (1 << this._numBitLevels);\n};\n\nLZMA.BitTreeDecoder.prototype.reverseDecode = function(rangeDecoder){\n  var m = 1, symbol = 0, i = 0, bit;\n\n  for (; i < this._numBitLevels; ++ i){\n    bit = rangeDecoder.decodeBit(this._models, m);\n    m = (m << 1) | bit;\n    symbol |= bit << i;\n  }\n  return symbol;\n};\n\nLZMA.reverseDecode2 = function(models, startIndex, rangeDecoder, numBitLevels){\n  var m = 1, symbol = 0, i = 0, bit;\n\n  for (; i < numBitLevels; ++ i){\n    bit = rangeDecoder.decodeBit(models, startIndex + m);\n    m = (m << 1) | bit;\n    symbol |= bit << i;\n  }\n  return symbol;\n};\n\nLZMA.LenDecoder = function(){\n  this._choice = [];\n  this._lowCoder = [];\n  this._midCoder = [];\n  this._highCoder = new LZMA.BitTreeDecoder(8);\n  this._numPosStates = 0;\n};\n\nLZMA.LenDecoder.prototype.create = function(numPosStates){\n  for (; this._numPosStates < numPosStates; ++ this._numPosStates){\n    this._lowCoder[this._numPosStates] = new LZMA.BitTreeDecoder(3);\n    this._midCoder[this._numPosStates] = new LZMA.BitTreeDecoder(3);\n  }\n};\n\nLZMA.LenDecoder.prototype.init = function(){\n  var i = this._numPosStates;\n  LZMA.initBitModels(this._choice, 2);\n  while(i --){\n    this._lowCoder[i].init();\n    this._midCoder[i].init();\n  }\n  this._highCoder.init();\n};\n\nLZMA.LenDecoder.prototype.decode = function(rangeDecoder, posState){\n  if (rangeDecoder.decodeBit(this._choice, 0) === 0){\n    return this._lowCoder[posState].decode(rangeDecoder);\n  }\n  if (rangeDecoder.decodeBit(this._choice, 1) === 0){\n    return 8 + this._midCoder[posState].decode(rangeDecoder);\n  }\n  return 16 + this._highCoder.decode(rangeDecoder);\n};\n\nLZMA.Decoder2 = function(){\n  this._decoders = [];\n};\n\nLZMA.Decoder2.prototype.init = function(){\n  LZMA.initBitModels(this._decoders, 0x300);\n};\n\nLZMA.Decoder2.prototype.decodeNormal = function(rangeDecoder){\n  var symbol = 1;\n\n  do{\n    symbol = (symbol << 1) | rangeDecoder.decodeBit(this._decoders, symbol);\n  }while(symbol < 0x100);\n\n  return symbol & 0xff;\n};\n\nLZMA.Decoder2.prototype.decodeWithMatchByte = function(rangeDecoder, matchByte){\n  var symbol = 1, matchBit, bit;\n\n  do{\n    matchBit = (matchByte >> 7) & 1;\n    matchByte <<= 1;\n    bit = rangeDecoder.decodeBit(this._decoders, ( (1 + matchBit) << 8) + symbol);\n    symbol = (symbol << 1) | bit;\n    if (matchBit !== bit){\n      while(symbol < 0x100){\n        symbol = (symbol << 1) | rangeDecoder.decodeBit(this._decoders, symbol);\n      }\n      break;\n    }\n  }while(symbol < 0x100);\n\n  return symbol & 0xff;\n};\n\nLZMA.LiteralDecoder = function(){\n};\n\nLZMA.LiteralDecoder.prototype.create = function(numPosBits, numPrevBits){\n  var i;\n\n  if (this._coders\n    && (this._numPrevBits === numPrevBits)\n    && (this._numPosBits === numPosBits) ){\n    return;\n  }\n  this._numPosBits = numPosBits;\n  this._posMask = (1 << numPosBits) - 1;\n  this._numPrevBits = numPrevBits;\n\n  this._coders = [];\n\n  i = 1 << (this._numPrevBits + this._numPosBits);\n  while(i --){\n    this._coders[i] = new LZMA.Decoder2();\n  }\n};\n\nLZMA.LiteralDecoder.prototype.init = function(){\n  var i = 1 << (this._numPrevBits + this._numPosBits);\n  while(i --){\n    this._coders[i].init();\n  }\n};\n\nLZMA.LiteralDecoder.prototype.getDecoder = function(pos, prevByte){\n  return this._coders[( (pos & this._posMask) << this._numPrevBits)\n    + ( (prevByte & 0xff) >>> (8 - this._numPrevBits) )];\n};\n\nLZMA.Decoder = function(){\n  this._outWindow = new LZMA.OutWindow();\n  this._rangeDecoder = new LZMA.RangeDecoder();\n  this._isMatchDecoders = [];\n  this._isRepDecoders = [];\n  this._isRepG0Decoders = [];\n  this._isRepG1Decoders = [];\n  this._isRepG2Decoders = [];\n  this._isRep0LongDecoders = [];\n  this._posSlotDecoder = [];\n  this._posDecoders = [];\n  this._posAlignDecoder = new LZMA.BitTreeDecoder(4);\n  this._lenDecoder = new LZMA.LenDecoder();\n  this._repLenDecoder = new LZMA.LenDecoder();\n  this._literalDecoder = new LZMA.LiteralDecoder();\n  this._dictionarySize = -1;\n  this._dictionarySizeCheck = -1;\n\n  this._posSlotDecoder[0] = new LZMA.BitTreeDecoder(6);\n  this._posSlotDecoder[1] = new LZMA.BitTreeDecoder(6);\n  this._posSlotDecoder[2] = new LZMA.BitTreeDecoder(6);\n  this._posSlotDecoder[3] = new LZMA.BitTreeDecoder(6);\n};\n\nLZMA.Decoder.prototype.setDictionarySize = function(dictionarySize){\n  if (dictionarySize < 0){\n    return false;\n  }\n  if (this._dictionarySize !== dictionarySize){\n    this._dictionarySize = dictionarySize;\n    this._dictionarySizeCheck = Math.max(this._dictionarySize, 1);\n    this._outWindow.create( Math.max(this._dictionarySizeCheck, 4096) );\n  }\n  return true;\n};\n\nLZMA.Decoder.prototype.setLcLpPb = function(lc, lp, pb){\n  var numPosStates = 1 << pb;\n\n  if (lc > 8 || lp > 4 || pb > 4){\n    return false;\n  }\n\n  this._literalDecoder.create(lp, lc);\n\n  this._lenDecoder.create(numPosStates);\n  this._repLenDecoder.create(numPosStates);\n  this._posStateMask = numPosStates - 1;\n\n  return true;\n};\n\nLZMA.Decoder.prototype.init = function(){\n  var i = 4;\n\n  this._outWindow.init(false);\n\n  LZMA.initBitModels(this._isMatchDecoders, 192);\n  LZMA.initBitModels(this._isRep0LongDecoders, 192);\n  LZMA.initBitModels(this._isRepDecoders, 12);\n  LZMA.initBitModels(this._isRepG0Decoders, 12);\n  LZMA.initBitModels(this._isRepG1Decoders, 12);\n  LZMA.initBitModels(this._isRepG2Decoders, 12);\n  LZMA.initBitModels(this._posDecoders, 114);\n\n  this._literalDecoder.init();\n\n  while(i --){\n    this._posSlotDecoder[i].init();\n  }\n\n  this._lenDecoder.init();\n  this._repLenDecoder.init();\n  this._posAlignDecoder.init();\n  this._rangeDecoder.init();\n};\n\nLZMA.Decoder.prototype.decode = function(inStream, outStream, outSize){\n  var state = 0, rep0 = 0, rep1 = 0, rep2 = 0, rep3 = 0, nowPos64 = 0, prevByte = 0,\n      posState, decoder2, len, distance, posSlot, numDirectBits;\n\n  this._rangeDecoder.setStream(inStream);\n  this._outWindow.setStream(outStream);\n\n  this.init();\n\n  while(outSize < 0 || nowPos64 < outSize){\n    posState = nowPos64 & this._posStateMask;\n\n    if (this._rangeDecoder.decodeBit(this._isMatchDecoders, (state << 4) + posState) === 0){\n      decoder2 = this._literalDecoder.getDecoder(nowPos64 ++, prevByte);\n\n      if (state >= 7){\n        prevByte = decoder2.decodeWithMatchByte(this._rangeDecoder, this._outWindow.getByte(rep0) );\n      }else{\n        prevByte = decoder2.decodeNormal(this._rangeDecoder);\n      }\n      this._outWindow.putByte(prevByte);\n\n      state = state < 4? 0: state - (state < 10? 3: 6);\n\n    }else{\n\n      if (this._rangeDecoder.decodeBit(this._isRepDecoders, state) === 1){\n        len = 0;\n        if (this._rangeDecoder.decodeBit(this._isRepG0Decoders, state) === 0){\n          if (this._rangeDecoder.decodeBit(this._isRep0LongDecoders, (state << 4) + posState) === 0){\n            state = state < 7? 9: 11;\n            len = 1;\n          }\n        }else{\n          if (this._rangeDecoder.decodeBit(this._isRepG1Decoders, state) === 0){\n            distance = rep1;\n          }else{\n            if (this._rangeDecoder.decodeBit(this._isRepG2Decoders, state) === 0){\n              distance = rep2;\n            }else{\n              distance = rep3;\n              rep3 = rep2;\n            }\n            rep2 = rep1;\n          }\n          rep1 = rep0;\n          rep0 = distance;\n        }\n        if (len === 0){\n          len = 2 + this._repLenDecoder.decode(this._rangeDecoder, posState);\n          state = state < 7? 8: 11;\n        }\n      }else{\n        rep3 = rep2;\n        rep2 = rep1;\n        rep1 = rep0;\n\n        len = 2 + this._lenDecoder.decode(this._rangeDecoder, posState);\n        state = state < 7? 7: 10;\n\n        posSlot = this._posSlotDecoder[len <= 5? len - 2: 3].decode(this._rangeDecoder);\n        if (posSlot >= 4){\n\n          numDirectBits = (posSlot >> 1) - 1;\n          rep0 = (2 | (posSlot & 1) ) << numDirectBits;\n\n          if (posSlot < 14){\n            rep0 += LZMA.reverseDecode2(this._posDecoders,\n                rep0 - posSlot - 1, this._rangeDecoder, numDirectBits);\n          }else{\n            rep0 += this._rangeDecoder.decodeDirectBits(numDirectBits - 4) << 4;\n            rep0 += this._posAlignDecoder.reverseDecode(this._rangeDecoder);\n            if (rep0 < 0){\n              if (rep0 === -1){\n                break;\n              }\n              return false;\n            }\n          }\n        }else{\n          rep0 = posSlot;\n        }\n      }\n\n      if (rep0 >= nowPos64 || rep0 >= this._dictionarySizeCheck){\n        return false;\n      }\n\n      this._outWindow.copyBlock(rep0, len);\n      nowPos64 += len;\n      prevByte = this._outWindow.getByte(0);\n    }\n  }\n\n  this._outWindow.flush();\n  this._outWindow.releaseStream();\n  this._rangeDecoder.releaseStream();\n\n  return true;\n};\n\nLZMA.Decoder.prototype.setDecoderProperties = function(properties){\n  var value, lc, lp, pb, dictionarySize;\n\n  if (properties.size < 5){\n    return false;\n  }\n\n  value = properties.readByte();\n  lc = value % 9;\n  value = ~~(value / 9);\n  lp = value % 5;\n  pb = ~~(value / 5);\n\n  if ( !this.setLcLpPb(lc, lp, pb) ){\n    return false;\n  }\n\n  dictionarySize = properties.readByte();\n  dictionarySize |= properties.readByte() << 8;\n  dictionarySize |= properties.readByte() << 16;\n  dictionarySize += properties.readByte() * 16777216;\n\n  return this.setDictionarySize(dictionarySize);\n};\n\nLZMA.decompress = function(properties, inStream, outStream, outSize){\n  var decoder = new LZMA.Decoder();\n\n  if ( !decoder.setDecoderProperties(properties) ){\n    throw \"Incorrect stream properties\";\n  }\n\n  if ( !decoder.decode(inStream, outStream, outSize) ){\n    throw \"Error in data stream\";\n  }\n\n  return true;\n};\n\nLZMA.decompressFile = function(inStream, outStream){\n  var decoder = new LZMA.Decoder(), outSize;\n\n  if ( !decoder.setDecoderProperties(inStream) ){\n    throw \"Incorrect stream properties\";\n  }\n\n  outSize = inStream.readByte();\n  outSize |= inStream.readByte() << 8;\n  outSize |= inStream.readByte() << 16;\n  outSize += inStream.readByte() * 16777216;\n\n  inStream.readByte();\n  inStream.readByte();\n  inStream.readByte();\n  inStream.readByte();\n\n  if ( !decoder.decode(inStream, outStream, outSize) ){\n    throw \"Error in data stream\";\n  }\n\n  return true;\n};\n\n//export default LZMA;\n\n\n`;\n\nconst LZMAWorker = `\nfunction decompressBuffer(buffer){\n  var inStream = {\n    data: new Uint8Array(buffer),\n    offset: 0,\n    readByte: function() {\n      return this.data[this.offset++]\n    },\n  }\n  var outStream = {\n    data:[],\n    offset: 0,\n    writeByte: function(val) {\n      this.data[this.offset++] = val\n    },\n  }\n  LZMA.decompressFile(inStream, outStream);\n  var uintGeomArray = new Uint8Array(outStream.data);\n  return uintGeomArray.buffer;\n}\n\nself.onmessage = function( event ) {\n  if(event.data==='CLOSE') {\n    self.close();\n    return;\n  }\n\n  try {\n    var decompBuffer = decompressBuffer(event.data.buffer);\n    self.postMessage({type:'SUCCESS', buffer:decompBuffer, meta:event.data.meta});\n  } catch(e) {\n    self.postMessage({type:'FAILURE', error:e, meta:event.data.meta});\n  }\n\n};\n`;\nimport { find } from 'ramda';\n\nconst workerQueue = [];\nconst workerPool = [];\n\nlet workerBlob;\ntry {\n  workerBlob = new Blob([LZMARaw, LZMAWorker], { type: 'application/javascript' });\n} catch (e) { // Backwards-compatibility\n  if (__BROWSER__) {\n    window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder;\n    workerBlob = new BlobBuilder();\n    workerBlob.append(LZMARaw);\n    workerBlob.append(LZMAWorker);\n    workerBlob = blob.getBlob();\n  }\n}\n\nconst workerLimit = __BROWSER__ ? Math.max(window.navigator.hardwareConcurrency - 1, 1) : 0;\n\nfunction requeueWorker(idx) {\n  if (workerQueue.length > 0) {\n    let toBeDecompressed = workerQueue.shift();\n    toBeDecompressed.meta.idx = idx;\n    workerPool[idx].postMessage(toBeDecompressed);\n  } else {\n    workerPool[idx].postMessage('CLOSE');\n    delete workerPool[idx];\n  }\n}\n\nexport function lzmaDecompressor(response, meta, onSuccessEnd, onFailure) {\n  let freeWorkerIndex = -1;\n  let idx = 0;\n  const lzmaWorkerObj = find((worker)=> {\n    if (!worker) freeWorkerIndex = idx;\n    else idx++;\n    return !worker;\n  }, workerPool);\n  const numWorkers = workerPool.length;\n\n  if (workerQueue.length > 0 || (typeof Worker !== 'undefined' && Worker && numWorkers >= workerLimit && freeWorkerIndex === -1)) {\n    workerQueue.push({\n      buffer: response,\n      meta,\n    });\n  } else {\n    if (typeof Worker !== 'undefined' && Worker) {\n      const lzmaWorker = new Worker(URL.createObjectURL(workerBlob));\n      const index = freeWorkerIndex === -1 ? workerPool.length : freeWorkerIndex;\n      lzmaWorker.onmessage = function (event) {\n        if (event.data.type === 'SUCCESS') {\n          onSuccessEnd(event.data.buffer, event.data.meta);\n          requeueWorker(event.data.meta.idx);\n        } else {\n          onFailure(event.data.error, event.data.meta);\n        }\n      };\n\n      lzmaWorker.postMessage({\n        buffer: response,\n        meta: Object.assign({}, meta, { idx: index }),\n      });\n      workerPool[index] = lzmaWorker;\n    } else {\n      var inStream = {\n        data: new Uint8Array(response),\n        offset: 0,\n        readByte: function () {\n          return this.data[this.offset++];\n        },\n      };\n      var outStream = {\n        data: [],\n        offset: 0,\n        writeByte: function (val) {\n          this.data[this.offset++] = val;\n        },\n      };\n      try {\n        LZMA.decompressFile(inStream, outStream);\n        var uintGeomArray = new Uint8Array(outStream.data);\n        onSuccessEnd(\n          uintGeomArray.buffer,\n          meta,\n        );\n      } catch (e) {\n        onFailure(e);\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/utils/lzmaDecompressor.js","\n//From Repository: https://github.com/jcmellado/js-lzma\n/*\nCopyright (c) 2011 Juan Mellado\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n*/\n\n/*\nReferences:\n- \"LZMA SDK\" by Igor Pavlov\n  http://www.7-zip.org/sdk.html\n*/\n\nvar LZMA = LZMA || {};\n\nLZMA.OutWindow = function(){\n  this._windowSize = 0;\n};\n\nLZMA.OutWindow.prototype.create = function(windowSize){\n  if ( (!this._buffer) || (this._windowSize !== windowSize) ){\n    this._buffer = [];\n  }\n  this._windowSize = windowSize;\n  this._pos = 0;\n  this._streamPos = 0;\n};\n\nLZMA.OutWindow.prototype.flush = function(){\n  var size = this._pos - this._streamPos;\n  if (size !== 0){\n    while(size --){\n      this._stream.writeByte(this._buffer[this._streamPos ++]);\n    }\n    if (this._pos >= this._windowSize){\n      this._pos = 0;\n    }\n    this._streamPos = this._pos;\n  }\n};\n\nLZMA.OutWindow.prototype.releaseStream = function(){\n  this.flush();\n  this._stream = null;\n};\n\nLZMA.OutWindow.prototype.setStream = function(stream){\n  this.releaseStream();\n  this._stream = stream;\n};\n\nLZMA.OutWindow.prototype.init = function(solid){\n  if (!solid){\n    this._streamPos = 0;\n    this._pos = 0;\n  }\n};\n\nLZMA.OutWindow.prototype.copyBlock = function(distance, len){\n  var pos = this._pos - distance - 1;\n  if (pos < 0){\n    pos += this._windowSize;\n  }\n  while(len --){\n    if (pos >= this._windowSize){\n      pos = 0;\n    }\n    this._buffer[this._pos ++] = this._buffer[pos ++];\n    if (this._pos >= this._windowSize){\n      this.flush();\n    }\n  }\n};\n\nLZMA.OutWindow.prototype.putByte = function(b){\n  this._buffer[this._pos ++] = b;\n  if (this._pos >= this._windowSize){\n    this.flush();\n  }\n};\n\nLZMA.OutWindow.prototype.getByte = function(distance){\n  var pos = this._pos - distance - 1;\n  if (pos < 0){\n    pos += this._windowSize;\n  }\n  return this._buffer[pos];\n};\n\nLZMA.RangeDecoder = function(){\n};\n\nLZMA.RangeDecoder.prototype.setStream = function(stream){\n  this._stream = stream;\n};\n\nLZMA.RangeDecoder.prototype.releaseStream = function(){\n  this._stream = null;\n};\n\nLZMA.RangeDecoder.prototype.init = function(){\n  var i = 5;\n\n  this._code = 0;\n  this._range = -1;\n\n  while(i --){\n    this._code = (this._code << 8) | this._stream.readByte();\n  }\n};\n\nLZMA.RangeDecoder.prototype.decodeDirectBits = function(numTotalBits){\n  var result = 0, i = numTotalBits, t;\n\n  while(i --){\n    this._range >>>= 1;\n    t = (this._code - this._range) >>> 31;\n    this._code -= this._range & (t - 1);\n    result = (result << 1) | (1 - t);\n\n    if ( (this._range & 0xff000000) === 0){\n      this._code = (this._code << 8) | this._stream.readByte();\n      this._range <<= 8;\n    }\n  }\n\n  return result;\n};\n\nLZMA.RangeDecoder.prototype.decodeBit = function(probs, index){\n  var prob = probs[index],\n      newBound = (this._range >>> 11) * prob;\n\n  if ( (this._code ^ 0x80000000) < (newBound ^ 0x80000000) ){\n    this._range = newBound;\n    probs[index] += (2048 - prob) >>> 5;\n    if ( (this._range & 0xff000000) === 0){\n      this._code = (this._code << 8) | this._stream.readByte();\n      this._range <<= 8;\n    }\n    return 0;\n  }\n\n  this._range -= newBound;\n  this._code -= newBound;\n  probs[index] -= prob >>> 5;\n  if ( (this._range & 0xff000000) === 0){\n    this._code = (this._code << 8) | this._stream.readByte();\n    this._range <<= 8;\n  }\n  return 1;\n};\n\nLZMA.initBitModels = function(probs, len){\n  while(len --){\n    probs[len] = 1024;\n  }\n};\n\nLZMA.BitTreeDecoder = function(numBitLevels){\n  this._models = [];\n  this._numBitLevels = numBitLevels;\n};\n\nLZMA.BitTreeDecoder.prototype.init = function(){\n  LZMA.initBitModels(this._models, 1 << this._numBitLevels);\n};\n\nLZMA.BitTreeDecoder.prototype.decode = function(rangeDecoder){\n  var m = 1, i = this._numBitLevels;\n\n  while(i --){\n    m = (m << 1) | rangeDecoder.decodeBit(this._models, m);\n  }\n  return m - (1 << this._numBitLevels);\n};\n\nLZMA.BitTreeDecoder.prototype.reverseDecode = function(rangeDecoder){\n  var m = 1, symbol = 0, i = 0, bit;\n\n  for (; i < this._numBitLevels; ++ i){\n    bit = rangeDecoder.decodeBit(this._models, m);\n    m = (m << 1) | bit;\n    symbol |= bit << i;\n  }\n  return symbol;\n};\n\nLZMA.reverseDecode2 = function(models, startIndex, rangeDecoder, numBitLevels){\n  var m = 1, symbol = 0, i = 0, bit;\n\n  for (; i < numBitLevels; ++ i){\n    bit = rangeDecoder.decodeBit(models, startIndex + m);\n    m = (m << 1) | bit;\n    symbol |= bit << i;\n  }\n  return symbol;\n};\n\nLZMA.LenDecoder = function(){\n  this._choice = [];\n  this._lowCoder = [];\n  this._midCoder = [];\n  this._highCoder = new LZMA.BitTreeDecoder(8);\n  this._numPosStates = 0;\n};\n\nLZMA.LenDecoder.prototype.create = function(numPosStates){\n  for (; this._numPosStates < numPosStates; ++ this._numPosStates){\n    this._lowCoder[this._numPosStates] = new LZMA.BitTreeDecoder(3);\n    this._midCoder[this._numPosStates] = new LZMA.BitTreeDecoder(3);\n  }\n};\n\nLZMA.LenDecoder.prototype.init = function(){\n  var i = this._numPosStates;\n  LZMA.initBitModels(this._choice, 2);\n  while(i --){\n    this._lowCoder[i].init();\n    this._midCoder[i].init();\n  }\n  this._highCoder.init();\n};\n\nLZMA.LenDecoder.prototype.decode = function(rangeDecoder, posState){\n  if (rangeDecoder.decodeBit(this._choice, 0) === 0){\n    return this._lowCoder[posState].decode(rangeDecoder);\n  }\n  if (rangeDecoder.decodeBit(this._choice, 1) === 0){\n    return 8 + this._midCoder[posState].decode(rangeDecoder);\n  }\n  return 16 + this._highCoder.decode(rangeDecoder);\n};\n\nLZMA.Decoder2 = function(){\n  this._decoders = [];\n};\n\nLZMA.Decoder2.prototype.init = function(){\n  LZMA.initBitModels(this._decoders, 0x300);\n};\n\nLZMA.Decoder2.prototype.decodeNormal = function(rangeDecoder){\n  var symbol = 1;\n\n  do{\n    symbol = (symbol << 1) | rangeDecoder.decodeBit(this._decoders, symbol);\n  }while(symbol < 0x100);\n\n  return symbol & 0xff;\n};\n\nLZMA.Decoder2.prototype.decodeWithMatchByte = function(rangeDecoder, matchByte){\n  var symbol = 1, matchBit, bit;\n\n  do{\n    matchBit = (matchByte >> 7) & 1;\n    matchByte <<= 1;\n    bit = rangeDecoder.decodeBit(this._decoders, ( (1 + matchBit) << 8) + symbol);\n    symbol = (symbol << 1) | bit;\n    if (matchBit !== bit){\n      while(symbol < 0x100){\n        symbol = (symbol << 1) | rangeDecoder.decodeBit(this._decoders, symbol);\n      }\n      break;\n    }\n  }while(symbol < 0x100);\n\n  return symbol & 0xff;\n};\n\nLZMA.LiteralDecoder = function(){\n};\n\nLZMA.LiteralDecoder.prototype.create = function(numPosBits, numPrevBits){\n  var i;\n\n  if (this._coders\n    && (this._numPrevBits === numPrevBits)\n    && (this._numPosBits === numPosBits) ){\n    return;\n  }\n  this._numPosBits = numPosBits;\n  this._posMask = (1 << numPosBits) - 1;\n  this._numPrevBits = numPrevBits;\n\n  this._coders = [];\n\n  i = 1 << (this._numPrevBits + this._numPosBits);\n  while(i --){\n    this._coders[i] = new LZMA.Decoder2();\n  }\n};\n\nLZMA.LiteralDecoder.prototype.init = function(){\n  var i = 1 << (this._numPrevBits + this._numPosBits);\n  while(i --){\n    this._coders[i].init();\n  }\n};\n\nLZMA.LiteralDecoder.prototype.getDecoder = function(pos, prevByte){\n  return this._coders[( (pos & this._posMask) << this._numPrevBits)\n    + ( (prevByte & 0xff) >>> (8 - this._numPrevBits) )];\n};\n\nLZMA.Decoder = function(){\n  this._outWindow = new LZMA.OutWindow();\n  this._rangeDecoder = new LZMA.RangeDecoder();\n  this._isMatchDecoders = [];\n  this._isRepDecoders = [];\n  this._isRepG0Decoders = [];\n  this._isRepG1Decoders = [];\n  this._isRepG2Decoders = [];\n  this._isRep0LongDecoders = [];\n  this._posSlotDecoder = [];\n  this._posDecoders = [];\n  this._posAlignDecoder = new LZMA.BitTreeDecoder(4);\n  this._lenDecoder = new LZMA.LenDecoder();\n  this._repLenDecoder = new LZMA.LenDecoder();\n  this._literalDecoder = new LZMA.LiteralDecoder();\n  this._dictionarySize = -1;\n  this._dictionarySizeCheck = -1;\n\n  this._posSlotDecoder[0] = new LZMA.BitTreeDecoder(6);\n  this._posSlotDecoder[1] = new LZMA.BitTreeDecoder(6);\n  this._posSlotDecoder[2] = new LZMA.BitTreeDecoder(6);\n  this._posSlotDecoder[3] = new LZMA.BitTreeDecoder(6);\n};\n\nLZMA.Decoder.prototype.setDictionarySize = function(dictionarySize){\n  if (dictionarySize < 0){\n    return false;\n  }\n  if (this._dictionarySize !== dictionarySize){\n    this._dictionarySize = dictionarySize;\n    this._dictionarySizeCheck = Math.max(this._dictionarySize, 1);\n    this._outWindow.create( Math.max(this._dictionarySizeCheck, 4096) );\n  }\n  return true;\n};\n\nLZMA.Decoder.prototype.setLcLpPb = function(lc, lp, pb){\n  var numPosStates = 1 << pb;\n\n  if (lc > 8 || lp > 4 || pb > 4){\n    return false;\n  }\n\n  this._literalDecoder.create(lp, lc);\n\n  this._lenDecoder.create(numPosStates);\n  this._repLenDecoder.create(numPosStates);\n  this._posStateMask = numPosStates - 1;\n\n  return true;\n};\n\nLZMA.Decoder.prototype.init = function(){\n  var i = 4;\n\n  this._outWindow.init(false);\n\n  LZMA.initBitModels(this._isMatchDecoders, 192);\n  LZMA.initBitModels(this._isRep0LongDecoders, 192);\n  LZMA.initBitModels(this._isRepDecoders, 12);\n  LZMA.initBitModels(this._isRepG0Decoders, 12);\n  LZMA.initBitModels(this._isRepG1Decoders, 12);\n  LZMA.initBitModels(this._isRepG2Decoders, 12);\n  LZMA.initBitModels(this._posDecoders, 114);\n\n  this._literalDecoder.init();\n\n  while(i --){\n    this._posSlotDecoder[i].init();\n  }\n\n  this._lenDecoder.init();\n  this._repLenDecoder.init();\n  this._posAlignDecoder.init();\n  this._rangeDecoder.init();\n};\n\nLZMA.Decoder.prototype.decode = function(inStream, outStream, outSize){\n  var state = 0, rep0 = 0, rep1 = 0, rep2 = 0, rep3 = 0, nowPos64 = 0, prevByte = 0,\n      posState, decoder2, len, distance, posSlot, numDirectBits;\n\n  this._rangeDecoder.setStream(inStream);\n  this._outWindow.setStream(outStream);\n\n  this.init();\n\n  while(outSize < 0 || nowPos64 < outSize){\n    posState = nowPos64 & this._posStateMask;\n\n    if (this._rangeDecoder.decodeBit(this._isMatchDecoders, (state << 4) + posState) === 0){\n      decoder2 = this._literalDecoder.getDecoder(nowPos64 ++, prevByte);\n\n      if (state >= 7){\n        prevByte = decoder2.decodeWithMatchByte(this._rangeDecoder, this._outWindow.getByte(rep0) );\n      }else{\n        prevByte = decoder2.decodeNormal(this._rangeDecoder);\n      }\n      this._outWindow.putByte(prevByte);\n\n      state = state < 4? 0: state - (state < 10? 3: 6);\n\n    }else{\n\n      if (this._rangeDecoder.decodeBit(this._isRepDecoders, state) === 1){\n        len = 0;\n        if (this._rangeDecoder.decodeBit(this._isRepG0Decoders, state) === 0){\n          if (this._rangeDecoder.decodeBit(this._isRep0LongDecoders, (state << 4) + posState) === 0){\n            state = state < 7? 9: 11;\n            len = 1;\n          }\n        }else{\n          if (this._rangeDecoder.decodeBit(this._isRepG1Decoders, state) === 0){\n            distance = rep1;\n          }else{\n            if (this._rangeDecoder.decodeBit(this._isRepG2Decoders, state) === 0){\n              distance = rep2;\n            }else{\n              distance = rep3;\n              rep3 = rep2;\n            }\n            rep2 = rep1;\n          }\n          rep1 = rep0;\n          rep0 = distance;\n        }\n        if (len === 0){\n          len = 2 + this._repLenDecoder.decode(this._rangeDecoder, posState);\n          state = state < 7? 8: 11;\n        }\n      }else{\n        rep3 = rep2;\n        rep2 = rep1;\n        rep1 = rep0;\n\n        len = 2 + this._lenDecoder.decode(this._rangeDecoder, posState);\n        state = state < 7? 7: 10;\n\n        posSlot = this._posSlotDecoder[len <= 5? len - 2: 3].decode(this._rangeDecoder);\n        if (posSlot >= 4){\n\n          numDirectBits = (posSlot >> 1) - 1;\n          rep0 = (2 | (posSlot & 1) ) << numDirectBits;\n\n          if (posSlot < 14){\n            rep0 += LZMA.reverseDecode2(this._posDecoders,\n                rep0 - posSlot - 1, this._rangeDecoder, numDirectBits);\n          }else{\n            rep0 += this._rangeDecoder.decodeDirectBits(numDirectBits - 4) << 4;\n            rep0 += this._posAlignDecoder.reverseDecode(this._rangeDecoder);\n            if (rep0 < 0){\n              if (rep0 === -1){\n                break;\n              }\n              return false;\n            }\n          }\n        }else{\n          rep0 = posSlot;\n        }\n      }\n\n      if (rep0 >= nowPos64 || rep0 >= this._dictionarySizeCheck){\n        return false;\n      }\n\n      this._outWindow.copyBlock(rep0, len);\n      nowPos64 += len;\n      prevByte = this._outWindow.getByte(0);\n    }\n  }\n\n  this._outWindow.flush();\n  this._outWindow.releaseStream();\n  this._rangeDecoder.releaseStream();\n\n  return true;\n};\n\nLZMA.Decoder.prototype.setDecoderProperties = function(properties){\n  var value, lc, lp, pb, dictionarySize;\n\n  if (properties.size < 5){\n    return false;\n  }\n\n  value = properties.readByte();\n  lc = value % 9;\n  value = ~~(value / 9);\n  lp = value % 5;\n  pb = ~~(value / 5);\n\n  if ( !this.setLcLpPb(lc, lp, pb) ){\n    return false;\n  }\n\n  dictionarySize = properties.readByte();\n  dictionarySize |= properties.readByte() << 8;\n  dictionarySize |= properties.readByte() << 16;\n  dictionarySize += properties.readByte() * 16777216;\n\n  return this.setDictionarySize(dictionarySize);\n};\n\nLZMA.decompress = function(properties, inStream, outStream, outSize){\n  var decoder = new LZMA.Decoder();\n\n  if ( !decoder.setDecoderProperties(properties) ){\n    throw \"Incorrect stream properties\";\n  }\n\n  if ( !decoder.decode(inStream, outStream, outSize) ){\n    throw \"Error in data stream\";\n  }\n\n  return true;\n};\n\nLZMA.decompressFile = function(inStream, outStream){\n  var decoder = new LZMA.Decoder(), outSize;\n\n  if ( !decoder.setDecoderProperties(inStream) ){\n    throw \"Incorrect stream properties\";\n  }\n\n  outSize = inStream.readByte();\n  outSize |= inStream.readByte() << 8;\n  outSize |= inStream.readByte() << 16;\n  outSize += inStream.readByte() * 16777216;\n\n  inStream.readByte();\n  inStream.readByte();\n  inStream.readByte();\n  inStream.readByte();\n\n  if ( !decoder.decode(inStream, outStream, outSize) ){\n    throw \"Error in data stream\";\n  }\n\n  return true;\n};\n\nmodule.exports = LZMA;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./vendor/lzma.js\n// module id = 105\n// module chunks = 0 1 2","/*!\n * @overview RSVP - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2016 Yehuda Katz, Tom Dale, Stefan Penner and contributors\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/tildeio/rsvp.js/master/LICENSE\n * @version   3.3.3\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (factory((global.RSVP = global.RSVP || {})));\n}(this, (function (exports) { 'use strict';\n\nfunction indexOf(callbacks, callback) {\n  for (var i = 0, l = callbacks.length; i < l; i++) {\n    if (callbacks[i] === callback) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\nfunction callbacksFor(object) {\n  var callbacks = object._promiseCallbacks;\n\n  if (!callbacks) {\n    callbacks = object._promiseCallbacks = {};\n  }\n\n  return callbacks;\n}\n\n/**\n  @class RSVP.EventTarget\n*/\nvar EventTarget = {\n\n  /**\n    `RSVP.EventTarget.mixin` extends an object with EventTarget methods. For\n    Example:\n     ```javascript\n    let object = {};\n     RSVP.EventTarget.mixin(object);\n     object.on('finished', function(event) {\n      // handle event\n    });\n     object.trigger('finished', { detail: value });\n    ```\n     `EventTarget.mixin` also works with prototypes:\n     ```javascript\n    let Person = function() {};\n    RSVP.EventTarget.mixin(Person.prototype);\n     let yehuda = new Person();\n    let tom = new Person();\n     yehuda.on('poke', function(event) {\n      console.log('Yehuda says OW');\n    });\n     tom.on('poke', function(event) {\n      console.log('Tom says OW');\n    });\n     yehuda.trigger('poke');\n    tom.trigger('poke');\n    ```\n     @method mixin\n    @for RSVP.EventTarget\n    @private\n    @param {Object} object object to extend with EventTarget methods\n  */\n  mixin: function mixin(object) {\n    object['on'] = this['on'];\n    object['off'] = this['off'];\n    object['trigger'] = this['trigger'];\n    object._promiseCallbacks = undefined;\n    return object;\n  },\n\n  /**\n    Registers a callback to be executed when `eventName` is triggered\n     ```javascript\n    object.on('event', function(eventInfo){\n      // handle the event\n    });\n     object.trigger('event');\n    ```\n     @method on\n    @for RSVP.EventTarget\n    @private\n    @param {String} eventName name of the event to listen for\n    @param {Function} callback function to be called when the event is triggered.\n  */\n  on: function on(eventName, callback) {\n    if (typeof callback !== 'function') {\n      throw new TypeError('Callback must be a function');\n    }\n\n    var allCallbacks = callbacksFor(this),\n        callbacks = undefined;\n\n    callbacks = allCallbacks[eventName];\n\n    if (!callbacks) {\n      callbacks = allCallbacks[eventName] = [];\n    }\n\n    if (indexOf(callbacks, callback) === -1) {\n      callbacks.push(callback);\n    }\n  },\n\n  /**\n    You can use `off` to stop firing a particular callback for an event:\n     ```javascript\n    function doStuff() { // do stuff! }\n    object.on('stuff', doStuff);\n     object.trigger('stuff'); // doStuff will be called\n     // Unregister ONLY the doStuff callback\n    object.off('stuff', doStuff);\n    object.trigger('stuff'); // doStuff will NOT be called\n    ```\n     If you don't pass a `callback` argument to `off`, ALL callbacks for the\n    event will not be executed when the event fires. For example:\n     ```javascript\n    let callback1 = function(){};\n    let callback2 = function(){};\n     object.on('stuff', callback1);\n    object.on('stuff', callback2);\n     object.trigger('stuff'); // callback1 and callback2 will be executed.\n     object.off('stuff');\n    object.trigger('stuff'); // callback1 and callback2 will not be executed!\n    ```\n     @method off\n    @for RSVP.EventTarget\n    @private\n    @param {String} eventName event to stop listening to\n    @param {Function} callback optional argument. If given, only the function\n    given will be removed from the event's callback queue. If no `callback`\n    argument is given, all callbacks will be removed from the event's callback\n    queue.\n  */\n  off: function off(eventName, callback) {\n    var allCallbacks = callbacksFor(this),\n        callbacks = undefined,\n        index = undefined;\n\n    if (!callback) {\n      allCallbacks[eventName] = [];\n      return;\n    }\n\n    callbacks = allCallbacks[eventName];\n\n    index = indexOf(callbacks, callback);\n\n    if (index !== -1) {\n      callbacks.splice(index, 1);\n    }\n  },\n\n  /**\n    Use `trigger` to fire custom events. For example:\n     ```javascript\n    object.on('foo', function(){\n      console.log('foo event happened!');\n    });\n    object.trigger('foo');\n    // 'foo event happened!' logged to the console\n    ```\n     You can also pass a value as a second argument to `trigger` that will be\n    passed as an argument to all event listeners for the event:\n     ```javascript\n    object.on('foo', function(value){\n      console.log(value.name);\n    });\n     object.trigger('foo', { name: 'bar' });\n    // 'bar' logged to the console\n    ```\n     @method trigger\n    @for RSVP.EventTarget\n    @private\n    @param {String} eventName name of the event to be triggered\n    @param {*} options optional value to be passed to any event handlers for\n    the given `eventName`\n  */\n  trigger: function trigger(eventName, options, label) {\n    var allCallbacks = callbacksFor(this),\n        callbacks = undefined,\n        callback = undefined;\n\n    if (callbacks = allCallbacks[eventName]) {\n      // Don't cache the callbacks.length since it may grow\n      for (var i = 0; i < callbacks.length; i++) {\n        callback = callbacks[i];\n\n        callback(options, label);\n      }\n    }\n  }\n};\n\nvar config = {\n  instrument: false\n};\n\nEventTarget['mixin'](config);\n\nfunction configure(name, value) {\n  if (name === 'onerror') {\n    // handle for legacy users that expect the actual\n    // error to be passed to their function added via\n    // `RSVP.configure('onerror', someFunctionHere);`\n    config['on']('error', value);\n    return;\n  }\n\n  if (arguments.length === 2) {\n    config[name] = value;\n  } else {\n    return config[name];\n  }\n}\n\nfunction objectOrFunction(x) {\n  return typeof x === 'function' || typeof x === 'object' && x !== null;\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\nfunction isMaybeThenable(x) {\n  return typeof x === 'object' && x !== null;\n}\n\nvar _isArray = undefined;\nif (!Array.isArray) {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n} else {\n  _isArray = Array.isArray;\n}\n\nvar isArray = _isArray;\n\n// Date.now is not available in browsers < IE9\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/now#Compatibility\nvar now = Date.now || function () {\n  return new Date().getTime();\n};\n\nfunction F() {}\n\nvar o_create = Object.create || function (o) {\n  if (arguments.length > 1) {\n    throw new Error('Second argument not supported');\n  }\n  if (typeof o !== 'object') {\n    throw new TypeError('Argument must be an object');\n  }\n  F.prototype = o;\n  return new F();\n};\n\nvar queue = [];\n\nfunction scheduleFlush() {\n  setTimeout(function () {\n    for (var i = 0; i < queue.length; i++) {\n      var entry = queue[i];\n\n      var payload = entry.payload;\n\n      payload.guid = payload.key + payload.id;\n      payload.childGuid = payload.key + payload.childId;\n      if (payload.error) {\n        payload.stack = payload.error.stack;\n      }\n\n      config['trigger'](entry.name, entry.payload);\n    }\n    queue.length = 0;\n  }, 50);\n}\nfunction instrument(eventName, promise, child) {\n  if (1 === queue.push({\n    name: eventName,\n    payload: {\n      key: promise._guidKey,\n      id: promise._id,\n      eventName: eventName,\n      detail: promise._result,\n      childId: child && child._id,\n      label: promise._label,\n      timeStamp: now(),\n      error: config[\"instrument-with-stack\"] ? new Error(promise._label) : null\n    } })) {\n    scheduleFlush();\n  }\n}\n\n/**\n  `RSVP.Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new RSVP.Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = RSVP.Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {*} object value that the returned promise will be resolved with\n  @param {String} label optional string for identifying the returned promise.\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$1(object, label) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop, label);\n  resolve(promise, object);\n  return promise;\n}\n\nfunction withOwnPromise() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nvar GET_THEN_ERROR = new ErrorObject();\n\nfunction getThen(promise) {\n  try {\n    return promise.then;\n  } catch (error) {\n    GET_THEN_ERROR.error = error;\n    return GET_THEN_ERROR;\n  }\n}\n\nfunction tryThen(then, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then) {\n  config.async(function (promise) {\n    var sealed = false;\n    var error = tryThen(then, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value, undefined);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    thenable._onError = null;\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      if (thenable !== value) {\n        resolve(promise, value, undefined);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$) {\n  if (maybeThenable.constructor === promise.constructor && then$$ === then && promise.constructor.resolve === resolve$1) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$ === GET_THEN_ERROR) {\n      reject(promise, GET_THEN_ERROR.error);\n    } else if (then$$ === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$)) {\n      handleForeignThenable(promise, maybeThenable, then$$);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    fulfill(promise, value);\n  } else if (objectOrFunction(value)) {\n    handleMaybeThenable(promise, value, getThen(value));\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onError) {\n    promise._onError(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length === 0) {\n    if (config.instrument) {\n      instrument('fulfilled', promise);\n    }\n  } else {\n    config.async(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n  config.async(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var subscribers = parent._subscribers;\n  var length = subscribers.length;\n\n  parent._onError = null;\n\n  subscribers[length] = child;\n  subscribers[length + FULFILLED] = onFulfillment;\n  subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    config.async(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (config.instrument) {\n    instrument(settled === FULFILLED ? 'fulfilled' : 'rejected', promise);\n  }\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = undefined,\n      callback = undefined,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction ErrorObject() {\n  this.error = null;\n}\n\nvar TRY_CATCH_ERROR = new ErrorObject();\n\nfunction tryCatch(callback, detail) {\n  try {\n    return callback(detail);\n  } catch (e) {\n    TRY_CATCH_ERROR.error = e;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = undefined,\n      error = undefined,\n      succeeded = undefined,\n      failed = undefined;\n\n  if (hasCallback) {\n    value = tryCatch(callback, detail);\n\n    if (value === TRY_CATCH_ERROR) {\n      failed = true;\n      error = value.error;\n      value = null;\n    } else {\n      succeeded = true;\n    }\n\n    if (promise === value) {\n      reject(promise, withOwnPromise());\n      return;\n    }\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n      resolve(promise, value);\n    } else if (failed) {\n      reject(promise, error);\n    } else if (settled === FULFILLED) {\n      fulfill(promise, value);\n    } else if (settled === REJECTED) {\n      reject(promise, value);\n    }\n}\n\nfunction initializePromise(promise, resolver) {\n  var resolved = false;\n  try {\n    resolver(function (value) {\n      if (resolved) {\n        return;\n      }\n      resolved = true;\n      resolve(promise, value);\n    }, function (reason) {\n      if (resolved) {\n        return;\n      }\n      resolved = true;\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nfunction then(onFulfillment, onRejection, label) {\n  var _arguments = arguments;\n\n  var parent = this;\n  var state = parent._state;\n\n  if (state === FULFILLED && !onFulfillment || state === REJECTED && !onRejection) {\n    config.instrument && instrument('chained', parent, parent);\n    return parent;\n  }\n\n  parent._onError = null;\n\n  var child = new parent.constructor(noop, label);\n  var result = parent._result;\n\n  config.instrument && instrument('chained', parent, child);\n\n  if (state) {\n    (function () {\n      var callback = _arguments[state - 1];\n      config.async(function () {\n        return invokeCallback(state, child, callback, result);\n      });\n    })();\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\nfunction makeSettledResult(state, position, value) {\n  if (state === FULFILLED) {\n    return {\n      state: 'fulfilled',\n      value: value\n    };\n  } else {\n    return {\n      state: 'rejected',\n      reason: value\n    };\n  }\n}\n\nfunction Enumerator(Constructor, input, abortOnReject, label) {\n  this._instanceConstructor = Constructor;\n  this.promise = new Constructor(noop, label);\n  this._abortOnReject = abortOnReject;\n\n  if (this._validateInput(input)) {\n    this._input = input;\n    this.length = input.length;\n    this._remaining = input.length;\n\n    this._init();\n\n    if (this.length === 0) {\n      fulfill(this.promise, this._result);\n    } else {\n      this.length = this.length || 0;\n      this._enumerate();\n      if (this._remaining === 0) {\n        fulfill(this.promise, this._result);\n      }\n    }\n  } else {\n    reject(this.promise, this._validationError());\n  }\n}\n\nEnumerator.prototype._validateInput = function (input) {\n  return isArray(input);\n};\n\nEnumerator.prototype._validationError = function () {\n  return new Error('Array Methods must be provided an Array');\n};\n\nEnumerator.prototype._init = function () {\n  this._result = new Array(this.length);\n};\n\nEnumerator.prototype._enumerate = function () {\n  var length = this.length;\n  var promise = this.promise;\n  var input = this._input;\n\n  for (var i = 0; promise._state === PENDING && i < length; i++) {\n    this._eachEntry(input[i], i);\n  }\n};\n\nEnumerator.prototype._settleMaybeThenable = function (entry, i) {\n  var c = this._instanceConstructor;\n  var resolve = c.resolve;\n\n  if (resolve === resolve$1) {\n    var then$$ = getThen(entry);\n\n    if (then$$ === then && entry._state !== PENDING) {\n      entry._onError = null;\n      this._settledAt(entry._state, i, entry._result);\n    } else if (typeof then$$ !== 'function') {\n      this._remaining--;\n      this._result[i] = this._makeResult(FULFILLED, i, entry);\n    } else if (c === Promise) {\n      var promise = new c(noop);\n      handleMaybeThenable(promise, entry, then$$);\n      this._willSettleAt(promise, i);\n    } else {\n      this._willSettleAt(new c(function (resolve) {\n        return resolve(entry);\n      }), i);\n    }\n  } else {\n    this._willSettleAt(resolve(entry), i);\n  }\n};\n\nEnumerator.prototype._eachEntry = function (entry, i) {\n  if (isMaybeThenable(entry)) {\n    this._settleMaybeThenable(entry, i);\n  } else {\n    this._remaining--;\n    this._result[i] = this._makeResult(FULFILLED, i, entry);\n  }\n};\n\nEnumerator.prototype._settledAt = function (state, i, value) {\n  var promise = this.promise;\n\n  if (promise._state === PENDING) {\n    this._remaining--;\n\n    if (this._abortOnReject && state === REJECTED) {\n      reject(promise, value);\n    } else {\n      this._result[i] = this._makeResult(state, i, value);\n    }\n  }\n\n  if (this._remaining === 0) {\n    fulfill(promise, this._result);\n  }\n};\n\nEnumerator.prototype._makeResult = function (state, i, value) {\n  return value;\n};\n\nEnumerator.prototype._willSettleAt = function (promise, i) {\n  var enumerator = this;\n\n  subscribe(promise, undefined, function (value) {\n    return enumerator._settledAt(FULFILLED, i, value);\n  }, function (reason) {\n    return enumerator._settledAt(REJECTED, i, reason);\n  });\n};\n\n/**\n  `RSVP.Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = RSVP.resolve(1);\n  let promise2 = RSVP.resolve(2);\n  let promise3 = RSVP.resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  RSVP.Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `RSVP.all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = RSVP.resolve(1);\n  let promise2 = RSVP.reject(new Error(\"2\"));\n  let promise3 = RSVP.reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  RSVP.Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries, label) {\n  return new Enumerator(this, entries, true, /* abort on reject */label).promise;\n}\n\n/**\n  `RSVP.Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new RSVP.Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new RSVP.Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  RSVP.Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `RSVP.Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new RSVP.Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new RSVP.Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  RSVP.Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  RSVP.Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} entries array of promises to observe\n  @param {String} label optional string for describing the promise returned.\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries, label) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  var promise = new Constructor(noop, label);\n\n  if (!isArray(entries)) {\n    reject(promise, new TypeError('You must pass an array to race.'));\n    return promise;\n  }\n\n  for (var i = 0; promise._state === PENDING && i < entries.length; i++) {\n    subscribe(Constructor.resolve(entries[i]), undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n\n  return promise;\n}\n\n/**\n  `RSVP.Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new RSVP.Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = RSVP.Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {*} reason value that the returned promise will be rejected with.\n  @param {String} label optional string for identifying the returned promise.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$1(reason, label) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop, label);\n  reject(promise, reason);\n  return promise;\n}\n\nvar guidKey = 'rsvp_' + now() + '-';\nvar counter = 0;\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise’s eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class RSVP.Promise\n  @param {function} resolver\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @constructor\n*/\nfunction Promise(resolver, label) {\n  this._id = counter++;\n  this._label = label;\n  this._state = undefined;\n  this._result = undefined;\n  this._subscribers = [];\n\n  config.instrument && instrument('created', this);\n\n  if (noop !== resolver) {\n    typeof resolver !== 'function' && needsResolver();\n    this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n  }\n}\n\nPromise.cast = resolve$1; // deprecated\nPromise.all = all;\nPromise.race = race;\nPromise.resolve = resolve$1;\nPromise.reject = reject$1;\n\nPromise.prototype = {\n  constructor: Promise,\n\n  _guidKey: guidKey,\n\n  _onError: function _onError(reason) {\n    var promise = this;\n    config.after(function () {\n      if (promise._onError) {\n        config['trigger']('error', reason, promise._label);\n      }\n    });\n  },\n\n  /**\n    The primary way of interacting with a promise is through its `then` method,\n    which registers callbacks to receive either a promise's eventual value or the\n    reason why the promise cannot be fulfilled.\n  \n    ```js\n    findUser().then(function(user){\n      // user is available\n    }, function(reason){\n      // user is unavailable, and you are given the reason why\n    });\n    ```\n  \n    Chaining\n    --------\n  \n    The return value of `then` is itself a promise.  This second, 'downstream'\n    promise is resolved with the return value of the first promise's fulfillment\n    or rejection handler, or rejected if the handler throws an exception.\n  \n    ```js\n    findUser().then(function (user) {\n      return user.name;\n    }, function (reason) {\n      return 'default name';\n    }).then(function (userName) {\n      // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n      // will be `'default name'`\n    });\n  \n    findUser().then(function (user) {\n      throw new Error('Found user, but still unhappy');\n    }, function (reason) {\n      throw new Error('`findUser` rejected and we\\'re unhappy');\n    }).then(function (value) {\n      // never reached\n    }, function (reason) {\n      // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n      // If `findUser` rejected, `reason` will be '`findUser` rejected and we\\'re unhappy'.\n    });\n    ```\n    If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n  \n    ```js\n    findUser().then(function (user) {\n      throw new PedagogicalException('Upstream error');\n    }).then(function (value) {\n      // never reached\n    }).then(function (value) {\n      // never reached\n    }, function (reason) {\n      // The `PedgagocialException` is propagated all the way down to here\n    });\n    ```\n  \n    Assimilation\n    ------------\n  \n    Sometimes the value you want to propagate to a downstream promise can only be\n    retrieved asynchronously. This can be achieved by returning a promise in the\n    fulfillment or rejection handler. The downstream promise will then be pending\n    until the returned promise is settled. This is called *assimilation*.\n  \n    ```js\n    findUser().then(function (user) {\n      return findCommentsByAuthor(user);\n    }).then(function (comments) {\n      // The user's comments are now available\n    });\n    ```\n  \n    If the assimliated promise rejects, then the downstream promise will also reject.\n  \n    ```js\n    findUser().then(function (user) {\n      return findCommentsByAuthor(user);\n    }).then(function (comments) {\n      // If `findCommentsByAuthor` fulfills, we'll have the value here\n    }, function (reason) {\n      // If `findCommentsByAuthor` rejects, we'll have the reason here\n    });\n    ```\n  \n    Simple Example\n    --------------\n  \n    Synchronous Example\n  \n    ```javascript\n    let result;\n  \n    try {\n      result = findResult();\n      // success\n    } catch(reason) {\n      // failure\n    }\n    ```\n  \n    Errback Example\n  \n    ```js\n    findResult(function(result, err){\n      if (err) {\n        // failure\n      } else {\n        // success\n      }\n    });\n    ```\n  \n    Promise Example;\n  \n    ```javascript\n    findResult().then(function(result){\n      // success\n    }, function(reason){\n      // failure\n    });\n    ```\n  \n    Advanced Example\n    --------------\n  \n    Synchronous Example\n  \n    ```javascript\n    let author, books;\n  \n    try {\n      author = findAuthor();\n      books  = findBooksByAuthor(author);\n      // success\n    } catch(reason) {\n      // failure\n    }\n    ```\n  \n    Errback Example\n  \n    ```js\n  \n    function foundBooks(books) {\n  \n    }\n  \n    function failure(reason) {\n  \n    }\n  \n    findAuthor(function(author, err){\n      if (err) {\n        failure(err);\n        // failure\n      } else {\n        try {\n          findBoooksByAuthor(author, function(books, err) {\n            if (err) {\n              failure(err);\n            } else {\n              try {\n                foundBooks(books);\n              } catch(reason) {\n                failure(reason);\n              }\n            }\n          });\n        } catch(error) {\n          failure(err);\n        }\n        // success\n      }\n    });\n    ```\n  \n    Promise Example;\n  \n    ```javascript\n    findAuthor().\n      then(findBooksByAuthor).\n      then(function(books){\n        // found books\n    }).catch(function(reason){\n      // something went wrong\n    });\n    ```\n  \n    @method then\n    @param {Function} onFulfillment\n    @param {Function} onRejection\n    @param {String} label optional string for labeling the promise.\n    Useful for tooling.\n    @return {Promise}\n  */\n  then: then,\n\n  /**\n    `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n    as the catch block of a try/catch statement.\n  \n    ```js\n    function findAuthor(){\n      throw new Error('couldn\\'t find that author');\n    }\n  \n    // synchronous\n    try {\n      findAuthor();\n    } catch(reason) {\n      // something went wrong\n    }\n  \n    // async with promises\n    findAuthor().catch(function(reason){\n      // something went wrong\n    });\n    ```\n  \n    @method catch\n    @param {Function} onRejection\n    @param {String} label optional string for labeling the promise.\n    Useful for tooling.\n    @return {Promise}\n  */\n  'catch': function _catch(onRejection, label) {\n    return this.then(undefined, onRejection, label);\n  },\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @param {String} label optional string for labeling the promise.\n    Useful for tooling.\n    @return {Promise}\n  */\n  'finally': function _finally(callback, label) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    return promise.then(function (value) {\n      return constructor.resolve(callback()).then(function () {\n        return value;\n      });\n    }, function (reason) {\n      return constructor.resolve(callback()).then(function () {\n        throw reason;\n      });\n    }, label);\n  }\n};\n\nfunction Result() {\n  this.value = undefined;\n}\n\nvar ERROR = new Result();\nvar GET_THEN_ERROR$1 = new Result();\n\nfunction getThen$1(obj) {\n  try {\n    return obj.then;\n  } catch (error) {\n    ERROR.value = error;\n    return ERROR;\n  }\n}\n\nfunction tryApply(f, s, a) {\n  try {\n    f.apply(s, a);\n  } catch (error) {\n    ERROR.value = error;\n    return ERROR;\n  }\n}\n\nfunction makeObject(_, argumentNames) {\n  var obj = {};\n  var length = _.length;\n  var args = new Array(length);\n\n  for (var x = 0; x < length; x++) {\n    args[x] = _[x];\n  }\n\n  for (var i = 0; i < argumentNames.length; i++) {\n    var _name = argumentNames[i];\n    obj[_name] = args[i + 1];\n  }\n\n  return obj;\n}\n\nfunction arrayResult(_) {\n  var length = _.length;\n  var args = new Array(length - 1);\n\n  for (var i = 1; i < length; i++) {\n    args[i - 1] = _[i];\n  }\n\n  return args;\n}\n\nfunction wrapThenable(_then, promise) {\n  return {\n    then: function then(onFulFillment, onRejection) {\n      return _then.call(promise, onFulFillment, onRejection);\n    }\n  };\n}\n\n/**\n  `RSVP.denodeify` takes a 'node-style' function and returns a function that\n  will return an `RSVP.Promise`. You can use `denodeify` in Node.js or the\n  browser when you'd prefer to use promises over using callbacks. For example,\n  `denodeify` transforms the following:\n\n  ```javascript\n  let fs = require('fs');\n\n  fs.readFile('myfile.txt', function(err, data){\n    if (err) return handleError(err);\n    handleData(data);\n  });\n  ```\n\n  into:\n\n  ```javascript\n  let fs = require('fs');\n  let readFile = RSVP.denodeify(fs.readFile);\n\n  readFile('myfile.txt').then(handleData, handleError);\n  ```\n\n  If the node function has multiple success parameters, then `denodeify`\n  just returns the first one:\n\n  ```javascript\n  let request = RSVP.denodeify(require('request'));\n\n  request('http://example.com').then(function(res) {\n    // ...\n  });\n  ```\n\n  However, if you need all success parameters, setting `denodeify`'s\n  second parameter to `true` causes it to return all success parameters\n  as an array:\n\n  ```javascript\n  let request = RSVP.denodeify(require('request'), true);\n\n  request('http://example.com').then(function(result) {\n    // result[0] -> res\n    // result[1] -> body\n  });\n  ```\n\n  Or if you pass it an array with names it returns the parameters as a hash:\n\n  ```javascript\n  let request = RSVP.denodeify(require('request'), ['res', 'body']);\n\n  request('http://example.com').then(function(result) {\n    // result.res\n    // result.body\n  });\n  ```\n\n  Sometimes you need to retain the `this`:\n\n  ```javascript\n  let app = require('express')();\n  let render = RSVP.denodeify(app.render.bind(app));\n  ```\n\n  The denodified function inherits from the original function. It works in all\n  environments, except IE 10 and below. Consequently all properties of the original\n  function are available to you. However, any properties you change on the\n  denodeified function won't be changed on the original function. Example:\n\n  ```javascript\n  let request = RSVP.denodeify(require('request')),\n      cookieJar = request.jar(); // <- Inheritance is used here\n\n  request('http://example.com', {jar: cookieJar}).then(function(res) {\n    // cookieJar.cookies holds now the cookies returned by example.com\n  });\n  ```\n\n  Using `denodeify` makes it easier to compose asynchronous operations instead\n  of using callbacks. For example, instead of:\n\n  ```javascript\n  let fs = require('fs');\n\n  fs.readFile('myfile.txt', function(err, data){\n    if (err) { ... } // Handle error\n    fs.writeFile('myfile2.txt', data, function(err){\n      if (err) { ... } // Handle error\n      console.log('done')\n    });\n  });\n  ```\n\n  you can chain the operations together using `then` from the returned promise:\n\n  ```javascript\n  let fs = require('fs');\n  let readFile = RSVP.denodeify(fs.readFile);\n  let writeFile = RSVP.denodeify(fs.writeFile);\n\n  readFile('myfile.txt').then(function(data){\n    return writeFile('myfile2.txt', data);\n  }).then(function(){\n    console.log('done')\n  }).catch(function(error){\n    // Handle error\n  });\n  ```\n\n  @method denodeify\n  @static\n  @for RSVP\n  @param {Function} nodeFunc a 'node-style' function that takes a callback as\n  its last argument. The callback expects an error to be passed as its first\n  argument (if an error occurred, otherwise null), and the value from the\n  operation as its second argument ('function(err, value){ }').\n  @param {Boolean|Array} [options] An optional paramter that if set\n  to `true` causes the promise to fulfill with the callback's success arguments\n  as an array. This is useful if the node function has multiple success\n  paramters. If you set this paramter to an array with names, the promise will\n  fulfill with a hash with these names as keys and the success parameters as\n  values.\n  @return {Function} a function that wraps `nodeFunc` to return an\n  `RSVP.Promise`\n  @static\n*/\nfunction denodeify(nodeFunc, options) {\n  var fn = function fn() {\n    var self = this;\n    var l = arguments.length;\n    var args = new Array(l + 1);\n    var promiseInput = false;\n\n    for (var i = 0; i < l; ++i) {\n      var arg = arguments[i];\n\n      if (!promiseInput) {\n        // TODO: clean this up\n        promiseInput = needsPromiseInput(arg);\n        if (promiseInput === GET_THEN_ERROR$1) {\n          var p = new Promise(noop);\n          reject(p, GET_THEN_ERROR$1.value);\n          return p;\n        } else if (promiseInput && promiseInput !== true) {\n          arg = wrapThenable(promiseInput, arg);\n        }\n      }\n      args[i] = arg;\n    }\n\n    var promise = new Promise(noop);\n\n    args[l] = function (err, val) {\n      if (err) reject(promise, err);else if (options === undefined) resolve(promise, val);else if (options === true) resolve(promise, arrayResult(arguments));else if (isArray(options)) resolve(promise, makeObject(arguments, options));else resolve(promise, val);\n    };\n\n    if (promiseInput) {\n      return handlePromiseInput(promise, args, nodeFunc, self);\n    } else {\n      return handleValueInput(promise, args, nodeFunc, self);\n    }\n  };\n\n  fn.__proto__ = nodeFunc;\n\n  return fn;\n}\n\nfunction handleValueInput(promise, args, nodeFunc, self) {\n  var result = tryApply(nodeFunc, self, args);\n  if (result === ERROR) {\n    reject(promise, result.value);\n  }\n  return promise;\n}\n\nfunction handlePromiseInput(promise, args, nodeFunc, self) {\n  return Promise.all(args).then(function (args) {\n    var result = tryApply(nodeFunc, self, args);\n    if (result === ERROR) {\n      reject(promise, result.value);\n    }\n    return promise;\n  });\n}\n\nfunction needsPromiseInput(arg) {\n  if (arg && typeof arg === 'object') {\n    if (arg.constructor === Promise) {\n      return true;\n    } else {\n      return getThen$1(arg);\n    }\n  } else {\n    return false;\n  }\n}\n\n/**\n  This is a convenient alias for `RSVP.Promise.all`.\n\n  @method all\n  @static\n  @for RSVP\n  @param {Array} array Array of promises.\n  @param {String} label An optional label. This is useful\n  for tooling.\n*/\nfunction all$1(array, label) {\n  return Promise.all(array, label);\n}\n\nfunction AllSettled(Constructor, entries, label) {\n  this._superConstructor(Constructor, entries, false, /* don't abort on reject */label);\n}\n\nAllSettled.prototype = o_create(Enumerator.prototype);\nAllSettled.prototype._superConstructor = Enumerator;\nAllSettled.prototype._makeResult = makeSettledResult;\nAllSettled.prototype._validationError = function () {\n  return new Error('allSettled must be called with an array');\n};\n\n/**\n  `RSVP.allSettled` is similar to `RSVP.all`, but instead of implementing\n  a fail-fast method, it waits until all the promises have returned and\n  shows you all the results. This is useful if you want to handle multiple\n  promises' failure states together as a set.\n\n  Returns a promise that is fulfilled when all the given promises have been\n  settled. The return promise is fulfilled with an array of the states of\n  the promises passed into the `promises` array argument.\n\n  Each state object will either indicate fulfillment or rejection, and\n  provide the corresponding value or reason. The states will take one of\n  the following formats:\n\n  ```javascript\n  { state: 'fulfilled', value: value }\n    or\n  { state: 'rejected', reason: reason }\n  ```\n\n  Example:\n\n  ```javascript\n  let promise1 = RSVP.Promise.resolve(1);\n  let promise2 = RSVP.Promise.reject(new Error('2'));\n  let promise3 = RSVP.Promise.reject(new Error('3'));\n  let promises = [ promise1, promise2, promise3 ];\n\n  RSVP.allSettled(promises).then(function(array){\n    // array == [\n    //   { state: 'fulfilled', value: 1 },\n    //   { state: 'rejected', reason: Error },\n    //   { state: 'rejected', reason: Error }\n    // ]\n    // Note that for the second item, reason.message will be '2', and for the\n    // third item, reason.message will be '3'.\n  }, function(error) {\n    // Not run. (This block would only be called if allSettled had failed,\n    // for instance if passed an incorrect argument type.)\n  });\n  ```\n\n  @method allSettled\n  @static\n  @for RSVP\n  @param {Array} entries\n  @param {String} label - optional string that describes the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled with an array of the settled\n  states of the constituent promises.\n*/\nfunction allSettled(entries, label) {\n  return new AllSettled(Promise, entries, label).promise;\n}\n\n/**\n  This is a convenient alias for `RSVP.Promise.race`.\n\n  @method race\n  @static\n  @for RSVP\n  @param {Array} array Array of promises.\n  @param {String} label An optional label. This is useful\n  for tooling.\n */\nfunction race$1(array, label) {\n  return Promise.race(array, label);\n}\n\nfunction PromiseHash(Constructor, object, label) {\n  this._superConstructor(Constructor, object, true, label);\n}\n\nPromiseHash.prototype = o_create(Enumerator.prototype);\nPromiseHash.prototype._superConstructor = Enumerator;\nPromiseHash.prototype._init = function () {\n  this._result = {};\n};\n\nPromiseHash.prototype._validateInput = function (input) {\n  return input && typeof input === 'object';\n};\n\nPromiseHash.prototype._validationError = function () {\n  return new Error('Promise.hash must be called with an object');\n};\n\nPromiseHash.prototype._enumerate = function () {\n  var enumerator = this;\n  var promise = enumerator.promise;\n  var input = enumerator._input;\n  var results = [];\n\n  for (var key in input) {\n    if (promise._state === PENDING && Object.prototype.hasOwnProperty.call(input, key)) {\n      results.push({\n        position: key,\n        entry: input[key]\n      });\n    }\n  }\n\n  var length = results.length;\n  enumerator._remaining = length;\n  var result = undefined;\n\n  for (var i = 0; promise._state === PENDING && i < length; i++) {\n    result = results[i];\n    enumerator._eachEntry(result.entry, result.position);\n  }\n};\n\n/**\n  `RSVP.hash` is similar to `RSVP.all`, but takes an object instead of an array\n  for its `promises` argument.\n\n  Returns a promise that is fulfilled when all the given promises have been\n  fulfilled, or rejected if any of them become rejected. The returned promise\n  is fulfilled with a hash that has the same key names as the `promises` object\n  argument. If any of the values in the object are not promises, they will\n  simply be copied over to the fulfilled object.\n\n  Example:\n\n  ```javascript\n  let promises = {\n    myPromise: RSVP.resolve(1),\n    yourPromise: RSVP.resolve(2),\n    theirPromise: RSVP.resolve(3),\n    notAPromise: 4\n  };\n\n  RSVP.hash(promises).then(function(hash){\n    // hash here is an object that looks like:\n    // {\n    //   myPromise: 1,\n    //   yourPromise: 2,\n    //   theirPromise: 3,\n    //   notAPromise: 4\n    // }\n  });\n  ````\n\n  If any of the `promises` given to `RSVP.hash` are rejected, the first promise\n  that is rejected will be given as the reason to the rejection handler.\n\n  Example:\n\n  ```javascript\n  let promises = {\n    myPromise: RSVP.resolve(1),\n    rejectedPromise: RSVP.reject(new Error('rejectedPromise')),\n    anotherRejectedPromise: RSVP.reject(new Error('anotherRejectedPromise')),\n  };\n\n  RSVP.hash(promises).then(function(hash){\n    // Code here never runs because there are rejected promises!\n  }, function(reason) {\n    // reason.message === 'rejectedPromise'\n  });\n  ```\n\n  An important note: `RSVP.hash` is intended for plain JavaScript objects that\n  are just a set of keys and values. `RSVP.hash` will NOT preserve prototype\n  chains.\n\n  Example:\n\n  ```javascript\n  function MyConstructor(){\n    this.example = RSVP.resolve('Example');\n  }\n\n  MyConstructor.prototype = {\n    protoProperty: RSVP.resolve('Proto Property')\n  };\n\n  let myObject = new MyConstructor();\n\n  RSVP.hash(myObject).then(function(hash){\n    // protoProperty will not be present, instead you will just have an\n    // object that looks like:\n    // {\n    //   example: 'Example'\n    // }\n    //\n    // hash.hasOwnProperty('protoProperty'); // false\n    // 'undefined' === typeof hash.protoProperty\n  });\n  ```\n\n  @method hash\n  @static\n  @for RSVP\n  @param {Object} object\n  @param {String} label optional string that describes the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all properties of `promises`\n  have been fulfilled, or rejected if any of them become rejected.\n*/\nfunction hash(object, label) {\n  return new PromiseHash(Promise, object, label).promise;\n}\n\nfunction HashSettled(Constructor, object, label) {\n  this._superConstructor(Constructor, object, false, label);\n}\n\nHashSettled.prototype = o_create(PromiseHash.prototype);\nHashSettled.prototype._superConstructor = Enumerator;\nHashSettled.prototype._makeResult = makeSettledResult;\n\nHashSettled.prototype._validationError = function () {\n  return new Error('hashSettled must be called with an object');\n};\n\n/**\n  `RSVP.hashSettled` is similar to `RSVP.allSettled`, but takes an object\n  instead of an array for its `promises` argument.\n\n  Unlike `RSVP.all` or `RSVP.hash`, which implement a fail-fast method,\n  but like `RSVP.allSettled`, `hashSettled` waits until all the\n  constituent promises have returned and then shows you all the results\n  with their states and values/reasons. This is useful if you want to\n  handle multiple promises' failure states together as a set.\n\n  Returns a promise that is fulfilled when all the given promises have been\n  settled, or rejected if the passed parameters are invalid.\n\n  The returned promise is fulfilled with a hash that has the same key names as\n  the `promises` object argument. If any of the values in the object are not\n  promises, they will be copied over to the fulfilled object and marked with state\n  'fulfilled'.\n\n  Example:\n\n  ```javascript\n  let promises = {\n    myPromise: RSVP.Promise.resolve(1),\n    yourPromise: RSVP.Promise.resolve(2),\n    theirPromise: RSVP.Promise.resolve(3),\n    notAPromise: 4\n  };\n\n  RSVP.hashSettled(promises).then(function(hash){\n    // hash here is an object that looks like:\n    // {\n    //   myPromise: { state: 'fulfilled', value: 1 },\n    //   yourPromise: { state: 'fulfilled', value: 2 },\n    //   theirPromise: { state: 'fulfilled', value: 3 },\n    //   notAPromise: { state: 'fulfilled', value: 4 }\n    // }\n  });\n  ```\n\n  If any of the `promises` given to `RSVP.hash` are rejected, the state will\n  be set to 'rejected' and the reason for rejection provided.\n\n  Example:\n\n  ```javascript\n  let promises = {\n    myPromise: RSVP.Promise.resolve(1),\n    rejectedPromise: RSVP.Promise.reject(new Error('rejection')),\n    anotherRejectedPromise: RSVP.Promise.reject(new Error('more rejection')),\n  };\n\n  RSVP.hashSettled(promises).then(function(hash){\n    // hash here is an object that looks like:\n    // {\n    //   myPromise:              { state: 'fulfilled', value: 1 },\n    //   rejectedPromise:        { state: 'rejected', reason: Error },\n    //   anotherRejectedPromise: { state: 'rejected', reason: Error },\n    // }\n    // Note that for rejectedPromise, reason.message == 'rejection',\n    // and for anotherRejectedPromise, reason.message == 'more rejection'.\n  });\n  ```\n\n  An important note: `RSVP.hashSettled` is intended for plain JavaScript objects that\n  are just a set of keys and values. `RSVP.hashSettled` will NOT preserve prototype\n  chains.\n\n  Example:\n\n  ```javascript\n  function MyConstructor(){\n    this.example = RSVP.Promise.resolve('Example');\n  }\n\n  MyConstructor.prototype = {\n    protoProperty: RSVP.Promise.resolve('Proto Property')\n  };\n\n  let myObject = new MyConstructor();\n\n  RSVP.hashSettled(myObject).then(function(hash){\n    // protoProperty will not be present, instead you will just have an\n    // object that looks like:\n    // {\n    //   example: { state: 'fulfilled', value: 'Example' }\n    // }\n    //\n    // hash.hasOwnProperty('protoProperty'); // false\n    // 'undefined' === typeof hash.protoProperty\n  });\n  ```\n\n  @method hashSettled\n  @for RSVP\n  @param {Object} object\n  @param {String} label optional string that describes the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when when all properties of `promises`\n  have been settled.\n  @static\n*/\nfunction hashSettled(object, label) {\n  return new HashSettled(Promise, object, label).promise;\n}\n\nfunction rethrow(reason) {\n  setTimeout(function () {\n    throw reason;\n  });\n  throw reason;\n}\n\n/**\n  `RSVP.defer` returns an object similar to jQuery's `$.Deferred`.\n  `RSVP.defer` should be used when porting over code reliant on `$.Deferred`'s\n  interface. New code should use the `RSVP.Promise` constructor instead.\n\n  The object returned from `RSVP.defer` is a plain object with three properties:\n\n  * promise - an `RSVP.Promise`.\n  * reject - a function that causes the `promise` property on this object to\n    become rejected\n  * resolve - a function that causes the `promise` property on this object to\n    become fulfilled.\n\n  Example:\n\n   ```javascript\n   let deferred = RSVP.defer();\n\n   deferred.resolve(\"Success!\");\n\n   deferred.promise.then(function(value){\n     // value here is \"Success!\"\n   });\n   ```\n\n  @method defer\n  @static\n  @for RSVP\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Object}\n */\nfunction defer(label) {\n  var deferred = { resolve: undefined, reject: undefined };\n\n  deferred.promise = new Promise(function (resolve, reject) {\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  }, label);\n\n  return deferred;\n}\n\n/**\n `RSVP.map` is similar to JavaScript's native `map` method, except that it\n  waits for all promises to become fulfilled before running the `mapFn` on\n  each item in given to `promises`. `RSVP.map` returns a promise that will\n  become fulfilled with the result of running `mapFn` on the values the promises\n  become fulfilled with.\n\n  For example:\n\n  ```javascript\n\n  let promise1 = RSVP.resolve(1);\n  let promise2 = RSVP.resolve(2);\n  let promise3 = RSVP.resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  let mapFn = function(item){\n    return item + 1;\n  };\n\n  RSVP.map(promises, mapFn).then(function(result){\n    // result is [ 2, 3, 4 ]\n  });\n  ```\n\n  If any of the `promises` given to `RSVP.map` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promise's\n  rejection handler. For example:\n\n  ```javascript\n  let promise1 = RSVP.resolve(1);\n  let promise2 = RSVP.reject(new Error('2'));\n  let promise3 = RSVP.reject(new Error('3'));\n  let promises = [ promise1, promise2, promise3 ];\n\n  let mapFn = function(item){\n    return item + 1;\n  };\n\n  RSVP.map(promises, mapFn).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(reason) {\n    // reason.message === '2'\n  });\n  ```\n\n  `RSVP.map` will also wait if a promise is returned from `mapFn`. For example,\n  say you want to get all comments from a set of blog posts, but you need\n  the blog posts first because they contain a url to those comments.\n\n  ```javscript\n\n  let mapFn = function(blogPost){\n    // getComments does some ajax and returns an RSVP.Promise that is fulfilled\n    // with some comments data\n    return getComments(blogPost.comments_url);\n  };\n\n  // getBlogPosts does some ajax and returns an RSVP.Promise that is fulfilled\n  // with some blog post data\n  RSVP.map(getBlogPosts(), mapFn).then(function(comments){\n    // comments is the result of asking the server for the comments\n    // of all blog posts returned from getBlogPosts()\n  });\n  ```\n\n  @method map\n  @static\n  @for RSVP\n  @param {Array} promises\n  @param {Function} mapFn function to be called on each fulfilled promise.\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled with the result of calling\n  `mapFn` on each fulfilled promise or value when they become fulfilled.\n   The promise will be rejected if any of the given `promises` become rejected.\n  @static\n*/\nfunction map(promises, mapFn, label) {\n  return Promise.all(promises, label).then(function (values) {\n    if (!isFunction(mapFn)) {\n      throw new TypeError(\"You must pass a function as map's second argument.\");\n    }\n\n    var length = values.length;\n    var results = new Array(length);\n\n    for (var i = 0; i < length; i++) {\n      results[i] = mapFn(values[i]);\n    }\n\n    return Promise.all(results, label);\n  });\n}\n\n/**\n  This is a convenient alias for `RSVP.Promise.resolve`.\n\n  @method resolve\n  @static\n  @for RSVP\n  @param {*} value value that the returned promise will be resolved with\n  @param {String} label optional string for identifying the returned promise.\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$2(value, label) {\n  return Promise.resolve(value, label);\n}\n\n/**\n  This is a convenient alias for `RSVP.Promise.reject`.\n\n  @method reject\n  @static\n  @for RSVP\n  @param {*} reason value that the returned promise will be rejected with.\n  @param {String} label optional string for identifying the returned promise.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$2(reason, label) {\n  return Promise.reject(reason, label);\n}\n\n/**\n `RSVP.filter` is similar to JavaScript's native `filter` method, except that it\n  waits for all promises to become fulfilled before running the `filterFn` on\n  each item in given to `promises`. `RSVP.filter` returns a promise that will\n  become fulfilled with the result of running `filterFn` on the values the\n  promises become fulfilled with.\n\n  For example:\n\n  ```javascript\n\n  let promise1 = RSVP.resolve(1);\n  let promise2 = RSVP.resolve(2);\n  let promise3 = RSVP.resolve(3);\n\n  let promises = [promise1, promise2, promise3];\n\n  let filterFn = function(item){\n    return item > 1;\n  };\n\n  RSVP.filter(promises, filterFn).then(function(result){\n    // result is [ 2, 3 ]\n  });\n  ```\n\n  If any of the `promises` given to `RSVP.filter` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promise's\n  rejection handler. For example:\n\n  ```javascript\n  let promise1 = RSVP.resolve(1);\n  let promise2 = RSVP.reject(new Error('2'));\n  let promise3 = RSVP.reject(new Error('3'));\n  let promises = [ promise1, promise2, promise3 ];\n\n  let filterFn = function(item){\n    return item > 1;\n  };\n\n  RSVP.filter(promises, filterFn).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(reason) {\n    // reason.message === '2'\n  });\n  ```\n\n  `RSVP.filter` will also wait for any promises returned from `filterFn`.\n  For instance, you may want to fetch a list of users then return a subset\n  of those users based on some asynchronous operation:\n\n  ```javascript\n\n  let alice = { name: 'alice' };\n  let bob   = { name: 'bob' };\n  let users = [ alice, bob ];\n\n  let promises = users.map(function(user){\n    return RSVP.resolve(user);\n  });\n\n  let filterFn = function(user){\n    // Here, Alice has permissions to create a blog post, but Bob does not.\n    return getPrivilegesForUser(user).then(function(privs){\n      return privs.can_create_blog_post === true;\n    });\n  };\n  RSVP.filter(promises, filterFn).then(function(users){\n    // true, because the server told us only Alice can create a blog post.\n    users.length === 1;\n    // false, because Alice is the only user present in `users`\n    users[0] === bob;\n  });\n  ```\n\n  @method filter\n  @static\n  @for RSVP\n  @param {Array} promises\n  @param {Function} filterFn - function to be called on each resolved value to\n  filter the final results.\n  @param {String} label optional string describing the promise. Useful for\n  tooling.\n  @return {Promise}\n*/\n\nfunction resolveAll(promises, label) {\n  return Promise.all(promises, label);\n}\n\nfunction resolveSingle(promise, label) {\n  return Promise.resolve(promise, label).then(function (promises) {\n    return resolveAll(promises, label);\n  });\n}\nfunction filter(promises, filterFn, label) {\n  var promise = isArray(promises) ? resolveAll(promises, label) : resolveSingle(promises, label);\n  return promise.then(function (values) {\n    if (!isFunction(filterFn)) {\n      throw new TypeError(\"You must pass a function as filter's second argument.\");\n    }\n\n    var length = values.length;\n    var filtered = new Array(length);\n\n    for (var i = 0; i < length; i++) {\n      filtered[i] = filterFn(values[i]);\n    }\n\n    return resolveAll(filtered, label).then(function (filtered) {\n      var results = new Array(length);\n      var newLength = 0;\n\n      for (var i = 0; i < length; i++) {\n        if (filtered[i]) {\n          results[newLength] = values[i];\n          newLength++;\n        }\n      }\n\n      results.length = newLength;\n\n      return results;\n    });\n  });\n}\n\nvar len = 0;\nvar vertxNext = undefined;\nfunction asap(callback, arg) {\n  queue$1[len] = callback;\n  queue$1[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 1, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    scheduleFlush$1();\n  }\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && ({}).toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  var nextTick = process.nextTick;\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // setImmediate should be used instead instead\n  var version = process.versions.node.match(/^(?:(\\d+)\\.)?(?:(\\d+)\\.)?(\\*|\\d+)$/);\n  if (Array.isArray(version) && version[1] === '0' && version[2] === '10') {\n    nextTick = setImmediate;\n  }\n  return function () {\n    return nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    return node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  return function () {\n    return setTimeout(flush, 1);\n  };\n}\n\nvar queue$1 = new Array(1000);\n\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue$1[i];\n    var arg = queue$1[i + 1];\n\n    callback(arg);\n\n    queue$1[i] = undefined;\n    queue$1[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertex() {\n  try {\n    var r = require;\n    var vertx = r('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush$1 = undefined;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush$1 = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush$1 = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush$1 = useMessageChannel();\n} else if (browserWindow === undefined && typeof require === 'function') {\n  scheduleFlush$1 = attemptVertex();\n} else {\n  scheduleFlush$1 = useSetTimeout();\n}\n\nvar platform = undefined;\n\n/* global self */\nif (typeof self === 'object') {\n  platform = self;\n\n  /* global global */\n} else if (typeof global === 'object') {\n    platform = global;\n  } else {\n    throw new Error('no global: `self` or `global` found');\n  }\n\nvar _async$filter;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// defaults\n\n// the default export here is for backwards compat:\n//   https://github.com/tildeio/rsvp.js/issues/434\nconfig.async = asap;\nconfig.after = function (cb) {\n  return setTimeout(cb, 0);\n};\nvar cast = resolve$2;\n\nvar async = function async(callback, arg) {\n  return config.async(callback, arg);\n};\n\nfunction on() {\n  config['on'].apply(config, arguments);\n}\n\nfunction off() {\n  config['off'].apply(config, arguments);\n}\n\n// Set up instrumentation through `window.__PROMISE_INTRUMENTATION__`\nif (typeof window !== 'undefined' && typeof window['__PROMISE_INSTRUMENTATION__'] === 'object') {\n  var callbacks = window['__PROMISE_INSTRUMENTATION__'];\n  configure('instrument', true);\n  for (var eventName in callbacks) {\n    if (callbacks.hasOwnProperty(eventName)) {\n      on(eventName, callbacks[eventName]);\n    }\n  }\n}var rsvp = (_async$filter = {\n  cast: cast,\n  Promise: Promise,\n  EventTarget: EventTarget,\n  all: all$1,\n  allSettled: allSettled,\n  race: race$1,\n  hash: hash,\n  hashSettled: hashSettled,\n  rethrow: rethrow,\n  defer: defer,\n  denodeify: denodeify,\n  configure: configure,\n  on: on,\n  off: off,\n  resolve: resolve$2,\n  reject: reject$2,\n  map: map\n}, _defineProperty(_async$filter, 'async', async), _defineProperty(_async$filter, 'filter', // babel seems to error if async isn't a computed prop here...\nfilter), _async$filter);\n\nexports['default'] = rsvp;\nexports.cast = cast;\nexports.Promise = Promise;\nexports.EventTarget = EventTarget;\nexports.all = all$1;\nexports.allSettled = allSettled;\nexports.race = race$1;\nexports.hash = hash;\nexports.hashSettled = hashSettled;\nexports.rethrow = rethrow;\nexports.defer = defer;\nexports.denodeify = denodeify;\nexports.configure = configure;\nexports.on = on;\nexports.off = off;\nexports.resolve = resolve$2;\nexports.reject = reject$2;\nexports.map = map;\nexports.async = async;\nexports.filter = filter;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=rsvp.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/rsvp/dist/rsvp.js\n// module id = 106\n// module chunks = 0 1 2","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/process/browser.js\n// module id = 107\n// module chunks = 0 1 2","var nextTick = require('process/browser.js').nextTick;\nvar apply = Function.prototype.apply;\nvar slice = Array.prototype.slice;\nvar immediateIds = {};\nvar nextImmediateId = 0;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) { timeout.close(); };\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(window, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// That's not how node.js implements it but the exposed api is the same.\nexports.setImmediate = typeof setImmediate === \"function\" ? setImmediate : function(fn) {\n  var id = nextImmediateId++;\n  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n\n  immediateIds[id] = true;\n\n  nextTick(function onNextTick() {\n    if (immediateIds[id]) {\n      // fn.call() is faster so we optimize for the common use-case\n      // @see http://jsperf.com/call-apply-segu\n      if (args) {\n        fn.apply(null, args);\n      } else {\n        fn.call(null);\n      }\n      // Prevent ids from leaking\n      exports.clearImmediate(id);\n    }\n  });\n\n  return id;\n};\n\nexports.clearImmediate = typeof clearImmediate === \"function\" ? clearImmediate : function(id) {\n  delete immediateIds[id];\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/timers-browserify/main.js\n// module id = 108\n// module chunks = 0 1 2","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// vertx (ignored)\n// module id = 109\n// module chunks = 0 1 2","import isPromise from './isPromise';\nimport isPlainObject from './isPlainObject';\n\nconst PENDING = 'PENDING';\nconst FULFILLED = 'FULFILLED';\nconst REJECTED = 'REJECTED';\n\nfunction isAction(action) {\n  return isPlainObject(action) && typeof action.type !== 'undefined';\n}\n\nexport default function promiseMiddleware(store) {\n  const { dispatch } = store;\n\n  return next => action => {\n    if (typeof action === 'function') return action(store);\n\n    if (!isAction(action) || !isPromise(action.payload) || action.error) {\n      return next(action);\n    }\n\n    const { type, payload, meta } = action;\n\n    dispatch({ type: `${type}_${PENDING}`, meta });\n\n    return payload.then(\n      result => dispatch({ type: `${type}_${FULFILLED}`, payload: result, meta }),\n      error => dispatch({ type: `${type}_${REJECTED}`, payload, error,  meta })\n    );\n  };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/clientMiddleware.js","export default function isPromise(value) {\n  if (value !== null && typeof value === 'object') {\n    return typeof value.then === 'function';\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/isPromise.js","\"use strict\";\n\nexports.__esModule = true;\n\nvar _iterator = require(\"../core-js/symbol/iterator\");\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _symbol = require(\"../core-js/symbol\");\n\nvar _symbol2 = _interopRequireDefault(_symbol);\n\nvar _typeof = typeof _symbol2.default === \"function\" && typeof _iterator2.default === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = typeof _symbol2.default === \"function\" && _typeof(_iterator2.default) === \"symbol\" ? function (obj) {\n  return typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n} : function (obj) {\n  return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/typeof.js\n// module id = 112\n// module chunks = 0 1 2","module.exports = { \"default\": require(\"core-js/library/fn/symbol/iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/symbol/iterator.js\n// module id = 113\n// module chunks = 0 1 2","require('../../modules/es6.string.iterator');\nrequire('../../modules/web.dom.iterable');\nmodule.exports = require('../../modules/_wks-ext').f('iterator');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/symbol/iterator.js\n// module id = 114\n// module chunks = 0 1 2","exports.f = require('./_wks');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_wks-ext.js\n// module id = 115\n// module chunks = 0 1 2","module.exports = { \"default\": require(\"core-js/library/fn/symbol\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/symbol.js\n// module id = 116\n// module chunks = 0 1 2","require('../../modules/es6.symbol');\nrequire('../../modules/es6.object.to-string');\nrequire('../../modules/es7.symbol.async-iterator');\nrequire('../../modules/es7.symbol.observable');\nmodule.exports = require('../../modules/_core').Symbol;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/symbol/index.js\n// module id = 117\n// module chunks = 0 1 2","'use strict';\n// ECMAScript 6 symbols shim\nvar global         = require('./_global')\n  , has            = require('./_has')\n  , DESCRIPTORS    = require('./_descriptors')\n  , $export        = require('./_export')\n  , redefine       = require('./_redefine')\n  , META           = require('./_meta').KEY\n  , $fails         = require('./_fails')\n  , shared         = require('./_shared')\n  , setToStringTag = require('./_set-to-string-tag')\n  , uid            = require('./_uid')\n  , wks            = require('./_wks')\n  , wksExt         = require('./_wks-ext')\n  , wksDefine      = require('./_wks-define')\n  , keyOf          = require('./_keyof')\n  , enumKeys       = require('./_enum-keys')\n  , isArray        = require('./_is-array')\n  , anObject       = require('./_an-object')\n  , toIObject      = require('./_to-iobject')\n  , toPrimitive    = require('./_to-primitive')\n  , createDesc     = require('./_property-desc')\n  , _create        = require('./_object-create')\n  , gOPNExt        = require('./_object-gopn-ext')\n  , $GOPD          = require('./_object-gopd')\n  , $DP            = require('./_object-dp')\n  , $keys          = require('./_object-keys')\n  , gOPD           = $GOPD.f\n  , dP             = $DP.f\n  , gOPN           = gOPNExt.f\n  , $Symbol        = global.Symbol\n  , $JSON          = global.JSON\n  , _stringify     = $JSON && $JSON.stringify\n  , PROTOTYPE      = 'prototype'\n  , HIDDEN         = wks('_hidden')\n  , TO_PRIMITIVE   = wks('toPrimitive')\n  , isEnum         = {}.propertyIsEnumerable\n  , SymbolRegistry = shared('symbol-registry')\n  , AllSymbols     = shared('symbols')\n  , OPSymbols      = shared('op-symbols')\n  , ObjectProto    = Object[PROTOTYPE]\n  , USE_NATIVE     = typeof $Symbol == 'function'\n  , QObject        = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function(){\n  return _create(dP({}, 'a', {\n    get: function(){ return dP(this, 'a', {value: 7}).a; }\n  })).a != 7;\n}) ? function(it, key, D){\n  var protoDesc = gOPD(ObjectProto, key);\n  if(protoDesc)delete ObjectProto[key];\n  dP(it, key, D);\n  if(protoDesc && it !== ObjectProto)dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function(tag){\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function(it){\n  return typeof it == 'symbol';\n} : function(it){\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D){\n  if(it === ObjectProto)$defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if(has(AllSymbols, key)){\n    if(!D.enumerable){\n      if(!has(it, HIDDEN))dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if(has(it, HIDDEN) && it[HIDDEN][key])it[HIDDEN][key] = false;\n      D = _create(D, {enumerable: createDesc(0, false)});\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P){\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P))\n    , i    = 0\n    , l = keys.length\n    , key;\n  while(l > i)$defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P){\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key){\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if(this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key))return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key){\n  it  = toIObject(it);\n  key = toPrimitive(key, true);\n  if(it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key))return;\n  var D = gOPD(it, key);\n  if(D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key]))D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it){\n  var names  = gOPN(toIObject(it))\n    , result = []\n    , i      = 0\n    , key;\n  while(names.length > i){\n    if(!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META)result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it){\n  var IS_OP  = it === ObjectProto\n    , names  = gOPN(IS_OP ? OPSymbols : toIObject(it))\n    , result = []\n    , i      = 0\n    , key;\n  while(names.length > i){\n    if(has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true))result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif(!USE_NATIVE){\n  $Symbol = function Symbol(){\n    if(this instanceof $Symbol)throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function(value){\n      if(this === ObjectProto)$set.call(OPSymbols, value);\n      if(has(this, HIDDEN) && has(this[HIDDEN], tag))this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if(DESCRIPTORS && setter)setSymbolDesc(ObjectProto, tag, {configurable: true, set: $set});\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString(){\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f   = $defineProperty;\n  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;\n  require('./_object-pie').f  = $propertyIsEnumerable;\n  require('./_object-gops').f = $getOwnPropertySymbols;\n\n  if(DESCRIPTORS && !require('./_library')){\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function(name){\n    return wrap(wks(name));\n  }\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, {Symbol: $Symbol});\n\nfor(var symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), i = 0; symbols.length > i; )wks(symbols[i++]);\n\nfor(var symbols = $keys(wks.store), i = 0; symbols.length > i; )wksDefine(symbols[i++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function(key){\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(key){\n    if(isSymbol(key))return keyOf(SymbolRegistry, key);\n    throw TypeError(key + ' is not a symbol!');\n  },\n  useSetter: function(){ setter = true; },\n  useSimple: function(){ setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function(){\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({a: S}) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it){\n    if(it === undefined || isSymbol(it))return; // IE8 returns string on undefined\n    var args = [it]\n      , i    = 1\n      , replacer, $replacer;\n    while(arguments.length > i)args.push(arguments[i++]);\n    replacer = args[1];\n    if(typeof replacer == 'function')$replacer = replacer;\n    if($replacer || !isArray(replacer))replacer = function(key, value){\n      if($replacer)value = $replacer.call(this, key, value);\n      if(!isSymbol(value))return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.symbol.js\n// module id = 118\n// module chunks = 0 1 2","var META     = require('./_uid')('meta')\n  , isObject = require('./_is-object')\n  , has      = require('./_has')\n  , setDesc  = require('./_object-dp').f\n  , id       = 0;\nvar isExtensible = Object.isExtensible || function(){\n  return true;\n};\nvar FREEZE = !require('./_fails')(function(){\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function(it){\n  setDesc(it, META, {value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  }});\n};\nvar fastKey = function(it, create){\n  // return primitive with prefix\n  if(!isObject(it))return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if(!has(it, META)){\n    // can't set metadata to uncaught frozen object\n    if(!isExtensible(it))return 'F';\n    // not necessary to add metadata\n    if(!create)return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function(it, create){\n  if(!has(it, META)){\n    // can't set metadata to uncaught frozen object\n    if(!isExtensible(it))return true;\n    // not necessary to add metadata\n    if(!create)return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function(it){\n  if(FREEZE && meta.NEED && isExtensible(it) && !has(it, META))setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY:      META,\n  NEED:     false,\n  fastKey:  fastKey,\n  getWeak:  getWeak,\n  onFreeze: onFreeze\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_meta.js\n// module id = 119\n// module chunks = 0 1 2","var global         = require('./_global')\n  , core           = require('./_core')\n  , LIBRARY        = require('./_library')\n  , wksExt         = require('./_wks-ext')\n  , defineProperty = require('./_object-dp').f;\nmodule.exports = function(name){\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if(name.charAt(0) != '_' && !(name in $Symbol))defineProperty($Symbol, name, {value: wksExt.f(name)});\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_wks-define.js\n// module id = 120\n// module chunks = 0 1 2","var getKeys   = require('./_object-keys')\n  , toIObject = require('./_to-iobject');\nmodule.exports = function(object, el){\n  var O      = toIObject(object)\n    , keys   = getKeys(O)\n    , length = keys.length\n    , index  = 0\n    , key;\n  while(length > index)if(O[key = keys[index++]] === el)return key;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_keyof.js\n// module id = 121\n// module chunks = 0 1 2","// all enumerable object keys, includes symbols\nvar getKeys = require('./_object-keys')\n  , gOPS    = require('./_object-gops')\n  , pIE     = require('./_object-pie');\nmodule.exports = function(it){\n  var result     = getKeys(it)\n    , getSymbols = gOPS.f;\n  if(getSymbols){\n    var symbols = getSymbols(it)\n      , isEnum  = pIE.f\n      , i       = 0\n      , key;\n    while(symbols.length > i)if(isEnum.call(it, key = symbols[i++]))result.push(key);\n  } return result;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_enum-keys.js\n// module id = 122\n// module chunks = 0 1 2","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg){\n  return cof(arg) == 'Array';\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_is-array.js\n// module id = 123\n// module chunks = 0 1 2","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./_to-iobject')\n  , gOPN      = require('./_object-gopn').f\n  , toString  = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function(it){\n  try {\n    return gOPN(it);\n  } catch(e){\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it){\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-gopn-ext.js\n// module id = 124\n// module chunks = 0 1 2","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys      = require('./_object-keys-internal')\n  , hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O){\n  return $keys(O, hiddenKeys);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-gopn.js\n// module id = 125\n// module chunks = 0 1 2","var pIE            = require('./_object-pie')\n  , createDesc     = require('./_property-desc')\n  , toIObject      = require('./_to-iobject')\n  , toPrimitive    = require('./_to-primitive')\n  , has            = require('./_has')\n  , IE8_DOM_DEFINE = require('./_ie8-dom-define')\n  , gOPD           = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P){\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if(IE8_DOM_DEFINE)try {\n    return gOPD(O, P);\n  } catch(e){ /* empty */ }\n  if(has(O, P))return createDesc(!pIE.f.call(O, P), O[P]);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-gopd.js\n// module id = 126\n// module chunks = 0 1 2","require('./_wks-define')('asyncIterator');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es7.symbol.async-iterator.js\n// module id = 127\n// module chunks = 0 1 2","require('./_wks-define')('observable');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es7.symbol.observable.js\n// module id = 128\n// module chunks = 0 1 2","var fnToString = (fn) => Function.prototype.toString.call(fn);\nvar objStringValue = fnToString(Object);\n\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\nexport default function isPlainObject(obj) {\n  if (!obj || typeof obj !== 'object') {\n    return false;\n  }\n\n  var proto = typeof obj.constructor === 'function' ? Object.getPrototypeOf(obj) : Object.prototype;\n\n  if (proto === null) {\n    return true;\n  }\n\n  var constructor = proto.constructor;\n\n  return typeof constructor === 'function'\n    && constructor instanceof constructor\n    && fnToString(constructor) === objStringValue;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/isPlainObject.js","module.exports = { \"default\": require(\"core-js/library/fn/object/get-prototype-of\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/get-prototype-of.js\n// module id = 130\n// module chunks = 0 1 2","require('../../modules/es6.object.get-prototype-of');\nmodule.exports = require('../../modules/_core').Object.getPrototypeOf;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/object/get-prototype-of.js\n// module id = 131\n// module chunks = 0 1 2","// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject        = require('./_to-object')\n  , $getPrototypeOf = require('./_object-gpo');\n\nrequire('./_object-sap')('getPrototypeOf', function(){\n  return function getPrototypeOf(it){\n    return $getPrototypeOf(toObject(it));\n  };\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.object.get-prototype-of.js\n// module id = 132\n// module chunks = 0 1 2","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export')\n  , core    = require('./_core')\n  , fails   = require('./_fails');\nmodule.exports = function(KEY, exec){\n  var fn  = (core.Object || {})[KEY] || Object[KEY]\n    , exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function(){ fn(1); }), 'Object', exp);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-sap.js\n// module id = 133\n// module chunks = 0 1 2","import cuid from 'cuid';\nimport { Map, List } from 'immutable';\nimport { curry, filter, findIndex, forEach, map, reduce, values } from 'ramda';\nimport createReducer from './utils/createReducer';\nimport { get, multi, set } from './sceneGraph';\nimport tweenFunctions from './utils/tweenFunctions';\nimport { LOAD_SCENE, CLEAR_SCENE } from './actionTypes';\nimport { ActionTypes } from '../store/createStore';\nimport { find as sceneFind, getAll } from './scene';\nimport { initPhysics, updatePhysics } from './utils/physics';\n\nconst SET_TIME = 'SET_TIME';\nconst SET_FRAME_TIME = 'SET_FRAME_TIME';\nconst START_PLAYING = 'START_PLAYING';\nconst STOP_PLAYING = 'STOP_PLAYING';\nconst UPDATE_TRACK = 'UPDATE_TRACK';\nconst UPDATE_ANIMATION = 'UPDATE_ANIMATION';\nconst REMOVE_ANIMATION = 'REMOVE_ANIMATION';\nconst QUEUE_ANIMATION = 'QUEUE_ANIMATION';\nconst QUEUE_TIMELINE_ANIMATION = 'QUEUE_TIMELINE_ANIMATION';\nconst ADD_CLIP = 'ADD_CLIP';\nconst INIT_PHYSICS = 'INIT_PHYSICS';\n\n\n/**\n * Animation module.\n *\n * This module controls the animation happening. The properties of an\n * animation are [defined here in the Animation type](global.html#Animation).\n *\n * Animations can be queued dynamically with [`queueAnimation`](module-animation.html#.queueAnimation)\n * Or, to play existing clips, queue a clip for playing with [`queueClip`](module-animation.html#.queueClip).\n *\n * @module animation\n * @public\n *\n */\n\nfunction newInitialState() {\n  return Map({\n    time: 0,\n    startTime: null,\n    playing: false,\n    autoplay: false,\n    frameTime: 0,\n    animations: List(),\n    clips: Map(),\n    timelineAnimationIndex: -1,\n    dynamicsWorld: null,\n    dynamicBodies: {},\n    kinematicBodies: {},\n  });\n}\n\nconst reducer = createReducer(newInitialState(), {\n  [ActionTypes.INIT](state) {\n    return newInitialState();\n  },\n\n  [SET_TIME](state, { time, startTime }) {\n    return state.set('time', time).set('startTime', startTime);\n  },\n\n  [SET_FRAME_TIME](state, frameTime) {\n    const currentFrameTime = state.get('frameTime');\n    // Apply a smoothing moving average to frameTime\n    return state.set('frameTime', currentFrameTime + (frameTime - currentFrameTime) * 0.1);\n  },\n\n  [START_PLAYING](state, autoplay) {\n    return state.merge({ playing: true, autoplay: !!autoplay });\n  },\n\n  [STOP_PLAYING](state) {\n    return state.set('playing', false);\n  },\n\n  [UPDATE_TRACK](state, { path, attrs }) {\n    const anim = state.getIn(['animations', path[0]]);\n    const track = anim && anim.tracks[path[1]];\n    if (track) Object.assign(track, attrs);\n    return state;\n  },\n\n  [UPDATE_ANIMATION](state, { index, attrs }) {\n    const anim = state.getIn(['animations', index]);\n    if (anim) Object.assign(anim, attrs);\n    return state;\n  },\n\n  [REMOVE_ANIMATION](state, idx) {\n    let newState = state;\n    if (idx === state.get('timelineAnimationIndex')) newState = newState.set('timelineAnimationIndex', -1);\n    return newState.deleteIn(['animations', idx]);\n  },\n\n  [QUEUE_ANIMATION](state, animation) {\n    return state.updateIn(['animations'], List(), list => list.push(animation));\n  },\n\n  [QUEUE_TIMELINE_ANIMATION](state, animation) {\n    return state.set('timelineAnimationIndex', state.get('animations').size - 1);\n  },\n\n  [ADD_CLIP](state, { clip, id }) {\n    return state.setIn(['clips', id], Map(clip).set('id', id));\n  },\n\n  [LOAD_SCENE](state, { clips }) {\n    return clips ? state.mergeIn(['clips'], clips) : state;\n  },\n\n  [CLEAR_SCENE](state) {\n    return initialState;\n  },\n\n  [INIT_PHYSICS](state, { dynamicsWorld, dynamicBodies, kinematicBodies }) {\n    return state.set('dynamicsWorld', dynamicsWorld).set('dynamicBodies', dynamicBodies).set('kinematicBodies', kinematicBodies);\n  },\n});\n\nexport function setFrameTime(frameTime) {\n  return { type: SET_FRAME_TIME, payload: frameTime };\n};\n\n/**\n * Return the current animation time.\n * @returns {Number}\n * @public\n *\n */\nexport function getTime(store) {\n  return store.getIn(['animation', 'time']);\n};\n\n/**\n * Set the current animation time.\n * @public\n * @param {Number} time in seconds\n */\nexport function setTime(time) {\n  return (store) => {\n    const startTime = new Date();\n    const delta = time - store.getIn(['animation', 'time']);\n    const dynamicsWorld = store.getIn(['animation', 'dynamicsWorld']);\n\n    if (delta !== 0) {\n      if (store.getIn(['animation', 'animations']).size) {\n        store.getIn(['animation', 'animations']).forEach((anim, animIdx) => {\n          updateAnimation(store, delta, time, anim, animIdx);\n        });\n      } else {\n        if (store.getIn(['animation', 'autoplay'])) {\n          store.dispatch(stopPlaying());\n        }\n      }\n\n      if (dynamicsWorld) {\n        updatePhysics(store, delta, time, dynamicsWorld,\n          store.getIn(['animation', 'dynamicBodies']),\n          store.getIn(['animation', 'kinematicBodies'])\n        )\n      }\n    }\n\n    store.dispatch({ type: SET_TIME, payload: { time, startTime } });\n  };\n};\n\nfunction getKeyframeValueFor(t, keyframes, tween, currentValue) {\n  const { vs, ts } = keyframes;\n\n  if (!ts.length) return currentValue;\n\n  const idx = findIndex((kt) => t <= kt, ts);\n  if (idx === -1) return vs[vs.length - 1];\n\n  // FIXME: Handle keyframe that hasn't started yet\n  if (idx === 0) return vs[0];\n\n  //console.log('tween?', frame1.v, frame2.v, frame2.t - frame1.t);\n  const v = tween(t - ts[idx - 1], vs[idx - 1], vs[idx], ts[idx] - ts[idx - 1]);\n  //console.log('getkeyframe value?', t, idx, v);\n  return v;\n}\n\nfunction getKeyframeValue(t, keyframes, tween, currentValue) {\n  //console.log('get keyframe value: ', t, keyframes, tween);\n  if (keyframes.ts) return getKeyframeValueFor(t, keyframes, tween, currentValue);\n  const result = {};\n  const keys = Object.keys(keyframes);\n  for (var i = 0; i < keys.length; i++) {\n    result[keys[i]] = getKeyframeValueFor(t, keyframes[keys[i]], tween, currentValue[keys[i]]);\n  }\n\n  return result;\n};\n\nfunction updateAnimation(store, delta, time, animation, animationIdx) {\n  //console.log('updateAnimation', delta, time, animation.name, animationIdx);\n\n  const { tracks, first, iterations, duration, easingFn, easingDuration, playSpeed } = animation;\n  let { easingTime } = animation;\n  const animationStart = animation.start;\n  const trackSet = animation.set;\n\n  let animationTime = time;\n\n  const isEasing = first && time < (animationStart + easingDuration);\n  if (isEasing) {\n    easingTime += delta * easingFn(time - animationStart, 0, 1, easingDuration);\n    animationTime = animationStart + easingTime;\n  } else if (easingTime) {\n    animationTime = time - easingDuration + easingTime;\n  }\n\n  const reverse = playSpeed < 0;\n\n  if (playSpeed !== 1) {\n    animationTime = (animationTime - animationStart) * playSpeed + animationStart;\n    if (reverse) animationTime = animationTime + duration;\n  }\n\n  let inProgress = false;\n  let ops = [];\n\n  var s = new Date();\n  let track;\n  for (var trackIdx = 0; trackIdx < tracks.length; trackIdx++) {\n    track = tracks[trackIdx];\n    const start = track.start + animationStart;\n    const end = track.end + animationStart;\n\n    if (reverse ? animationTime > end : animationTime < start) {\n      inProgress = true;\n      continue;\n    }\n\n    const endValue = track.value;\n    const { tween, path, keyframes, duration, currentValue, trackSet } = track;\n    let startValue = track.startValue;\n\n    // TODO: this should be more efficient\n    //let currentValue = endValue; //get(store, path);\n\n    if (startValue == null && !keyframes) {\n      startValue = get(store, path);\n      store.dispatch({ type: UPDATE_TRACK, payload: { path: [animationIdx, trackIdx], attrs: { startValue } } });\n    }\n\n    let v = keyframes ?\n      getKeyframeValue(animationTime - start, keyframes, tween, currentValue) :\n      (animationTime > end ? endValue : tween(animationTime - start, startValue, endValue, duration));\n\n    const op = trackSet(path, v);\n    if (op) ops.push(op);\n\n    if (reverse ? animationTime >= start : animationTime <= end) inProgress = true;\n  }\n\n  //console.log('dispatch animations',ops.length, 'in',  new Date() - s);\n  if (ops.length) store.dispatch(multi(ops));\n\n  if (inProgress) {\n    if (isEasing) {\n      store.dispatch({ type: UPDATE_ANIMATION, payload: { index: animationIdx, attrs: {\n        easingTime,\n      }, }, });\n    }\n  } else {\n    if (iterations > 1) {\n      store.dispatch({ type: UPDATE_ANIMATION, payload: { index: animationIdx, attrs: {\n        first: false, easingTime: 0, start: time, iterations: iterations - 1,\n      }, }, });\n    } else {\n      if (animation.onEnd) animation.onEnd();\n\n      if (animationIdx !== store.getIn(['animation', 'timelineAnimationIndex'])) {\n        store.dispatch({ type: REMOVE_ANIMATION, payload: animationIdx });\n      } else {\n        store.dispatch({ type: UPDATE_ANIMATION, payload: {\n          index: animationIdx, attrs: { start: time },\n        }, });\n        store.dispatch(stopPlaying());\n      }\n    }\n  }\n};\n\n/**\n * Are we currently playing\n * @returns {Boolean}\n */\nexport function isPlaying(store) {\n  return store.getIn(['animation', 'playing']);\n};\n\n/**\n * Start time\n * @public\n */\nexport function startPlaying(options={}) {\n  return (store) => {\n    store.dispatch({ type: START_PLAYING, payload: options.autoplay });\n    if (typeof Ammo !== 'undefined' && !store.getIn(['animation', 'dynamicsWorld'])) {\n      store.dispatch({ type: INIT_PHYSICS, payload: initPhysics(store) });\n    }\n    store.dispatch(setTime(store.getIn(['animation', 'time'])));\n  };\n};\n\n/*\n * If we are currently playing, increment time\n */\nexport function incrementTime() {\n  return (store) => {\n    if (store.getIn(['animation', 'playing'])) {\n      const startTime = store.getIn(['animation', 'startTime']);\n      const time = store.getIn(['animation', 'time']);\n      const delta = startTime ? (new Date() - startTime) : 0;\n      store.dispatch(setTime(time + delta));\n    }\n  };\n};\n\nfunction getLastKeyframeTime(keyframes) {\n  if (keyframes.ts) return keyframes.ts.length ? keyframes.ts[keyframes.ts.length - 1] : 0;\n  let lastTime = 0;\n  let times;\n  const keys = Object.keys(keyframes);\n  for (var i = 0; i < keys.length; i++) {\n    times = keyframes[keys[i]].ts;\n    lastTime = times.length ? Math.max(times[times.length - 1], lastTime) : lastTime;\n  }\n\n  return lastTime;\n};\n\n/**\n * Stop time\n * @public\n */\nexport function stopPlaying() {\n  return { type: STOP_PLAYING };\n};\n\nfunction formatTrack(store, sceneTime, attrs) {\n  const id = cuid();\n  let path = Array.isArray(attrs.path) ? attrs.path : attrs.path && sceneFind(store, attrs.path);\n  if (!path && attrs.path && attrs.path.id) {\n    delete attrs.path.id;\n    path = sceneFind(store, attrs.path)\n  }\n  if (!path && !attrs.set) {\n    console.log('path is not defined for track', attrs);\n    return null;\n  }\n\n  const start = attrs.start || 0;\n  const value = attrs.value;\n  const tween = attrs.tween || getTweenFunction(value, attrs.easing || 'linear');\n  const trackSet = attrs.set || set;\n  const keyframes = attrs.keyframes;\n  const duration = keyframes ? getLastKeyframeTime(keyframes) : (attrs.duration || 0);\n  const end = duration + start;\n  const startValue = duration === 0 ? value : attrs.startValue;\n  const currentValue = path && get(store, path);\n  return { path, start, end, value, duration, tween, startValue, keyframes, currentValue, trackSet };\n};\n\n/**\n * Queue a clip to be played\n *\n * @public\n * @param {String} clipId the id of the clip to be queued.\n * @param {Object} attrs Attrs to override the clip settings.\n * @param {Object} options\n * @param {Boolean} options.useTimeline Display the clip in the timeline\n * @returns {Promise}\n *\n * @example\n * var clips = animation.getClips();\n * animation.queueClip(clips[0].id, {autoplay: true});\n *\n */\nexport function queueClip(clipId, attrs, options={}) {\n  return (store) => {\n    var clip = store.getIn(['animation', 'clips', clipId]);\n    if (clip) {\n      store.dispatch(queueAnimation(Object.assign({}, clip.toJS(), attrs)));\n      if (options.useTimeline) store.dispatch({ type: QUEUE_TIMELINE_ANIMATION });\n    }\n  };\n};\n\n\n/**\n * Queue an animation\n *\n * @public\n * @param {Animation} attrs the animation object\n * @returns {Promise}\n */\nexport function queueAnimation(attrs) {\n  return (store) => {\n    const sceneTime = store.getIn(['animation', 'time']);\n\n    const name = attrs.name || 'Animation';\n    const iterations = attrs.iterations || 1;\n    const start = attrs.start || sceneTime;\n    const easing = attrs.easing || 'linear';\n    const easingFn = getTweenFunction(1, easing);\n    const easingDuration = attrs.easingDuration || 0;\n    const playSpeed = typeof attrs.playSpeed !== 'undefined' ? attrs.playSpeed : 1;\n    const trackList = filter((t) => !!t, map((attrs) => formatTrack(store, sceneTime, attrs), attrs.tracks));\n    const duration = reduce((lastEnd, track) => Math.max(lastEnd, track.end), 0, trackList);\n    const onEnd = attrs.onEnd || null;\n\n    //let end = 0;\n    //forEach((t) => { if (t.get('end') > end) end = t.get('end'); }, trackList);\n\n    store.dispatch({\n      type: QUEUE_ANIMATION,\n      payload: {\n        name,\n        start,\n        easingTime: 0,\n        first: true,\n        easing,\n        easingFn,\n        easingDuration,\n        iterations,\n        tracks: trackList,\n        onEnd,\n        playSpeed,\n        duration,\n      },\n    });\n\n    if (attrs.autoplay && !isPlaying(store)) {\n      store.dispatch(startPlaying({ autoplay: true }));\n    }\n\n    return Promise.resolve(true);\n  };\n};\n\nexport function findAnimationIndex(name, store) {\n  return store.getIn(['animation', 'animations']).findIndex((anim) => anim.name === name);\n};\n\n/**\n * Remove an animation\n *\n * @public\n * @param {String} name the name of the animation\n * @returns {Promise}\n */\nexport function removeAnimation(name) {\n  return (store) => {\n    let animationIdx = findAnimationIndex(name, store);\n    if (animationIdx !== -1) {\n      return store.dispatch({ type: REMOVE_ANIMATION, payload: animationIdx });\n    }\n  };\n\n};\n\n/**\n * Add a clip to the store.\n * @param {Object} clip\n * @param {String} id\n * @returns {Promise}\n */\nexport function addClip(clip, id) {\n  return { type: ADD_CLIP, payload: { clip, id } };\n};\n\n/**\n * Return a list of clips available.\n *\n * @public\n * @returns {Clip[]}\n */\nexport function getClips(store) {\n  return values(store.getIn(['animation', 'clips']).toJS());\n};\n\nfunction getTweenFunction(value, easing) {\n  const tweenFn = tweenFunctions[easing];\n  if (!tweenFn) throw new Error('Unknown easing function: ' + easing);\n\n  if (typeof value !== 'object') return tweenFn;\n\n  const keys = Object.keys(value);\n\n  return (t, b, c, d) => {\n    const result = {};\n    for (var i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      result[key] = tweenFn(t, b[key], c[key], d);\n    }\n\n    return result;\n  };\n};\n\nexport function getTimelineAnimation(store) {\n  const index = store.getIn(['animation', 'timelineAnimationIndex']);\n  if (index < 0) return null;\n  return store.getIn(['animation', 'animations', index]);\n}\n\nconst publicApi = {\n  reducer,\n  actions: { setTime, startPlaying, stopPlaying, removeAnimation, queueAnimation,\n    addClip, queueClip,\n  },\n  selectors: { getTime, getClips, getTimelineAnimation, isPlaying },\n};\n\nexport default publicApi;\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/animation.js","module.exports = { \"default\": require(\"core-js/library/fn/object/keys\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/keys.js\n// module id = 135\n// module chunks = 0 1 2","require('../../modules/es6.object.keys');\nmodule.exports = require('../../modules/_core').Object.keys;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/object/keys.js\n// module id = 136\n// module chunks = 0 1 2","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object')\n  , $keys    = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function(){\n  return function keys(it){\n    return $keys(toObject(it));\n  };\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.object.keys.js\n// module id = 137\n// module chunks = 0 1 2","\"use strict\";\n\nexports.__esModule = true;\n\nvar _defineProperty = require(\"../core-js/object/define-property\");\n\nvar _defineProperty2 = _interopRequireDefault(_defineProperty);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (obj, key, value) {\n  if (key in obj) {\n    (0, _defineProperty2.default)(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/defineProperty.js\n// module id = 138\n// module chunks = 0 1 2","module.exports = { \"default\": require(\"core-js/library/fn/object/define-property\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/define-property.js\n// module id = 139\n// module chunks = 0 1 2","require('../../modules/es6.object.define-property');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function defineProperty(it, key, desc){\n  return $Object.defineProperty(it, key, desc);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/object/define-property.js\n// module id = 140\n// module chunks = 0 1 2","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', {defineProperty: require('./_object-dp').f});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.object.define-property.js\n// module id = 141\n// module chunks = 0 1 2","/**\n * cuid.js\n * Collision-resistant UID generator for browsers and node.\n * Sequential for fast db lookups and recency sorting.\n * Safe for element IDs and server-side lookups.\n *\n * Extracted from CLCTR\n *\n * Copyright (c) Eric Elliott 2012\n * MIT License\n */\n\n/*global window, navigator, document, require, process, module */\n(function (app) {\n  'use strict';\n  var namespace = 'cuid',\n    c = 0,\n    blockSize = 4,\n    base = 36,\n    discreteValues = Math.pow(base, blockSize),\n\n    pad = function pad(num, size) {\n      var s = \"000000000\" + num;\n      return s.substr(s.length-size);\n    },\n\n    randomBlock = function randomBlock() {\n      return pad((Math.random() *\n            discreteValues << 0)\n            .toString(base), blockSize);\n    },\n\n    safeCounter = function () {\n      c = (c < discreteValues) ? c : 0;\n      c++; // this is not subliminal\n      return c - 1;\n    },\n\n    api = function cuid() {\n      // Starting with a lowercase letter makes\n      // it HTML element ID friendly.\n      var letter = 'c', // hard-coded allows for sequential access\n\n        // timestamp\n        // warning: this exposes the exact date and time\n        // that the uid was created.\n        timestamp = (new Date().getTime()).toString(base),\n\n        // Prevent same-machine collisions.\n        counter,\n\n        // A few chars to generate distinct ids for different\n        // clients (so different computers are far less\n        // likely to generate the same id)\n        fingerprint = api.fingerprint(),\n\n        // Grab some more chars from Math.random()\n        random = randomBlock() + randomBlock();\n\n        counter = pad(safeCounter().toString(base), blockSize);\n\n      return  (letter + timestamp + counter + fingerprint + random);\n    };\n\n  api.slug = function slug() {\n    var date = new Date().getTime().toString(36),\n      counter,\n      print = api.fingerprint().slice(0,1) +\n        api.fingerprint().slice(-1),\n      random = randomBlock().slice(-2);\n\n      counter = safeCounter().toString(36).slice(-4);\n\n    return date.slice(-2) +\n      counter + print + random;\n  };\n\n  api.globalCount = function globalCount() {\n    // We want to cache the results of this\n    var cache = (function calc() {\n        var i,\n          count = 0;\n\n        for (i in window) {\n          count++;\n        }\n\n        return count;\n      }());\n\n    api.globalCount = function () { return cache; };\n    return cache;\n  };\n\n  api.fingerprint = function browserPrint() {\n    return pad((navigator.mimeTypes.length +\n      navigator.userAgent.length).toString(36) +\n      api.globalCount().toString(36), 4);\n  };\n\n  // don't change anything from here down.\n  if (app.register) {\n    app.register(namespace, api);\n  } else if (typeof module !== 'undefined') {\n    module.exports = api;\n  } else {\n    app[namespace] = api;\n  }\n\n}(this.applitude || this));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/cuid/dist/browser-cuid.js\n// module id = 142\n// module chunks = 0 1 2","export default function createReducer(initialState, handlers) {\n  return function reducer(state, action, allState, createEvent) {\n    if (action && handlers.hasOwnProperty(action.type)) {\n      return handlers[action.type](state, action.payload, { action, createEvent, state: allState });\n    } else {\n      return state || initialState;\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/utils/createReducer.js","import * as THREE from 'three';\nimport cuid from 'cuid';\nimport uuid from 'node-uuid';\nimport { Map, List, fromJS } from 'immutable';\nimport { contains, forEach, map, mapObjIndexed, curry, pick, reduce } from 'ramda';\nimport createReducer from './utils/createReducer';\nimport { addFile } from './assets';\n//import { fetchmaterial } from './files';\nimport { ADD_NODE, ADD_VR_CAMERA, DELETE_NODE, LOAD_SCENE, LOADED_FILE, SET_VR_CAMERA, CLEAR_SCENE } from './actionTypes';\nimport operators, { lookupOperator } from '../operators/nonImmutable';\nimport { evaluateSceneGraph } from './utils/evalSceneGraph';\nimport { ActionTypes } from '../store/createStore';\n\nimport { getWorldTransform } from './scene';\n\nconst SET = 'SET';\nconst MERGE = 'MERGE';\nconst REPLACE = 'REPLACE';\nconst MULTI = 'MULTI';\nconst REPARENT = 'REPARENT';\nconst ADD_OPERATOR = 'ADD_OPERATOR';\nconst TOUCH = 'TOUCH';\nconst virtualCameraId = 'cccccccc-cccc-1ccc-accc-cccccccccccc';\nconst vrCameraId = 'bbbbbbbb-bbbb-0bbb-zbbb-bbbbbbbbbbbb';\nconst virtualTargetId = 'dddddddd-dddd-0ddd-addd-dddddddddddd';\n\n/*\n * Convert from immutable.js scenegraph to our new object format\n */\nfunction convertFromImmutable(scene) {\n  return scene.map((node) => {\n    const warnings = node.get('warnings').toArray();\n    const plugs = node.get('plugs').map((ops, plug) => {\n      return ops.map((op) => {\n        let type = op.get('type');\n        let operator = lookupOperator(plug, type, warnings);\n        const opjs = operator.init(type, op.toJS(), op.get('name'));\n        //console.log('init operator: ', plug, opjs);\n        return opjs;\n      }).toArray();\n    }).toObject();\n    var nodeJS = node.toJS();\n    nodeJS.plugs = plugs;\n    nodeJS.warnings = warnings;\n    nodeJS._v = 0;\n    return nodeJS;\n  }).toObject();\n}\n\n/**\n * Initialize node from object literal format\n */\nexport function initNode(node) {\n  const plugs = {};\n  const warnings = node.warnings || [];\n  Object.keys(node.plugs).forEach((plugName) => {\n    plugs[plugName] = node.plugs[plugName].map((op) => {\n      const type = op.type;\n      const operator = lookupOperator(plugName, type, warnings);\n      return operator.init(type, op, op.name);\n    });\n  });\n  return Object.assign({}, node, { warnings, plugs, _v: 0 });\n}\n\n/*\n * Read and initialize nodes from object literal format\n */\nfunction initNodes(nodes) {\n  const result = {};\n  Object.keys(nodes).forEach((id) => {\n    result[id] = initNode(nodes[id]);\n  });\n  return result;\n}\n\n/**\n * This module contains actions to manipulate the scene graph.\n *\n * @module sceneGraph\n * @public\n *\n */\n\n/*\n * Reducer\n */\nfunction reducer(records) {\n  function createOperator(OperatorRecord, type, props, name) {\n    if (!name) name = type;\n\n    let Op = new OperatorRecord({ type, name });\n    // Calling merge directly so that the immutable shim has its `set` method called\n    // Filtering the operator to only known keys.\n    return Op.merge(pick(OperatorRecord.keys(), props));\n  };\n\n  function checkNode(node) {\n    if (!node.hasOwnProperty('_v')) node._v = 0;\n    return node;\n  }\n\n  function buildNode({ id, name, type, children, parent, plugs }) {\n    let warnings = [];\n\n    const initPlugs = mapObjIndexed((ops, plug) => {\n      if (!records[plug]) {\n        warnings = warnings.push(`No Plug: ${plug}`);\n        return [];\n      }\n\n      return ops.map((op) => {\n        if (!Array.isArray(op)) throw new Error('Expect op to be an array of 2 or 3');\n\n        let [type, props, name] = op;\n        const operator = lookupOperator(plug, type, warnings);\n        var opdata = operator.init(type, props, name); // Object.assign({}, props, { type, name });\n        //console.log('init operator: ', type, props, opdata);\n        return opdata;\n        //let OperatorRecord = records[plug][type];\n\n        //if (!OperatorRecord) {\n        //  warnings = warnings.push(`No Operator: ${plug} - ${type}`);\n        //  //console.log('WARNING:', warnings.toJS());\n        //  OperatorRecord = records.None.NoOp;\n        //}\n        //return createOperator(OperatorRecord, type, props, name);\n      });\n    }, plugs);\n\n    const newChildren = children || [];\n\n    return {\n      id,\n      name,\n      type,\n      children: newChildren,\n      parent,\n      plugs: initPlugs,\n      warnings,\n      _v: 0,\n    };\n  };\n\n  function errorNode({ id, name, children, parent }) {\n    children = children ? List(children) : List();\n    return Map({ id, name, type: 'ErrorNode', children, parent, plugs: Map() });\n  };\n\n  function initializeVirtualNodes(state, options={}) {\n    if (!state.nodes[virtualCameraId] || options.force) {\n      state.nodes[virtualCameraId] = buildNode({\n        id: virtualCameraId,\n        name: 'CAMERA',\n        type: 'Camera',\n        plugs: {\n          Camera: [['Camera', {}]],\n          Transform: [['Transform', {}]],\n          Properties: [['Default', {}]],\n        },\n      });\n    }\n\n    if (!state.nodes[vrCameraId] || options.force) {\n      state.nodes[vrCameraId] = buildNode({\n        id: vrCameraId,\n        name: 'VR CAMERA',\n        type: 'Camera',\n        plugs: {\n          Camera: [['Camera', { fieldOfView: 45 }]],\n          Transform: [['Transform', { translation: { x: 0, y: 1.6, z: 1 } }]],\n          Properties: [['Default', {}]],\n        },\n      });\n    }\n\n    if (!state.nodes[virtualTargetId] || options.force) {\n      state.nodes[virtualTargetId] = buildNode({\n        id: virtualTargetId,\n        name: 'VIRTUAL TARGET NULL',\n        type: 'Null',\n        plugs: {\n          Transform: [['Transform', {}]],\n        },\n      });\n    }\n  }\n\n  function newInitialState() {\n    return {\n      _v: 0,\n      nodes: {},\n      fileReferences: { to: {}, from: {} },\n      nodeReferences: { to: {}, from: {} },\n      evaluatedNodes: {},\n      loaded: false,\n      _ev: 0,\n    };\n  }\n\n  function setReducer(state, { path, value }) {\n    if (!path.length || path.length < 2) {\n      throw new Error('SET requires a path with length 2 or 4');\n    }\n\n    const [nodeId, plugName, idx, key] = path;\n    const node = state.nodes[nodeId];\n\n    if (path.length === 2 && path[1] === 'name') {\n      node.name = value;\n      node._v += 1;\n      state._v += 1;\n    } else {\n      const plug = node && node.plugs[plugName];\n      const op = plug && plug[idx];\n      if (!op) throw new Error('Setting data on unknown operator: ' + path.join(','));\n\n      const operator = operators[plugName][op.type];\n      if (operator.set(op, key, value)) {\n        node._v += 1;\n        state._v += 1;\n      };\n    }\n\n    return state;\n  }\n\n  const sceneReducer = createReducer({}, {\n    // If we have multiple players on a page, the state object for the sceneGraph module must be unique.\n    // Use the @@redux/INIT action to create a new base state object.\n    [ActionTypes.INIT](state) {\n      return newInitialState();\n    },\n\n    [TOUCH](state, id) {\n      const node = state.nodes[id];\n      if (node) {\n        node._v += 1;\n        state._v += 1;\n      }\n\n      return state;\n    },\n\n    [SET]: setReducer,\n\n    [MERGE](state, { path, attrs }) {\n      if (!path.length || path.length !== 3) {\n        throw new Error('MERGE requires a path with length 3');\n      }\n\n      if (typeof attrs !== 'object') {\n        throw new Error('MERGE requires an object to merge in');\n      }\n\n      const [nodeId, plugName, idx] = path;\n      const node = state.nodes[nodeId];\n      const plug = node && node.plugs[plugName];\n      const op = plug && plug[idx];\n      const operator = op && operators[plugName][op.type];\n      if (!operator) throw new Error('Setting data on unknown operator: ' + path.join(','));\n      for (var k of Object.keys(attrs)) {\n        operator.set(op, k, attrs[k]);\n      }\n      //op._v += 1;\n      node._v += 1;\n      state._v += 1;\n      return state;\n    },\n\n    [REPLACE](state, { id, node }) {\n      const originalNode = state.nodes[id];\n      if (!originalNode) return;\n\n      const v = originalNode._v;\n      state.nodes[id] = node;\n      node._v = v + 1;\n      state._v += 1;\n      return state;\n    },\n\n    [ADD_NODE](state, attrs) {\n      const { id, parent } = attrs;\n      const parentNode = parent && state.nodes[parent];\n      if (parent && !parentNode) throw new Error(`Unknown parent: '${parent}'`);\n\n      if (state.nodes[id]) throw new Error(`Adding a node that already exists: ${id}`);\n\n      state.nodes[id] = attrs.node ? checkNode(attrs.node) : buildNode(attrs);\n\n      if (parent && !parentNode.children) {\n        parentNode.children = [];\n      }\n\n      if (parent && parentNode.children.indexOf(id) === -1) {\n        parentNode.children.push(id);\n      }\n\n      state._v += 1;\n      return state;\n    },\n\n    [DELETE_NODE](state, nodeId) {\n      function deleteNodesFromState(id) {\n        const node = state.nodes[id];\n        if (node) {\n          for (let childId of (node.children || [])) {\n            deleteNodesFromState(childId);\n          }\n\n          const references = state.nodeReferences.from[id];\n          Object.keys(references || {}).forEach((refKey) => {\n            const path = JSON.parse(refKey);\n            setReducer(state, { path, value: null });\n          });\n          delete state.nodes[id];\n        }\n\n        return node;\n      }\n\n      const node = deleteNodesFromState(nodeId);\n      if (!node) return state;\n      let parent = node.parent && state.nodes[node.parent];\n      if (parent) {\n        let idx = parent.children.indexOf(nodeId);\n        if (idx !== -1) parent.children.splice(idx, 1);\n        parent._v += 1;\n      }\n\n      state._v += 1;\n      return state;\n    },\n\n    [ADD_OPERATOR](state, attrs) {\n      const { id, plug, op } = attrs;\n      const node = state.nodes[id];\n      if (!node) throw new Error(`Unknown node: ${id}`);\n\n      const ops = node.plugs[plug];\n      if (!ops) throw new Error(`Unknown plug: ${plug}`);\n\n      if (!Array.isArray(op)) throw new Error('Expect op to be an array of 2 or 3');\n\n      const [type, props, name] = op;\n      const operator = lookupOperator(plug, type, node.warnings);\n      ops.push(operator.init(type, op, name));\n      node._v += 1;\n      state._v += 1;\n\n      return state;\n    },\n\n    [MULTI](state, ops) {\n      const v = state._v;\n      for (let opId in ops) {\n        let op = ops[opId];\n        if (op.type === SET) setReducer(state, op.payload);\n      }\n\n      state._v = v + 1;\n      //console.log('create new multi state in: ', new Date() - s);\n      return state;\n    },\n\n    [REPARENT](state, { parentId, childIds }) {\n      const newParentNode = state.nodes[parentId];\n      if (!newParentNode) {\n        console.warn(`Unknown parent for reparent: ${parentId}`);\n        return state;\n      }\n\n      forEach((childId) => {\n        const childNode = state.nodes[childId];\n        if (!childNode) return;\n\n        const childParentId = childNode && childNode.parent;\n        const prevParentNode = childParentId && state.nodes[childParentId];\n        let idx = prevParentNode && prevParentNode.children ? prevParentNode.children.indexOf(childId) : -1;\n        if (idx !== -1) {\n          prevParentNode.children.splice(idx, 1);\n          prevParentNode._v += 1;\n        }\n\n        newParentNode.children.push(childId);\n        childNode.parent = parentId;\n        childNode._v += 1;\n      }, childIds.slice()); // iterate copy of array to protect from corruption from child removals\n\n      newParentNode._v += 1;\n      state._v += 1;\n      return state;\n    },\n\n    [LOAD_SCENE](state, { scene, nodes }) {\n      const sceneJS = scene\n        ? convertFromImmutable(scene)\n        : initNodes(JSON.parse(nodes));\n\n      Object.assign(state.nodes, sceneJS);\n\n      initializeVirtualNodes(state);\n      state._v += 1;\n\n      return state;\n      //const newState = state.merge(scene);\n      //return newState.get(virtualCameraId) ? newState : newState.set(virtualCameraId, buildNode({\n      //  id: virtualCameraId,\n      //  name: 'CAMERA',\n      //  type: 'Camera',\n      //  plugs: {\n      //    Camera: [['Camera', {}]],\n      //    Transform: [['Transform', {}]],\n      //    Properties: [['Default', {}]],\n      //  },\n      //}));\n    },\n\n    [CLEAR_SCENE](state, id) {\n      initializeVirtualNodes(state, { force: true });\n      state._v += 1;\n      if (state.nodes[id]) state.nodes[id]._v = 0;\n      return state;\n    },\n\n    [LOADED_FILE](state, id) {\n      if (state.fileReferences.from[id]) {\n        for (let refKey of Object.keys(state.fileReferences.from[id])) {\n          const [nodeId, plugName, opIdx] = JSON.parse(refKey);\n          state.nodes[nodeId]._v += 1;\n        }\n\n        state._v += 1;\n      }\n\n      return state;\n    },\n\n    [SET_VR_CAMERA](state, cameraId) {\n      // FIXME: remove this\n      const camNode = state.get(cameraId);\n      if (camNode.type === 'Camera') return state.set(vrCameraId, camNode);\n      else return state;\n    },\n\n  });\n\n  return sceneReducer;\n}\n\n// Return a new node object from existing node\nfunction copyNode(node) {\n  const newPlugs = {};\n  for (let plug of Object.keys(node.plugs)) {\n    newPlugs[plug] = map((op) => Object.assign({}, op), node.plugs[plug]);\n  }\n\n  return {\n    id: uuid.v4(),\n    name: node.name,\n    type: node.type,\n    parent: node.parent,\n    children: [].concat(node.children),\n    plugs: newPlugs,\n    _v: 1,\n  };\n}\n\n/**\n * Add a node to the scene.\n *\n * @public\n * @param {Node} node\n * @returns {Promise}\n */\nexport function addNode(node)  {\n  let { id, name, type, plugs, parent } = node;\n  if (!id) id = uuid.v4(); //cuid();\n  name = name || id;\n\n  return {\n    type: ADD_NODE,\n    payload: { id, name, type, plugs, parent },\n    resolve: id,\n  };\n};\n\nexport function setVRCamera(camId) {\n  return { type: SET_VR_CAMERA, payload: camId };\n}\n\n/**\n * Deletes a node\n *\n * @public\n * @param {String} id The node id\n * @returns {Promise}\n */\nexport function deleteNode(id) {\n  return {\n    type: DELETE_NODE,\n    payload: id,\n  };\n};\n\n/**\n *\n * Add an operator to a plug of a node.\n */\nexport function addOperator(id, plug, op) {\n  return {\n    type: ADD_OPERATOR,\n    payload: { id, plug, op },\n  };\n};\n\n/**\n * get a property\n *\n * @param {Path} path to the operator property.\n * @returns {any} value\n *\n * @example\n * // scene.get([uuid\n */\nexport function get(store, path) {\n  if (!Array.isArray(path)) throw new Error('Expect path to be an array');\n\n  const sceneGraph = store.get('sceneGraph');\n  let result = sceneGraph.nodes[path[0]];\n\n  if (path.length >= 2) {\n    if (path[1] === 'name' || path[1] === 'type') {\n      return result && result[path[1]];\n    }\n\n    result = result && result.plugs[path[1]];\n  }\n\n  if (path.length >= 3) {\n    result = result && result[path[2]];\n  }\n\n  if (path.length >= 4 && result) {\n    const operator = lookupOperator(path[1], result.type, []);\n    result = operator.get(result, path[3]);\n  }\n\n  return result;\n};\n\nexport function getVRCamera(store) {\n  return store.getIn(['sceneGraph', vrCameraId]);\n}\n\n/**\n * set a property on an operator. This takes a Path array,\n * and a value\n *\n * @param {Path} path includes the operator property.\n * @param {any} value\n * @returns {Promise}\n *\n */\nexport function set(path, value) {\n  return { type: SET, payload: { path, value }, meta: { remote: true } };\n};\n\n/**\n * Merges an object into an operator.\n *\n * @param {Path} path to the operator.\n * @param {Object} attrs\n * @returns {Promise}\n *\n */\nexport function merge(path, attrs) {\n  return { type: MERGE, payload: { path, attrs } };\n};\n\n/**\n * Replace a node with the given node contents\n * @private\n *\n */\nexport function replace(id, node) {\n  return { type: REPLACE, payload: { id, node } };\n};\n\n/**\n * An array of scene actions.\n *\n * @param {Action[]} ops\n * @returns {Promise}\n */\nexport function multi(ops) {\n  return { type: MULTI, payload: ops };\n};\n\n/**\n * Touch sceneGraph node, so it is re-evaluated and translated\n */\nexport function touch(id) {\n  return { type: TOUCH, payload: id };\n};\n\n/**\n * Reparent nodes to the new parent.\n *\n * @public\n * @param {String} parent id of the new parent node\n * @param {Array} childIds list of ids to reparent\n *\n * @example\n * // reparent children of 'MyModel' to 'NewParentNull'\n * const parentId = scene.find({ name: 'NewParentNull' });\n * const nodesToReparent = scene.filter({ from: { name: 'MyModel' } });\n * sceneGraph.reparent(parentId, nodesToReparent);\n */\nexport function reparent(parentId, childIds) {\n  return { type: REPARENT, payload: { parentId, childIds } };\n};\n\n/**\n * Return the parent id of the node.\n */\nexport function findParent(store, id) {\n  const node = store.get('sceneGraph').nodes[id];\n  return node && node.parent;\n};\n\n/**\n * Return the root parent id of the node.\n */\nexport function findRoot(store, id) {\n  const node = store.get('sceneGraph').nodes[id];\n  const parent = node && node.parent;\n  return parent ? findRoot(store, parent) : id;\n};\n\n/**\n * Clone nodes. Given a list of ids, this will copy the node with a new id,\n * and update the parent and child of each node. By passing in a map of *old\n * parent id* to *new parent id*, the nodes can be cloned to a different location\n * in the sceneGraph (or from one to another).\n *\n * @public\n * @param {Array} ids list of ids to clone\n * @param {Object} nodeMap of {oldNodeId: newNodeId} Can be used for passing\n *                         new parents, or new depencies.\n * @param {Object} [options]\n * @param {Boolean} [options.cloneDependencies] Clone dependencies as well.\n *\n * @example\n * // clone children of 'MyModel' to 'NewParentNull'\n * const parentId = scene.find({ name: 'NewParentNull' });\n * const myModelId = scene.find({ name: 'MyModel' });\n * const nodesToClone = scene.filter({ from: { id: myModelId } });\n * sceneGraph.clone(nodesToClone, { [myModelId]: parentId });\n * // clone dependencies\n * sceneGraph.clone(nodesToClone, { [myModelId]: parentId }, {cloneDependencies: true});\n */\nexport function clone(ids, nodeMap={}, options={}) {\n  const { cloneDependencies } = options;\n  const nodes = reduce((acc, id) => {\n    acc[id] = true; return acc;\n  }, {}, ids);\n  const assets = {};\n\n  return (store) => {\n    const sceneGraph = store.get('sceneGraph');\n\n    // Find dependencies\n    function checkDependency(id) {\n      const node = sceneGraph.nodes[id];\n      const name = node && node.name;\n      if (!node || !node.plugs) return;\n\n      for (let plug of Object.keys(node.plugs)) {\n        const ops = node.plugs[plug];\n\n        for (let op of ops) {\n          const operator = operators[plug][op.type];\n          if (operator) {\n            for (let key of operator.referenceKeys) {\n              const refId = op[key];\n              if (refId && !nodes[refId] && !nodeMap[refId]) {\n                nodes[refId] = true;\n                checkDependency(refId);\n              }\n            }\n\n            for (let key of operator.fileReferenceKeys) {\n              const refId = op[key];\n              if (refId && store.getIn(['assets', refId])) {\n                assets[refId] = true;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    if (cloneDependencies) forEach(checkDependency, ids);\n\n    // Generate new ids\n    forEach((id) => nodes[id] = uuid.v4(), Object.keys(nodes));\n    forEach((assetId) => assets[assetId] = uuid.v4(), Object.keys(assets));\n\n    function updateDependencies(node) {\n      var resultNode = node;\n      for (let plug of Object.keys(node.plugs)) {\n        const ops = node.plugs[plug];\n        ops.forEach((op, opIdx) => {\n          const operator = operators[plug][op.type];\n          if (operator) {\n            for (let key of operator.referenceKeys) {\n              const refId = op[key];\n              const newRef = refId && (nodes[refId] || nodeMap[refId]);\n              if (newRef) resultNode.plugs[plug][opIdx][key] = newRef;\n            }\n\n            for (let key of operator.fileReferenceKeys) {\n              const refId = op[key];\n              if (refId && assets[refId]) {\n                resultNode.plugs[plug][opIdx][key] = assets[refId];\n              }\n            };\n          }\n        });\n      }\n\n      return resultNode;\n    }\n\n\n    // Remap parents, children and dependencies\n    forEach((id) => {\n      const oldNode = sceneGraph.nodes[id];\n      const newNode = copyNode(oldNode);\n      newNode.id = nodes[id];\n\n      const nodeParent = oldNode.parent;\n      const parent = nodeParent && (nodes[nodeParent] || nodeMap[nodeParent] || nodeParent);\n      newNode.parent = parent;\n\n      newNode.children = [];\n      for (let childId of oldNode.children) {\n        if (nodes[childId]) newNode.children.push(nodes[childId]);\n        else if (nodeMap[childId]) newNode.children.push(nodeMap[childId]);\n      }\n\n      store.dispatch({\n        type: ADD_NODE,\n        payload: {\n          id: nodes[id],\n          parent,\n          node: updateDependencies(newNode),\n        },\n      });\n    }, Object.keys(nodes));\n\n    var firstNodeRootId = findRoot(store, nodes[Object.keys(nodes)[0]]);\n\n    forEach((assetId) => {\n      const asset = store.getIn(['assets', assetId]);\n      if (asset) {\n        store.dispatch(addFile(asset.set('id', assets[assetId]).set('sceneId', firstNodeRootId).toJS()));\n      }\n    }, Object.keys(assets));\n\n    return Promise.resolve(nodes);\n  };\n};\n\nexport function oldNodeJSON(node) {\n  const plugs = Object.keys(node.plugs).map(function (plugName) {\n    return {\n      type: plugName,\n      operators: node.plugs[plugName].map((op) => {\n        const operator = lookupOperator(plugName, op.type, []);\n        return operator.export(op);\n      }),\n    };\n  });\n\n  return {\n    _id: node.id,\n    name: node.name,\n    type: node.type,\n    plugs,\n    nodes: [],\n  };\n};\n\n/**\n * Given a list of nodes, build and return the old scene graph format.\n */\nexport function exportJSON(store, nodes) {\n  let rootNode;\n  const nodeMap = {};\n  const sceneGraph = store.get('sceneGraph');\n\n  forEach((nodeId) => {\n    const node = sceneGraph.nodes[nodeId];\n    if (!node) return;\n\n    const newNode = oldNodeJSON(node);\n    nodeMap[newNode._id] = newNode;\n    if (!rootNode) rootNode = newNode;\n\n    if (node.parent && nodeMap[node.parent]) {\n      nodeMap[node.parent].nodes.push(newNode);\n    }\n  }, nodes);\n\n  return rootNode;\n};\n\n//export function importMaterial(id) {\n//  return ({dispatch, getState}) => {\n//    // let sceneId = getState().getIn(['scene','id']);\n//    return dispatch(fetchMaterial(id)).then((mat) => {\n//      return dispatch(addNode({...mat, plugs: {\n//        Material: [['Material', {color: {r: 1, g: 0, b: 0}}]]\n//      }, parent: 'materiallibrary'}));\n//    }).catch((err) => {\n//      // console.log('handle rejected promise?', err);\n//      return false;\n//      // throw err;\n//    });\n//  }\n//}\n\nexport function updateNodeTransform(store, nodeId, newTransform) {\n  var parentNodeId = findParent(store, nodeId);\n\n  //const parent = store.getIn(['sceneGraph',parentNode.get('id'),'parent']);\n  var parentWorldTransform = getWorldTransform(store, parentNodeId);\n  //console.log( 'parentWorldTransform', parentWorldTransform );\n\n  var position = new THREE.Vector3(), quaternion = new THREE.Quaternion(), scale = new THREE.Vector3();\n\n  var tempTransform = new THREE.Matrix4();\n  tempTransform.copy(newTransform);\n\n  if (parentWorldTransform) {\n    var invParentWorldTransform = new THREE.Matrix4();\n    invParentWorldTransform.getInverse(parentWorldTransform, true);\n    tempTransform.multiplyMatrices(invParentWorldTransform, tempTransform);\n  }\n\n  tempTransform.decompose(position, quaternion, scale);\n  //console.log( 'position', JSON.stringify( position ) );\n  //console.log( 'scale', JSON.stringify( scale ) );\n  var euler = new THREE.Euler().setFromQuaternion(quaternion, 'ZYX');\n  //console.log( 'euler', JSON.stringify( euler ) );\n\n\n  //let translation = node.getIn(['plugs','Transform',0,'translation']);\n  //let rotation = node.getIn(['plugs','Transform',0,'rotation']);\n  store.dispatch(\n    set([nodeId, 'Transform', 0, 'translation'],\n      { x: position.x, y: position.y, z: position.z })\n    );\n  store.dispatch(\n    set([nodeId, 'Transform', 0, 'rotation'],\n      { x: THREE.Math.radToDeg(euler.x), y: THREE.Math.radToDeg(euler.y), z: THREE.Math.radToDeg(euler.z) })\n    );\n}\n\nexport function getEvalSceneGraph(store) {\n  const sceneGraph = store.get('sceneGraph');\n\n  if (sceneGraph._v === sceneGraph._ev) {\n    return sceneGraph;\n  }\n\n  const sceneId = store.getIn(['sceneIO', 'id']); // getSceneId\n  //console.log('updateSceneGraph', sceneGraph._ev, 'from', sceneGraph._v);\n  evaluateSceneGraph(store, sceneId, sceneGraph);\n  return sceneGraph;\n};\n\nconst publicApi = {\n  reducer,\n  actions: { set, merge, multi, addNode, deleteNode, reparent, clone, setVRCamera, addOperator },\n  selectors: { get, exportJSON, getVRCamera },\n};\nexport default publicApi;\n\nexport {\n  virtualCameraId as virtualCameraId,\n  vrCameraId as vrCameraId,\n  virtualTargetId as virtualTargetId,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/sceneGraph.js","//     uuid.js\n//\n//     Copyright (c) 2010-2012 Robert Kieffer\n//     MIT License - http://opensource.org/licenses/mit-license.php\n\n/*global window, require, define */\n(function(_window) {\n  'use strict';\n\n  // Unique ID creation requires a high quality random # generator.  We feature\n  // detect to determine the best RNG source, normalizing to a function that\n  // returns 128-bits of randomness, since that's what's usually required\n  var _rng, _mathRNG, _nodeRNG, _whatwgRNG, _previousRoot;\n\n  function setupBrowser() {\n    // Allow for MSIE11 msCrypto\n    var _crypto = _window.crypto || _window.msCrypto;\n\n    if (!_rng && _crypto && _crypto.getRandomValues) {\n      // WHATWG crypto-based RNG - http://wiki.whatwg.org/wiki/Crypto\n      //\n      // Moderately fast, high quality\n      try {\n        var _rnds8 = new Uint8Array(16);\n        _whatwgRNG = _rng = function whatwgRNG() {\n          _crypto.getRandomValues(_rnds8);\n          return _rnds8;\n        };\n        _rng();\n      } catch(e) {}\n    }\n\n    if (!_rng) {\n      // Math.random()-based (RNG)\n      //\n      // If all else fails, use Math.random().  It's fast, but is of unspecified\n      // quality.\n      var  _rnds = new Array(16);\n      _mathRNG = _rng = function() {\n        for (var i = 0, r; i < 16; i++) {\n          if ((i & 0x03) === 0) { r = Math.random() * 0x100000000; }\n          _rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n        }\n\n        return _rnds;\n      };\n      if ('undefined' !== typeof console && console.warn) {\n        console.warn(\"[SECURITY] node-uuid: crypto not usable, falling back to insecure Math.random()\");\n      }\n    }\n  }\n\n  function setupNode() {\n    // Node.js crypto-based RNG - http://nodejs.org/docs/v0.6.2/api/crypto.html\n    //\n    // Moderately fast, high quality\n    if ('function' === typeof require) {\n      try {\n        var _rb = require('crypto').randomBytes;\n        _nodeRNG = _rng = _rb && function() {return _rb(16);};\n        _rng();\n      } catch(e) {}\n    }\n  }\n\n  if (_window) {\n    setupBrowser();\n  } else {\n    setupNode();\n  }\n\n  // Buffer class to use\n  var BufferClass = ('function' === typeof Buffer) ? Buffer : Array;\n\n  // Maps for number <-> hex string conversion\n  var _byteToHex = [];\n  var _hexToByte = {};\n  for (var i = 0; i < 256; i++) {\n    _byteToHex[i] = (i + 0x100).toString(16).substr(1);\n    _hexToByte[_byteToHex[i]] = i;\n  }\n\n  // **`parse()` - Parse a UUID into it's component bytes**\n  function parse(s, buf, offset) {\n    var i = (buf && offset) || 0, ii = 0;\n\n    buf = buf || [];\n    s.toLowerCase().replace(/[0-9a-f]{2}/g, function(oct) {\n      if (ii < 16) { // Don't overflow!\n        buf[i + ii++] = _hexToByte[oct];\n      }\n    });\n\n    // Zero out remaining bytes if string was short\n    while (ii < 16) {\n      buf[i + ii++] = 0;\n    }\n\n    return buf;\n  }\n\n  // **`unparse()` - Convert UUID byte array (ala parse()) into a string**\n  function unparse(buf, offset) {\n    var i = offset || 0, bth = _byteToHex;\n    return  bth[buf[i++]] + bth[buf[i++]] +\n            bth[buf[i++]] + bth[buf[i++]] + '-' +\n            bth[buf[i++]] + bth[buf[i++]] + '-' +\n            bth[buf[i++]] + bth[buf[i++]] + '-' +\n            bth[buf[i++]] + bth[buf[i++]] + '-' +\n            bth[buf[i++]] + bth[buf[i++]] +\n            bth[buf[i++]] + bth[buf[i++]] +\n            bth[buf[i++]] + bth[buf[i++]];\n  }\n\n  // **`v1()` - Generate time-based UUID**\n  //\n  // Inspired by https://github.com/LiosK/UUID.js\n  // and http://docs.python.org/library/uuid.html\n\n  // random #'s we need to init node and clockseq\n  var _seedBytes = _rng();\n\n  // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n  var _nodeId = [\n    _seedBytes[0] | 0x01,\n    _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n  ];\n\n  // Per 4.2.2, randomize (14 bit) clockseq\n  var _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n  // Previous uuid creation time\n  var _lastMSecs = 0, _lastNSecs = 0;\n\n  // See https://github.com/broofa/node-uuid for API details\n  function v1(options, buf, offset) {\n    var i = buf && offset || 0;\n    var b = buf || [];\n\n    options = options || {};\n\n    var clockseq = (options.clockseq != null) ? options.clockseq : _clockseq;\n\n    // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n    // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n    // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n    // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n    var msecs = (options.msecs != null) ? options.msecs : new Date().getTime();\n\n    // Per 4.2.1.2, use count of uuid's generated during the current clock\n    // cycle to simulate higher resolution clock\n    var nsecs = (options.nsecs != null) ? options.nsecs : _lastNSecs + 1;\n\n    // Time since last uuid creation (in msecs)\n    var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n    // Per 4.2.1.2, Bump clockseq on clock regression\n    if (dt < 0 && options.clockseq == null) {\n      clockseq = clockseq + 1 & 0x3fff;\n    }\n\n    // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n    // time interval\n    if ((dt < 0 || msecs > _lastMSecs) && options.nsecs == null) {\n      nsecs = 0;\n    }\n\n    // Per 4.2.1.2 Throw error if too many uuids are requested\n    if (nsecs >= 10000) {\n      throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n    }\n\n    _lastMSecs = msecs;\n    _lastNSecs = nsecs;\n    _clockseq = clockseq;\n\n    // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n    msecs += 12219292800000;\n\n    // `time_low`\n    var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n    b[i++] = tl >>> 24 & 0xff;\n    b[i++] = tl >>> 16 & 0xff;\n    b[i++] = tl >>> 8 & 0xff;\n    b[i++] = tl & 0xff;\n\n    // `time_mid`\n    var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n    b[i++] = tmh >>> 8 & 0xff;\n    b[i++] = tmh & 0xff;\n\n    // `time_high_and_version`\n    b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n    b[i++] = tmh >>> 16 & 0xff;\n\n    // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n    b[i++] = clockseq >>> 8 | 0x80;\n\n    // `clock_seq_low`\n    b[i++] = clockseq & 0xff;\n\n    // `node`\n    var node = options.node || _nodeId;\n    for (var n = 0; n < 6; n++) {\n      b[i + n] = node[n];\n    }\n\n    return buf ? buf : unparse(b);\n  }\n\n  // **`v4()` - Generate random UUID**\n\n  // See https://github.com/broofa/node-uuid for API details\n  function v4(options, buf, offset) {\n    // Deprecated - 'format' argument, as supported in v1.2\n    var i = buf && offset || 0;\n\n    if (typeof(options) === 'string') {\n      buf = (options === 'binary') ? new BufferClass(16) : null;\n      options = null;\n    }\n    options = options || {};\n\n    var rnds = options.random || (options.rng || _rng)();\n\n    // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n    // Copy bytes to buffer, if provided\n    if (buf) {\n      for (var ii = 0; ii < 16; ii++) {\n        buf[i + ii] = rnds[ii];\n      }\n    }\n\n    return buf || unparse(rnds);\n  }\n\n  // Export public API\n  var uuid = v4;\n  uuid.v1 = v1;\n  uuid.v4 = v4;\n  uuid.parse = parse;\n  uuid.unparse = unparse;\n  uuid.BufferClass = BufferClass;\n  uuid._rng = _rng;\n  uuid._mathRNG = _mathRNG;\n  uuid._nodeRNG = _nodeRNG;\n  uuid._whatwgRNG = _whatwgRNG;\n\n  if (('undefined' !== typeof module) && module.exports) {\n    // Publish as node.js module\n    module.exports = uuid;\n  } else if (typeof define === 'function' && define.amd) {\n    // Publish as AMD module\n    define(function() {return uuid;});\n\n\n  } else {\n    // Publish as global (in browsers)\n    _previousRoot = _window.uuid;\n\n    // **`noConflict()` - (browser only) to reset global 'uuid' var**\n    uuid.noConflict = function() {\n      _window.uuid = _previousRoot;\n      return uuid;\n    };\n\n    _window.uuid = uuid;\n  }\n})('undefined' !== typeof window ? window : null);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/node-uuid/uuid.js\n// module id = 145\n// module chunks = 0 1 2","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/buffer/index.js\n// module id = 146\n// module chunks = 0 1 2","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction placeHoldersCount (b64) {\n  var len = b64.length\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // the number of equal signs (place holders)\n  // if there are two placeholders, than the two characters before it\n  // represent one byte\n  // if there is only one, then the three characters before it represent 2 bytes\n  // this is just a cheap hack to not do indexOf twice\n  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0\n}\n\nfunction byteLength (b64) {\n  // base64 is 4/3 + up to two characters of the original data\n  return b64.length * 3 / 4 - placeHoldersCount(b64)\n}\n\nfunction toByteArray (b64) {\n  var i, j, l, tmp, placeHolders, arr\n  var len = b64.length\n  placeHolders = placeHoldersCount(b64)\n\n  arr = new Arr(len * 3 / 4 - placeHolders)\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  l = placeHolders > 0 ? len - 4 : len\n\n  var L = 0\n\n  for (i = 0, j = 0; i < l; i += 4, j += 3) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]\n    arr[L++] = (tmp >> 16) & 0xFF\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  if (placeHolders === 2) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[L++] = tmp & 0xFF\n  } else if (placeHolders === 1) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var output = ''\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    output += lookup[tmp >> 2]\n    output += lookup[(tmp << 4) & 0x3F]\n    output += '=='\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])\n    output += lookup[tmp >> 10]\n    output += lookup[(tmp >> 4) & 0x3F]\n    output += lookup[(tmp << 2) & 0x3F]\n    output += '='\n  }\n\n  parts.push(output)\n\n  return parts.join('')\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/base64-js/index.js\n// module id = 147\n// module chunks = 0 1 2","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/ieee754/index.js\n// module id = 148\n// module chunks = 0 1 2","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/buffer/~/isarray/index.js\n// module id = 149\n// module chunks = 0 1 2","var rng = require('./rng')\n\nfunction error () {\n  var m = [].slice.call(arguments).join(' ')\n  throw new Error([\n    m,\n    'we accept pull requests',\n    'http://github.com/dominictarr/crypto-browserify'\n    ].join('\\n'))\n}\n\nexports.createHash = require('./create-hash')\n\nexports.createHmac = require('./create-hmac')\n\nexports.randomBytes = function(size, callback) {\n  if (callback && callback.call) {\n    try {\n      callback.call(this, undefined, new Buffer(rng(size)))\n    } catch (err) { callback(err) }\n  } else {\n    return new Buffer(rng(size))\n  }\n}\n\nfunction each(a, f) {\n  for(var i in a)\n    f(a[i], i)\n}\n\nexports.getHashes = function () {\n  return ['sha1', 'sha256', 'sha512', 'md5', 'rmd160']\n}\n\nvar p = require('./pbkdf2')(exports)\nexports.pbkdf2 = p.pbkdf2\nexports.pbkdf2Sync = p.pbkdf2Sync\n\n\n// the least I can do is make error messages for the rest of the node.js/crypto api.\neach(['createCredentials'\n, 'createCipher'\n, 'createCipheriv'\n, 'createDecipher'\n, 'createDecipheriv'\n, 'createSign'\n, 'createVerify'\n, 'createDiffieHellman'\n], function (name) {\n  exports[name] = function () {\n    error('sorry,', name, 'is not implemented yet')\n  }\n})\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/crypto-browserify/index.js\n// module id = 150\n// module chunks = 0 1 2","(function() {\n  var g = ('undefined' === typeof window ? global : window) || {}\n  _crypto = (\n    g.crypto || g.msCrypto || require('crypto')\n  )\n  module.exports = function(size) {\n    // Modern Browsers\n    if(_crypto.getRandomValues) {\n      var bytes = new Buffer(size); //in browserify, this is an extended Uint8Array\n      /* This will not work in older browsers.\n       * See https://developer.mozilla.org/en-US/docs/Web/API/window.crypto.getRandomValues\n       */\n    \n      _crypto.getRandomValues(bytes);\n      return bytes;\n    }\n    else if (_crypto.randomBytes) {\n      return _crypto.randomBytes(size)\n    }\n    else\n      throw new Error(\n        'secure random number generation not supported by this browser\\n'+\n        'use chrome, FireFox or Internet Explorer 11'\n      )\n  }\n}())\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/crypto-browserify/rng.js\n// module id = 151\n// module chunks = 0 1 2","var createHash = require('sha.js')\n\nvar md5 = toConstructor(require('./md5'))\nvar rmd160 = toConstructor(require('ripemd160'))\n\nfunction toConstructor (fn) {\n  return function () {\n    var buffers = []\n    var m= {\n      update: function (data, enc) {\n        if(!Buffer.isBuffer(data)) data = new Buffer(data, enc)\n        buffers.push(data)\n        return this\n      },\n      digest: function (enc) {\n        var buf = Buffer.concat(buffers)\n        var r = fn(buf)\n        buffers = null\n        return enc ? r.toString(enc) : r\n      }\n    }\n    return m\n  }\n}\n\nmodule.exports = function (alg) {\n  if('md5' === alg) return new md5()\n  if('rmd160' === alg) return new rmd160()\n  return createHash(alg)\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/crypto-browserify/create-hash.js\n// module id = 153\n// module chunks = 0 1 2","var exports = module.exports = function (alg) {\n  var Alg = exports[alg]\n  if(!Alg) throw new Error(alg + ' is not supported (we accept pull requests)')\n  return new Alg()\n}\n\nvar Buffer = require('buffer').Buffer\nvar Hash   = require('./hash')(Buffer)\n\nexports.sha1 = require('./sha1')(Buffer, Hash)\nexports.sha256 = require('./sha256')(Buffer, Hash)\nexports.sha512 = require('./sha512')(Buffer, Hash)\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/sha.js/index.js\n// module id = 154\n// module chunks = 0 1 2","module.exports = function (Buffer) {\n\n  //prototype class for hash functions\n  function Hash (blockSize, finalSize) {\n    this._block = new Buffer(blockSize) //new Uint32Array(blockSize/4)\n    this._finalSize = finalSize\n    this._blockSize = blockSize\n    this._len = 0\n    this._s = 0\n  }\n\n  Hash.prototype.init = function () {\n    this._s = 0\n    this._len = 0\n  }\n\n  Hash.prototype.update = function (data, enc) {\n    if (\"string\" === typeof data) {\n      enc = enc || \"utf8\"\n      data = new Buffer(data, enc)\n    }\n\n    var l = this._len += data.length\n    var s = this._s = (this._s || 0)\n    var f = 0\n    var buffer = this._block\n\n    while (s < l) {\n      var t = Math.min(data.length, f + this._blockSize - (s % this._blockSize))\n      var ch = (t - f)\n\n      for (var i = 0; i < ch; i++) {\n        buffer[(s % this._blockSize) + i] = data[i + f]\n      }\n\n      s += ch\n      f += ch\n\n      if ((s % this._blockSize) === 0) {\n        this._update(buffer)\n      }\n    }\n    this._s = s\n\n    return this\n  }\n\n  Hash.prototype.digest = function (enc) {\n    // Suppose the length of the message M, in bits, is l\n    var l = this._len * 8\n\n    // Append the bit 1 to the end of the message\n    this._block[this._len % this._blockSize] = 0x80\n\n    // and then k zero bits, where k is the smallest non-negative solution to the equation (l + 1 + k) === finalSize mod blockSize\n    this._block.fill(0, this._len % this._blockSize + 1)\n\n    if (l % (this._blockSize * 8) >= this._finalSize * 8) {\n      this._update(this._block)\n      this._block.fill(0)\n    }\n\n    // to this append the block which is equal to the number l written in binary\n    // TODO: handle case where l is > Math.pow(2, 29)\n    this._block.writeInt32BE(l, this._blockSize - 4)\n\n    var hash = this._update(this._block) || this._hash()\n\n    return enc ? hash.toString(enc) : hash\n  }\n\n  Hash.prototype._update = function () {\n    throw new Error('_update must be implemented by subclass')\n  }\n\n  return Hash\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/sha.js/hash.js\n// module id = 155\n// module chunks = 0 1 2","/*\n * A JavaScript implementation of the Secure Hash Algorithm, SHA-1, as defined\n * in FIPS PUB 180-1\n * Version 2.1a Copyright Paul Johnston 2000 - 2002.\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for details.\n */\n\nvar inherits = require('util').inherits\n\nmodule.exports = function (Buffer, Hash) {\n\n  var A = 0|0\n  var B = 4|0\n  var C = 8|0\n  var D = 12|0\n  var E = 16|0\n\n  var W = new (typeof Int32Array === 'undefined' ? Array : Int32Array)(80)\n\n  var POOL = []\n\n  function Sha1 () {\n    if(POOL.length)\n      return POOL.pop().init()\n\n    if(!(this instanceof Sha1)) return new Sha1()\n    this._w = W\n    Hash.call(this, 16*4, 14*4)\n\n    this._h = null\n    this.init()\n  }\n\n  inherits(Sha1, Hash)\n\n  Sha1.prototype.init = function () {\n    this._a = 0x67452301\n    this._b = 0xefcdab89\n    this._c = 0x98badcfe\n    this._d = 0x10325476\n    this._e = 0xc3d2e1f0\n\n    Hash.prototype.init.call(this)\n    return this\n  }\n\n  Sha1.prototype._POOL = POOL\n  Sha1.prototype._update = function (X) {\n\n    var a, b, c, d, e, _a, _b, _c, _d, _e\n\n    a = _a = this._a\n    b = _b = this._b\n    c = _c = this._c\n    d = _d = this._d\n    e = _e = this._e\n\n    var w = this._w\n\n    for(var j = 0; j < 80; j++) {\n      var W = w[j] = j < 16 ? X.readInt32BE(j*4)\n        : rol(w[j - 3] ^ w[j -  8] ^ w[j - 14] ^ w[j - 16], 1)\n\n      var t = add(\n        add(rol(a, 5), sha1_ft(j, b, c, d)),\n        add(add(e, W), sha1_kt(j))\n      )\n\n      e = d\n      d = c\n      c = rol(b, 30)\n      b = a\n      a = t\n    }\n\n    this._a = add(a, _a)\n    this._b = add(b, _b)\n    this._c = add(c, _c)\n    this._d = add(d, _d)\n    this._e = add(e, _e)\n  }\n\n  Sha1.prototype._hash = function () {\n    if(POOL.length < 100) POOL.push(this)\n    var H = new Buffer(20)\n    //console.log(this._a|0, this._b|0, this._c|0, this._d|0, this._e|0)\n    H.writeInt32BE(this._a|0, A)\n    H.writeInt32BE(this._b|0, B)\n    H.writeInt32BE(this._c|0, C)\n    H.writeInt32BE(this._d|0, D)\n    H.writeInt32BE(this._e|0, E)\n    return H\n  }\n\n  /*\n   * Perform the appropriate triplet combination function for the current\n   * iteration\n   */\n  function sha1_ft(t, b, c, d) {\n    if(t < 20) return (b & c) | ((~b) & d);\n    if(t < 40) return b ^ c ^ d;\n    if(t < 60) return (b & c) | (b & d) | (c & d);\n    return b ^ c ^ d;\n  }\n\n  /*\n   * Determine the appropriate additive constant for the current iteration\n   */\n  function sha1_kt(t) {\n    return (t < 20) ?  1518500249 : (t < 40) ?  1859775393 :\n           (t < 60) ? -1894007588 : -899497514;\n  }\n\n  /*\n   * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n   * to work around bugs in some JS interpreters.\n   * //dominictarr: this is 10 years old, so maybe this can be dropped?)\n   *\n   */\n  function add(x, y) {\n    return (x + y ) | 0\n  //lets see how this goes on testling.\n  //  var lsw = (x & 0xFFFF) + (y & 0xFFFF);\n  //  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  //  return (msw << 16) | (lsw & 0xFFFF);\n  }\n\n  /*\n   * Bitwise rotate a 32-bit number to the left.\n   */\n  function rol(num, cnt) {\n    return (num << cnt) | (num >>> (32 - cnt));\n  }\n\n  return Sha1\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/sha.js/sha1.js\n// module id = 156\n// module chunks = 0 1 2","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/util/util.js\n// module id = 157\n// module chunks = 0 1 2","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/util/support/isBufferBrowser.js\n// module id = 158\n// module chunks = 0 1 2","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/inherits/inherits_browser.js\n// module id = 159\n// module chunks = 0 1 2","\n/**\n * A JavaScript implementation of the Secure Hash Algorithm, SHA-256, as defined\n * in FIPS 180-2\n * Version 2.2-beta Copyright Angel Marin, Paul Johnston 2000 - 2009.\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n *\n */\n\nvar inherits = require('util').inherits\n\nmodule.exports = function (Buffer, Hash) {\n\n  var K = [\n      0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5,\n      0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5,\n      0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3,\n      0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174,\n      0xE49B69C1, 0xEFBE4786, 0x0FC19DC6, 0x240CA1CC,\n      0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA,\n      0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7,\n      0xC6E00BF3, 0xD5A79147, 0x06CA6351, 0x14292967,\n      0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13,\n      0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85,\n      0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3,\n      0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070,\n      0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5,\n      0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3,\n      0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208,\n      0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2\n    ]\n\n  var W = new Array(64)\n\n  function Sha256() {\n    this.init()\n\n    this._w = W //new Array(64)\n\n    Hash.call(this, 16*4, 14*4)\n  }\n\n  inherits(Sha256, Hash)\n\n  Sha256.prototype.init = function () {\n\n    this._a = 0x6a09e667|0\n    this._b = 0xbb67ae85|0\n    this._c = 0x3c6ef372|0\n    this._d = 0xa54ff53a|0\n    this._e = 0x510e527f|0\n    this._f = 0x9b05688c|0\n    this._g = 0x1f83d9ab|0\n    this._h = 0x5be0cd19|0\n\n    this._len = this._s = 0\n\n    return this\n  }\n\n  function S (X, n) {\n    return (X >>> n) | (X << (32 - n));\n  }\n\n  function R (X, n) {\n    return (X >>> n);\n  }\n\n  function Ch (x, y, z) {\n    return ((x & y) ^ ((~x) & z));\n  }\n\n  function Maj (x, y, z) {\n    return ((x & y) ^ (x & z) ^ (y & z));\n  }\n\n  function Sigma0256 (x) {\n    return (S(x, 2) ^ S(x, 13) ^ S(x, 22));\n  }\n\n  function Sigma1256 (x) {\n    return (S(x, 6) ^ S(x, 11) ^ S(x, 25));\n  }\n\n  function Gamma0256 (x) {\n    return (S(x, 7) ^ S(x, 18) ^ R(x, 3));\n  }\n\n  function Gamma1256 (x) {\n    return (S(x, 17) ^ S(x, 19) ^ R(x, 10));\n  }\n\n  Sha256.prototype._update = function(M) {\n\n    var W = this._w\n    var a, b, c, d, e, f, g, h\n    var T1, T2\n\n    a = this._a | 0\n    b = this._b | 0\n    c = this._c | 0\n    d = this._d | 0\n    e = this._e | 0\n    f = this._f | 0\n    g = this._g | 0\n    h = this._h | 0\n\n    for (var j = 0; j < 64; j++) {\n      var w = W[j] = j < 16\n        ? M.readInt32BE(j * 4)\n        : Gamma1256(W[j - 2]) + W[j - 7] + Gamma0256(W[j - 15]) + W[j - 16]\n\n      T1 = h + Sigma1256(e) + Ch(e, f, g) + K[j] + w\n\n      T2 = Sigma0256(a) + Maj(a, b, c);\n      h = g; g = f; f = e; e = d + T1; d = c; c = b; b = a; a = T1 + T2;\n    }\n\n    this._a = (a + this._a) | 0\n    this._b = (b + this._b) | 0\n    this._c = (c + this._c) | 0\n    this._d = (d + this._d) | 0\n    this._e = (e + this._e) | 0\n    this._f = (f + this._f) | 0\n    this._g = (g + this._g) | 0\n    this._h = (h + this._h) | 0\n\n  };\n\n  Sha256.prototype._hash = function () {\n    var H = new Buffer(32)\n\n    H.writeInt32BE(this._a,  0)\n    H.writeInt32BE(this._b,  4)\n    H.writeInt32BE(this._c,  8)\n    H.writeInt32BE(this._d, 12)\n    H.writeInt32BE(this._e, 16)\n    H.writeInt32BE(this._f, 20)\n    H.writeInt32BE(this._g, 24)\n    H.writeInt32BE(this._h, 28)\n\n    return H\n  }\n\n  return Sha256\n\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/sha.js/sha256.js\n// module id = 160\n// module chunks = 0 1 2","var inherits = require('util').inherits\n\nmodule.exports = function (Buffer, Hash) {\n  var K = [\n    0x428a2f98, 0xd728ae22, 0x71374491, 0x23ef65cd,\n    0xb5c0fbcf, 0xec4d3b2f, 0xe9b5dba5, 0x8189dbbc,\n    0x3956c25b, 0xf348b538, 0x59f111f1, 0xb605d019,\n    0x923f82a4, 0xaf194f9b, 0xab1c5ed5, 0xda6d8118,\n    0xd807aa98, 0xa3030242, 0x12835b01, 0x45706fbe,\n    0x243185be, 0x4ee4b28c, 0x550c7dc3, 0xd5ffb4e2,\n    0x72be5d74, 0xf27b896f, 0x80deb1fe, 0x3b1696b1,\n    0x9bdc06a7, 0x25c71235, 0xc19bf174, 0xcf692694,\n    0xe49b69c1, 0x9ef14ad2, 0xefbe4786, 0x384f25e3,\n    0x0fc19dc6, 0x8b8cd5b5, 0x240ca1cc, 0x77ac9c65,\n    0x2de92c6f, 0x592b0275, 0x4a7484aa, 0x6ea6e483,\n    0x5cb0a9dc, 0xbd41fbd4, 0x76f988da, 0x831153b5,\n    0x983e5152, 0xee66dfab, 0xa831c66d, 0x2db43210,\n    0xb00327c8, 0x98fb213f, 0xbf597fc7, 0xbeef0ee4,\n    0xc6e00bf3, 0x3da88fc2, 0xd5a79147, 0x930aa725,\n    0x06ca6351, 0xe003826f, 0x14292967, 0x0a0e6e70,\n    0x27b70a85, 0x46d22ffc, 0x2e1b2138, 0x5c26c926,\n    0x4d2c6dfc, 0x5ac42aed, 0x53380d13, 0x9d95b3df,\n    0x650a7354, 0x8baf63de, 0x766a0abb, 0x3c77b2a8,\n    0x81c2c92e, 0x47edaee6, 0x92722c85, 0x1482353b,\n    0xa2bfe8a1, 0x4cf10364, 0xa81a664b, 0xbc423001,\n    0xc24b8b70, 0xd0f89791, 0xc76c51a3, 0x0654be30,\n    0xd192e819, 0xd6ef5218, 0xd6990624, 0x5565a910,\n    0xf40e3585, 0x5771202a, 0x106aa070, 0x32bbd1b8,\n    0x19a4c116, 0xb8d2d0c8, 0x1e376c08, 0x5141ab53,\n    0x2748774c, 0xdf8eeb99, 0x34b0bcb5, 0xe19b48a8,\n    0x391c0cb3, 0xc5c95a63, 0x4ed8aa4a, 0xe3418acb,\n    0x5b9cca4f, 0x7763e373, 0x682e6ff3, 0xd6b2b8a3,\n    0x748f82ee, 0x5defb2fc, 0x78a5636f, 0x43172f60,\n    0x84c87814, 0xa1f0ab72, 0x8cc70208, 0x1a6439ec,\n    0x90befffa, 0x23631e28, 0xa4506ceb, 0xde82bde9,\n    0xbef9a3f7, 0xb2c67915, 0xc67178f2, 0xe372532b,\n    0xca273ece, 0xea26619c, 0xd186b8c7, 0x21c0c207,\n    0xeada7dd6, 0xcde0eb1e, 0xf57d4f7f, 0xee6ed178,\n    0x06f067aa, 0x72176fba, 0x0a637dc5, 0xa2c898a6,\n    0x113f9804, 0xbef90dae, 0x1b710b35, 0x131c471b,\n    0x28db77f5, 0x23047d84, 0x32caab7b, 0x40c72493,\n    0x3c9ebe0a, 0x15c9bebc, 0x431d67c4, 0x9c100d4c,\n    0x4cc5d4be, 0xcb3e42b6, 0x597f299c, 0xfc657e2a,\n    0x5fcb6fab, 0x3ad6faec, 0x6c44198c, 0x4a475817\n  ]\n\n  var W = new Array(160)\n\n  function Sha512() {\n    this.init()\n    this._w = W\n\n    Hash.call(this, 128, 112)\n  }\n\n  inherits(Sha512, Hash)\n\n  Sha512.prototype.init = function () {\n\n    this._a = 0x6a09e667|0\n    this._b = 0xbb67ae85|0\n    this._c = 0x3c6ef372|0\n    this._d = 0xa54ff53a|0\n    this._e = 0x510e527f|0\n    this._f = 0x9b05688c|0\n    this._g = 0x1f83d9ab|0\n    this._h = 0x5be0cd19|0\n\n    this._al = 0xf3bcc908|0\n    this._bl = 0x84caa73b|0\n    this._cl = 0xfe94f82b|0\n    this._dl = 0x5f1d36f1|0\n    this._el = 0xade682d1|0\n    this._fl = 0x2b3e6c1f|0\n    this._gl = 0xfb41bd6b|0\n    this._hl = 0x137e2179|0\n\n    this._len = this._s = 0\n\n    return this\n  }\n\n  function S (X, Xl, n) {\n    return (X >>> n) | (Xl << (32 - n))\n  }\n\n  function Ch (x, y, z) {\n    return ((x & y) ^ ((~x) & z));\n  }\n\n  function Maj (x, y, z) {\n    return ((x & y) ^ (x & z) ^ (y & z));\n  }\n\n  Sha512.prototype._update = function(M) {\n\n    var W = this._w\n    var a, b, c, d, e, f, g, h\n    var al, bl, cl, dl, el, fl, gl, hl\n\n    a = this._a | 0\n    b = this._b | 0\n    c = this._c | 0\n    d = this._d | 0\n    e = this._e | 0\n    f = this._f | 0\n    g = this._g | 0\n    h = this._h | 0\n\n    al = this._al | 0\n    bl = this._bl | 0\n    cl = this._cl | 0\n    dl = this._dl | 0\n    el = this._el | 0\n    fl = this._fl | 0\n    gl = this._gl | 0\n    hl = this._hl | 0\n\n    for (var i = 0; i < 80; i++) {\n      var j = i * 2\n\n      var Wi, Wil\n\n      if (i < 16) {\n        Wi = W[j] = M.readInt32BE(j * 4)\n        Wil = W[j + 1] = M.readInt32BE(j * 4 + 4)\n\n      } else {\n        var x  = W[j - 15*2]\n        var xl = W[j - 15*2 + 1]\n        var gamma0  = S(x, xl, 1) ^ S(x, xl, 8) ^ (x >>> 7)\n        var gamma0l = S(xl, x, 1) ^ S(xl, x, 8) ^ S(xl, x, 7)\n\n        x  = W[j - 2*2]\n        xl = W[j - 2*2 + 1]\n        var gamma1  = S(x, xl, 19) ^ S(xl, x, 29) ^ (x >>> 6)\n        var gamma1l = S(xl, x, 19) ^ S(x, xl, 29) ^ S(xl, x, 6)\n\n        // W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16]\n        var Wi7  = W[j - 7*2]\n        var Wi7l = W[j - 7*2 + 1]\n\n        var Wi16  = W[j - 16*2]\n        var Wi16l = W[j - 16*2 + 1]\n\n        Wil = gamma0l + Wi7l\n        Wi  = gamma0  + Wi7 + ((Wil >>> 0) < (gamma0l >>> 0) ? 1 : 0)\n        Wil = Wil + gamma1l\n        Wi  = Wi  + gamma1  + ((Wil >>> 0) < (gamma1l >>> 0) ? 1 : 0)\n        Wil = Wil + Wi16l\n        Wi  = Wi  + Wi16 + ((Wil >>> 0) < (Wi16l >>> 0) ? 1 : 0)\n\n        W[j] = Wi\n        W[j + 1] = Wil\n      }\n\n      var maj = Maj(a, b, c)\n      var majl = Maj(al, bl, cl)\n\n      var sigma0h = S(a, al, 28) ^ S(al, a, 2) ^ S(al, a, 7)\n      var sigma0l = S(al, a, 28) ^ S(a, al, 2) ^ S(a, al, 7)\n      var sigma1h = S(e, el, 14) ^ S(e, el, 18) ^ S(el, e, 9)\n      var sigma1l = S(el, e, 14) ^ S(el, e, 18) ^ S(e, el, 9)\n\n      // t1 = h + sigma1 + ch + K[i] + W[i]\n      var Ki = K[j]\n      var Kil = K[j + 1]\n\n      var ch = Ch(e, f, g)\n      var chl = Ch(el, fl, gl)\n\n      var t1l = hl + sigma1l\n      var t1 = h + sigma1h + ((t1l >>> 0) < (hl >>> 0) ? 1 : 0)\n      t1l = t1l + chl\n      t1 = t1 + ch + ((t1l >>> 0) < (chl >>> 0) ? 1 : 0)\n      t1l = t1l + Kil\n      t1 = t1 + Ki + ((t1l >>> 0) < (Kil >>> 0) ? 1 : 0)\n      t1l = t1l + Wil\n      t1 = t1 + Wi + ((t1l >>> 0) < (Wil >>> 0) ? 1 : 0)\n\n      // t2 = sigma0 + maj\n      var t2l = sigma0l + majl\n      var t2 = sigma0h + maj + ((t2l >>> 0) < (sigma0l >>> 0) ? 1 : 0)\n\n      h  = g\n      hl = gl\n      g  = f\n      gl = fl\n      f  = e\n      fl = el\n      el = (dl + t1l) | 0\n      e  = (d + t1 + ((el >>> 0) < (dl >>> 0) ? 1 : 0)) | 0\n      d  = c\n      dl = cl\n      c  = b\n      cl = bl\n      b  = a\n      bl = al\n      al = (t1l + t2l) | 0\n      a  = (t1 + t2 + ((al >>> 0) < (t1l >>> 0) ? 1 : 0)) | 0\n    }\n\n    this._al = (this._al + al) | 0\n    this._bl = (this._bl + bl) | 0\n    this._cl = (this._cl + cl) | 0\n    this._dl = (this._dl + dl) | 0\n    this._el = (this._el + el) | 0\n    this._fl = (this._fl + fl) | 0\n    this._gl = (this._gl + gl) | 0\n    this._hl = (this._hl + hl) | 0\n\n    this._a = (this._a + a + ((this._al >>> 0) < (al >>> 0) ? 1 : 0)) | 0\n    this._b = (this._b + b + ((this._bl >>> 0) < (bl >>> 0) ? 1 : 0)) | 0\n    this._c = (this._c + c + ((this._cl >>> 0) < (cl >>> 0) ? 1 : 0)) | 0\n    this._d = (this._d + d + ((this._dl >>> 0) < (dl >>> 0) ? 1 : 0)) | 0\n    this._e = (this._e + e + ((this._el >>> 0) < (el >>> 0) ? 1 : 0)) | 0\n    this._f = (this._f + f + ((this._fl >>> 0) < (fl >>> 0) ? 1 : 0)) | 0\n    this._g = (this._g + g + ((this._gl >>> 0) < (gl >>> 0) ? 1 : 0)) | 0\n    this._h = (this._h + h + ((this._hl >>> 0) < (hl >>> 0) ? 1 : 0)) | 0\n  }\n\n  Sha512.prototype._hash = function () {\n    var H = new Buffer(64)\n\n    function writeInt64BE(h, l, offset) {\n      H.writeInt32BE(h, offset)\n      H.writeInt32BE(l, offset + 4)\n    }\n\n    writeInt64BE(this._a, this._al, 0)\n    writeInt64BE(this._b, this._bl, 8)\n    writeInt64BE(this._c, this._cl, 16)\n    writeInt64BE(this._d, this._dl, 24)\n    writeInt64BE(this._e, this._el, 32)\n    writeInt64BE(this._f, this._fl, 40)\n    writeInt64BE(this._g, this._gl, 48)\n    writeInt64BE(this._h, this._hl, 56)\n\n    return H\n  }\n\n  return Sha512\n\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/sha.js/sha512.js\n// module id = 161\n// module chunks = 0 1 2","/*\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.1 Copyright (C) Paul Johnston 1999 - 2002.\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\n\nvar helpers = require('./helpers');\n\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length\n */\nfunction core_md5(x, len)\n{\n  /* append padding */\n  x[len >> 5] |= 0x80 << ((len) % 32);\n  x[(((len + 64) >>> 9) << 4) + 14] = len;\n\n  var a =  1732584193;\n  var b = -271733879;\n  var c = -1732584194;\n  var d =  271733878;\n\n  for(var i = 0; i < x.length; i += 16)\n  {\n    var olda = a;\n    var oldb = b;\n    var oldc = c;\n    var oldd = d;\n\n    a = md5_ff(a, b, c, d, x[i+ 0], 7 , -680876936);\n    d = md5_ff(d, a, b, c, x[i+ 1], 12, -389564586);\n    c = md5_ff(c, d, a, b, x[i+ 2], 17,  606105819);\n    b = md5_ff(b, c, d, a, x[i+ 3], 22, -1044525330);\n    a = md5_ff(a, b, c, d, x[i+ 4], 7 , -176418897);\n    d = md5_ff(d, a, b, c, x[i+ 5], 12,  1200080426);\n    c = md5_ff(c, d, a, b, x[i+ 6], 17, -1473231341);\n    b = md5_ff(b, c, d, a, x[i+ 7], 22, -45705983);\n    a = md5_ff(a, b, c, d, x[i+ 8], 7 ,  1770035416);\n    d = md5_ff(d, a, b, c, x[i+ 9], 12, -1958414417);\n    c = md5_ff(c, d, a, b, x[i+10], 17, -42063);\n    b = md5_ff(b, c, d, a, x[i+11], 22, -1990404162);\n    a = md5_ff(a, b, c, d, x[i+12], 7 ,  1804603682);\n    d = md5_ff(d, a, b, c, x[i+13], 12, -40341101);\n    c = md5_ff(c, d, a, b, x[i+14], 17, -1502002290);\n    b = md5_ff(b, c, d, a, x[i+15], 22,  1236535329);\n\n    a = md5_gg(a, b, c, d, x[i+ 1], 5 , -165796510);\n    d = md5_gg(d, a, b, c, x[i+ 6], 9 , -1069501632);\n    c = md5_gg(c, d, a, b, x[i+11], 14,  643717713);\n    b = md5_gg(b, c, d, a, x[i+ 0], 20, -373897302);\n    a = md5_gg(a, b, c, d, x[i+ 5], 5 , -701558691);\n    d = md5_gg(d, a, b, c, x[i+10], 9 ,  38016083);\n    c = md5_gg(c, d, a, b, x[i+15], 14, -660478335);\n    b = md5_gg(b, c, d, a, x[i+ 4], 20, -405537848);\n    a = md5_gg(a, b, c, d, x[i+ 9], 5 ,  568446438);\n    d = md5_gg(d, a, b, c, x[i+14], 9 , -1019803690);\n    c = md5_gg(c, d, a, b, x[i+ 3], 14, -187363961);\n    b = md5_gg(b, c, d, a, x[i+ 8], 20,  1163531501);\n    a = md5_gg(a, b, c, d, x[i+13], 5 , -1444681467);\n    d = md5_gg(d, a, b, c, x[i+ 2], 9 , -51403784);\n    c = md5_gg(c, d, a, b, x[i+ 7], 14,  1735328473);\n    b = md5_gg(b, c, d, a, x[i+12], 20, -1926607734);\n\n    a = md5_hh(a, b, c, d, x[i+ 5], 4 , -378558);\n    d = md5_hh(d, a, b, c, x[i+ 8], 11, -2022574463);\n    c = md5_hh(c, d, a, b, x[i+11], 16,  1839030562);\n    b = md5_hh(b, c, d, a, x[i+14], 23, -35309556);\n    a = md5_hh(a, b, c, d, x[i+ 1], 4 , -1530992060);\n    d = md5_hh(d, a, b, c, x[i+ 4], 11,  1272893353);\n    c = md5_hh(c, d, a, b, x[i+ 7], 16, -155497632);\n    b = md5_hh(b, c, d, a, x[i+10], 23, -1094730640);\n    a = md5_hh(a, b, c, d, x[i+13], 4 ,  681279174);\n    d = md5_hh(d, a, b, c, x[i+ 0], 11, -358537222);\n    c = md5_hh(c, d, a, b, x[i+ 3], 16, -722521979);\n    b = md5_hh(b, c, d, a, x[i+ 6], 23,  76029189);\n    a = md5_hh(a, b, c, d, x[i+ 9], 4 , -640364487);\n    d = md5_hh(d, a, b, c, x[i+12], 11, -421815835);\n    c = md5_hh(c, d, a, b, x[i+15], 16,  530742520);\n    b = md5_hh(b, c, d, a, x[i+ 2], 23, -995338651);\n\n    a = md5_ii(a, b, c, d, x[i+ 0], 6 , -198630844);\n    d = md5_ii(d, a, b, c, x[i+ 7], 10,  1126891415);\n    c = md5_ii(c, d, a, b, x[i+14], 15, -1416354905);\n    b = md5_ii(b, c, d, a, x[i+ 5], 21, -57434055);\n    a = md5_ii(a, b, c, d, x[i+12], 6 ,  1700485571);\n    d = md5_ii(d, a, b, c, x[i+ 3], 10, -1894986606);\n    c = md5_ii(c, d, a, b, x[i+10], 15, -1051523);\n    b = md5_ii(b, c, d, a, x[i+ 1], 21, -2054922799);\n    a = md5_ii(a, b, c, d, x[i+ 8], 6 ,  1873313359);\n    d = md5_ii(d, a, b, c, x[i+15], 10, -30611744);\n    c = md5_ii(c, d, a, b, x[i+ 6], 15, -1560198380);\n    b = md5_ii(b, c, d, a, x[i+13], 21,  1309151649);\n    a = md5_ii(a, b, c, d, x[i+ 4], 6 , -145523070);\n    d = md5_ii(d, a, b, c, x[i+11], 10, -1120210379);\n    c = md5_ii(c, d, a, b, x[i+ 2], 15,  718787259);\n    b = md5_ii(b, c, d, a, x[i+ 9], 21, -343485551);\n\n    a = safe_add(a, olda);\n    b = safe_add(b, oldb);\n    c = safe_add(c, oldc);\n    d = safe_add(d, oldd);\n  }\n  return Array(a, b, c, d);\n\n}\n\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\nfunction md5_cmn(q, a, b, x, s, t)\n{\n  return safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s),b);\n}\nfunction md5_ff(a, b, c, d, x, s, t)\n{\n  return md5_cmn((b & c) | ((~b) & d), a, b, x, s, t);\n}\nfunction md5_gg(a, b, c, d, x, s, t)\n{\n  return md5_cmn((b & d) | (c & (~d)), a, b, x, s, t);\n}\nfunction md5_hh(a, b, c, d, x, s, t)\n{\n  return md5_cmn(b ^ c ^ d, a, b, x, s, t);\n}\nfunction md5_ii(a, b, c, d, x, s, t)\n{\n  return md5_cmn(c ^ (b | (~d)), a, b, x, s, t);\n}\n\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\nfunction safe_add(x, y)\n{\n  var lsw = (x & 0xFFFF) + (y & 0xFFFF);\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return (msw << 16) | (lsw & 0xFFFF);\n}\n\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\nfunction bit_rol(num, cnt)\n{\n  return (num << cnt) | (num >>> (32 - cnt));\n}\n\nmodule.exports = function md5(buf) {\n  return helpers.hash(buf, core_md5, 16);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/crypto-browserify/md5.js\n// module id = 162\n// module chunks = 0 1 2","var intSize = 4;\nvar zeroBuffer = new Buffer(intSize); zeroBuffer.fill(0);\nvar chrsz = 8;\n\nfunction toArray(buf, bigEndian) {\n  if ((buf.length % intSize) !== 0) {\n    var len = buf.length + (intSize - (buf.length % intSize));\n    buf = Buffer.concat([buf, zeroBuffer], len);\n  }\n\n  var arr = [];\n  var fn = bigEndian ? buf.readInt32BE : buf.readInt32LE;\n  for (var i = 0; i < buf.length; i += intSize) {\n    arr.push(fn.call(buf, i));\n  }\n  return arr;\n}\n\nfunction toBuffer(arr, size, bigEndian) {\n  var buf = new Buffer(size);\n  var fn = bigEndian ? buf.writeInt32BE : buf.writeInt32LE;\n  for (var i = 0; i < arr.length; i++) {\n    fn.call(buf, arr[i], i * 4, true);\n  }\n  return buf;\n}\n\nfunction hash(buf, fn, hashSize, bigEndian) {\n  if (!Buffer.isBuffer(buf)) buf = new Buffer(buf);\n  var arr = fn(toArray(buf, bigEndian), buf.length * chrsz);\n  return toBuffer(arr, hashSize, bigEndian);\n}\n\nmodule.exports = { hash: hash };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/crypto-browserify/helpers.js\n// module id = 163\n// module chunks = 0 1 2","\nmodule.exports = ripemd160\n\n\n\n/*\nCryptoJS v3.1.2\ncode.google.com/p/crypto-js\n(c) 2009-2013 by Jeff Mott. All rights reserved.\ncode.google.com/p/crypto-js/wiki/License\n*/\n/** @preserve\n(c) 2012 by Cédric Mesnil. All rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n\n    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n// Constants table\nvar zl = [\n    0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15,\n    7,  4, 13,  1, 10,  6, 15,  3, 12,  0,  9,  5,  2, 14, 11,  8,\n    3, 10, 14,  4,  9, 15,  8,  1,  2,  7,  0,  6, 13, 11,  5, 12,\n    1,  9, 11, 10,  0,  8, 12,  4, 13,  3,  7, 15, 14,  5,  6,  2,\n    4,  0,  5,  9,  7, 12,  2, 10, 14,  1,  3,  8, 11,  6, 15, 13];\nvar zr = [\n    5, 14,  7,  0,  9,  2, 11,  4, 13,  6, 15,  8,  1, 10,  3, 12,\n    6, 11,  3,  7,  0, 13,  5, 10, 14, 15,  8, 12,  4,  9,  1,  2,\n    15,  5,  1,  3,  7, 14,  6,  9, 11,  8, 12,  2, 10,  0,  4, 13,\n    8,  6,  4,  1,  3, 11, 15,  0,  5, 12,  2, 13,  9,  7, 10, 14,\n    12, 15, 10,  4,  1,  5,  8,  7,  6,  2, 13, 14,  0,  3,  9, 11];\nvar sl = [\n     11, 14, 15, 12,  5,  8,  7,  9, 11, 13, 14, 15,  6,  7,  9,  8,\n    7, 6,   8, 13, 11,  9,  7, 15,  7, 12, 15,  9, 11,  7, 13, 12,\n    11, 13,  6,  7, 14,  9, 13, 15, 14,  8, 13,  6,  5, 12,  7,  5,\n      11, 12, 14, 15, 14, 15,  9,  8,  9, 14,  5,  6,  8,  6,  5, 12,\n    9, 15,  5, 11,  6,  8, 13, 12,  5, 12, 13, 14, 11,  8,  5,  6 ];\nvar sr = [\n    8,  9,  9, 11, 13, 15, 15,  5,  7,  7,  8, 11, 14, 14, 12,  6,\n    9, 13, 15,  7, 12,  8,  9, 11,  7,  7, 12,  7,  6, 15, 13, 11,\n    9,  7, 15, 11,  8,  6,  6, 14, 12, 13,  5, 14, 13, 13,  7,  5,\n    15,  5,  8, 11, 14, 14,  6, 14,  6,  9, 12,  9, 12,  5, 15,  8,\n    8,  5, 12,  9, 12,  5, 14,  6,  8, 13,  6,  5, 15, 13, 11, 11 ];\n\nvar hl =  [ 0x00000000, 0x5A827999, 0x6ED9EBA1, 0x8F1BBCDC, 0xA953FD4E];\nvar hr =  [ 0x50A28BE6, 0x5C4DD124, 0x6D703EF3, 0x7A6D76E9, 0x00000000];\n\nvar bytesToWords = function (bytes) {\n  var words = [];\n  for (var i = 0, b = 0; i < bytes.length; i++, b += 8) {\n    words[b >>> 5] |= bytes[i] << (24 - b % 32);\n  }\n  return words;\n};\n\nvar wordsToBytes = function (words) {\n  var bytes = [];\n  for (var b = 0; b < words.length * 32; b += 8) {\n    bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF);\n  }\n  return bytes;\n};\n\nvar processBlock = function (H, M, offset) {\n\n  // Swap endian\n  for (var i = 0; i < 16; i++) {\n    var offset_i = offset + i;\n    var M_offset_i = M[offset_i];\n\n    // Swap\n    M[offset_i] = (\n        (((M_offset_i << 8)  | (M_offset_i >>> 24)) & 0x00ff00ff) |\n        (((M_offset_i << 24) | (M_offset_i >>> 8))  & 0xff00ff00)\n    );\n  }\n\n  // Working variables\n  var al, bl, cl, dl, el;\n  var ar, br, cr, dr, er;\n\n  ar = al = H[0];\n  br = bl = H[1];\n  cr = cl = H[2];\n  dr = dl = H[3];\n  er = el = H[4];\n  // Computation\n  var t;\n  for (var i = 0; i < 80; i += 1) {\n    t = (al +  M[offset+zl[i]])|0;\n    if (i<16){\n        t +=  f1(bl,cl,dl) + hl[0];\n    } else if (i<32) {\n        t +=  f2(bl,cl,dl) + hl[1];\n    } else if (i<48) {\n        t +=  f3(bl,cl,dl) + hl[2];\n    } else if (i<64) {\n        t +=  f4(bl,cl,dl) + hl[3];\n    } else {// if (i<80) {\n        t +=  f5(bl,cl,dl) + hl[4];\n    }\n    t = t|0;\n    t =  rotl(t,sl[i]);\n    t = (t+el)|0;\n    al = el;\n    el = dl;\n    dl = rotl(cl, 10);\n    cl = bl;\n    bl = t;\n\n    t = (ar + M[offset+zr[i]])|0;\n    if (i<16){\n        t +=  f5(br,cr,dr) + hr[0];\n    } else if (i<32) {\n        t +=  f4(br,cr,dr) + hr[1];\n    } else if (i<48) {\n        t +=  f3(br,cr,dr) + hr[2];\n    } else if (i<64) {\n        t +=  f2(br,cr,dr) + hr[3];\n    } else {// if (i<80) {\n        t +=  f1(br,cr,dr) + hr[4];\n    }\n    t = t|0;\n    t =  rotl(t,sr[i]) ;\n    t = (t+er)|0;\n    ar = er;\n    er = dr;\n    dr = rotl(cr, 10);\n    cr = br;\n    br = t;\n  }\n  // Intermediate hash value\n  t    = (H[1] + cl + dr)|0;\n  H[1] = (H[2] + dl + er)|0;\n  H[2] = (H[3] + el + ar)|0;\n  H[3] = (H[4] + al + br)|0;\n  H[4] = (H[0] + bl + cr)|0;\n  H[0] =  t;\n};\n\nfunction f1(x, y, z) {\n  return ((x) ^ (y) ^ (z));\n}\n\nfunction f2(x, y, z) {\n  return (((x)&(y)) | ((~x)&(z)));\n}\n\nfunction f3(x, y, z) {\n  return (((x) | (~(y))) ^ (z));\n}\n\nfunction f4(x, y, z) {\n  return (((x) & (z)) | ((y)&(~(z))));\n}\n\nfunction f5(x, y, z) {\n  return ((x) ^ ((y) |(~(z))));\n}\n\nfunction rotl(x,n) {\n  return (x<<n) | (x>>>(32-n));\n}\n\nfunction ripemd160(message) {\n  var H = [0x67452301, 0xEFCDAB89, 0x98BADCFE, 0x10325476, 0xC3D2E1F0];\n\n  if (typeof message == 'string')\n    message = new Buffer(message, 'utf8');\n\n  var m = bytesToWords(message);\n\n  var nBitsLeft = message.length * 8;\n  var nBitsTotal = message.length * 8;\n\n  // Add padding\n  m[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);\n  m[(((nBitsLeft + 64) >>> 9) << 4) + 14] = (\n      (((nBitsTotal << 8)  | (nBitsTotal >>> 24)) & 0x00ff00ff) |\n      (((nBitsTotal << 24) | (nBitsTotal >>> 8))  & 0xff00ff00)\n  );\n\n  for (var i=0 ; i<m.length; i += 16) {\n    processBlock(H, m, i);\n  }\n\n  // Swap endian\n  for (var i = 0; i < 5; i++) {\n      // Shortcut\n    var H_i = H[i];\n\n    // Swap\n    H[i] = (((H_i << 8)  | (H_i >>> 24)) & 0x00ff00ff) |\n          (((H_i << 24) | (H_i >>> 8))  & 0xff00ff00);\n  }\n\n  var digestbytes = wordsToBytes(H);\n  return new Buffer(digestbytes);\n}\n\n\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/ripemd160/lib/ripemd160.js\n// module id = 164\n// module chunks = 0 1 2","var createHash = require('./create-hash')\n\nvar zeroBuffer = new Buffer(128)\nzeroBuffer.fill(0)\n\nmodule.exports = Hmac\n\nfunction Hmac (alg, key) {\n  if(!(this instanceof Hmac)) return new Hmac(alg, key)\n  this._opad = opad\n  this._alg = alg\n\n  var blocksize = (alg === 'sha512') ? 128 : 64\n\n  key = this._key = !Buffer.isBuffer(key) ? new Buffer(key) : key\n\n  if(key.length > blocksize) {\n    key = createHash(alg).update(key).digest()\n  } else if(key.length < blocksize) {\n    key = Buffer.concat([key, zeroBuffer], blocksize)\n  }\n\n  var ipad = this._ipad = new Buffer(blocksize)\n  var opad = this._opad = new Buffer(blocksize)\n\n  for(var i = 0; i < blocksize; i++) {\n    ipad[i] = key[i] ^ 0x36\n    opad[i] = key[i] ^ 0x5C\n  }\n\n  this._hash = createHash(alg).update(ipad)\n}\n\nHmac.prototype.update = function (data, enc) {\n  this._hash.update(data, enc)\n  return this\n}\n\nHmac.prototype.digest = function (enc) {\n  var h = this._hash.digest()\n  return createHash(this._alg).update(this._opad).update(h).digest(enc)\n}\n\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/crypto-browserify/create-hmac.js\n// module id = 165\n// module chunks = 0 1 2","var pbkdf2Export = require('pbkdf2-compat/pbkdf2')\n\nmodule.exports = function (crypto, exports) {\n  exports = exports || {}\n\n  var exported = pbkdf2Export(crypto)\n\n  exports.pbkdf2 = exported.pbkdf2\n  exports.pbkdf2Sync = exported.pbkdf2Sync\n\n  return exports\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/crypto-browserify/pbkdf2.js\n// module id = 166\n// module chunks = 0 1 2","module.exports = function(crypto) {\n  function pbkdf2(password, salt, iterations, keylen, digest, callback) {\n    if ('function' === typeof digest) {\n      callback = digest\n      digest = undefined\n    }\n\n    if ('function' !== typeof callback)\n      throw new Error('No callback provided to pbkdf2')\n\n    setTimeout(function() {\n      var result\n\n      try {\n        result = pbkdf2Sync(password, salt, iterations, keylen, digest)\n      } catch (e) {\n        return callback(e)\n      }\n\n      callback(undefined, result)\n    })\n  }\n\n  function pbkdf2Sync(password, salt, iterations, keylen, digest) {\n    if ('number' !== typeof iterations)\n      throw new TypeError('Iterations not a number')\n\n    if (iterations < 0)\n      throw new TypeError('Bad iterations')\n\n    if ('number' !== typeof keylen)\n      throw new TypeError('Key length not a number')\n\n    if (keylen < 0)\n      throw new TypeError('Bad key length')\n\n    digest = digest || 'sha1'\n\n    if (!Buffer.isBuffer(password)) password = new Buffer(password)\n    if (!Buffer.isBuffer(salt)) salt = new Buffer(salt)\n\n    var hLen, l = 1, r, T\n    var DK = new Buffer(keylen)\n    var block1 = new Buffer(salt.length + 4)\n    salt.copy(block1, 0, 0, salt.length)\n\n    for (var i = 1; i <= l; i++) {\n      block1.writeUInt32BE(i, salt.length)\n\n      var U = crypto.createHmac(digest, password).update(block1).digest()\n\n      if (!hLen) {\n        hLen = U.length\n        T = new Buffer(hLen)\n        l = Math.ceil(keylen / hLen)\n        r = keylen - (l - 1) * hLen\n\n        if (keylen > (Math.pow(2, 32) - 1) * hLen)\n          throw new TypeError('keylen exceeds maximum length')\n      }\n\n      U.copy(T, 0, 0, hLen)\n\n      for (var j = 1; j < iterations; j++) {\n        U = crypto.createHmac(digest, password).update(U).digest()\n\n        for (var k = 0; k < hLen; k++) {\n          T[k] ^= U[k]\n        }\n      }\n\n      var destPos = (i - 1) * hLen\n      var len = (i == l ? r : hLen)\n      T.copy(DK, destPos, 0, len)\n    }\n\n    return DK\n  }\n\n  return {\n    pbkdf2: pbkdf2,\n    pbkdf2Sync: pbkdf2Sync\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/pbkdf2-compat/pbkdf2.js\n// module id = 167\n// module chunks = 0 1 2","import { Map } from 'immutable';\nimport { map } from 'ramda';\nimport createReducer from './utils/createReducer';\nimport { addNode, getEvalSceneGraph } from './sceneGraph';\nimport { find as sceneFind } from './scene';\nimport { LOAD_SCENE, LOADING_FILE, LOADED_FILE, LOADING_FILE_ERROR } from './actionTypes';\nimport { isUuid } from './utils/selectors';\n\n/**\n * Managing assets\n *\n * @module assets\n * @public\n */\n\nconst ADD_FILE = 'ADD_FILE';\nconst REMOVE_FILE = 'REMOVE_FILE';\n\nconst IMPORTING_FILE = 'IMPORTING_FILE';\nconst IMPORTED_FILE = 'IMPORTED_FILE';\nconst IMPORT_FILE_ERROR = 'IMPORT_FILE_ERROR';\n\nconst initialState = Map({\n});\n\nconst reducer = createReducer(initialState, {\n  [ADD_FILE](state, attrs, { action, createEvent }) {\n    let { id } = attrs;\n    if (action.meta && action.meta.saveFile) createEvent('saveFile', attrs);\n    return state.set(id, Map(attrs));\n  },\n\n  [REMOVE_FILE](state, id) {\n    return state.delete(id);\n  },\n\n  [LOAD_SCENE](state, { assets }) {\n    return state.merge(assets);\n  },\n});\n\nexport function addFile(attrs, saveFile) {\n  return { type: ADD_FILE, payload: attrs, meta: { saveFile } };\n};\n\nexport function removeFile(id) {\n  return { type: REMOVE_FILE, payload: id };\n};\n\nfunction urlsFor(file) {\n  return map((host) => `${host}/${file.get('hash')}${file.get('suffix')}?filename=${file.get('name')}`, __FILEROOTS__);\n}\n\nexport function isLoading(id) {\n  return ({ getIn }) => getIn(['sceneIO', 'loadingFiles', id]);\n};\n\nexport function getImage(id) {\n  return images[id];\n};\n\nexport function getOrFetchImage(id, attrs={}) {\n  return (store) => {\n    let file = store.getIn(['assets', id]);\n    if (!file) return;\n\n    return store.callApi(Object.assign({\n      types: [LOADING_FILE, LOADED_FILE, LOADING_FILE_ERROR],\n      url: urlsFor(file),\n      contentType: 'img',\n      payload: id,\n      queryKey: 'IMAGE' + file.get('hash'),\n      fireAndForget: true,\n    }, attrs));\n  };\n}\n\nexport function getOrFetchBinary(id) {\n  return (store) => {\n    const file = store.getIn(['assets', id]);\n    if (file.get('content')) {\n      return file.get('content');\n    } else {\n      const lzmaFile = file.get('lzma') ? file.set('suffix', 'lzma1') : file;\n\n      return store.callApi({\n        types: [LOADING_FILE, LOADED_FILE, LOADING_FILE_ERROR],\n        url: urlsFor(lzmaFile),\n        contentType: 'binary',\n        payload: id,\n        queryKey: 'FILE' + lzmaFile.get('hash'),\n        decompress: lzmaFile.get('lzma'),\n        fireAndForget: true,\n      });\n    }\n  };\n}\n\nexport function getHash(store, id) {\n  return store.getIn(['assets', id, 'hash']);\n};\n\n/**\n * get the url for the asset.\n *\n * @public\n * @param {String} id\n * @returns {String} the url pointing to the asset.\n *\n */\nexport function getUrl(store, id) {\n  const asset = store.getIn(['assets', id]);\n  if (asset) {\n    const urls = urlsFor(asset);\n    return urls[urls.length - 1];\n  } else {\n    return asset;\n  }\n};\n\nexport function fetchText(hash) {\n  return (store) => {\n    return store.callApi({\n      contentType: 'text',\n      url: map((host) => `${host}/${hash}`, __FILEROOTS__),\n    });\n  };\n};\n\nexport function fetchTransit(uuid) {\n  return (store) => {\n    return store.callApi({\n      contentType: 'text',\n      url: `/api/scenes/${uuid}`,\n    });\n  };\n};\n\nexport function find(store, fn) {\n  return store.get('assets').find(fn);\n};\n\nexport function filter(store, fn) {\n  return store.getIn(['assets']).filter(fn || (() =>  true));\n};\n\nexport function exportJSON(store) {\n  return store.getIn(['assets']).map(function (asset) {\n    var json = asset.toJS();\n    json._id = json.id;\n    delete json.id;\n    return json;\n  }).toArray();\n};\n\nexport function getActiveAssets(store) {\n  const sceneGraph = getEvalSceneGraph(store);\n  return filter(store, (v, k) => !!sceneGraph.fileReferences.from[k]);\n};\n\nfunction logBase(value, base) {\n  return Math.log(value) / Math.log(base);\n}\n\nfunction ceilPower2(value) {\n  return Math.pow(2, Math.ceil(logBase(value, 2)));\n}\n\nfunction clamp(value, min, max) {\n  return Math.max(min, Math.min(value, max));\n}\n\nfunction computeNewSize(imgInfo, maxSize) {\n  let newSize = {};\n  newSize.width = clamp(ceilPower2(imgInfo.width), 1, maxSize.width);\n  newSize.height = clamp(ceilPower2(imgInfo.height), 1, maxSize.height);\n  return newSize;\n};\n\nfunction resizeImage(file, maxWidth, maxHeight) {\n  return new Promise(function (resolve, reject) {\n    const img = document.createElement('img');\n    const reader = new FileReader();\n    reader.onload = function (e) {\n      img.src = e.target.result;\n\n      img.onload = function () {\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        ctx.drawImage(img, 0, 0);\n\n        let width = img.width;\n        let height = img.height;\n        const newSize = computeNewSize({ width, height }, { width: maxWidth, height: maxHeight });\n        canvas.width = newSize.width;\n        canvas.height = newSize.height;\n\n        var ctx2 = canvas.getContext('2d');\n        ctx2.drawImage(img, 0, 0, newSize.width, newSize.height);\n\n        resolve(canvas.toDataURL(file.type));\n      };\n    };\n\n    reader.readAsDataURL(file);\n  });\n}\n\nconst MAX_IMG_SIZE = 4096;\nexport const NULL_SCENE_ID = '00000000-0000-0000-0000-000000000000';\n\n/**\n *\n * This will upload an image, add an image node to the scene graph, and return\n * an object with the id of the new node, and the id of the uploaded asset.\n *\n * If you save the assetId, that assetId can be passed into this function\n * to get a new image node for the scene. That means you can restore the state of\n * a scene without having to reimport the previous image.\n *\n * See [The demo example](tutorial-demo-ImportImage.html) for an example of usage.\n *\n * @public\n * @param {(File|String)} image A [File](https://developer.mozilla.org/en/docs/Web/API/File) to import, an assetId from a previous import, or url src of image.\n * @param {Object} options\n * @param {Number} options.resizeTo A max width/height to resize the\n *   image to (preserves aspect ratio of image)\n * @returns Promise resolve to an object with `assetId` and `imageNodeId` keys\n *\n */\nexport function importImage(file, options = {}) {\n  return (store) => {\n    function fetchAsset(uuid) {\n      return store.callApi({\n        types: [IMPORTING_FILE, IMPORTED_FILE, IMPORT_FILE_ERROR],\n        url: `${__APIROOT__}/files/${uuid}/asset`,\n      });\n    }\n\n    function importImageURL(url) {\n      const body = JSON.stringify({\n        url,\n        maxSize: options.resizeTo || MAX_IMG_SIZE,\n        sceneId: NULL_SCENE_ID,\n      });\n\n      return store.callApi({\n        types: [IMPORTING_FILE, IMPORTED_FILE, IMPORT_FILE_ERROR],\n        method: 'POST',\n        url: `${__APIROOT__}/files/image`,\n        body,\n      });\n    };\n\n    // Post to the server to create the image asset\n    function importImage(image) {\n      const body = JSON.stringify({\n        content: image,\n        name: file.name,\n        sceneId: NULL_SCENE_ID,\n        type: file.type,\n      });\n\n      return importFile(store, { body });\n    }\n\n    // Add the asset to the store.\n    function addImageAsset(image) {\n      return store.dispatch(addFile(Object.assign({ id: image._id }, image)));\n    }\n\n    // Create the image node from given asset\n    function createImageNode(imageAsset) {\n      return store.dispatch(addNode({\n        name: imageAsset.name || file.name,\n        type: 'Image',\n        parent: sceneFind(store, { name: 'Material Library' }),\n        plugs: {\n          Image: [['Image', { glBitmapFile: imageAsset.id, glOption: 1 }]],\n          Properties: [['ImageProperties', {}]],\n        },\n      })).then(function (imageNodeId) {\n        return {\n          imageNodeId,\n          assetId: imageAsset.id,\n          imageSize: {\n            width: imageAsset.height,\n            height: imageAsset.width,\n            originalWidth: imageAsset.originalWidth,\n            originalHeight: imageAsset.originalHeight,\n          },\n        };\n      });\n    }\n\n    if (typeof file === 'string') {\n      if (isUuid(file)) {\n        return fetchAsset(file).then(addImageAsset).then(createImageNode);\n      } else {\n        return importImageURL(file).then(addImageAsset).then(createImageNode).catch(function (err) {\n          let errMessage;\n\n          if (err.status && err.status < 500) errMessage = 'Image not imported, bad url';\n          else if (err.status && err.status >= 500) errMessage = 'Image not imported, internal error';\n          else errMessage = err;\n\n          return Promise.reject(errMessage);\n        });\n      }\n    }\n\n    if (!file.type) return Promise.reject('Expect a File');\n    if (file.type !== 'image/jpeg' && file.type !== 'image/png') return Promise.reject('File must be a jpg or png');\n\n    const max = options.resizeTo || MAX_IMG_SIZE;\n\n    return resizeImage(file, max, max).then(importImage).then(addImageAsset).then(createImageNode);\n  };\n}\n\nexport function importFile(store, attrs={}) {\n  return store.callApi(Object.assign({\n    types: [IMPORTING_FILE, IMPORTED_FILE, IMPORT_FILE_ERROR],\n    method: 'POST',\n    url: `${__APIROOT__}/files`,\n  }, attrs));\n}\n\nconst publicApi = {\n  reducer,\n  actions: { addFile, removeFile, importImage },\n  selectors: { _getHash: getHash, getUrl, filter, find, getActiveAssets, exportJSON },\n};\nexport default publicApi;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/assets.js","module.exports = { \"default\": require(\"core-js/library/fn/json/stringify\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/json/stringify.js\n// module id = 169\n// module chunks = 0 1 2","var core  = require('../../modules/_core')\n  , $JSON = core.JSON || (core.JSON = {stringify: JSON.stringify});\nmodule.exports = function stringify(it){ // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/json/stringify.js\n// module id = 170\n// module chunks = 0 1 2","import * as THREE from 'three';\nimport { chain, forEach, map, reduce } from 'ramda';\nimport { merge, addOperator as sceneAddOperator, addNode as sceneAddNode, set as sceneSet, get as sceneGet, clone as sceneClone, exportJSON as exportSceneJSON, setVRCamera as setSceneVRCamera } from './sceneGraph';\nimport { filter as filterAssets, removeFile, exportJSON as exportAssetsJSON } from './assets';\nimport { getEvalSceneGraph, findParent, findRoot } from './sceneGraph';\nimport { buildQueryObject, getMatch, findChild, matchChildren } from './utils/selectors';\nimport records, { lookupOperator } from '../operators/nonImmutable';\n\n/**\n * This module is a high level scene graph manipulation and query library.\n *\n * * Either id, name, or regex's can be used for node names.\n * * All `get` functions return the value, or undefined if no match is found\n * * All `find` functions return an `id` or a Path\n * * All `filter` functions return an array of `id` or Path\n * *\n * @module scene\n * @public\n *\n */\n\n/**\n * Finds first matching node.\n * If propertyName is specified, will look for the first matching operator,\n * and if found, return a path to the operator property.\n * (See {@tutorial sdk-SceneGraph})\n *\n * @public\n * @param {(String|QueryObject)} query The query object to filter on (or a string that gets converted to a query object).\n *\n * @example\n *\n * // Return the node uuid\n * scene.find('Box'); -> 'uuid'\n * // Return the path to the transform operator\n * scene.find('Box','Transform','translation'); -> ['uuid','Transform',0]\n * // Match the first node that starts with Box\n * scene.find('Box*');\n *\n */\nexport function find(store, query, onlyNode) {\n  const queryObj = buildQueryObject(query);\n  const sceneGraph = store.get('sceneGraph');\n\n  // Don't need to do a search if we have an id\n  if (queryObj.id) {\n    let foundNode = sceneGraph.nodes[queryObj.id];\n    if (foundNode && queryObj.parent) {\n      return foundNode.parent || null;\n    }\n\n    if (foundNode && queryObj.child) {\n      return findChild(store, foundNode, { type: queryObj.child, shallow: true }, false, true) || null;\n    }\n\n    return foundNode ? getMatch(foundNode, queryObj, onlyNode) : null;\n  }\n\n  // If we ask to search `all`, then we do a linear search. This lets us\n  // find nodes from scenes not in the active scene graph.\n  if (queryObj.from && queryObj.from.all) {\n    let result;\n    for (let id of Object.keys(sceneGraph.nodes)) {\n      result = getMatch(sceneGraph.nodes[id], queryObj);\n      if (result) return result;\n    }\n\n    return null;\n  }\n\n  const rootId = queryObj.from ? find(store, queryObj.from, true) :\n    store.getIn(['sceneIO', 'id']);\n  const rootNode = rootId && sceneGraph.nodes[rootId];\n\n  return rootNode ? findChild(store, rootNode, queryObj, queryObj.includeParent && rootNode, onlyNode) : null;\n};\n\nfunction matchSceneNode(store, queryObj, onlyNode) {\n  const node = store.getIn('sceneGraph').nodes[store.getIn(['sceneIO', 'id'])];\n  return node && getMatch(node, queryObj, onlyNode) || null;\n};\n\n/**\n * This function will iterate through the scene graph, returning an array\n * of all elements that match the parameters provided.\n *\n * The return value of this function will either be an array of ids (if nodequery and\n * plug are provied), or an array of paths (if property is provided).\n *\n * (See {@tutorial sdk-SceneGraph})\n *\n * @public\n * @param {(String|QueryObject)} query The query object to filter on (or a string that gets converted to a query object).\n * @returns {Array}\n */\nexport function filter(store, query) {\n  const queryObj = buildQueryObject(query);\n  const fromId = queryObj.from ? find(store, queryObj.from) : store.getIn(['sceneIO', 'id']);\n\n  // No matching from query, return empty search\n  if (queryObj.from && !fromId) return [];\n\n  const fromNode = store.get('sceneGraph').nodes[fromId];\n\n  if (!fromNode) {\n    throw new Error('Unknown node to filter from');\n  }\n\n  return matchChildren(store, fromNode, queryObj, queryObj.includeParent && fromNode);\n};\n\n/**\n * Returns the value at the matching property.\n *\n * (See {@tutorial sdk-SceneGraph})\n *\n * @param {(String|QueryObject|Path)} query The query object to filter on (or a string that gets converted to a query object).\n * @returns {any}\n * @public\n */\nexport function get(store, query) {\n  const path = Array.isArray(query) ? query : find(store, query);\n  if (!path || !Array.isArray(path)) return undefined;\n  if (path.length >= 2 && path[1] === 'eval') {\n    const evalNode = getEvalSceneGraph(store).evaluatedNodes[path[0]];\n    const evalPlug = evalNode && evalNode[path[2]];\n    return evalPlug && path[3] ? evalPlug[path[3]] : evalPlug;\n  }\n\n  return sceneGet(store, path);\n};\n\n/**\n * Returns an array of values for the matching properties\n *\n * (See {@tutorial sdk-SceneGraph})\n *\n * @param {(String|QueryObject|Path)} query The query object to filter on (or a found path)\n * @returns {any[]}\n * @public\n */\nexport function getAll(store, query) {\n  const paths = Array.isArray(query) ? query : filter(store, query);\n  return paths ? reduce((obj, path) => {\n    obj[path[0]] = sceneGet(store, path);\n    return obj;\n  }, {}, paths) : undefined;\n};\n\n/**\n * Returns the evaluated plug (and/or property).\n * @param {String} nodeId id of the node\n * @param {String} plug\n * @param {?String} key\n *\n * @example\n *\n * // Return the calculated transform\n * ctx.getEval('Box','Transfrom','translation');\n * // Return the orbitTarget for the scene camera\n * ctx.getEval(true, 'Player', 'orbitTarget');\n */\nexport function getEval(store, nodeId, plug, key) {\n  return get(store, key ? [nodeId, plug, key] : [nodeId, plug]);\n};\n\n/**\n * Get the world transform for a node.\n *\n * @param {String} id\n * @public\n * @returns {?THREE.Matrix4}\n */\nexport function getWorldTransform(store, id) {\n  const transform = get(store, { id, evalPlug: 'Transform' });\n  if (!transform) return null;\n\n  const localTransform = transform.transform;\n  const node = store.get('sceneGraph').nodes[id];\n  const parent = node && node.parent;\n\n  const parentTransform = parent && getWorldTransform(store, parent);\n  return parentTransform ? new THREE.Matrix4().copy(parentTransform).multiply(localTransform)\n    : new THREE.Matrix4().copy(localTransform);\n}\n\n\n/**\n * Get the transform for a node relative to a specified ancestor node. If rootId is not in id's\n *  ancestry, the result is simply the world transform.\n *\n * @param {String} id\n * @param {String} rootId - the node for which we want to calculated id's relative transform from\n * @public\n * @returns {?THREE.Matrix4}\n */\nexport function getRelativeTransform(store, id, rootId) {\n  const transform = get(store, { id, evalPlug: 'Transform' });\n  if (!transform || id === rootId) return null;\n\n  const localTransform = transform.transform;\n  const node = store.get('sceneGraph').nodes[id];\n  const parent = node && node.parent;\n  const parentTransform = parent && getRelativeTransform(store, parent, rootId);\n  return parentTransform ? new THREE.Matrix4().copy(parentTransform).multiply(localTransform)\n    : new THREE.Matrix4().copy(localTransform);\n}\n\n\n/**\n * Get the local transform for a node.\n *\n * @returns {?THREE.Matrix4}\n */\nexport function getLocalTransform(transform) {\n  const { translation, rotation, scale, rotateOrder, preRotation,\n    rotatePivotOffset, localRotatePivot, scalePivotOffset,\n    localScalePivot, shear, } = transform;\n  if (scale.x === 0) scale.x = 0.0000001;\n  if (scale.y === 0) scale.y = 0.0000001;\n  if (scale.z === 0) scale.z = 0.0000001;\n  const zero = new THREE.Vector3(0, 0, 0);\n\n  let matrixStack = [];\n\n  const translationM = new THREE.Matrix4()\n    .makeTranslation(translation.x, translation.y, translation.z);\n  matrixStack.push(translationM);\n\n  const rotatePivotOffestM = new THREE.Matrix4();\n  if (!rotatePivotOffset.equals(zero)) {\n    rotatePivotOffestM.makeTranslation(rotatePivotOffset.x, rotatePivotOffset.y, rotatePivotOffset.z);\n    matrixStack.push(rotatePivotOffestM);\n  }\n\n  const localRotatePivotM = new THREE.Matrix4();\n  const invLocalRotatePivotM = new THREE.Matrix4();\n  let localRotatePivotFlag = false;\n  if (!localRotatePivot.equals(zero)) {\n    localRotatePivotM.makeTranslation(localRotatePivot.x, localRotatePivot.y, localRotatePivot.z);\n    matrixStack.push(localRotatePivotM);\n    invLocalRotatePivotM.getInverse(localRotatePivotM, true);\n    localRotatePivotFlag = true;\n  }\n\n  const preRotationM = new THREE.Matrix4();\n  if (!preRotation.equals(zero)) {\n    const localRotationRadians = new THREE.Vector3().copy(preRotation).multiplyScalar(Math.PI / 180);\n    preRotationM.makeRotationFromEuler(new THREE.Euler(\n      localRotationRadians.x, localRotationRadians.y, localRotationRadians.z, rotateOrder\n    ));\n    matrixStack.push(preRotationM);\n  }\n\n  const rotationRadians = new THREE.Vector3().copy(rotation).multiplyScalar(Math.PI / 180);\n  const rotationM = new THREE.Matrix4()\n    .makeRotationFromEuler(new THREE.Euler(rotationRadians.x, rotationRadians.y, rotationRadians.z, rotateOrder));\n  matrixStack.push(rotationM);\n\n  if (localRotatePivotFlag) matrixStack.push(invLocalRotatePivotM);\n\n  const scalePivotOffsetM = new THREE.Matrix4();\n  if (!scalePivotOffset.equals(zero)) {\n    scalePivotOffsetM.makeTranslation(scalePivotOffset.x, scalePivotOffset.y, scalePivotOffset.z);\n    matrixStack.push(scalePivotOffsetM);\n  }\n\n  const localScalePivotM = new THREE.Matrix4();\n  const invLocalScalePivotM = new THREE.Matrix4();\n  let localScalePivotFlag = false;\n  if (!localScalePivot.equals(zero)) {\n    localScalePivotM.makeTranslation(localScalePivot.x, localScalePivot.y, localScalePivot.z);\n    matrixStack.push(localScalePivotM);\n    invLocalScalePivotM.getInverse(localScalePivotM, true);\n    localScalePivotFlag = true;\n  }\n\n  const sX = shear.x, sY = shear.y, sZ = shear.z;\n  const shearM = new THREE.Matrix4().set(\n    1, sX, sY, 0,\n    0, 1, sZ, 0,\n    0, 0, 1, 0,\n    0, 0, 0, 1\n  ); //.makeShear(new THREE.Vector3(0, 0, 0));\n  matrixStack.push(shearM);\n\n  const scaleM = new THREE.Matrix4().makeScale(scale.x, scale.y, scale.z);\n  matrixStack.push(scaleM);\n\n  if (localScalePivotFlag) matrixStack.push(invLocalScalePivotM);\n\n  const matrixAccumulation = new THREE.Matrix4();\n  for (let i = 0; i < matrixStack.length; i++) {\n    matrixAccumulation.multiply(matrixStack[i]);\n  }\n\n  return matrixAccumulation;\n}\n\n/**\n * Sets the property at path to value.\n *\n * (See {@tutorial sdk-SceneGraph})\n *\n * @param {(Path|QueryObject|String)} query The query object to filter on (or a string that gets converted to a query object).\n * @param {any} value The value to set, the type must match the property being set.\n * @public\n */\nexport function set(query, value) {\n  return (store) => {\n    const path = Array.isArray(query) ? query : find(store, query);\n    if (!path) {\n      console.warn('No matching query', query);\n      return Promise.resolve();\n    }\n\n    if (path.length === 3) {\n      if (typeof value !== 'object') throw new Error('If no property is set, expect an object to merge into the operator');\n      return store.dispatch(merge(path, value));\n    } else if (path.length === 4) {\n      return store.dispatch(sceneSet(path, value));\n    } else if (path.length === 2) {\n      if (path[1] !== 'name') throw new Error('Can only set node name');\n      return store.dispatch(sceneSet(path, value));\n    }\n  };\n};\n\n/**\n * Given an array of paths, will set the `value` on each path.\n * This can be combined with `find` to set a number of properties at once.\n *\n * (See {@tutorial sdk-SceneGraph})\n *\n * @public\n * @param {(Path[]|QueryObject|String)} query An array of path arrays, or a QueryObject\n * @param {any} value The value to set the properties to.\n *\n * @example\n *\n * // Move all boxes to the origin\n * const paths = ctx.find('Box*', 'Transform', 'translation');\n * setAll(paths, {x: 0, y: 0, z: 0});\n *\n */\nexport function setAll(query, value) {\n  //if (!Array.isArray(paths)) return Promise.reject('paths must be an array');\n  return (store) => {\n    const paths = Array.isArray(query) ? query : filter(store, query);\n    //console.log('ctx.setAll', paths, value);\n    return Promise.all(map((path) => store.dispatch(set(path, value)), paths));\n  };\n};\n\n/*\n * Returns an array of nodes with warnings in the scene graph.\n * @private\n */\nexport function getWarnings(store) {\n  const sceneGraph = store.get('sceneGraph');\n  const nodeIds = Object.keys(sceneGraph.nodes);\n  let node;\n  const warningNodes = [];\n  for (let i = 0; i < nodeIds.length; i++) {\n    node = sceneGraph.nodes[nodeIds[i]];\n    if (node && node.warnings && node.warnings.length) warningNodes.push(node);\n  }\n\n  return warningNodes;\n}\n\nexport function setVRCamera(query) {\n  return (store) => {\n    query.type = 'Camera';\n    const newVRCamera = find(store, query);\n    store.dispatch(setSceneVRCamera(newVRCamera));\n  };\n}\n\n/**\n * Given a query, clone these nodes. Without options, these nodes will be cloned\n * in place\n *\n * @public\n * @param {(QueryObject|String|Path[])} query A list of nodes (from filter), or query that will find a list of nodes to clone\n * @param {Object} [options]\n * @param {String} [options.to] The scene being cloned to (default is the active scene)\n * @param {String} [options.withNull] Add a null to clone the nodes to\n * @param {Object} [options.includeDependencies] Clone dependencies (default true)\n *\n * @example\n *\n * // Clone all nodes from Objects on import scene into active scene\n * scene.clone({from: {id: importId, child: 'Objects'}});\n *\n * // Clone children of a null to a new null\n * scene.clone({from: {id: importId, child: 'Objects'}}, {withNull: 'New Parent Null'});\n *\n * // Clone children, without also cloning dependencies.\n *\n *\n * // Return the path to the transform operator\n * scene.find('Box','Transform','translation'); -> ['uuid','Transform',0]\n * // Match the first node that starts with Box\n * scene.find('Box*');\n *\n */\nexport function clone(query, options = {}) {\n  if (options.cloneDependencies === undefined) options.cloneDependencies = true;\n\n  return (store) => {\n    const paths = Array.isArray(query) ? query : filter(store, query);\n    if (!paths.length) {\n      console.warn('No match for clone: ', query);\n      return Promise.resolve(true);\n    }\n\n    const fromSceneId = findRoot(store, paths[0]);\n    const toSceneId = options.to || store.getIn(['sceneIO', 'id']);\n    const fromObjectsId = find(store, { id: fromSceneId, child: 'Objects' });\n    const toObjectsId = find(store, { id: toSceneId, child: 'Objects' });\n\n    const nodeMap = {\n      [fromObjectsId]: toObjectsId,\n      [find(store, { id: fromSceneId, child: 'MaterialLibrary' })]: find(store, { id: toSceneId, child: 'MaterialLibrary' }),\n    };\n\n    const nullNode = options.withNull ? store.dispatch(sceneAddNode({\n      name: options.withNull,\n      parent: toObjectsId,\n      type: 'Null',\n      plugs: {\n        Null: [['Null', {}]],\n        Transform: [['Transform', {}]],\n        Properties: [['Default', {}]],\n      },\n    })) : Promise.resolve(null);\n\n    return nullNode.then((nullNodeId) => {\n      if (nullNodeId) nodeMap[fromObjectsId] = nullNodeId;\n      return store.dispatch(sceneClone(paths, nodeMap, { cloneDependencies: options.cloneDependencies })).then((cloneMap) => {\n        if (nullNodeId) cloneMap[options.withNull] = nullNodeId;\n        return cloneMap;\n      });\n    });\n  };\n}\n\nexport function pruneAssets() {\n  return (store) => {\n    const sceneGraph = store.get('sceneGraph');\n    const usedAssets = {};\n    const nodes = filter(store, { includeParent: true });\n\n    function storeFileRefs(id) {\n      const plugs = sceneGraph.nodes[id] && sceneGraph.nodes[id].plugs;\n      for (let plugName of Object.keys(plugs || {})) {\n        plugs[plugName].forEach((op, opIdx) => {\n          const operator = lookupOperator(plugName, op.type, []);\n          for (let refKey of operator.fileReferenceKeys) {\n            if (op[refKey]) usedAssets[op[refKey]] = true;\n          }\n        });\n      }\n    };\n\n    nodes.forEach(storeFileRefs);\n\n    return Promise.all(filterAssets(store).map(function (asset) {\n      return !usedAssets[asset.get('id')] &&\n        store.dispatch(removeFile(asset.get('id')));\n    }));\n  };\n}\n\nexport function getNodeBoundingBox(store, id) {\n  const translator = store.getTranslator();\n  if(translator) return translator.getNodeBoundingBox(id);\n  return new THREE.Box3();\n};\n\nexport function getCurrentPass(store, optionalPassName) {\n  if (optionalPassName) {\n    return get(store, { name: optionalPassName, evalPlug: 'Pass' });\n  }\n  const currPassID = get(store, { name: 'Passes', plug: 'GeneralRenderer', property: 'curPass' });\n  const currPass = get(store, { id: currPassID, evalPlug: 'Pass' });\n  return currPass || get(store, { type: 'Pass', evalPlug: 'Pass' });\n};\n\nexport function exportJSON(store, sceneId) {\n  const _sceneId = sceneId || store.getIn(['sceneIO', 'id']);\n\n  const nodes = filter(store, { from: { id: _sceneId }, includeParent: true });\n  return {\n    sceneGraph: exportSceneJSON(store, nodes),\n    assets: exportAssetsJSON(store),\n  };\n};\n\nconst nodeTypes = {\n  //Scene: {\n  //  'Environment': 'Environment',\n  //  'Timeline': 'Timeline',\n  //  'Player': 'Player',\n  //},\n  BinMesh: {\n    'BinMesh': 'ProxyMesh',\n    'Transform': 'Transform',\n    'Material': 'Reference',\n    'Properties': 'BinMeshProperties',\n  },\n  PolyMesh: {\n    'PolyMesh': 'Box',\n    'Transform': 'Transform',\n    'Material': 'Reference',\n    'Properties': 'PolyMeshProperties',\n  },\n  Light: {\n    'Light': 'PointLight',\n    'Transform': 'Transform',\n    'Properties': 'Default',\n  },\n  Camera: {\n    'Camera': 'Camera',\n    'Transform': 'Transform',\n    'Properties': 'Default',\n  },\n  Null: {\n    'Null': 'Null',\n    'Transform': 'Transform',\n    'Properties': 'Default',\n  },\n  Model: {\n    'Null': 'Null',\n    'Transform': 'Transform',\n    'Mixer': 'Mixer',\n    'Properties': 'ModelProperties',\n  },\n  Material: {\n    'Material': 'Physical',\n    'Properties': 'MaterialProperties',\n  },\n  Image: {\n    'Image': 'Image',\n    'Properties': 'ImageProperties',\n  },\n  Pass: {\n    'Pass': 'Pass'\n  },\n  Renderer: {\n    'Renderer': 'WebGLRenderer',\n  },\n  Bone: {\n    'Bone': 'Bone',\n    'Transform': 'BoneTransform',\n    'Properties': 'Default',\n  },\n  Annotation: {\n    'Annotation': 'Annotation',\n    'Transform': 'Transform',\n    'Properties': 'Default',\n  },\n  // Objects: [],\n  // MaterialLibrary: [],\n  // Renderers: [],\n  // Passes: [],\n};\n\n/**\n * Add a node to the scene.\n *\n * @public\n * @param {Node} node The new node being added\n * @param {String} node.name The name of the new node\n * @param {String} node.type The type of the new node\n * @param {String} node.parent the id of the parent node for the new node\n * @param {Object} [node.plugs] The plugs for the new node\n * @returns {Promise}\n *\n */\nexport function addNode(node) {\n  const { name, type, parent, plugs } = node;\n  if (!parent) throw new Error('addNode requires parent to be set');\n  if (!type) throw new Error('addNode requires type to be set');\n  if (!name) throw new Error('addNode requires name to be set');\n  if (!nodeTypes[type]) throw new Error(`invalid type: ${type} for addNode`);\n  const toPlugs = plugs || {};\n  for (let plugName of Object.keys(nodeTypes[type])) {\n    if (!toPlugs[plugName]) toPlugs[plugName] = [[nodeTypes[type][plugName], {}]];\n    if (!toPlugs[plugName][0][0]) throw new Error('Required operator for ' + plugName);\n  }\n  return sceneAddNode({ name, type, plugs: toPlugs, parent });\n};\n\n/**\n * Add an operator to an existing node in the scene.\n *\n * @public\n * @param {String} id The id of the node receiving the operator\n * @param {String} plugType The plug that is receiving the operator\n * @param {string} operatorType The type of operator being added\n * @param {Object} [operator] The details of the operator\n * @param {String} [name] the name of the operator\n * @returns {Promise}\n *\n */\nexport function addOperator(id, plugType, operatorType, operator={}, name) {\n  if (!id) throw new Error('addOperator requires the id for the element receiving the operator');\n  if (!plugType) throw new Error('addOperator requires the plug to be set');\n  if (!operatorType) throw new Error('addOperator requires the operator type to be set');\n\n  const plug = records[plugType];\n  if (!plug) throw new Error(`Unknown plug: ${plugType}`);\n  const op = plug[operatorType];\n  if (!op) throw new Error(`Unknown operator: ${operatorType}`);\n\n  return sceneAddOperator(id, plugType, [operatorType, operator, name]);\n}\n\nconst publicApi = {\n  actions: { set, setAll, clone, pruneAssets, setVRCamera, addOperator, addNode },\n  selectors: { get, getAll, getWorldTransform, find, filter, getWarnings,\n    exportJSON, getNodeBoundingBox, getCurrentPass },\n};\n\nexport default publicApi;\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/scene.js","import { all, contains, find, findIndex, flatten, forEach } from 'ramda';\n\nconst uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n\n/**\n * Test whether a string is a uuid or not.\n * @param {String} id\n */\nexport function isUuid(id) {\n  return uuidRegex.test(id);\n};\n\nfunction pathToRegExp(query) {\n  if (query instanceof RegExp) return query;\n  query = query.replace(/\\*/g, '(.*)').replace(/^\\\"|\\\"$/g, '');\n  return new RegExp('^' + query + '$', 'i');\n};\n\nconst re = {\n  bareName: '^([^!%\\[#:]*)*',    // Match the name, up to % or #\n  type: '(?:\\%([^#!:]*))*',      // Match the type\n  filter: '(?::([^#:]*))*',     // Any filter?\n  evalPlug: '(?:\\!([^#\\[]*))*',  // Evaluated plug name\n  plugName: '(?:\\#([^\\[]*))*',  // Plug name\n  attrs: '(.*)',                 // Any attribute selectors (entire match)\n};\n\nconst queryRegex = new RegExp(\n  re.bareName + re.type + re.filter + re.evalPlug + re.plugName + re.attrs\n);\n\nconst queryRegexNoName = new RegExp(\n  '()' + re.type + re.filter + re.evalPlug + re.plugName + re.attrs\n);\n\nconst attrsRegex = /(?:\\[([^\\]]*)\\])/g;\n\n/*\n * Parse \"[translation][name='Transform']\" and turn it into\n * operator/property/properties fields for matching.\n */\nfunction parseOperatorAttributes(attrsString) {\n  // Take \"[translation][name='Transform']\" and convert it into\n  // a filter function that will match the specific operator\n  var items, match;\n\n  let property;\n  let properties;\n\n  while ((match = attrsRegex.exec(attrsString)) !== null) {\n    items = match[1].split('=');\n    if (items.length === 2) {\n      if (!properties) properties = {};\n      properties[items[0]] = items[1];\n    } else {\n      property = items[0];\n    }\n  }\n\n  return { property, properties };\n};\n\nfunction buildQueryObjectFromString(query) {\n  // Support looking for the active scene node with '~'.\n  const scene = query[0] === '~';\n  const quotedIdx = !scene && query[0] === '\"' && query.slice(1).indexOf('\"');\n  const quotedName = quotedIdx && quotedIdx !== -1;\n\n  const matches = (quotedName || scene) ?\n      queryRegexNoName.exec(query.slice(scene ? 1 : quotedIdx + 2)) :\n      queryRegex.exec(query);\n  const name = quotedName ? query.slice(1, quotedIdx + 1) : (scene ? false : matches[1]);\n  const type = matches[2];\n  const filter = matches[3];\n  const evalPlug = matches[4];\n  const plug = matches[5];\n  const attrs = matches[6];\n  const id = isUuid(name) ? name : undefined;\n  return Object.assign({ scene, id, name: (id || !name) ? undefined : pathToRegExp(name),\n    type, filter, evalPlug, plug, }, parseOperatorAttributes(attrs), { includeParent: true });\n};\n\n/**\n * Takes a query string, and returns an object with the attributes we are looking\n * for.\n */\nexport function buildQueryObject(query) {\n  if (typeof query === 'string') return buildQueryObjectFromString(query);\n  if (typeof query === 'object') {\n    //if (typeof query.name === 'string' && query.name.indexOf('*') !== -1)\n    return Object.assign({}, query, {\n      name: query.name ? pathToRegExp(query.name) : undefined,\n      names: (query.names && Array.isArray(query.names)) ? query.names.map(pathToRegExp) : undefined,\n      // include parent by default if no from query is specified\n      includeParent: query.includeParent === undefined ? !query.from : query.includeParent,\n    });\n  }\n\n  return {};\n}\n\n/*\n * Given a QueryObject, will return a matching path for this node, or\n * null if the node does not match.\n */\nexport function getMatch(node, queryObj, onlyNode) {\n  var nodeMatch = getNodeMatch(node, queryObj);\n  return !nodeMatch ? null : (onlyNode ? nodeMatch.id : matchInside(node, queryObj));\n}\n\n/*\n * Given a QueryObject, will return the node if the node matches the\n * node query parameters (id, name, type).\n */\nfunction getNodeMatch(node, queryObj) {\n  if (queryObj.id !== undefined && queryObj.id !== node.id) return null;\n  if (queryObj.name !== undefined && !queryObj.name.test(node.name)) return null;\n  if (queryObj.type !== undefined) {\n    if (typeof queryObj.type === 'string') {\n      if (queryObj.type !== node.type) return null;\n    } else if (Array.isArray(queryObj.type)) {\n      if (!contains(node.type, queryObj.type)) return null;\n    }\n  }\n\n  if (queryObj.hasPlug !== undefined && !node.plugs[queryObj.hasPlug]) return null;\n\n  return node;\n};\n\nfunction matchInside(node, queryObj) {\n  const { properties, property, operator, operatorIndex } = queryObj;\n\n  if (queryObj.evalPlug) {\n    return property ? [node.id, 'eval', queryObj.evalPlug, property] :\n      [node.id, 'eval', queryObj.evalPlug];\n  }\n\n  if (!queryObj.plug) {\n    if (property === 'name' || property === 'type') {\n      return [node.id, property];\n    }\n\n    return node.id;\n  }\n\n  const plug = node.plugs[queryObj.plug];\n  if (!plug) return null;\n\n  const propKeys = properties && Object.keys(properties);\n\n  if (!properties  && !property && !operator && operatorIndex === undefined) {\n    return node.id; // No operator query provided.\n  }\n\n  const idx = queryObj.operatorIndex !== undefined ? queryObj.operatorIndex :\n    findIndex((op) => {\n      return (property ? op.hasOwnProperty(property) : true) &&\n        (properties ?  all((k) => op[k] === properties[k], propKeys) : true);\n    }, plug);\n\n  if (idx === -1) return null;\n  return property ? [node.id, queryObj.plug, idx, property] :\n    [node.id, queryObj.plug, idx];\n};\n\nexport function matchChildren(store, node, queryObj, parentNodeToMatch) {\n  let results = [];\n  const sceneGraph = store.get('sceneGraph');\n\n  const parentMatch = parentNodeToMatch && getMatch(parentNodeToMatch, queryObj);\n  if (parentMatch) results.push(parentMatch);\n\n  forEach((childId) => {\n    const childNode = sceneGraph.nodes[childId];\n    if (!childNode) throw new Error(`Invalid child for '${node.get('name')}' - ${childId}`);\n\n    const match = getMatch(childNode, queryObj);\n    if (match) results.push(match);\n    if (!queryObj.shallow) {\n      results = results.concat(matchChildren(store, childNode, queryObj));\n    }\n  }, node.children || []);\n\n  return results;\n};\n\nexport function findChild(store, node, queryObj, parentNodeToMatch, onlyNode) {\n  let result;\n  if (parentNodeToMatch) {\n    result = getMatch(parentNodeToMatch, queryObj, onlyNode);\n    if (result) return result;\n  }\n\n  const sceneGraph = store.get('sceneGraph');\n  const query = Object.assign({}, queryObj);\n  if (query.names) {\n    query.name = query.names[0]\n    query.names = query.names.slice(1);\n  }\n\n  const match = find((childId) => {\n    const childNode = sceneGraph.nodes[childId];\n    result = getMatch(childNode, query, onlyNode || (query.names && query.names.length));\n    if (query.names) { // heirarchical search by name\n      if (!result || !query.names.length) return !!result;\n      result = findChild(store, childNode, query, null, onlyNode);\n      if (result) return true;\n    } else {\n      if (result) return true;\n      result = !query.shallow && findChild(store, childNode, query, null, onlyNode);\n      if (result) return true;\n    }\n  }, node.children || []);\n  return match ? result : null;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/utils/selectors.js","import makeAllOperators from './makeAllOperatorsNonImmutable';\nimport Annotation from './Annotation';\nimport BinMesh from './BinMesh';\nimport Camera from './Camera';\nimport Environment from './Environment';\nimport GeneralRenderer from './GeneralRenderer';\nimport Image from './Image';\nimport Light from './Light';\nimport Material from './Material';\nimport Pass from './Pass';\nimport Player from './Player';\nimport PolyMesh from './PolyMesh';\nimport Properties from './Properties';\nimport Renderer from './Renderer';\nimport Transform from './Transform';\n\nconst NoOp = { schema: {} };\n\nconst Bone = { Bone: NoOp };\nconst Null = { Null: NoOp };\nconst Mixer = { Action: NoOp, Mixer: NoOp };\nRenderer['vray/create'] = NoOp;\nconst Timeline = { Timeline: NoOp };\nconst Viewport = { Viewport: NoOp };\n\nconst records = makeAllOperators({\n  Annotation, BinMesh, Bone, Camera, Environment, GeneralRenderer, Light, Material,\n  Mixer, Null, Pass, Player, PolyMesh, Properties,\n  Renderer, Timeline, Transform, Image, Viewport,\n}, { withNone: true });\n\nexport function lookupOperator(plugName, type, warnings) {\n  const plug = records[plugName];\n  if (!plug) {\n    warnings.push(`Unknown plug: ${plugName}`);\n    return records.None.NoOp;\n  }\n\n  const operator = plug[type];\n  if (!operator) {\n    warnings.push(`Unknown Operator: ${plugName}, ${type}`);\n    return records.None.NoOp;\n  }\n\n  return operator;\n}\n\nexport default records;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/nonImmutable.js","import { curry, map, mapObjIndexed, pick, pickBy } from 'ramda';\nimport schemaTypes from './schemaTypes';\n\nexport default function makeAllOperators(hierarchy, { withNone }) {\n  let records = mapObjIndexed((ops, plug) => {\n    return mapObjIndexed((op, name) => {\n      return makeOperator(plug, op, name);\n    }, ops);\n  }, hierarchy);\n  if (withNone) records.None = { NoOp: makeOperator('None', { schema: {} }, 'NoOp') };\n  return records;\n};\n\nfunction makeOperator(plug, op, name) {\n  const fileReferenceKeys = [];\n  const referenceKeys = [];\n  const nodeReferenceKeys = [];\n  const nodeReferenceListKeys = [];\n  const plugReferences = {};\n\n  let props = mapObjIndexed((info, key) => {\n    const prop = (schemaTypes[info.type]) ? Object.assign({ type: info.type, schema: info }, schemaTypes[info.type](info))\n     : { set: (v) => v };\n\n    if (prop.isFileReference) fileReferenceKeys.push(key);\n    if (prop.isNodeReference) {\n      nodeReferenceKeys.push(key);\n      referenceKeys.push(key);\n    }\n\n    if (prop.isPlugReference) {\n      plugReferences[key] = prop.isPlugReference;\n      referenceKeys.push(key);\n    }\n\n    if (prop.isReferenceList) nodeReferenceListKeys.push(key);\n\n    return prop;\n  }, op.schema);\n\n  const keys = Object.keys(props);\n\n  return {\n    keys,\n    referenceKeys,\n    fileReferenceKeys,\n    nodeReferenceKeys,\n    nodeReferenceListKeys,\n    plugReferences,\n    environment: op.environment,\n\n    getProperties() {\n      return props;\n    },\n\n    typeOf(key) {\n      return op.schema[key] && op.schema[key].type;\n    },\n\n    set(data, key, val) {\n      const newVal = props[key] ? props[key].set(val) : val;\n      const isChanged = props[key] && props[key].equals ? !props[key].equals(newVal, data[key]) : newVal !== data[key];\n      if (isChanged) data[key] = props[key] && props[key].get ? props[key].get(newVal) : newVal;\n      return isChanged;\n    },\n\n    /*\n    equals(data1, data2) {\n      //return (JSON.stringify(data1) === JSON.stringify(data2));\n      let isEqual = true;\n\n      for(let key in keys){\n        if(data1.hasOwnProperty(key) &&\n          ((data1[key].equals && !data1[key].equals(data2)) ||\n          (data1[key] !== data2[key]))){\n            isEqual = false;\n            break;\n        }\n      }\n      return isEqual;\n    },\n    */\n\n    export(data) {\n      // This could be written to remove default keys\n      return Object.assign({}, data, {\n        name, primitive: plug,\n      });\n    },\n\n    get(data, key) {\n      return props[key] && props[key].get ? props[key].get(data[key]) : data[key];\n    },\n\n    init(type, initAttrs={}, name) {\n      const result = { type, name: (name || type) };\n      for (let key of keys) {\n        result[key] = props[key].set(initAttrs[key]); //props.set(result, key, props[key]);\n      }\n      //result._v = 1;\n      return result;\n    },\n\n    update(data, primitive, options) {\n      let newPrimitive = op.update ?\n        op.update.call(op, data, primitive, options) :\n        Object.assign(primitive, data);\n      const result = newPrimitive || primitive;\n\n      if (!result.nodeId) result.nodeId = options.node.id;\n      if (!result.id) result.id = options.node.id;\n      result._v = options.node._v;\n      return result;\n    },\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/makeAllOperatorsNonImmutable.js","import { Vector2, Vector3, Color } from 'three';\n//import { FileReference, NodeReference, PlugReference, Vec2, Vec3, Color} from './primitives';\n\nfunction initVector3(from) {\n  if (!from) return new Vector3();\n  if (from.isVector3) return from;\n  if (from.hasOwnProperty('x')) return new Vector3(from.x, from.y, from.z);\n  if (Array.isArray(from)) return new Vector3(from[0], from[1], from[2]);\n  return new Vector3();\n};\n\nfunction initVector2(from) {\n  if (!from) return new Vector2();\n  if (from.isVector2) return from;\n  if (from.hasOwnProperty('x')) return new Vector2(from.x, from.y);\n  if (Array.isArray(from)) return new Vector2(from[0], from[1]);\n  return new Vector2();\n};\n\nfunction initColor(from) {\n  if (!from) return new Color();\n  if (Array.isArray(from)) return new Color(from[0], from[1], from[2]);\n  if (from.hasOwnProperty('r')) return new Color(from.r, from.g, from.b);\n  if (Number.isInteger(from)) return new Color(from);//hex value\n  return new Color();\n}\n\nconst schemaTypes = {\n  Boolean: function (schema) {\n    const defaultValue = schema.defaultValue || false;\n\n    return {\n      defaultValue,\n\n      set: (val) => {\n        return val == null ? defaultValue : !!val;\n      },\n    };\n  },\n\n  Label: function (schema) {\n    return {\n      set: (val) => {\n        return typeof val === 'string' ? val : '';\n      },\n    };\n  },\n\n  Number: function (schema) {\n    const min = schema.minValue;\n    const max = schema.maxValue;\n    const defaultValue = schema.defaultValue || 0;\n\n    let clamp;\n\n    if (min !== undefined && max !== undefined) clamp = (v) => Math.min(Math.max(min, v), max);\n    else if (min !== undefined) clamp = (v) => Math.max(v, min);\n    else if (max !== undefined) clamp = (v) => Math.min(v, max);\n    else clamp = (v) => v;\n\n    return {\n      defaultValue,\n\n      set: (val) => {\n        let num = Number(val);\n        if (isNaN(num)) return defaultValue;\n        return Math.round(clamp(num) * 10000) / 10000;\n      },\n    };\n  },\n\n  Integer: function (schema) {\n    const min = schema.minValue;\n    const max = schema.maxValue;\n    const defaultValue = schema.defaultValue || 0;\n\n    let clamp;\n\n    if (min !== undefined && max !== undefined) clamp = (v) => Math.min(Math.max(min, v), max);\n    else if (min !== undefined) clamp = (v) => Math.max(v, min);\n    else if (max !== undefined) clamp = (v) => Math.min(v, max);\n    else clamp = (v) => v;\n\n    return {\n      defaultValue,\n\n      set: (val) => {\n        const num = Number(val);\n        if (isNaN(num)) return defaultValue;\n        return Math.round(clamp(num));\n      },\n    };\n  },\n\n  Plug: function (schema) {\n    if (!schema.plug) throw new Error('plug property expects a `plug` property');\n\n    return {\n      isPlugReference: schema.plug,\n\n      set: (id) => {\n        if (id && id.id) return id.id;\n        return id;\n      },\n    };\n  },\n\n  Options: function (schema) {\n    const defaultValue = schema.defaultValue;\n    return {\n      defaultValue,\n\n      set: (val) => {\n        return val == null ? defaultValue : val;\n      },\n    };\n  },\n\n  Image: function (schema) {\n    return {\n      isFileReference: true,\n\n      set: (id) => {\n        if (id && id.id) return id.id;\n        return id; // ? FileReference({id}) : null;\n      },\n    };\n  },\n\n  Binary: function (schema) {\n    return {\n      isFileReference: true,\n\n      set: (id) => {\n        if (id && id.id) return id.id;\n        return id; // ? FileReference({id}) : null;\n      },\n    };\n  },\n\n  File: function (schema) {\n    return {\n      isFileReference: true,\n\n      set: (id) => {\n        if (id && id.id) return id.id;\n        return id; // ? FileReference({id}) : null;\n      },\n    };\n  },\n\n  Object: function (schema) {\n    const defaultValue = schema.defaultValue || {};\n    return {\n      set: (obj) => {\n        return obj || defaultValue;\n      },\n\n      equals: (val1, val2) => {\n        return (JSON.stringify(val1) === JSON.stringify(val2));\n      },\n    };\n  },\n\n  String: function (schema) {\n    const defaultValue = schema.defaultValue || '';\n\n    return {\n      defaultValue,\n\n      set: (str) => {\n        return typeof str === 'string' ? str : defaultValue;\n      },\n    };\n  },\n\n  Node: function (schema) {\n    return {\n      isNodeReference: true,\n\n      set: (id) => {\n        if (id && id.id) return id.id;\n        return id; // ? NodeReference({id}) : null;\n      },\n    };\n  },\n\n  NodeList: function (schema) {\n    return {\n      isReferenceList: true,\n\n      set: (ids) => {\n        if (Array.isArray(ids)) {\n          return ids.map((id) => id && id.id ? id.id : id);\n        }\n\n        return [];\n      },\n\n      equals: (val1, val2) => {\n        return JSON.stringify(val1) === JSON.stringify(val2);\n      },\n    };\n  },\n\n  Vec2: function (schema) {\n    const defaultValue = initVector2(schema.defaultValue);\n\n    return {\n      defaultValue,\n\n      set: (val) => {\n        return initVector2(val || defaultValue);\n      },\n\n      get: (val) => {\n        return val.clone();\n      },\n\n      equals: (val1, val2) => {\n        return val1.equals(val2);\n      },\n    };\n  },\n\n  Color: function (schema) {\n    const defaultValue = initColor(schema.defaultValue);\n\n    return {\n      defaultValue,\n\n      set: (val) => {\n        return initColor(val || defaultValue);\n      },\n\n      get: (val) => {\n        return val.clone();\n      },\n\n      equals: (val1, val2) => {\n        return val1.equals(val2);\n      },\n    };\n  },\n\n  Vec3: function (schema) {\n    const defaultValue = initVector3(schema.defaultValue);\n\n    return {\n      defaultValue,\n\n      set: (val) => {\n        return initVector3(val || defaultValue);\n      },\n\n      get: (val) => {\n        return val.clone();\n      },\n\n      equals: (val1, val2) => {\n        return val1.equals(val2);\n      },\n    };\n  },\n};\n\nexport default schemaTypes;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/schemaTypes.js","module.exports = { \"default\": require(\"core-js/library/fn/number/is-integer\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/number/is-integer.js\n// module id = 176\n// module chunks = 0 1 2","require('../../modules/es6.number.is-integer');\nmodule.exports = require('../../modules/_core').Number.isInteger;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/number/is-integer.js\n// module id = 177\n// module chunks = 0 1 2","// 20.1.2.3 Number.isInteger(number)\nvar $export = require('./_export');\n\n$export($export.S, 'Number', {isInteger: require('./_is-integer')});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.number.is-integer.js\n// module id = 178\n// module chunks = 0 1 2","// 20.1.2.3 Number.isInteger(number)\nvar isObject = require('./_is-object')\n  , floor    = Math.floor;\nmodule.exports = function isInteger(it){\n  return !isObject(it) && isFinite(it) && floor(it) === it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_is-integer.js\n// module id = 179\n// module chunks = 0 1 2","\nconst Annotation = {\n  schema: {\n    useText: { type: 'Boolean', label: 'Use Custom Text', defaultValue: false, animatable: false },\n    text: { type: 'String', label: 'Custom Text', defaultValue: 'Annotation Text', animatable: false },\n    open: { type: 'Boolean', label: 'Open by default', defaultValue: false, animatable: false },\n    // Mis-spelled `limitVisibility`\n    limitVisilibility: { type: 'Boolean', label: 'Limit Visibility', defaultValue: false, animatable: false },\n    visibilityAngle: { type: 'Number', label: 'Visibility Angle', defaultValue: 180, step: 5, minValue: 10, maxValue: 360, animatable: false },\n    directionMode: { label: 'Direction Mode', type: 'Options',\n                labels: ['Manual', 'Away From Origin'],\n                values: ['manual', 'awayFromOrigin'],\n                defaultValue: 'manual', },\n    directionAxis: { label: 'Direction', type: 'Options',\n            labels: [ 'XAxis', 'YAxis', 'ZAxis' ],\n            values: [ 'x', 'y', 'z' ],\n            defaultValue: 'z' },\n    directionTarget: { type: 'Node', label: 'Direction Target' },\n  },\n\n  update: function (operator, primitive, { node }) {\n    Object.assign(primitive, operator);\n    if (!operator.useText) primitive.text = node.name;\n  },\n};\n\nexport default { Annotation };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Annotation.js","import { convertToCNSPolyMesh } from '../translators/bingeom';\nimport { getOrFetchBinary, getHash } from '../modules/assets';\n\nimport MeshSmooth from './PolyMesh/MeshSmooth';\n\nconst ProxyMesh = {\n  schema: {\n    binary: { type: 'Binary', label: 'Binary Geometry File' },\n    reducedBinary: { type: 'Binary', label: 'Reduced Binary Geometry File' },\n    operatorDisplay: { type: 'Number', defaultValue: 1, label: 'Operator Display Type' },\n    nbLevel: { type: 'Number', defaultValue: 1 }, // 1 -> only binary, 2 -> level0 and binary, 3 -> level0, level1, binary, ....\n    level0: { type: 'Binary', label: 'Binary Geometry File' },\n    level1: { type: 'Binary', label: 'Binary Geometry File' },\n    level2: { type: 'Binary', label: 'Binary Geometry File' },\n    level3: { type: 'Binary', label: 'Binary Geometry File' },\n    level4: { type: 'Binary', label: 'Binary Geometry File' },\n  },\n\n  update: function (operator, primitive, { node, store, properties, previousResult, loaded }) {\n    const visible = properties.visible;\n    const binary = operator.binary;\n    const fetch = visible || (properties.prefetch && loaded);\n    const bingeom = fetch && binary && store.hasApi() && getOrFetchBinary(binary)(store);\n    const mesh = bingeom && convertToCNSPolyMesh(bingeom, binary);\n    //console.log('Mesh update', 'visible:', visible, 'prefetch:', properties.prefetch, 'fetch:', fetch, 'bingeom:', !!bingeom, node.name, mesh);\n    primitive.mesh = mesh;\n    primitive.previousMesh = previousResult && previousResult.mesh;\n  },\n};\n\nconst Instance = {\n  schema: {\n    geometry: { label: 'Mesh', plug: 'BinMesh', type: 'Plug' },\n  },\n\n  update: function (operator, primitive) {\n    primitive.mesh = operator.geometry && operator.geometry.mesh;\n  },\n};\n\nexport default { ProxyMesh, MeshSmooth, Instance };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/BinMesh.js","import { Importer, PolyMaps, PolyMesh } from '../polyMesh';\n\nfunction validateAndRetype(data) {\n  if (data instanceof Uint32Array) return data;\n  else if (data instanceof ArrayBuffer) return new Uint32Array(data);\n  else if (typeof (Buffer) !== 'undefined' && data instanceof Buffer) {\n    return new Uint32Array(new Uint8Array(data).buffer);\n  }\n\n  throw new Error('Invalid bingeom type: ' + typeof (data));\n};\n\nfunction extractFooter(data) {\n  const jsonLength = data[data.length - 2];\n  if (!jsonLength) throw new Error('No footer in bingeom');\n  let charData = new Uint8Array(data.buffer);\n  const len = charData.byteLength - 8;\n  charData = charData.subarray(len - jsonLength, len);\n  return JSON.parse(String.fromCharCode.apply(null, charData));\n}\n\nfunction validateDataInfo(dataInfo) {\n  return dataInfo !== undefined && typeof (dataInfo.o) === 'number' && typeof (dataInfo.l) === 'number';\n}\n\nexport function validatePolymeshData(jsonData) {\n  return jsonData && validateDataInfo(jsonData.faceCount) && validateDataInfo(jsonData.faces) && validateDataInfo(jsonData.positions);\n}\n\nfunction assert(truthy, message) {\n  if (!truthy) throw new Error(message);\n}\n\nconst RawUintByteSize = { 1: 'RawUint8', 2: 'RawUint16', 4: 'RawUint32' };\n\nconst types = {\n  RawUint8: { shift: 0, arr: Uint8Array },\n  RawUint16: { shift: 1, arr: Uint16Array },\n  RawUint32: { shift: 2, arr: Uint32Array },\n  RawFloat32: { shift: 2, arr: Float32Array },\n};\n\nfunction readArray(buffer, jsonData, dataType=null) {\n  if (!jsonData) return dataType ? new types[dataType].arr(0) : [];\n  const typeinfo = types[dataType || RawUintByteSize[jsonData.b || 4]];\n  return new typeinfo.arr(buffer, jsonData.o, jsonData.l >> typeinfo.shift);\n}\n\nfunction noTriangulation(faces, faceSize) {\n  return faces;\n}\n\nfunction staticTriangulation(faces, faceSize) {\n  if (faces.length % faceSize !== 0) throw new Error('Invalid face index array');\n  const trianglePerFace = faceSize - 2;\n  const nbFaces = 3 * (faces.length * trianglePerFace) / faceSize;   // number of triangulated faces\n\n  const newFaces = new faces.constructor(nbFaces);\n  for (let inn = 0, out = 0, il = faces.length; out < il;) {\n    let first  = faces[out++];\n    let second = faces[out++];\n    for (let j = trianglePerFace; j > 0; --j) {\n      newFaces[inn++] = first;\n      newFaces[inn++] = second;\n      second = faces[out++];\n      newFaces[inn++] = second;\n    }\n  }\n\n  return newFaces;\n};\n\nfunction dynamicTriangulation(faces, faceCount) {\n  let fl = faceCount.length;\n  let nbFaces = -(fl << 1); // starts at -2*fl because the number of triangle in on face 'x' is faceCount[x]-2\n  for (let i = fl - 1; i >= 0; --i) nbFaces += faceCount[i];\n\n  const newFaces = new faces.constructor(nbFaces * 3);  // can reuse the same constructor as faces because the max index is the same\n  for (let inn = 0, out = 0, f = 0, fl = faceCount.length; f < fl; ++f) {\n    let first  = faces[out++];\n    let second = faces[out++];\n    for (let j = faceCount[f] - 2; j > 0; --j) {\n      newFaces[inn++] = first;\n      newFaces[inn++] = second;\n      second = faces[out++];\n      newFaces[inn++] = second;\n    }\n  }\n\n  return newFaces;\n};\n\nconst geometryCache = {};\n\nexport function checkGeometryCache(hash) {\n  return geometryCache[hash];\n}\n\n/*\n * cache geometry by file hash. This might break when we start adding\n * on operators, so verify that.\n */\nexport function cacheGeometry(hash, geometry) {\n  geometryCache[hash] = geometry;\n  return geometry;\n}\n\nexport function convertToPolyMesh(data) {\n  const binaryData = validateAndRetype(data);\n  const jsonData = extractFooter(binaryData);\n  //console.log('extracted footer: ', jsonData);\n  const buffer = binaryData.buffer;\n  assert(validatePolymeshData(jsonData), 'Invalid Polymesh Data?');\n\n  const positions = readArray(buffer, jsonData.positions, 'RawFloat32');\n  const fc = readArray(buffer, jsonData.faceCount);\n  let faceCount = fc;\n  if (fc.length === 1) faceCount = fc[0];\n  const triangulationFunction = fc.length === 1 ? (fc[0] !== 3 ? staticTriangulation : noTriangulation) : dynamicTriangulation;\n  const faces = triangulationFunction(readArray(buffer, jsonData.faces), faceCount);\n\n\n  // normalMap\n  const normalMap = jsonData.normalMap && {\n    faces:  triangulationFunction(readArray(buffer, jsonData.normalMap.faces), faceCount),\n    values: readArray(buffer, jsonData.normalMap.values, 'RawFloat32'),\n  };\n\n  let uvs = null;\n\n  // uvMaps\n  if (jsonData.uvMaps && Object.keys(jsonData.uvMaps).length) {\n    uvs = {};\n    for (let attr in jsonData.uvMaps) {\n      if (jsonData.uvMaps.hasOwnProperty(attr)) {\n        const map = jsonData.uvMaps[attr];\n        // TODO for vray?: if (options.uvsToVec3Array) throw new Error('vec3ForUvs');\n\n        uvs[attr] = {\n          faces:  triangulationFunction(readArray(buffer, map.faces), faceCount),\n          values: readArray(buffer, map.values, 'RawFloat32'),\n        };\n      }\n    }\n  }\n\n  // // extra data\n  // if (tmp = jsonData.materialIds) {//this.materialIds = reader.readArray(tmp, \"RawUint32\");\n  //   let rawMtl = reader.readArray(tmp, \"RawUint32\");\n  //   if (triangulationFunction !== noTriangulation) {  // noTriangulation, material id already correct!\n  //     let nbTriangulatedFaces = this.faces.length / 3;    // already know the right size of the material ids array\n  //\n  //     let materialTriangulationFunction = (triangulationFunction === staticTriangulation) ? staticMaterialTriangulation : dynamicMaterialTriangulation;\n  //     rawMtl = materialTriangulationFunction(rawMtl, faceCount, nbTriangulatedFaces);\n  //   }\n  //   this.materialIds = rawMtl;\n  // }\n  // return this;\n  return { positions, faces, normalMap, uvs };\n}\n\nconst BIN_VERSION = 1000;\n//Things to change when we eventually upgrade the format\n// - remove all references to poseBoneToWorldTransform\n// - materialIds should be a Uint8Array or at least a Uint16Array\n// - materialIds could also be deprecated in favor of material ranges\n\n\n\n/*\n * Convert PolyMesh to bingeom\n */\nexport function convertToBingeom(polyMesh) { //{ positions, faces, normalMap, uvs }) {\n  const jsonFooter = { blendShapes: {}, colorMaps: {} }; //, uvMaps: { 'default': {}} };\n  let byteLength = 0;\n  const buffers = [];\n  const bufferFooters = [];\n\n  function extract(key, typedArray, footer, readInto) {\n    const sourceBuf = readInto ? (new readInto(typedArray)).buffer : typedArray.buffer;\n    let buf = new Uint8Array(sourceBuf, 0, typedArray.byteLength);\n\n    // pad buffer if necessary to maintain 4-byte alignment\n    const overBytes = buf.byteLength % 4;\n    let padBytes = 0;\n    if (overBytes) {\n      padBytes = 4 - overBytes;\n      const paddedBuf = new Uint8Array(buf.byteLength + padBytes);\n      paddedBuf.set(buf);\n      buf = paddedBuf;\n    }\n\n    let reuseFooter = null;\n    for (let i = 0; i < buffers.length; i++) {\n      if (equalsArrayBuffers(buf, buffers[i])) {\n        reuseFooter = bufferFooters[i];\n        break;\n      }\n    }\n\n    if (reuseFooter !== null) {\n      footer[key] = reuseFooter;\n    } else {\n      const bytesPerElement = readInto ? readInto.BYTES_PER_ELEMENT : typedArray.BYTES_PER_ELEMENT;\n      footer[key] = { b: bytesPerElement, l: buf.byteLength - padBytes, o: byteLength };\n      byteLength += buf.byteLength;\n      buffers.push(buf);\n      bufferFooters.push(footer[key]);\n    }\n    //console.log( \"extract: key\", key, \"result\", footer[key], (reuseFooter !== null ) ? 'deduped' : '');\n  }\n\n  function equalsArrayBuffers(a, b) {\n    // a and b must be Uint8Arrays.\n\n    if (a.length !== b.length) {\n      return false;\n    }\n\n    for (let i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  function offsetsSum(offsets) {\n    const arr = new Uint32Array(offsets.length - 1);\n    for (let i = 0; i < (offsets.length - 1); i++) {\n      arr[i] = offsets[i + 1] - offsets[i];\n    }\n\n    return arr;\n  }\n\n  extract('faces', polyMesh.positions.faceValueIndices, jsonFooter);\n  extract('faceCount', offsetsSum(polyMesh.faceRangeOffsets), jsonFooter);\n  extract('positions', polyMesh.positions.values.data, jsonFooter, Float32Array);\n\n  if (polyMesh.normalMap) {\n    jsonFooter.normalMap = {};\n    extract('faces', polyMesh.normalMap.faceValueIndices, jsonFooter.normalMap);\n    extract('values', polyMesh.normalMap.values.data, jsonFooter.normalMap, Float32Array);\n  }\n\n  if (polyMesh.uvMaps && polyMesh.uvMaps.length) {\n    jsonFooter.uvMaps = {};\n    polyMesh.uvMaps.namesByIndex.forEach((uvName) => {\n      const uvMap = polyMesh.uvMaps.byName[uvName];\n      jsonFooter.uvMaps[uvName] = {};\n      extract('faces', uvMap.faceValueIndices, jsonFooter.uvMaps[uvName]);\n      extract('values', uvMap.values.data, jsonFooter.uvMaps[uvName], Float32Array);\n    });\n  }\n\n  if (polyMesh.edgeCreaseWeights && polyMesh.edgeCreaseWeights.length) {\n    extract('edgeCreaseWeights', polyMesh.edgeCreaseWeights, jsonFooter, Float32Array); // don't need to convert, already Float32Array...?\n  }\n\n  if (polyMesh.skinning) {\n    jsonFooter.skinning = {};\n    extract('positionSkinRange', polyMesh.skinning.positionSkinRange, jsonFooter.skinning);\n    extract('skinWeights', polyMesh.skinning.skinWeights, jsonFooter.skinning);\n    extract('poseSkinToPoseBoneTransform', polyMesh.skinning.poseSkinToPoseBoneTransform.data, jsonFooter.skinning, Float32Array);\n    extract('skinBoneIndices', polyMesh.skinning.skinBoneIndices, jsonFooter.skinning);\n  }\n\n  let jsonFooterString = JSON.stringify(jsonFooter);\n  jsonFooterString += { 0: '', 1: '   ', 2: '  ', 3: ' ' }[jsonFooterString.length % 4];\n\n  let currentByte = 0;\n  const result = new Uint8Array(byteLength + jsonFooterString.length + 8);\n  for (let i = 0; i < buffers.length; i++) {\n    result.set(buffers[i], currentByte);\n    currentByte += buffers[i].byteLength;\n  }\n\n  for (let i = 0; i < jsonFooterString.length; i++) {\n    result[currentByte++] = jsonFooterString.charCodeAt(i);\n  }\n\n  let currentDWord = currentByte >> 2;\n  let newBytes32 = new Uint32Array(result.buffer);\n  newBytes32[currentDWord] = jsonFooterString.length;\n  newBytes32[currentDWord + 1] = BIN_VERSION;\n  return new Uint32Array(result.buffer);\n}\n\nconst polyMeshCaches = {};\n\nexport function convertToCNSPolyMesh(data, refId) {\n  if (refId && polyMeshCaches[refId]) return polyMeshCaches[refId];\n\n  const binaryData = validateAndRetype(data);\n  const jsonData = extractFooter(binaryData);\n  const buffer = binaryData.buffer;\n\n  if (jsonData && !jsonData.faceCount && !jsonData.faces && !jsonData.positions) {\n    console.warn('Warning: PolyMesh is empty.');\n    return new PolyMesh();\n  }\n\n  assert(validatePolymeshData(jsonData), 'Invalid Polymesh Data?');\n\n  const fc = readArray(buffer, jsonData.faceCount);\n  //console.log( 'CNS', CNS );\n  const importer = new Importer();\n  //console.log( 'importer', importer );\n  if (fc.length === 1) {\n    importer.defaultFaceArity = fc[0];\n  } else {\n    importer.setFaceArities(fc);\n  }\n\n  importer.collapsePositions = false;\n  importer.collapseMapValues = false;\n\n  const positionFaceIndices = readArray(buffer, jsonData.faces);\n  const positionValues = readArray(buffer, jsonData.positions, 'RawFloat32');\n\n  const positionsId = PolyMaps.id(PolyMaps.TypePosition);\n\n  importer.setMapIndices(positionsId, positionFaceIndices);\n  importer.setMapValues(positionsId, positionValues);\n\n\n  // normalMap\n  if (jsonData.normalMap) {\n\n    const normalFaceIndices = readArray(buffer, jsonData.normalMap.faces);\n    const normalValues = readArray(buffer, jsonData.normalMap.values, 'RawFloat32');\n\n    const normalsId = PolyMaps.id(PolyMaps.TypeNormal);\n\n    importer.setMapIndices(normalsId, normalFaceIndices);\n    importer.setMapValues(normalsId, normalValues);\n  }\n\n  // uvMaps\n  if (jsonData.uvMaps && Object.keys(jsonData.uvMaps).length) {\n    for (let attr in jsonData.uvMaps) {\n      if (jsonData.uvMaps.hasOwnProperty(attr)) {\n        const map = jsonData.uvMaps[attr];\n\n        const uvFaceIndices = readArray(buffer, map.faces);\n        const uvValues = readArray(buffer, map.values, 'RawFloat32');\n\n        const uvsId = PolyMaps.id(PolyMaps.TypeUV, attr);\n\n        importer.setMapIndices(uvsId, uvFaceIndices);\n        importer.setMapValues(uvsId, uvValues);\n      }\n    }\n  }\n\n  // skinning\n  if (jsonData.skinning) {\n\n    importer.setSkinning(\n      readArray(buffer, jsonData.skinning.positionSkinRange, 'RawUint32'),\n      readArray(buffer, jsonData.skinning.skinWeights, 'RawFloat32'),\n      readArray(buffer, jsonData.skinning.skinBoneIndices, 'RawUint16'),\n\n      readArray(buffer, jsonData.skinning.poseSkinToPoseBoneTransform, 'RawFloat32')\n    );\n\n  }\n\n  // edge creases\n  // Can come in 2 forms:\n  //  1) 'creases': Imported from fbx. Contains an edge crease weights array and an array of\n  //                vertex index pairs for the corresponding creased edges\n  //  2) 'edgeCreaseWeights': A single array of weights, where the edge is implied by the index, which\n  //                corresponds to the V2 polyMesh edge index. This form is preferred.\n  if (jsonData.edgeCreaseWeights) importer.setCreases(readArray(buffer, jsonData.edgeCreaseWeights, 'RawFloat32'));\n  else if (jsonData.creases) {\n    const weights = readArray(buffer, jsonData.creases.weights, 'RawFloat32');\n    const edges = readArray(buffer, jsonData.creases.edgeVertexIndices, 'RawUint32');\n    importer.setCreases(weights, edges);\n  }\n\n  if (jsonData.materialIds) {\n    importer.setMaterialIds(readArray(buffer, jsonData.materialIds, 'RawUint32'));\n  }\n\n  // TODO: add support for UVs.\n  // TODO: add support for Colors.\n  // TODO: add support for MaterialIDs.\n\n  const polyMesh = importer.toMeshAndClear();\n  //console.log('bingeom jsonDate ', jsonData);\n  //console.log('bingeom.js convertToCNSPolyMesh ', polyMesh );\n\n  if (refId) polyMeshCaches[refId] = polyMesh;\n  return polyMesh;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/bingeom.js","\nimport './three/ThreeInstanceScalarSize';\nimport './generic/utility/polyfill';\nimport Importer from './geometric/tool/Importer';\nimport PolyMesh from './geometric/model/PolyMesh';\nimport PolyMap from './geometric/model/PolyMap';\nimport PolyMaps from './geometric/model/PolyMaps';\nimport Selection from './geometric/transient/Selection';\nimport ThreeExport from './three/ThreeExport';\n\nexport {\n  Importer as Importer,\n  PolyMap as PolyMap,\n  PolyMaps as PolyMaps,\n  PolyMesh as PolyMesh,\n  Selection as Selection,\n  ThreeExport as ThreeExport,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/index.js","import * as THREE from 'three';\n\nTHREE.Vector2.InstanceScalarSize = 2;\nTHREE.Vector3.InstanceScalarSize = 3;\nTHREE.Vector4.InstanceScalarSize = 4;\n\nTHREE.Color.InstanceScalarSize = 3;\nTHREE.Quaternion.InstanceScalarSize = 4;\n\nTHREE.Matrix3.InstanceScalarSize = 9;\nTHREE.Matrix4.InstanceScalarSize = 16;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/three/ThreeInstanceScalarSize.js","[Uint32Array, Int32Array, Uint8Array, Int8Array].forEach((cls) => {\n  if (!cls.prototype.fill) {\n    Object.defineProperty(cls.prototype, 'fill', { value: function (value, start, end) {\n        start = start || 0;\n        end = end || this.length;\n        for (var i = start; i < end; i++) {\n          this[i] = value;\n        }\n\n        return this;\n      }, });\n  }\n\n  if (!cls.prototype.slice) {\n    Object.defineProperty(cls.prototype, 'slice', { value: function (start, end) {\n        var i = start === undefined ? 0 : start;\n        var finalIdx = end === undefined ? this.length : end;\n        var count = finalIdx - i;\n        var a = new this.constructor(count);\n        var n = 0;\n        while (i < finalIdx) {\n          a[n] = this[i];\n          ++n;\n          ++i;\n        }\n\n        return a;\n      }, });\n  }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/utility/polyfill.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ScalarArrayView from '../../generic/container/ScalarArrayView';\nimport Arrays from '../../generic/utility/Arrays';\nimport PolyMaps from '../model/PolyMaps';\nimport PolyMap from '../model/PolyMap';\nimport PolyMesh from '../model/PolyMesh';\nimport Skinning from '../model/Skinning';\nimport ImportConversions from '../algorithm/ImportConversions';\n\nexport default function Importer() {\n\n  this.defaultFaceArity = 3; // triangles\n  this.collapsePositions = true; // re-index positions\n  this.collapseMapValues = true; // join equal map values at the same vertex\n\n  this.faceArities = null;\n  this.materialIds = null;\n\n  this.mapIds = [];\n  this.mapValues = {};\n  this.mapIndices = {};\n\n  this.skinning = null;\n  this.creases = null;\n};\n\nImporter.prototype = {\n\n  constructor: Importer,\n\n  setFaceArities: function (array,\n      optionalNumberOfElements, optionalOffset, optionalStride) {\n\n    this.faceArities = new ScalarArrayView(\n        optionalNumberOfElements || null,\n        array,\n        optionalOffset,\n        optionalStride);\n\n    return this;\n  },\n\n  setMaterialIds: function (materialIds) {\n    for (let i = 0; i < materialIds.length; i++) {\n      //only add to the polymesh if array contains a non zero value\n      if (materialIds[i] > 0) {\n        this.materialIds = materialIds;\n        break;\n      }\n    }\n\n    return this;\n  },\n\n  setMapValues: function (mapId, array,\n      optionalNumberOfElements, optionalOffset, optionalStride) {\n\n    const id = PolyMaps.checkId(mapId);\n    const ids = this.mapIds;\n\n    if (ids.indexOf(id) === -1) ids.push(id);\n\n    this.mapValues[id] = new ObjectArrayView(\n          PolyMaps.getTypeInfo(\n              PolyMaps.getAnchorName(mapId)).ElementType,\n          optionalNumberOfElements || null,\n          !optionalOffset ? array : array.subarray(optionalOffset),\n          optionalStride);\n\n    return this;\n  },\n\n  setMapIndices: function (mapId, array,\n      optionalNumberOfElements, optionalOffset, optionalStride) {\n\n    this.mapIndices[PolyMaps.checkId(mapId)] =\n        new ScalarArrayView(\n          optionalNumberOfElements || null,\n          array,\n          optionalOffset,\n          optionalStride);\n\n    return this;\n  },\n\n  setSkinning: function (positionSkinRange, skinWeights, skinBoneIndices, poseSkinToPoseBoneTransform) {\n    this.skinning = {};\n\n    this.skinning.positionSkinRange = positionSkinRange;\n    this.skinning.skinWeights = skinWeights;\n    this.skinning.skinBoneIndices = skinBoneIndices;\n\n    this.skinning.poseSkinToPoseBoneTransform = new ObjectArrayView(THREE.Matrix4, null, poseSkinToPoseBoneTransform);\n\n    return this;\n  },\n\n  setCreases: function (weights, edges) {\n    this.creases = { weights, edges };\n  },\n\n  toMeshAndClear: function () {\n\n    const mapIds = this.mapIds;\n    const mapValueData = this.mapValues;\n    const mapIndexData = this.mapIndices;\n\n    const positionMapId = PolyMaps.IdPositions;\n    let positions = mapValueData[positionMapId];\n\n    let faceArities = this.faceArities;\n    let materialIds = this.materialIds;\n\n    if (!positions)\n      throw Error('No positions!');\n\n    const positionIndices = mapIndexData[positionMapId] || null;\n\n    const nFaceVertices = positionIndices ? positionIndices.length : positions.length;\n\n    let faceOffsets = null;\n    //  -----------\n\n    if (faceArities === null) {\n      const fixedArity = this.defaultFaceArity;\n      const nFaces = nFaceVertices / fixedArity | 0;\n\n      faceArities = new Uint32Array(nFaces + 1).fill(fixedArity, 1);\n    } else {\n      faceArities = faceArities.toArray(Uint32Array, 1);\n    }\n\n    // Here faceOffsets contains the face arities after a zero at index 0,\n    // their accumulation yields the offsets (including length sentinel):\n    faceOffsets = Arrays.accumulate(faceArities); // (in-place)\n\n    for (let i = 0; i !== mapIds.length; ++i) {\n      // avoid aliasing with the map indices in case it's the same array\n\n      const mapId = mapIds[i];\n      if (mapId === positionMapId) continue;\n\n      const mapIndexView = mapIndexData[mapId];\n\n      if (mapIndexView !== undefined)\n        mapIndexView.forceRepack(Uint32Array);\n    }\n\n    let indices = null;\n    if (this.collapsePositions) {\n      // re-index values\n      if (positionIndices !== null)\n        indices = positionIndices.repack(Uint32Array).data;\n\n      positions = ImportConversions.\n          collapsePositions(positions, indices);\n\n    } else if (positionIndices !== null) {\n      // use given indices as-is\n      indices = positionIndices.repack(Uint32Array).data;\n    }\n\n    const mesh = PolyMesh.fromData(faceOffsets, positions, indices, materialIds);\n\n    for (let i = 0; i !== mapIds.length; ++i) {\n\n      const mapId = mapIds[i];\n      if (mapId === positionMapId) continue;\n\n      const mapIndexView = mapIndexData[mapId];\n      const mapValueView = mapValueData[mapId];\n\n      const polyMap = PolyMap.fromData(\n            faceOffsets, mapIndexView.data, mapValueView);\n\n      if (this.collapseMapValues) {\n\n        ImportConversions.collapseMapVertexValues(mesh, polyMap);\n\n        polyMap.compactValues();\n      }\n\n      PolyMaps.assignMap(mesh, mapId, polyMap);\n\n    }\n\n    if (this.skinning) mesh.skinning = new Skinning(this.skinning);\n\n    if (this.creases) {\n      const { weights, edges } = this.creases;\n      // if edges array exists, need to calculate edge indices from the vertex pairs\n      if (edges) { // generate edge indices from vertex pairs\n        const edgeVertexAdjacency = mesh.positions.edgeVertexAdjacency;\n        const edgeWeights = new Float32Array(edgeVertexAdjacency.getNumEdges());\n        for (let i = 0, e = 0; i < edges.length; i += 2, e++) {\n          edgeWeights[edgeVertexAdjacency.findEdgeId(edges[i], edges[i + 1])] = weights[e];\n        }\n\n        mesh.edgeCreaseWeights = edgeWeights;\n      } else mesh.edgeCreaseWeights = weights; // no edges array, assume weight index = edge index\n    }\n\n    Importer.call(this); // re-run constructor to clear state\n\n    return mesh;\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/tool/Importer.js","import Arrays from '../utility/Arrays';\nimport FlatArrayView from './FlatArrayView';\nimport ObjectBuffer from './ObjectBuffer';\n\n/**\n * Object view mapping fixed size objects to flat arrays.\n *\n * @constructor\n *\n * @param {!function(new:*)} type\n *\n *    object constructor\n *\n * @param {number} length\n *\n *    number of objects to map,\n *    can be null when an existing array is given,\n *\n * @param {ArrayOrType=} optionalArrayOrType\n *\n *    existing array or array constructor, default is Float32Array\n *\n * @param {number=} optionalStride\n *\n *    an explicit stride for cases where it differs from the element size\n *    deduced from {@code type.InstanceScalarSize}\n */\nexport default function ObjectArrayView(type, length,\n    optionalArrayOrType, optionalStride) {\n\n  const elementSize = type.InstanceScalarSize || optionalStride;\n  const stride = optionalStride || elementSize;\n  const arrayLength = length !== null ? length * stride : null;\n\n  if (elementSize === undefined || stride === undefined)\n    throw Error(\"Can't determine element size / stride!\");\n\n  const existingArrayOrType = optionalArrayOrType || Float32Array;\n\n  const array = Arrays.maybeCreate(\n        existingArrayOrType, arrayLength);\n\n  FlatArrayView.call(this, array, length ||\n      // Note: Integer division by 'stride', rounding towards infinity\n      // at a minimum remainder of 'elementSize':\n      (array.length + stride - elementSize) / stride | 0);\n\n  this.type = type;\n  this.stride = stride;\n  this.elementSize = elementSize;\n  this.tempBuffer = new Float32Array(elementSize);\n\n};\n\nObjectArrayView.prototype =\n    Object.assign(Object.create(FlatArrayView.prototype), {\n\n  constructor: ObjectArrayView,\n\n  getAt: function (index, optionalValue) {\n\n    const result = optionalValue || new this.type();\n    return result.fromArray(this.data, index * this.stride);\n  },\n\n  setAt: function (index, value) {\n\n    value.toArray(this.data, index * this.stride);\n  },\n\n  addAt: function (index, value) {\n\n    value.toArray(this.tempBuffer, 0);\n    for (let i = 0, offset = index * this.stride; i < this.elementSize; i++) {\n      this.data[offset + i] += this.tempBuffer[i];\n    }\n\n  },\n\n  multiplyScalarAt: function (index, scalar) {\n\n    for (let i = 0, offset = index * this.stride; i < this.elementSize; i++) {\n      this.data[offset + i] *= scalar;\n    }\n\n  },\n\n  newCompatibleView: function (arrayOrType, optionalLength) {\n\n    return new ObjectArrayView(\n        this.type, optionalLength || null, arrayOrType, this.stride);\n  },\n\n  newCompatibleBuffer: function () {\n\n    return new ObjectBuffer(\n        this.type, this.data.constructor, this.stride);\n  },\n\n});\n\nObjectArrayView.fromObjects = function (type, objects, optionalArrayType) {\n\n  const result = new ObjectArrayView(\n      type, objects.length, optionalArrayType);\n\n  Arrays.copyObjects(objects, result.data);\n  return result;\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/container/ObjectArrayView.js","module.exports = { \"default\": require(\"core-js/library/fn/object/create\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/create.js\n// module id = 188\n// module chunks = 0 1 2","require('../../modules/es6.object.create');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function create(P, D){\n  return $Object.create(P, D);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/object/create.js\n// module id = 189\n// module chunks = 0 1 2","var $export = require('./_export')\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', {create: require('./_object-create')});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.object.create.js\n// module id = 190\n// module chunks = 0 1 2","import Orders from './Orders';\n\n/**\n * @typedef {(function(new:Array)|Array)} ArrayOrType\n */\n\n/**\n * Various utilities for working with arrays.\n *\n * @namespace\n */\nconst Arrays = {\n\n  /**\n   * Empty arrays.\n   *\n   * @namespace\n   */\n  Empty: Object.freeze({\n\n    /** @const @type {!Array} */\n    Array: Object.freeze(new Array(0)),\n\n    // Note: Typed arrays can't - and don't have to frozen, since\n    // they have an immutable length.\n\n    /** @const @type {!Array<!number>} */\n    Float64Array: new Float64Array(0),\n    /** @const @type {!Array<!number>} */\n    Float32Array: new Float32Array(0),\n    /** @const @type {!Array<!number>} */\n    Uint32Array: new Uint32Array(0),\n    /** @const @type {!Array<!number>} */\n    Int32Array: new Int32Array(0),\n\n  }),\n\n  //\n\n  rangeCopy: function (src, srcOffset, dst, dstOffset, length) {\n\n    for (let i = 0; i !== length; ++i)\n      dst[dstOffset + i] = src[srcOffset + i];\n\n    return dst;\n\n  },\n\n  rangeEquals: function (a, aStart, b, bStart, length) {\n\n    for (let i = 0; i !== length; ++i)\n      if (a[aStart + i] !== b[bStart + i]) return false;\n\n    return true;\n\n  },\n\n  stridedCopy: function (src, srcOffset, srcStride,\n      dst, dstOffset, dstStride, elementLength, numElements) {\n\n    for (let i = 0; i !== numElements; ++i)\n    for (let j = 0; j !== elementLength; ++j)\n\n      dst[dstOffset + i * dstStride + j] =\n          src[srcOffset + i * srcStride + j];\n\n    return dst;\n\n  },\n\n  /**\n   * For each element add the previous element.\n   *\n   * @param {!Array<!number>} array\n   */\n  accumulate: function (array) {\n\n    for (let i = 1, n = array.length; i < n; ++i)\n      array[i] += array[i - 1];\n\n    return array;\n\n  },\n\n  slice: function (array, from, optionalTo) {\n\n    // Not all browsers have .slice for typed arrays...\n\n    return array.slice !== undefined ?\n        array.slice(from, optionalTo) :\n        new array.constructor(array.subarray(from, optionalTo));\n\n  },\n\n  clone: function (array) {\n\n    // Not all browsers have .slice for typed arrays...\n\n    return array !== null ? (array.slice !== undefined ?\n        array.slice(0) :\n        new array.constructor(array)) : null;\n\n  },\n\n  binarySearch: function (array, elem, optionalBegin, optionalUntil) {\n\n    let left = optionalBegin === undefined ? 0 : optionalBegin,\n      right = optionalUntil === undefined ?\n          array.length - left : optionalUntil,\n\n      rightBound = right;\n\n    while (left < right) {\n\n      let mid = (left + right) >>> 1,\n        midVal = array[mid];\n\n      if (midVal < elem) left = mid + 1;\n      else right = mid;\n\n    }\n\n    return left < rightBound && array[left] === elem ? left : ~left;\n\n  },\n\n  sort: function (array, optionalOrder) {\n\n    // TODO: Optimized sorting - a likely and improvable bottleneck:\n    //\n    // - A customized sort beats Chrome by a factor of 18 at block\n    //   sizes of 10.000 elements, where the performance is roughly\n    //   equal for a few elements. At this scale Chrome is already\n    //   3-4 times slower than Firefox - the more elements there are\n    //   the worse it gets.\n    //\n    // - The same routine beats Firefox by a factor of 5 with small\n    //   block sizes, where the performance becomes roughly equal at\n    //   10.000 elements.\n    //\n    // My test code did not contain duplicate elements (and does not\n    // handle them well, in the moment) and used a Quicksort with a\n    // median index pivot (which is rather lousy). It did implement\n    // a decent partitioner based on Hoare's algorithm, though.\n\n    if (array.sort !== undefined) {\n\n      return array.sort(optionalOrder || Orders.Numeric);\n\n    } else { // some browsers may not yet support the above\n\n      return Array.prototype.sort.call(array,\n          optionalOrder || Orders.Numeric);\n    }\n\n    return array;\n\n  },\n\n  unique: function (sortedArray, optionalOrder) {\n\n    const n = sortedArray.length;\n\n    if (n <= 1) return sortedArray.length;\n\n    let writeIndex = 0,\n      prevValue = sortedArray[0];\n\n    if (optionalOrder === undefined) {\n\n      for (let i = 1; i !== n; ++i) {\n\n        const value = sortedArray[i];\n        if (value !== prevValue) {\n\n          prevValue = value;\n\n          if (++writeIndex !== i)\n            sortedArray[writeIndex] = value;\n        }\n      }\n\n    } else {\n\n      const compare = optionalOrder;\n\n      if (!optionallyBuiltMap) {\n\n        for (let i = 1; i !== n; ++i) {\n\n          const value = sortedArray[i];\n          if (compare(value, prevValue) !== 0) {\n\n            prevValue = value;\n\n            if (++writeIndex !== i)\n              sortedArray[writeIndex] = value;\n          }\n        }\n\n      }\n\n    }\n\n    return writeIndex + 1; // new length\n  },\n\n  //\n\n  /**\n   * Utiltiy function for taking an argument that is either an existing\n   * array or an array type / constructor.\n   *\n   * Example:\n   * <pre>\n   * const array = Arrays.maybeCreate( arg || Uint32Array, n );\n   * </pre>\n   *\n   * @param {!ArrayOrType} existingArrayOrType\n   * @param {number=} requiredLength\n   * @throws Error when argument missing or an array and too short\n   */\n  maybeCreate: function (existingArrayOrType, requiredLength) {\n    if (!existingArrayOrType) throw Error('Missing array!');\n\n    const validLength =\n        requiredLength !== null && !isNaN(requiredLength);\n\n    // Safari returns \"object\" for typeof Uint32Array, Float32Array, etc, so use instanceof\n    if ((typeof existingArrayOrType === 'function') || (existingArrayOrType instanceof Function)) {\n\n      if (!validLength)\n        throw Error('Missing or invalid length!');\n\n      // Note: Browsers show wEirD behavior when it comes to\n      // argument checks of typed array constructors...\n\n      return new existingArrayOrType(requiredLength);\n\n    }\n\n    // otherwise assume we got an existing array\n\n    if (validLength && existingArrayOrType.length < requiredLength)\n\n      throw Error('Array too short: ' +\n          existingArrayOrType.length + ' < ' + requiredLength);\n\n    return existingArrayOrType;\n  },\n\n  copyObjects: function (objects, array, optionalStride) {\n\n    if (!objects) return null;\n\n    const nObjects = objects.length;\n    if (nObjects === 0) return array;\n\n    const stride =\n        objects[0].constructor.InstanceScalarSize || optionalStride;\n\n    if (stride === undefined)\n      throw Error('Arrays.fromObjects: Cannot determine stride!');\n\n    const result = Arrays.maybeCreate(arrayOrType, nObjects * stride);\n\n    for (let i = 0, offset = 0; i !== nObjects; ++i, offset += stride) {\n\n      const object = objects[i];\n\n      if (object === undefined) {\n        console.warn('Arrays.fromObjects: Undefined object.');\n        array.fill(0, offset, offset + stride);\n        continue;\n      }\n\n      object.toArray(array, offset);\n\n    }\n\n    return array;\n\n  },\n\n};\n\nexport default Arrays;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/utility/Arrays.js","module.exports = { \"default\": require(\"core-js/library/fn/object/freeze\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/freeze.js\n// module id = 192\n// module chunks = 0 1 2","require('../../modules/es6.object.freeze');\nmodule.exports = require('../../modules/_core').Object.freeze;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/object/freeze.js\n// module id = 193\n// module chunks = 0 1 2","// 19.1.2.5 Object.freeze(O)\nvar isObject = require('./_is-object')\n  , meta     = require('./_meta').onFreeze;\n\nrequire('./_object-sap')('freeze', function($freeze){\n  return function freeze(it){\n    return $freeze && isObject(it) ? $freeze(meta(it)) : it;\n  };\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.object.freeze.js\n// module id = 194\n// module chunks = 0 1 2","const Orders = {\n\n  Numeric: function (a, b) { return a - b; },\n\n  Natural: function (a, b) { return a < b ? -1 : b < a ? 1 : 0; },\n\n  // Note: Unstable compare functions are not an optimization.\n  // Some operations require to detect equality!\n\n  derefedNumbersIn: function (array) {\n\n    return function compare(a, b) { return array[a] - array[b]; };\n\n  },\n\n  derefedTuplesIn: function (array, elementSize, optionalStride) {\n\n    if (!elementSize) throw Error('Invalid element size!');\n\n    const stride = optionalStride || elementSize;\n\n    if (stride === 1 && elementSize === 1)\n      return Orders.derefNumbersIn(array);\n\n    return function compare(a, b) {\n\n      const offsetA = a * stride;\n      const offsetB = b * stride;\n\n      let result = array[offsetA] - array[offsetB];\n\n      for (let i = 1; i !== elementSize && result === 0; ++i)\n\n        result = array[offsetA + i] - array[offsetB + i];\n\n      return result;\n    };\n\n  },\n\n  derefedNumbersStableIn: function (array) {\n\n    return function compare(a, b) {\n\n      const result = array[a] - array[b];\n      return result !== 0 ? result : a - b;\n\n    };\n\n  },\n\n  derefedTuplesStableIn: function (array, elementSize, optionalStride) {\n\n    if (!elementSize) throw Error('Invalid element size!');\n\n    const stride = optionalStride || elementSize;\n\n    if (stride === 1 && elementSize === 1)\n      return Orders.derefNumbersStableIn(array);\n\n    return function compare(a, b) {\n\n      const offsetA = a * stride;\n      const offsetB = b * stride;\n\n      let result = array[offsetA] - array[offsetB];\n\n      for (let i = 1; i !== elementSize && result === 0; ++i)\n\n        result = array[offsetA + i] - array[offsetB + i];\n\n      return result !== 0 ? result : a - b;\n    };\n\n  },\n\n};\n\nexport default Orders;\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/utility/Orders.js","import Arrays from '../utility/Arrays';\nimport Orders from '../utility/Orders';\n\nexport default function FlatArrayView(data, length) {\n\n  this.data = data;\n  this.length = length;\n};\n\nFlatArrayView.prototype = {\n\n  constructor: FlatArrayView,\n\n  offset: 0,    // in scalars, constant default\n  stride: 1,    // in scalars, constant default\n  elementSize: 1, // in scalars, constant default\n\n  // Access to element ranges\n\n  newRangeArray: function (optionalNumberOfElements) {\n\n    const n = optionalNumberOfElements || 1;\n    return new this.data.constructor(n * this.elementSize);\n  },\n\n  rangeToArray: function (index, n, optionalArray, optionalWriteOffset) {\n\n    const data = this.data;\n    const stride = this.stride;\n    const elemSize = this.elementSize;\n\n    const array = optionalArray ||\n          new this.data.constructor(n * this.elementSize);\n    let writeOffset = optionalWriteOffset || 0;\n\n    for (let offset = this.offset + index * stride,\n        end = offset + n * stride; offset < end; offset += stride)\n\n      for (let i = offset, e = offset + elemSize; i !== e; ++i)\n\n        array[writeOffset++] = data[i];\n\n    return array;\n\n  },\n\n  arrayToRange: function (array, index, n, optionalReadOffset) {\n\n    const data = this.data;\n    const stride = this.stride;\n    const elemSize = this.elementSize;\n    let readOffset = optionalReadOffset || 0;\n\n    for (let offset = this.offset + index * stride,\n        end = offset + n * stride; offset < end; offset += stride)\n\n      for (let i = offset, e = offset + elemSize; i !== e; ++i)\n\n        data[i] = array[readOffset++];\n\n    return this;\n\n  },\n\n  // Bulk copy operations\n\n  toArray: function (optionalArrayOrType, optionalOffset) {\n\n    const stride = this.stride;\n    const length = this.length;\n    const elemSize = this.elementSize;\n    const writeOffset = optionalOffset === undefined ? 0 : optionalOffset;\n    const minimumLength = writeOffset + length * elemSize;\n\n    if (stride === elemSize) {\n      // data is packed, can use typed array API\n\n      const data = this.data;\n      const offset = this.offset;\n      const dataEnd = offset + length * elemSize;\n\n      if (writeOffset === 0 && (\n          optionalArrayOrType === undefined ||\n          optionalArrayOrType === this.data.constructor))\n\n        return Arrays.slice(data, offset, dataEnd);\n\n      const array = Arrays.maybeCreate(\n          optionalArrayOrType, minimumLength);\n\n      array.set(data.subarray(offset, dataEnd), writeOffset);\n\n      return array;\n\n    } else {\n      // data is strided, twiddle it apart\n\n      const array = Arrays.maybeCreate(\n          optionalArrayOrType, minimumLength);\n\n      return this.rangeToArray(0, length, array, optionalOffset);\n\n    }\n\n  },\n\n  fromArray: function (array, optionalOffset) {\n\n    const stride = this.stride;\n    const length = this.length;\n    const elemSize = this.elementSize;\n    const readOffset = optionalOffset === undefined ? 0 : optionalOffset;\n    const minimumLength = readOffset + length * elemSize;\n\n    if (stride === elemSize) {\n      // data is packed, can use typed array API\n\n      const readView = readOffset === 0 && array.length === minimumLength ?\n          array : array.subarray(readOffset, minimumLength);\n\n      this.data.set(readView, this.offset);\n\n    } else {\n      // data is strided, scatter it\n\n      return this.arrayToRange(array, 0, length, readOffset);\n    }\n\n    return this;\n\n  },\n\n  // Array data management\n\n  repack: function (optionalArrayType) {\n\n    const currentArrayType = this.data.constructor;\n    const requestedArrayType = optionalArrayType || currentArrayType;\n\n    if (this.stride !== this.elementSize ||\n        requestedArrayType !== currentArrayType)\n\n      this.forceRepack(optionalArrayType);\n\n    return this;\n\n  },\n\n  forceRepack: function (optionalArrayType) {\n\n    this.data = this.toArray(optionalArrayType);\n    this.offset = 0;\n    this.stride = this.elementSize;\n\n    return this;\n\n  },\n\n  // Factory methods for views / buffers\n\n  clone: function () {\n\n    return this.newCompatibleView(this.toArray(), this.length);\n  },\n\n  newCompatibleView: function (arrayOrType, optionalLength) {\n\n    throw Error('not implemented'); // abstract\n\n  },\n\n  newCompatibleBuffer: function () {\n\n    throw Error('not implemented'); // abstract\n\n  },\n\n  // Factory methods for compare functions\n\n  newCompareAtIndices: function () {\n\n    return Orders.derefedTuplesIn(\n        this.data, this.elementSize, this.stride);\n\n  },\n\n  newCompareAtIndicesStable: function () {\n\n    return Orders.derefedTuplesStableIn(\n        this.data, this.elementSize, this.stride);\n\n  },\n\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/container/FlatArrayView.js","import BlockBuffer from './BlockBuffer';\nimport ObjectArrayView from './ObjectArrayView';\n\nexport default function ObjectBuffer(type, optionalArrayType, optionalElementSize) {\n\n  BlockBuffer.call(this, optionalArrayType || Float32Array);\n\n  this.elementSize = optionalElementSize || type.InstanceScalarSize;\n  this.type = type;\n\n};\n\nObjectBuffer.prototype =\n    Object.assign(Object.create(BlockBuffer.prototype), {\n\n  constructor: ObjectBuffer,\n\n  toObjectArrayViewAndClear: function () {\n\n    return new ObjectArrayView(\n        this.type, null, this.toArrayAndClear());\n\n  },\n\n  getAt: function (index, optionalValue) {\n\n    const result = optionalValue || new this.type();\n\n    const blockIndex = index >> this.intraBlockIndexBits;\n    const blockOffset = index & this.intraBlockIndexMask;\n\n    return result.fromArray(\n        this.blocks[blockIndex], blockOffset * this.elementSize);\n\n  },\n\n  setAt: function (index, value) {\n\n    const blockIndex = index >> this.intraBlockIndexBits;\n    const blockOffset = index & this.intraBlockIndexMask;\n\n    value.toArray(\n        this.blocks[blockIndex], blockOffset * this.elementSize);\n\n  },\n\n  push: function (value) {\n\n    const index = this.length++;\n    let block = this.lastBlock;\n    const blockOffset = index & this.intraBlockIndexMask;\n\n    if (blockOffset === 0) {\n\n      const blockSize = this.intraBlockIndexMask + 1;\n      block = new this.arrayType(blockSize * this.elementSize);\n      this.lastBlock = block;\n      this.blocks.push(block);\n\n    }\n\n    value.toArray(block, blockOffset * this.elementSize);\n\n    return index + 1;\n\n  },\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/container/ObjectBuffer.js","import Arrays from '../utility/Arrays';\n\nexport default function BlockBuffer(arrayType, nIntraBlockIndexBits) {\n\n  this.blocks = [];\n  this.lastBlock = null;\n  this.arrayType = arrayType;\n\n  const nBits = nIntraBlockIndexBits || 12;\n  this.intraBlockIndexBits = nBits;\n  this.intraBlockIndexMask = (1 << nBits) - 1;\n\n  this.length = 0;\n\n};\n\nBlockBuffer.prototype = {\n\n  constructor: BlockBuffer,\n\n  elementSize: 1, // in scalars, constant default\n\n  toArrayAndClear: function () {\n\n    const result = this.toArray();\n    this.clear();\n    return result;\n  },\n\n  newRangeArray: function (optionalNumberOfElements) {\n\n    const n = optionalNumberOfElements || 1;\n    return new this.arrayType(n * this.elementSize);\n  },\n\n  rangeToArray: function (index, n, optionalArray, optionalWriteOffset) {\n\n    const intraBlockIndexMask = this.intraBlockIndexMask;\n    const elementSize = this.elementSize;\n\n    let blockIndex = index >> this.intraBlockIndexBits;\n    let blockOffset = index & intraBlockIndexMask;\n\n    let block = this.blocks[blockIndex];\n\n    const array = optionalArray || new this.arrayType(n * elementSize);\n    let writeOffset =\n          optionalWriteOffset === undefined ? 0 : optionalWriteOffset;\n\n    for (let i = 0; i < n; ++i) {\n\n      for (let j = blockOffset * elementSize,\n          s = j + elementSize; j !== s; ++j)\n\n        array[writeOffset++] = block[j];\n\n      if ((++blockOffset & intraBlockIndexMask) === 0)\n\n        block = this.blocks[++blockIndex];\n    }\n\n    return array;\n  },\n\n  arrayToRange: function (array, index, n, optionalReadOffset) {\n\n    const intraBlockIndexMask = this.intraBlockIndexMask;\n    const elementSize = this.elementSize;\n\n    let blockIndex = index >> this.intraBlockIndexBits;\n    let blockOffset = index & intraBlockIndexMask;\n\n    let block = this.blocks[blockIndex];\n\n    let readOffset =\n          optionalReadOffset === undefined ? 0 : optionalReadOffset;\n\n    for (let i = 0; i < n; ++i) {\n\n      for (let j = blockOffset * elementSize,\n          s = j + elementSize; j !== s; ++j)\n\n        block[j] = array[readOffset++];\n\n      if ((++blockOffset & intraBlockIndexMask) === 0)\n\n        block = this.blocks[++blockIndex];\n    }\n\n    return this;\n  },\n\n  pushArrayRange: function (array, n, optionalReadOffset) {\n\n    const intraBlockIndexMask = this.intraBlockIndexMask;\n    const elementSize = this.elementSize;\n\n    let blockOffset = this.length; // masked later\n\n    let block = this.lastBlock;\n\n    let readOffset =\n          optionalReadOffset === undefined ? 0 : optionalReadOffset;\n\n    for (let i = 0; i < n; ++i) {\n\n      if ((blockOffset &= intraBlockIndexMask) === 0) {\n\n        const blockSize = intraBlockIndexMask + 1;\n        block = new this.arrayType(blockSize * elementSize);\n        this.lastBlock = block;\n        this.blocks.push(block);\n      }\n\n      for (let j = blockOffset++ * elementSize,\n          s = j + elementSize; j !== s; ++j)\n\n        block[j] = array[readOffset++];\n    }\n\n    return this.length += n;\n  },\n\n  clear: function () {\n\n    this.blocks = [];\n    this.length = 0;\n    this.lastBlock = null;\n\n    return this;\n  },\n\n  toArray: function (optionalArrayOrType, optionalOffset) {\n\n    let writeOffset = optionalOffset === undefined ? 0 : optionalOffset;\n    const elementSize = this.elementSize;\n    const minArraySize = this.length * elementSize + writeOffset;\n\n    const array = Arrays.maybeCreate(\n          optionalArrayOrType || this.arrayType, minArraySize);\n\n    let blocks = this.blocks;\n    const blockSize = (1 << this.intraBlockIndexBits) * elementSize;\n    const nFullBlocks = Math.max(blocks.length - 1, 0);\n\n    for (let i = 0; i !== nFullBlocks; ++i) {\n\n      array.set(blocks[i], writeOffset);\n      writeOffset += blockSize;\n    }\n\n    const lastBlockUse = minArraySize - writeOffset;\n\n    if (lastBlockUse !== 0)\n      array.set(blocks[nFullBlocks].subarray(0, lastBlockUse), writeOffset);\n\n    return array;\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/container/BlockBuffer.js","import Arrays from '../utility/Arrays';\nimport FlatArrayView from './FlatArrayView';\nimport ScalarBuffer from './ScalarBuffer';\n\nexport default function ScalarArrayView(length,\n    optionalArrayOrType, optionalOffset, optionalStride) {\n\n  const offset = optionalOffset === undefined ? 0 : optionalOffset;\n  const stride = optionalStride === undefined ? 1 : optionalStride;\n\n  const offsetLength = (offset + stride - 1) / stride | 0;\n  const minArrayLength = length !== null ?\n        (offsetLength + length) * stride : null;\n\n  const array = Arrays.maybeCreate(\n      optionalArrayOrType || Uint32Array, minArrayLength);\n\n  FlatArrayView.call(this, array, length !== null ? length :\n    // figure out length from user-provided array\n    (array.length - offset + stride - 1) / stride | 0);\n\n  this.offset = offset;\n  this.stride = stride;\n\n};\n\nScalarArrayView.prototype =\n    Object.assign(Object.create(FlatArrayView.prototype), {\n\n  constructor: ScalarArrayView,\n\n  getAt: function (index) {\n\n    return this.array[this.offset + index * this.stride];\n  },\n\n  setAt: function (index, value) {\n\n    this.array[this.offset + index * this.stride] = value;\n  },\n\n  newCompatibleView: function (arrayOrType, optionalLength) {\n\n    return new ScalarArrayView(optionalLength || null, arrayOrType, 0);\n  },\n\n  newCompatibleBuffer: function () {\n\n    return new ScalarBuffer(this.data.constructor);\n  },\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/container/ScalarArrayView.js","import BlockBuffer from './BlockBuffer';\n\nexport default function ScalarBuffer(optionalArrayType) {\n\n  BlockBuffer.call(this, optionalArrayType || Uint32Array);\n\n};\n\nScalarBuffer.prototype =\n    Object.assign(Object.create(BlockBuffer.prototype), {\n\n  constructor: ScalarBuffer,\n\n  getAt: function (index) {\n\n    const blockIndex = index >> this.intraBlockIndexBits;\n    const blockOffset = index & this.intraBlockIndexMask;\n\n    return this.blocks[blockIndex][blockOffset];\n\n  },\n\n  setAt: function (index, value) {\n\n    const blockIndex = index >> this.intraBlockIndexBits;\n    const blockOffset = index & this.intraBlockIndexMask;\n\n    this.blocks[blockIndex][blockOffset] = value;\n    return this;\n\n  },\n\n  push: function (value) {\n\n    const index = this.length++;\n    let block = this.lastBlock;\n    const blockOffset = index & this.intraBlockIndexMask;\n\n    if (blockOffset === 0) {\n\n      const blockSize = this.intraBlockIndexMask + 1;\n      block = new this.arrayType(blockSize);\n      this.lastBlock = block;\n      this.blocks.push(block);\n\n    }\n\n    block[blockOffset] = value;\n\n    return index + 1;\n\n  },\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/container/ScalarBuffer.js","import ObjectsByName from '../../generic/container/ObjectsByName';\nimport * as THREE from 'three';\n\nexport default function PolyMaps() {\n\n  ObjectsByName.call(this);\n\n};\n\nPolyMaps.prototype = Object.create(ObjectsByName.prototype);\nPolyMaps.prototype.constructor = PolyMaps;\n\n// Pretty much an alias to ObjectsByName, adding a static interface\n// and a custom iterator for uniform access of maps within a mesh...\n\nObject.assign(PolyMaps, {\n\n  TypePosition: 1,\n  TypeNormal: 2,\n  TypeTangent: 4,\n  TypeUV: 8,\n  TypeColor: 16,\n\n  id: function (typeId, name) {\n\n    const anchorName = PolyMaps.TypeInfo[typeId].AnchorName;\n    return name != null ? anchorName + '.' + name : anchorName;\n  },\n\n  checkId: function (id) {\n\n    const anchorName = PolyMaps.getAnchorName(id);\n    const mapName = PolyMaps.getMapName(id, anchorName);\n    const typeInfo = PolyMaps.getTypeInfo(anchorName);\n\n    if (typeInfo === null || mapName === '')\n      throw Error(\"Invalid PolyMap ID '\" + id + \"'!\");\n\n    return id;\n  },\n\n  getAnchorName: function (id) {\n\n    const dot = id.indexOf('.');\n    return dot === -1 ? id : id.slice(0, dot);\n  },\n\n  getMapName: function (id, anchorName) {\n\n    return id === anchorName ? null :\n        id.slice(anchorName.length + 1);\n  },\n\n  getTypeInfo: function (anchorName) {\n\n    const info = PolyMaps.TypeInfo;\n    for (let i = 0, n = info.length; i !== n; ++i) {\n      const entry = info[i];\n      if (entry !== null &&\n          entry.AnchorName === anchorName) return info[i];\n    }\n\n    return null;\n  },\n\n  resolveMap: function (mesh, id) {\n\n    const anchorName = PolyMaps.getAnchorName(id);\n    if (id === anchorName) return mesh[anchorName];\n\n    const maps = mesh[anchorName];\n    return maps && maps.byName[id.slice(anchorName.length + 1)];\n  },\n\n  assignMap: function (mesh, id, map) {\n\n    const anchorName = PolyMaps.getAnchorName(id);\n    const mapName = PolyMaps.getMapName(id, anchorName);\n\n    if (mapName === null) {\n\n      mesh[anchorName] = map;\n\n    } else {\n\n      let maps = mesh[anchorName];\n\n      if (maps === null) {\n\n        maps = new PolyMaps();\n        mesh[anchorName] = maps;\n\n      }\n\n      maps.set(mapName, map);\n\n    }\n\n  },\n\n  Iterator: function (mesh) {\n\n    ObjectsByName.Iterator.call(this);\n    this.reset(mesh || null);\n  },\n\n});\n\nPolyMaps.TypeInfo = [\n  null,\n  { // 1\n    Type: PolyMaps.TypePosition,\n    AnchorName: 'positions',\n    ElementType: THREE.Vector3,\n  }, { // 2\n    Type: PolyMaps.TypeNormal,\n    AnchorName: 'normalMap',\n    ElementType: THREE.Vector3,\n  }, null, { // 4\n    Type: PolyMaps.TypeTangent,\n    AnchorName: 'tangentMap',\n    ElementType: THREE.Vector3,\n  }, null, null, null, { // 8\n    Type: PolyMaps.TypeUV,\n    AnchorName: 'uvMaps',\n    ElementType: THREE.Vector2,\n  }, null, null, null, null, null, null, null, {\n    Type: PolyMaps.TypeColor,\n    AnchorName: 'colorMaps',\n    ElementType: THREE.Color,\n  },\n];\n\nObject.assign(PolyMaps, {\n\n  IdPositions: PolyMaps.id(PolyMaps.TypePosition),\n  IdNormals: PolyMaps.id(PolyMaps.TypeNormal),\n  IdTangents: PolyMaps.id(PolyMaps.TypeTangent),\n\n});\n\nPolyMaps.Iterator.prototype = Object.assign(\n    Object.create(ObjectsByName.Iterator.prototype), {\n\n  constructor: PolyMaps.Iterator,\n  _super: ObjectsByName.Iterator.prototype,\n\n  reset: function (optionalMesh) {\n\n    this._super.reset.call(this, null);\n\n    const mesh = optionalMesh || null;\n    this.mesh = mesh;\n    this.byName = mesh;\n    this.typeId = 0;\n\n  },\n\n  getId: function () {\n\n    return PolyMaps.id(this.typeId, this.name);\n\n  },\n\n  next: function () {\n\n    // Note: Not using dynamic resolution here because it may impact\n    // compiler optimizations in a negative way.\n\n    // If iterating a collection, keep going:\n\n    if (this._super.next.call(this)) return true;\n\n    // Otherwise count up the id:\n\n    const mesh = this.mesh;\n    let type = this.typeId;\n\n    let elem = null;\n    let object = null;\n\n    type <<= 1;\n\n    switch (type) {\n\n      case 0:\n        type = 1;\n        // v-v-v\n\n      case PolyMaps.TypePosition:\n        elem = mesh.positions;\n        break;\n\n      case PolyMaps.TypeNormal:\n        elem = mesh.normalMap;\n        break;\n\n      case PolyMaps.TypeTangent:\n        elem = mesh.tangentMap;\n        break;\n\n      case PolyMaps.TypeUV:\n        object = mesh.uvMaps;\n        break;\n\n      case PolyMaps.TypeColor:\n        object = mesh.colorMaps;\n        break;\n\n      default:\n\n        this.reset(null);\n        return false;\n\n    }\n\n    this.typeId = type;\n\n    if (object !== null && object !== undefined) {\n\n      this.byName = object.byName;\n      return this._super.reset.call(this, object).next();\n\n    } else if (elem !== null && elem !== undefined) {\n\n      this.element = elem;\n      this.index = type;\n      this.name = null;\n      return true;\n\n    }\n\n    return this.next();\n\n  },\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/model/PolyMaps.js","/**\n * This class works around the problem that {@code for .. in} loops poison\n * the surrounding function and inhibit all optimizations with V8. This is\n * of course undesirable, especially since some data processing may happen\n * in the same function, and redundant workarounds would obscure the code.\n *\n * Therefore we use an extra data structure with an array of names.\n *\n * A noteworthy property is that there is no reliance on the indices, so\n * {@code .namesByIndex} can be sorted (unless within an ongoing iteration,\n * of course) in-place, e.g. alphabetically or by use frequency for UI or\n * caching purposes.\n *\n * Further, we provide a nested {@code Iterator} class that treats {@code\n * null} values gracefully.\n *\n * Example:\n * <pre>\n * // Create an iterator\n * const iterator = new ObjectsByName.Iterator( objects );\n *\n * // Iterate when this.objects is an ObjectsByName instance, do nothing\n * // in case it is null\n * for ( iterator.next(); ) {\n *     // [... use iterator.name, iterator.index and iterator.element ...]\n * }\n * </pre>\n *\n * @template T\n * @constructor\n */\nexport default function ObjectsByName() {\n\n  /** @const @type {!Object<!string,T>} */\n  this.byName = {};\n\n  /** @const @type {!Array<T>} */\n  this.namesByIndex = [];\n\n};\n\nObjectsByName.prototype = {\n\n  constructor: ObjectsByName,\n\n  /** @type {!number} */\n  get length() {\n    return this.namesByIndex.length;\n  },\n\n  set: function (name, object) {\n\n    const byName = this.byName;\n    if (name in byName === false) this.namesByIndex.push(name);\n    byName[name] = object;\n  },\n\n};\n\n/**\n * @template T\n * @constructor\n * @param {ObjectsByName<T>=} optionalContainer\n */\nObjectsByName.Iterator = function (optionalContainer) {\n\n  this.reset(optionalContainer || null);\n\n};\n\nObjectsByName.Iterator.prototype = {\n\n  constructor: ObjectsByName.Iterator,\n\n  /**\n   * @param {ObjectsByName<T>=} optionalContainer\n   * @return {!ObjectsByName.Iterator<T>}\n   */\n  reset: function (optionalContainer) {\n\n    if (optionalContainer !== undefined)\n      this.container = optionalContainer;\n\n    this.name = null;\n    this.index = -1;\n    this.element = null;\n    return this;\n\n  },\n\n  /**\n   * @return {!boolean}\n   */\n  next: function () {\n\n    const map = this.container;\n    if (map === null) return false;\n\n    const names = map.namesByIndex;\n    const index = ++this.index;\n\n    if (index >= names.length) {\n\n      this.name = null;\n      return false;\n\n    }\n\n    this.element = map.byName[this.name = names[index]];\n    return true;\n\n  },\n\n  /**\n   * @param {!string} name\n   * @param {T} element\n   * @return {!ObjectsByName<T>}\n   */\n  add: function (name, element) {\n\n    // TODO if ( this === null ) this = new ObjectsByName();\n\n    const namesByIndex = this.namesByIndex;\n\n    if (namesByIndex.indexOf(name) !== -1)\n      throw Error(\"ObjectsByName: Name '\" + name + \"' not unique!\");\n\n    namesByIndex.push(name);\n    this.byName[name] = element;\n\n    return this;\n  },\n\n};\n\nObjectsByName.shallowClone = (function () {\n\n  const i = new ObjectsByName.Iterator();\n\n  return function shallowClone(that) {\n\n    const newMap = new ObjectsByName();\n\n    if (!that) return newMap;\n\n    const byName = newMap.byName;\n    const names = newMap.namesByIndex;\n\n    names.length = that.namesByIndex.length;\n\n    for (i.reset(that); i.next();) {\n\n      const name = i.name;\n      byName[name] = i.element;\n      names[i.index] = name;\n\n    }\n\n    i.reset(null); // (!)\n\n    return newMap;\n\n  };\n\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/container/ObjectsByName.js","import * as THREE from 'three';\nimport IndexMappings from '../../generic/algorithm/IndexMappings';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport Arrays from '../../generic/utility/Arrays';\nimport EdgeVertexAdjacency from './adjacency/EdgeVertexAdjacency';\nimport FaceEdgeAdjacency from './adjacency/FaceEdgeAdjacency';\nimport ValueAdjacency from './adjacency/ValueAdjacency';\nimport FaceFaceAdjacency from './adjacency/FaceFaceAdjacency';\n\n/**\n * @template T\n * @constructor\n *\n * @param {!PolyMap|!Object} from object to copy the properties from\n */\nexport default function PolyMap(from) {\n\n  if (!from) {\n    this.faceRangeOffsets = new Uint32Array(1);\n    this.faceValueIndices = new Uint32Array(0);\n    this.values = new ObjectArrayView(THREE.Vector3, 0);\n  } else {\n\n    this.faceRangeOffsets = from.faceRangeOffsets;  //Uint32Array\n    this.faceValueIndices = from.faceValueIndices;  //Uint32Array\n    this.values = from.values;            //ObjectArrayView contains Three.Vector3 or Three.Vector2 usually\n\n    // Cached transient information (can be rebuilt from the above):\n\n    // Inverse index (value indices -> faces):\n    const valueFaceIndices = from.valueFaceIndices || null;\n    this.valueFaceIndices = valueFaceIndices;\n    this.valueFaceIndexOffsets = // only reuse when complete\n        valueFaceIndices && from.valueFaceIndexOffsets || null;\n\n    // The low value index acts as the pivot for edge enumeration, so\n    // the following array is indexed by edge UIDs:\n    this._edgeVertexAdjacency = null;\n    this._faceEdgeAdjacency = null;\n    this._valueAdjacency = null;\n    this._valueValueAdjacency = null;\n    this._faceFaceAdjacency = null;\n  }\n\n};\n\nPolyMap.fromData = function (faceOffsets, indices, values) {\n\n  const result = new PolyMap({\n\n    faceRangeOffsets: faceOffsets,\n\n    faceValueIndices: indices ||\n        IndexMappings.identity(values.length, Uint32Array),\n\n    values: values.repack(Float32Array),\n\n  });\n\n  const nFaceVertices = faceOffsets[faceOffsets.length - 1];\n\n  if (result.faceValueIndices.length !== nFaceVertices)\n    throw Error('Number of postition indices or unindexed ' +\n        'data values does not match the number of face vertices!');\n\n  return result;\n};\n\nPolyMap.prototype = {\n\n  constructor: PolyMap,\n  isPolyMap: true,\n\n  findValueIndexOffset: function (faceIndex, valueIndex) {\n\n    const offsets = this.faceRangeOffsets;\n    const indices = this.faceValueIndices;\n\n    const begin = offsets[faceIndex];\n    const until = offsets[faceIndex + 1];\n\n    for (let i = begin; i !== until; ++i)\n      if (indices[i] === valueIndex)\n        return i;\n\n    return -1;\n  },\n\n  // adjacency structures, computed on-demand adjacency structures.\n\n  get edgeVertexAdjacency() {\n\n    if (!this._edgeVertexAdjacency) this._edgeVertexAdjacency = new EdgeVertexAdjacency(this);\n\n    return this._edgeVertexAdjacency;\n  },\n\n  get faceEdgeAdjacency() {\n\n    if (!this._faceEdgeAdjacency) this._faceEdgeAdjacency = new FaceEdgeAdjacency(this);\n\n    return this._faceEdgeAdjacency;\n  },\n\n  get valueAdjacency() {\n\n    if (!this._valueAdjacency) this._valueAdjacency = new ValueAdjacency(this);\n\n    return this._valueAdjacency;\n  },\n\n  get valueValueAdjacency() {\n\n    if (!this._valueValueAdjacency) this._valueValueAdjacency = new ValueValueAdjacency(this);\n\n    return this._valueValueAdjacency;\n  },\n\n  get faceFaceAdjacency() {\n\n    if (!this._faceFaceAdjacency) this._faceFaceAdjacency = new FaceFaceAdjacency(this);\n\n    return this._faceFaceAdjacency;\n  },\n\n  // Inverse index (value index -> faces) build\n\n  updateInverseIndex: function () {\n\n    if (this.valueFaceIndices === null) {\n\n      const faceOffsets = this.faceRangeOffsets;\n\n      let faceIndex = -1;\n      let nextFaceStart = faceOffsets[0];\n\n      const indices = this.faceValueIndices;\n\n      const writeOffsets = this._updateValueFaceIndexOffsets();\n      const nDestOffsets = writeOffsets.length;\n\n      const nFaceIndices = indices.length;\n      const faceIndices = new Uint32Array(nFaceIndices);\n\n      for (let i = 0; i !== nFaceIndices; ++i) {\n\n        if (i === nextFaceStart)\n          nextFaceStart = faceOffsets[++faceIndex + 1];\n\n        faceIndices[writeOffsets[indices[i]]++] = faceIndex;\n      }\n\n      this.valueFaceIndices = faceIndices;\n\n      // Shift the write offsets back to their initial values:\n\n      if (writeOffsets.byteOffset === 0)\n        throw Error('Invalid .valueFaceIndexOffsets != null!');\n\n      this.valueFaceIndexOffsets =\n          new Uint32Array(writeOffsets.buffer, 0, nDestOffsets);\n    }\n\n    return this;\n  },\n\n  _updateValueFaceIndexOffsets: function () {\n\n    let result = this.valueFaceIndexOffsets;\n\n    if (result === null) {\n\n      const nValues = this.values.length;\n      const requiredLength = nValues + 2;\n\n      // Two extra values... Why?\n      //\n      // 1. For uniform access we keep n+1 offsets, that is\n      //    0, o_0, o_1, o_2 ..., <length>\n      //\n      // 2. The build of the inverse indices is destructive\n      //    and shifts the offsets by one index. The result\n      //    is something like:\n      //\n      //    o_0, o_1, o_2, ..., <length>, <length>\n      //\n      //    Now we will want our leading zero back.\n\n      const buffer = new Uint32Array(requiredLength);\n      const histogramArea = buffer.subarray(2);\n\n      result = buffer.subarray(1);\n\n      IndexMappings.histogram(\n          this.faceValueIndices, nValues, histogramArea);\n\n      Arrays.accumulate(histogramArea);\n\n      this.valueFaceIndices = null;\n      this.valueFaceIndexOffsets = result;\n    }\n\n    return result;\n  },\n\n  // Compaction\n\n  compactValues: function () {\n\n    const values = this.values;\n    const nValues = values.length;\n\n    if (nValues !== 0) {\n\n      const sourceToTargetMap = new Uint32Array(nValues);\n      const nCompactValues =\n            this._compactFaceIndexOffsets(sourceToTargetMap);\n\n      if (nCompactValues !== nValues) {\n\n        this._compactData(sourceToTargetMap, nCompactValues);\n        this._compactIndices(sourceToTargetMap);\n\n      }\n\n    }\n\n    return this;\n  },\n\n  _compactFaceIndexOffsets: function (outSourceToTargetMap) {\n\n    let faceIndexOffsets = this._updateValueFaceIndexOffsets();\n    const nValues = outSourceToTargetMap.length;\n\n    let nCompactValues = 0;\n    let offset = 0; // == faceIndexOffsets[ 0 ]\n\n    for (let i = 0; i !== nValues; ++i) {\n\n      let nextOffset = faceIndexOffsets[i + 1];\n\n      outSourceToTargetMap[i] = nCompactValues;\n      // Note: Filling in incorrect values at indices that are no longer\n      // used, actually. But those allow to replay the compaction of the\n      // offsets on the values once the size is known.\n      //\n      // The value that corresponds to the last index in an equal range\n      // is the one to keep.\n\n      if (offset !== nextOffset) {\n\n        if (nCompactValues !== i)\n          faceIndexOffsets[nCompactValues] = offset;\n\n        offset = nextOffset;\n        ++nCompactValues;\n      }\n    }\n\n    faceIndexOffsets[nCompactValues] = offset;\n\n    if (nCompactValues !== nValues) {\n\n      // Note: Since only empty ranges were removed, neither need to null\n      // nor rebuild .valueFaceIndices.\n\n      if (faceIndexOffsets.byteOffset !== 0) {\n        // this will be our leading zero and we want to keep it, so have\n        // a little dance with the typed arrays API...\n\n        const bufferView = new Uint32Array(faceIndexOffsets.buffer),\n          slice = Arrays.slice(bufferView, 0, nCompactValues + 2);\n\n        faceIndexOffsets = slice.subarray(1);\n\n        // ... phew!\n\n      } else {\n\n        faceIndexOffsets = Arrays.slice(\n            faceIndexOffsets, 0, nCompactValues + 1);\n      }\n    }\n\n    this.valueFaceIndexOffsets = faceIndexOffsets;\n    return nCompactValues;\n  },\n\n  _compactData: function (sourceToTargetMap, nCompactValues) {\n\n    // Rewrite the values to a new buffer, avoiding to build another\n    // temporary map, instead exploit the bogus padding of the STTM:\n\n    const values = this.values;\n    const nValues = values.length;\n    const newValues = new ObjectArrayView(values.type, nCompactValues);\n    let writeIndex = sourceToTargetMap[0];\n    const element = newValues.newRangeArray();\n\n    for (let i = 1; i !== nValues; ++i) {\n\n      const nextWriteIndex = sourceToTargetMap[i];\n\n      if (writeIndex !== nextWriteIndex) {\n        // now i - 1 is the source position we want\n\n        values.rangeToArray(i - 1, 1, element);\n        newValues.arrayToRange(element, writeIndex, 1);\n\n        writeIndex = nextWriteIndex;\n      }\n    }\n\n    values.rangeToArray(nValues - 1, 1, element);\n    newValues.arrayToRange(element, writeIndex, 1);\n\n    this.values = newValues;\n  },\n\n  _compactIndices: function (sourceToTargetMap) {\n\n    // The size of the index array does not change - it has already (else\n    // there'd be no unused indices), but we don't know when (the typical\n    // case would be in a previous transaction), so the same array can be\n    // in use elsewhere...\n\n    const indices = this.faceValueIndices;\n    const nIndices = indices.length;\n\n    const newIndices = new Uint32Array(nIndices);\n\n    IndexMappings.apply(indices, sourceToTargetMap, newIndices);\n    this.faceValueIndices = newIndices;\n\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/model/PolyMap.js","import Arrays from '../utility/Arrays';\n\n/**\n * Utilties for working with arrays of indices that are broadly useful and not\n * tailored towards a specific purpose.\n *\n * @namespace\n */\nconst IndexMappings = {\n\n  /**\n   * Create or populate an array with elements equal to their indices.\n   *\n   * @param {!number} n\n   * @param {ArrayOrType=} arrayOrType defaults to Uint32Array\n   * @return {!Array<!number>}\n   */\n  identity: function (n, arrayOrType) {\n\n    const result = Arrays.maybeCreate(arrayOrType || Uint32Array, n);\n    for (let i = 0; i !== n; ++i) result[i] = i;\n    return result;\n  },\n\n  /**\n   * Get an identity map as a view onto a globally shared buffer which\n   * must not be changed.\n   *\n   * @param {!number} n\n   * @return {!Uint32Array}\n   */\n  identityForReading: function (n) {\n\n    let proto = IndexMappings._identityProto;\n\n    if (n > proto.length) {\n\n      proto = IndexMappings.identity(n * 5 / 4 | 0);\n      IndexMappings._identityProto = proto;\n    }\n\n    return proto.subarray(0, n);\n  },\n\n  _identityProto: Arrays.Empty.Uint32Array,\n\n  /**\n   * Create an array where each index corresponds to the values and the\n   * values map back to the index of the source array.\n   *\n   * For non-surjective mappings, the missing indices are not written to.\n   * For non-injective mappings, duplicate indices will map to their last\n   * position of occurence in the input.\n   *\n   * @param {!Array<!number>} source integer indices\n   * @param {number} n\n   *    maximum entry in source map + 1\n   *    can be {@code null} when an existing array is given\n   * @param {ArrayOrType=} arrayOrType defaults to Uint32Array\n   * @return {!Array<!number>}\n   */\n  inverse: function (source, n, arrayOrType) {\n\n    const result = Arrays.maybeCreate(arrayOrType || Uint32Array, n);\n\n    for (let i = 0, e = source.length; i !== e; ++i)\n      result[source[i]] = i;\n\n    return result;\n  },\n\n  /**\n   * Transform one mapping with another, in-place unless an explicit\n   * destination is given.\n   *\n   * @param {!Array<!number>} map indices to transform\n   * @param {!Array<!number>} transform mapping to apply\n   * @param {Array<!number>=} optionalDestination\n   * @return {!Array<!number>} same as {@code map}\n   */\n  apply: function (map, transform, optionalDestination) {\n\n    const dst = optionalDestination || map;\n\n    for (let i = 0, n = map.length; i !== n; ++i)\n      dst[i] = transform[map[i]];\n\n    return map;\n  },\n\n  /**\n   * Count the equal elements.\n   *\n   * When an existing array is used for the destination, it must be\n   * filled with zeroes.\n   *\n   * @param {!Array<!number>} source integer indices\n   * @param {!number} n maximum entry in source map + 1\n   * @param {ArrayOrType=} arrayOrType defaults to Uint32Array\n   * @return {!Array<!number>}\n   */\n  histogram: function (source, n, arrayOrType) {\n\n    const result = Arrays.maybeCreate(arrayOrType || Uint32Array, n);\n\n    for (let i = 0, e = source.length; i !== e; ++i)\n      ++result[source[i]];\n\n    return result;\n  },\n\n};\nexport default IndexMappings;\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/algorithm/IndexMappings.js","import MergeSort from '../../../generic/algorithm/MergeSort';\nimport Arrays from '../../../generic/utility/Arrays';\n\n/**\n * @template T\n * @constructor\n *\n */\nexport default function EdgeVertexAdjacency(polyMap) {\n\n  this.polyMap = polyMap;\n\n  // The low value index acts as the pivot for edge enumeration, so\n  // the following array is indexed by edge UIDs:\n  this.edgeHighVertexIndices = null;\n\n  // Low -> high value index mapping (describes ranges of edge UIDs):\n  this.edgePivotRangeOffsets = null;\n\n  this.edgeVertices = null;\n\n  this._compactEdgeLowToHighMap(this._buildEdgeLowToHighMap());\n\n  this._inverseMapping();\n};\n\nEdgeVertexAdjacency.prototype = {\n\n  constructor: EdgeVertexAdjacency,\n\n  getNumEdges: function () {\n\n    return this.edgeHighVertexIndices.length;\n  },\n\n  // VV -> E\n  findEdgeId: function (faceValueIndexA, faceValueIndexB) {\n\n    let loVertex = faceValueIndexA;\n    let hiVertex = faceValueIndexB;\n\n    if (hiVertex < loVertex) {\n      loVertex = faceValueIndexB;\n      hiVertex = faceValueIndexA;\n    }\n\n    const rangeOffsets = this.edgePivotRangeOffsets;\n\n    return Arrays.binarySearch(\n        this.edgeHighVertexIndices, hiVertex,\n        rangeOffsets[loVertex], rangeOffsets[loVertex + 1]);\n  },\n\n  // E -> VV\n  getVerticesForEdge: function (edgeId) {\n    return {\n      v: this.edgeVertices[edgeId * 2],\n      vNext: this.edgeVertices[edgeId * 2 + 1],\n    };\n  },\n\n  _inverseMapping: function () {\n\n    const numEdges = this.getNumEdges();\n\n    const edgeVertices = new Uint32Array(numEdges * 2);\n\n    for (let v0 = 0; v0 < this.edgePivotRangeOffsets.length - 1; v0++) {\n\n      const edgeBegin = this.edgePivotRangeOffsets[v0];\n      const edgeEnd = this.edgePivotRangeOffsets[v0 + 1];\n\n      for (let i = edgeBegin; i <= edgeEnd; i++) {\n        const v1 = this.edgeHighVertexIndices[i];\n\n        edgeVertices[i * 2 + 0] = v0;\n        edgeVertices[i * 2 + 1] = v1;\n      }\n    }\n\n    this.edgeVertices = edgeVertices;\n\n  },\n\n  _buildEdgeLowToHighMap: function () {\n\n    const faceOffsets = this.polyMap.faceRangeOffsets;\n    const valueIndices = this.polyMap.faceValueIndices;\n\n    const nValues = this.polyMap.values.length;\n    const offsets = new Uint32Array(nValues + 2);\n    const histogramArea = offsets.subarray(2);\n\n    let faceBegin = faceOffsets[0];\n    let maxEdgesSharingPivot = 0;\n\n    // Construct histogram and accumulate:\n\n    for (let i = 1, n = faceOffsets.length; i !== n; ++i) {\n\n      const faceUntil = faceOffsets[i];\n      let vertexA = valueIndices[faceUntil - 1];\n\n      for (let j = faceBegin; j !== faceUntil; ++j) {\n\n        const vertexB = valueIndices[j];\n        const loVertex = vertexB < vertexA ? vertexB : vertexA;\n\n        const nEdges = ++histogramArea[loVertex];\n\n        if (nEdges > maxEdgesSharingPivot)\n\n          maxEdgesSharingPivot = nEdges;\n\n        vertexA = vertexB;\n      }\n\n      faceBegin = faceUntil;\n    }\n\n    Arrays.accumulate(histogramArea);\n\n    // Build the indices array (shifting the offsets):\n\n    const writeOffsets = offsets.subarray(1);\n    const indices = new Uint32Array(writeOffsets[nValues]);\n\n    faceBegin = faceOffsets[0];\n\n    for (let i = 1, n = faceOffsets.length; i !== n; ++i) {\n\n      const faceUntil = faceOffsets[i];\n      let vertexA = valueIndices[faceUntil - 1];\n\n      for (let j = faceBegin; j !== faceUntil; ++j) {\n\n        const vertexB = valueIndices[j];\n\n        let loVertex = vertexA;\n        let hiVertex = vertexB;\n\n        if (hiVertex < loVertex) {\n\n          loVertex = vertexB;\n          hiVertex = vertexA;\n        }\n\n        indices[writeOffsets[loVertex]++] = hiVertex;\n\n        vertexA = vertexB;\n      }\n\n      faceBegin = faceUntil;\n    }\n\n    this.edgePivotRangeOffsets = offsets;\n    this.edgeHighVertexIndices = indices;\n\n    return maxEdgesSharingPivot;\n  },\n\n  _compactEdgeLowToHighMap: function (maxEdgesSharingPivot) {\n\n    const offsets = this.edgePivotRangeOffsets;\n    const indices = this.edgeHighVertexIndices;\n\n    const sorter = new MergeSort(Uint32Array, maxEdgesSharingPivot);\n\n    const nOffsets = this.polyMap.values.length + 1;\n\n    let rangeUntil = 0;\n    let rangeBegin = 0;\n    let writeOffset = 0;\n\n    for (let i = 1; i !== nOffsets; ++i) {\n\n      rangeUntil = offsets[i];\n\n      if (rangeBegin !== rangeUntil) {\n\n        sorter.sortRange(indices, rangeBegin, rangeUntil);\n\n        // Unique-compact indices within each range:\n\n        let prevElement = indices[rangeBegin];\n        indices[writeOffset++] = prevElement;\n\n        for (let j = rangeBegin + 1; j < rangeUntil; ++j) {\n\n          const element = indices[j];\n          if (element !== prevElement) {\n\n            indices[writeOffset++] = element;\n            prevElement = element;\n          }\n        }\n      }\n\n      offsets[i] = writeOffset; // re-write compact offsets\n      rangeBegin = rangeUntil; // certainly >= writeOffset\n    }\n\n    // Shrink to fit (offsets only has 2 extra elements, so view it):\n\n    this.edgeHighVertexIndices =\n        Arrays.slice(indices, 0, writeOffset);\n\n    this.edgePivotRangeOffsets = offsets.subarray(0, nOffsets);\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/model/adjacency/EdgeVertexAdjacency.js","export default function MergeSort(arrayType, maxRangeLength) {\n\n  this.ping = new arrayType(maxRangeLength);\n  this.pong = new arrayType(maxRangeLength);\n};\n\nMergeSort.apply = function (array) {\n\n  const sorter = new MergeSort(array.constructor, array.length);\n  sorter.sortRange(array, 0, array.length);\n};\n\nMergeSort.prototype = {\n\n  constructor: MergeSort,\n\n  sortRange: function (array, begin, until) {\n\n    const length = until - begin;\n\n    if (length <= 4) {\n      // this implementation requires at least three elements and also\n      // has a high base cost when it comes to very short ranges\n\n      if (length >= 2) this._handleShortRange(array, begin, length);\n      return;\n    }\n\n    let read = array;\n    let readBegin = begin;\n    let readUntil = until;\n\n    let write = this.ping;\n    let writeOffset = 0;\n\n    let blockSize = 1;\n    let blockPairSize = 2;\n\n    for (let run = true; run;) {\n\n      let nMerges = (length + blockSize - 1) / blockSize >> 1,\n\n        l = readBegin,\n        endR = readBegin + blockPairSize;\n\n      for (let last = 0; last <= 1; ++last) {\n\n        for (let i = 1; i !== nMerges; ++i,\n            l += blockSize, endR += blockPairSize) {\n\n          let r = l + blockSize,\n            endL = r,\n\n            valL = read[l],\n            valR = read[r];\n\n          for (let merge = true; merge;) {\n\n            if (valR < valL) {\n\n              write[writeOffset++] = valR;\n\n              if (++r === endR) {\n\n                write[writeOffset++] = valL;\n                while (++l !== endL)\n                  write[writeOffset++] = read[l];\n                merge = false;\n\n              } else valR = read[r];\n\n            } else {\n\n              write[writeOffset++] = valL;\n\n              if (++l === endL) {\n\n                write[writeOffset++] = valR;\n                while (++r !== endR)\n                  write[writeOffset++] = read[r];\n                merge = false;\n\n              } else valL = read[l];\n\n            }\n          }\n        }\n\n        // Handle edge cases before the last pass:\n\n        if (last === 0) {\n\n          nMerges = 2; // one more merge (1-based, exclusive)\n\n          if (endR > readUntil) endR = readUntil;\n          else if (endR !== readUntil) {\n\n            let writeOffsetTemp = writeOffset + blockPairSize;\n\n            for (let j = endR; j !== readUntil; ++j)\n              write[writeOffsetTemp++] = read[j];\n          }\n        }\n      }\n\n      if (write !== array) {\n        // not done yet? prepare next level\n\n        blockSize = blockPairSize;\n        blockPairSize <<= 1;\n\n        read = write;\n        readBegin = 0;\n        readUntil = length;\n\n        if (blockPairSize < length) {\n          // at least two more levels? destination is temporary\n\n          const ping = this.ping;\n          write = write === ping ? this.pong : ping;\n          writeOffset = 0;\n\n        } else {\n          // next will be the last level -> write back to source\n\n          write = array;\n          writeOffset = begin;\n\n        }\n\n      } else run = false;\n\n    }\n\n  },\n\n  _handleShortRange: function (array, begin, length) {\n\n    let valA = array[begin];\n    let valB = array[begin + 1];\n\n    switch (length) {\n\n      case 2:\n\n        if (valB < valA) {\n\n          array[begin] = valB;\n          array[begin + 1] = valA;\n        }\n\n        break;\n\n      case 3: {\n\n        let valC = array[begin + 2];\n\n        if (valB < valA) {\n\n          const tmp = valA; valA = valB; valB = tmp;\n        }\n\n        if (valC < valB) {\n\n          const tmp = valB; valB = valC; valC = tmp;\n        }\n\n        if (valB < valA) {\n\n          const tmp = valA; valA = valB; valB = tmp;\n        }\n\n        array[begin] = valA;\n        array[begin + 1] = valB;\n        array[begin + 2] = valC;\n\n        break;\n      }\n\n      case 4: {\n\n        let valC = array[begin + 2];\n        let valD = array[begin + 3];\n\n        if (valB < valA) {\n\n          const tmp = valA; valA = valB; valB = tmp;\n        }\n\n        if (valD < valC) {\n\n          const tmp = valC; valC = valD; valD = tmp;\n        }\n\n        if (valC < valA) {\n\n          const tmp = valA; valA = valC; valC = tmp;\n        }\n\n        if (valD < valB) {\n\n          const tmp = valB; valB = valD; valD = tmp;\n        }\n\n        if (valC < valB) {\n\n          const tmp = valB; valB = valC; valC = tmp;\n        }\n\n        array[begin] = valA;\n        array[begin + 1] = valB;\n        array[begin + 2] = valC;\n        array[begin + 3] = valD;\n\n      }\n    }\n\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/algorithm/MergeSort.js","export default function FaceEdgeAdjacency(polyMap) {\n\n  this.polyMap = polyMap;\n\n  this.faceEdgeIndices = null;\n\n  this.edgeFaceCounts = null;\n  this.edgeFaceIndices = null;\n\n  this._compute();\n\n};\n\nFaceEdgeAdjacency.prototype = {\n\n  constructor: FaceEdgeAdjacency,\n\n  // F -> E\n  //faceValueIndex is the index of value on the face\n  //ie: the index of the value in faceValueIndices\n  //    not the value of faceValueIndices\n  getEdgeIdFromFaceValueIndex: function (faceValueIndex) {\n    return this.faceEdgeIndices[faceValueIndex];\n  },\n\n  // E -> F, part 1\n  getNumFacesForEdgeId: function (edgeID) {\n    return this.edgeFaceCounts[edgeID];\n  },\n  // E -> F, part 2\n  getFaceForEdgeId: function (edgeId, faceOffset) {\n    return this.edgeFaceIndices[edgeId * 2 + faceOffset];\n  },\n\n  //returns false if there is an invalid surface\n  //if this function returns false this adjacency structure is invalid and cannot be used\n  checkValidity: function () {\n    let invalidSurface = true;\n    for (let i = 0; i < this.edgeFaceCounts.length; i++) {\n      if (this.edgeFaceCounts[i] > 2)\n        invalidSurface = false;\n    }\n\n    return invalidSurface;\n  },\n\n  _compute: function () {\n\n    const polyMap = this.polyMap;\n    const edgeVertexAdjacency = polyMap.edgeVertexAdjacency;\n\n    const faceRangeOffsets = polyMap.faceRangeOffsets;\n    const faceValueIndices = polyMap.faceValueIndices;\n\n    const numEdges = edgeVertexAdjacency.edgeHighVertexIndices.length;\n    //const numFaces = faceRangeOffsets.length - 1;\n    const edgeFaceCounts = new Uint32Array(numEdges);\n    const edgeFaceIndices = new Uint32Array(numEdges * 2);\n    const faceEdgeIndices = new Uint32Array(faceValueIndices.length);\n\n    for (let f = 0; f < faceRangeOffsets.length - 1; f++) {\n\n      const faceBegin = faceRangeOffsets[f];\n      const faceUntil = faceRangeOffsets[f + 1];\n      const numFaceValues = faceUntil - faceBegin;\n\n      let vNext = faceValueIndices[faceBegin];\n\n      // count faces on each edge.\n      for (let fv = 0; fv < numFaceValues; fv++) {\n\n        const v = vNext;\n        vNext = faceValueIndices[faceBegin + ((fv + 1) % numFaceValues)];\n\n        const edgeId = edgeVertexAdjacency.findEdgeId(v, vNext);\n\n        const faceValueIndex = faceBegin + fv;\n\n        faceEdgeIndices[faceValueIndex] = edgeId;\n\n        edgeFaceIndices[edgeId * 2 + edgeFaceCounts[edgeId]] = f;\n        edgeFaceCounts[edgeId]++;\n      }\n\n    }\n\n    this.faceEdgeIndices = faceEdgeIndices;\n\n    this.edgeFaceCounts = edgeFaceCounts;\n    this.edgeFaceIndices = edgeFaceIndices;\n\n    return this;\n\n  },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/model/adjacency/FaceEdgeAdjacency.js","export default function ValueAdjacency(polyMap) {\n\n  this.polyMap = polyMap;\n\n  this._compute();\n\n};\n\nValueAdjacency.prototype = {\n\n  constructor: ValueAdjacency,\n\n  // V -> E, part 1\n  getNumEdgesForVertex: function (valueIndex) {\n    const valueBegin = this.valueEdgeOffsets[valueIndex];\n    const valueUntil = this.valueEdgeOffsets[valueIndex + 1];\n    const numValueEdges = valueUntil - valueBegin;\n\n    return numValueEdges;\n  },\n\n  // V -> E, part 2\n  getEdgeForVertexId: function (valueIndex, edgeOffset) {\n    const valueBegin = this.valueEdgeOffsets[valueIndex];\n    return this.valueEdgeIndices[valueBegin + edgeOffset];\n  },\n\n  //V->VV returns the adjacent values to a given vertex\n  getAdjacentValues: function (valueIndex) {\n    const edgeVertexAdjacency = this.polyMap.edgeVertexAdjacency;\n    const adjacentValues = [];\n    const numEdges = this.getNumEdgesForVertex(valueIndex);\n\n    for (let i = 0; i < numEdges; i++) {\n      const edge = this.getEdgeForVertexId(valueIndex, i);\n      const values = edgeVertexAdjacency.getVerticesForEdge(edge);\n      const adjacentValue = (values.v === valueIndex) ? values.vNext : values.v;\n      adjacentValues.push(adjacentValue);\n    }\n\n    return adjacentValues;\n  },\n\n  //V->VV for a given faceValueIndex and face, returns the (0-2) adjacent faceValueIndices on that face\n  getAdjacentFaceValuesIndicesOnFace: function (faceValueIndex, face) {\n\n    const adjacentValuesOnFace = [];\n    const faceBegin = this.polyMap.faceRangeOffsets[face];\n    const faceEnd = this.polyMap.faceRangeOffsets[face + 1];\n    const faceSize = faceEnd - faceBegin;\n    if (faceSize < 3) return adjacentValuesOnFace;\n\n    const next = (faceValueIndex === faceEnd - 1) ? faceBegin : faceValueIndex + 1;\n    const prev = (faceValueIndex === faceBegin) ? faceEnd - 1 : faceValueIndex - 1;\n\n    adjacentValuesOnFace.push(prev);\n    adjacentValuesOnFace.push(next);\n\n    return adjacentValuesOnFace;\n  },\n\n  // V -> F, part 1\n  getNumFacesForVertex: function (faceValueIndex) {\n    const valueBegin = this.valueFaceOffsets[faceValueIndex];\n    const valueUntil = this.valueFaceOffsets[faceValueIndex + 1];\n    const numValueFace = valueUntil - valueBegin;\n\n    return numValueFace;\n  },\n\n  // V -> F, part 2\n  getFaceForVertexId: function (faceValueIndex, faceOffset) {\n    const valueBegin = this.valueFaceOffsets[faceValueIndex];\n    return this.valueFaceIndices[valueBegin + faceOffset];\n  },\n\n  _compute: function () {\n\n    const polyMap = this.polyMap;\n\n    const faceRangeOffsets = polyMap.faceRangeOffsets;\n    const faceValueIndices = polyMap.faceValueIndices;\n\n    const edgeVertexAdjacency = polyMap.edgeVertexAdjacency;\n\n    const valueFaceCount = new Uint32Array(polyMap.values.length);\n    const valueEdgeCount = new Uint32Array(polyMap.values.length);\n    //const numFaces = faceRangeOffsets.length - 1;\n\n    const numEdges = edgeVertexAdjacency.getNumEdges();\n    const edgeUnique = new Uint8Array(numEdges);\n\n    // histogram.\n    for (let f = 0; f < polyMap.faceRangeOffsets.length - 1; f++) {\n\n      const faceBegin = polyMap.faceRangeOffsets[f];\n      const faceUntil = polyMap.faceRangeOffsets[f + 1];\n      const numFaceValues = faceUntil - faceBegin;\n\n      let vNext = polyMap.faceValueIndices[faceBegin];\n\n      for (let fv = 0; fv < numFaceValues; fv++) {\n\n        const v = vNext;\n        vNext = polyMap.faceValueIndices[faceBegin + ((fv + 1) % numFaceValues)];\n\n        const e = edgeVertexAdjacency.findEdgeId(v, vNext);\n\n        valueFaceCount[v]++;\n\n        // is this the first time processing this edge\n        if (edgeUnique[e] === 0) {\n          edgeUnique[e] = 1;\n\n          valueEdgeCount[v]++;\n          valueEdgeCount[vNext]++;\n        }\n      }\n    }\n\n    // create offset arrays.\n    let faceSum = 0, edgeSum = 0;\n    const valueFaceOffsets = new Uint32Array(valueFaceCount.length + 1);\n    const valueEdgeOffsets = new Uint32Array(valueEdgeCount.length + 1);\n    for (let i = 0; i < valueFaceCount.length; i++) {\n      valueFaceOffsets[i] = faceSum;\n      faceSum += valueFaceCount[i];\n      valueFaceCount[i] = 0;\n\n      valueEdgeOffsets[i] = edgeSum;\n      edgeSum += valueEdgeCount[i];\n      valueEdgeCount[i] = 0;\n    }\n\n    valueFaceOffsets[valueFaceCount.length] = faceSum;\n    valueEdgeOffsets[valueEdgeCount.length] = edgeSum;\n\n    // fill in the values\n    const valueFaceIndices = new Uint32Array(faceSum);\n    const valueEdgeIndices = new Uint32Array(edgeSum);\n\n    for (let f = 0; f < polyMap.faceRangeOffsets.length - 1; f++) {\n\n      const faceBegin = polyMap.faceRangeOffsets[f];\n      const faceUntil = polyMap.faceRangeOffsets[f + 1];\n      const numFaceValues = faceUntil - faceBegin;\n\n      let vNext = polyMap.faceValueIndices[faceBegin];\n\n      for (let fv = 0; fv < numFaceValues; fv++) {\n\n        const v = vNext;\n        vNext = polyMap.faceValueIndices[faceBegin + ((fv + 1) % numFaceValues)];\n\n        const e = edgeVertexAdjacency.findEdgeId(v, vNext);\n\n        valueFaceIndices[valueFaceOffsets[v] + (valueFaceCount[v]++)] = f;\n\n        // is this the first time processing this edge\n        if (edgeUnique[e] === 1) {\n          edgeUnique[e] = 2;\n\n          valueEdgeIndices[valueEdgeOffsets[v] + (valueEdgeCount[v]++)] = e;\n          valueEdgeIndices[valueEdgeOffsets[vNext] + (valueEdgeCount[vNext]++)] = e;\n        }\n      }\n    }\n\n    this.valueFaceOffsets = valueFaceOffsets;\n    this.valueFaceIndices = valueFaceIndices;\n\n    this.valueEdgeOffsets = valueEdgeOffsets;\n    this.valueEdgeIndices = valueEdgeIndices;\n\n  },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/model/adjacency/ValueAdjacency.js","export default function FaceFaceAdjacency(polyMap) {\n\n  //for each face there is an offset array (faceFaceCounts)\n  //this offset array indexes into an array of all faces that are adjacent (faceFaceIndices)\n\n  this.polyMap = polyMap;\n\n  this.faceFaceCounts = null;\n  this.faceFaceIndices = null;\n\n  this._compute();\n\n};\n\nFaceFaceAdjacency.prototype = {\n\n  constructor: FaceFaceAdjacency,\n\n  //F->F\n  getAdjacentFaces: function (face) {\n    const numAdjacentFaces = this.faceFaceCounts[face + 1] - this.faceFaceCounts[face];\n    const adjacentFaces = new Uint32Array(numAdjacentFaces);\n    for (let i = this.faceFaceCounts[face], j = 0; i < this.faceFaceCounts[face + 1]; i++, j++) {\n      adjacentFaces[j] = this.faceFaceIndices[i];\n    }\n\n    return adjacentFaces;\n  },\n\n  //return array of 0-2 faces\n  //valuesIndex is the index of the vertex in the values array\n  adjacentFacesOnVertex: function (face, valuesIndex) {\n    const adjacentFaces = this.getAdjacentFaces(face);\n    const faceRangeOffsets = this.polyMap.faceRangeOffsets;\n    const faceValueIndices = this.polyMap.faceValueIndices;\n    const adjacentFacesOnVertex = [];\n\n    for (let i = 0; i < adjacentFaces.length; i++) {\n      for (let j = faceRangeOffsets[adjacentFaces[i]]; j < faceRangeOffsets[adjacentFaces[i] + 1]; j++) {\n        if (faceValueIndices[j] === valuesIndex) {\n          adjacentFacesOnVertex.push(adjacentFaces[i]);\n          break;\n        }\n      }\n    }\n\n    return adjacentFacesOnVertex;\n  },\n\n  _compute: function () {\n\n    const faceRangeOffsets = this.polyMap.faceRangeOffsets;\n    const faceValueIndices = this.polyMap.faceValueIndices;\n    const faceEdgeAdjacency = this.polyMap.faceEdgeAdjacency;\n\n    const faceFaceCounts = new Uint32Array(faceRangeOffsets.length);\n    const faceFaceIndices = [];\n\n    for (let i = 0; i < faceRangeOffsets.length - 1; i++) {\n\n      const adjacentFaces = [];\n      for (let j = faceRangeOffsets[i]; j < faceRangeOffsets[i + 1]; j++) {\n        const edge = faceEdgeAdjacency.getEdgeIdFromFaceValueIndex(j);\n\n        //if edge has 2 faces then find the adjacent face that isnt the given face\n        const numFaces = faceEdgeAdjacency.getNumFacesForEdgeId(edge);\n        if (numFaces > 1) {\n          let adjacentFaceIndex = faceEdgeAdjacency.getFaceForEdgeId(edge, 0);\n          if (adjacentFaceIndex === i) adjacentFaceIndex = faceEdgeAdjacency.getFaceForEdgeId(edge, 1);\n          adjacentFaces.push(adjacentFaceIndex);\n        }\n      }\n\n      faceFaceCounts[i + 1] = faceFaceCounts[i] + adjacentFaces.length;\n      faceFaceIndices.push.apply(faceFaceIndices, adjacentFaces);\n\n    }\n\n    this.faceFaceCounts = faceFaceCounts;\n    this.faceFaceIndices = Uint32Array.from(faceFaceIndices);\n\n    return this;\n  },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/model/adjacency/FaceFaceAdjacency.js","import ObjectsByName from '../../generic/container/ObjectsByName';\nimport PolyMaps from './PolyMaps';\nimport PolyMap from './PolyMap';\n\nexport default function PolyMesh(from) {\n  if (!from) {\n    this.faceRangeOffsets = new Uint32Array(1);\n    this.positions = new PolyMap();\n\n    this.colorMaps = new ObjectsByName();\n    this.uvMaps = new ObjectsByName();\n\n  } else {\n\n    if (!from.colorMaps) console.error('Polymesh must have initialized colorMaps container.');\n    if (!from.uvMaps) console.error('Polymesh must have initialized uvMaps container.');\n\n    this.faceRangeOffsets = from.faceRangeOffsets;               //Uint32Array\n    this.positions = from.positions;                             //PolyMap Object\n    this.normalMap = from.normalMap;                             //PolyMap Object\n    this.uvMaps = ObjectsByName.shallowClone(from.uvMaps);       //ObjectsByName contains PolyMap Object\n\n    //optional properties discarded topology change:\n    if (from.skinning) this.skinning = from.skinning;                                //Skinning Object\n    if (from.edgeCreaseWeights) this.edgeCreaseWeights = from.edgeCreaseWeights;     //Float32Array : index === edge, value === weight {0..1}\n    if (from.materialIds) this.materialIds = from.materialIds;                       //Uint32Array  : index === face\n\n    //not implemented:\n    //this.tangentMap = from.tangentMap;                         //PolyMap Object\n    this.colorMaps = ObjectsByName.shallowClone(from.colorMaps); //ObjectsByName contains PolyMap Object\n  }\n};\n\nPolyMesh.prototype = {\n\n  constructor: PolyMesh,\n\n  getNumFaces: function () {\n\n    return this.faceRangeOffsets.length - 1;\n\n  },\n\n  getNumFaceVertices: function () {\n\n    return this.positions.faceValueIndices.length;\n\n  },\n\n  getNumVertices: function () {\n\n    return this.positions.values.length;\n\n  },\n\n  getMapById: function (mapId) {\n\n    return PolyMaps.resolveMap(this, mapId) || null;\n\n  },\n\n  topologyChanged: function () {\n    //this function is only to be called during construction of a new polymesh\n    //its purpose is to nullify data that would become invalidated due to a change in topology\n    //the data to remain intact would have to also be correctly mapped in each operator\n    //in the future operators will instead generate a mapping that can be applied through\n    //a general mapping function so such additions can be done in a singular location\n    if (this.skinning) this.skinning = null;\n    if (this.edgeCreaseWeights) this.edgeCreaseWeights = null;\n    if (this.materialIds) this.materialIds = null;\n    return this;\n  },\n\n};\n\nPolyMesh.fromData = function (\n    faceRangeOffsets, positions, optionalIndices, optionalMaterialIds) {\n\n  const polyMesh = new PolyMesh({\n    faceRangeOffsets,\n    positions: positions.isPolyMap ? positions :\n        PolyMap.fromData(faceRangeOffsets, optionalIndices || null, positions),\n    uvMaps: new ObjectsByName(),     // ObjectsByName< PolyMap<THREE.Vector2> >\n    colorMaps: new ObjectsByName(),  // ObjectsByName< PolyMap<THREE.Color> >\n  });\n\n  if (optionalMaterialIds) polyMesh.materialIds = optionalMaterialIds;\n\n  return polyMesh;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/model/PolyMesh.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\n\nexport default function Skinning(from) {\n\n  this.positionSkinRange = from.positionSkinRange;  //Uint32Array\n  this.skinWeights = from.skinWeights;              //Float32Array\n  this.skinBoneIndices = from.skinBoneIndices;      //Uint16Array\n\n  this.poseSkinToPoseBoneTransform = from.poseSkinToPoseBoneTransform;  //ObjectArrayView of Matrix4's\n\n};\n\nSkinning.prototype = {\n\n  constructor: Skinning,\n\n  applyTransforms: function (positions, skinToWorldTransform, boneWorldTransforms, rootBoneIndex) {\n    return this.deform(this.createFinalTransforms(skinToWorldTransform, boneWorldTransforms, rootBoneIndex), positions);\n  },\n\n  createFinalTransforms: function (skinToWorldTransform, boneWorldTransforms, rootBoneIndex) {\n\n    const poseSkinToPoseBoneTransform = this.poseSkinToPoseBoneTransform;\n    const worldToSkinTransform = new THREE.Matrix4().getInverse(skinToWorldTransform, true);\n    const finalTransforms = new Array(poseSkinToPoseBoneTransform.length);\n\n    const identity = new THREE.Matrix4().identity();\n\n    if (poseSkinToPoseBoneTransform.length === 0) {\n      return finalTransforms;\n    }\n\n    let rootToWorldTransform;\n    let worldToRootTransform;\n    let poseRootToSkinTransform;\n\n    if (rootBoneIndex > -1) {\n      rootToWorldTransform = boneWorldTransforms[rootBoneIndex];\n      worldToRootTransform = new THREE.Matrix4().getInverse(rootToWorldTransform, true);\n      poseRootToSkinTransform = new THREE.Matrix4().getInverse(poseSkinToPoseBoneTransform.getAt(rootBoneIndex), true);\n    }\n\n    const boneToRootTransform = new THREE.Matrix4();\n    const boneToSkinTransform = new THREE.Matrix4();\n    const finalTransform = new THREE.Matrix4();\n\n    for (let i = 0, il = poseSkinToPoseBoneTransform.length; i < il; i++) {\n\n      let boneToWorldTransform = boneWorldTransforms[i];\n      if (rootBoneIndex > -1) {\n        boneToRootTransform.multiplyMatrices(worldToRootTransform, boneToWorldTransform);\n        boneToSkinTransform.multiplyMatrices(poseRootToSkinTransform, boneToRootTransform);\n      } else {\n        boneToSkinTransform.multiplyMatrices(worldToSkinTransform, boneToWorldTransform);\n      }\n\n      finalTransforms[i] = new THREE.Matrix4().multiplyMatrices(boneToSkinTransform, poseSkinToPoseBoneTransform.getAt(i));\n\n    }\n\n    return finalTransforms;\n\n  },\n\n  deform: function (finalTransforms, positions) {\n\n    const positionSkinRange = this.positionSkinRange;\n    const skinWeights = this.skinWeights;\n    const skinBoneIndices = this.skinBoneIndices;\n\n    const deformedPositions = new ObjectArrayView(THREE.Vector3, positions.length);\n    const v = new THREE.Vector3();\n    const d = new THREE.Vector3();\n\n    for (let i = 0; i < positions.length; i++) {\n      positions.getAt(i, v);\n      d.multiplyScalar(0);\n      for (let j = positionSkinRange[i]; j < positionSkinRange[i + 1]; j++) {\n        positions.getAt(i, v);\n        v.applyMatrix4(finalTransforms[skinBoneIndices[j]]);\n        v.multiplyScalar(skinWeights[j]);\n        d.addVectors(d, v);\n      }\n\n      if (positionSkinRange[i + 1] - positionSkinRange[i] === 0) {\n        d.copy(v);\n      }\n\n      deformedPositions.setAt(i, d);\n    }\n\n    return deformedPositions;\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/model/Skinning.js","import Arrays from '../../generic/utility/Arrays';\nimport GlobalCompaction from '../../generic/algorithm/GlobalCompaction';\n\nconst ImportConversions = {\n\n  collapsePositions: function (positions, indices) {\n\n    var compaction = new GlobalCompaction(positions),\n      compactPositions = compaction.compactedValues(positions);\n\n    if (indices) compaction.transcribeIndices(indices);\n\n    return compactPositions;\n\n  },\n\n  collapseMapVertexValues: function (polyMesh, polyMap) {\n\n    var positions = polyMesh.positions.updateInverseIndex(),\n      indexRanges = polyMesh.faceRangeOffsets,\n      positionIndices = positions.faceValueIndices,\n      faceRangeOffsets = positions.faceRangeOffsets,\n      currFaceIndex = -1,\n      nextFaceStart = 0,\n\n      faceIndexOffsets = positions.valueFaceIndexOffsets,\n      faceIndices = positions.valueFaceIndices,\n\n      values = polyMap.values,\n      data = values.data,\n      elementSize = values.elementSize,\n      valueIndices = polyMap.faceValueIndices;\n\n    for (var i = 0, n = polyMesh.getNumFaceVertices(); i !== n; ++i) {\n\n      var positionIndex = positionIndices[i],\n        currValueIndex = valueIndices[i],\n        currValueOffset = currValueIndex * elementSize;\n\n      if (i === nextFaceStart)\n        nextFaceStart = faceRangeOffsets[++currFaceIndex + 1];\n\n      var facesStart = faceIndexOffsets[positionIndex],\n        facesUntil = faceIndexOffsets[positionIndex + 1];\n\n      for (var j = facesStart; j !== facesUntil; ++j) {\n\n        var faceIndex = faceIndices[j];\n        if (faceIndex === currFaceIndex) break;\n\n        var valueIndexOffset = positions.\n            findValueIndexOffset(faceIndex, positionIndex),\n\n          valueIndex = valueIndices[valueIndexOffset];\n\n        if (valueIndex !== currValueIndex) {\n\n          if (Arrays.rangeEquals(data, currValueOffset,\n              data, valueIndex * elementSize, elementSize))\n\n            valueIndices[i] = valueIndex;\n        }\n      }\n    }\n  },\n\n};\n\nexport default ImportConversions;\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/algorithm/ImportConversions.js","import Arrays from '../utility/Arrays';\nimport BitSet from '../container/BitSet';\nimport ObjectArrayView from '../container/ObjectArrayView';\nimport IndexMappings from './IndexMappings';\n\n/**\n * Construct a compact (injective / scattering) map to globally unique values\n * within an ObjectArrayView and optionally also the (injective / compacting)\n * source-to-target mapping (STTM).\n *\n * For each index in the input data, the STTM contains the index in compacted\n * form. The STTM can be used to transcribe existing indices into the data or,\n * if the data is \"unindexed\", it is the indices.\n *\n * @constructor\n *\n * @param {!ObjectArrayView} values\n * @param {boolean=} ttsOnly whether to only create the target-to-source map\n */\nexport default function GlobalCompaction(values, ttsOnly) {\n\n  const nValues = values.length;\n\n  const tupleOrder = Arrays.sort(\n        IndexMappings.identity(nValues),\n        values.newCompareAtIndicesStable());\n\n  let nUnique = 0;\n  let sourceToTargetMap = null;\n\n  const compare = values.newCompareAtIndices();\n\n  if (ttsOnly) {\n\n    nUnique = Arrays.unique(tupleOrder, compare);\n\n  } else {\n    // customized UNIQUE algo that builds the STTM on the fly\n\n    sourceToTargetMap = new Uint32Array(nValues);\n\n    let writeIndex = 0;\n    let prevUniqueAt = 0;\n    let minValueIndex = tupleOrder[0];\n\n    for (let i = 1; i < nValues; ++i) {\n\n      const valueIndex = tupleOrder[i];\n\n      if (compare(valueIndex, minValueIndex) !== 0) {\n\n        for (let j = prevUniqueAt; j !== i; ++j)\n          sourceToTargetMap[tupleOrder[j]] = minValueIndex;\n\n        prevUniqueAt = i;\n        minValueIndex = valueIndex;\n\n        if (++writeIndex !== i)\n          tupleOrder[writeIndex] = valueIndex;\n\n      }\n    }\n\n    for (let j = prevUniqueAt; j !== nValues; ++j)\n      sourceToTargetMap[tupleOrder[j]] = minValueIndex;\n\n    nUnique = writeIndex + 1;\n  }\n\n  // Now that duplicates have been removed, restore the original order by\n  // sorting the indices (since we have a finite integer range, we can do\n  // so very quickly using a BitSet):\n\n  const targetToSourceMap = new BitSet(nValues).\n      includeFromArray(tupleOrder, 0, nUnique).toIndexArray(nUnique);\n\n  if (sourceToTargetMap !== null) {\n\n    // The STTM already has all equal indices mapped to the first, but\n    // these indices are still in respect to the input, so they need to\n    // be translated to refer to compact data:\n\n    const reusableMemory = tupleOrder;\n\n    const sparseCompaction =\n          IndexMappings.inverse(\n            targetToSourceMap, null, reusableMemory);\n\n    IndexMappings.apply(sourceToTargetMap, sparseCompaction);\n  }\n\n  this.targetToSourceMap = targetToSourceMap;\n  this.sourceToTargetMap = sourceToTargetMap;\n\n};\n\nGlobalCompaction.prototype = {\n\n  constructor: GlobalCompaction,\n\n  compactedValues: function (data) {\n\n    const map = this.targetToSourceMap;\n    const nCompact = map.length;\n\n    const result = new ObjectArrayView(data.type, nCompact);\n\n    const elementData = data.newRangeArray();\n\n    for (let i = 0; i !== nCompact; ++i) {\n\n      data.rangeToArray(map[i], 1, elementData);\n      result.arrayToRange(elementData, i, 1);\n    }\n\n    return result;\n\n  },\n\n  indices: function (nFaceVertices) {\n\n    return new Uint32Array(this.sourceToTargetMap);\n\n  },\n\n  transcribeIndices: function (indices) {\n\n    return IndexMappings.apply(indices, this.sourceToTargetMap);\n\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/algorithm/GlobalCompaction.js","export default function BitSet(length) {\n\n  this.data = new Uint32Array((length + 31) >>> 5);\n  this.length = length;\n\n  this.byteView = null;\n};\n\nBitSet.prototype = {\n\n  constructor: BitSet,\n\n  clear: function () {\n\n    this.data.fill(0);\n    return this;\n  },\n\n  fill: function (optionalOffset, optionalLength) {\n\n    const data = this.data;\n\n    let begin = optionalOffset !== undefined ? optionalOffset : 0;\n    let until = optionalLength !== undefined ?\n              begin + optionalLength : this.length;\n\n    let wordIndexBegin = begin >>> 5;\n    let wordIndexUntil = until >>> 5;\n\n    // Smear the highbit with a signed shift for a pattern of MSBs:\n    const maskBegin = -0x80000000 >> ~begin;\n\n    // Power of two minus one yields a pattern of LSBs:\n    const maskUntil = (1 << until) - 1;\n\n    if (wordIndexBegin === wordIndexUntil)\n\n      data[wordIndexBegin] |= (maskBegin & maskUntil);\n\n    else {\n\n      data[wordIndexBegin] |= maskBegin;\n\n      if (++wordIndexBegin !== wordIndexUntil)\n        data.fill(~0, wordIndexBegin, wordIndexUntil);\n\n      data[wordIndexUntil] |= maskUntil;\n\n    }\n\n    return this;\n  },\n\n  include: function (i) {\n\n    this.data[i >>> 5] |= 1 << i;\n  },\n\n  exclude: function (i) {\n\n    this.data[i >>> 5] &= ~(1 << i);\n  },\n\n  contains: function (i) {\n\n    return (this.data[i >>> 5] & 1 << i) !== 0;\n  },\n\n  swap: function (i, j) {\n\n    const data = this.data;\n\n    const wordIndexI = i >>> 5, maskI = 1 << i;\n    const wordIndexJ = j >>> 5, maskJ = 1 << j;\n\n    const stateI = (data[wordIndexI] & maskI) !== 0;\n    const stateJ = (data[wordIndexJ] & maskJ) !== 0;\n\n    if (stateI !== stateJ) {\n\n      if (stateI) {\n\n        data[wordIndexI] &= ~maskI;\n        data[wordIndexJ] |= maskJ;\n\n      } else {\n\n        data[wordIndexI] |= maskI;\n        data[wordIndexJ] &= ~maskJ;\n      }\n    }\n\n  },\n\n  testAndInclude: function (i) {\n\n    const data = this.data;\n\n    const wordIndex = i >>> 5, mask = 1 << i;\n\n    const unchangedWord  = data[wordIndex];\n\n    data[wordIndex] = unchangedWord | mask;\n    return (unchangedWord & mask) !== 0;\n  },\n\n  includeFromArray: function (array, optionalOffset, optionalUntil) {\n\n    const data = this.data;\n\n    for (let j = optionalOffset || 0,\n        e = optionalUntil || array.length; j < e; ++j) {\n\n      const i = array[j];\n\n      data[i >>> 5] |= 1 << i;\n    }\n\n    return this;\n  },\n\n  containsAnyIn: function (array, optionalOffset, optionalUntil) {\n\n    let result = false;\n    const data = this.data;\n\n    for (let j = optionalOffset || 0,\n        e = optionalUntil || array.length; j < e && !result; ++j) {\n\n      const i = array[j];\n\n      result = (data[i >>> 5] & 1 << i) !== 0;\n    }\n\n    return result;\n  },\n\n  countSetBits: function (optionalOffset, optionalUntil) {\n\n    let result = 0;\n\n    const begin = optionalOffset !== undefined ? optionalOffset : 0;\n    const until = optionalUntil !== undefined ? optionalUntil : this.length;\n\n    if ((until - begin & -0x4000) === 0)\n      // that is, 'begin' is less than 'until' and fewer than 2048 bytes\n\n      result = this.countSetBitsInShortRange(begin, until);\n\n    else if (begin < until) {\n      // use a LUT - it's several times faster at scale\n\n      let data = this.byteView;\n      const lut = BitSet._ByteBitCount;\n\n      if (data === null) {\n\n        data = new Uint8Array(this.data.buffer);\n        this.byteView = data;\n      }\n\n      const wordIndexBegin = begin >>> 3;\n      const wordIndexUntil = until >>> 3;\n\n      // Smear the highbit with a signed shift for a pattern of MSBs:\n      const maskBegin = -0x80000000 >> 31 - (begin & 7);\n      // Power of two minus one yields a pattern of LSBs:\n      const maskUntil = (1 << (until & 7)) - 1;\n\n      result = lut[data[wordIndexBegin] & maskBegin];\n\n      for (let j = wordIndexBegin + 1; j !== wordIndexUntil; ++j)\n        result += lut[data[j]];\n\n      result += lut[data[wordIndexUntil] & maskUntil];\n    }\n\n    return result;\n  },\n\n  countSetBitsInShortRange: function (begin, until) {\n\n    // Note: For some odd reason the data word must be signed to keep\n    // V8 from deoptimizing - all unsigned access won't do.\n\n    let result = 0;\n\n    const data = this.data;\n\n    let here = begin;\n    let index = here >>> 5;\n\n    let word = data[index] >> here;\n\n    result = word & 1;\n\n    while (++here !== until) {\n\n      if ((here & 31) !== 0)\n        word >>= 1;\n      else\n        word = data[++index] | 0; // cast to signed (important)\n\n      result += word & 1;\n    }\n\n    return result;\n  },\n\n  toIndexArray: function (optionalKnownLength) {\n\n    const result = new Uint32Array(\n          optionalKnownLength === undefined ?\n              this.countSetBits() : optionalKnownLength);\n    let baseIndex = 0;\n    let writeOffset = 0;\n    const data = this.data;\n\n    for (let j = 0, n = data.length; j !== n; ++j) {\n\n      for (let mask = data[j],\n          i = baseIndex; mask !== 0; mask >>>= 1, ++i)\n\n        if ((mask & 1) !== 0) result[writeOffset++] = i;\n\n      baseIndex += 32;\n    }\n\n    return result;\n  },\n\n};\n\nBitSet._ByteBitCount = (function () {\n\n  const lut = new Uint8Array(256);\n\n  for (let i = 0; i !== 256; ++i) {\n\n    let value = 0;\n    for (let m = i; m !== 0; m >>>= 1) if ((m & 1) !== 0) ++value;\n\n    lut[i] = value;\n  }\n\n  return lut;\n\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/generic/container/BitSet.js","import Arrays from '../../generic/utility/Arrays';\nimport PolyMaps from '../model/PolyMaps';\nimport ScalarBuffer from '../../generic/container/ScalarBuffer';\nimport BitSet from '../../generic/container/BitSet';\nimport IndexMappings from '../../generic/algorithm/IndexMappings';\n\nexport default function Selection(indices, meaning, optionalMapId) {\n\n  this.indices = indices;\n  this.meaning = meaning;\n  this.mapId = optionalMapId || PolyMaps.IdPositions;\n};\n\nSelection.Faces = 0;\nSelection.Vertices = 1;\nSelection.Edges = 2;\n\nSelection.prototype = {\n\n  constructor: Selection,\n\n  getIndices: function (mesh, meaning, optionalMapId) {\n\n    var indices = this.indices,\n      convTab = Selection.ConversionTable,\n      convFunc = convTab[this.meaning][meaning];\n\n    if (convFunc !== null)\n\n      indices = convFunc.call(null, mesh, indices,\n          this.mapId, optionalMapId || PolyMaps.IdPositions);\n\n    return indices;\n  },\n\n};\n\nSelection.newRandomSelection =\n    function (seed, density, polyMesh, meaning, optionalMapId) {\n\n  var n = Selection.getNumElements(polyMesh, meaning, optionalMapId),\n\n    nPopulation = density * n | 0,\n    bits = new BitSet(n).fill(0, nPopulation),\n    prng = seed;\n\n  for (var i = 0, e = n - 1; i < e; ++i) {\n\n    // Magic constants taken from\n    // https://en.wikipedia.org/wiki/Linear_congruential_generator\n    prng = prng * 22695477 + 1 >>> 0;\n\n    bits.swap(i, i + (prng & 0x3fffffff) % (n - i));\n  }\n\n  return new Selection(bits.toIndexArray(), meaning, optionalMapId);\n\n};\n\n\n// Provides an identity mapping in case a selection is not provided:\n\nSelection.getIndices = function (\n    mesh, meaning, optionalSelectionOrMapId, optionalSelection) {\n\n  var mapId = PolyMaps.IdPositions,\n    selection = optionalSelection;\n\n  if (typeof optionalSelectionOrMapId === 'string')\n    mapId = optionalSelectionOrMapId;\n  else\n    selection = optionalSelectionOrMapId;\n\n  return !selection ?\n\n      IndexMappings.identityForReading(\n        Selection.getNumElements(mesh, meaning, mapId)) :\n\n      selection.getIndices(mesh, meaning, mapId);\n};\n\nSelection.getNumElements = function (mesh, meaning, optionalMapId) {\n\n  switch (meaning) {\n\n    case Selection.Faces:\n      return mesh.getNumFaces();\n\n    case Selection.Vertices:\n      return PolyMaps.resolveMap(mesh,\n          optionalMapId || PolyMaps.IdPositions).values.length;\n\n    case Selection.Edges:\n      return PolyMaps.resolveMap(mesh,\n          optionalMapId || PolyMaps.IdPositions).getNumEdges();\n\n    default:\n      throw Error('Bad meaning argument!');\n  }\n};\n\n// Conversions:\n\nSelection.convFacesToVertices = function (mesh, indices, _, mapId) {\n\n  var mapOut = PolyMaps.resolveMap(mesh, mapId),\n    result = new BitSet(mapOut.values.length),\n\n    faceRangeOffsets = mesh.faceRangeOffsets,\n    mapValueIndices = mapOut.faceValueIndices;\n\n  for (var i = 0, n = indices.length; i !== n; ++i) {\n\n    var faceIndex = indices[i],\n\n      begin = faceRangeOffsets[faceIndex],\n      until = faceRangeOffsets[faceIndex + 1];\n\n    result.includeFromArray(mapValueIndices, begin, until);\n  }\n\n  return result.toIndexArray();\n};\n\nSelection.convFacesToEdges = function (mesh, indices, _, mapId) {\n\n  var mapOut = PolyMaps.resolveMap(mesh, mapId),\n    result = new BitSet(mapOut.getNumEdges()),\n\n    faceRangeOffsets = mesh.faceRangeOffsets,\n    mapValueIndices = mapOut.faceValueIndices;\n\n  for (var i = 0, n = indices.length; i !== n; ++i) {\n\n    var faceIndex = indices[i],\n\n      begin = faceRangeOffsets[faceIndex],\n      until = faceRangeOffsets[faceIndex + 1];\n\n    if (begin !== until) {\n\n      var vertexA = mapValueIndices[until - 1];\n\n      for (var j = begin; j !== until; ++j) {\n\n        var vertexB = mapValueIndices[j];\n        result.include(mapOut.findEdgeId(vertexA, vertexB));\n        vertexA = vertexB;\n      }\n    }\n  }\n\n  return result.toIndexArray();\n};\n\n//\n\nSelection.convVerticesToFaces = function (mesh, indices, mapId, _) {\n\n  var buffer = new ScalarBuffer(Uint32Array),\n\n    faceRangeOffsets = mesh.faceRangeOffsets,\n    mapValueIndices =\n        PolyMaps.resolveMap(mesh, mapId).faceValueIndices,\n\n    nFaces = mesh.getNumFaces();\n\n  for (var faceIndex = 0; faceIndex !== nFaces; ++faceIndex) {\n\n    var begin = faceRangeOffsets[faceIndex],\n      until = faceRangeOffsets[faceIndex + 1],\n\n      allVerticesFound = true;\n\n    for (var i = begin; i !== until && allVerticesFound; ++i)\n\n      allVerticesFound = -1 <\n          Arrays.binarySearch(indices, mapValueIndices[i]);\n\n    if (allVerticesFound) buffer.push(faceIndex);\n  }\n\n  return buffer.toArrayAndClear();\n};\n\nSelection.convVerticesToVertices =\n    function (mesh, indices, mapIdIn, mapIdOut) {\n\n  if (mapIdIn === mapIdOut) return indices;\n\n  var mapOut = PolyMaps.resolveMap(mesh, mapIdOut),\n    result = new BitSet(mapOut.values.length),\n\n    mapOutValueIndices = mapOut.faceValueIndices,\n\n    mapIn = PolyMaps.resolveMap(mesh, mapIdIn).updateInverseIndex(),\n    faceIndexOffsets = mapIn.valueFaceIndexOffsets,\n    faceIndices = mapIn.valueFaceIndices;\n\n  for (var i = 0, n = indices.length; i !== n; ++i) {\n\n    var mapInValueIndex = indices[i],\n\n      facesBegin = faceIndexOffsets[mapInValueIndex],\n      facesUntil = faceIndexOffsets[mapInValueIndex + 1];\n\n    for (var j = facesBegin; j !== facesUntil; ++j) {\n\n      var vertexOffset =\n          mapIn.findValueIndexOffset(\n              faceIndices[j], mapInValueIndex);\n\n      result.include(mapOutValueIndices[vertexOffset]);\n    }\n  }\n\n  return result.toIndexArray();\n};\n\nSelection.convVerticesToEdges =\n    function (mesh, indices, mapIdIn, mapIdOut) {\n\n  var mapOut = PolyMaps.resolveMap(mesh, mapIdOut),\n    result = new BitSet(mapOut.getNumEdges()),\n\n    faceRangeOffsets = mesh.faceRangeOffsets,\n    mapValueIndices =\n        PolyMaps.resolveMap(mesh, mapIdIn).faceValueIndices,\n\n    nFaces = mesh.getNumFaces();\n\n  for (var faceIndex = 0; faceIndex !== nFaces; ++faceIndex) {\n\n    var begin = faceRangeOffsets[faceIndex],\n      until = faceRangeOffsets[faceIndex + 1];\n\n    if (begin !== until) {\n\n      var last = mapValueIndices[--until],\n        lastSelected = -1 < Arrays.binarySearch(indices, last),\n\n        vertexA = last,\n        prevSelected = lastSelected;\n\n      for (var j = begin; j !== until; ++j) {\n\n        var vertexB = mapValueIndices[j],\n          selected = -1 < Arrays.binarySearch(indices, vertexB);\n\n        if (prevSelected && selected)\n\n          result.include(mapOut.findEdgeId(vertexA, vertexB));\n\n        vertexA = vertexB;\n        prevSelected = selected;\n      }\n\n      if (prevSelected && lastSelected)\n        result.include(mapOut.findEdgeId(vertexA, last));\n    }\n  }\n\n  return result.toIndexArray();\n};\n\n//\n\nSelection.convEdgesToFaces = function (mesh, indices, mapIdIn, _) {\n\n  var tmp = Selection.\n      convEdgesToVertices(mesh, indices, mapIdIn, mapIdIn);\n\n  return Selection.convVerticesToFaces(mesh, tmp, mapIdIn, '');\n};\n\nSelection.convEdgesToVertices =\n    function (mesh, indices, mapIdIn, mapIdOut) {\n\n  var tmp = Selection.\n      convEdgesToVerticesOfSameMap(mesh, indices, mapIdIn);\n\n  return Selection.convVerticesToVertices(mesh, tmp, mapIdIn, mapIdOut);\n};\n\nSelection.convEdgesToEdges =\n    function (mesh, indices, mapIdIn, mapIdOut) {\n\n  if (mapIdIn === mapIdOut) return indices;\n\n  var tmp = Selection.\n      convEdgesToVerticesOfSameMap(mesh, indices, mapIdIn);\n\n  return Selection.\n      convVerticesToEdges(mesh, indices, mapIdIn, mapIdOut);\n};\n\nSelection.convEdgesToVerticesOfSameMap = function (mesh, indices, mapId) {\n\n  var map = PolyMaps.resolveMap(mesh, mapId).updateEdgeMap(),\n\n    edgeRangeOffsets = map.edgePivotRangeOffsets,\n    highVertexIndices = map.edgeHighVertexIndices,\n\n    result = new BitSet(map.values.length);\n\n  for (var i = 0, n = indices.length; i !== n; ++i) {\n\n    var edgeId = indices[i],\n\n      hiVertex = highVertexIndices[edgeId],\n\n      searchResult = Arrays.\n          binarySearch(edgeRangeOffsets, edgeId + 1);\n\n    if (searchResult < 0) searchResult = ~searchResult;\n\n    var loVertex = searchResult - 1;\n\n    result.include(hiVertex);\n    result.include(loVertex);\n  }\n\n  return result.toIndexArray();\n};\n\nSelection.ConversionTable = [\n\n  // From Faces to...\n  [\n    // ... Faces\n    null,\n    // ... Vertices\n    Selection.convFacesToVertices,\n    // ... Edges\n    Selection.convFacesToEdges,\n  ],\n  // From Vertices to...\n  [\n    // ... Faces\n    Selection.convVerticesToFaces,\n    // ... Vertices\n    Selection.convVerticesToVertices,\n    // ... Edges\n    Selection.convVerticesToEdges,\n  ],\n  // From Edges to...\n  [\n    // ... Faces\n    Selection.convEdgesToFaces,\n    // ... Vertices\n    Selection.convEdgesToVertices,\n    // ... Edges\n    Selection.convEdgesToEdges,\n  ],\n];\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/transient/Selection.js","import PolyMaps from '../geometric/model/PolyMaps';\nimport Exporter from '../geometric/tool/Exporter';\nimport * as THREE from 'three';\n\nconst ThreeExport = {\n\n    NoIndices: 0,\n    SimpleIndices: 1,\n    CompactIndices: 2,\n\n    exportBufferGeometry: function (\n            polyMesh, indicesMode, interleaved, exportTangents, oldMesh, prevTriangulation, prevIndexing, prevValueMap) {\n\n        var result = new THREE.BufferGeometry(),\n            exportSpec = [],\n            { exporter, triangulationChanged } = ThreeExport._prepare(polyMesh,\n                                                                      exportSpec,\n                                                                      indicesMode,\n                                                                      interleaved,\n                                                                      exportTangents,\n                                                                      oldMesh,\n                                                                      prevTriangulation,\n                                                                      prevIndexing),\n\n            IdPositions = PolyMaps.IdPositions,\n            valueMap = {};\n\n        if (indicesMode !== ThreeExport.NoIndices) {\n\n          var indices = indicesMode === ThreeExport.SimpleIndices ?\n                  exporter.getTriangulatingIndices() :\n                  exporter.getMapIndices(IdPositions);\n\n          result.setIndex(new THREE.BufferAttribute(indices, 1, false));\n        }\n\n        if (!interleaved) {\n\n          for (var i = 0; i !== exportSpec.length; ++i) {\n\n            //console.log(indicesMode);\n\n            var attrSpec = exportSpec[i],\n\n                triangulateValues =\n                        indicesMode === ThreeExport.NoIndices;\n\n            var data;\n            var newMap = PolyMaps.resolveMap(polyMesh, attrSpec.mapId),\n            oldMap = oldMesh && PolyMaps.resolveMap(oldMesh, attrSpec.mapId);\n\n            if (oldMap !== newMap || !prevValueMap) {\n              data = indicesMode !== ThreeExport.CompactIndices ?\n\n                          exporter.getUnindexedMapValues(\n                                  attrSpec.mapId, triangulateValues) :\n\n                          exporter.getMapValues(attrSpec.mapId);\n            } else {\n              //console.log('skip');\n              data = prevValueMap[attrSpec.mapId];\n            }\n\n            valueMap[attrSpec.mapId] = data;\n            result.addAttribute(attrSpec.threeName,\n                    new THREE.BufferAttribute(\n                        data, attrSpec.itemSize, attrSpec.normalized));\n          }\n\n        } else {\n\n          var stride = 0;\n          for (var i = 0; i !== exportSpec.length; ++i)\n              stride += exportSpec[i].itemSize;\n\n          var nValuess = 0;\n          switch (indicesMode) {\n\n            case ThreeExport.NoIndices: // no. of triangulated vertices\n              nValuess = exporter.getNumFaceVertices();\n              break;\n\n            case ThreeExport.SimpleIndices: // no. of values\n              nValuess = exporter.mesh.getNumFaceVertices();\n              break;\n\n            case ThreeExport.CompactIndices: // as calculated\n              nValuess = exporter.\n                      getNumMapValues(PolyMaps.IdPositions);\n          }\n\n          var data = new Float32Array(stride * nValuess),\n              buffer = new THREE.InterleavedBuffer(data, stride),\n\n              offset = 0;\n\n          for (var i = 0; i !== exportSpec.length; ++i) {\n\n            var attrSpec = exportSpec[i],\n                itemSize = attrSpec.itemSize,\n                mapId = attrSpec.mapId;\n\n            if (indicesMode !== ThreeExport.CompactIndices) {\n\n              exporter.getUnindexedMapValues(mapId,\n                      indicesMode === ThreeExport.NoIndices,\n                      data, offset, stride);\n\n            } else {\n\n              exporter.getMapValues(mapId, data, offset, stride);\n            }\n\n            result.addAttribute(attrSpec.threeName,\n                    new THREE.InterleavedBufferAttribute(\n                                            buffer, itemSize, offset));\n\n            offset += itemSize;\n          }\n        }\n        // add group to buffer geometry if there is materialId list in polymesh\n        var groups = exporter.getGroups();\n        if (polyMesh.materialIds && groups) {\n          for (var i = 0; i < groups.groupCounts.length; i++) {\n            if(groups.groupCounts[i] > 0) {\n              result.addGroup(groups.groupStarts[i], groups.groupCounts[i], i);\n            }\n          }\n        }\n        return {\n            geometry: result,\n            triangulation: exporter.triangulation,\n            renderIndexing: exporter.renderIndexing,\n            triangulationChanged,\n            valueMap,\n          };\n      },\n\n    _prepare: function (\n            polyMesh, outSpec, indicesMode, interleaved, exportTangents, oldMesh, prevTriangulation, prevIndexing) {\n\n        var exporter = new Exporter(polyMesh),\n            mapsToExport = [];\n\n        var retriangulate = !oldMesh || !prevTriangulation\n            || oldMesh.positions.faceValueIndices !== polyMesh.positions.faceValueIndices;\n        var reIndex = !oldMesh || !prevIndexing;\n\n        var mapOffset = 0;\n        //console.log(polyMesh);\n        for (var iter = new PolyMaps.Iterator(polyMesh); iter.next();) {\n\n          var threeName = '',\n              itemSize = 3,\n              normalized = false;\n\n          switch (iter.typeId) {\n\n          case PolyMaps.TypePosition:\n            threeName = 'position';\n            break;\n\n          case PolyMaps.TypeTangent:\n            // Note: Since tangents are normally ignored by the three.js\n            // renderer, they must be requested explicitly.\n            if (!exportTangents) break;\n            threeName = 'tangent';\n            break;\n\n          case PolyMaps.TypeNormal:\n            threeName = 'normal';\n            break;\n\n          case PolyMaps.TypeUV:\n            if (iter.index >= 2) break; // max two UV maps\n            threeName = 'uv' + (\n                    iter.index !== 0 ? iter.index + 1 : '');\n            itemSize = 2;\n            break;\n\n          case PolyMaps.TypeColor:\n\n            if (iter.index >= 1) break; // use first color map\n            threeName = 'color';\n            normalized = true;\n\n        }\n\n          if (!threeName || (interleaved && normalized)) continue;\n\n          var mapId = iter.getId();\n          mapsToExport.push(mapId);\n\n          outSpec.push({\n              mapId: mapId,\n              threeName: threeName,\n              itemSize: itemSize,\n              normalized: normalized,\n            });\n          ++mapOffset;\n\n        }\n\n        for (var i = 0; i < outSpec.length && !reIndex; i++) {\n          var oldMap = PolyMaps.resolveMap(oldMesh, outSpec[i].mapId),\n          newMap = PolyMaps.resolveMap(polyMesh, outSpec[i].mapId);\n          if (oldMap.faceValueIndices !== newMap.faceValueIndices) reIndex = true;\n        }\n\n        //console.log(polyMesh===(prevData && prevData.mesh));\n        if (indicesMode === ThreeExport.CompactIndices && !reIndex) {\n          prevIndexing.mesh = polyMesh;\n          exporter.renderIndexing = prevIndexing;\n        } else if (indicesMode === ThreeExport.CompactIndices && reIndex) {\n\n          exporter.reindexForRendering(mapsToExport);\n        }\n\n        var triangulationChanged = false;\n        if (retriangulate) {\n          exporter.triangulate();\n          triangulationChanged = true;\n        } else {\n          exporter.triangulation = prevTriangulation;\n        }\n\n        return { exporter, triangulationChanged };\n      },\n\n  };\n\nexport default ThreeExport;\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/three/ThreeExport.js","import Arrays from '../../generic/utility/Arrays';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ScalarArrayView from '../../generic/container/ScalarArrayView';\nimport IndexMappings from '../../generic/algorithm/IndexMappings';\nimport RenderIndexing from '../algorithm/RenderIndexing';\nimport SimpleFanTriangulation from '../algorithm/SimpleFanTriangulation';\n\nexport default function Exporter(polyMesh) {\n\n  this.mesh = polyMesh;\n\n  this.triangulation = null;\n  this.renderIndexing = null;\n};\n\nExporter.prototype = {\n\n  constructor: Exporter,\n\n  reindexForRendering: function (optionalMapIdWhitelist) {\n\n    if (this.triangulation !== null)\n      throw Error('Reindex must come before triangulation!');\n\n    this.renderIndexing =\n        new RenderIndexing(this.mesh, optionalMapIdWhitelist);\n\n    return this;\n  },\n\n  triangulate: function (optionalTriangulationType) {\n\n    var triangulationType =\n        optionalTriangulationType || SimpleFanTriangulation;\n\n    this.triangulation =\n        new triangulationType(this.mesh, this.renderIndexing);\n\n    return this;\n  },\n\n  getNumFaces: function () {\n\n    var triangulation = this.triangulation;\n\n    return triangulation === null ? this.mesh.getNumFaces() :\n        triangulation.numTriangles;\n  },\n\n  getNumFaceVertices: function () {\n\n    return this.triangulation === null ?\n        this.mesh.getNumFaceVertices() : this.getNumFaces() * 3;\n  },\n\n  getNumMapValues: function (mapId) {\n\n    var renderIndexing = this.renderIndexing;\n\n    return renderIndexing !== null ?\n        renderIndexing.numVertices :\n        this.mesh.getMapById(mapId).values.length;\n  },\n\n  getFaceArities: function (\n      optionalArrayOrType, optionalOffset, optionalStride) {\n\n    if (this.triangulation !== null)\n      throw Error('No face arity export for triangular meshes!');\n\n    var result = new ScalarArrayView(this.getNumFaces(),\n          optionalArrayOrType, optionalOffset, optionalStride),\n\n      offsets = this.mesh.faceRangeOffsets,\n      nOffsets = offsets.length;\n\n    if (nOffsets > 1) {\n\n      var prevOffset = offsets[0];\n\n      for (var i = 1; i !== nOffsets; ++i) {\n\n        var offset = offsets[i];\n        result.setAt(i - 1, offset - prevOffset);\n        prevOffset = offset;\n      }\n\n    }\n\n    return result.data;\n  },\n\n  getMaterialIds: function (\n      optionalArrayOrType, optionalOffset, optionalStride) {\n\n    var result = null,\n      source = this.mesh.materialIDs;\n\n    if (source === null) return null;\n\n    if (this.triangulation === null) {\n\n      var offset = optionalOffset || 0,\n        stride = optionalStride || 1,\n        arrayOrType = optionalArrayOrType || source.data.constructor;\n\n      if (offset === 0 && stride === 1 &&\n          arrayOrType === source.data.constructor)\n\n        return source;\n\n      result = new ScalarArrayView(\n          source.length, arrayOrType, offset, stride);\n\n      result.fromArray(source);\n\n    } else {\n\n      this.triangulation.translateMaterialIds(source, result);\n\n    }\n\n    return result.data;\n  },\n\n  getMapValues: function (mapId,\n      optionalArrayOrType, optionalOffset, optionalStride) {\n\n    var result = null,\n      renderIndexing = this.renderIndexing,\n\n      source = this.mesh.getMapById(mapId).values,\n      type = source.type,\n\n      offset = optionalOffset || 0,\n      stride = optionalStride || type.InstanceScalarSize,\n      arrayOrType = optionalArrayOrType || source.data.constructor;\n\n    if (renderIndexing === null &&\n        (offset === 0) &&\n        (stride === type.InstanceScalarSize) &&\n        (arrayOrType === source.data.constructor))\n\n      result = source; // compatible format, just expose the data\n\n    else {\n\n      var length = renderIndexing === null ?\n          source.length : renderIndexing.numVertices;\n\n      result = this._offsetObjects(\n          type, length, arrayOrType, offset, stride);\n\n      if (renderIndexing !== null) {\n\n        renderIndexing.getMapValues(mapId, result);\n\n      } else {\n\n        result.fromArray(source.data);\n\n      }\n    }\n\n    return result.data;\n  },\n  getGroups: function() {\n    var triangulation = this.triangulation;\n    var result =  triangulation.groups;\n    return result;\n  },\n  getMapIndices: function (mapId,\n      optionalArrayOrType, optionalOffset, optionalStride) {\n\n    var result = null,\n\n      renderIndexing = this.renderIndexing,\n      triangulation = this.triangulation,\n\n      source = renderIndexing !== null ?\n          renderIndexing.renderIndices :\n          this.mesh.getMapById(mapId).faceValueIndices;\n\n    if (triangulation === null) {\n\n      var offset = optionalOffset || 0,\n        stride = optionalStride || 1,\n        arrayOrType = optionalArrayOrType || source.constructor;\n\n      if (offset === 0 && stride === 1 &&\n          arrayOrType === source.constructor)\n\n        return source;\n\n      result = new ScalarArrayView(\n          source.length, arrayOrType, offset, stride);\n\n      result.fromArray(source);\n\n    } else {\n\n      result = new ScalarArrayView(\n          this.triangulation.numTriangles * 3,\n          optionalArrayOrType, optionalOffset, optionalStride);\n\n      triangulation.translateIndices(source, result);\n\n    }\n\n    return result.data;\n  },\n\n  getUnindexedMapValues: function (mapId, allowTriangulation,\n      optionalArrayOrType, optionalOffset, optionalStride) {\n\n    var result = null,\n      polyMap = this.mesh.getMapById(mapId),\n      values = polyMap.values,\n      valueType = values.type,\n      indices = polyMap.faceValueIndices,\n      triangulation = this.triangulation;\n\n    if (!allowTriangulation || triangulation === null) {\n\n      result = this._offsetObjects(\n            valueType, indices.length,\n            optionalArrayOrType || values.data.constructor,\n            optionalOffset, optionalStride);\n\n      var temp = values.newRangeArray(1);\n\n      for (var i = 0, n = indices.length; i !== n; ++i)\n\n        result.arrayToRange(\n            values.rangeToArray(indices[i], 1, temp), i, 1);\n\n    } else {\n\n      result = this._offsetObjects(\n            valueType, triangulation.numTriangles * 3,\n            optionalArrayOrType || values.data.constructor,\n            optionalOffset, optionalStride);\n\n      triangulation.\n          translateToUnindexedValues(values, result, indices);\n    }\n\n    return result.data;\n  },\n\n  getTriangulatingIndices: function (\n      optionalArrayOrType, optionalOffset, optionalStride) {\n\n    var triangulation = this.triangulation;\n\n    if (triangulation === null) return null;\n\n    var result = new ScalarArrayView(this.getNumFaceVertices(),\n        optionalArrayOrType, optionalOffset, optionalStride),\n\n      nFaceVertices = this.getNumFaceVertices(),\n      identityMap = IndexMappings.identityForReading(nFaceVertices);\n\n    triangulation.translateIndices(identityMap, result);\n\n    return result.data;\n  },\n\n  _offsetObjects: function (\n      type, length, arrayOrType, optionalOffset, optionalStride) {\n\n    var offset = optionalOffset || 0,\n      stride = optionalStride || type.InstanceScalarSize,\n\n      offsetLength = offset / stride | 0,\n      minArrayLength = (offsetLength + length) * stride,\n      array = Arrays.maybeCreate(arrayOrType, minArrayLength),\n      offsetView = offset === 0 ? array : array.subarray(offset);\n\n    return new ObjectArrayView(type, null, offsetView, stride);\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/tool/Exporter.js","import PolyMaps from '../model/PolyMaps';\n\nexport default function RenderIndexing(polyMesh, optionalMapIdWhitelist) {\n\n  var mapIds = [],\n    mapStates = [];\n\n  for (var iter = new PolyMaps.Iterator(polyMesh); iter.next();) {\n\n    var map = iter.element,\n      mapId = iter.getId();\n\n    if (optionalMapIdWhitelist &&\n        optionalMapIdWhitelist.indexOf(mapId) === -1) continue;\n\n    mapIds.push(mapId);\n\n    mapStates.push({\n      map: map,\n      faceIndices: map.updateInverseIndex().valueFaceIndices,\n      facesOffset: 0,\n    });\n  }\n\n  // Processing face vertices, an n-way MERGE-like step is performed to\n  // identify a previously processed face that uses the same combination\n  // of value indices. Forward processing and the sorted nature of the\n  // inverse PolyMap indices allow this algorithm to be very efficient.\n\n  var nFaceVertices = polyMesh.getNumFaceVertices(),\n    nMaps = mapStates.length,\n\n    renderIndices = new Uint32Array(nFaceVertices),\n    valueIndices = new Uint32Array(nFaceVertices * nMaps),\n    writeOffset = 0,\n    nVertices = 0,\n\n    faceRangeOffsets = polyMesh.faceRangeOffsets,\n    faceIndex = -1,\n    nextFaceStart = 0,\n\n    pivotState = mapStates[nMaps - 1],\n    pivotFaces = pivotState.faceIndices,\n    mapScanStart = nMaps - 2;\n\n  for (var i = 0; i !== nFaceVertices; ++i) {\n\n    if (i === nextFaceStart)\n      nextFaceStart = faceRangeOffsets[++faceIndex + 1];\n\n    // Try to find a face before this one that already uses all the\n    // values for this vertex:\n\n    var reusePossible = true,\n      reuseFromFace = 0;\n\n    for (var j = 0; j !== nMaps; ++j) {\n\n      var mapState = mapStates[j],\n        map = mapState.map,\n        valueIndex = map.faceValueIndices[i];\n\n      // Speculatively write data:\n      valueIndices[writeOffset + j] = valueIndex;\n\n      if (reusePossible) {\n\n        var facesBegin = map.valueFaceIndexOffsets[valueIndex],\n          firstFaceIndex = map.valueFaceIndices[facesBegin];\n\n        // Speculatively prepare the scanning state:\n        mapState.facesOffset = facesBegin;\n\n        // Early-out when a value index is used for the first time:\n        reusePossible = (firstFaceIndex !== faceIndex);\n      }\n\n    }\n\n    if (reusePossible) {\n\n      var pivotFaceIdxPos = pivotState.facesOffset,\n        pivotFaceIndex = 0,\n        pivotFaceGood = true;\n\n      do {\n\n        pivotFaceIndex = pivotFaces[pivotFaceIdxPos++];\n        pivotFaceGood = (pivotFaceIndex !== faceIndex);\n        reusePossible = pivotFaceGood;\n\n        for (var j = mapScanStart;\n            pivotFaceGood && j !== -1; --j) {\n\n          var mapState = mapStates[j],\n            faceIdxPos = mapState.facesOffset,\n            faceIndices = mapState.faceIndices,\n            candidate = faceIndices[faceIdxPos];\n\n          while (candidate < pivotFaceIndex)\n            candidate = faceIndices[++faceIdxPos];\n\n          if (candidate !== pivotFaceIndex) pivotFaceGood = false;\n          if (candidate === faceIndex) reusePossible = false;\n          else mapState.facesOffset = faceIdxPos;\n\n          // Note that the next pivot face will have a higher index\n          // and that we'll see the current face when out of input.\n          // Also note that the pivot face has a lower index than\n          // the current face.\n\n        }\n\n      } while (reusePossible && !pivotFaceGood);\n\n      reusePossible = pivotFaceGood;\n      reuseFromFace = pivotFaceIndex;\n\n    }\n\n    if (reusePossible) {\n\n      var positionMap = mapStates[0].map,\n        faceVertexIndex = positionMap.findValueIndexOffset(\n            reuseFromFace, positionMap.faceValueIndices[i]),\n\n        reuseIndex = renderIndices[faceVertexIndex];\n\n      renderIndices[i] = reuseIndex;\n\n    } else {\n\n      renderIndices[i] = nVertices++;\n      writeOffset += nMaps;\n\n    }\n  }\n\n  this.mesh = polyMesh;\n  this.mapIds = mapIds;\n  this.renderIndices = renderIndices;\n  this.valueIndices = valueIndices.slice(0, writeOffset);\n  this.numVertices = nVertices;\n\n};\n\nRenderIndexing.prototype = {\n\n  constructor: RenderIndexing,\n\n  getMapValues: function (mapId, targetView) {\n\n    var mapIds = this.mapIds,\n      mapIndex = mapIds.indexOf(mapId),\n      nVertices = this.numVertices,\n      valueIndices = this.valueIndices;\n\n    if (mapIndex === -1)\n      throw Error(\"Map with id '\" + mapId + \"' not found!\");\n\n    var map = PolyMaps.resolveMap(this.mesh, mapId),\n      mapValues = map.values;\n\n    if (targetView.length < nVertices)\n      throw Error(\"Data won't fit!\");\n\n    var viOffset = mapIndex,\n      viStride = mapIds.length,\n\n      tmp = new targetView.type();\n\n    for (var i = 0; i !== nVertices; ++i) {\n\n      var valueIndex = valueIndices[viOffset + i * viStride];\n      targetView.setAt(i, mapValues.getAt(valueIndex, tmp));\n\n    }\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/algorithm/RenderIndexing.js","import * as THREE from 'three';\n\nexport default function SimpleFanTriangulation(mesh) {\n\n  this.mesh = mesh;\n  this.groups = null;\n  var nTriangles = 0,\n\n    faceOffsets = mesh.faceRangeOffsets,\n    faceBegin = faceOffsets[0],\n    maxNumVerticesPerFace = 0;;\n\n  for (var i = 1, n = faceOffsets.length; i < n; ++i) {\n\n    var faceUntil = faceOffsets[i],\n      nVertices = faceUntil - faceBegin;\n\n    if (nVertices >= 3) nTriangles += nVertices - 2;\n\n    maxNumVerticesPerFace = Math.max(maxNumVerticesPerFace, nVertices);\n\n    faceBegin = faceUntil;\n  }\n\n  this.startFaceIndices = this.getStartFaceIndices(mesh.positions, maxNumVerticesPerFace);\n  //console.log( 'this.startFaceIndices', this.startFaceIndices );\n\n  this.numTriangles = nTriangles;\n};\n\nSimpleFanTriangulation.prototype = {\n\n  constructor: SimpleFanTriangulation,\n\n  getStartFaceIndices: function (positionsPolyMap, maxNumVerticesPerFace) {\n\n    //return an array of size faces, that says which face vertex index to use as the starting vertex in simple fan triangulation.\n    // you will want return the first convex vertex face vertex index (in the range 0 to number of vertices in that face), if there is one\n    // otherwise you can return 0.\n\n    var faceOffsets = this.mesh.faceRangeOffsets;\n\n    var numFaces = this.mesh.faceRangeOffsets.length - 1;\n    var startFaceIndices = new Uint32Array(numFaces);\n    var faceEdgeSign = new Float32Array(maxNumVerticesPerFace);\n\n    var faceValueIndices = positionsPolyMap.faceValueIndices;\n    var positionValues = positionsPolyMap.values;\n\n    var dPrev = new THREE.Vector3();\n    var d = new THREE.Vector3();\n    var dNext = new THREE.Vector3();\n    var dTemp;\n\n    var pPrev = new THREE.Vector3();\n    var p = new THREE.Vector3();\n    var pNext = new THREE.Vector3();\n    var pNextNext = new THREE.Vector3();\n    var pTemp;\n\n    var cpTemp;\n    var cp = new THREE.Vector3();\n    var cpNext = new THREE.Vector3();\n\n    for (var i = 0, il = faceOffsets.length - 1; i < il; ++i) {\n\n      var faceBegin = faceOffsets[i];\n      var faceUntil = faceOffsets[i + 1];\n      var numFaceVertices = faceUntil - faceBegin;\n\n      if (numFaceVertices <= 3) {\n        continue;\n      }\n\n      var vPrev;\n      var v = faceValueIndices[faceBegin + (numFaceVertices - 1)];\n      var vNext = faceValueIndices[faceBegin];\n      var vNextNext = faceValueIndices[faceBegin + (1 % numFaceVertices)];\n\n      positionValues.getAt(v, p);\n      positionValues.getAt(vNext, pNext);\n      positionValues.getAt(vNextNext, pNextNext);\n\n      d.copy(pNext).sub(p);\n      dNext.copy(pNextNext).sub(pNext);\n\n      cpNext.copy(dNext).cross(d);\n\n      for (var j = 0; j < numFaceVertices; ++j) {\n\n        vPrev = v;\n        v = vNext;\n        vNext = vNextNext;\n        vNextNext = faceValueIndices[faceBegin + ((j + 2) % numFaceVertices)];\n\n        pTemp = pPrev;\n        pPrev = p;\n        p = pNext;\n        pNext = pNextNext;\n        pNextNext = pTemp;\n        positionValues.getAt(vNextNext, pNextNext);\n\n        dTemp = dPrev;\n        dPrev = d;\n        d = dNext;\n        dNext = dTemp;\n        dNext.copy(pNextNext).sub(pNext);\n\n        cpTemp = cp;\n        cp = cpNext;\n        cpNext = cpTemp;\n        cpNext.copy(dNext).cross(d);\n\n        var sign = cp.dot(cpNext);\n\n        faceEdgeSign[j] = sign;\n      }\n\n      //console.log( 'faceEdgeSign for face: ', i, faceEdgeSign );\n\n      for (var j = 0; j < numFaceVertices; ++j) {\n        var sign = faceEdgeSign[j];\n        var signNext = faceEdgeSign[(j + 1) % numFaceVertices];\n        if (sign >= 0 && signNext >= 0) {\n          startFaceIndices[i] = (j + 1) % numFaceVertices;\n          break;\n        }\n      }\n    }\n\n    return startFaceIndices;\n  },\n\n  translateIndices: function (inputArray, outputView) {\n\n    var faceOffsets = this.mesh.faceRangeOffsets,\n      outputArray = outputView.data,\n      writeIndex = outputView.offset,\n      stride = outputView.stride;\n\n    var materialIds = null;\n    var polygonOrder = null;\n    var groupMin = null;\n    var groupMax = null;\n\n    // if multi-materials, sort polygons in material order and create material groups\n    if(this.mesh.materialIds) {\n\n      materialIds = this.mesh.materialIds;\n\n      var numPolygons = faceOffsets.length - 1;\n      var polygonOrder = new Uint32Array( numPolygons );\n      for( var i = 0; i < polygonOrder.length; i ++ ) {\n        polygonOrder[i] = i;\n      }\n\n      polygonOrder.sort( function( a, b ) {\n        return materialIds[ a ] - materialIds[ b ];\n      } );\n\n      var numMaterials = materialIds[ polygonOrder[ numPolygons - 1 ] ] + 1;\n\n      groupMin = new Uint32Array( numMaterials );\n      for(var i = 0; i < numMaterials; i++) {\n        groupMin[i] = outputArray.length;\n      }\n      groupMax = new Uint32Array( numMaterials );\n    }\n\n    for (var i = 0; i < this.startFaceIndices.length; ++i) {\n\n      var polygonIndex = i;\n      if( polygonOrder ) {\n        polygonIndex = polygonOrder[ i ];\n      }\n\n      var startOffset = this.startFaceIndices[polygonIndex];\n      var startIndex = faceOffsets[polygonIndex];\n      var endIndex = faceOffsets[polygonIndex+1];\n      var polygonLength = endIndex - startIndex;\n\n      for (var j = 0; j < polygonLength - 2; ++j) {\n\n        if( materialIds ) {\n          var materialId = materialIds[ polygonIndex ];\n          groupMin[materialId] = Math.min( groupMin[ materialId ], writeIndex );\n          groupMax[materialId] = Math.max( groupMax[ materialId ], writeIndex + stride * 2 );\n        }\n\n        outputArray[writeIndex] = inputArray[startIndex + startOffset];\n        writeIndex += stride;\n\n        outputArray[writeIndex] = inputArray[startIndex + (startOffset + j + 1) % polygonLength];\n        writeIndex += stride;\n\n        outputArray[writeIndex] = inputArray[startIndex + (startOffset + j + 2) % polygonLength];\n        writeIndex += stride;\n\n      }\n    }\n\n    if( materialIds ) {\n      // convert max to length in place\n      for( var i = 0; i < groupMax.length; i ++ ) {\n        groupMax[i] = groupMax[i] - groupMin[i] + 1;\n      }\n      this.groups = {\n        groupStarts: groupMin,\n        groupCounts: groupMax\n      };\n    }\n\n  },\n\n  translateMaterialIds: function (outputView) {\n\n    var faceOffsets = this.mesh.faceRangeOffsets,\n      inputArray = this.mesh.materialIds,\n      faceBegin = faceOffsets[0];\n\n    for (var i = 1, j = 0, n = faceOffsets.length; i < n; ++i) {\n\n      var materialId = inputArray[i - 1],\n\n        faceUntil = faceOffsets[i],\n        nVertices = faceUntil - faceBegin,\n\n        nTriangles = nVertices >= 3 ? nVertices - 2 : 0;\n\n      for (var writeUntil = writeIndex + nTriangles * stride;\n          writeIndex !== writeUntil; writeIndex += stride)\n\n        outputArray[writeIndex] = materialId;\n\n      faceBegin = faceUntil;\n    }\n  },\n\n  translateToUnindexedValues: function (inputView, outputView, indices) {\n\n    var faceOffsets = this.mesh.faceRangeOffsets,\n      writeIndex = 0,\n      temp = inputView.newRangeArray(1);\n\n    var materialIds = null;\n    var polygonOrder = null;\n    var groupMin = null;\n    var groupMax = null;\n\n    // if multi-materials, sort polygons in material order and create material groups\n    if(this.mesh.materialIds) {\n\n      materialIds = this.mesh.materialIds;\n\n      var numPolygons = faceOffsets.length - 1;\n      var polygonOrder = new Uint32Array( numPolygons );\n      for( var i = 0; i < polygonOrder.length; i ++ ) {\n        polygonOrder[i] = i;\n      }\n\n      polygonOrder.sort( function( a, b ) {\n        return materialIds[ a ] - materialIds[ b ];\n      } );\n\n      var numMaterials = materialIds[ polygonOrder[ numPolygons - 1 ] ] + 1;\n\n      groupMin = new Uint32Array( numMaterials );\n      for(var i = 0; i < numMaterials; i++) {\n        groupMin[i] = outputView.length;\n      }\n      groupMax = new Uint32Array( numMaterials );\n    }\n\n\n    for (var i = 0; i < this.startFaceIndices.length; ++i) {\n\n      var polygonIndex = i;\n      if( polygonOrder ) {\n        polygonIndex = polygonOrder[ i ];\n      }\n\n      var startOffset = this.startFaceIndices[polygonIndex];\n      var startIndex = faceOffsets[polygonIndex];\n      var endIndex = faceOffsets[polygonIndex+1];\n      var polygonLength = endIndex - startIndex;\n\n\n      for (var j = 0; j < polygonLength - 2; ++j) {\n\n        if( materialIds ) {\n          var materialId = materialIds[ polygonIndex ];\n          groupMin[materialId] = Math.min( groupMin[ materialId ], writeIndex );\n          groupMax[materialId] = Math.max( groupMax[ materialId ], writeIndex + 2 );\n        }\n\n        outputView.arrayToRange(inputView.rangeToArray(\n            indices[startIndex + startOffset], 1, temp), writeIndex, 1);\n\n        outputView.arrayToRange(inputView.rangeToArray(\n            indices[startIndex + (startOffset + j + 1) % polygonLength], 1, temp), writeIndex + 1, 1);\n\n        outputView.arrayToRange(inputView.rangeToArray(\n            indices[startIndex + (startOffset + j + 2) % polygonLength], 1, temp), writeIndex + 2, 1);\n\n        writeIndex += 3;\n\n      }\n    }\n\n    if( materialIds ) {\n      // convert max to length in place\n      for( var i = 0; i < groupMax.length; i ++ ) {\n        groupMax[i] = groupMax[i] - groupMin[i] + 1;\n      }\n      this.groups = {\n        groupStarts: groupMin,\n        groupCounts: groupMax\n      };\n    }\n  },\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/algorithm/SimpleFanTriangulation.js","import subdivision from '../../polyMesh/geometric/operator/subdivision';\n\nconst MeshSmooth = {\n  schema: {\n    subdivisions: { label: 'Subdivisions', type: 'Number', defaultValue: 1, minValue: 0, maxValue: 4 },\n    smoothByMaterialIds: { label: 'Smooth by Material Ids', type: 'Boolean', defaultValue: true },\n    //hardEdges: { label: 'Hard Edges', type: 'Boolean', defaultValue: false },\n  },\n\n  update: function (operator, primitive) {\n    let mesh = primitive.mesh;\n    const subdivisions = (operator.subdivisions !== undefined) ? operator.subdivisions : 1;\n    //currently we are always assuming hard edges\n    //const hardEdges = operator.hardEdges || true;\n    if (!mesh) return primitive;\n\n    for (let i = 0; i < subdivisions; i++) {\n      mesh = subdivision(mesh, operator.smoothByMaterialIds);\n    }\n\n    primitive.mesh = mesh;\n    return primitive;\n  },\n};\n\nexport default MeshSmooth;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/MeshSmooth.js","import ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ObjectsByName from '../../generic/container/ObjectsByName';\nimport PolyMap from '../model/PolyMap';\nimport PolyMesh from '../model/PolyMesh';\nimport polyMeshValidation from './polyMeshValidation';\nimport removeDuplicateNormals from './removeDuplicateNormals';\n\nexport default function subdivision(mesh, smoothByMaterialIds) {\n\n  // based on theory given on pages 623-624 of \"Real-Time Rendering\"\n  const subdividePolyMap = function (polyMap, newFaceRangeOffsets, faceEdgeCreases, faceValueCorners) {\n\n    const edgeVertexAdjacency = polyMap.edgeVertexAdjacency;\n    const valueAdjacency = polyMap.valueAdjacency;\n    const faceEdgeAdjacency = polyMap.faceEdgeAdjacency;\n    /*\n    if(!faceEdgeAdjacency.checkValidity()){\n      throw 'This polymap contains an invalid surface and cannot be subdivided. Edge Adjacency will fail.';\n    }//*/\n\n    const values = polyMap.values;\n    const valueType = values.type;\n    const numValues = values.length;\n    const faceRangeOffsets = polyMap.faceRangeOffsets;\n    const numFaces = faceRangeOffsets.length - 1;\n    const faceValueIndices = polyMap.faceValueIndices;\n    const numEdges = edgeVertexAdjacency.getNumEdges();\n    const numNewFaces = faceValueIndices.length;\n\n    const vertexCorners = new Uint8Array(polyMap.values.length);\n    for (let i = 0; i < faceValueCorners.length; i++) {\n      vertexCorners[faceValueIndices[i]] = faceValueCorners[i];\n    }\n\n    if (!newFaceRangeOffsets) {\n      newFaceRangeOffsets = new Uint32Array(numNewFaces + 1);\n      for (let f = 0; f < newFaceRangeOffsets.length; f++) {\n        newFaceRangeOffsets[f] = f * 4;\n      }\n    }\n\n    const numNewFaceValueIndices = numNewFaces * 4;\n    const newFaceValueIndices = new Uint32Array(numNewFaceValueIndices);\n\n    // pre allocate all new vertices\n    //    updated vertices (V) + edge centroids (E) + face centroids (V)\n    const edgeOffset = numValues;\n    const faceOffset = edgeOffset + numEdges;\n    const numNewValues = numValues + numEdges + numFaces;\n    const newValues = new ObjectArrayView(valueType, numNewValues);\n\n    const valueEdgeValence = new Uint8Array(numValues);\n    const valueFaceValence = new Uint8Array(numValues);\n    const edgeFaceValence = new Uint8Array(numEdges);\n    const edgeUnique = new Uint8Array(numEdges);\n\n    const tempFaceCentroid = new valueType();\n    const tempValue = new valueType();\n    const tempNextValue = new valueType();\n    const tempEdgeCentroid = new valueType();\n    const tempConnectedValue = new valueType();\n    const tempConnectedFace = new valueType();\n\n    let nf = 0;\n\n    const edgeCreases = new Uint8Array(numEdges);\n    const valueCreases = new Uint8Array(numValues);\n\n    for (let f = 0; f < numFaces; f++) {\n\n      const faceBegin = faceRangeOffsets[f];\n      const faceUntil = faceRangeOffsets[f + 1];\n      const numFaceValues = faceUntil - faceBegin;\n\n      let vNext = faceValueIndices[faceBegin];\n      let vNextNext = faceValueIndices[faceBegin + 1 % numFaceValues];\n\n      let eNext = edgeVertexAdjacency.findEdgeId(vNext, vNextNext);\n\n      // calculate face centroid\n      tempFaceCentroid.multiplyScalar(0.0);\n\n      for (let fv = 0; fv < numFaceValues; fv++) {\n\n        const v = vNext;\n        vNext = vNextNext;\n        vNextNext = faceValueIndices[faceBegin + ((fv + 2) % numFaceValues)];\n\n        const e = eNext;\n        eNext = edgeVertexAdjacency.findEdgeId(vNext, vNextNext);\n\n        edgeFaceValence[e]++;\n        valueFaceValence[v]++;\n\n        // is this the first time processing this edge\n        if (edgeUnique[e] === 0) {\n          edgeUnique[e] = 1;\n\n          valueEdgeValence[v]++;\n          valueEdgeValence[vNext]++;\n\n          if (faceEdgeCreases[faceBegin + fv]) {\n            edgeCreases[e] = 1;\n            valueCreases[v]++;\n            valueCreases[vNext]++;\n          }\n        }\n\n        values.getAt(v, tempValue);\n        tempFaceCentroid.add(tempValue);\n\n        newFaceValueIndices[nf++] = edgeOffset + e;\n        newFaceValueIndices[nf++] = vNext;\n        newFaceValueIndices[nf++] = edgeOffset + eNext;\n        newFaceValueIndices[nf++] = faceOffset + f;\n      }\n\n      tempFaceCentroid.multiplyScalar(1.0 / numFaceValues);\n      newValues.setAt(faceOffset + f, tempFaceCentroid);\n    }\n    // create new edges\n    for (let e = 0; e < numEdges; e++) {\n\n      const v = edgeVertexAdjacency.edgeVertices[e * 2];\n      const vNext = edgeVertexAdjacency.edgeVertices[e * 2 + 1];\n\n      values.getAt(v, tempEdgeCentroid);\n      values.getAt(vNext, tempValue);\n      tempEdgeCentroid.add(tempValue);\n      let numNeighbors = 2;\n\n      const edgeFaceCount = faceEdgeAdjacency.edgeFaceCounts[e];\n\n      if (!edgeCreases[e] && edgeFaceCount === 2) {\n\n        //if the edge contains 2 corners do not average with face\n        if (!(vertexCorners[v] && vertexCorners[vNext])) {\n\n          for (let ef = 0; ef < edgeFaceCount; ef++) {\n            const f = faceEdgeAdjacency.edgeFaceIndices[e * 2 + ef];\n            newValues.getAt(faceOffset + f, tempValue);\n            tempEdgeCentroid.add(tempValue);\n            numNeighbors++;\n          }\n        }\n      }\n\n      tempEdgeCentroid.multiplyScalar(1.0 / numNeighbors);\n\n      newValues.setAt(edgeOffset + e, tempEdgeCentroid);\n    }\n\n    const useBoundaryValues = true;\n\n    // create new values\n    for (let v = 0; v < numValues; v++) {\n\n      values.getAt(v, tempNextValue);\n      const boundaryValue = valueEdgeValence[v] !== valueFaceValence[v];\n\n      if (valueEdgeValence[v] !== 0 && vertexCorners[v] < 1) {\n\n        // sum of connected vertices.\n        const valueBegin = valueAdjacency.valueEdgeOffsets[v];\n        const valueUntil = valueAdjacency.valueEdgeOffsets[v + 1];\n        const numValueEdges = valueUntil - valueBegin;\n\n        tempConnectedValue.multiplyScalar(0.0);\n        let numConnectedValues = 0;\n\n        if ((useBoundaryValues && boundaryValue) || valueCreases[v]) {\n\n          for (let ve = 0; ve < numValueEdges; ve++) {\n            const e = valueAdjacency.valueEdgeIndices[valueBegin + ve];\n            if (edgeCreases[e]) {\n              let vOther = edgeVertexAdjacency.edgeVertices[e * 2];\n              if (vOther === v) {\n                vOther = edgeVertexAdjacency.edgeVertices[e * 2 + 1];\n              }\n\n              values.getAt(vOther, tempValue);\n              tempConnectedValue.add(tempValue);\n              numConnectedValues++;\n            }\n\n          }\n\n          tempNextValue.multiplyScalar(0.75).add(tempConnectedValue.multiplyScalar(0.25 / numConnectedValues));\n        } else {\n\n          for (let ve = 0; ve < numValueEdges; ve++) {\n            const e = valueAdjacency.valueEdgeIndices[valueBegin + ve];\n            let vOther = edgeVertexAdjacency.edgeVertices[e * 2];\n            if (vOther === v) {\n              vOther = edgeVertexAdjacency.edgeVertices[e * 2 + 1];\n            }\n\n            values.getAt(vOther, tempValue);\n            tempConnectedValue.add(tempValue);\n            numConnectedValues++;\n          }\n\n          tempConnectedValue.multiplyScalar(1 / (numConnectedValues * numConnectedValues));\n\n          const valueBeginF = valueAdjacency.valueFaceOffsets[v];\n          const valueUntilF = valueAdjacency.valueFaceOffsets[v + 1];\n          const numValueFacesF = valueUntilF - valueBeginF;\n\n          tempConnectedFace.multiplyScalar(0.0);\n          let numConnectedFaces = 0;\n\n          for (let vf = 0; vf < numValueFacesF; vf++) {\n\n            const f = valueAdjacency.valueFaceIndices[valueBeginF + vf];\n            newValues.getAt(faceOffset + f, tempValue);\n            tempConnectedFace.add(tempValue);\n            numConnectedFaces++;\n          }\n\n          tempConnectedFace.multiplyScalar(1 / (numConnectedFaces * numConnectedFaces));\n\n          tempNextValue.multiplyScalar((numConnectedFaces - 2) / numConnectedFaces);\n          tempNextValue.add(tempConnectedValue);\n          tempNextValue.add(tempConnectedFace);\n\n        }\n      }\n\n      newValues.setAt(v, tempNextValue);\n    }\n\n    const pm = {\n      faceRangeOffsets: newFaceRangeOffsets,\n      faceValueIndices: newFaceValueIndices,\n      values: newValues,\n    };\n\n    return new PolyMap(pm);\n  };\n\n  polyMeshValidation(mesh);\n  const polyMesh = removeDuplicateNormals(mesh);\n\n  const faceEdgeCreases = new Uint8Array(polyMesh.positions.faceValueIndices.length);\n\n  if (polyMesh.edgeCreaseWeights) {\n    const faceEdgeAdjacency = polyMesh.positions.faceEdgeAdjacency;\n    for (let fe = 0; fe < faceEdgeAdjacency.faceEdgeIndices.length; fe++) {\n      const edgeIndex = faceEdgeAdjacency.faceEdgeIndices[fe];\n      faceEdgeCreases[fe] = (polyMesh.edgeCreaseWeights[edgeIndex] > 0) ? 1 : 0;\n    }\n  } else if (polyMesh.normalMap) {\n    getFaceEdgeCreases(polyMesh.normalMap, faceEdgeCreases);\n  }\n\n  if (smoothByMaterialIds && polyMesh.materialIds) {\n    const faceEdgeAdjacency = polyMesh.positions.faceEdgeAdjacency;\n\n    for (let fe = 0; fe < faceEdgeAdjacency.faceEdgeIndices.length; fe++) {\n      const edgeIndex = faceEdgeAdjacency.faceEdgeIndices[fe];\n      if (faceEdgeAdjacency.getNumFacesForEdgeId(edgeIndex) === 2 &&\n        polyMesh.materialIds[faceEdgeAdjacency.getFaceForEdgeId(edgeIndex, 0)] !== polyMesh.materialIds[faceEdgeAdjacency.getFaceForEdgeId(edgeIndex, 1)]) {\n\n        faceEdgeCreases[fe] += 1;\n      }\n    }\n\n  }\n\n  const faceValueCorners = getValueCorners(polyMesh.positions, faceEdgeCreases);\n\n  const results = new PolyMesh();\n  results.positions = subdividePolyMap(polyMesh.positions, null, faceEdgeCreases, faceValueCorners);\n  results.faceRangeOffsets = results.positions.faceRangeOffsets;\n\n  if (polyMesh.normalMap) {\n    results.normalMap = subdividePolyMap(polyMesh.normalMap, results.faceRangeOffsets, faceEdgeCreases, faceValueCorners);\n  }\n\n  //split UV's but treat all edges as hard\n  const allOnes = new Uint8Array(polyMesh.positions.faceValueIndices.length).fill(1);\n  if (polyMesh.uvMaps) {\n    const uvMaps = new ObjectsByName();\n    for (let i = 0; i < polyMesh.uvMaps.length; i++) {\n      const name = polyMesh.uvMaps.namesByIndex[i];\n      uvMaps.set(name, subdividePolyMap(polyMesh.uvMaps.byName[name], results.faceRangeOffsets, allOnes, allOnes));\n    }\n\n    results.uvMaps = uvMaps;\n  }\n\n  results.topologyChanged();\n  return results;\n};\n\nconst getFaceEdgeCreases = function (polyMap, faceEdgeCreases) {\n  const faceEdgeAdjacency = polyMap.faceEdgeAdjacency;\n\n  for (let fe = 0; fe < faceEdgeAdjacency.faceEdgeIndices.length; fe++) {\n    const edgeIndex = faceEdgeAdjacency.faceEdgeIndices[fe];\n    faceEdgeCreases[fe] = (faceEdgeAdjacency.edgeFaceCounts[edgeIndex] !== 2) ? 1 : 0;\n  }\n};\n\nconst getValueCorners = function (polyMap, faceEdgeCreases) {\n  const edgeVertexAdjacency = polyMap.edgeVertexAdjacency;\n\n  //converted to track indices that are corners instead of values\n  const faceValueCorners = new Uint8Array(polyMap.faceValueIndices.length);\n  const valueCreaseEdgeCount = new Uint8Array(polyMap.values.length);\n  const edgeProcessed = new Uint8Array(edgeVertexAdjacency.getNumEdges());\n\n  for (let f = 0; f < polyMap.faceRangeOffsets.length - 1; f++) {\n\n    const faceBegin = polyMap.faceRangeOffsets[f];\n    const faceUntil = polyMap.faceRangeOffsets[f + 1];\n    const numFaceValues = faceUntil - faceBegin;\n\n    let vNext = polyMap.faceValueIndices[faceBegin];\n\n    for (let fv = 0; fv < numFaceValues; fv++) {\n      const v = vNext;\n      vNext = polyMap.faceValueIndices[faceBegin + (fv + 1) % numFaceValues];\n\n      const e = edgeVertexAdjacency.findEdgeId(v, vNext);\n      if (edgeProcessed[e] === 0) {\n        edgeProcessed[e] = 1;\n\n        if (faceEdgeCreases[faceBegin + fv]) {\n          valueCreaseEdgeCount[v]++;\n          valueCreaseEdgeCount[vNext]++;\n        }\n      }\n    }\n  }\n\n  for (let i = 0; i < faceValueCorners.length; i++) {\n    const valueIndex = polyMap.faceValueIndices[i];\n    if (valueCreaseEdgeCount[valueIndex] > 2) {\n      faceValueCorners[i] = 1;\n    }\n  }\n\n  return faceValueCorners;\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/subdivision.js","import ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ObjectsByName from '../../generic/container/ObjectsByName';\nimport PolyMap from '../model/PolyMap';\nimport PolyMesh from '../model/PolyMesh';\n\nconst isVec3NaN = function (v) {\n  return isNaN(v.x) || isNaN(v.y) || isNaN(v.z);\n};\n\nconst isVec3Zero = function (v) {\n  return v.length() === 0;\n};\n\nconst isVec2NaN = function (v) {\n  return isNaN(v.x) || isNaN(v.y);\n};\n\nconst validateValues = function (polyMapName, values, validationFunc) {\n  //console.log( polyMapName, values.length );\n  const temp = new (values.type)();\n  const replacement = new (values.type)();\n  for (let i = 0; i < values.length; i++) {\n    values.getAt(i, temp);\n    if (!validationFunc(temp)) {\n      //console.log( \"  badValue at \" + i + \" is \", temp );\n      values.setAt(i, replacement);\n    }\n  }\n};\n\nexport default function polyMeshValidation(mesh) {\n\n  validateValues('positions', mesh.positions.values, function (v) { return !isVec3NaN(v); });\n\n  if (mesh.normalMap) {\n    validateValues('normalMap', mesh.normalMap.values, function (v) { return !isVec3NaN(v) && !isVec3Zero(v); });\n  }\n\n  if (mesh.uvMaps) {\n    const uvMaps = new ObjectsByName();\n    for (let i = 0; i < mesh.uvMaps.length; i++) {\n      let name = mesh.uvMaps.namesByIndex[i];\n      validateValues('uvMap[' + name + ']', mesh.uvMaps.byName[name].values, function (v) { return !isVec2NaN(v); });\n    }\n  }\n\n  return mesh;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/polyMeshValidation.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ObjectBuffer from '../../generic/container/ObjectBuffer';\nimport PolyMesh from '../model/PolyMesh';\nimport PolyMap from '../model/PolyMap';\n\nexport default function removeDuplicateNormals(polyMesh, removeUnusedValues, withLogging) {\n\n  if (!polyMesh.normalMap) return polyMesh;\n\n  const ru = removeUnusedValues || true;\n  const l = withLogging || false;\n\n  const faceValueIndices = polyMesh.positions.faceValueIndices;\n  const values = polyMesh.positions.values;\n\n  const normalFaceValueIndices = new Uint32Array(polyMesh.normalMap.faceValueIndices);\n  const normalValues = polyMesh.normalMap.values;\n\n  let duplicatesFound = 0;\n\n  let n1, n2;\n\n  //TODO bad nested array\n  const valuesToIndices = [];\n  for (let i = 0; i < values.length; i++) {\n    valuesToIndices[i] = [];\n  }\n\n  for (let i = 0; i < faceValueIndices.length; i++) {\n    valuesToIndices[faceValueIndices[i]].push(i);\n  }\n\n  //compares every normal on specific vertices to each other\n  //then remaps indices of normals that are the same\n  for (let i = 0; i < valuesToIndices.length; i++) {\n\n    for (let j = 0; j < valuesToIndices[i].length; j++) {\n\n      n1 = normalFaceValueIndices[valuesToIndices[i][j]];\n      for (let k = 0; k < valuesToIndices[i].length; k++) {\n\n        n2 = normalFaceValueIndices[valuesToIndices[i][j + k]];\n        if (n1 !== n2 && normalValues.getAt(n1).dot(normalValues.getAt(n2)) > 0.99) {\n          normalFaceValueIndices[valuesToIndices[i][j + k]] = n1;\n          duplicatesFound++;\n        }\n\n      }\n    }\n  }\n\n  if (l) console.log('Normal Duplicates Found: ' + duplicatesFound);\n\n  let normals = normalValues;\n  if (ru && duplicatesFound) {\n    let newNormalValuesBuffer = new ObjectBuffer(THREE.Vector3);\n    let isUsed = new Int32Array(normalValues.length);\n    isUsed.fill(-1);\n\n    let newNormalsCount = 0;\n    for (let i = 0; i < normalFaceValueIndices.length; i++) {\n      if (isUsed[normalFaceValueIndices[i]] === -1) {\n        newNormalValuesBuffer.push(normalValues.getAt(normalFaceValueIndices[i]));\n        isUsed[normalFaceValueIndices[i]] = newNormalsCount++;\n      }\n\n      normalFaceValueIndices[i] = isUsed[normalFaceValueIndices[i]];\n    }\n\n    let newNormalValues = new ObjectArrayView(THREE.Vector3, newNormalsCount);\n    newNormalValues.fromArray(newNormalValuesBuffer.toArray());\n\n    normals = newNormalValues;\n    if (l) console.log('' + normalValues.length + ' normal values reduced to ' + newNormalValues.length + ', duplicates removed: ' + (normalValues.length - newNormalValues.length));\n  }\n\n  const newNormals = new PolyMap({\n    faceRangeOffsets: polyMesh.faceRangeOffsets,\n    faceValueIndices: normalFaceValueIndices,\n    values: normals,\n  });\n\n  let resultMesh = new PolyMesh(polyMesh);\n  resultMesh.normalMap = newNormals;\n  return resultMesh;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/removeDuplicateNormals.js","const filmSizes = {\n  '-1': '[ Custom ]',\n  35: '35mm',\n  70: 'IMAX',\n  // TODO: add more of these!\n};\n\nconst viewType = {\n  values: [0, 1],\n  labels: ['Field of View', 'Focal Length'],\n};\n\nconst Camera = {\n  schema: {\n    targeted: { label: 'Enable Look Target', type: 'Boolean', defaultValue: false },\n    focalDepthEnabled: { label: 'Use Focal Depth', type: 'Boolean', defaultValue: false },\n    focalDepth: { label: 'Focal Depth', type: 'Number', defaultValue: 100, minValue: 0.001, animatable: true, hidden: true },\n\n    axisDirection: { type: 'Object', hidden: true },\n    zoomAxis: { type: 'Object', hidden: true },\n    //size: { type: 'Object', hidden: true},  // Call getSize() to access this field, and call viewport.getViewRect(() for view resolution\n\n    projection: { label: 'Projection', type: 'Options', defaultValue: 'Perspective', values: ['Perspective', 'Orthographic'] },\n\n    viewCtrl: { type: 'Options', defaultValue: 0, values: viewType.values, labels: viewType.labels, label: 'View Control' },\n    fieldOfView: { label: 'Field of View', type: 'Number', defaultValue: 45, minValue: 5, maxValue: 179, animatable: true },\n    focalLength: { label: 'Focal Length (mm)', type: 'Number', defaultValue: 40, minValue: 1, maxValue: 400, step: 1, animatable: true },\n    filmSizeBox: { type: 'Options', defaultValue: '35', values: Object.keys(filmSizes), labels: filmSizes, label: 'Film Size' },\n    customFilmSize: { label: 'Custom Film Size (mm)', type: 'Number', defaultValue: 35, step: 0.1, minValue: 1, maxValue: 1000 },\n    fStop: { label: 'F-Stop', type: 'Number', defaultValue: 2.8, minValue: 0.7, maxValue: 32, step: 0.1 },\n    filmOffset: { label: 'Film Offset (mm)', type: 'Vec2', defaultValue: { x: 0, y: 0 }, minValue: -1000.0, step: 1.0, maxValue: 1000.0 },\n\n    aspectRatio: { label: 'Aspect Ratio', type: 'Number', defaultValue: 16.0 / 9.0, step: 0.01, minValue: 0.01, maxValue: 10 },\n    nearClip: { label: 'Near Clip', type: 'Number', step: 0.01, defaultValue: 0.1, minValue: 0.01 },\n    farClip: { label: 'Far Clip', type: 'Number', defaultValue: 50000, step: 1, minValue: 0.00001, maxValue: 1000000 },\n    orthoZoom: { label: 'Ortho Zoom', type: 'Number', defaultValue: 1, minValue: 0.01, step: 0.1 },\n\n\n    // Orbit around\n    targetDistance: { label: 'Distance to Target', type: 'Number', defaultValue: 5.0, minValue: 0.01 }, // Distance to target, in world space\n    target: { label: 'Virtual Target', type: 'Vec3', defaultValue: { x: 0, y: 0, z: 0 }, hidden: true },  // Virtual target, in world space\n\n    // Display\n    showFrustum: { label: 'Show Frustum', type: 'Boolean', defaultValue: false },\n    frustumColor: { label: 'Frustum Color', type: 'Color', defaultValue: { r: 1, g: 0.78, b: 0 }, animatable: true },\n    showClipping: { label: 'Show Clipping', type: 'Boolean', defaultValue: false },\n    showTarget: { label: 'Show Virtual Target', type: 'Boolean', defaultValue: false },\n  },\n\n  update: function (operator, primitive, { previousResult }) {\n    //console.log('Camera update?', operator.aspectRatio, operator.fieldOfView, primitive, previousResult);\n    Object.assign(primitive, operator);\n\n    // Values initialized / editor from the translator that we carry through\n    var keepKeys = ['pivotMatrix', 'upPosition', 'radiusConstraint', 'newRadiusConstraint', 'offset'];\n    if (previousResult) {\n      for (let i = 0; i < keepKeys.length; i++) {\n        if (previousResult[keepKeys[i]]) primitive[keepKeys[i]] = previousResult[keepKeys[i]];\n      }\n    }\n\n    let box = operator.filmSizeBox;\n    primitive.filmSize = box === -1 ? operator.customFilmSize : parseFloat(box);\n  },\n};\n\nexport default { Camera };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Camera.js","\nconst backgroundStyle = {\n  values: [0, 1, 2, 3, 4],\n  labels: ['Default', 'Color', 'Image', 'CubeMap', 'EnvironmentMap'],\n};\n\nconst Environment = {\n  schema: {\n    ambientLight: { label: 'Color', type: 'Color', defaultValue: { r: 0, g: 0, b: 0 } },\n    environmentMap: { label: 'Environment Map', type: 'Plug', plug: 'Material' },\n\n    backgroundStyle: { label: 'Style', type: 'Options', defaultValue: 0, values: backgroundStyle.values, labels: backgroundStyle.labels },\n    backgroundColor: { label: 'Color', type: 'Color', defaultValue: { r: 0, g: 0, b: 0 } },\n    backgroundOpacity: { label: 'Opacity', type: 'Number', defaultValue: 1, minValue: 0, maxValue: 1, step: 0.1 },\n\n    background: { label: 'Image', type: 'Plug', plug: 'Image' },\n\n    cubeMapBlurring: { label: 'CubeMap Blur', type: 'Number', defaultValue: 0, minValue: 0, maxValue: 10, step: 0.5, animatable: true },\n    cubeMap: { label: 'CubeMap', type: 'Plug', plug: 'Material' },\n  },\n};\n\nexport default { Environment };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Environment.js","const RES_LIST = {\n  values: [0, 1, 2, 3, 4, 5, 6, 7],\n  labels: ['[ Custom ]', 'HD 720', 'HD 1080', '640x480', 'Full 1024', '1k Square', '2k Square', 'Retina'],\n};\n\nconst GeneralRenderer = {\n\n  schema: {\n    // general settings\n    res: { label: 'Resolution', type: 'Options', defaultValue: '1', values: RES_LIST.values, labels: RES_LIST.labels },\n    res_w: { label: 'Custom Width', type: 'Number', defaultValue: 1280, minValue: 100, isInteger: true },\n    res_h: { label: 'Custom Height', type: 'Number', defaultValue: 720, minValue: 100, isInteger: true },\n    output_dir: { label: 'Output directory', type: 'Text' },\n\n    // current pass\n    curPass: { label: 'Current Pass', type: 'Node' },\n\n    // batch rendering\n    frm_start: { label: 'Start Frame', type: 'Number', defaultValue: 1 },\n    frm_last: { label: 'Last Frame', type: 'Number', defaultValue: 24 },\n    frm_by: { label: 'By Frame', type: 'Number', defaultValue: 1 },\n\n    ren_start: { label: 'Start number', type: 'Number', defaultValue: 1, isInteger: true },\n    ren_by: { label: 'By Frame', type: 'Number', defaultValue: 1, isInteger: true },\n    frm_pad: { label: 'Frame padding', type: 'Number', defaultValue: 1, minValue: 0, maxValue: 10, isInteger: true },\n  },\n\n};\n\nexport default { GeneralRenderer };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/GeneralRenderer.js","import { forEach } from 'ramda';\nimport * as THREE from 'three';\nimport { getImageFromNode, fetchTextureImage } from '../translators/asset';\n\nconst NearestFilter = 1003;\nconst NearestMipMapNearestFilter = 1004;\nconst NearestMipMapLinearFilter = 1005;\nconst LinearFilter = 1006;\nconst LinearMipMapNearestFilter = 1007;\nconst LinearMipMapLinearFilter = 1008;\n\nconst Linear = 3000;\nconst sRGB = 3001;\nconst RGBE = 3002;\nconst LogLUV = 3003;\nconst RGBM7 = 3004;\nconst RGBM16 = 3005;\n\nconst renderType = {\n  Original: 0, WebGL: 1, Renderer: 3,\n};\n\nconst renderTypes = {\n  values: [0, 1, 2],\n  labels: ['Original', 'WebGL', 'Renderer'],\n};\n\nconst wrapType = {\n  values: [0, 1, 2],\n  labels: ['None', 'Wrap', 'Mirror'],\n};\n\nconst sampleFilter = {\n  values: [NearestFilter, NearestMipMapNearestFilter, NearestMipMapLinearFilter, LinearFilter, LinearMipMapNearestFilter, LinearMipMapLinearFilter],\n  labels: ['Nearest', 'Nearest MipMap Nearest', 'Nearest MipMap Linear', 'Linear', 'Linear MipMap Nearest', 'Linear MipMap Linear'],\n};\n\nconst encodingType = {\n  values: [Linear, sRGB, RGBE, LogLUV, RGBM7, RGBM16],\n  labels: ['Linear', 'sRGB', 'RGBE/Radiance', 'Log LUV', 'RGBM 7', 'RGBM 16'],\n};\n\nconst Image = {\n  schema: {\n    originalBitmapFile: { type: 'Image', hidden: true },\n    glBitmapFile:       { type: 'Image', hidden: true },\n    rendererBitmapFile: { type: 'Image', hidden: true },\n    hdrBitmapFile:      { type: 'Image', hidden: true },\n\n    renderOption: { label: 'Server Image', type: 'Options', defaultValue: 0, values: renderTypes.values, labels: renderTypes.labels },\n    glOption: { label: 'WebGL Image', type: 'Options', defaultValue: 1, values: renderTypes.values, labels: renderTypes.labels },\n\n    uOffset:  { type: 'Number', label: 'U Offset', defaultValue: 0, step: 0.1, animatable: true },\n    vOffset:  { type: 'Number', label: 'V Offset', defaultValue: 0, step: 0.1, animatable: true },\n    uTile:    { type: 'Number', label: 'U Tile',   defaultValue: 1, step: 0.1, animatable: true },\n    vTile:    { type: 'Number', label: 'V Tile',   defaultValue: 1, step: 0.1, animatable: true },\n    rotation: { type: 'Number', label: 'Rotation', defaultValue: 0, step: 0.1, animatable: true },\n    wrapU:    { type: 'Options', defaultValue: 1, values: wrapType.values, labels: wrapType.labels, label: 'U Wrap Style' },\n    wrapV:    { type: 'Options', defaultValue: 1, values: wrapType.values, labels: wrapType.labels, label: 'V Wrap Style' },\n\n    invert:  { type: 'Boolean', label: 'Invert', defaultValue: false, animatable: true },\n    gainPivot:  { type: 'Number', label: 'Gain Pivot', defaultValue: 0, step: 0.1, animatable: true },\n    gain:  { type: 'Number', label: 'Gain', defaultValue: 1.0, step: 0.1, animatable: true },\n    brightness:    { type: 'Number', label: 'Brightness',  defaultValue: 0, step: 0.1, animatable: true },\n\n    magFilter:    { type: 'Options', defaultValue: LinearFilter, values: sampleFilter.values, labels: sampleFilter.labels, label: 'Magnify Filter' },\n    minFilter:    { type: 'Options', defaultValue: LinearMipMapLinearFilter, values: sampleFilter.values, labels: sampleFilter.labels, label: 'Minify Filter' },\n    generateMipMaps:    { label: 'Use MipMaps', type: 'Boolean', defaultValue: true },\n\n    hdrEncoding: { type: 'Options', defaultValue: RGBM16, values: encodingType.values, labels: encodingType.labels, label: 'HDR Encoding' },\n  },\n\n  update: function (operator, primitive, { node }) {\n    let asset = null;\n\n    //const renderOption = __SERVER__ ? operator.renderOption : operator.glOption;\n    const renderOption = operator.glOption;\n\n    if (renderOption == renderType.Original) {\n      asset = operator.originalBitmapFile;\n    } else if (renderOption === renderType.WebGL) {\n      asset = operator.glBitmapFile || operator.originalBitmapFile;\n    } else {\n      asset = operator.rendererBitmapFile || operator.originalBitmapFile;\n    }\n\n    primitive.asset = asset;\n    primitive.hdr = operator.hdrBitmapFile;\n\n    forEach((key) => {\n      primitive[key] = operator[key];\n    }, ['uOffset', 'vOffset', 'uTile', 'vTile', 'rotation', 'wrapU', 'wrapV', 'gain', 'gainPivot', 'brightness', 'magFilter', 'minFilter', 'generateMipMaps', 'hdrEncoding', 'invert']);\n\n    primitive.preferHDR = (operator.hdrEncoding !== Linear) && !!operator.hdrBitmapFile;\n\n    return primitive;\n  },\n};\n\nconst Canvas = {\n  schema: {\n    width: { type: 'Number', defaultValue: 512, minValue: 16, maxValue: 4096, step: 1, label: 'Width' },\n    height: { type: 'Number', defaultValue: 512, minValue: 16, maxValue: 4096, step: 1, label: 'Height' },\n\n    color: { label: 'Color', type: 'Color', defaultValue: { r: 0, g: 0, b: 0, a: 0 }, animatable: true },\n    opacity: { label: 'Opacity', type: 'Number', defaultValue: 1, minValue: 0, maxValue: 1, step: 0.1, animatable: true },\n\n    uOffset:  { type: 'Number', label: 'U Offset', defaultValue: 0, step: 0.1, animatable: true },\n    vOffset:  { type: 'Number', label: 'V Offset', defaultValue: 0, step: 0.1, animatable: true },\n    uTile:    { type: 'Number', label: 'U Tile',   defaultValue: 1, step: 0.1, animatable: true },\n    vTile:    { type: 'Number', label: 'V Tile',   defaultValue: 1, step: 0.1, animatable: true },\n    rotation: { type: 'Number', label: 'Rotation', defaultValue: 0, step: 0.1, animatable: true },\n    wrapU:    { type: 'Options', defaultValue: 1, values: wrapType.values, labels: wrapType.labels, label: 'U Wrap Style' },\n    wrapV:    { type: 'Options', defaultValue: 1, values: wrapType.values, labels: wrapType.labels, label: 'V Wrap Style' },\n\n    invert:  { type: 'Boolean', label: 'Invert', defaultValue: false, animatable: true },\n    gainPivot:  { type: 'Number', label: 'Gain Pivot', defaultValue: 0, step: 0.1, animatable: true },\n    gain:  { type: 'Number', label: 'Gain', defaultValue: 1.0, step: 0.1, animatable: true },\n    brightness:    { type: 'Number', label: 'Brightness',  defaultValue: 0, step: 0.1, animatable: true },\n\n    magFilter:    { type: 'Options', defaultValue: THREE.LinearFilter, values: sampleFilter.values, labels: sampleFilter.labels, label: 'Magnify Filter' },\n    minFilter:    { type: 'Options', defaultValue: THREE.LinearMipMapLinearFilter, values: sampleFilter.values, labels: sampleFilter.labels, label: 'Minify Filter' },\n    generateMipMaps:    { label: 'Use MipMaps', type: 'Boolean', defaultValue: true },\n\n    hdrEncoding: { type: 'Options', defaultValue: THREE.RGBM16, values: encodingType.values, labels: encodingType.labels, label: 'HDR Encoding' },\n  },\n\n  update: function (operator, primitive, { node }) {\n\n    const ctxWidth = operator.width;\n    const ctxHeight = operator.height;\n\n    let color = operator.color;\n    if (color) color = 'rgba(' + parseInt(color.r * 255) + ',' + parseInt(color.g * 255) + ',' + parseInt(color.b * 255) + ',' + operator.opacity + ')';\n\n    forEach((key) => {\n      primitive[key] = operator[key];\n    }, ['uOffset', 'vOffset', 'uTile', 'vTile', 'rotation', 'wrapU', 'wrapV', 'gain', 'gainPivot', 'brightness', 'magFilter', 'minFilter', 'generateMipMaps', 'hdrEncoding', 'invert', 'width', 'height']);\n\n    const op = (context) => {\n      context.fillStyle = color;\n      context.fillRect(0, 0, ctxWidth, ctxHeight);\n      return true;\n    };\n\n    if (!primitive.canvasOperations) {\n      primitive.canvasOperations = [op];\n    } else {\n      primitive.canvasOperations.push(op);\n    }\n\n    return primitive;\n  },\n\n};\n\nconst CanvasLinearGradient = {\n  schema: {\n    startIs: { label: 'Start Is', type: 'Options', values: ['top', 'left', 'top-left', 'bottom-left'], initialValue: 'top' },\n    startColor: { label: 'Start Color', type: 'Color', defaultValue: { r: 0, g: 0, b: 0, a: 0 }, animatable: true },\n    startOpacity: { label: 'Start Opacity', type: 'Number', defaultValue: 1, minValue: 0, maxValue: 1, step: 0.1, animatable: true },\n    endColor: { label: 'End Color', type: 'Color', defaultValue: { r: 0, g: 0, b: 0, a: 0 }, animatable: true },\n    endOpacity: { label: 'End Opacity', type: 'Number', defaultValue: 1, minValue: 0, maxValue: 1, step: 0.1, animatable: true },\n\n    xOffset: { type: 'Number', defaultValue: 0, minValue: -10000, maxValue: +10000, step: 1, label: 'X', animatable: true },\n    yOffset: { type: 'Number', defaultValue: 0, minValue: -10000, maxValue: +10000, step: 1, label: 'Y', animatable: true },\n    width: { type: 'Number', defaultValue: 512, minValue: 16, maxValue: 4096, step: 1, label: 'Width' },\n    height: { type: 'Number', defaultValue: 512, minValue: 16, maxValue: 4096, step: 1, label: 'Height' },\n\n    composition: { label: 'Mode', type: 'Options', values: ['source-over', 'source-in', 'source-out', 'source-atop', 'destination-over', 'destination-in', 'destination-out', 'destination-atop', 'lighter', 'copy', 'xor', 'multiply', 'screen', 'overlay', 'darken', 'lighten', 'color-dodge', 'color-burn', 'hard-light', 'soft-light', 'difference', 'exclusion', 'hue', 'saturation', 'color', 'luminosity'], initialValue: 'source-over' },\n\n  },\n\n  update: function (operator, primitive) {\n    const xOffset = operator.xOffset;\n    const yOffset = operator.yOffset;\n    const width = operator.width;\n    const height = operator.height;\n\n    let startColor = operator.startColor;\n    let endColor = operator.endColor;\n    if (startColor) startColor = 'rgba(' + parseInt(startColor.r * 255) + ',' + parseInt(startColor.g * 255) + ',' + parseInt(startColor.b * 255) + ',' + operator.startOpacity + ')';\n    if (endColor) endColor = 'rgba(' + parseInt(endColor.r * 255) + ',' + parseInt(endColor.g * 255) + ',' + parseInt(endColor.b * 255) + ',' + operator.endOpacity + ')';\n\n    const op = (canvasContext) => {\n      let grd;\n      switch (operator.startIs) {\n      case 'top':     grd = canvasContext.createLinearGradient(xOffset, yOffset, xOffset, yOffset + height); break;\n      case 'left':    grd = canvasContext.createLinearGradient(xOffset, yOffset, xOffset + width, yOffset); break;\n      case 'top-left':grd = canvasContext.createLinearGradient(xOffset, yOffset, xOffset + width, yOffset + height); break;\n      default:        grd = canvasContext.createLinearGradient(xOffset, yOffset + height, xOffset + width, yOffset); break;\n    }\n      grd.addColorStop(0, startColor);\n      grd.addColorStop(1, endColor);\n      canvasContext.fillStyle = grd;\n\n      canvasContext.globalCompositeOperation = operator.composition;\n\n      canvasContext.fillRect(xOffset, yOffset, width, height);\n      return true;\n    };\n\n    if (!primitive.canvasOperations) {\n      primitive.canvasOperations = [op];\n    } else {\n      primitive.canvasOperations.push(op);\n    }\n\n    return primitive;\n  },\n\n};\n\nconst CanvasFill = {\n  schema: {\n    color: { label: 'Color', type: 'Color', defaultValue: { r: 0, g: 0, b: 0, a: 0 }, animatable: true },\n    opacity: { label: 'Opacity', type: 'Number', defaultValue: 1, minValue: 0, maxValue: 1, step: 0.1, animatable: true },\n\n    xOffset: { type: 'Number', defaultValue: 0, minValue: -10000, maxValue: +10000, step: 1, label: 'X', animatable: true },\n    yOffset: { type: 'Number', defaultValue: 0, minValue: -10000, maxValue: +10000, step: 1, label: 'Y', animatable: true },\n    width: { type: 'Number', defaultValue: 512, minValue: 16, maxValue: 4096, step: 1, label: 'Width' },\n    height: { type: 'Number', defaultValue: 512, minValue: 16, maxValue: 4096, step: 1, label: 'Height' },\n\n    composition: { label: 'Mode', type: 'Options', values: ['source-over', 'source-in', 'source-out', 'source-atop', 'destination-over', 'destination-in', 'destination-out', 'destination-atop', 'lighter', 'copy', 'xor', 'multiply', 'screen', 'overlay', 'darken', 'lighten', 'color-dodge', 'color-burn', 'hard-light', 'soft-light', 'difference', 'exclusion', 'hue', 'saturation', 'color', 'luminosity'], initialValue: 'source-over' },\n\n  },\n\n  update: function (operator, primitive) {\n    const xOffset = operator.xOffset;\n    const yOffset = operator.yOffset;\n    const width = operator.width;\n    const height = operator.height;\n\n    let color = operator.color;\n    if (color) color = 'rgba(' + parseInt(color.r * 255) + ',' + parseInt(color.g * 255) + ',' + parseInt(color.b * 255) + ',' + operator.opacity + ')';\n\n    const op = (canvasContext) => {\n      canvasContext.fillStyle = color;\n      canvasContext.globalCompositeOperation = operator.composition;\n      canvasContext.fillRect(xOffset, yOffset, width, height);\n      return true;\n    };\n\n    if (!primitive.canvasOperations) {\n      primitive.canvasOperations = [op];\n    } else {\n      primitive.canvasOperations.push(op);\n    }\n\n    return primitive;\n  },\n};\n\nconst CanvasComposite = {\n  schema: {\n    sourceImage: { type: 'Plug', plug: 'Image' },\n    xOffset: { type: 'Number', defaultValue: 0, minValue: -10000, maxValue: +10000, step: 1, label: 'X', animatable: true },\n    yOffset: { type: 'Number', defaultValue: 0, minValue: -10000, maxValue: +10000, step: 1, label: 'Y', animatable: true },\n\n    overrideSize: { type: 'Boolean', label: 'Override Default Size', defaultValue: false, animatable: true },\n    overrideWidth: { type: 'Number', defaultValue: 0, minValue: -10000, maxValue: +10000, step: 1, label: 'Override Width', animatable: true },\n    overrideHeight: { type: 'Number', defaultValue: 0, minValue: -10000, maxValue: +10000, step: 1, label: 'Override Height', animatable: true },\n\n    composition: { label: 'Composition', type: 'Options', values: ['source-over', 'source-in', 'source-out', 'source-atop', 'destination-over', 'destination-in', 'destination-out', 'destination-atop', 'lighter', 'copy', 'xor', 'multiply', 'screen', 'overlay', 'darken', 'lighten', 'color-dodge', 'color-burn', 'hard-light', 'soft-light', 'difference', 'exclusion', 'hue', 'saturation', 'color', 'luminosity'], initialValue: 'source-over' },\n\n  },\n\n  update: function (operator, primitive, { node }) {\n    const sourceImage = operator.sourceImage;\n\n    const xOffset = operator.xOffset;\n    const yOffset = operator.yOffset;\n    const overrideSize = operator.overrideSize;\n    let overrideWidth = operator.overrideWidth;\n    let overrideHeight = operator.overrideHeight;\n    const composition = operator.composition;\n\n    const op = (context, store) => {\n      if (!sourceImage) return false;\n\n      const textureImage = fetchTextureImage(store, sourceImage);\n      if (!textureImage) {\n        return false;\n      }\n\n      if (!overrideSize) {\n        overrideWidth = textureImage.width;\n        overrideHeight = textureImage.height;\n      }\n\n      if (overrideWidth == 0) {\n        overrideWidth = 1;\n      }\n\n      if (overrideHeight == 0) {\n        overrideHeight = 1;\n      }\n\n      const imgCanvas = document.createElement('canvas');\n      imgCanvas.width = overrideWidth;\n      imgCanvas.height = overrideHeight;\n      const imgCanvasContext = imgCanvas.getContext('2d');\n\n      imgCanvasContext.drawImage(textureImage, 0, 0, overrideWidth, overrideHeight);\n\n      context.globalCompositeOperation = composition;\n\n      context.drawImage(imgCanvas, xOffset, yOffset, overrideWidth, overrideHeight);\n\n      return true;\n    };\n\n    if (!primitive.canvasOperations) {\n      primitive.canvasOperations = [op];\n    } else {\n      primitive.canvasOperations.push(op);\n    }\n\n    return primitive;\n  },\n};\n\nexport default { Image, Canvas, CanvasLinearGradient, CanvasFill, CanvasComposite };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Image.js","import { getOrFetchImage, getOrFetchBinary } from '../modules/assets';\n\nexport function getAssetIdFromImage(store, image) {\n  const { asset, hdr } = image;\n  return image.preferHDR && hdr ? hdr : asset;\n};\n\nexport function getImageFromNode(store, image) {\n  const id = getAssetIdFromImage(store, image);\n  return id && getOrFetchImage(id)(store);\n}\n\nexport function fetchTextureImage(store, image) {\n  const ref = image.asset;\n  return ref && getOrFetchImage(ref)(store);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/asset.js","\nconst DirectionalLight = {\n  schema: {\n    lightType: { label: 'type', type: 'String', defaultValue: 'DirectionalLight' },\n    color: { label: 'Color', type: 'Color', defaultValue: { r: 0.94, g: 0.94, b: 0.94 } },\n    intensity: { label: 'Intensity', type: 'Number', defaultValue: 0.8 },\n  },\n};\n\nconst SpotLight = {\n  schema: {\n    lightType: { label: 'type', type: 'String', defaultValue: 'SpotLight' },\n    color: { label: 'Color', type: 'Color', defaultValue: { r: 0.94, g: 0.94, b: 0.94 } },\n    intensity: { label: 'Intensity', type: 'Number', defaultValue: 0.8 },\n  },\n};\n\nconst PointLight = {\n  schema: {\n    lightType: { label: 'type', type: 'String', defaultValue: 'PointLight' },\n    color: { label: 'Color', type: 'Color', defaultValue: { r: 0.94, g: 0.94, b: 0.94 } },\n    intensity: { label: 'Intensity', type: 'Number', defaultValue: 0.8 },\n  },\n};\n\nconst HemisphereLight = {\n  schema: {\n    lightType: { label: 'type', type: 'String', defaultValue: 'HemisphereLight' },\n    color: { label: 'Sky Color', type: 'Color', defaultValue: { r: 0.2, g: 0.52, b: 1 } },\n    gndColor: { label: 'Sky Color', type: 'Color', defaultValue: { r: 1, g: 0.78, b: 0.5 } },\n    intensity: { label: 'Intensity', type: 'Number', defaultValue: 0.6 },\n  },\n};\n\nconst AreaLight = {\n  schema: {\n    lightType: { label: 'type', type: 'String', defaultValue: 'AreaLight' },\n    color: { label: 'Color', type: 'Color', defaultValue: { r: 0.94, g: 0.94, b: 0.94 } },\n    intensity: { label: 'Intensity', type: 'Number', defaultValue: 10 },\n  },\n};\n\nexport default { DirectionalLight, SpotLight, PointLight, HemisphereLight, AreaLight };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Light.js","import { map } from 'ramda';\n\nconst Material = {\n  schema: {\n    color: { label: 'Color', type: 'Color', defaultValue: { r: 0.94, g: 0.94, b: 0.94 } },\n  },\n  update: (operator, primitive) => {\n    return primitive.color = operator.color;\n  },\n};\n\nconst Physical = {\n  environment: true,\n\n  schema: {\n    baseMap: { label: 'Image', type: 'Plug', plug: 'Image' },\n    baseMapTransparent: { label: 'Image Transparent', type: 'Boolean', defaultValue: false },\n    baseColor: { label: 'Color', type: 'Color', defaultValue: { r: 0.94, g: 0.94, b: 0.94 } },\n\n    baseFalloff: { label: 'Falloff', type: 'Boolean', defaultValue: false },\n    baseFalloffMap: { label: 'Image', type: 'Plug', plug: 'Image' },\n    baseFalloffColor: { label: 'Falloff Color', type: 'Color', defaultValue: { r: 0.94, g: 0.94, b: 0.94 }, animatable: true },\n\n    opacityMap: { label: 'Image', type: 'Plug', plug: 'Image' },\n    opacityFactor: { label: 'Factor', type: 'Number', defaultValue: 1.0, maxValue: 1.0, minValue: 0.0, step: 0.01, animatable: true },\n\n    opacityFalloffMap: { label: 'Image', type: 'Plug', plug: 'Image' },\n    opacityFalloffFactor: { label: 'Falloff Factor', type: 'Number', defaultValue: 1.0, maxValue: 1.0, minValue: 0.0, step: 0.01, animatable: true },\n\n    depthWrite: { label: 'Depth Write', type: 'Boolean', defaultValue: true },\n    depthTest: { label: 'Depth Test', type: 'Boolean', defaultValue: true },\n\n    specularMap: { label: 'Image', type: 'Plug', plug: 'Image' },\n    specularColor: { label: 'Color', type: 'Color', defaultValue: { r: 1, g: 1, b: 1 }, animatable: true },\n\n    roughness: { label: 'Roughness', type: 'Number', defaultValue: 0.25, minValue: 0.0, maxValue: 1.0, step: 0.01, animatable: true },\n    roughnessMap: { label: 'Image', type: 'Plug', plug: 'Image' },\n\n    metallic: { label: 'Metallic', type: 'Number', defaultValue: 0.0, minValue: 0.0, maxValue: 1.0, step: 0.01, animatable: true },\n    metallicMap: { label: 'Image', type: 'Plug', plug: 'Image' },\n\n    clearCoat: { label: 'Thickness', type: 'Number', defaultValue: 0.0, minValue: 0.0, maxValue: 1.0, step: 0.01, animatable: true },\n    clearCoatRoughness: { label: 'Roughness', type: 'Number', defaultValue: 0.25, minValue: 0.0, maxValue: 1.0, step: 0.01, animatable: true },\n\n    lightMap:  { label: 'Image', type: 'Plug', plug: 'Image' },\n    ambientColor2: { label: 'Color', type: 'Color', animatable: true, defaultValue: { r: 0, g: 0, b: 0 } },\n\n    emissiveMap:  { label: 'Image', type: 'Plug', plug: 'Image' },\n    emissiveColor: { label: 'Color', type: 'Color', animatable: true,  defaultValue: { r: 0, g: 0, b: 0 } },\n    emissiveScale: { label: 'Scale', type: 'Number', defaultValue: 1.0, minValue: 0.0, maxValue: 100.0, step: 0.1, animatable: true },\n    emissiveLabel: { type: 'Label', align: 'right', defaultValue: 'Emissive uses the second UV channel.' },\n\n    translucencyColor: { label: 'Color', type: 'Color', animatable: true, defaultValue: { r: 0, g: 0, b: 0 } },\n    translucencyMap:  { label: 'Image', type: 'Plug', plug: 'Image' },\n    translucencyNormalAlpha: { label: 'Normal Alpha', type: 'Number', defaultValue: 0.75, minValue: 0.0, maxValue: 1.0, step: 0.05, animatable: true },\n    translucencyNormalPower: { label: 'Normal Power', type: 'Number', defaultValue: 2.0, minValue: 0.01, maxValue: 100.0, step: 0.05, animatable: true },\n    translucencyViewAlpha: { label: 'View Alpha', type: 'Number', defaultValue: 0.75, minValue: 0.0, maxValue: 1.0, step: 0.05, animatable: true },\n    translucencyViewPower: { label: 'View Power', type: 'Number', defaultValue: 2.0, minValue: 0.01, maxValue: 100.0, step: 0.05, animatable: true },\n\n    bumpMap:  { label: 'Image', type: 'Plug', plug: 'Image' },\n    bumpFactor: { label: 'Scale Factor', type: 'Number', defaultValue: 0.03, minValue: -5.0, maxValue: 5.0, step: 0.001, animatable: true },\n\n    normalMap: { label: 'Image', type: 'Plug', plug: 'Image' },\n    normalFactor: { label: 'Scale Factor', type: 'Number', defaultValue: 1.0, minValue: -100.0, maxValue: 100.0, step: 0.001, animatable: true },\n    normalRedFlip: { label: \"Red Channel Flip\", type: \"Boolean\", defaultValue: false },\n    normalGreenFlip: { label: \"Green Channel Flip\", type: \"Boolean\", defaultValue: false },\n\n    anisotropyLabel: { type: 'Label', align: 'right', defaultValue: 'Anisotropy requires the Tangent operator.' },\n    anisotropyMap: { label: 'Image', type: 'Plug', plug: 'Image' },\n    anisotropy: { label: 'Offset', type: 'Number', defaultValue: 0.0, minValue: -1.0, maxValue: 1.0, step: 0.025, animatable: true },\n\n    anisotropyRotationMap:  { label: 'Image', type: 'Plug', plug: 'Image' },\n    anisotropyRotation: { label: 'Rotation Offset', type: 'Number', defaultValue: 0.0, minValue: -1.0, maxValue: 1.0, step: 0.025, animatable: true },\n\n    overrideEnvironment: { label: 'Override Environment', type: 'Boolean', defaultValue: false },\n    //environmentMap: { label: \"Environment Map\", type: 'Node', filter: environmentMapFilter },\n  },\n};\n\nconst MaterialReference = {\n  schema: {\n    defaultColor: { label: 'Default Color', type: 'Color', defaultValue: { r: 1, g: 1, b: 1 } },\n    reference: { type: 'Plug', plug: 'Material', label: 'Reference' },\n  },\n  update: (operator, primitive) => {\n    primitive.color = operator.defaultColor;\n    //return operator.reference || primitive.color = operator.defaultColor;\n  },\n};\n\nconst Reference = {\n  schema: {\n    defaultColor: { label: 'Default Color', type: 'Color', defaultValue: { r: 1, g: 1, b: 1 } },\n    reference: { type: 'Plug', plug: 'Material', label: 'Reference' },\n  },\n  update: (operator, primitive) => {\n    if (operator.reference) return operator.reference;\n    primitive.defaultColor = operator.defaultColor;\n  },\n};\n\nconst EnvironmentMap = {\n  schema: {\n    thumbnailImage: { label: 'Thumbnail', type: 'Plug', plug: 'Image' },\n\n    irradianceCubeMap: { label: 'Irradiance', type: 'Plug', plug: 'Material' }, //filter: cubeMapFilter },\n    specularCubeMap: { label: 'Specular', type: 'Plug', plug: 'Material' }, //filter: cubeMapFilter },\n    intensity: { label: \"Intensity\", type: 'Number', defaultValue: 1.0, minValue: 0.001, maxValue: 100.0, step: 0.1, animatable: true },\n\n    //giImage:   { label: 'Global Illumination', type: 'Node', initialValue: null, filter: exo.material.ImageUtils.nodeFilter },\n    //// these two maps should usually be the global illumination map.\n    //reflectionImage:   { label: 'Reflection', type: 'Node', initialValue: null, filter: exo.material.ImageUtils.nodeFilter },\n    //refractionImage:   { label: 'Refraction', type: 'Node', initialValue: null, filter: exo.material.ImageUtils.nodeFilter },\n  },\n};\n\nconst CubeMap = {\n  schema: {\n    map0: { label: 'Map ( x)', type: 'Plug', plug: 'Image' },\n    map1: { label: 'Map (-x)', type: 'Plug', plug: 'Image' },\n    map2: { label: 'Map ( y)', type: 'Plug', plug: 'Image' },\n    map3: { label: 'Map (-y)', type: 'Plug', plug: 'Image' },\n    map4: { label: 'Map ( z)', type: 'Plug', plug: 'Image' },\n    map5: { label: 'Map (-z)', type: 'Plug', plug: 'Image' },\n  },\n  update: (operator, primitive, { node }) => {\n    primitive.maps = [\n      operator.map0, operator.map1, operator.map2, operator.map3, operator.map4, operator.map5,\n    ];\n  },\n};\n\nconst ProxyReference = {\n  schema: {\n    webgl: { type: 'Plug', label: 'WebGL Material', plug: 'Material' },\n    vray: { type: 'Plug', label: 'VRay Material', plug: 'Material' },\n  },\n  update: (operator, primitive) => {\n    return operator.webgl || primitive;\n  },\n};\n\nconst Standard = {\n  schema: {\n    diffuseColor: { label: 'Color', type: 'Color', defaultValue: { r: 0.94, g: 0.94, b: 0.94 } },\n  },\n};\n\nconst MultiID = {\n  schema: {\n\n    defaultColor: { label: 'Default Color', type: 'Color', defaultValue: { r: 0.5, g: 0.5, b: 0.5 } },\n\n    material0: { type: 'Plug', plug: 'Material', label: 'Material ID 0' },\n    material1: { type: 'Plug', plug: 'Material', label: 'Material ID 1' },\n    material2: { type: 'Plug', plug: 'Material', label: 'Material ID 2' },\n    material3: { type: 'Plug', plug: 'Material', label: 'Material ID 3' },\n    material4: { type: 'Plug', plug: 'Material', label: 'Material ID 4' },\n    material5: { type: 'Plug', plug: 'Material', label: 'Material ID 5' },\n    material6: { type: 'Plug', plug: 'Material', label: 'Material ID 6' },\n    material7: { type: 'Plug', plug: 'Material', label: 'Material ID 7' },\n    material8: { type: 'Plug', plug: 'Material', label: 'Material ID 8' },\n    material9: { type: 'Plug', plug: 'Material', label: 'Material ID 9' },\n    material10: { type: 'Plug', plug: 'Material', label: 'Material ID 10' },\n    material11: { type: 'Plug', plug: 'Material', label: 'Material ID 11' },\n    material12: { type: 'Plug', plug: 'Material', label: 'Material ID 12' },\n    material13: { type: 'Plug', plug: 'Material', label: 'Material ID 13' },\n    material14: { type: 'Plug', plug: 'Material', label: 'Material ID 14' },\n    material15: { type: 'Plug', plug: 'Material', label: 'Material ID 15' },\n    material16: { type: 'Plug', plug: 'Material', label: 'Material ID 16' },\n    material17: { type: 'Plug', plug: 'Material', label: 'Material ID 17' },\n    material18: { type: 'Plug', plug: 'Material', label: 'Material ID 18' },\n    material19: { type: 'Plug', plug: 'Material', label: 'Material ID 19' },\n    material20: { type: 'Plug', plug: 'Material', label: 'Material ID 20' },\n    material21: { type: 'Plug', plug: 'Material', label: 'Material ID 21' },\n    material22: { type: 'Plug', plug: 'Material', label: 'Material ID 22' },\n    material23: { type: 'Plug', plug: 'Material', label: 'Material ID 23' },\n    material24: { type: 'Plug', plug: 'Material', label: 'Material ID 24' },\n    material25: { type: 'Plug', plug: 'Material', label: 'Material ID 25' },\n    material26: { type: 'Plug', plug: 'Material', label: 'Material ID 26' },\n    material27: { type: 'Plug', plug: 'Material', label: 'Material ID 27' },\n    material28: { type: 'Plug', plug: 'Material', label: 'Material ID 28' },\n    material29: { type: 'Plug', plug: 'Material', label: 'Material ID 29' },\n\n    multiID: { type: 'Boolean', label: 'Is MultiID', defaultValue: true },\n  },\n};\n\nconst VRmat = {\n  schema: {\n    visMatZipFile:  { type: 'File',  hidden: true },\n    viewColor:      { type: 'Color', defaultValue: { r: 0.94, g: 0.94, b: 0.94 }, label: 'Viewport Color' },\n  },\n};\n\nexport default { Material, Physical, MaterialReference, Reference, EnvironmentMap,\n  CubeMap, Standard, ProxyReference, MultiID, 'vray/VRmat': VRmat, };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Material.js","const targetCam = n => n.get('type') === 'Camera';\nconst targetRen = n => n.get('type') === 'Renderer';\n\nconst Pass = {\n\n  schema: {\n    activated: { label: 'Activated', type: 'Boolean', defaultValue: true },\n    filename: { label: 'Filename', type: 'Text', defaultValue: null },\n    fileFormat: { label: 'File Format', type: 'Text', defaultValue: null },\n\n    over_res: { label: 'On', type: 'Boolean', defaultValue: false },\n    over_res_x: { label: 'Image Width', type: 'Number', defaultValue: 1280, isInteger: true },\n    over_res_y: { label: 'Image Height', type: 'Number', defaultValue: 720, isInteger: true },\n\n    render_cam: { type: 'Node', label: 'Camera', filter: targetCam },\n    render_red: { type: 'Node', label: 'Renderer', filter: targetRen },\n  },\n};\n\nexport default { Pass };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Pass.js","\nconst Player = {\n  schema: {\n    autoRotate: { label: 'Auto-Rotate Camera', type: 'Boolean', defaultValue: false },\n    autoRotateNode: { label: 'Rotate Node', type: 'Node' },\n    autoRotateSpeed: { label: 'Rotate Speed (seconds)', type: 'Number', minValue: 1, maxValue: 60, defaultValue: 12 },\n    autoRotateDirection: { label: 'Rotate Direction', type: 'Options', values: ['-', '+'], labels: ['Clockwise', 'Counter-clockwise'], defaultValue: '-' },\n\n    camera: { label: 'Camera', type: 'Node' },\n    constraintCameraY: { label: 'Constrain Camera to Positive Y', type: 'Boolean', defaultValue: false },\n    orbitTarget: { label: 'Orbit Target', type: 'Node' },\n    orbitMode: { label: 'Orbit Mode', type:  'Options', values: ['gyroscope', 'trackball', 'firstPerson'], labels: ['Gyropscope', 'Trackball', 'First Person'], defaultValue: 'gyroscope' },\n\n    toneMapStyle: { label: 'Style', type: 'Options', values: ['Linear', 'Reinhard', 'Cineon', 'Filmic'], defaultValue: 'Linear' },\n    toneMapExposureGain: { label: 'Exposure Gain', type: 'Number', defaultValue: 1.0, minValue: 0.0, maxValue: 20.0, step: 0.1 },\n    toneMapWhitePoint: { label: 'White Point', type: 'Number', defaultValue: 4.0, minValue: 0.0, maxValue: 20.0, step: 0.1 },\n\n    dofPass: { label: 'Enabled', type: 'Boolean', defaultValue: false },\n    dofMaxBlur: { label: 'Max Blur', type: 'Number', defaultValue: 10.0, minValue: 0.0, maxValue: 100.0, step: 0.1 },\n\n    saoPass: { label: 'Enabled', type: 'Boolean', defaultValue: false },\n    saoIntensity: { label: 'Intensity', type: 'Number', defaultValue: 1.0, minValue: 0.0, maxValue: 1000.0, step: 0.1 },\n    saoScale: { label: 'Scale', type: 'Number', defaultValue: 24.0, minValue: 0.0, maxValue: 1000.0, step: 0.1 },\n\n    bloomPass: { label: 'Enabled', type: 'Boolean', defaultValue: false },\n    bloomThreshold: { label: 'Luminance Threshold', type: 'Number', defaultValue: 0.9, minValue: 0.0, maxValue: 1.0, step: 0.1 },\n    //bloomBlendRange: { label: 'Blend Range', type: 'Number', defaultValue: 0.1, minValue: 0.0, maxValue: 10.0, step: 0.1 }, //not configurable in threejs yet\n\n    reflectiveFloor: { label: 'Enabled', type: 'Boolean', defaultValue: false },\n    reflectiveFloorWidth: { label: 'Width', type: 'Number', defaultValue: 1.0, minValue: 0.0, maxValue: 1000.0, step: 1.0 },\n    reflectiveFloorRoughness: { label: 'Roughness', type: 'Number', defaultValue: 0.0, minValue: 0.0, maxValue: 10.0, step: 0.1 },\n    reflectiveFloorMetallic: { label: 'Metallic', type: 'Number', defaultValue: 0.0, minValue: 0.0, maxValue: 1.0, step: 0.1 },\n    reflectiveFloorFade: { label: 'Fade', type: 'Number', defaultValue: 0.0, minValue: 0.0, maxValue: 10000.0, step: 0.1 },\n    reflectiveFloorHeight: { label: 'Height', type: 'Number', defaultValue: 0.0, minValue: -100.0, maxValue: 100.0, step: 0.1 },\n    reflectiveFloorOpacity: { label: 'Opacity', type: 'Number', defaultValue: 1.0, minValue: 0.0, maxValue: 1.0, step: 0.1 },\n    reflectiveFloorFresnel: { label: 'Fresnel Strength', type: 'Number', defaultValue: 1.0, minValue: -1.0, maxValue: 1.0, step: 0.1 },\n    reflectiveFloorExcludeServer: { label: 'Exclude on Server', type: 'Boolean', defaultValue: false },\n\n    configurator: { label: 'Configurator', type: 'String', hidden: true, defaultValue: '' },\n\n    // Physics\n    gravity: { label: 'Gravity', type: 'Vec3', step: 1.0, defaultValue: [0.0, -9.8, 0.0] },\n  },\n};\n\nexport default { Player };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Player.js","import Mesh from './Mesh';\nimport TransformVertices from './TransformVertices';\nimport MeshSmooth from './MeshSmooth';\nimport UVMap from './UVMap';\nimport UVTransform from './UVTransform';\nimport Skin from './Skin';\nimport Box from './Box';\nimport Sphere from './Sphere';\nimport Cone from './Cone';\nimport Capsule from './Capsule';\nimport Cylinder from './Cylinder';\nimport Plane from './Plane';\nimport Torus from './Torus';\nimport Disk from './Disk';\nimport ProxyMesh from './ProxyMesh';\nimport Instance from './Instance';\nimport SortFacesByAxis from './SortFacesByAxis';\n\nexport default { Mesh, MeshSmooth, Skin, TransformVertices, UVMap, UVTransform, Box, Sphere,\n  Cone, Capsule, Cylinder, Plane, Torus, Disk, ProxyMesh, Instance, SortFacesByAxis, };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/index.js","import { convertToCNSPolyMesh } from '../../translators/bingeom';\nimport { getOrFetchBinary, getHash } from '../../modules/assets';\n\nconst Mesh = {\n  schema: {\n    geometry: { type: 'File', label: 'PolyMesh Geometry File' },\n  },\n\n  update: function (operator, primitive, { node, store, properties, previousResult, loaded }) {\n    const visible = properties.visible;\n    const geom = operator.geometry; // Request geometry so the asset gets referenced\n    const fetch = visible || (properties.prefetch && loaded);\n    const ref = fetch && geom;\n    const bingeom = ref && store.hasApi() && getOrFetchBinary(ref)(store);\n    const mesh = bingeom && convertToCNSPolyMesh(bingeom, ref);\n    //console.log('Mesh update', 'visible:', visible, 'prefetch:', properties.prefetch, 'fetch:', fetch, 'bingeom:', !!bingeom,  node.name, mesh);\n    primitive.mesh = mesh;\n    primitive.previousMesh = previousResult && previousResult.mesh;\n    return primitive;\n  },\n};\n\nexport default Mesh;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Mesh.js","import { List } from 'immutable';\nimport * as THREE from 'three';\nimport { PolyMesh, Selection, PolyMap, PolyMaps } from '../../polyMesh';\n\nfunction stringIndicesToArray(str='') {\n  const indices = str.split(',');\n  let outIndices = [];\n  let i, j, start, end, v;\n  for (i = 0; i < indices.length; i++) {\n    v = indices[i];\n    if (v.indexOf('-') !== -1) {\n      [start, end] = v.split('-');\n      start = Number(start);\n      end = Number(end);\n      for (j = start; j <= end; j++) {\n        outIndices.push(j);\n      }\n    } else {\n      outIndices.push(Number(v));\n    }\n  }\n\n  return outIndices;\n}\n\nconst TransformVertices = {\n  schema: {\n    translation: { label: 'Translation', type: 'Vec3', step: 0.1, defaultValue: { x: 0, y: 0, z: 0 }, animatable: true },\n    rotation: { label: 'Rotation', type: 'Vec3', step: 1, defaultValue: { x: 0, y: 0, z: 0 }, animatable: true, hidden: true },\n    scale: { label: 'Scale', type: 'Vec3', minValue: 0.0001, step: 0.1, defaultValue: { x: 1, y: 1, z: 1 }, animatable: true, hidden: true },\n    updateNormals: { label: 'Update Normals', type: 'Boolean', defaultValue: true, hidden: true },\n    //centerType: { label: 'Center', type: 'Options', display: 'Dropdown',\n    //      labels: ['Selection Center', 'World Center', 'Pivot'],\n    //      values: ['SelectionCenter', 'WorldCenter', 'Pivot'],\n    //      defaultValue: 'SelectionCenter' },\n    //// matrix is used in baking transform and overrides other parameters\n    //matrix: { label: 'Translation', type: 'Object', defaultValue: null, hidden: true },\n    vertexIndices: { label: 'Selection', type: 'String', defaultValue: '' },\n  },\n\n  update: function (operator, primitive) {\n    const mesh = primitive.mesh;\n    if (!mesh) return primitive;\n\n    const seed = Math.random();\n    const density = 0.5;\n    const meaning = Selection.Vertices;\n\n    const indices = stringIndicesToArray(operator.vertexIndices);\n    //console.log('create selection from: ', operator.vertexIndices, indices);\n\n    const selection = new Selection(indices, Selection.Vertices);\n\n    const newMesh = new PolyMesh(mesh);\n    const newPolyMap = new PolyMap(PolyMaps.resolveMap(mesh, 'positions'));\n    const newMapValues = newPolyMap.values.clone();\n    newPolyMap.values = newMapValues;\n    PolyMaps.assignMap(newMesh, 'positions', newPolyMap);\n\n    const vertexIndices = Selection.getIndices(mesh, Selection.Vertices, 'positions', selection);\n\n    const nonuniform = !!selection;\n\n    for (let j = 0, n = vertexIndices.length; j !== n; ++j) {\n      const i = vertexIndices[j];\n\n      newMapValues.setAt(i,\n          newMapValues.getAt(i, new THREE.Vector3()).add(operator.translation));\n    }\n\n    primitive.mesh = newMesh;\n  },\n};\n\nexport default TransformVertices;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/TransformVertices.js","import { List } from 'immutable';\nimport * as THREE from 'three';\nimport PolyMesh from '../../polyMesh/geometric/model/PolyMesh';\nimport PolyMap from '../../polyMesh/geometric/model/PolyMap';\nimport ObjectArrayView from '../../polyMesh/generic/container/ObjectArrayView';\nimport ObjectsByName from '../../polyMesh/generic/container/ObjectsByName';\n\nconst UVMap = {\n  schema: {\n    mWidth: { type: 'Number', label: 'Width', defaultValue: 1, step: 0.1, minValue: 0.0, animatable: true },\n    mHeight: { type: 'Number', label: 'Height', defaultValue: 1, step: 0.1,  minValue: 0.0, animatable: true },\n    mLength: { type: 'Number', label: 'Length', defaultValue: 1, step: 0.1,  minValue: 0.0, animatable: true },\n\n    center: { label: 'Center', type: 'Vec3', step: 0.1, defaultValue: new THREE.Vector3(0, 0, 0), animatable: true },\n    rotation: { label: 'Rotation', type: 'Vec3', step: 1,  minValue: -360, maxValue: 360, defaultValue: new THREE.Vector3(0, 0, 0), animatable: true },\n    uTile: { label: 'U Tile', type: 'Number', step: 0.1, defaultValue: 1.0, animatable: true },\n    vTile: { label: 'V Tile', type: 'Number', step: 0.1, defaultValue: 1.0, animatable: true },\n\n    uvProjectionMode: { label: 'Projection', type: 'Options', display: 'Radio',\n      values: [], // FIXME UVMAP type // 0, 1, 2, 3\n      labels: ['Planar', 'Box', 'Cylindrical', 'Spherical'], defaultValue: 0, /* FIXME PROPER value*/ },\n    xAxis: { label: 'Align Local Axis', type: 'Options', display: 'Radio',\n      values: [],//0, 1, 2, 3\n      labels: ['X', 'Y', 'Z', 'Average Normals'], defaultValue: 1, },\n    //uvMapChannel: { label: 'UV Channel', type: 'String', defaultValue: 'default' },\n\n    autoFit: { label: 'Auto Fit', type: 'Button' },\n    autoAlign: { label: 'Auto Align', type: 'Button' }, // Hidden until local manipulators fixed\n    autoFitAlign: { label: 'Best Fit', type: 'Button' }, // Hidden until local manipulators fixed\n    autoCenter: { label: 'Auto Center', type: 'Button' },\n    resetUVs: { label: 'Reset', type: 'Button' },\n\n    // SubObjects\n    //indices: { label: \"Selection\", type: 'TextArea', defaultValue: \"\", display: 'indexStyle' },\n    //componentType: { type: 'Object', hidden: true, defaultValue: 'Face' },\n\n    // For backward compatibility\n    //scale: { label: 'scale', type: 'Vec3', step: 0.1, defaultValue: {x: 0, y: 0, z: 0}, hidden: true },\n\n    //subdivisions: { label: 'Subdivisions', type: 'Number', defaultValue: 1, minValue: 0, maxValue: 4 },\n    //hardEdges: { label: 'Hard Edges', type: 'Boolean', defaultValue: false }\n  },\n\n  update: function (operator, primitive) {\n    const mesh = primitive.mesh;\n    if (!mesh) return primitive;\n\n    const options = {};\n\n    options.uTile = operator.uTile;\n    options.vTile = operator.vTile;\n    options.uvProjectionMode = operator.uvProjectionMode;\n    options.alignmentAxis = operator.xAxis;\n    options.center = operator.center;\n    options.rotation = operator.rotation;\n    options.mapChannel = operator.uvMapChannel;\n    options.scale = new THREE.Vector3(operator.mWidth, operator.mHeight, operator.mLength);\n\n    primitive.mesh = applyUVMap(mesh, options);\n  },\n};\n\nfunction applyUVMap(polyMesh, uvMapOptions) {\n\n  uvMapOptions = uvMapOptions || {};    // because all values can be defaulted, uvMapOptions should be allowed to be null/undefined too!\n\n  const rotation = uvMapOptions.rotation.multiplyScalar(180 / Math.PI) || new THREE.Vector3();\n  const scale = uvMapOptions.scale || new THREE.Vector3(1, 1, 1);\n  const center = uvMapOptions.center || new THREE.Vector3();\n  const uvProjectionMode = (uvMapOptions.uvProjectionMode !== undefined) ? uvMapOptions.uvProjectionMode : 0;\n  const alignmentAxis = (uvMapOptions.alignmentAxis !== undefined) ? uvMapOptions.alignmentAxis : 1;\n  const mapChannel = (uvMapOptions.mapChannel !== undefined) ? uvMapOptions.mapChannel : 'default';\n  const uTile = (uvMapOptions.uTile !== undefined) ? uvMapOptions.uTile : 1.0;\n  const vTile = (uvMapOptions.vTile !== undefined) ? uvMapOptions.vTile : 1.0;\n\n  // Inverse matrix should be used, so uv map follows the gimzo\n  const matrixRotation = new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler().setFromVector3(rotation, 'ZYX'));\n  const matrixRotationInv = new THREE.Matrix4().getInverse(matrixRotation);\n\n  const faceRangeOffsets = polyMesh.faceRangeOffsets;\n  const faceValueIndices = polyMesh.positions.faceValueIndices;\n  const values = polyMesh.positions.values;\n\n  const uvFaceValueIndices = new Uint32Array(faceValueIndices.length);\n  const uvValues = new ObjectArrayView(THREE.Vector2, faceValueIndices.length);\n\n  const vertex1 = new THREE.Vector3();\n  const vertex2 = new THREE.Vector3();\n  const faceNormal = new THREE.Vector3();\n  const newUV = new THREE.Vector2();\n\n  //for every face\n  let faceBegin = 0;\n  let faceEnd = 0;\n  let uvValueCounter = 0;\n  for (let i = 1; i < faceRangeOffsets.length; i++) {\n    faceEnd = faceRangeOffsets[i];\n\n    //compute the face normal\n    faceNormal.multiplyScalar(0);\n    for (let j = faceBegin; j < faceEnd; j++) {\n\n      let k = j + 1;\n      if (k >= faceEnd) {\n        k = faceBegin;\n      }\n\n      values.getAt(faceValueIndices[j], vertex1);\n      values.getAt(faceValueIndices[k], vertex2);\n\n      faceNormal.x += (vertex1.y - vertex2.y) * (vertex1.z + vertex2.z);\n      faceNormal.y += (vertex1.z - vertex2.z) * (vertex1.x + vertex2.x);\n      faceNormal.z += (vertex1.x - vertex2.x) * (vertex1.y + vertex2.y);\n    }\n\n    faceNormal.normalize();\n\n    //for every index on that face\n    for (let j = faceBegin; j < faceEnd; j++) {\n\n      values.getAt(faceValueIndices[j], vertex1);\n\n      vertex1.sub(center);    // Translate to center\n      vertex1.applyMatrix4(matrixRotationInv);   // Apply Inverse rotation to the vertex (to follow gizmo)\n\n      switch (uvProjectionMode) {\n\n      case 0: //Planar\n        planarUVMap(vertex1, alignmentAxis, scale, newUV);\n      break;\n\n      case 1: //Box\n        boxUVMap(vertex1, faceNormal, scale, newUV);\n      break;\n\n      case 2: //Cylindrical\n        cylindricalUVMap(vertex1, alignmentAxis, scale, newUV);\n      break;\n\n      case 3: //Spherical\n        sphericalUVMap(vertex1, alignmentAxis, scale, newUV);\n      break;\n\n      default:\n        newUV.set(0, 0);\n      break;\n    }\n\n      // Apply tiling\n      if (uTile !== 1.0) {\n        newUV.x *= uTile;\n      }\n\n      if (vTile !== 1.0) {\n        newUV.y *= vTile;\n      }\n\n      // Avoid disconnected uv faces\n      //TODO check for duplicate uv's on that vertex and don't store it twice;\n\n      uvFaceValueIndices[j] = uvValueCounter;\n      uvValues.setAt(uvValueCounter++, newUV);\n    }\n\n    faceBegin = faceEnd;\n  }\n\n  const resultMesh = new PolyMesh(polyMesh);\n\n  const newUVMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: uvFaceValueIndices,\n    values: uvValues,\n  });\n\n  if (!resultMesh.uvMaps) resultMesh.uvMaps = new ObjectsByName();\n  resultMesh.uvMaps.set(mapChannel, newUVMap);\n\n  return resultMesh;\n};\n\nfunction boxUVMap(vertex, normal, scale, uv) {\n\n  let s = 0;\n  let t = 0;\n\n  const x = vertex.x;\n  const y = vertex.y;\n  const z = vertex.z;\n  // Face normal\n  const nx = Math.abs(normal.x);\n  const ny = Math.abs(normal.y);\n  const nz = Math.abs(normal.z);\n\n  if (nx >= ny && nx >= nz) {\n    s = -z / scale.z + 0.5;\n    t = y / scale.y + 0.5;\n  }\n\n  if (ny >= nx && ny >= nz) {\n    s = x / scale.x + 0.5;\n    t = -z / scale.z + 0.5;\n  }\n\n  if (nz >= nx && nz >= ny) {\n    s = x / scale.x + 0.5;\n    t = y / scale.y + 0.5;\n  }\n\n  // Otherside of box is mirror of the other side\n  // However, only making them negative is not a good solution for tiling, so we add them to 1 to be flipped in positive side\n  if (normal.x < 0) {\n    s = -s + 1;\n  }\n\n  if (normal.y < 0) {\n    s = -s + 1;\n  }\n\n  if (normal.z < 0) {\n    s = -s + 1;\n  }\n\n  uv.set(s, t);\n  return uv;\n};\n\nfunction planarUVMap(vertex, planeAxis, scale, uv) {\n\n  // Note: In case of plane we will not use scale.z\n  let u = ((planeAxis === 0) ? -vertex.z : vertex.x);\n  let v = ((planeAxis === 1) ? -vertex.z : vertex.y);\n\n  u = u / scale.x + 0.5;\n  v = v / scale.y + 0.5;\n\n  uv.set(u, v);\n\n  return uv;\n};\n\nfunction cylindricalUVMap(vertex, cylinderAxis, scale, uv) {\n\n  let lon;\n  let t;\n\n  switch (cylinderAxis) {\n    case 0:\n      lon = xyz_to_longitude(vertex.z / scale.z, vertex.x / scale.x, -vertex.y / scale.y);\n      t = -vertex.x / scale.x + 0.5;\n    break;\n\n    case 1:\n      lon = xyz_to_longitude(vertex.x / scale.x, vertex.y / scale.y, vertex.z / scale.z);\n      t = vertex.y / scale.y + 0.5;\n    break;\n\n    case 2:\n      lon = xyz_to_longitude(-vertex.x / scale.x, vertex.z / scale.z, -vertex.y / scale.y);\n      t = -vertex.z / scale.z + 0.5;\n    break;\n  }\n\n  // convert it from [0-2PI] to [0-1]\n  lon = lon / (Math.PI * 2);\n  uv.set(lon, t);\n\n  return uv;\n};\n\nfunction sphericalUVMap(vertex, sphereAxis, scale, uv) {\n\n  let lonlat;\n  let lat, lon;\n\n  switch (sphereAxis) {\n    case 0:\n      lonlat = xyz_to_longitudelatitude(vertex.z / scale.z, vertex.x / scale.x, -vertex.y / scale.y);\n    break;\n\n    case 1:\n      lonlat = xyz_to_longitudelatitude(vertex.x / scale.x, -vertex.y / scale.y, vertex.z / scale.z);\n    break;\n\n    case 2:\n      lonlat = xyz_to_longitudelatitude(-vertex.x / scale.x, vertex.z / scale.z, -vertex.y / scale.y);\n    break;\n  }\n\n  // convert longitude from [0, 2PI] to [0,1], and latitude from [-PI, +PI] to [0,1]\n  lon = lonlat.lon / (Math.PI * 2);\n  lat = 0.5 - lonlat.lat / Math.PI;\n  uv.set(lon, lat);\n\n  return uv;\n};\n\n\n// convert XYZ space to longitude\n// Returns longitude is in interval [-PI,+PI]\nfunction xyz_to_longitude(x, y, z) {\n\n  let lon;\n\n  if (x === 0 && z === 0) {\n\n    lon = 0;\n\n  } else {\n    lon = Math.atan2(x, z);\n\n    // longitude is in interval [-PI,+PI], so we add two PI to negative longitudes to be between [0,2PI]\n    if (lon < 0) {\n      lon += (Math.PI * 2);\n    }\n  }\n\n  return lon;\n};\n\n// convert XYZ space to longitude and latitude\n// Returns longitude [0, 2PI] and latitude [-PI, +PI]\nfunction xyz_to_longitudelatitude(x, y, z) {\n\n  let lo, la;\n\n  if (x === 0 && z === 0) {\n    lo = 0;\n\n    if (y !== 0) {\n      la = (y < 0) ? -(Math.PI / 2) : (Math.PI / 2);\n\n    } else {\n      la = 0;\n    }\n\n  } else {\n\n    lo = Math.atan2(x, z);\n\n    // longitude is in interval [-PI,+PI], so we add two PI to negative longitudes to be between [0,2PI]\n    if (lo < 0) {\n      lo += Math.PI * 2;\n    }\n\n    const h = Math.sqrt(x * x + z * z);\n    // latitude is in [-PI,+PI]\n    la = Math.atan2(y, h);\n\n  }\n\n  return {\n    lon: lo,\n    lat: la,\n  };\n};\n\nexport default UVMap;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/UVMap.js","import * as THREE from 'three';\nimport PolyMesh from '../../polyMesh/geometric/model/PolyMesh';\nimport PolyMap from '../../polyMesh/geometric/model/PolyMap';\nimport ObjectArrayView from '../../polyMesh/generic/container/ObjectArrayView';\n\nconst ScaleMode = {\n  Scale: 0,\n  Tiling: 1,\n};\n\nconst UVTransform = {\n  name: 'UVTransform',\n  label: 'UV Transform',\n\n  schema: {\n    rotation: { label: 'Rotation', type: 'Number', step: 0.1,  minValue: -360, maxValue: 360, defaultValue: 0, animatable: true },\n    scaleMode: { label: 'Scale Mode', type: 'Options', display: 'Dropdown',\n                labels: ['Scale', 'Tiling'],\n                values: [ScaleMode.Scale, ScaleMode.Tiling],\n                defaultValue: ScaleMode.Scale, },\n    tiling: { label: 'Tiling', type: 'Vec2', step: 0.1, defaultValue: new THREE.Vector2(1, 1), animatable: true },\n    scale: { label: 'Scale', type: 'Vec2', step: 0.1, defaultValue: new THREE.Vector2(1, 1), animatable: true },\n    translation: { label: 'Translation', type: 'Vec2', step: 0.1, defaultValue: new THREE.Vector2(0, 0), animatable: true },\n    pivotCenter: { label: 'Pivot Center', type: 'Vec2', step: 0.1, defaultValue: new THREE.Vector2(0, 0), animatable: true },\n\n    uvMapChannel: { label: 'UV Channel', type: 'String', defaultValue: 'default' },\n\n  },\n\n  update: function (operator, primitive) {\n\n    const mesh = primitive.mesh;\n    if (!mesh) return primitive;\n\n    const mapChannel = operator.uvMapChannel || 'default'; //consider empty channel as default\n\n    const uvMap = mesh.uvMaps ? mesh.uvMaps.byName[mapChannel] : null;\n    if (!uvMap) return primitive;\n\n    const uvVec3 = new THREE.Vector3();\n    const uv = new THREE.Vector2();\n    const uvValues = new ObjectArrayView(THREE.Vector2, uvMap.values.length);\n\n    const rotation = operator.rotation;\n    const scaleMode = operator.scaleMode;\n    const scale = operator.scale;\n    const tiling = operator.tiling;\n    const translation = operator.translation;\n    const pivotCenter = operator.pivotCenter;\n\n    const uvTransform = getUVTransform(rotation, tiling, (scaleMode  === ScaleMode.Scale), scale, translation, pivotCenter);\n\n    for (let i = 0; i < uvMap.values.length; i++) {\n      uvMap.values.getAt(i, uv);\n      uvVec3.set(uv.x, uv.y, 0);\n      uvVec3.applyMatrix4(uvTransform);\n      uv.set(uvVec3.x, uvVec3.y);\n      uvValues.setAt(i, uv);\n    }\n\n    const resultMesh = new PolyMesh(mesh);\n\n    const newUVMap = new PolyMap({\n      faceRangeOffsets: mesh.faceRangeOffsets,\n      faceValueIndices: uvMap.faceValueIndices,\n      values: uvValues,\n    });\n\n    resultMesh.uvMaps.set(mapChannel, newUVMap);\n\n    primitive.mesh = resultMesh;\n  },\n};\n\nfunction getUVTransform(rotation, tiling, useScale, scale, translation, pivotCenter) {\n\n  const result = new THREE.Matrix4();\n\n  result.multiply(new THREE.Matrix4().makeTranslation(pivotCenter.x, pivotCenter.y, 0));\n  result.multiply(new THREE.Matrix4().makeRotationZ(THREE.Math.degToRad(rotation)));\n  if (useScale) {\n    result.multiply(new THREE.Matrix4().makeScale(scale.x, scale.y, 0));\n  } else {\n    const safeInverse = function (v) {\n      return (v == 0) ? 1 : 1 / v;\n    };\n\n    result.multiply(new THREE.Matrix4().makeScale(safeInverse(tiling.x), safeInverse(tiling.y), 0));\n  }\n\n  result.multiply(new THREE.Matrix4().makeTranslation(-pivotCenter.x, -pivotCenter.y, 0));\n  result.multiply(new THREE.Matrix4().makeTranslation(translation.x, translation.y, 0));\n\n  return result;\n\n};\n\nexport default UVTransform;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/UVTransform.js","import PolyMap from '../../polyMesh/geometric/model/PolyMap';\nimport PolyMesh from '../../polyMesh/geometric/model/PolyMesh';\n\nconst Skin = {\n  schema: {\n    boneNodeList: { type: 'NodeList', label: 'Select Bones', plug: 'Bone' },\n    optionalRootBone: { type: 'Node', label: 'Optional Root Bone', defaultValue: null, filter: function (n) { return n.isBone(); } },\n  },\n\n  update: function (operator, primitive, { node, getWorldTransform }) {\n    const skinWorldTransform = getWorldTransform(node.id);\n\n    // Ensure we reference the bone node list, so that the dependency\n    // graph gets updated properly.\n    const nodeList = operator.boneNodeList;\n    const rootBone = operator.optionalRootBone;\n    let rootBoneIndex = -1;\n\n    if (nodeList.length === 0) return primitive;\n\n    //get world transforms for each bone\n    const boneWorldTransforms = nodeList.map((boneNode) => {\n      return getWorldTransform(boneNode);\n    });\n\n    //get the index of the root bone\n    if (rootBone) {\n      for (let i = 0, il = nodeList.length; i < il; i++) {\n        let boneNode = nodeList[i];\n        if (boneNode == rootBone) {\n          rootBoneIndex = i;\n          break;\n        }\n      }\n    }\n\n    const polyMesh = primitive.mesh;\n    const skinToWorldTransform = skinWorldTransform;\n\n    primitive.mesh = skin(polyMesh, skinToWorldTransform, boneWorldTransforms, rootBoneIndex);\n  },\n};\n\nfunction skin(polyMesh, skinToWorldTransform, boneWorldTransforms, rootBoneIndex) {\n  if (!polyMesh || !polyMesh.skinning) {\n    return polyMesh;\n  }\n\n  const skinning = polyMesh.skinning;\n  const newValues = skinning.applyTransforms(polyMesh.positions.values, skinToWorldTransform, boneWorldTransforms, rootBoneIndex);\n\n  const newPositions = new PolyMap({\n    faceRangeOffsets: polyMesh.faceRangeOffsets,\n    faceValueIndices: polyMesh.positions.faceValueIndices,\n    values: newValues,\n  });\n\n  const resultMesh = new PolyMesh(polyMesh);\n  resultMesh.positions = newPositions;\n\n  return resultMesh;\n};\n\nexport default Skin;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Skin.js","\nimport box from '../../polyMesh/geometric/primitives/Box';\n\nconst Box = {\n  schema: {\n      depth: { type: 'Number', label: 'Depth', defaultValue: 1, step: 0.1, minValue: 0.0, animatable: true },\n      width: { type: 'Number', label: 'Width', defaultValue: 1, step: 0.1, minValue: 0.0, animatable: true },\n      height: { type: 'Number', label: 'Height', defaultValue: 1, step: 0.1,  minValue: 0.0, animatable: true },\n      depthSegments: { type: 'Number', label: 'Depth Segments', defaultValue: 1, minValue: 1, isInteger: true, animatable: true, i18n: { en: {}, xn: { label: 'XXX' }, hn: { label: 'DX' } } },\n      widthSegments: { type: 'Number', label: 'Width Segments', defaultValue: 1, minValue: 1, isInteger: true, animatable: true },\n      heightSegments: { type: 'Number', label: 'Height Segments', defaultValue: 1, minValue: 1, isInteger: true, animatable: true },\n    },\n\n  update: function (operator, primitive) {\n    const { width, height, depth, widthSegments, heightSegments, depthSegments } = operator;\n    primitive.mesh = box(width, height, depth, widthSegments, heightSegments, depthSegments);\n  },\n};\n\nexport default Box;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Box.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ObjectsByName from '../../generic/container/ObjectsByName';\nimport PolyMesh from '../model/PolyMesh';\nimport PolyMap from '../model/PolyMap';\nimport removeDuplicateValues from '../operator/removeDuplicateValues';\n\nexport default function Box(width, height, depth, widthSegments, heightSegments, depthSegments) {\n\n  widthSegments = Math.floor(widthSegments) || 1;\n  heightSegments = Math.floor(heightSegments) || 1;\n  depthSegments = Math.floor(depthSegments) || 1;\n\n  const faceRangeOffsets = new Uint32Array((widthSegments * heightSegments) * 2 + (widthSegments * depthSegments) * 2 + (heightSegments * depthSegments) * 2 + 1);//number of faces\n  const faceValueIndices = new Uint32Array(((widthSegments * heightSegments) * 2 + (widthSegments * depthSegments) * 2 + (heightSegments * depthSegments) * 2) * 4);//number of faces*4\n  const values = new ObjectArrayView(THREE.Vector3, (widthSegments + 1) * (heightSegments + 1) * 2 + (widthSegments + 1) * (depthSegments + 1) * 2 + (heightSegments + 1) * (depthSegments + 1) * 2);\n  const normals = new ObjectArrayView(THREE.Vector3, (widthSegments + 1) * (heightSegments + 1) * 2 + (widthSegments + 1) * (depthSegments + 1) * 2 + (heightSegments + 1) * (depthSegments + 1) * 2);\n  const uvValues = new ObjectArrayView(THREE.Vector2, (widthSegments + 1) * (heightSegments + 1) * 2 + (widthSegments + 1) * (depthSegments + 1) * 2 + (heightSegments + 1) * (depthSegments + 1) * 2);\n\n  const segment_width = width / widthSegments;\n  const segment_height = height / heightSegments;\n  const segment_depth = depth / depthSegments;\n\n  const width_half = width / 2;\n  const height_half = height / 2;\n  const depth_half = depth / 2;\n\n  let ix, iy, iz;\n  let indOffset = 0;\n\n  const newValue = new THREE.Vector3();\n  const newNormal = new THREE.Vector3();\n  const newUV = new THREE.Vector2();\n\n  //push utility for faceValueIndices\n  let indLengthMarker = 0;\n  function pushInd(value) {\n    faceValueIndices[indLengthMarker] = value;\n    indLengthMarker++;\n  }\n\n  //populate FaceRangeOffsets\n  for (iz = 0, ix = 0; iz < faceRangeOffsets.length; iz++, ix += 4) {\n    faceRangeOffsets[iz] = ix;//0 4 8 12 16 20 ...\n  }\n\n\n  //front and back\n  for (iz = 0; iz < 2; iz++) {//do twice, one for each face\n    for (iy = 0; iy < heightSegments; iy++) {\n      for (ix = 0; ix < widthSegments; ix++) {\n        pushInd(indOffset + iy * (widthSegments + 1) + ix);\n        pushInd(indOffset + iy * (widthSegments + 1) + ix + 1);\n        pushInd(indOffset + (iy + 1) * (widthSegments + 1) + ix + 1);\n        pushInd(indOffset + (iy + 1) * (widthSegments + 1) + ix);\n      }\n    }\n\n    indOffset += (widthSegments + 1) * (heightSegments + 1);\n  }\n\n  //top and bottom face\n  for (iy = 0; iy < 2; iy++) {//do twice, one for each face\n    for (ix = 0; ix < widthSegments; ix++) {\n      for (iz = 0; iz < depthSegments; iz++) {\n        pushInd(indOffset + ix * (depthSegments + 1) + iz);\n        pushInd(indOffset + ix * (depthSegments + 1) + iz + 1);\n        pushInd(indOffset + (ix + 1) * (depthSegments + 1) + iz + 1);\n        pushInd(indOffset + (ix + 1) * (depthSegments + 1) + iz);\n      }\n    }\n\n    indOffset += (widthSegments + 1) * (depthSegments + 1);\n  }\n\n  //left and right face\n  for (ix = 0; ix < 2; ix++) {//do twice, one for each face\n    for (iz = 0; iz < depthSegments; iz++) {\n      for (iy = 0; iy < heightSegments; iy++) {\n        pushInd(indOffset + iz * (heightSegments + 1) + iy);\n        pushInd(indOffset + iz * (heightSegments + 1) + iy + 1);\n        pushInd(indOffset + (iz + 1) * (heightSegments + 1) + iy + 1);\n        pushInd(indOffset + (iz + 1) * (heightSegments + 1) + iy);\n      }\n    }\n\n    indOffset += (depthSegments + 1) * (heightSegments + 1);\n  }\n\n\n  //push utility for faceValueIndices\n  let valLengthMarker = 0;\n  function pushVal(value) {\n    values.setAt(valLengthMarker, value);\n    valLengthMarker++;\n  }\n\n  //push utility for uv's and normals\n  let uv_normLengthMarker = 0;\n  function push_uv_norm(uv, norm) {\n    uvValues.setAt(uv_normLengthMarker, uv);\n    normals.setAt(uv_normLengthMarker, norm);\n    uv_normLengthMarker++;\n  }\n\n  //populate values, normals, and uv values\n  //front and back\n  for (iz = -1; iz < 2; iz += 2) {//do twice for each side with -1 for first and +1 for second\n    for (iy = 0; iy < heightSegments + 1; iy++) {\n\n      //calculate y coord\n      const y = -1 * iz * iy * segment_height + iz * height_half;\n\n      for (ix = 0; ix < widthSegments + 1; ix++) {\n        //calculate x coord\n        const x = ix * segment_width - width_half;\n\n        //set value\n        newValue.set(x, y, -1 * iz * depth_half);\n        pushVal(newValue);\n\n        //set normal\n        newNormal.set(0, 0, -1 * iz);\n\n        //set uv value\n        newUV.set(ix / widthSegments, iy / heightSegments);\n        push_uv_norm(newUV, newNormal);\n\n      }\n    }\n  }\n\n  //top and bottom\n  for (iy = -1; iy < 2; iy += 2) {//do twice for each side with -1 for first and +1 for second\n    for (ix = 0; ix < widthSegments + 1; ix++) {\n\n      //calculate z coord\n      const x = -1 * ix * iy * segment_width + iy * width_half;\n\n      for (iz = 0; iz < depthSegments + 1; iz++) {\n        //calculate x coord\n        const z = iz * segment_depth - depth_half;\n\n        //set value\n        newValue.set(x, -1 * iy * height_half, z);\n        pushVal(newValue);\n\n        //set normal\n        newNormal.set(0, -1 * iy, 0);\n\n        //set uv value\n        newUV.set(ix / widthSegments, iz / depthSegments);\n        push_uv_norm(newUV, newNormal);\n\n      }\n    }\n  }\n\n\n  //left and right\n  for (ix = -1; ix < 2; ix += 2) {//do twice for each side with -1 for first and +1 for second\n    for (iz = 0; iz < depthSegments + 1; iz++) {\n\n      //calculate y coord\n      const z = -1 * ix * iz * segment_depth + ix * depth_half;\n\n      for (iy = 0; iy < heightSegments + 1; iy++) {\n        //calculate z coord\n        const y = iy * segment_height - height_half;\n\n        //set value\n        newValue.set(-1 * ix * width_half, y, z);\n        pushVal(newValue);\n\n        //set normal\n        newNormal.set(-1 * ix, 0, 0);\n\n        //set uv value\n        newUV.set(iz / depthSegments, iy / heightSegments);\n        push_uv_norm(newUV, newNormal);\n\n      }\n    }\n  }\n\n  const positionsMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: values,\n  });\n\n  const normalMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: normals,\n  });\n\n  const uvMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: uvValues,\n  });\n\n  const uvMapsByName = new ObjectsByName();\n  uvMapsByName.set('default', uvMap);\n\n  const polyMesh = new PolyMesh();\n  polyMesh.faceRangeOffsets = faceRangeOffsets;\n  polyMesh.positions = positionsMap;\n  polyMesh.normalMap = normalMap;\n  polyMesh.uvMaps = uvMapsByName;\n\n  return removeDuplicateValues(polyMesh);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/primitives/Box.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ObjectBuffer from '../../generic/container/ObjectBuffer';\nimport PolyMesh from '../model/PolyMesh';\nimport PolyMap from '../model/PolyMap';\n\nexport default function removeDuplicateValues(polyMesh, withLogging) {\n\n  //removes indentical values in the values array and remaps the indices\n  //also has the side effect of removing values not used by a face\n\n  const l = withLogging || false;\n\n  const faceValueIndices = new Uint32Array(polyMesh.positions.faceValueIndices);\n  const values = polyMesh.positions.values;\n\n  const newValues = new ObjectBuffer(THREE.Vector3);\n\n  const valueMappings = new Map();\n  let newValuesLength = 0;\n\n  let key = 0;\n  let newIndex = 0;\n  const value = new THREE.Vector3();\n  const keyValue = new THREE.Vector3();\n\n  const boundingBox = new THREE.Box3();\n  boundingBox.setFromArray(new Float32Array(values.data));\n  const boundingBoxDiagonalWithShift = boundingBox.getSize().length() * Math.pow(2, 17);\n\n  for (let ix = 0; ix < faceValueIndices.length; ix++) {\n\n    values.getAt(faceValueIndices[ix], value);\n    //hash function scales values to the diagonal of the bounding box and stores 17 bits of precision in 3 buckets in a 64 bit float (52 bits usable)\n    keyValue.subVectors(value, boundingBox.min).multiplyScalar(boundingBoxDiagonalWithShift);\n    key = keyValue.x * 1000000000000 + keyValue.y * 100000 + keyValue.z;\n\n    if (!valueMappings.has(key)) {\n      valueMappings.set(key, newValuesLength);//save location of value in map\n      newIndex = newValuesLength;\n      newValues.push(value);//push value to the newValues array\n      newValuesLength++;\n    } else {\n      newIndex = valueMappings.get(key);\n    }\n\n    faceValueIndices[ix] = newIndex;//update indices array with new value\n\n  }\n\n  if (l) console.log('' + values.length + ' values reduced to ' + newValuesLength + ', duplicates removed: ' + (values.length - newValuesLength));\n\n  if (values.length === newValuesLength) return polyMesh;\n\n  const newValuesArray = new ObjectArrayView(THREE.Vector3, newValuesLength);\n  newValuesArray.fromArray(newValues.toArray());\n\n  const newPositions = new PolyMap({\n    faceRangeOffsets: polyMesh.faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: newValuesArray,\n  });\n\n  const resultMesh = new PolyMesh(polyMesh);\n  resultMesh.positions = newPositions;\n\n  resultMesh.topologyChanged();\n  return resultMesh;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/removeDuplicateValues.js","module.exports = { \"default\": require(\"core-js/library/fn/map\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/map.js\n// module id = 242\n// module chunks = 0 1 2","require('../modules/es6.object.to-string');\nrequire('../modules/es6.string.iterator');\nrequire('../modules/web.dom.iterable');\nrequire('../modules/es6.map');\nrequire('../modules/es7.map.to-json');\nmodule.exports = require('../modules/_core').Map;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/map.js\n// module id = 243\n// module chunks = 0 1 2","'use strict';\nvar strong = require('./_collection-strong');\n\n// 23.1 Map Objects\nmodule.exports = require('./_collection')('Map', function(get){\n  return function Map(){ return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.1.3.6 Map.prototype.get(key)\n  get: function get(key){\n    var entry = strong.getEntry(this, key);\n    return entry && entry.v;\n  },\n  // 23.1.3.9 Map.prototype.set(key, value)\n  set: function set(key, value){\n    return strong.def(this, key === 0 ? 0 : key, value);\n  }\n}, strong, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.map.js\n// module id = 244\n// module chunks = 0 1 2","'use strict';\nvar dP          = require('./_object-dp').f\n  , create      = require('./_object-create')\n  , redefineAll = require('./_redefine-all')\n  , ctx         = require('./_ctx')\n  , anInstance  = require('./_an-instance')\n  , defined     = require('./_defined')\n  , forOf       = require('./_for-of')\n  , $iterDefine = require('./_iter-define')\n  , step        = require('./_iter-step')\n  , setSpecies  = require('./_set-species')\n  , DESCRIPTORS = require('./_descriptors')\n  , fastKey     = require('./_meta').fastKey\n  , SIZE        = DESCRIPTORS ? '_s' : 'size';\n\nvar getEntry = function(that, key){\n  // fast case\n  var index = fastKey(key), entry;\n  if(index !== 'F')return that._i[index];\n  // frozen object case\n  for(entry = that._f; entry; entry = entry.n){\n    if(entry.k == key)return entry;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function(wrapper, NAME, IS_MAP, ADDER){\n    var C = wrapper(function(that, iterable){\n      anInstance(that, C, NAME, '_i');\n      that._i = create(null); // index\n      that._f = undefined;    // first entry\n      that._l = undefined;    // last entry\n      that[SIZE] = 0;         // size\n      if(iterable != undefined)forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.1.3.1 Map.prototype.clear()\n      // 23.2.3.2 Set.prototype.clear()\n      clear: function clear(){\n        for(var that = this, data = that._i, entry = that._f; entry; entry = entry.n){\n          entry.r = true;\n          if(entry.p)entry.p = entry.p.n = undefined;\n          delete data[entry.i];\n        }\n        that._f = that._l = undefined;\n        that[SIZE] = 0;\n      },\n      // 23.1.3.3 Map.prototype.delete(key)\n      // 23.2.3.4 Set.prototype.delete(value)\n      'delete': function(key){\n        var that  = this\n          , entry = getEntry(that, key);\n        if(entry){\n          var next = entry.n\n            , prev = entry.p;\n          delete that._i[entry.i];\n          entry.r = true;\n          if(prev)prev.n = next;\n          if(next)next.p = prev;\n          if(that._f == entry)that._f = next;\n          if(that._l == entry)that._l = prev;\n          that[SIZE]--;\n        } return !!entry;\n      },\n      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)\n      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)\n      forEach: function forEach(callbackfn /*, that = undefined */){\n        anInstance(this, C, 'forEach');\n        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3)\n          , entry;\n        while(entry = entry ? entry.n : this._f){\n          f(entry.v, entry.k, this);\n          // revert to the last existing entry\n          while(entry && entry.r)entry = entry.p;\n        }\n      },\n      // 23.1.3.7 Map.prototype.has(key)\n      // 23.2.3.7 Set.prototype.has(value)\n      has: function has(key){\n        return !!getEntry(this, key);\n      }\n    });\n    if(DESCRIPTORS)dP(C.prototype, 'size', {\n      get: function(){\n        return defined(this[SIZE]);\n      }\n    });\n    return C;\n  },\n  def: function(that, key, value){\n    var entry = getEntry(that, key)\n      , prev, index;\n    // change existing entry\n    if(entry){\n      entry.v = value;\n    // create new entry\n    } else {\n      that._l = entry = {\n        i: index = fastKey(key, true), // <- index\n        k: key,                        // <- key\n        v: value,                      // <- value\n        p: prev = that._l,             // <- previous entry\n        n: undefined,                  // <- next entry\n        r: false                       // <- removed\n      };\n      if(!that._f)that._f = entry;\n      if(prev)prev.n = entry;\n      that[SIZE]++;\n      // add to index\n      if(index !== 'F')that._i[index] = entry;\n    } return that;\n  },\n  getEntry: getEntry,\n  setStrong: function(C, NAME, IS_MAP){\n    // add .keys, .values, .entries, [@@iterator]\n    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11\n    $iterDefine(C, NAME, function(iterated, kind){\n      this._t = iterated;  // target\n      this._k = kind;      // kind\n      this._l = undefined; // previous\n    }, function(){\n      var that  = this\n        , kind  = that._k\n        , entry = that._l;\n      // revert to the last existing entry\n      while(entry && entry.r)entry = entry.p;\n      // get next entry\n      if(!that._t || !(that._l = entry = entry ? entry.n : that._t._f)){\n        // or finish the iteration\n        that._t = undefined;\n        return step(1);\n      }\n      // return step by kind\n      if(kind == 'keys'  )return step(0, entry.k);\n      if(kind == 'values')return step(0, entry.v);\n      return step(0, [entry.k, entry.v]);\n    }, IS_MAP ? 'entries' : 'values' , !IS_MAP, true);\n\n    // add [@@species], 23.1.2.2, 23.2.2.2\n    setSpecies(NAME);\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_collection-strong.js\n// module id = 245\n// module chunks = 0 1 2","'use strict';\nvar global         = require('./_global')\n  , $export        = require('./_export')\n  , meta           = require('./_meta')\n  , fails          = require('./_fails')\n  , hide           = require('./_hide')\n  , redefineAll    = require('./_redefine-all')\n  , forOf          = require('./_for-of')\n  , anInstance     = require('./_an-instance')\n  , isObject       = require('./_is-object')\n  , setToStringTag = require('./_set-to-string-tag')\n  , dP             = require('./_object-dp').f\n  , each           = require('./_array-methods')(0)\n  , DESCRIPTORS    = require('./_descriptors');\n\nmodule.exports = function(NAME, wrapper, methods, common, IS_MAP, IS_WEAK){\n  var Base  = global[NAME]\n    , C     = Base\n    , ADDER = IS_MAP ? 'set' : 'add'\n    , proto = C && C.prototype\n    , O     = {};\n  if(!DESCRIPTORS || typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function(){\n    new C().entries().next();\n  }))){\n    // create collection constructor\n    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);\n    redefineAll(C.prototype, methods);\n    meta.NEED = true;\n  } else {\n    C = wrapper(function(target, iterable){\n      anInstance(target, C, NAME, '_c');\n      target._c = new Base;\n      if(iterable != undefined)forOf(iterable, IS_MAP, target[ADDER], target);\n    });\n    each('add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON'.split(','),function(KEY){\n      var IS_ADDER = KEY == 'add' || KEY == 'set';\n      if(KEY in proto && !(IS_WEAK && KEY == 'clear'))hide(C.prototype, KEY, function(a, b){\n        anInstance(this, C, KEY);\n        if(!IS_ADDER && IS_WEAK && !isObject(a))return KEY == 'get' ? undefined : false;\n        var result = this._c[KEY](a === 0 ? 0 : a, b);\n        return IS_ADDER ? this : result;\n      });\n    });\n    if('size' in proto)dP(C.prototype, 'size', {\n      get: function(){\n        return this._c.size;\n      }\n    });\n  }\n\n  setToStringTag(C, NAME);\n\n  O[NAME] = C;\n  $export($export.G + $export.W + $export.F, O);\n\n  if(!IS_WEAK)common.setStrong(C, NAME, IS_MAP);\n\n  return C;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_collection.js\n// module id = 246\n// module chunks = 0 1 2","// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx      = require('./_ctx')\n  , IObject  = require('./_iobject')\n  , toObject = require('./_to-object')\n  , toLength = require('./_to-length')\n  , asc      = require('./_array-species-create');\nmodule.exports = function(TYPE, $create){\n  var IS_MAP        = TYPE == 1\n    , IS_FILTER     = TYPE == 2\n    , IS_SOME       = TYPE == 3\n    , IS_EVERY      = TYPE == 4\n    , IS_FIND_INDEX = TYPE == 6\n    , NO_HOLES      = TYPE == 5 || IS_FIND_INDEX\n    , create        = $create || asc;\n  return function($this, callbackfn, that){\n    var O      = toObject($this)\n      , self   = IObject(O)\n      , f      = ctx(callbackfn, that, 3)\n      , length = toLength(self.length)\n      , index  = 0\n      , result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined\n      , val, res;\n    for(;length > index; index++)if(NO_HOLES || index in self){\n      val = self[index];\n      res = f(val, index, O);\n      if(TYPE){\n        if(IS_MAP)result[index] = res;            // map\n        else if(res)switch(TYPE){\n          case 3: return true;                    // some\n          case 5: return val;                     // find\n          case 6: return index;                   // findIndex\n          case 2: result.push(val);               // filter\n        } else if(IS_EVERY)return false;          // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_array-methods.js\n// module id = 247\n// module chunks = 0 1 2","// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = require('./_array-species-constructor');\n\nmodule.exports = function(original, length){\n  return new (speciesConstructor(original))(length);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_array-species-create.js\n// module id = 248\n// module chunks = 0 1 2","var isObject = require('./_is-object')\n  , isArray  = require('./_is-array')\n  , SPECIES  = require('./_wks')('species');\n\nmodule.exports = function(original){\n  var C;\n  if(isArray(original)){\n    C = original.constructor;\n    // cross-realm fallback\n    if(typeof C == 'function' && (C === Array || isArray(C.prototype)))C = undefined;\n    if(isObject(C)){\n      C = C[SPECIES];\n      if(C === null)C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_array-species-constructor.js\n// module id = 249\n// module chunks = 0 1 2","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar $export  = require('./_export');\n\n$export($export.P + $export.R, 'Map', {toJSON: require('./_collection-to-json')('Map')});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es7.map.to-json.js\n// module id = 250\n// module chunks = 0 1 2","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar classof = require('./_classof')\n  , from    = require('./_array-from-iterable');\nmodule.exports = function(NAME){\n  return function toJSON(){\n    if(classof(this) != NAME)throw TypeError(NAME + \"#toJSON isn't generic\");\n    return from(this);\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_collection-to-json.js\n// module id = 251\n// module chunks = 0 1 2","var forOf = require('./_for-of');\n\nmodule.exports = function(iter, ITERATOR){\n  var result = [];\n  forOf(iter, false, result.push, result, ITERATOR);\n  return result;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_array-from-iterable.js\n// module id = 252\n// module chunks = 0 1 2","\nimport sphere from '../../polyMesh/geometric/primitives/Sphere';\n\nconst Sphere = {\n  schema: {\n    radius: { label: 'Radius', type: 'Number', defaultValue: 0.5, minValue: 0.0, step: 0.1, animatable: true },\n    widthSegments: { label: 'Longitudinal Segments', type: 'Integer', defaultValue: 24, minValue: 3, maxValue: 200, step: 1, animatable: true },\n    heightSegments: { label: 'Latitudinal Segments', type: 'Integer', defaultValue: 24, minValue: 3, maxValue: 200, step: 1, animatable: true },\n    phiStart: { label: 'Phi Start', type: 'Number', defaultValue: 0, minValue: 0, maxValue: 360, step: 10, animatable: true },\n    phiLength: { label: 'Phi Length', type: 'Number', defaultValue: 360, minValue: 0, maxValue: 360, step: 10, animatable: true },\n    thetaStart: { label: 'Theta Start', type: 'Number', defaultValue: 0, minValue: 0, maxValue: 180, step: 10, animatable: true },\n    thetaLength: { label: 'Theta Length', type: 'Number', defaultValue: 180, minValue: 0, maxValue: 180, step: 10, animatable: true },\n  },\n\n  update: function (operator, primitive) {\n    const { radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength } = operator;\n    primitive.mesh = sphere(radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength);\n  },\n};\n\nexport default Sphere;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Sphere.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport Lathe from './Lathe';\n\nexport default function Sphere(radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength) {\n\n  radius = radius || 50;\n\n  widthSegments = Math.max(3, Math.floor(widthSegments || 8));\n  heightSegments = Math.max(2, Math.floor(heightSegments || 6));\n\n  phiStart = THREE.Math.clamp(phiStart || 0, 0, Math.PI * 2);\n  phiLength = THREE.Math.clamp(phiLength || Math.PI * 2, 0, Math.PI * 2 - phiStart);\n\n  thetaStart = THREE.Math.clamp(thetaStart || 0, 0, Math.PI);\n  thetaLength = THREE.Math.clamp(thetaLength || Math.PI, 0, Math.PI - thetaStart);\n\n  const inverseHeightSegments = 1.0 / heightSegments;\n  const points = new ObjectArrayView(THREE.Vector3, heightSegments + 1);\n  const norms  = new ObjectArrayView(THREE.Vector3, heightSegments + 1);\n  const pt = new THREE.Vector3();\n\n  for (let i = 0, il = heightSegments; i <= il; i++) {\n\n    const theta = thetaStart + i * inverseHeightSegments * thetaLength;\n\n    pt.set(\n      radius * Math.sin(theta),\n      -radius * Math.cos(theta),\n      0\n    );\n\n    points.setAt(i, pt);\n    norms.setAt(i, pt.normalize());\n  }\n\n  return Lathe(points, norms, widthSegments, phiStart, phiLength);\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/primitives/Sphere.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ObjectsByName from '../../generic/container/ObjectsByName';\nimport PolyMesh from '../model/PolyMesh';\nimport PolyMap from '../model/PolyMap';\nimport cleanPolyMesh from '../operator/cleanPolyMesh';\n\nexport default function Lathe(points, norms, segments, phiStart, phiLength) {\n  //assumes one normal per point\n  const positions = new ObjectArrayView(THREE.Vector3, (segments + 1) * points.length);\n  const normals   = new ObjectArrayView(THREE.Vector3, (segments + 1) * norms.length);\n  let positionCounter = 0;\n  const faceRangeOffsets = new Uint32Array((segments) * (points.length - 1) + 1);//number of faces\n  const faceValueIndices = new Uint32Array((segments) * (points.length - 1) * 4);//number of faces*4\n  let indCounter = 0;\n  const uvValues = new ObjectArrayView(THREE.Vector2, (segments + 1) * points.length);\n  let uvCounter = 0;\n\n  segments = segments || 12;\n  phiStart = phiStart || 0;\n  phiLength = phiLength || 2 * Math.PI;\n\n  const inversePointLength = 1.0 / (points.length - 1);\n  const inverseSegments = 1.0 / segments;\n\n  faceRangeOffsets[0] = 0;\n  let faceCounter = 1;\n\n  const tempUV = new THREE.Vector2();\n  const vertex = new THREE.Vector3();\n  const normal = new THREE.Vector3();\n\n  const rotationMatrix4 = new THREE.Matrix4().identity();\n  const rotationMatrix = new THREE.Matrix3().identity();\n\n  for (let i = 0, il = segments; i <= il; i++) {\n\n    const phi = phiStart + i * inverseSegments * phiLength;\n    rotationMatrix4.copy(rotationMatrix4.makeRotationY(phi));\n    rotationMatrix.getNormalMatrix(rotationMatrix4);\n\n    const u = i * inverseSegments;\n\n    for (let j = 0, jl = points.length; j < jl; j++) {\n\n      points.getAt(j, vertex);\n      norms.getAt(j, normal);\n\n      vertex.applyMatrix3(rotationMatrix);\n      normal.applyMatrix3(rotationMatrix);\n\n      vertex.set(\n        Math.round(vertex.x * 1000) / 1000,\n        Math.round(vertex.y * 1000) / 1000,\n        Math.round(vertex.z * 1000) / 1000);\n\n      normal.set(\n        Math.round(normal.x * 1000) / 1000,\n        Math.round(normal.y * 1000) / 1000,\n        Math.round(normal.z * 1000) / 1000);\n\n      positions.setAt(positionCounter, vertex);\n      normals.setAt(positionCounter, normal);\n\n      const v = j / (points.length - 1);\n\n      tempUV.set(u, v);\n      uvValues.setAt(positionCounter++, tempUV);\n    }\n\n  }\n\n  const np = points.length;\n\n  for (let i = 0, il = segments; i < il; i++) {\n\n    for (let j = 0, jl = points.length - 1; j < jl; j++) {\n\n      const base = j + np * i;\n      const a = base;\n      const b = base + np;\n      const c = base + 1 + np;\n      const d = base + 1;\n\n      faceValueIndices[indCounter++] = a;\n      faceValueIndices[indCounter++] = b;\n      faceValueIndices[indCounter++] = c;\n      faceValueIndices[indCounter++] = d;\n      faceRangeOffsets[faceCounter++] = indCounter;\n    }\n\n  }\n\n  const positionsMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: positions,\n  });\n\n  const normalMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: normals,\n  });\n\n  const uvMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: uvValues,\n  });\n\n  const uvMapsByName = new ObjectsByName();\n  const name = 'default';\n  uvMapsByName.set(name, uvMap);\n\n  const polyMesh = new PolyMesh();\n  polyMesh.faceRangeOffsets = positionsMap.faceRangeOffsets;\n  polyMesh.positions = positionsMap;\n  polyMesh.normalMap = normalMap;\n  polyMesh.uvMaps = uvMapsByName;\n\n  return cleanPolyMesh(new PolyMesh(polyMesh));\n  //return new PolyMesh( new PolyMesh( polyMesh ) );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/primitives/Lathe.js","import removeDuplicateValues from '../operator/removeDuplicateValues';\nimport removeDuplicateIndices from '../operator/removeDuplicateIndices';\nimport removeInvalidSurfaces from '../operator/removeInvalidSurfaces';\nimport removeDuplicateNormals from '../operator/removeDuplicateNormals';\n\nexport default function cleanPolyMesh(polyMesh) {\n  //not advisable to remove normals by default. can lead to fusing of normals on joints while doing animation\n  //return removeDuplicateNormals(removeInvalidSurfaces(removeDuplicateIndices(removeDuplicateValues(polyMesh))));\n  return removeInvalidSurfaces(removeDuplicateIndices(removeDuplicateValues(polyMesh)));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/cleanPolyMesh.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ObjectsByName from '../../generic/container/ObjectsByName';\nimport ObjectBuffer from '../../generic/container/ObjectBuffer';\nimport PolyMesh from '../model/PolyMesh';\nimport PolyMap from '../model/PolyMap';\n\nexport default function removeDuplicateIndices(polyMesh, withLogging) {\n\n  const l = withLogging || false;\n\n  const faceRangeOffsets = new Uint32Array(polyMesh.positions.faceRangeOffsets);\n  const faceValueIndices = new Uint32Array(polyMesh.positions.faceValueIndices);\n  const normalFaceValueIndices = new Uint32Array(polyMesh.normalMap.faceValueIndices);\n\n  const uvMapNames = [];\n  const uvMapsNewIndices = [];\n  if (polyMesh.uvMaps) {\n    for (let i = 0; i < polyMesh.uvMaps.length; i++) {\n      uvMapNames.push(polyMesh.uvMaps.namesByIndex[i]);\n      uvMapsNewIndices.push(new Uint32Array(polyMesh.uvMaps.byName[uvMapNames[i]].faceValueIndices));\n    }\n  }\n\n  let newIndicesMarker = 0;\n\n  let previousFaceIndex = 0;\n  let currentFaceIndex = 0;\n  let currentFaceSize = 0;\n  let newFaceSize = 0;\n\n  //stores [index value, index];\n  const uniqueIndicesMap = new Map();\n\n  //Check every face\n  for (let i = 1; i < faceRangeOffsets.length; i++) {\n\n    currentFaceIndex = faceRangeOffsets[i];\n    currentFaceSize = currentFaceIndex - previousFaceIndex;\n    newFaceSize = currentFaceSize;\n\n    //check unique\n    uniqueIndicesMap.clear();\n    for (let j = 0; j < currentFaceSize; j++) {\n      uniqueIndicesMap.set(faceValueIndices[previousFaceIndex + j], previousFaceIndex + j);\n    }\n\n    newFaceSize = uniqueIndicesMap.size;\n    //special case face of size 1\n    if (newFaceSize === 1) {\n      if (l && currentFaceSize > 1) console.log('Face ' + i + ' has only 1 unique value. Reducing to a point...');\n      faceRangeOffsets[i] = faceRangeOffsets[i - 1] + 1;\n      faceValueIndices[newIndicesMarker++] = faceValueIndices[previousFaceIndex];\n\n    } else {\n      if (l && currentFaceSize === 2) console.log('Face ' + i + ' has only 2 unique values. Reducing to a line...');\n\n      faceRangeOffsets[i] = faceRangeOffsets[i - 1] + newFaceSize;\n      let entries = uniqueIndicesMap.entries();\n\n      let element;\n      for (element of entries) {\n        normalFaceValueIndices[newIndicesMarker] = normalFaceValueIndices[element[1]];\n        for (let k = 0; k < uvMapsNewIndices.length; k++) {\n          uvMapsNewIndices[k][newIndicesMarker] = uvMapsNewIndices[k][element[1]];\n        }\n\n        faceValueIndices[newIndicesMarker++] = element[0];\n      }\n    }\n\n    previousFaceIndex = currentFaceIndex;\n  }\n\n  if (l) console.log('' + faceValueIndices.length + ' index values reduced to ' + newIndicesMarker + ', duplicates removed: ' + (faceValueIndices.length - newIndicesMarker));\n\n  const newIndices = new Uint32Array(faceValueIndices.subarray(0, newIndicesMarker));\n  const newNormalIndices = new Uint32Array(normalFaceValueIndices.subarray(0, newIndicesMarker));\n\n  const positions = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: newIndices,\n    values: polyMesh.positions.values,\n  });\n\n  const results = new PolyMesh();\n  results.positions = positions;\n  results.faceRangeOffsets = results.positions.faceRangeOffsets;\n\n  const normalMap = new PolyMap({\n    faceRangeOffsets: results.faceRangeOffsets,\n    faceValueIndices: newNormalIndices,\n    values: polyMesh.normalMap.values,\n  });\n  results.normalMap = normalMap;\n\n  if (polyMesh.uvMaps) {\n    let uvMaps = new ObjectsByName();\n    for (let i = 0; i < polyMesh.uvMaps.length; i++) {\n      let name = polyMesh.uvMaps.namesByIndex[i];\n      const uvMap = new PolyMap({\n        faceRangeOffsets: results.faceRangeOffsets,\n        faceValueIndices: uvMapsNewIndices[i],\n        values: polyMesh.uvMaps.byName[name].values,\n      });\n      uvMaps.set(name, uvMap);\n    }\n\n    results.uvMaps = uvMaps;\n  }\n\n  return results;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/removeDuplicateIndices.js","import * as THREE from 'three';\nimport ObjectsByName from '../../generic/container/ObjectsByName';\nimport PolyMesh from '../model/PolyMesh';\nimport PolyMap from '../model/PolyMap';\nimport removeUnusedValues from '../operator/removeUnusedValues';\nimport applyFunctionToPolyMap from './applyFunctionToPolyMap';\n\nexport default function removeInvalidSurfaces(polyMesh, withLogging) {\n\n  //this algorithm assumes no duplicate indices\n  //to remove those use removeDuplicateIndices first\n\n  function removeInvalidSurfacesFromMap(polyMap, polyMapName, additionalArguments) {\n    const l = additionalArguments.withLogging || false;\n\n    const faceRangeOffsets = new Uint32Array(polyMap.faceRangeOffsets);\n    const faceValueIndices = new Uint32Array(polyMap.faceValueIndices);\n    const values = polyMap.values;\n\n    let currentFaceIndex = 0;\n    let previousFaceIndex = 0;\n    let size = 0;\n\n    let newFacesMarker = 1;\n    let newIndicesMarker = 0;\n\n    for (let i = 1; i < faceRangeOffsets.length; i++) {\n\n      currentFaceIndex = faceRangeOffsets[i];\n      size = currentFaceIndex - previousFaceIndex;\n\n      if (size > 2) {\n        //store face\n        faceRangeOffsets[newFacesMarker] = faceRangeOffsets[newFacesMarker - 1] + size;\n        newFacesMarker++;\n\n        //store all the indices on that face\n        for (let j = 0; j < size; j++) {\n          faceValueIndices[newIndicesMarker++] = faceValueIndices[previousFaceIndex + j];\n        }\n      } else if (l) {\n        console.log('Removed face ' + i + ' of size ' + size);\n      }\n\n      previousFaceIndex = currentFaceIndex;\n    }\n\n    const newFaceRangeOffsets = new Uint32Array(faceRangeOffsets.subarray(0, newFacesMarker));\n    const newFaceValueIndices = new Uint32Array(faceValueIndices.subarray(0, newIndicesMarker));\n\n    let resultMap = new PolyMap({\n      faceRangeOffsets: newFaceRangeOffsets,\n      faceValueIndices: newFaceValueIndices,\n      values: values,\n    });\n    return resultMap;\n  }\n\n  const args = { withLogging };\n  const resultMesh = applyFunctionToPolyMap(polyMesh, removeInvalidSurfacesFromMap, args);\n\n  if (withLogging) console.log('' + (polyMesh.faceRangeOffsets.length - 1) + ' faces reduced to ' + (resultMesh.faceRangeOffsets.length - 1) + ', faces removed: ' + (polyMesh.faceRangeOffsets.length - resultMesh.faceRangeOffsets.length));\n\n  return removeUnusedValues(resultMesh).topologyChanged();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/removeInvalidSurfaces.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport PolyMesh from '../model/PolyMesh';\nimport PolyMap from '../model/PolyMap';\n\nexport default function removeUnusedValues(polyMesh, withLogging) {\n\n  const l = withLogging || false;\n\n  const faceValueIndices = new Uint32Array(polyMesh.positions.faceValueIndices);\n  const values = polyMesh.positions.values;\n\n  const newValues = new ObjectArrayView(THREE.Vector3, values.length);\n\n  const valueMappings = new Map();\n  let newValuesLength = 0;\n\n  let newIndex = 0;\n  const value = new THREE.Vector3;\n\n  for (let i = 0; i < faceValueIndices.length; i++) {\n    if (!valueMappings.has(faceValueIndices[i])) {\n      valueMappings.set(faceValueIndices[i], newValuesLength);\n      newIndex = newValuesLength;\n      values.getAt(faceValueIndices[i], value);\n      newValues.setAt(newValuesLength, value);\n      newValuesLength++;\n    } else {\n      newIndex = valueMappings.get(faceValueIndices[i]);\n    }\n\n    faceValueIndices[i] = newIndex;\n\n  }\n\n  if (l) console.log('' + values.length + ' values reduced to ' + newValuesLength + ', unused values removed: ' + (values.length - newValuesLength));\n\n  if (values.length === newValuesLength) return polyMesh;\n\n  const newValuesArray = new ObjectArrayView(THREE.Vector3, newValuesLength);\n  newValuesArray.fromArray(newValues.toArray());\n\n  const newPositions = new PolyMap({\n    faceRangeOffsets: polyMesh.faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: newValuesArray,\n  });\n\n  const resultMesh = new PolyMesh(polyMesh);\n  resultMesh.positions = newPositions;\n\n  return resultMesh;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/removeUnusedValues.js","import PolyMesh from '../model/PolyMesh';\nimport ObjectsByName from '../../generic/container/ObjectsByName';\n\nexport default function applyFunctionToPolyMap(polyMesh, applyToPolyMapFunction, additionalArguments) {\n  const args = additionalArguments || {};\n\n  const resultMesh = new PolyMesh(polyMesh);\n  resultMesh.positions = applyToPolyMapFunction(resultMesh.positions, 'positions', args);\n  if (resultMesh.normalMap) resultMesh.normalMap = applyToPolyMapFunction(resultMesh.normalMap, 'normalMap', args);\n\n  const uvMaps = new ObjectsByName();\n  for (let i = 0; i < polyMesh.uvMaps.length; i++) {\n    const name = polyMesh.uvMaps.namesByIndex[i];\n    const uvMap = applyToPolyMapFunction(polyMesh.uvMaps.byName[name], name, args);\n    uvMaps.set(name, uvMap);\n  }\n\n  resultMesh.uvMaps = uvMaps;\n  resultMesh.faceRangeOffsets = resultMesh.positions.faceRangeOffsets;\n\n  return resultMesh;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/applyFunctionToPolyMap.js","import cone from '../../polyMesh/geometric/primitives/Cone';\n\nconst Cone = {\n  schema: {\n    base: { type: 'Number', label: 'Base Radius', defaultValue: 0.5, minValue: 0.0, step: 0.1, animatable: true },\n    height: { type: 'Number', label: 'Height', defaultValue: 1, minValue: 0.0, step: 0.1, animatable: true },\n    radiusSegments: { label: 'Radial Segments', type: 'Integer', defaultValue: 12, minValue: 3, maxValue: 200, animatable: true },\n    heightSegments: { label: 'Height Segments', type: 'Integer', defaultValue: 1, minValue: 1, maxValue: 200, animatable: true },\n    openEnded:  { label: 'Open Base', type: 'Boolean', defaultValue: false, animatable: true },\n  },\n\n  update: function (operator, primitive) {\n    const { base, height, radiusSegments, heightSegments } = operator;\n    primitive.mesh = cone(base, radiusSegments, height);\n  },\n};\n\nexport default Cone;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Cone.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport Lathe from './Lathe';\n\nexport default function Cone(radius, segments, height, thetaStart, thetaLength) {\n\n  radius = radius || 50;\n\n  segments = Math.max(1, Math.floor(segments || 8));\n  const segmentLength = radius / segments;\n  const heightSegmentLength = height / segments;\n\n  thetaStart = THREE.Math.clamp(thetaStart || 0, 0, Math.PI * 2);\n  thetaLength = THREE.Math.clamp(thetaLength || Math.PI * 2, 0, Math.PI * 2 - thetaStart);\n\n  const points = new ObjectArrayView(THREE.Vector3, (segments + 1) * 2);\n  const norms  = new ObjectArrayView(THREE.Vector3, (segments + 1) * 2);\n  const normPt = new THREE.Vector3(0, -1, 0);\n  const pt = new THREE.Vector3();\n\n  for (let i = 0, il = segments; i <= il; i++) {\n\n    pt.set(i * segmentLength, -height / 2, 0);\n\n    points.setAt(i, pt);\n    norms.setAt(i, normPt);\n  }\n\n  normPt.set(height, radius, 0);\n  normPt.normalize();\n  for (let i = 0, il = segments; i <= il; i++) {\n\n    pt.set(radius - i * segmentLength, i * heightSegmentLength - (height / 2), 0);\n\n    points.setAt(segments + 1 + i, pt);\n    norms.setAt(segments + 1 + i, normPt);\n  }\n\n  const latheSegments = segments < 3 ? 3 : segments;\n  return Lathe(points, norms, latheSegments, thetaStart, thetaLength);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/primitives/Cone.js","\n\nimport capsule from '../../polyMesh/geometric/primitives/Capsule';\n\nconst Capsule = {\n  schema: {\n    radius: { type: 'Number', label: 'Radius', defaultValue: 0.5, minValue: 0.1, step: 0.1 },\n    height: { type: 'Number', label: 'Height', defaultValue: 1, minValue: 0.1, step: 0.1 },\n    radiusSegments: { label: 'Radial Segments', type: 'Integer', defaultValue: 12, minValue: 4, maxValue: 100 },\n    heightSegments: { label: 'Height Segments', type: 'Integer', defaultValue: 10, minValue: 1, maxValue: 100 },\n  },\n\n  update: function (operator, primitive) {\n    const { radius, height, radiusSegments, heightSegments } = operator;\n    primitive.mesh = capsule(radius, height, radiusSegments, heightSegments);\n  },\n};\n\nexport default Capsule;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Capsule.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport Lathe from './Lathe';\n\nexport default function Capsule(radius, height, radialSegments, heightSegments, thetaStart, thetaLength) {\n\n  radius = radius !== undefined ? radius : 20;\n  height = height !== undefined ? height : 100;\n\n  radialSegments = Math.max(1, Math.floor(radialSegments || 8));\n  heightSegments = Math.max(1, Math.floor(heightSegments || 8));\n\n  thetaStart = THREE.Math.clamp(thetaStart || 0, 0, Math.PI * 2);\n  thetaLength = THREE.Math.clamp(thetaLength || Math.PI * 2, 0, Math.PI * 2 - thetaStart);\n\n  const heightSegmentLength = height / heightSegments;\n  const halfHeight = height / 2;\n  const inverseRadialSegments = 1 / radialSegments;\n\n  const points = new ObjectArrayView(THREE.Vector3, heightSegments + 1 + (radialSegments + 1) * 2);\n  const norms  = new ObjectArrayView(THREE.Vector3, heightSegments + 1 + (radialSegments + 1) * 2);\n  const pt = new THREE.Vector3();\n  const normPt = new THREE.Vector3();\n\n  //top\n  for (let i = 0, il = radialSegments; i <= il; i++) {\n\n    let theta = i * (Math.PI / 2) * inverseRadialSegments;\n\n    pt.set(\n      radius * Math.sin(theta),\n      -radius * Math.cos(theta) - halfHeight,\n      0\n    );\n\n    normPt.set(\n      Math.sin(theta),\n      -Math.cos(theta),\n      0\n    );\n\n    points.setAt(i, pt);\n    norms.setAt(i, normPt.normalize());\n  }\n\n  //body\n  normPt.set(1, 0, 0);\n  for (let i = 0, il = heightSegments; i <= il; i++) {\n\n    pt.set(radius, i * heightSegmentLength - halfHeight, 0);\n\n    points.setAt(i + radialSegments + 1, pt);\n    norms.setAt(i + radialSegments + 1, normPt);\n  }\n\n  //bottom\n  for (let i = 0, il = radialSegments; i <= il; i++) {\n\n    let theta = Math.PI / 2 + i * (Math.PI / 2) * inverseRadialSegments;\n\n    pt.set(\n      radius * Math.sin(theta),\n      -radius * Math.cos(theta) + halfHeight,\n      0\n    );\n\n    normPt.set(\n      Math.sin(theta),\n      -Math.cos(theta),\n      0\n    );\n\n    points.setAt(i + radialSegments + heightSegments + 2, pt);\n    norms.setAt(i + radialSegments + heightSegments + 2, normPt.normalize());\n  }\n\n  const latheSegments = radialSegments < 3 ? 3 : radialSegments;\n  return Lathe(points, norms, latheSegments, thetaStart, thetaLength);\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/primitives/Capsule.js","\n\nimport cylinder from '../../polyMesh/geometric/primitives/Cylinder';\n\nconst Cylinder = {\n  schema: {\n    radiusTop: { type: 'Number', label: 'Top Radius', defaultValue: 0.5, minValue: 0.0, step: 0.1, animatable: true },\n    radiusBottom: { type: 'Number', label: 'Bottom Radius', defaultValue: 0.5, minValue: 0.0, step: 0.1, animatable: true },\n    height: { type: 'Number', label: 'Height', defaultValue: 1, minValue: 0.0, step: 0.1, animatable: true },\n    radiusSegments: { label: 'Radial Segments', type: 'Integer', defaultValue: 24, minValue: 3, maxValue: 200, animatable: true },\n    heightSegments: { label: 'Height Segments', type: 'Integer', defaultValue: 1, minValue: 1, maxValue: 200, animatable: true },\n    openEnded:  { label: 'Open Ended', type: 'Boolean', defaultValue: false, animatable: true },\n  },\n\n  update: function (operator, primitive) {\n    const { radiusTop, radiusBottom, height, radiusSegments, heightSegments, openEnded } = operator;\n    primitive.mesh = cylinder(radiusTop, radiusBottom, height, radiusSegments, heightSegments, openEnded);\n  },\n};\n\nexport default Cylinder;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Cylinder.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport Lathe from './Lathe';\n\nexport default function Cylinder(radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength) {\n\n  radiusTop = radiusTop !== undefined ? radiusTop : 20;\n  radiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\n  height = height !== undefined ? height : 100;\n\n  openEnded = openEnded || false;\n\n  radialSegments = Math.max(1, Math.floor(radialSegments || 8));\n  heightSegments = Math.max(1, Math.floor(heightSegments || 8));\n\n  thetaStart = THREE.Math.clamp(thetaStart || 0, 0, Math.PI * 2);\n  thetaLength = THREE.Math.clamp(thetaLength || Math.PI * 2, 0, Math.PI * 2 - thetaStart);\n\n  const heightSegmentLength = height / heightSegments;\n  const halfHeight = height / 2;\n  const slope = (radiusBottom - radiusTop) / height;\n\n  const radialSegmentsLengthTop = radiusTop / radialSegments;\n  const radialSegmentsLengthBottom = radiusBottom / radialSegments;\n\n  let points;\n  let norms;\n\n  if (openEnded) {\n    points = new ObjectArrayView(THREE.Vector3, heightSegments + 1);\n    norms = new ObjectArrayView(THREE.Vector3, heightSegments + 1);\n  } else {\n    points = new ObjectArrayView(THREE.Vector3, heightSegments + 1 + (radialSegments + 1) * 2);\n    norms = new ObjectArrayView(THREE.Vector3, heightSegments + 1 + (radialSegments + 1) * 2);\n  }\n\n  const pt = new THREE.Vector3();\n  const normPt = new THREE.Vector3(0, -1, 0);\n\n  if (!openEnded) {\n    //top\n    for (let i = 0, il = radialSegments; i <= il; i++) {\n\n      pt.set(i * radialSegmentsLengthTop, -1 * halfHeight, 0);\n      points.setAt(i, pt);\n      norms.setAt(i, normPt);\n    }\n  }\n\n  //body\n  normPt.set(height, radiusTop - radiusBottom, 0);\n  normPt.normalize();\n  for (let i = 0, il = heightSegments; i <= il; i++) {\n\n    pt.set(slope * i * heightSegmentLength + radiusTop, i * heightSegmentLength - halfHeight, 0);\n\n    if (openEnded) {\n      points.setAt(i, pt);\n      norms.setAt(i, normPt);\n    } else {\n      points.setAt(i + radialSegments + 1, pt);\n      norms.setAt(i + radialSegments + 1, normPt);\n    }\n  }\n\n  if (!openEnded) {\n    //bottom\n    normPt.set(0, 1, 0);\n\n    for (let i = 0, il = radialSegments; i <= il; i++) {\n\n      pt.set(radiusBottom - i * radialSegmentsLengthBottom, 1 * halfHeight, 0);\n      points.setAt(i + radialSegments + heightSegments + 2, pt);\n      norms.setAt(i + radialSegments + heightSegments + 2, normPt);\n    }\n  }\n\n  const latheSegments = radialSegments < 3 ? 3 : radialSegments;\n  return Lathe(points, norms, latheSegments, thetaStart, thetaLength);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/primitives/Cylinder.js","\nimport plane from '../../polyMesh/geometric/primitives/Plane';\n\nconst Plane = {\n  schema: {\n    width: { label: 'Width', type: 'Number', defaultValue: 4, minValue: 0.0, step: 0.1, animatable: true },\n    height: { label: 'Height', type: 'Number', defaultValue: 4, minValue: 0.0, step: 0.1, animatable: true },\n    widthSegments: { type: 'Number', label: 'Width Segments', defaultValue: 1, minValue: 1, isInteger: true, animatable: true },\n    heightSegments: { type: 'Number', label: 'Height Segments', defaultValue: 1, minValue: 1, isInteger: true, animatable: true },\n  },\n\n  update: function (operator, primitive) {\n    const { width, height, widthSegments, heightSegments } = operator;\n    primitive.mesh = plane(width, height, widthSegments, heightSegments);\n  },\n};\n\nexport default Plane;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Plane.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport ObjectsByName from '../../generic/container/ObjectsByName';\nimport PolyMesh from '../model/PolyMesh';\nimport PolyMap from '../model/PolyMap';\n\nexport default function Plane(width, height, widthSegments, heightSegments) {\n\n  widthSegments = Math.floor(widthSegments);\n  heightSegments = Math.floor(heightSegments);\n\n  const faceRangeOffsets = new Uint32Array(widthSegments * heightSegments + 1);\n  const faceValueIndices = new Uint32Array(widthSegments * heightSegments * 4);\n  const values = new ObjectArrayView(THREE.Vector3, (widthSegments + 1) * (heightSegments + 1));\n  const normals = new ObjectArrayView(THREE.Vector3, (widthSegments + 1) * (heightSegments + 1));\n  const uvValues = new ObjectArrayView(THREE.Vector2, (widthSegments + 1) * (heightSegments + 1));\n\n  const segment_width = width / widthSegments;\n  const segment_height = height / heightSegments;\n\n  const width_half = width / 2;\n  const height_half = height / 2;\n\n  let iz, ix;\n\n  const newValue = new THREE.Vector3();\n  const newNormal = new THREE.Vector3(0, 1, 0);\n  const newUV = new THREE.Vector2();\n\n  //populate FaceRangeOffsets\n  for (iz = 0, ix = 0; iz < faceRangeOffsets.length; iz++, ix += 4) {\n    faceRangeOffsets[iz] = ix;//0 4 8 12 16 20 ...\n  }\n\n  //populate faceValueIndices\n  for (iz = 0; iz < heightSegments; iz++) {\n    for (ix = 0; ix < widthSegments; ix++) {\n      faceValueIndices[(iz * widthSegments + ix) * 4]     = iz * (widthSegments + 1) + ix;\n      faceValueIndices[(iz * widthSegments + ix) * 4 + 1] = iz * (widthSegments + 1) + ix + 1;\n      faceValueIndices[(iz * widthSegments + ix) * 4 + 2] = (iz + 1) * (widthSegments + 1) + ix + 1;\n      faceValueIndices[(iz * widthSegments + ix) * 4 + 3] = (iz + 1) * (widthSegments + 1) + ix;\n    }\n  }\n\n  //populate values, normals, and uv values\n  for (iz = 0; iz < heightSegments + 1; iz++) {\n\n    //calculate z coord\n    const z = iz * segment_height - height_half;\n\n    for (ix = 0; ix < widthSegments + 1; ix++) {\n      //calculate x coord\n      const x = ix * segment_width - width_half;\n\n      //set value\n      newValue.set(x, 0, -z);\n      values.setAt((iz * (widthSegments + 1) + ix), newValue);\n\n      //set normal\n      normals.setAt((iz * (widthSegments + 1) + ix), newNormal);\n\n      //set uv value\n      newUV.set(ix / widthSegments, iz / heightSegments);\n      uvValues.setAt((iz * (widthSegments + 1) + ix), newUV);\n\n    }\n\n  }\n\n  const positionsMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: values,\n  });\n\n  const normalMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: normals,\n  });\n\n  const uvMap = new PolyMap({\n    faceRangeOffsets: faceRangeOffsets,\n    faceValueIndices: faceValueIndices,\n    values: uvValues,\n  });\n\n  const uvMapsByName = new ObjectsByName();\n  const name = 'default';\n  uvMapsByName.set(name, uvMap);\n\n  const polyMesh = new PolyMesh();\n  polyMesh.faceRangeOffsets = faceRangeOffsets;\n  polyMesh.positions = positionsMap;\n  polyMesh.normalMap = normalMap;\n  polyMesh.uvMaps = uvMapsByName;\n\n  return polyMesh;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/primitives/Plane.js","import torus from '../../polyMesh/geometric/primitives/Torus';\n\nconst Torus = {\n  schema: {\n    radius: { label: 'Radius', type: 'Number', defaultValue: 0.3, minValue: 0.0, step: 0.1, animatable: true },\n    tube: { label: 'Tube Radius', type: 'Number', defaultValue: 0.2, minValue: 0.0, step: 0.1, animatable: true },\n    radialSegments: { label: 'Longitudinal Segments', type: 'Integer', defaultValue: 24, minValue: 3, step: 1, animatable: true },\n    tubularSegments: { label: 'Latitudinal Segments', type: 'Integer', defaultValue: 24, minValue: 3, step: 1, animatable: true },\n    phiStart: { label: 'Phi Start', type: 'Number', defaultValue: 0, minValue: 0, maxValue: 360, step: 10, animatable: true },\n    phiLength: { label: 'Phi Length', type: 'Number', defaultValue: 360, minValue: 0, maxValue: 360, step: 10, animatable: true },\n    thetaStart: { label: 'Theta Start', type: 'Number', defaultValue: 0, minValue: 0, maxValue: 360, step: 10, animatable: true },\n    thetaLength: { label: 'Theta Length', type: 'Number', defaultValue: 360, minValue: 0, maxValue: 360, step: 10, animatable: true },\n  },\n\n  update: function (operator, primitive) {\n    const { radius, tube, radialSegments, tubularSegments, phiStart, phiLength, thetaStart, thetalength } = operator;\n    primitive.mesh = torus(radius, tube, radialSegments, tubularSegments, phiStart, phiLength, thetaStart, thetalength);\n  },\n};\n\nexport default Torus;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Torus.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport Lathe from './Lathe';\n\nexport default function Torus(radius, tube, radialSegments, tubularSegments, phiStart, phiLength, thetaStart, thetaLength) {\n\n  radialSegments = Math.floor(radialSegments) || 1;\n  tubularSegments = Math.floor(tubularSegments) || 1;\n\n  radius = radius || 100;\n  tube = tube || 40;\n\n  radialSegments = Math.max(radialSegments || 8, 3);\n  tubularSegments = Math.max(tubularSegments || 6, 3);\n\n  phiStart = THREE.Math.clamp(phiStart || 0, 0, Math.PI * 2);\n  phiLength = THREE.Math.clamp(phiLength || Math.PI * 2, 0, Math.PI * 2 - phiStart);\n\n  thetaStart = THREE.Math.clamp(thetaStart || 0, 0, Math.PI * 2);\n  thetaLength = THREE.Math.clamp(thetaLength || Math.PI * 2, 0, Math.PI * 2 - thetaStart);\n\n  const inverseTubularSegments = 1.0 / tubularSegments;\n  const points = new ObjectArrayView(THREE.Vector3, tubularSegments + 1);\n  const norms  = new ObjectArrayView(THREE.Vector3, tubularSegments + 1);\n  const pt = new THREE.Vector3();\n  const normPt = new THREE.Vector3();\n\n  for (let i = 0, il = tubularSegments; i <= il; i++) {\n\n    const theta = thetaStart + i * inverseTubularSegments * thetaLength;\n\n    pt.set(\n      radius + tube * Math.cos(theta),\n      tube * Math.sin(theta),\n      0\n    );\n\n    normPt.set(\n      Math.cos(theta),\n      Math.sin(theta),\n      0\n    );\n\n    points.setAt(i, pt);\n    norms.setAt(i, normPt.normalize());\n  }\n\n  return Lathe(points, norms, radialSegments, phiStart, phiLength);\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/primitives/Torus.js","import disk from '../../polyMesh/geometric/primitives/Disk';\n\nconst Disk = {\n  schema: {\n    radius: { type: 'Number', label: 'Radius', defaultValue: 0.5, minValue: 0.0, step: 0.1, animatable: true },\n    segments: { type: 'Integer', label: 'Segments', defaultValue: 12, minValue: 3, maxValue: 200, animatable: true },\n    thetaStart: { label: 'Theta Start', type: 'Number', defaultValue: 0, minValue: 0, maxValue: 360, step: 10, animatable: true },\n    thetaLength: { label: 'Theta Length', type: 'Number', defaultValue: 360, minValue: 0, maxValue: 360, step: 10, animatable: true },\n    removeDuplicate: { label: 'Remove Duplicate Vertices', type: 'Boolean', defaultValue: false, hidden: true },\n  },\n\n  update: function (operator, primitive) {\n    const { radius, segments, thetaStart, thetaLength } = operator;\n    primitive.mesh = disk(radius, segments, thetaStart, thetaLength);\n  },\n};\n\nexport default Disk;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Disk.js","import * as THREE from 'three';\nimport ObjectArrayView from '../../generic/container/ObjectArrayView';\nimport Lathe from './Lathe';\n\nexport default function Disk(radius, segments, thetaStart, thetaLength) {\n\n  radius = radius || 50;\n\n  segments = Math.max(1, Math.floor(segments || 8));\n  const segmentLength = radius / segments;\n\n  thetaStart = THREE.Math.clamp(thetaStart || 0, 0, Math.PI * 2);\n  thetaLength = THREE.Math.clamp(thetaLength || Math.PI * 2, 0, Math.PI * 2 - thetaStart);\n\n  const points = new ObjectArrayView(THREE.Vector3, segments + 1);\n  const norms  = new ObjectArrayView(THREE.Vector3, segments + 1);\n  const normPt = new THREE.Vector3(0, 1, 0);\n  const pt = new THREE.Vector3();\n\n  for (let i = 0, il = segments; i <= il; i++) {\n\n    pt.set(radius - i * segmentLength, 0, 0);\n\n    points.setAt(i, pt);\n    norms.setAt(i, normPt);\n  }\n\n  const latheSegments = segments < 3 ? 3 : segments;\n  return Lathe(points, norms, latheSegments, thetaStart, thetaLength);\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/primitives/Disk.js","import { convertToCNSPolyMesh } from '../../translators/bingeom';\nimport { getOrFetchBinary, getHash } from '../../modules/assets';\n\nconst ProxyMesh = {\n  schema: {\n    binary: { type: 'Binary', label: 'Binary Geometry File' },\n    reducedBinary: { type: 'Binary', label: 'Reduced Binary Geometry File' },\n    operatorDisplay: { type: 'Number', defaultValue: 1, label: 'Operator Display Type' },\n    nbLevel: { type: 'Number', defaultValue: 1 }, // 1 -> only binary, 2 -> level0 and binary, 3 -> level0, level1, binary, ....\n    level0: { type: 'Binary', label: 'Binary Geometry File' },\n    level1: { type: 'Binary', label: 'Binary Geometry File' },\n    level2: { type: 'Binary', label: 'Binary Geometry File' },\n    level3: { type: 'Binary', label: 'Binary Geometry File' },\n    level4: { type: 'Binary', label: 'Binary Geometry File' },\n  },\n\n  update: function (operator, primitive, { node, store, properties, previousResult, loaded }) {\n    const visible = properties.visible;\n    const binary = operator.binary;\n    const fetch = visible || (properties.prefetch && loaded);\n    const bingeom = fetch && binary && store.hasApi() && getOrFetchBinary(binary)(store);\n    const mesh = bingeom && convertToCNSPolyMesh(bingeom, binary);\n    //console.log('Mesh update', 'visible:', visible, 'prefetch:', properties.prefetch, 'fetch:', fetch, 'bingeom:', !!bingeom, node.name, mesh);\n    primitive.mesh = mesh;\n    primitive.previousMesh = previousResult && previousResult.mesh;\n  },\n};\n\nexport default ProxyMesh;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/ProxyMesh.js","const Instance = {\n  schema: {\n    geometry: { label: 'Mesh', plug: 'PolyMesh', type: 'Plug' },\n  },\n\n  update: function (operator, primitive) {\n    primitive.mesh = operator.geometry && operator.geometry.mesh;\n  },\n};\n\nexport default Instance;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/Instance.js","import sortFacesByAxis from '../../polyMesh/geometric/operator/sortFacesByAxis';\n\nconst SortFacesByAxis = {\n  schema: {\n    axis: { label: 'Direction', type: 'Vec3', step: 0.1, defaultValue: { x: 1, y: 1, z: 0 }, animatable: true },\n  },\n\n  update: function (operator, primitive, { store }) {\n    //using an import from player.js for getThreeCamera for some reason wipes the active camera\n    //const camera =  store.getIn(['player','threeCamera']);\n    //const cameraWorldMatrix = camera.matrix;\n    const axis = operator.axis.normalize();\n\n    //does not account for the local space of an object\n    //const cameraDirection = new THREE.Vector3(0,0,-1);\n    //cameraDirection.transformDirection(cameraWorldMatrix);\n\n    const polyMesh = primitive.mesh;\n    primitive.mesh = sortFacesByAxis(polyMesh, axis);\n  },\n};\n\nexport default SortFacesByAxis;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/PolyMesh/SortFacesByAxis.js","import * as THREE from 'three';\nimport PolyMap from '../model/PolyMap';\nimport applyFunctionToPolyMap from './applyFunctionToPolyMap';\n\nexport default function sortFacesByAxis(polyMesh, axis, withLogging) {\n\n  function reorderFacesOnPolymap(polyMap, polyMapName, additionalArguments) {\n    const newFaceRangeOffsets = additionalArguments.newFaceRangeOffsets;\n    const reMapping = additionalArguments.reMapping;\n\n    const faceRangeOffsets = polyMap.faceRangeOffsets;\n    const faceValueIndices = polyMap.faceValueIndices;\n    const newFaceValueIndices = new Uint32Array(faceValueIndices.length);\n    let newFaceValueIndicesMarker = 0;\n\n    for (let i = 0; i < reMapping.length; i++) {\n      for (let j = faceRangeOffsets[reMapping[i]]; j < faceRangeOffsets[reMapping[i] + 1]; j++) {\n        newFaceValueIndices[newFaceValueIndicesMarker++] = faceValueIndices[j];\n      }\n    }\n\n    const newPolyMap = new PolyMap({\n      faceRangeOffsets: newFaceRangeOffsets,\n      faceValueIndices: newFaceValueIndices,\n      values: polyMap.values,\n    });\n\n    return newPolyMap;\n\n  };\n\n  const l = withLogging || false;\n  if (!axis || !polyMesh) return polyMesh;\n  if (axis.x === 0 && axis.y === 0 && axis.z === 0) return polyMesh;\n\n  const faceRangeOffsets = polyMesh.faceRangeOffsets;\n  const newFaceRangeOffsets = new Uint32Array(polyMesh.faceRangeOffsets.length);\n  const faceValueIndices = new Uint32Array(polyMesh.positions.faceValueIndices);\n  const values = polyMesh.positions.values;\n\n  //create a mapping for the faces (0, 1, 2, 3, 4...)\n  const faces = [];\n  const faceDistances = [];\n\n  const centroid = new THREE.Vector3();\n  const tempValue = new THREE.Vector3();\n\n  for (let i = 0; i < faceRangeOffsets.length - 1; i++) {\n    faces[i] = i;\n\n    const faceStart = faceRangeOffsets[i];\n    const faceEnd = faceRangeOffsets[i + 1];\n\n    centroid.set(0, 0, 0);\n    for (let j = faceStart; j < faceEnd; j++) {\n      values.getAt(faceValueIndices[j], tempValue);\n      centroid.add(tempValue);\n    }\n\n    centroid.multiplyScalar(1 / (faceEnd - faceStart));\n\n    //projection of v1 and v2 on camera axis compare magnitudes\n    faceDistances[i] = centroid.dot(axis);\n  }\n\n  //sort the face mapping by the values of their indices\n  faces.sort(function (a, b) { return faceDistances[b] - faceDistances[a]; });\n\n  for (let i = 0; i < faces.length; i++) {\n    newFaceRangeOffsets[i + 1] = newFaceRangeOffsets[i] + (faceRangeOffsets[faces[i] + 1] - faceRangeOffsets[faces[i]]);\n  }\n\n  if (l) {//print out all the faces to compare old and new\n    console.log('Face List [old][new]:');\n    for (let i = 0; i < faces.length; i++) {\n      let face = [];\n      let newFace = [];\n      for (let j = faceRangeOffsets[i]; j < faceRangeOffsets[i + 1]; j++) {\n        face.push(faceValueIndices[j]);\n      }\n\n      for (let j = faceRangeOffsets[faces[i]]; j < faceRangeOffsets[faces[i] + 1]; j++) {\n        newFace.push(faceValueIndices[j]);\n      }\n\n      console.log(face, newFace);\n    }\n  }\n\n  const args = { newFaceRangeOffsets: newFaceRangeOffsets, reMapping: faces };\n  return applyFunctionToPolyMap(polyMesh, reorderFacesOnPolymap, args).topologyChanged();\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/sortFacesByAxis.js","const PolyMeshProperties = {\n  schema: {\n    visible: { label: 'Visible', type: 'Boolean', defaultValue: true, animatable: true },\n    prefetch: { label: 'Pre-fetch mesh', type: 'Boolean', defaultValue: false },\n  },\n};\n\nconst MaterialProperties = {\n  schema: {\n    prefetch: { label: 'Pre-fetch Material', type: 'Boolean', defaultValue: false },\n  },\n};\n\nconst ImageProperties = {\n  schema: {\n    prefetch: { label: 'Pre-fetch Image', type: 'Boolean', defaultValue: false },\n  },\n};\n\nconst Default = {\n  schema: {\n    visible: { label: 'Visible', type: 'Boolean', defaultValue: true, animatable: true },\n  },\n};\n\n\nconst motionTypes = ['Static', 'Kinematic', 'Dynamic'];\nconst shapeValues = ['Box', 'Convex', 'Mesh'];\nconst shapeLabels = ['Bounding Box', 'Convex Hull', 'Mesh (Non-Dynamic)'];\n\nconst RigidBodyProperties = {\n  schema: {\n    collisionShape: {\n      label: 'Collision Shape',\n      type: 'Options',\n      display: 'Dropdown',\n      values: shapeValues,\n      labels: shapeLabels,\n      defaultValue: 'Convex',\n    },\n    motionType: {\n      label: 'Motion Type',\n      type: 'Options',\n      display: 'Dropdown',\n      values: motionTypes,\n      labels: motionTypes,\n      defaultValue: 'Dynamic',\n    },\n    mass: { label: 'Mass', type: 'Number', defaultValue: 1.0, minValue: 0.0, step: 1 },\n    linearDamping: { label: 'Linear Damping', type: 'Number', defaultValue: 0.0, minValue: 0.0, maxValue: 1.0, step: 0.1 },\n    angularDamping: { label: 'Angular Damping', type: 'Number', defaultValue: 0.0, minValue: 0.0, maxValue: 1.0, step: 0.1 },\n //   gravity: { label: 'Local Gravity', type: 'Vec3', step: 1.0, defaultValue: [0, -9.8, 0] },\n    linearFactor: { label: 'Linear Factor', type: 'Vec3', defaultValue: [1.0, 1.0, 1.0] },\n    angularFactor: { label: 'Angular Factor', type: 'Vec3', defaultValue: [1.0, 1.0, 1.0] },\n    linearVelocity: { label: 'Linear Velocity', type: 'Vec3', defaultValue: [0.0, 0.0, 0.0] },\n    angularVelocity: { label: 'Angular Velocity', type: 'Vec3', defaultValue: [0.0, 0.0, 0.0] },\n    linearSleepingThreshold: { label: 'Linear Sleep Threshold', type: 'Number', defaultValue: 0.8, minValue: 0.0, step: 0.1 },\n    angularSleepingThreshold: { label: 'Angular Sleep Threshold', type: 'Number', defaultValue: 1.0, minValue: 0.0, step: 0.1 },\n    friction: { label: 'Friction', type: 'Number', defaultValue: 0.5, minValue: 0.0, step: 0.1 },\n    rollingFriction: { label: 'Rolling Friction', type: 'Number', defaultValue: 0.0, minValue: 0.0, step: 0.1 },\n    restitution: { label: 'Bounce', type: 'Number', defaultValue: 0.0, minValue: 0.0, maxValue: 1.0, step: 0.1 },\n  },\n};\n\nexport default {\n  Default,\n  PolyMeshProperties,\n  MaterialProperties,\n  ImageProperties,\n  RigidBodyProperties,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Properties.js","const WebGLRenderer = {\n  schema: {\n    format: { type: 'Options', defaultValue: 'jpeg', values: ['jpeg', 'png'], labels: ['JPEG', 'PNG'], label: 'Output Format' },\n    v2renderer: { type: 'Boolean', defaultValue: false, label: 'v2 renderer' },\n  },\n};\n\nexport default { WebGLRenderer };\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Renderer.js","import * as THREE from 'three';\nimport { getLocalTransform } from '../modules/scene';\n\nconst Transform = {\n  schema: {\n    translation: { label: 'Translation', type: 'Vec3', step: 0.1, defaultValue: { x: 0, y: 0, z: 0 }, animatable: true },\n    rotation: { label: 'Rotation', type: 'Vec3', step: 1.0, defaultValue: { x: 0, y: 0, z: 0 }, animatable: true },\n    scale: { label: 'Scale', type: 'Vec3', step: 0.01, defaultValue: { x: 1, y: 1, z: 1 }, animatable: true }, // Scale's step must be 0.01 as 1 percent\n    shear: { label: 'Shear', type: 'Vec3', step: 0.1, defaultValue: { x: 0, y: 0, z: 0 }, animatable: true },\n    rotateOrder: { label: 'Rotate Order', type: 'Options', display: 'Dropdown',\n      values: ['XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX'], defaultValue: 'ZYX', },\n    preRotation: { label: 'Pre-Rotation', type: 'Vec3', step: 1.0, defaultValue: { x: 0, y: 0, z: 0 } },\n    rotatePivotOffset: { label: 'Rotate Pivot Offset', type: 'Vec3', step: 0.1, defaultValue: { x: 0, y: 0, z: 0 } },\n    scalePivotOffset: { label: 'Scale Pivot Offset', type: 'Vec3', step: 0.1, defaultValue: { x: 0, y: 0, z: 0 } },\n    localRotatePivot: { label: 'Local Rotate Pivot', type: 'Vec3', step: 0.1, defaultValue: { x: 0, y: 0, z: 0 } },\n    localScalePivot: { label: 'Local Scale Pivot', type: 'Vec3', step: 0.1, defaultValue: { x: 0, y: 0, z: 0 } },\n  },\n\n  update: function (operator, primitive) {\n    primitive.transform = getLocalTransform(operator);\n  },\n};\n\nconst LookAt = {\n  schema: {\n    target: { label: 'LookAt Target', type: 'Plug', plug: 'Transform' },\n    orientation: { label: 'Orientation', type: 'Vec3', defaultValue: { x: 0, y: 0, z: 0 }, animatable: true },\n\n    lookAtAxis: { label: 'Look Axis', type: 'Options', display: 'Dropdown', defaultValue: 'Z',\n      labels: ['X', 'Y', 'Z'], values: ['X', 'Y', 'Z'], },\n    flipLookAtAxis: { label: 'Flip Look Axis', type: 'Boolean', defaultValue: true },\n\n    upAxis: { label: 'Up Axis', type: 'Options', display: 'Dropdown', defaultValue: 'Y',\n      labels: ['X', 'Y', 'Z'], values: ['X', 'Y', 'Z'], },\n    flipUpAxis: { label: 'Flip Up Axis', type: 'Boolean', defaultValue: false },\n  },\n};\n\nconst BoneTransform = {\n  schema: {\n    translation: { label: 'Translation', type: 'Vec3', step: 0.1, defaultValue: { x: 0, y: 0, z: 0 }, animatable: true },\n    rotation: { label: 'Rotation', type: 'Vec3', step: 1.0, defaultValue: { x: 0, y: 0, z: 0 }, animatable: true },\n    scale: { label: 'Scale', type: 'Vec3', step: 0.1, defaultValue: { x: 1, y: 1, z: 1 }, animatable: true },\n    rotateOrder: { label: 'Rotate Order', type: 'Options', display: 'Dropdown',\n      values: ['XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX'], defaultValue: 'ZYX', },\n    preRotation: { label: 'Pre-Rotation', type: 'Vec3', step: 1.0, defaultValue: { x: 0, y: 0, z: 0 } }, // hidden: true\n    rotateAxis: { label: 'Rotate Axis', type: 'Vec3', step: 1.0, defaultValue: { x: 0, y: 0, z: 0 } },\n  },\n\n  update: function (operator, primitive, { node }) {\n    const { translation, rotation, scale, rotateOrder, preRotation, rotateAxis } = operator;\n    if (scale.x === 0) scale.x = 0.0000001;\n    if (scale.y === 0) scale.y = 0.0000001;\n    if (scale.z === 0) scale.z = 0.0000001;\n\n    const translationM = new THREE.Matrix4().makeTranslation(translation.x, translation.y, translation.z);\n    const rotationRadians = new THREE.Vector3().copy(rotation).multiplyScalar(Math.PI / 180);\n    const rotationM = new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(rotationRadians.x, rotationRadians.y, rotationRadians.z, 'ZYX'));\n    const shearM = new THREE.Matrix4();\n    const scaleM = new THREE.Matrix4().makeScale(scale.x, scale.y, scale.z);\n\n    const preRotationRadians = new THREE.Vector3().copy(preRotation).multiplyScalar(Math.PI / 180);\n    const lPreRotationM = new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(preRotationRadians.x, preRotationRadians.y, preRotationRadians.z, 'ZYX'));\n\n    const rotateAxisRadians  = new THREE.Vector3().copy(rotateAxis).multiplyScalar(Math.PI / 180);\n    const lPostRotationM = new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(rotateAxisRadians.x, rotateAxisRadians.y, rotateAxisRadians.z, 'ZYX'));\n\n    primitive.transform = new THREE.Matrix4().multiply(translationM).multiply(lPreRotationM).multiply(rotationM).multiply(lPostRotationM).multiply(scaleM);\n  },\n\n};\n\nexport default { Transform, BoneTransform, LookAt };\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/Transform.js","\n// shared:\n//\nexport const LOAD_SCENE = 'LOAD_SCENE';\nexport const ADD_NODE = 'ADDNODE';\nexport const ADD_VR_CAMERA = 'ADD_VR_CAMERA';\nexport const SET_VR_CAMERA = 'SET_VR_CAMERA';\nexport const DELETE_NODE = 'DELETE_NODE';\nexport const LOADING_FILE = 'LOADING_FILE';\nexport const LOADED_FILE = 'LOADED_FILE';\nexport const LOADING_FILE_ERROR = 'LOADING_FILE_ERROR';\nexport const CLEAR_SCENE = 'CLEAR_SCENE';\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/actionTypes.js","import * as THREE from 'three';\nimport { isSceneLoaded } from '../sceneIO';\nimport { lookupOperator } from '../../operators/nonImmutable';\n\nlet doLog = false;\nfunction log(...args) {\n  if (doLog) console.log(...args);\n}\n\nexport function updateReferenceList({ from, to }, nodeId, plugName, opIdx, key, refs) {\n  const refKey = JSON.stringify([nodeId, plugName, opIdx, key]);\n  const existingRefs = to[refKey];\n  if (existingRefs) {\n    for (let existingRefId of existingRefs) {\n      if (refs.indexOf(existingRefId) === -1) {\n        delete from[existingRefId][refKey];\n        if (!Object.keys(from[existingRefId]).length) {\n          delete from[existingRefId];\n        }\n      }\n    }\n  }\n\n  for (let refId of refs) {\n    if (!from[refId]) from[refId] = {};\n    from[refId][refKey] = true;\n  }\n\n  to[refKey] = refs;\n};\n\n//\n// refKey = JSON.stringify([nodeId,plugName,opIdx]);\n// from: { [fileId]:  refKey },\n// from: { [refId]:  { [refKey}: refPlug } }\n// to:  { [refKey]: fileId },\n//\nexport function updateReference(sceneGraph, { from, to }, nodeId, plugName, opIdx, key, op, refPlug) {\n  let refId = op[key];\n  if (refId && sceneGraph && !sceneGraph.nodes[refId]) {\n    console.warn('No reference to:', refId, 'from', nodeId, plugName, opIdx, key);\n    op[key] = refId = null;\n  }\n\n  const refKey = JSON.stringify([nodeId, plugName, opIdx, key]);\n  const existingRef = to[refKey];\n  if (existingRef) {\n    if (existingRef !== refId) {\n      delete from[existingRef][refKey];\n      if (refId) {\n        if (!from[refId]) from[refId] = {};\n        from[refId][refKey] = refPlug || true;\n        to[refKey] = refId;\n      } else {\n        if (!Object.keys(from[existingRef]).length) {\n          delete from[existingRef];\n        }\n\n        delete to[refKey];\n      }\n    }\n  } else if (refId) {\n    if (!from[refId]) from[refId] = {};\n    from[refId][refKey] = refPlug || true;\n    to[refKey] = refId;\n  }\n};\n\nexport function evaluateSceneGraph(store, sceneId, sceneGraph) {\n  let start = new Date();\n  let i = 0;\n  let id = null;\n\n  const sceneNodeIds = Object.keys(sceneGraph.nodes);\n  const evaluatedNodeIds = Object.keys(sceneGraph.evaluatedNodes);\n  const { from, to } = sceneGraph.nodeReferences;\n\n  // First evaluation after sceneGraph is loaded\n  const transitionToLoaded = !sceneGraph.loaded && isSceneLoaded(store);\n  if (!sceneGraph.loaded) sceneGraph.loaded = transitionToLoaded;\n\n  const worldTransforms = {};\n  const toUpdate = {};\n  const toDelete = {};\n  const updating = {};\n  const nodeUpdates = {};\n\n  function getEvaluated(id, plug) {\n    if (updating[id] && !nodeUpdates[id]) {\n      console.error('Circular reference, updating', sceneGraph.nodes[id].name);\n      throw new Error('Circular reference: ' + id);\n    }\n\n    if (toUpdate[id] && !updating[id]) updateNode(id, toUpdate[id]);\n\n    //addReference(id, {id: nodeId, sourcePlug, destPlug}, toPlugKey(destPlug, opIndex, fromKey));\n    let result = nodeUpdates[id] || sceneGraph.evaluatedNodes[id];\n    if (plug) result = result && result[plug];\n    return result;\n  }\n\n  function getWorldTransform(id) {\n    if (worldTransforms[id]) return worldTransforms[id];\n\n    if (toUpdate[id] && !updating[id]) updateNode(id, toUpdate[id]);\n    const localTransform = getEvaluated(id, 'Transform');\n    if (!localTransform) return null;\n\n    const node = sceneGraph.nodes[id];\n    const parent = node && node.parent;\n    const parentTransform = parent && getWorldTransform(parent);\n\n    worldTransforms[id] = parentTransform\n      ? new THREE.Matrix4().copy(parentTransform).multiply(localTransform.transform)\n      : new THREE.Matrix4().copy(localTransform.transform);\n    return worldTransforms[id];\n  }\n\n  function updateNode(id, updatePlug) {\n    const node = sceneGraph.nodes[id];\n\n    let evalNode = sceneGraph.evaluatedNodes[id];\n    if (!evalNode) {\n      evalNode = sceneGraph.evaluatedNodes[id] = { name: node.name, _ev: 0, plugs: [] };\n      if (node.plugs.Properties) evalNode.plugs.push('Properties');\n      if (node.plugs.Transform) evalNode.plugs.push('Transform');\n      for (let plug of Object.keys(node.plugs)) {\n        if (plug !== 'Properties' && plug !== 'Transform') evalNode.plugs.push(plug);\n      }\n    }\n\n    nodeUpdates[id] = evalNode;\n    //console.log('evaluateSceneGraph::updateNode', node.name, updatePlug);\n    updating[id] = true;\n\n    let nodeEvaluatedVersion = 0;\n\n    function doUpdatePlug(plug) {\n      //console.log('  - ', plug);\n      const ops = node.plugs[plug];\n      const previousResult = evalNode[plug];\n      const previousVersion = previousResult ? previousResult._v  : 0;\n\n      evalNode[plug] = ops.reduce((result, op, idx) => {\n\n        let operator = lookupOperator(plug, op.type, []);\n        for (let key of operator.fileReferenceKeys) {\n          updateReference(null, sceneGraph.fileReferences, id, plug, idx, key, op);\n        }\n\n        for (let key of operator.nodeReferenceKeys) {\n          updateReference(sceneGraph, sceneGraph.nodeReferences, id, plug, idx, key, op);\n        }\n\n        let plugs = {};\n        for (let key of Object.keys(operator.plugReferences)) {\n          updateReference(sceneGraph, sceneGraph.nodeReferences, id, plug, idx, key, op, operator.plugReferences[key]);\n          if (op[key]) plugs[key] = getEvaluated(op[key], operator.plugReferences[key]);\n        }\n\n        for (let key of operator.nodeReferenceListKeys) {\n          updateReferenceList(sceneGraph.nodeReferences, id, plug, idx, key, op[key]);\n        }\n\n        if (operator.environment) {\n          updateReference(sceneGraph, sceneGraph.nodeReferences, id, plug, idx, 'environment', { environment: sceneId }, 'Environment');\n          plugs.environment = getEvaluated(sceneId, 'Environment');\n        }\n\n        return operator.update(Object.assign({}, op, plugs), result, {\n          sceneId,\n          node,\n          store,\n          properties: evalNode.Properties,\n          getWorldTransform,\n          previousResult,\n          loaded: sceneGraph.loaded,\n        });\n      }, {});\n\n      evalNode[plug]._v = previousVersion + 1;\n    }\n\n    for (let plug of evalNode.plugs) {\n      if (updatePlug === true || updatePlug === plug) doUpdatePlug(plug);\n      nodeEvaluatedVersion += evalNode[plug]._v;\n    }\n\n    evalNode._v = node._v;\n    evalNode._ev = nodeEvaluatedVersion;\n\n    delete updating[id];\n    delete toUpdate[id];\n  };\n\n  for (let id of sceneNodeIds) {\n    if (!sceneGraph.evaluatedNodes[id] || sceneGraph.evaluatedNodes[id]._v !== sceneGraph.nodes[id]._v) {\n      toUpdate[id] = true;\n    }\n  }\n\n  for (let id of evaluatedNodeIds) {\n    if (!sceneGraph.nodes[id]) {\n      toDelete[id] = true;\n    }\n  }\n\n  if (transitionToLoaded) {\n    for (let id of sceneNodeIds) {\n      let evalNode = sceneGraph.evaluatedNodes[id];\n      if (evalNode && evalNode.Properties && evalNode.Properties.prefetch) {\n        toUpdate[id] = sceneGraph.nodes[id].type;\n      }\n    }\n  }\n\n  function needsUpdateReference(refId, fromPlug) {\n    if (from[refId]) {\n      for (let refKey of Object.keys(from[refId])) {\n        const refPlug = from[refId][refKey];\n        const [nodeId, plugName, opIdx, key] = JSON.parse(refKey);\n        //console.log(' - ref ', sceneGraph.nodes[nodeId].name, '-', plugName, '-', key, 'fromPlug: ', toUpdate[nodeId]);\n\n        if (!fromPlug || refPlug === true || refPlug === fromPlug) {\n          if (!toUpdate[nodeId]) {\n            toUpdate[nodeId] = plugName;\n            needsUpdateReference(nodeId, plugName);\n          } else if (toUpdate[nodeId] !== plugName) {\n            toUpdate[nodeId] = true;\n            needsUpdateReference(nodeId, plugName);\n          }\n        }\n      }\n    }\n  }\n\n  for (let id of Object.keys(toUpdate)) {\n    if (from[id]) needsUpdateReference(id);\n  }\n\n  for (let id of Object.keys(toDelete)) {\n    delete sceneGraph.evaluatedNodes[id];\n  }\n\n  // console.log('evalSceneGraph updating: ', Object.keys(toUpdate).length);\n  for (let id of Object.keys(toUpdate)) {\n    if (toUpdate[id]) updateNode(id, toUpdate[id]);\n  }\n\n  //if (nowLoaded) evalSceneGraph.loaded = true;\n\n  // Store the current files and sceneGraph used to calculate evalSceneGraph\n  //console.log('Update scene graph in: ', new Date() - start);\n\n  sceneGraph._ev = sceneGraph._v;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/utils/evalSceneGraph.js","import { Map, List } from 'immutable';\nimport createReducer from './utils/createReducer';\nimport { curry, forEach, map, mapObjIndexed, omit } from 'ramda';\nimport { addNode, getEvalSceneGraph } from './sceneGraph';\nimport { fetchText, addFile, getActiveAssets } from './assets';\nimport { addClip } from './animation';\nimport { LOAD_SCENE, LOADING_FILE, LOADED_FILE, LOADING_FILE_ERROR, CLEAR_SCENE } from './actionTypes';\n\n/**\n * Loading, reading, exporting of the scene.\n *\n * @module sceneIO\n * @public\n */\n\nconst USE_SCENE = 'USE_SCENE';\nconst LOADING_SCENEGRAPH = 'LOADING_SCENEGRAPH';\nconst LOADED_SCENEGRAPH = 'LOADED_SCENEGRAPH';\nconst ERROR_LOADING_SCENEGRAPH = 'ERROR_LOADING_SCENEGRAPH';\nconst RENDERING_SCENE = 'RENDERING_SCENE';\nconst RENDERED_SCENE = 'RENDERED_SCENE';\nconst PRELOADING_SCENE='PRELOADING_SCENE';\nconst PRELOADED_SCENE = 'PRELOADED_SCENE';\nconst LOADED_SCENE = 'LOADED_SCENE';\nconst SCENE_ERROR = 'SCENE_ERROR';\nconst PRELOAD_COMMAND = 'PRELOAD_COMMAND';\n\nexport const SCENE_PHASES = {\n  FAILED: -1,\n  UNKNOWN: 0,\n  LOADING_SCENEGRAPH: 1,\n  LOADED_SCENEGRAPH: 2,\n  RENDERING: 3,\n  PRELOADING: 4,\n  PRELOADED: 5,\n  LOADED: 6,\n  RENDERED: 7,\n};\n\nconst initialState = Map({\n  id: null,       // Active scene id\n  errors: List(), // List of scene errors\n  phase: SCENE_PHASES.UNKNOWN,\n  progress: 0,\n  loadingFiles: Map(),\n  loadedFiles: Map(),\n  loaded: false,\n  preloadCommands: List(),\n});\n\nfunction setProgress(state, createEvent) {\n  if (state.get('phase') !== SCENE_PHASES.RENDERING) return state;\n\n  const loadingFiles = state.get('loadingFiles').size;\n  const loadedFiles = state.get('loadedFiles').size;\n  const totalFiles = loadingFiles + loadedFiles;\n  const progress = totalFiles === 0 ? 1 : (1 + loadedFiles / totalFiles) / 2;\n  //console.log('progress: ', loadingFiles, loadedFiles, progress);\n\n  if (progress < 1) {\n    createEvent('loading', progress);\n    return state.set('progress', progress);\n  }\n\n  createEvent('loading', 1);\n  return state.set('progress', 1);\n};\n\nconst reducer = createReducer(initialState, {\n  [USE_SCENE](state, id) {\n    return state.set('id', id);\n  },\n\n  [LOADING_SCENEGRAPH](state, id) {\n    const hasActiveScene = state.get('loaded') || (state.get('id') && state.get('id') !== id);\n    return hasActiveScene ? state : state.set('phase', SCENE_PHASES.LOADING_SCENEGRAPH).set('progress', 1 / 4);\n  },\n\n  [LOADED_SCENEGRAPH](state, id) {\n    const hasActiveScene = state.get('loaded') || (state.get('id') && state.get('id') !== id);\n    return hasActiveScene ? state : state.set('phase', SCENE_PHASES.LOADED_SCENEGRAPH).set('progress', 1 / 2);\n  },\n\n  [ERROR_LOADING_SCENEGRAPH](state, xhr, { action }) {\n    const { error } = action;\n    const msg = `Error Loading Scene: ${error.status} ${error.statusText}`; //' + (error && error.response ? ': '+error.response : '');\n    return state.updateIn(['errors'], List(), list => list.push(msg));\n  },\n\n  [RENDERING_SCENE](state, payload, { createEvent }) {\n    return setProgress(state.set('phase', SCENE_PHASES.RENDERING), createEvent);\n  },\n\n  [LOADING_FILE](state, id) {\n    return state.setIn(['loadingFiles', id], true);\n  },\n\n  [LOADED_FILE](state, id, { createEvent }) {\n    return setProgress(state.deleteIn(['loadingFiles', id]).setIn(['loadedFiles', id], true), createEvent);\n  },\n\n  [LOADING_FILE_ERROR](state, id, { createEvent }) {\n    return setProgress(state.deleteIn(['loadingFiles', id]), createEvent);\n  },\n\n  [PRELOADING_SCENE](state, _, {createEvent}) {\n    createEvent('preloading');\n    return state.set('phase', SCENE_PHASES.PRELOADING);\n  },\n\n  [PRELOADED_SCENE](state, _, {createEvent}) {\n    createEvent('preloaded');\n    return state.set('phase', SCENE_PHASES.PRELOADED);\n  },\n\n  [PRELOAD_COMMAND](state, fn) {\n    return state.updateIn(['preloadCommands'], List(), list => list.push(fn));\n  },\n\n  [LOADED_SCENE](state, _, { createEvent }) {\n    createEvent('loaded');\n    return state.set('loaded', true).set('phase', SCENE_PHASES.LOADED);\n  },\n\n  [RENDERED_SCENE](state, _, { createEvent }) {\n    createEvent('rendered');\n    return state.set('phase', SCENE_PHASES.RENDERED);\n  },\n\n  [SCENE_ERROR](state, msg) {\n    return state.updateIn(['errors'], List(), list => list.push(msg));\n  },\n\n  [CLEAR_SCENE](state) {\n    return initialState;\n  },\n});\n\nconst apiRoot = __URLROOT__ + '/api';\n\nexport function reportError(msg) {\n  return { type: SCENE_ERROR, payload: msg };\n}\n\n/**\n * sets the active scene.\n *\n * @param {string} id the scene uuid\n */\nexport function useScene(id) {\n  return { type: USE_SCENE, payload: id };\n}\n\n\n/**\n * Returns the active scene Id\n *\n * @public\n * @returns {uuid}\n *\n */\nexport function getSceneId(store) {\n  return store.getIn(['sceneIO', 'id']);\n};\n\n/**\n * Loads the published scene\n *\n * @public\n * @param {string} id the scene uuid.\n * @param {string} transitString the published, exported scene\n * @returns {Promise}\n *\n */\nexport function loadScene(id, transitString, loadTime) {\n  return (store) => {\n    const payload = store.read(transitString);\n    store.logPageView(`/player/v2/${id}`, loadTime);\n    return store.dispatch({ type: LOAD_SCENE, payload });\n  };\n}\n\nexport function errorLoadingScene(id) {\n  return reportError('Error Loading Scene');\n}\n\nexport function markRenderingScene() {\n  return { type: RENDERING_SCENE };\n}\n\nexport function markRenderedScene() {\n  return { type: RENDERED_SCENE };\n}\n\nconst LOAD_SLOW_THRESHOLD = 5000;\nconst LOAD_FAIL_THRESHOLD = 15000;\n\n/**\n * Fetch the scene\n *\n * If `hash` is provided it will fetch directly from resources, otherwise it will fetch from\n * `/api/scenes/:uuid/published`. By default, it will fetch the latest published version. If you\n *  wish to ensure you are fetching the latest scene version, set `waitForPublish: true`.\n *\n *  @public\n *  @param {uuid} sceneId\n *  @param {String} hash - md5 hash of published content (Optional)\n *  @param {Object} options\n *  @param {Boolean} options.waitForPublish Wait for the latest scene version to be published (default false);\n *\n */\nexport function fetch(sceneId, hash, options = {}) {\n  const startTime = new Date();\n  const wait = options.waitForPublish;\n\n  return (store) => {\n    if (store.getIn(['sceneGraph', sceneId])) return Promise.resolve(true);\n\n    const fetch = hash ?\n      fetchText(hash)(store) :\n      store.callApi({\n        contentType: 'text',\n        types: [LOADING_SCENEGRAPH, LOADED_SCENEGRAPH, ERROR_LOADING_SCENEGRAPH],\n        url: `${apiRoot}/scenes/${sceneId}/published?wait=${wait ? 'true' : 'false'}`,\n        queryKey: 'SCENE' + sceneId,\n        payload: sceneId,\n      });\n\n    let slowLoadTimeout = setTimeout(() => {\n      store.error(new Error('Slow Load'), null, { sceneId: sceneId });\n    }, LOAD_SLOW_THRESHOLD);\n\n    let loadFailureTimeout = setTimeout(() => {\n      store.error(new Error('Load Failure'), null, { sceneId: sceneId });\n    }, LOAD_FAIL_THRESHOLD);\n\n    const promise = fetch.then((transit) => {\n      clearTimeout(slowLoadTimeout);\n      clearTimeout(loadFailureTimeout);\n      return store.dispatch(loadScene(sceneId, transit, new Date() - startTime));\n    });\n\n    return promise;\n  };\n};\n\nexport function savePublished() {\n  return (store) => {\n    const transit = writeScene(store);\n    const sceneId = getSceneId(store);\n\n    return store.callApi({\n      contentType: 'text',\n      url: `${apiRoot}/scenes/${sceneId}/published`,\n      method: 'PUT',\n      body: JSON.stringify({ content: transit }),\n    });\n  };\n}\n\n/**\n * Fetch, Load and Use published scene\n *\n * If `hash` is provided it will fetch directly from resources, otherwise it will fetch from\n * `/api/scenes/:uuid/published`.\n *\n *  @public\n *  @param {uuid} sceneId\n *  @param {String} hash - md5 hash of published content (Optional)\n *  @param {Object} options\n *  @param {Boolean} options.waitForPublish Wait for the latest scene version to be published (default false);\n *\n */\nexport function fetchAndUse(sceneId, hash, options = {}) {\n  return (store) => {\n    return store.dispatch(fetch(sceneId, hash, options)).then(\n      () => store.dispatch(useScene(sceneId))\n    );\n  };\n};\n\nexport function loadingProgress({ getIn, dispatch }) {\n  return getIn(['sceneIO', 'progress']);\n};\n\n/*\n * Have preloaded commands run, and are all assets loaded\n */\nexport function areAssetsLoaded(store) {\n  return store.getIn(['sceneIO', 'phase']) >= SCENE_PHASES.PRELOADED && store.getIn(['sceneIO', 'loadingFiles']).size === 0;\n}\n\n\n/*\n * Are all assets loaded before preload commands are run\n */\nexport function areAssetsPreloaded(store) {\n  return store.getIn(['sceneIO', 'phase']) >= SCENE_PHASES.RENDERING && store.getIn(['sceneIO', 'loadingFiles']).size === 0;\n}\n\nexport function isSceneLoaded(store) {\n  return store.getIn(['sceneIO', 'loaded']);\n}\n\nexport function isSceneRendered(store) {\n  return store.getIn(['sceneIO', 'phase']) >= SCENE_PHASES.RENDERED;\n}\n\nexport function markPreloaded() {\n  return (store) => {\n    const preloadCommands = store.getIn(['sceneIO', 'preloadCommands']);\n    if (!preloadCommands.size) return store.dispatch({ type: PRELOADED_SCENE });\n\n    store.dispatch({ type: PRELOADING_SCENE });\n\n    Promise.all(preloadCommands.map((fn) => {\n      return Promise.resolve(fn());\n    }).toArray()).then(() => {\n      store.dispatch({ type: PRELOADED_SCENE });\n    }).catch((err) => {\n      console.log('Caught plugin error: ', err.message);\n      console.log('Caught plugin error, stack: ', err.stack);\n      store.dispatch({ type: PRELOADED_SCENE });\n    });\n  };\n}\n\nexport function preloadCommand(fn) {\n  return { type: PRELOAD_COMMAND, payload: fn };\n}\n\nexport function markLoaded() {\n  return { type: LOADED_SCENE };\n}\n\nexport function markLoadingFile(id) {\n  return { type: LOADING_FILE, payload: id };\n};\n\nexport function markLoadedFile(id) {\n  return { type: LOADED_FILE, payload: id };\n};\n\nfunction convertPlugs(plugArray) {\n  const plugs = {};\n  plugArray.forEach((plug) => {\n    plugs[plug.type] = plug.operators.map((op) => {\n      let name = op.name;\n      let type = op.type || name;\n      return [type, omit(['_id', 'primitive', 'name', 'type'], op), name];\n    });\n  });\n  return plugs;\n};\n\nconst convertNode = curry(function (store, sceneJSON, parent, json) {\n  const id = json._id;\n  const name = json.name;\n  const type = json.type;\n\n  const plugs = convertPlugs(json.plugs);\n\n  store.dispatch(addNode({ id, name, type, plugs, parent }));\n\n  forEach(convertNode(store, sceneJSON, id), json.nodes);\n});\n\nfunction convertFiles(store, files) {\n  forEach((file) => {\n    store.dispatch(addFile(Object.assign({ id: file._id }, omit(['_id', '__v'], file))));\n  }, files);\n}\n\nexport function convertFromJSON(store, json) {\n  convertNode(store, json, null, json);\n  convertFiles(store, json.files);\n\n  mapObjIndexed((clip, id) => {\n    store.dispatch(addClip(clip, id));\n  }, json.clips);\n};\n\nexport function writeScene(store) {\n  const sceneGraph = getEvalSceneGraph(store);\n\n  return store.write({\n    nodes: JSON.stringify(sceneGraph.nodes),\n    assets: getActiveAssets(store),\n    clips: store.getIn(['animation', 'clips']),\n  });\n}\n\nexport function exportJSON(store) {\n  return {\n    scene: store.get('sceneGraph').toJS(),\n    assets: getActiveAssets(store).toJS(),\n  };\n}\n\nexport function numErrors(store) {\n  return store.getIn(['sceneIO', 'errors']).size;\n}\n\nexport function getErrors(store) {\n  return store.getIn(['sceneIO', 'errors']);\n}\n\nexport function getScenePhase(store) {\n  return store.getIn(['sceneIO', 'phase']);\n}\n\n\n/**\n *  Clears current scene\n *\n *  @public\n *  @returns {Promise}\n */\nexport function clearScene() {\n  return { type: CLEAR_SCENE };\n}\n\nconst publicApi = {\n  reducer,\n  actions: { fetch, fetchAndUse, loadScene, useScene, reportError, preloadCommand, savePublished, clearScene },\n  selectors: { isSceneLoaded, isSceneRendered, loadingProgress, getErrors, numErrors, getSceneId, writeScene },\n};\nexport default publicApi;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/sceneIO.js","import isPlainObject from './isPlainObject';\nimport { withRecords } from './transitImmutable';\nimport rsvp from 'rsvp';\n\nlet raf, rafContext;\n\nfunction setRequestAnimationFrame(newRequestAnimationFrame, context) {\n  if (newRequestAnimationFrame) {\n    raf = newRequestAnimationFrame;\n    rafContext = context;\n  } else {\n    raf = __BROWSER__ ? requestAnimationFrame : setImmediate;\n    rafContext = __BROWSER__ ? window : this;\n  }\n}\n\nsetRequestAnimationFrame();\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nexport var ActionTypes = {\n  INIT: '@@redux/INIT',\n};\n\n/**\n * Creates a Redux store that holds the state tree.\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [initialState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\nexport default function createStore(reducer, initialState, enhancer) {\n  if (typeof initialState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = initialState;\n    initialState = undefined;\n  }\n\n  if (typeof enhancer === 'function') {\n    return enhancer(createStore)(reducer, initialState);\n  }\n\n  let transitInstance;\n  let currentReducer = reducer;\n  let currentState = initialState;\n  const listeners = [];\n  const events = [];\n  let isDispatching = false;\n  let records = [];\n  let rollbar = false;\n  let currentTranslator = null;\n  let currentNavigator = null;\n  let apiFunction = null;\n\n  function createEvent(type, ...args) {\n    events.push({ type, args });\n  }\n\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n  function getState() {\n    return currentState;\n  }\n\n  function getIn(path) {\n    return currentState.getIn(path);\n  }\n\n  function get(key) {\n    return currentState.get(key);\n  }\n\n  function getTranslator() {\n    return currentTranslator;\n  };\n\n  function setTranslator(translator) {\n    currentTranslator = translator;\n  };\n\n  function setApi(api) {\n    apiFunction = api;\n  };\n\n  function hasApi() {\n    return !!apiFunction;\n  };\n\n  function callApi(...args) {\n    return apiFunction(this, ...args);\n  };\n\n  function logPageView(path, loadTime) {\n    if (!__BROWSER__ || !__GOOGLE_ANALYTICS_TOKEN__) return;\n\n    const url = `https://www.google-analytics.com/collect?v=1&tid=${__GOOGLE_ANALYTICS_TOKEN__}` +\n     `&cid=555&t=pageview&dh=${encodeURI(window.location.hostname)}` +\n     `&dt=${encodeURI(document.title)}&dp=${encodeURI(path)}` + (loadTime ? `&plt=${loadTime}` : '');\n\n    store.callApi({ contentType: 'text', method: 'POST', url }).catch((e) => {\n      // console.log('Ignore api errors from ga');\n    });\n  }\n\n  /**\n   * Adds 'Record' types required for reading/writing transit format.\n   */\n  function addRecords(newRecords) {\n    records = records.concat(newRecords);\n  };\n\n  function initTransit() {\n    transitInstance = withRecords(records, 'NoneNoOp');\n  };\n\n  function read(transitString) {\n    if (!transitInstance) initTransit();\n    return transitInstance.fromJSON(transitString);\n  };\n\n  function write(data) {\n    if (!transitInstance) initTransit();\n    return transitInstance.toJSON(data); //sceneGraph: Map(), files: Map()});\n  };\n\n  function useRollbar(rb) {\n    rollbar = rb;\n  };\n\n  function error(err, label, data={}) {\n    if (label) console.error(label);\n    if (rollbar) {\n      rollbar.error(err, data);\n      if (err.message) {\n        console.error(err.message);\n        if (err.stack) console.log(err.stack);\n      } else {\n        console.error(err);\n      }\n    } else {\n      throw err;\n    }\n  };\n\n  rsvp.on('error', error);\n\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n  function subscribe(listener) {\n    listeners.push(listener);\n    var isSubscribed = true;\n\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      isSubscribed = false;\n      var index = listeners.indexOf(listener);\n      listeners.splice(index, 1);\n    };\n  }\n\n  // Custom debounce function, lodash.debounce is bigger and slower.\n  function batchNotify() {\n    var notifying = false;\n    var requestNotify = false;\n\n    function notify() {\n      if (notifying) {\n        requestNotify = true;\n      } else {\n        notifying = true;\n        requestNotify = false;\n\n        raf.call(rafContext, () => {\n          // Actual notify code\n          try {\n            var evs = events.splice(0, events.length);\n            listeners.slice().forEach(listener => listener(evs));\n          } catch (e) {\n            error(e);\n          }\n\n          notifying = false;\n          if (requestNotify) {\n            notify();\n          }\n        });\n      }\n    }\n\n    return notify;\n  }\n\n  const notifyListenersBatched = batchNotify();\n\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error(\n        'Actions must be plain objects. ' +\n        'Use custom middleware for async actions.'\n      );\n    }\n\n    if (typeof action.type === 'undefined') {\n      console.error('Invalid action: ', action);\n      throw new Error(\n        'Actions may not have an undefined \"type\" property. ' +\n        'Have you misspelled a constant?'\n      );\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action, createEvent);\n    } catch (e) {\n      error(e);\n    } finally {\n      isDispatching = false;\n    }\n\n    notifyListenersBatched();\n    // listeners.slice().forEach(listener => listener())\n\n    return rsvp.Promise.resolve(action.resolve ? action.resolve : action.payload);\n  }\n\n\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n  function replaceReducer(nextReducer) {\n    currentReducer = nextReducer;\n    dispatch({ type: ActionTypes.INIT });\n  }\n\n  // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n  dispatch({ type: ActionTypes.INIT });\n\n  const store = {\n    dispatch,\n    subscribe,\n    getState,\n    getIn,\n    get,\n    replaceReducer,\n    setTranslator,\n    getTranslator,\n    addRecords,\n    read,\n    write,\n    useRollbar,\n    error,\n    setApi,\n    hasApi,\n    callApi,\n    createEvent,\n    setRequestAnimationFrame,\n    logPageView,\n  };\n\n  return store;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/createStore.js","module.exports = { \"default\": require(\"core-js/library/fn/set-immediate\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/set-immediate.js\n// module id = 284\n// module chunks = 0 1 2","require('../modules/web.immediate');\nmodule.exports = require('../modules/_core').setImmediate;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/set-immediate.js\n// module id = 285\n// module chunks = 0 1 2","var $export = require('./_export')\n  , $task   = require('./_task');\n$export($export.G + $export.B, {\n  setImmediate:   $task.set,\n  clearImmediate: $task.clear\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/web.immediate.js\n// module id = 286\n// module chunks = 0 1 2","// Modified from:\n// https://github.com/thomasboyt/transit-immutable-js/blob/records-support/index.js\n\n// With changes:\n//  * Records can't simply be serialized with 'toJS', since\n//    records may contain other composite types.\n//  * Serialize with array for efficiency.\n//  * Build records into an object first instead of using 'asMutable',\n//    due to weird bug with 'id' containing records.\n\nimport transit from 'transit-js';\nimport Immutable from 'immutable';\n\nfunction createReader(recordMap, defaultRecord) {\n  return transit.reader('json', {\n    mapBuilder: {\n      init: function () {\n        return {};\n      },\n\n      add: function (m, k, v) {\n        m[k] = v;\n        return m;\n      },\n\n      finalize: function (m) {\n        return m;\n      },\n    },\n    handlers: {\n      iM: function (v) {\n        var o = {};\n        for (var i = 0; i < v.length; i += 2) {\n          o[v[i]] = v[i + 1];\n        }\n\n        return new Immutable.Map(o);\n      },\n\n      iL: function (v) {\n        return Immutable.List(v);\n      },\n\n      iR: function (v) {\n        var Record = recordMap[v[0]];\n        if (!Record) {\n          var msg = ('Tried to deserialize Record type named `' + v[0] + '`, ' +\n                     'but no type with that name was passed to withRecords()');\n          if (defaultRecord) {\n            if (console) console.error(msg);\n            return new recordMap[defaultRecord]();\n          } else {\n            throw new Error(msg);\n          }\n        }\n\n        var o = {};\n        for (var i = 1; i < v.length; i += 2) {\n          o[v[i]] = v[i + 1];\n        }\n\n        return new Record(o);\n      },\n    },\n  });\n\n}\n\nvar reader = createReader([]);\nvar writer = createWriter(false, []);\n\nexport function toJSON(data) {\n  return writer.write(data);\n}\n\nexport function fromJSON(data) {\n  return reader.read(data);\n}\n\nexport function withFilter(predicate) {\n  var filteredWriter = createWriter(predicate, []);\n  return {\n    toJSON: function (data) {\n      return filteredWriter.write(data);\n    },\n\n    fromJSON: fromJSON,\n  };\n}\n\nexport function withRecords(records, defaultRecord, predicate) {\n  var recordMap = {};\n\n  records.forEach(function (RecordType) {\n    var rec = new RecordType({});\n\n    if (!rec._name) {\n      throw new Error('Cannot (de)serialize Record() without a name field');\n    }\n\n    recordMap[rec._name] = RecordType;\n  });\n\n  var recordWriter = createWriter(predicate, recordMap);\n  var recordReader = createReader(recordMap, defaultRecord);\n\n  return {\n    toJSON: function (data) {\n      return recordWriter.write(data);\n    },\n\n    fromJSON: function (data) {\n      return recordReader.read(data);\n    },\n  };\n}\n\nfunction createWriter(predicate, recordMap) {\n  var handlers = transit.map([\n    Immutable.Map, transit.makeWriteHandler({\n      tag: function () {\n        return 'iM';\n      },\n\n      rep: function (m) {\n        var i = 0, a = new Array(2 * m.size);\n        if (predicate) {\n          m = m.filter(predicate);\n        }\n\n        m.forEach(function (v, k) {\n          a[i++] = k;\n          a[i++] = v;\n        });\n\n        return a;\n      },\n    }),\n    Immutable.List, transit.makeWriteHandler({\n      tag: function () {\n        return 'iL';\n      },\n\n      rep: function (v) {\n        if (predicate) {\n          v = v.filter(predicate);\n        }\n\n        return v.toArray();\n      },\n    }),\n    Function, transit.makeWriteHandler({\n      tag: function () {\n        return '_';\n      },\n\n      rep: function () {\n        return null;\n      },\n    }),\n  ]);\n\n  Object.keys(recordMap).forEach(function (name) {\n    handlers.set(recordMap[name], makeRecordHandler(name, recordMap[name], predicate));\n  });\n\n  return transit.writer('json', {\n    handlers: handlers,\n  });\n}\n\nfunction makeRecordHandler(name, Record, predicate) {\n  var rec = new Record();\n  return transit.makeWriteHandler({\n    tag: function () {\n      return 'iR';\n    },\n\n    rep: function (m) {\n      var i = 0, a = new Array(); //2 * m.size + 1);\n      a.push(name); //a[i++] = name;\n      if (predicate) {\n        m = m.filter(predicate);\n      }\n\n      m.forEach(function (v, k) {\n        let d = rec.get(k);\n        if (d !== v && !Immutable.is(d, v)) {\n          a.push(k); //a[i++] = k;\n          a.push(v); //a[i++] = v;\n        }\n      });\n\n      return a;\n    },\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/transitImmutable.js","// transit-js 0.8.837\n// http://transit-format.org\n//\n// Copyright 2014 Cognitect. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License..\n;(function(){var aa=this;\nfunction ba(a){var b=typeof a;if(\"object\"==b)if(a){if(a instanceof Array)return\"array\";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(\"[object Window]\"==c)return\"object\";if(\"[object Array]\"==c||\"number\"==typeof a.length&&\"undefined\"!=typeof a.splice&&\"undefined\"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable(\"splice\"))return\"array\";if(\"[object Function]\"==c||\"undefined\"!=typeof a.call&&\"undefined\"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable(\"call\"))return\"function\"}else return\"null\";else if(\"function\"==\nb&&\"undefined\"==typeof a.call)return\"object\";return b}function k(a,b){var c=a.split(\".\"),d=aa;c[0]in d||!d.execScript||d.execScript(\"var \"+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b};function l(a,b){this.v=a|0;this.j=b|0}var ca,da,ea,fa,ga,ia,ja={};function m(a){if(-128<=a&&128>a){var b=ja[a];if(b)return b}b=new l(a|0,0>a?-1:0);-128<=a&&128>a&&(ja[a]=b);return b}function n(a){isNaN(a)||!isFinite(a)?a=p():a<=-ka?a=q():a+1>=ka?(fa||(fa=r(-1,2147483647)),a=fa):a=0>a?t(n(-a)):new l(a%v|0,a/v|0);return a}function r(a,b){return new l(a,b)}\nfunction la(a,b){if(0==a.length)throw Error(\"number format error: empty string\");var c=b||10;if(2>c||36<c)throw Error(\"radix out of range: \"+c);if(\"-\"==a.charAt(0))return t(la(a.substring(1),c));if(0<=a.indexOf(\"-\"))throw Error('number format error: interior \"-\" character: '+a);for(var d=n(Math.pow(c,8)),e=p(),f=0;f<a.length;f+=8){var g=Math.min(8,a.length-f),h=parseInt(a.substring(f,f+g),c);8>g?(g=n(Math.pow(c,g)),e=w(e,g).add(n(h))):(e=w(e,d),e=e.add(n(h)))}return e}var v=4294967296,ka=v*v/2;\nfunction p(){ca||(ca=m(0));return ca}function x(){da||(da=m(1));return da}function ma(){ea||(ea=m(-1));return ea}function q(){ga||(ga=r(0,-2147483648));return ga}function na(){ia||(ia=m(16777216));return ia}function y(a){return a.j*v+(0<=a.v?a.v:v+a.v)}\nl.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error(\"radix out of range: \"+a);if(z(this))return\"0\";if(0>this.j){if(A(this,q())){var b=n(a),c=B(this,b),b=oa(w(c,b),this);return c.toString(a)+b.v.toString(a)}return\"-\"+t(this).toString(a)}for(var c=n(Math.pow(a,6)),b=this,d=\"\";;){var e=B(b,c),f=oa(b,w(e,c)).v.toString(a),b=e;if(z(b))return f+d;for(;6>f.length;)f=\"0\"+f;d=\"\"+f+d}};function z(a){return 0==a.j&&0==a.v}function A(a,b){return a.j==b.j&&a.v==b.v}\nfunction C(a,b){if(A(a,b))return 0;var c=0>a.j,d=0>b.j;return c&&!d?-1:!c&&d?1:0>oa(a,b).j?-1:1}function t(a){return A(a,q())?q():r(~a.v,~a.j).add(x())}l.prototype.add=function(a){var b=this.j>>>16,c=this.j&65535,d=this.v>>>16,e=a.j>>>16,f=a.j&65535,g=a.v>>>16,h;h=0+((this.v&65535)+(a.v&65535));a=0+(h>>>16);a+=d+g;d=0+(a>>>16);d+=c+f;c=0+(d>>>16);c=c+(b+e)&65535;return r((a&65535)<<16|h&65535,c<<16|d&65535)};function oa(a,b){return a.add(t(b))}\nfunction w(a,b){if(z(a)||z(b))return p();if(A(a,q()))return 1==(b.v&1)?q():p();if(A(b,q()))return 1==(a.v&1)?q():p();if(0>a.j)return 0>b.j?w(t(a),t(b)):t(w(t(a),b));if(0>b.j)return t(w(a,t(b)));var c=na();if(c=0>C(a,c))c=na(),c=0>C(b,c);if(c)return n(y(a)*y(b));var c=a.j>>>16,d=a.j&65535,e=a.v>>>16,f=a.v&65535,g=b.j>>>16,h=b.j&65535,Ia=b.v>>>16,ha=b.v&65535,M,u,H,Ja;Ja=0+f*ha;H=0+(Ja>>>16);H+=e*ha;u=0+(H>>>16);H=(H&65535)+f*Ia;u+=H>>>16;H&=65535;u+=d*ha;M=0+(u>>>16);u=(u&65535)+e*Ia;M+=u>>>16;u&=\n65535;u+=f*h;M+=u>>>16;u&=65535;M=M+(c*ha+d*Ia+e*h+f*g)&65535;return r(H<<16|Ja&65535,M<<16|u)}\nfunction B(a,b){if(z(b))throw Error(\"division by zero\");if(z(a))return p();if(A(a,q())){if(A(b,x())||A(b,ma()))return q();if(A(b,q()))return x();var c;c=1;if(0==c)c=a;else{var d=a.j;c=32>c?r(a.v>>>c|d<<32-c,d>>c):r(d>>c-32,0<=d?0:-1)}c=pa(B(c,b),1);if(A(c,p()))return 0>b.j?x():ma();d=oa(a,w(b,c));return c.add(B(d,b))}if(A(b,q()))return p();if(0>a.j)return 0>b.j?B(t(a),t(b)):t(B(t(a),b));if(0>b.j)return t(B(a,t(b)));for(var e=p(),d=a;0<=C(d,b);){c=Math.max(1,Math.floor(y(d)/y(b)));for(var f=Math.ceil(Math.log(c)/\nMath.LN2),f=48>=f?1:Math.pow(2,f-48),g=n(c),h=w(g,b);0>h.j||0<C(h,d);)c-=f,g=n(c),h=w(g,b);z(g)&&(g=x());e=e.add(g);d=oa(d,h)}return e}function pa(a,b){b&=63;if(0==b)return a;var c=a.v;return 32>b?r(c<<b,a.j<<b|c>>>32-b):r(0,c<<b-32)}function qa(a,b){b&=63;if(0==b)return a;var c=a.j;return 32>b?r(a.v>>>b|c<<32-b,c>>>b):32==b?r(c,0):r(c>>>b-32,0)};function ra(a,b){if(3<a.length){if(b)return!0;var c=a.charAt(1);return\"~\"===a.charAt(0)?\":\"===c||\"$\"===c||\"#\"===c:!1}return!1}function sa(a){var b=Math.floor(a/44);a=String.fromCharCode(a%44+48);return 0===b?\"^\"+a:\"^\"+String.fromCharCode(b+48)+a}function ta(){this.a=this.s=0;this.g={}}ta.prototype.write=function(a,b){if(ra(a,b)){1936===this.s&&this.clear();var c=this.g[a];return null==c?(this.g[a]=[sa(this.s),this.a],this.s++,a):c[1]!=this.a?(c[1]=this.a,c[0]=sa(this.s),this.s++,a):c[0]}return a};\nta.prototype.clear=function(){this.s=0;this.a++};function ua(){this.s=0;this.a=[]}ua.prototype.write=function(a){1936==this.s&&(this.s=0);this.a[this.s]=a;this.s++;return a};ua.prototype.P=function(a){return this.a[2===a.length?a.charCodeAt(1)-48:44*(a.charCodeAt(1)-48)+(a.charCodeAt(2)-48)]};ua.prototype.clear=function(){this.s=0};var D=\"undefined\"!=typeof Object.keys?function(a){return Object.keys(a)}:function(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b},E=\"undefined\"!=typeof Array.isArray?function(a){return Array.isArray(a)}:function(a){return\"array\"===ba(a)};function F(){return Math.round(15*Math.random()).toString(16)}\nfunction va(){var a=(8|3&Math.round(14*Math.random())).toString(16);return F()+F()+F()+F()+F()+F()+F()+F()+\"-\"+F()+F()+F()+F()+\"-4\"+F()+F()+F()+\"-\"+a+F()+F()+F()+\"-\"+F()+F()+F()+F()+F()+F()+F()+F()+F()+F()+F()+F()};var wa=1;function G(a,b){if(null==a)return null==b;if(a===b)return!0;if(\"object\"===typeof a){if(E(a)){if(E(b)&&a.length===b.length){for(var c=0;c<a.length;c++)if(!G(a[c],b[c]))return!1;return!0}return!1}if(a.C)return a.C(b);if(null!=b&&\"object\"===typeof b){if(b.C)return b.C(a);var c=0,d=D(b).length,e;for(e in a)if(a.hasOwnProperty(e)&&(c++,!b.hasOwnProperty(e)||!G(a[e],b[e])))return!1;return c===d}}return!1}function xa(a,b){return a^b+2654435769+(a<<6)+(a>>2)}var ya={},za=0;\nfunction Aa(a){var b=0;if(null!=a.forEach)a.forEach(function(a,c){b=(b+(I(c)^I(a)))%4503599627370496});else for(var c=D(a),d=0;d<c.length;d++)var e=c[d],f=a[e],b=(b+(I(e)^I(f)))%4503599627370496;return b}function Ba(a){var b=0;if(E(a))for(var c=0;c<a.length;c++)b=xa(b,I(a[c]));else a.forEach&&a.forEach(function(a){b=xa(b,I(a))});return b}\nfunction I(a){if(null==a)return 0;switch(typeof a){case \"number\":return a;case \"boolean\":return!0===a?1:0;case \"string\":var b=ya[a];if(null==b){for(var c=b=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=4294967296;za++;256<=za&&(ya={},za=1);ya[a]=b}a=b;return a;case \"function\":if(b=a.transit$hashCode$)return b;b=wa;\"undefined\"!=typeof Object.defineProperty?Object.defineProperty(a,\"transit$hashCode$\",{value:b,enumerable:!1}):a.transit$hashCode$=b;wa++;return b;default:return a instanceof Date?a.valueOf():\nE(a)?Ba(a):a.D?a.D():Aa(a)}};var Ca=\"undefined\"!=typeof Symbol?Symbol.iterator:\"@@iterator\";function J(a,b){this.tag=a;this.rep=b;this.a=-1}J.prototype.toString=function(){return\"[TaggedValue: \"+this.tag+\", \"+this.rep+\"]\"};J.prototype.g=function(a){return G(this,a)};J.prototype.equiv=J.prototype.g;J.prototype.C=function(a){return a instanceof J?this.tag===a.tag&&G(this.rep,a.rep):!1};J.prototype.D=function(){-1===this.a&&(this.a=xa(I(this.tag),I(this.rep)));return this.a};function K(a,b){return new J(a,b)}\nvar Da=la(\"9007199254740991\"),Ea=la(\"-9007199254740991\");function Fa(a){if(\"number\"===typeof a)return a;if(a instanceof l)return a;a=la(a,10);return 0<C(a,Da)||0>C(a,Ea)?a:y(a)}l.prototype.a=function(a){return G(this,a)};l.prototype.equiv=l.prototype.a;l.prototype.C=function(a){return a instanceof l&&A(this,a)};l.prototype.D=function(){return this.v};function Ga(a){return K(\"n\",a)}function Ha(a){return K(\"f\",a)}function L(a){this.w=a;this.a=-1}L.prototype.toString=function(){return\":\"+this.w};\nL.prototype.namespace=function(){var a=this.w.indexOf(\"/\");return-1!=a?this.w.substring(0,a):null};L.prototype.name=function(){var a=this.w.indexOf(\"/\");return-1!=a?this.w.substring(a+1,this.w.length):this.w};L.prototype.g=function(a){return G(this,a)};L.prototype.equiv=L.prototype.g;L.prototype.C=function(a){return a instanceof L&&this.w==a.w};L.prototype.D=function(){-1===this.a&&(this.a=I(this.w));return this.a};function Ka(a){return new L(a)}function N(a){this.w=a;this.a=-1}\nN.prototype.namespace=function(){var a=this.w.indexOf(\"/\");return-1!=a?this.w.substring(0,a):null};N.prototype.name=function(){var a=this.w.indexOf(\"/\");return-1!=a?this.w.substring(a+1,this.w.length):this.w};N.prototype.toString=function(){return this.w};N.prototype.g=function(a){return G(this,a)};N.prototype.equiv=N.prototype.g;N.prototype.C=function(a){return a instanceof N&&this.w==a.w};N.prototype.D=function(){-1===this.a&&(this.a=I(this.w));return this.a};function La(a){return new N(a)}\nfunction Ma(a,b,c){var d=\"\";c=c||b+1;for(var e=8*(7-b),f=pa(m(255),e);b<c;b++,e-=8,f=qa(f,8)){var g=qa(r(a.v&f.v,a.j&f.j),e).toString(16);1==g.length&&(g=\"0\"+g);d+=g}return d}function O(a,b){this.g=a;this.o=b;this.a=-1}O.prototype.toString=function(){var a,b=this.g,c=this.o;a=\"\"+(Ma(b,0,4)+\"-\");a+=Ma(b,4,6)+\"-\";a+=Ma(b,6,8)+\"-\";a+=Ma(c,0,2)+\"-\";return a+=Ma(c,2,8)};O.prototype.F=function(a){return G(this,a)};O.prototype.equiv=O.prototype.F;\nO.prototype.C=function(a){return a instanceof O&&A(this.g,a.g)&&A(this.o,a.o)};O.prototype.D=function(){-1===this.a&&(this.a=I(this.toString()));return this.a};\nfunction Na(a){a=a.replace(/-/g,\"\");for(var b=null,c=null,d=c=0,e=24,f=0,f=c=0,e=24;8>f;f+=2,e-=8)c|=parseInt(a.substring(f,f+2),16)<<e;d=0;f=8;for(e=24;16>f;f+=2,e-=8)d|=parseInt(a.substring(f,f+2),16)<<e;b=r(d,c);c=0;f=16;for(e=24;24>f;f+=2,e-=8)c|=parseInt(a.substring(f,f+2),16)<<e;d=0;for(e=f=24;32>f;f+=2,e-=8)d|=parseInt(a.substring(f,f+2),16)<<e;c=r(d,c);return new O(b,c)}function Oa(a){a=\"number\"===typeof a?a:parseInt(a,10);return new Date(a)}\nDate.prototype.C=function(a){return a instanceof Date?this.valueOf()===a.valueOf():!1};Date.prototype.D=function(){return this.valueOf()};\nfunction Pa(a,b){var c;if(b&&!1===b.O||\"undefined\"==typeof Buffer)if(\"undefined\"!=typeof Uint8Array){if(\"undefined\"!=typeof atob)c=atob(a);else{c=String(a).replace(/=+$/,\"\");if(1==c.length%4)throw Error(\"'atob' failed: The string to be decoded is not correctly encoded.\");for(var d=0,e,f,g=0,h=\"\";f=c.charAt(g++);~f&&(e=d%4?64*e+f:f,d++%4)?h+=String.fromCharCode(255&e>>(-2*d&6)):0)f=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(f);c=h}d=c.length;e=new Uint8Array(d);for(f=\n0;f<d;f++)e[f]=c.charCodeAt(f);c=e}else c=K(\"b\",a);else c=new Buffer(a,\"base64\");return c}function Qa(a){return K(\"r\",a)}function P(a,b){this.a=a;this.type=b||0;this.s=0}P.prototype.next=function(){if(this.s<this.a.length){var a=null;0===this.type?a=this.a[this.s]:1===this.type?a=this.a[this.s+1]:a=[this.a[this.s],this.a[this.s+1]];a={value:a,done:!1};this.s+=2;return a}return{value:null,done:!0}};P.prototype.next=P.prototype.next;P.prototype[Ca]=function(){return this};\nfunction Q(a,b){this.map=a;this.type=b||0;this.keys=Ra(this.map);this.s=0;this.g=null;this.a=0}Q.prototype.next=function(){if(this.s<this.map.size){null!=this.g&&this.a<this.g.length||(this.g=this.map.map[this.keys[this.s]],this.a=0);var a=null;0===this.type?a=this.g[this.a]:1===this.type?a=this.g[this.a+1]:a=[this.g[this.a],this.g[this.a+1]];a={value:a,done:!1};this.s++;this.a+=2;return a}return{value:null,done:!0}};Q.prototype.next=Q.prototype.next;Q.prototype[Ca]=function(){return this};\nfunction Sa(a,b){if(a instanceof R&&Ta(b)){if(a.size!==b.size)return!1;for(var c in a.map)for(var d=a.map[c],e=0;e<d.length;e+=2)if(!G(d[e+1],b.get(d[e])))return!1;return!0}if(a instanceof S&&Ta(b)){if(a.size!==b.size)return!1;c=a.l;for(e=0;e<c.length;e+=2)if(!G(c[e+1],b.get(c[e])))return!1;return!0}if(null!=b&&\"object\"===typeof b&&(e=D(b),c=e.length,a.size===c)){for(d=0;d<c;d++){var f=e[d];if(!a.has(f)||!G(b[f],a.get(f)))return!1}return!0}return!1}\nfunction Ua(a){return null==a?\"null\":\"array\"==ba(a)?\"[\"+a.toString()+\"]\":\"string\"==typeof a?'\"'+a+'\"':a.toString()}function Va(a){var b=0,c=\"TransitMap {\";a.forEach(function(d,e){c+=Ua(e)+\" => \"+Ua(d);b<a.size-1&&(c+=\", \");b++});return c+\"}\"}function Wa(a){var b=0,c=\"TransitSet {\";a.forEach(function(d){c+=Ua(d);b<a.size-1&&(c+=\", \");b++});return c+\"}\"}function S(a){this.l=a;this.h=null;this.a=-1;this.size=a.length/2;this.g=0}S.prototype.toString=function(){return Va(this)};S.prototype.inspect=function(){return this.toString()};\nfunction Xa(a){if(a.h)throw Error(\"Invalid operation, already converted\");if(8>a.size)return!1;a.g++;return 32<a.g?(a.h=T(a.l,!1,!0),a.l=[],!0):!1}S.prototype.clear=function(){this.a=-1;this.h?this.h.clear():this.l=[];this.size=0};S.prototype.clear=S.prototype.clear;S.prototype.keys=function(){return this.h?this.h.keys():new P(this.l,0)};S.prototype.keys=S.prototype.keys;S.prototype.o=function(){if(this.h)return this.h.o();for(var a=[],b=0,c=0;c<this.l.length;b++,c+=2)a[b]=this.l[c];return a};\nS.prototype.keySet=S.prototype.o;S.prototype.entries=function(){return this.h?this.h.entries():new P(this.l,2)};S.prototype.entries=S.prototype.entries;S.prototype.values=function(){return this.h?this.h.values():new P(this.l,1)};S.prototype.values=S.prototype.values;S.prototype.forEach=function(a){if(this.h)this.h.forEach(a);else for(var b=0;b<this.l.length;b+=2)a(this.l[b+1],this.l[b])};S.prototype.forEach=S.prototype.forEach;\nS.prototype.get=function(a,b){if(this.h)return this.h.get(a);if(Xa(this))return this.get(a);for(var c=0;c<this.l.length;c+=2)if(G(this.l[c],a))return this.l[c+1];return b};S.prototype.get=S.prototype.get;S.prototype.has=function(a){if(this.h)return this.h.has(a);if(Xa(this))return this.has(a);for(var b=0;b<this.l.length;b+=2)if(G(this.l[b],a))return!0;return!1};S.prototype.has=S.prototype.has;\nS.prototype.set=function(a,b){this.a=-1;if(this.h)this.h.set(a,b),this.size=this.h.size;else{for(var c=0;c<this.l.length;c+=2)if(G(this.l[c],a)){this.l[c+1]=b;return}this.l.push(a);this.l.push(b);this.size++;32<this.size&&(this.h=T(this.l,!1,!0),this.l=null)}};S.prototype.set=S.prototype.set;\nS.prototype[\"delete\"]=function(a){this.a=-1;if(this.h)return a=this.h[\"delete\"](a),this.size=this.h.size,a;for(var b=0;b<this.l.length;b+=2)if(G(this.l[b],a))return a=this.l[b+1],this.l.splice(b,2),this.size--,a};S.prototype.clone=function(){var a=T();this.forEach(function(b,c){a.set(c,b)});return a};S.prototype.clone=S.prototype.clone;S.prototype[Ca]=function(){return this.entries()};S.prototype.D=function(){if(this.h)return this.h.D();-1===this.a&&(this.a=Aa(this));return this.a};\nS.prototype.C=function(a){return this.h?Sa(this.h,a):Sa(this,a)};function R(a,b,c){this.map=b||{};this.a=a||[];this.size=c||0;this.g=-1}R.prototype.toString=function(){return Va(this)};R.prototype.inspect=function(){return this.toString()};R.prototype.clear=function(){this.g=-1;this.map={};this.a=[];this.size=0};R.prototype.clear=R.prototype.clear;function Ra(a){return null!=a.a?a.a:D(a.map)}\nR.prototype[\"delete\"]=function(a){this.g=-1;this.a=null;for(var b=I(a),c=this.map[b],d=0;d<c.length;d+=2)if(G(a,c[d]))return a=c[d+1],c.splice(d,2),0===c.length&&delete this.map[b],this.size--,a};R.prototype.entries=function(){return new Q(this,2)};R.prototype.entries=R.prototype.entries;R.prototype.forEach=function(a){for(var b=Ra(this),c=0;c<b.length;c++)for(var d=this.map[b[c]],e=0;e<d.length;e+=2)a(d[e+1],d[e],this)};R.prototype.forEach=R.prototype.forEach;\nR.prototype.get=function(a,b){var c=I(a),c=this.map[c];if(null!=c)for(var d=0;d<c.length;d+=2){if(G(a,c[d]))return c[d+1]}else return b};R.prototype.get=R.prototype.get;R.prototype.has=function(a){var b=I(a),b=this.map[b];if(null!=b)for(var c=0;c<b.length;c+=2)if(G(a,b[c]))return!0;return!1};R.prototype.has=R.prototype.has;R.prototype.keys=function(){return new Q(this,0)};R.prototype.keys=R.prototype.keys;\nR.prototype.o=function(){for(var a=Ra(this),b=[],c=0;c<a.length;c++)for(var d=this.map[a[c]],e=0;e<d.length;e+=2)b.push(d[e]);return b};R.prototype.keySet=R.prototype.o;R.prototype.set=function(a,b){this.g=-1;var c=I(a),d=this.map[c];if(null==d)this.a&&this.a.push(c),this.map[c]=[a,b],this.size++;else{for(var c=!0,e=0;e<d.length;e+=2)if(G(b,d[e])){c=!1;d[e]=b;break}c&&(d.push(a),d.push(b),this.size++)}};R.prototype.set=R.prototype.set;R.prototype.values=function(){return new Q(this,1)};\nR.prototype.values=R.prototype.values;R.prototype.clone=function(){var a=T();this.forEach(function(b,c){a.set(c,b)});return a};R.prototype.clone=R.prototype.clone;R.prototype[Ca]=function(){return this.entries()};R.prototype.D=function(){-1===this.g&&(this.g=Aa(this));return this.g};R.prototype.C=function(a){return Sa(this,a)};\nfunction T(a,b,c){a=a||[];b=!1===b?b:!0;if((!0!==c||!c)&&64>=a.length){if(b){var d=a;a=[];for(b=0;b<d.length;b+=2){var e=!1;for(c=0;c<a.length;c+=2)if(G(a[c],d[b])){a[c+1]=d[b+1];e=!0;break}e||(a.push(d[b]),a.push(d[b+1]))}}return new S(a)}var d={},e=[],f=0;for(b=0;b<a.length;b+=2){c=I(a[b]);var g=d[c];if(null==g)e.push(c),d[c]=[a[b],a[b+1]],f++;else{var h=!0;for(c=0;c<g.length;c+=2)if(G(g[c],a[b])){g[c+1]=a[b+1];h=!1;break}h&&(g.push(a[b]),g.push(a[b+1]),f++)}}return new R(e,d,f)}\nfunction Ta(a){return a instanceof S||a instanceof R}function U(a){this.map=a;this.size=a.size}U.prototype.toString=function(){return Wa(this)};U.prototype.inspect=function(){return this.toString()};U.prototype.add=function(a){this.map.set(a,a);this.size=this.map.size};U.prototype.add=U.prototype.add;U.prototype.clear=function(){this.map=new R;this.size=0};U.prototype.clear=U.prototype.clear;U.prototype[\"delete\"]=function(a){a=this.map[\"delete\"](a);this.size=this.map.size;return a};\nU.prototype.g=function(){return this.map.entries()};U.prototype.entries=U.prototype.g;U.prototype.forEach=function(a){var b=this;this.map.forEach(function(c,d){a(d,b)})};U.prototype.forEach=U.prototype.forEach;U.prototype.has=function(a){return this.map.has(a)};U.prototype.has=U.prototype.has;U.prototype.keys=function(){return this.map.keys()};U.prototype.keys=U.prototype.keys;U.prototype.o=function(){return this.map.o()};U.prototype.keySet=U.prototype.o;U.prototype.a=function(){return this.map.values()};\nU.prototype.values=U.prototype.a;U.prototype.clone=function(){var a=Ya();this.forEach(function(b){a.add(b)});return a};U.prototype.clone=U.prototype.clone;U.prototype[Ca]=function(){return this.a()};U.prototype.C=function(a){if(a instanceof U){if(this.size===a.size)return G(this.map,a.map)}else return!1};U.prototype.D=function(){return I(this.map)};\nfunction Ya(a){a=a||[];for(var b={},c=[],d=0,e=0;e<a.length;e++){var f=I(a[e]),g=b[f];if(null==g)c.push(f),b[f]=[a[e],a[e]],d++;else{for(var f=!0,h=0;h<g.length;h+=2)if(G(g[h],a[e])){f=!1;break}f&&(g.push(a[e]),g.push(a[e]),d++)}}return new U(new R(c,b,d))}function Za(a){return K(\"'\",a)}function $a(a){return K(\"list\",a)}function ab(a){return K(\"link\",a)};var bb=0,cb=\"transit$guid$\"+va();function db(a){if(null==a)return\"null\";if(a===String)return\"string\";if(a===Boolean)return\"boolean\";if(a===Number)return\"number\";if(a===Array)return\"array\";if(a===Object)return\"map\";var b=a[cb];null==b&&(\"undefined\"!=typeof Object.defineProperty?(b=++bb,Object.defineProperty(a,cb,{value:b,enumerable:!1})):a[cb]=b=++bb);return b}function V(a,b){for(var c=a.toString(),d=c.length;d<b;d++)c=\"0\"+c;return c}function eb(){}eb.prototype.tag=function(){return\"_\"};\neb.prototype.rep=function(){return null};eb.prototype.B=function(){return\"null\"};function fb(){}fb.prototype.tag=function(){return\"s\"};fb.prototype.rep=function(a){return a};fb.prototype.B=function(a){return a};function gb(){}gb.prototype.tag=function(){return\"i\"};gb.prototype.rep=function(a){return a};gb.prototype.B=function(a){return a.toString()};function hb(){}hb.prototype.tag=function(){return\"i\"};hb.prototype.rep=function(a){return a.toString()};hb.prototype.B=function(a){return a.toString()};\nfunction ib(){}ib.prototype.tag=function(){return\"?\"};ib.prototype.rep=function(a){return a};ib.prototype.B=function(a){return a.toString()};function jb(){}jb.prototype.tag=function(){return\"array\"};jb.prototype.rep=function(a){return a};jb.prototype.B=function(){return null};function kb(){}kb.prototype.tag=function(){return\"map\"};kb.prototype.rep=function(a){return a};kb.prototype.B=function(){return null};function lb(){}lb.prototype.tag=function(){return\"t\"};\nlb.prototype.rep=function(a){return a.getUTCFullYear()+\"-\"+V(a.getUTCMonth()+1,2)+\"-\"+V(a.getUTCDate(),2)+\"T\"+V(a.getUTCHours(),2)+\":\"+V(a.getUTCMinutes(),2)+\":\"+V(a.getUTCSeconds(),2)+\".\"+V(a.getUTCMilliseconds(),3)+\"Z\"};lb.prototype.B=function(a,b){return b.rep(a)};function mb(){}mb.prototype.tag=function(){return\"m\"};mb.prototype.rep=function(a){return a.valueOf()};mb.prototype.B=function(a){return a.valueOf().toString()};mb.prototype.R=function(){return new lb};function nb(){}\nnb.prototype.tag=function(){return\"u\"};nb.prototype.rep=function(a){return a.toString()};nb.prototype.B=function(a){return a.toString()};function ob(){}ob.prototype.tag=function(){return\":\"};ob.prototype.rep=function(a){return a.w};ob.prototype.B=function(a,b){return b.rep(a)};function pb(){}pb.prototype.tag=function(){return\"$\"};pb.prototype.rep=function(a){return a.w};pb.prototype.B=function(a,b){return b.rep(a)};function qb(){}qb.prototype.tag=function(a){return a.tag};qb.prototype.rep=function(a){return a.rep};\nqb.prototype.B=function(){return null};function rb(){}rb.prototype.tag=function(){return\"set\"};rb.prototype.rep=function(a){var b=[];a.forEach(function(a){b.push(a)});return K(\"array\",b)};rb.prototype.B=function(){return null};function sb(){}sb.prototype.tag=function(){return\"map\"};sb.prototype.rep=function(a){return a};sb.prototype.B=function(){return null};function tb(){}tb.prototype.tag=function(){return\"map\"};tb.prototype.rep=function(a){return a};tb.prototype.B=function(){return null};\nfunction ub(){}ub.prototype.tag=function(){return\"b\"};ub.prototype.rep=function(a){return a.toString(\"base64\")};ub.prototype.B=function(){return null};function vb(){}vb.prototype.tag=function(){return\"b\"};\nvb.prototype.rep=function(a){for(var b=0,c=a.length,d=\"\",e=null;b<c;)e=a.subarray(b,Math.min(b+32768,c)),d+=String.fromCharCode.apply(null,e),b+=32768;var f;if(\"undefined\"!=typeof btoa)f=btoa(d);else{a=String(d);c=0;d=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";for(e=\"\";a.charAt(c|0)||(d=\"=\",c%1);e+=d.charAt(63&f>>8-c%1*8)){b=a.charCodeAt(c+=.75);if(255<b)throw Error(\"'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.\");f=f<<8|b}f=e}return f};\nvb.prototype.B=function(){return null};function wb(){this.A={};this.set(null,new eb);this.set(String,new fb);this.set(Number,new gb);this.set(l,new hb);this.set(Boolean,new ib);this.set(Array,new jb);this.set(Object,new kb);this.set(Date,new mb);this.set(O,new nb);this.set(L,new ob);this.set(N,new pb);this.set(J,new qb);this.set(U,new rb);this.set(S,new sb);this.set(R,new tb);\"undefined\"!=typeof Buffer&&this.set(Buffer,new ub);\"undefined\"!=typeof Uint8Array&&this.set(Uint8Array,new vb)}\nwb.prototype.get=function(a){var b=null,b=\"string\"===typeof a?this.A[a]:this.A[db(a)];return null!=b?b:this.A[\"default\"]};wb.prototype.get=wb.prototype.get;wb.prototype.set=function(a,b){var c;if(c=\"string\"===typeof a)a:{switch(a){case \"null\":case \"string\":case \"boolean\":case \"number\":case \"array\":case \"map\":c=!1;break a}c=!0}c?this.A[a]=b:this.A[db(a)]=b};function xb(a){this.K=a}\nfunction W(a){this.o=a||{};this.A={};for(var b in this.G.A)this.A[b]=this.G.A[b];for(b in this.o.handlers){a:{switch(b){case \"_\":case \"s\":case \"?\":case \"i\":case \"d\":case \"b\":case \"'\":case \"array\":case \"map\":a=!0;break a}a=!1}if(a)throw Error('Cannot override handler for ground type \"'+b+'\"');this.A[b]=this.o.handlers[b]}this.J=null!=this.o.preferStrings?this.o.preferStrings:this.G.J;this.O=null!=this.o.preferBuffers?this.o.preferBuffers:this.G.O;this.M=this.o.defaultHandler||this.G.M;this.g=this.o.mapBuilder;\nthis.F=this.o.arrayBuilder}\nW.prototype.G={A:{_:function(){return null},\"?\":function(a){return\"t\"===a},b:function(a,b){return Pa(a,b)},i:function(a){return Fa(a)},n:function(a){return Ga(a)},d:function(a){return parseFloat(a)},f:function(a){return Ha(a)},c:function(a){return a},\":\":function(a){return Ka(a)},$:function(a){return La(a)},r:function(a){return Qa(a)},z:function(a){a:switch(a){case \"-INF\":a=-Infinity;break a;case \"INF\":a=Infinity;break a;case \"NaN\":a=NaN;break a;default:throw Error(\"Invalid special double value \"+a);\n}return a},\"'\":function(a){return a},m:function(a){return Oa(a)},t:function(a){return new Date(a)},u:function(a){return Na(a)},set:function(a){return Ya(a)},list:function(a){return $a(a)},link:function(a){return ab(a)},cmap:function(a){return T(a,!1)}},M:function(a,b){return K(a,b)},J:!0,O:!0};\nW.prototype.a=function(a,b,c,d){if(null==a)return null;switch(typeof a){case \"string\":return ra(a,c)?(a=yb(this,a),b&&b.write(a,c),b=a):b=\"^\"===a.charAt(0)&&\" \"!==a.charAt(1)?b.P(a,c):yb(this,a),b;case \"object\":if(E(a))if(\"^ \"===a[0])if(this.g)if(17>a.length&&this.g.fromArray){d=[];for(c=1;c<a.length;c+=2)d.push(this.a(a[c],b,!0,!1)),d.push(this.a(a[c+1],b,!1,!1));b=this.g.fromArray(d,a)}else{d=this.g.init(a);for(c=1;c<a.length;c+=2)d=this.g.add(d,this.a(a[c],b,!0,!1),this.a(a[c+1],b,!1,!1),a);b=\nthis.g.finalize(d,a)}else{d=[];for(c=1;c<a.length;c+=2)d.push(this.a(a[c],b,!0,!1)),d.push(this.a(a[c+1],b,!1,!1));b=T(d,!1)}else b=zb(this,a,b,c,d);else{c=D(a);var e=c[0];if((d=1==c.length?this.a(e,b,!1,!1):null)&&d instanceof xb)a=a[e],c=this.A[d.K],b=null!=c?c(this.a(a,b,!1,!0),this):K(d.K,this.a(a,b,!1,!1));else if(this.g)if(16>c.length&&this.g.fromArray){var f=[];for(d=0;d<c.length;d++)e=c[d],f.push(this.a(e,b,!0,!1)),f.push(this.a(a[e],b,!1,!1));b=this.g.fromArray(f,a)}else{f=this.g.init(a);\nfor(d=0;d<c.length;d++)e=c[d],f=this.g.add(f,this.a(e,b,!0,!1),this.a(a[e],b,!1,!1),a);b=this.g.finalize(f,a)}else{f=[];for(d=0;d<c.length;d++)e=c[d],f.push(this.a(e,b,!0,!1)),f.push(this.a(a[e],b,!1,!1));b=T(f,!1)}}return b}return a};W.prototype.decode=W.prototype.a;\nfunction zb(a,b,c,d,e){if(e){var f=[];for(e=0;e<b.length;e++)f.push(a.a(b[e],c,d,!1));return f}f=c&&c.s;if(2===b.length&&\"string\"===typeof b[0]&&(e=a.a(b[0],c,!1,!1))&&e instanceof xb)return b=b[1],f=a.A[e.K],null!=f?f=f(a.a(b,c,d,!0),a):K(e.K,a.a(b,c,d,!1));c&&f!=c.s&&(c.s=f);if(a.F){if(32>=b.length&&a.F.fromArray){f=[];for(e=0;e<b.length;e++)f.push(a.a(b[e],c,d,!1));return a.F.fromArray(f,b)}f=a.F.init(b);for(e=0;e<b.length;e++)f=a.F.add(f,a.a(b[e],c,d,!1),b);return a.F.finalize(f,b)}f=[];for(e=\n0;e<b.length;e++)f.push(a.a(b[e],c,d,!1));return f}function yb(a,b){if(\"~\"===b.charAt(0)){var c=b.charAt(1);if(\"~\"===c||\"^\"===c||\"`\"===c)return b.substring(1);if(\"#\"===c)return new xb(b.substring(2));var d=a.A[c];return null==d?a.M(c,b.substring(2)):d(b.substring(2),a)}return b};function Ab(a){this.a=new W(a)}function Bb(a,b){this.o=a;this.g=b||{};this.a=this.g.cache?this.g.cache:new ua}Bb.prototype.P=function(a){var b=this.a;a=this.o.a.a(JSON.parse(a),b);this.a.clear();return a};Bb.prototype.read=Bb.prototype.P;function Cb(a){this.a=a||{};this.J=null!=this.a.preferStrings?this.a.preferStrings:!0;this.S=this.a.objectBuilder||null;this.A=new wb;if(a=this.a.handlers){if(E(a)||!a.forEach)throw Error('transit writer \"handlers\" option must be a map');var b=this;a.forEach(function(a,d){if(void 0!==d)b.A.set(d,a);else throw Error(\"Cannot create handler for JavaScript undefined\");})}this.H=this.a.handlerForForeign;this.L=this.a.unpack||function(a){return a instanceof S&&null===a.h?a.l:!1};this.I=this.a&&this.a.verbose||\n!1}function Db(a,b){var c=a.A.get(null==b?null:b.constructor);return null!=c?c:(c=b&&b.transitTag)?a.A.get(c):null}function X(a,b,c,d,e){a=a+b+c;return e?e.write(a,d):a}function Eb(a,b,c){var d=[];if(E(b))for(var e=0;e<b.length;e++)d.push(Y(a,b[e],!1,c));else b.forEach(function(b){d.push(Y(a,b,!1,c))});return d}function Fb(a,b){if(\"string\"!==typeof b){var c=Db(a,b);return c&&1===c.tag(b).length}return!0}\nfunction Gb(a,b){var c=a.L(b),d=!0;if(c){for(var e=0;e<c.length&&(d=Fb(a,c[e]),d);e+=2);return d}if(b.keys&&(c=b.keys(),e=null,c.next)){for(e=c.next();!e.done;){d=Fb(a,e.value);if(!d)break;e=c.next()}return d}if(b.forEach)return b.forEach(function(b,c){d=d&&Fb(a,c)}),d;throw Error(\"Cannot walk keys of object type \"+(null==b?null:b.constructor).name);}\nfunction Hb(a){if(a.constructor.transit$isObject)return!0;var b=a.constructor.toString(),b=b.substr(9),b=b.substr(0,b.indexOf(\"(\")),b=\"Object\"==b;\"undefined\"!=typeof Object.defineProperty?Object.defineProperty(a.constructor,\"transit$isObject\",{value:b,enumerable:!1}):a.constructor.transit$isObject=b;return b}\nfunction Ib(a,b,c){if(b.constructor===Object||null!=b.forEach||a.H&&Hb(b)){if(a.I){if(null!=b.forEach){if(Gb(a,b)){var d={};b.forEach(function(b,e){d[Y(a,e,!0,!1)]=Y(a,b,!1,c)});return d}var e=a.L(b),f=[],g=X(\"~#\",\"cmap\",\"\",!0,c);if(e)for(var h=0;h<e.length;h+=2)f.push(Y(a,e[h],!0,!1)),f.push(Y(a,e[h+1],!1,c));else b.forEach(function(b,d){f.push(Y(a,d,!0,!1));f.push(Y(a,b,!1,c))});d={};d[g]=f;return d}d={};e=D(b);for(h=0;h<e.length;h++)d[Y(a,e[h],!0,!1)]=Y(a,b[e[h]],!1,c);return d}if(null!=b.forEach){if(Gb(a,\nb)){e=a.L(b);d=[\"^ \"];if(e)for(h=0;h<e.length;h+=2)d.push(Y(a,e[h],!0,c)),d.push(Y(a,e[h+1],!1,c));else b.forEach(function(b,e){d.push(Y(a,e,!0,c));d.push(Y(a,b,!1,c))});return d}e=a.L(b);f=[];g=X(\"~#\",\"cmap\",\"\",!0,c);if(e)for(h=0;h<e.length;h+=2)f.push(Y(a,e[h],!0,c)),f.push(Y(a,e[h+1],!1,c));else b.forEach(function(b,d){f.push(Y(a,d,!0,c));f.push(Y(a,b,!1,c))});return[g,f]}d=[\"^ \"];e=D(b);for(h=0;h<e.length;h++)d.push(Y(a,e[h],!0,c)),d.push(Y(a,b[e[h]],!1,c));return d}if(null!=a.S)return a.S(b,\nfunction(b){return Y(a,b,!0,c)},function(b){return Y(a,b,!1,c)});h=(null==b?null:b.constructor).name;e=Error(\"Cannot write \"+h);e.data={N:b,type:h};throw e;}\nfunction Y(a,b,c,d){var e=Db(a,b)||(a.H?a.H(b,a.A):null),f=e?e.tag(b):null,g=e?e.rep(b):null;if(null!=e&&null!=f)switch(f){case \"_\":return c?X(\"~\",\"_\",\"\",c,d):null;case \"s\":return 0<g.length?(a=g.charAt(0),a=\"~\"===a||\"^\"===a||\"`\"===a?\"~\"+g:g):a=g,X(\"\",\"\",a,c,d);case \"?\":return c?X(\"~\",\"?\",g.toString()[0],c,d):g;case \"i\":return Infinity===g?X(\"~\",\"z\",\"INF\",c,d):-Infinity===g?X(\"~\",\"z\",\"-INF\",c,d):isNaN(g)?X(\"~\",\"z\",\"NaN\",c,d):c||\"string\"===typeof g||g instanceof l?X(\"~\",\"i\",g.toString(),c,d):g;case \"d\":return c?\nX(g.T,\"d\",g,c,d):g;case \"b\":return X(\"~\",\"b\",g,c,d);case \"'\":return a.I?(b={},c=X(\"~#\",\"'\",\"\",!0,d),b[c]=Y(a,g,!1,d),d=b):d=[X(\"~#\",\"'\",\"\",!0,d),Y(a,g,!1,d)],d;case \"array\":return Eb(a,g,d);case \"map\":return Ib(a,g,d);default:a:{if(1===f.length){if(\"string\"===typeof g){d=X(\"~\",f,g,c,d);break a}if(c||a.J){(a=a.I&&e.R())?(f=a.tag(b),g=a.B(b,a)):g=e.B(b,e);if(null!==g){d=X(\"~\",f,g,c,d);break a}d=Error('Tag \"'+f+'\" cannot be encoded as string');d.data={tag:f,rep:g,N:b};throw d;}}b=f;c=g;a.I?(g={},g[X(\"~#\",\nb,\"\",!0,d)]=Y(a,c,!1,d),d=g):d=[X(\"~#\",b,\"\",!0,d),Y(a,c,!1,d)]}return d}else throw d=(null==b?null:b.constructor).name,a=Error(\"Cannot write \"+d),a.data={N:b,type:d},a;}function Jb(a,b){var c=Db(a,b)||(a.H?a.H(b,a.A):null);if(null!=c)return 1===c.tag(b).length?Za(b):b;var c=(null==b?null:b.constructor).name,d=Error(\"Cannot write \"+c);d.data={N:b,type:c};throw d;}function Z(a,b){this.a=a;this.o=b||{};!1===this.o.cache?this.g=null:this.g=this.o.cache?this.o.cache:new ta}Z.prototype.G=function(){return this.a};\nZ.prototype.marshaller=Z.prototype.G;Z.prototype.write=function(a,b){var c=null,d=b||{},c=d.asMapKey||!1,e=this.a.I?!1:this.g;!1===d.marshalTop?c=Y(this.a,a,c,e):(d=this.a,c=JSON.stringify(Y(d,Jb(d,a),c,e)));null!=this.g&&this.g.clear();return c};Z.prototype.write=Z.prototype.write;Z.prototype.F=function(a,b){this.a.A.set(a,b)};Z.prototype.register=Z.prototype.F;var Kb=T;k(\"transit.reader\",function(a,b){if(\"json\"===a||\"json-verbose\"===a||null==a){var c=new Ab(b);return new Bb(c,b)}throw Error(\"Cannot create reader of type \"+a);});k(\"transit.writer\",function(a,b){if(\"json\"===a||\"json-verbose\"===a||null==a){\"json-verbose\"===a&&(null==b&&(b={}),b.verbose=!0);var c=new Cb(b);return new Z(c,b)}c=Error('Type must be \"json\"');c.data={type:a};throw c;});\nk(\"transit.makeBuilder\",function(a){function b(){}b.prototype.init=a.init;b.prototype.add=a.add;b.prototype.finalize=a.finalize;b.prototype.fromArray=a.fromArray;return new b});k(\"transit.makeWriteHandler\",function(a){function b(){}b.prototype.tag=a.tag;b.prototype.rep=a.rep;b.prototype.B=a.stringRep;b.prototype.R=a.getVerboseHandler;return new b});k(\"transit.date\",Oa);k(\"transit.integer\",Fa);\nk(\"transit.isInteger\",function(a){return a instanceof l?!0:\"number\"===typeof a&&!isNaN(a)&&Infinity!==a&&parseFloat(a)===parseInt(a,10)});k(\"transit.uuid\",function(a){return Na(a)});k(\"transit.isUUID\",function(a){return a instanceof O});k(\"transit.bigInt\",Ga);k(\"transit.isBigInt\",function(a){return a instanceof J&&\"n\"===a.tag});k(\"transit.bigDec\",Ha);k(\"transit.isBigDec\",function(a){return a instanceof J&&\"f\"===a.tag});k(\"transit.keyword\",Ka);k(\"transit.isKeyword\",function(a){return a instanceof L});\nk(\"transit.symbol\",La);k(\"transit.isSymbol\",function(a){return a instanceof N});k(\"transit.binary\",Pa);k(\"transit.isBinary\",function(a){return\"undefined\"!=typeof Buffer&&a instanceof Buffer?!0:\"undefined\"!=typeof Uint8Array&&a instanceof Uint8Array?!0:a instanceof J&&\"b\"===a.tag});k(\"transit.uri\",Qa);k(\"transit.isURI\",function(a){return a instanceof J&&\"r\"===a.tag});k(\"transit.map\",T);k(\"transit.isMap\",Ta);k(\"transit.set\",Ya);k(\"transit.isSet\",function(a){return a instanceof U});\nk(\"transit.list\",$a);k(\"transit.isList\",function(a){return a instanceof J&&\"list\"===a.tag});k(\"transit.quoted\",Za);k(\"transit.isQuoted\",function(a){return a instanceof J&&\"'\"===a.tag});k(\"transit.tagged\",K);k(\"transit.isTaggedValue\",function(a){return a instanceof J});k(\"transit.link\",ab);k(\"transit.isLink\",function(a){return a instanceof J&&\"link\"===a.tag});k(\"transit.hash\",I);k(\"transit.hashMapLike\",Aa);k(\"transit.hashArrayLike\",Ba);k(\"transit.equals\",G);\nk(\"transit.extendToEQ\",function(a,b){a.D=b.hashCode;a.C=b.equals;return a});k(\"transit.mapToObject\",function(a){var b={};a.forEach(function(a,d){if(\"string\"!==typeof d)throw Error(\"Cannot convert map with non-string keys\");b[d]=a});return b});k(\"transit.objectToMap\",function(a){var b=Kb(),c;for(c in a)a.hasOwnProperty(c)&&b.set(c,a[c]);return b});k(\"transit.decoder\",function(a){return new W(a)});k(\"transit.UUIDfromString\",Na);k(\"transit.randomUUID\",va);k(\"transit.stringableKeys\",Gb);\nk(\"transit.readCache\",function(){return new ua});k(\"transit.writeCache\",function(){return new ta});})();\nmodule.exports = transit;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./vendor/transit-0.8.837-min.js\n// module id = 288\n// module chunks = 0 1 2","\n// From: https://github.com/chenglou/tween-functions/blob/master/index.js\n// t: current time, b: beginning value, _c: final value, d: total duration\nconst tweenFunctions = {\n  linear: function (t, b, _c, d) {\n    var c = _c - b;\n    return c * t / d + b;\n  },\n\n  easeInQuad: function (t, b, _c, d) {\n    var c = _c - b;\n    return c * (t /= d) * t + b;\n  },\n\n  easeOutQuad: function (t, b, _c, d) {\n    var c = _c - b;\n    return -c * (t /= d) * (t - 2) + b;\n  },\n\n  easeInOutQuad: function (t, b, _c, d) {\n    var c = _c - b;\n    if ((t /= d / 2) < 1) {\n      return c / 2 * t * t + b;\n    } else {\n      return -c / 2 * ((--t) * (t - 2) - 1) + b;\n    }\n  },\n\n  easeInCubic: function (t, b, _c, d) {\n    var c = _c - b;\n    return c * (t /= d) * t * t + b;\n  },\n\n  easeOutCubic: function (t, b, _c, d) {\n    var c = _c - b;\n    return c * ((t = t / d - 1) * t * t + 1) + b;\n  },\n\n  easeInOutCubic: function (t, b, _c, d) {\n    var c = _c - b;\n    if ((t /= d / 2) < 1) {\n      return c / 2 * t * t * t + b;\n    } else {\n      return c / 2 * ((t -= 2) * t * t + 2) + b;\n    }\n  },\n\n  easeInQuart: function (t, b, _c, d) {\n    var c = _c - b;\n    return c * (t /= d) * t * t * t + b;\n  },\n\n  easeOutQuart: function (t, b, _c, d) {\n    var c = _c - b;\n    return -c * ((t = t / d - 1) * t * t * t - 1) + b;\n  },\n\n  easeInOutQuart: function (t, b, _c, d) {\n    var c = _c - b;\n    if ((t /= d / 2) < 1) {\n      return c / 2 * t * t * t * t + b;\n    } else {\n      return -c / 2 * ((t -= 2) * t * t * t - 2) + b;\n    }\n  },\n\n  easeInQuint: function (t, b, _c, d) {\n    var c = _c - b;\n    return c * (t /= d) * t * t * t * t + b;\n  },\n\n  easeOutQuint: function (t, b, _c, d) {\n    var c = _c - b;\n    return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n  },\n\n  easeInOutQuint: function (t, b, _c, d) {\n    var c = _c - b;\n    if ((t /= d / 2) < 1) {\n      return c / 2 * t * t * t * t * t + b;\n    } else {\n      return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\n    }\n  },\n\n  easeInSine: function (t, b, _c, d) {\n    var c = _c - b;\n    return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;\n  },\n\n  easeOutSine: function (t, b, _c, d) {\n    var c = _c - b;\n    return c * Math.sin(t / d * (Math.PI / 2)) + b;\n  },\n\n  easeInOutSine: function (t, b, _c, d) {\n    var c = _c - b;\n    return -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b;\n  },\n\n  easeInExpo: function (t, b, _c, d) {\n    var c = _c - b;\n    var _ref;\n    return (_ref = t === 0) !== null ? _ref : {\n      b: c * Math.pow(2, 10 * (t / d - 1)) + b,\n    };\n  },\n\n  easeOutExpo: function (t, b, _c, d) {\n    var c = _c - b;\n    var _ref;\n    return (_ref = t === d) !== null ? _ref : b + {\n      c: c * (-Math.pow(2, -10 * t / d) + 1) + b,\n    };\n  },\n\n  easeInOutExpo: function (t, b, _c, d) {\n    var c = _c - b;\n    if (t === 0) {\n      b;\n    }\n\n    if (t === d) {\n      b + c;\n    }\n\n    if ((t /= d / 2) < 1) {\n      return c / 2 * Math.pow(2, 10 * (t - 1)) + b;\n    } else {\n      return c / 2 * (-Math.pow(2, -10 * --t) + 2) + b;\n    }\n  },\n\n  easeInCirc: function (t, b, _c, d) {\n    var c = _c - b;\n    return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;\n  },\n\n  easeOutCirc: function (t, b, _c, d) {\n    var c = _c - b;\n    return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;\n  },\n\n  easeInOutCirc: function (t, b, _c, d) {\n    var c = _c - b;\n    if ((t /= d / 2) < 1) {\n      return -c / 2 * (Math.sqrt(1 - t * t) - 1) + b;\n    } else {\n      return c / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;\n    }\n  },\n\n  easeInElastic: function (t, b, _c, d) {\n    var c = _c - b;\n    var a, p, s;\n    s = 1.70158;\n    p = 0;\n    a = c;\n    if (t === 0) {\n      b;\n    } else if ((t /= d) === 1) {\n      b + c;\n    }\n\n    if (!p) {\n      p = d * 0.3;\n    }\n\n    if (a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(c / a);\n    }\n\n    return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n  },\n\n  easeOutElastic: function (t, b, _c, d) {\n    var c = _c - b;\n    var a, p, s;\n    s = 1.70158;\n    p = 0;\n    a = c;\n    if (t === 0) {\n      b;\n    } else if ((t /= d) === 1) {\n      b + c;\n    }\n\n    if (!p) {\n      p = d * 0.3;\n    }\n\n    if (a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(c / a);\n    }\n\n    return a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * (2 * Math.PI) / p) + c + b;\n  },\n\n  easeInOutElastic: function (t, b, _c, d) {\n    var c = _c - b;\n    var a, p, s;\n    s = 1.70158;\n    p = 0;\n    a = c;\n    if (t === 0) {\n      b;\n    } else if ((t /= d / 2) === 2) {\n      b + c;\n    }\n\n    if (!p) {\n      p = d * (0.3 * 1.5);\n    }\n\n    if (a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(c / a);\n    }\n\n    if (t < 1) {\n      return -0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n    } else {\n      return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * 0.5 + c + b;\n    }\n  },\n\n  easeInBack: function (t, b, _c, d, s) {\n    var c = _c - b;\n    if (s === void 0) {\n      s = 1.70158;\n    }\n\n    return c * (t /= d) * t * ((s + 1) * t - s) + b;\n  },\n\n  easeOutBack: function (t, b, _c, d, s) {\n    var c = _c - b;\n    if (s === void 0) {\n      s = 1.70158;\n    }\n\n    return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n  },\n\n  easeInOutBack: function (t, b, _c, d, s) {\n    var c = _c - b;\n    if (s === void 0) {\n      s = 1.70158;\n    }\n\n    if ((t /= d / 2) < 1) {\n      return c / 2 * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n    } else {\n      return c / 2 * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n    }\n  },\n\n  easeInBounce: function (t, b, _c, d) {\n    var c = _c - b;\n    var v;\n    v = tweenFunctions.easeOutBounce(d - t, 0, c, d);\n    return c - v + b;\n  },\n\n  easeOutBounce: function (t, b, _c, d) {\n    var c = _c - b;\n    if ((t /= d) < 1 / 2.75) {\n      return c * (7.5625 * t * t) + b;\n    } else if (t < 2 / 2.75) {\n      return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n    } else if (t < 2.5 / 2.75) {\n      return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n    } else {\n      return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n    }\n  },\n\n  easeInOutBounce: function (t, b, _c, d) {\n    var c = _c - b;\n    var v;\n    if (t < d / 2) {\n      v = tweenFunctions.easeInBounce(t * 2, 0, c, d);\n      return v * 0.5 + b;\n    } else {\n      v = tweenFunctions.easeOutBounce(t * 2 - d, 0, c, d);\n      return v * 0.5 + c * 0.5 + b;\n    }\n  },\n};\n\nexport default tweenFunctions;\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/utils/tweenFunctions.js","import * as THREE from 'three';\nimport { mapObjIndexed } from 'ramda';\nimport { get, getAll, getWorldTransform, set } from '../scene';\nimport CONSTANTS from './physicsConstants';\nimport triangulateMesh from '../../polyMesh/geometric/operator/triangulateMesh';\n\n// re-usable threeJS matrix decompose targets\nconst translation = new THREE.Vector3();\nconst rotation = new THREE.Quaternion();\nconst scale = new THREE.Vector3();\n\nfunction initWorld(store) {\n  const collisionConfiguration = new Ammo.btDefaultCollisionConfiguration();\n  const dispatcher = new Ammo.btCollisionDispatcher(collisionConfiguration);\n  const overlappingPairCache = new Ammo.btDbvtBroadphase();\n  const solver = new Ammo.btSequentialImpulseConstraintSolver();\n  const dynamicsWorld = new Ammo.btDiscreteDynamicsWorld(dispatcher, overlappingPairCache, solver, collisionConfiguration);\n\n  let gravity = get(store, { plug: 'Player', property: 'gravity' });\n  if (!gravity) gravity = new THREE.Vector3(0, -9.8, 0);\n  dynamicsWorld.setGravity(new Ammo.btVector3(gravity.x, gravity.y, gravity.z));\n  return dynamicsWorld;\n}\n\n\nfunction createConvexHullFromPolyMesh(polyMesh) {\n  const shape = new Ammo.btConvexHullShape();\n  const verts = polyMesh.positions.values;\n\n  const tmpVec3 = new THREE.Vector3();\n  for (let i = 0; i < verts.length; i++) {\n    verts.getAt(i, tmpVec3);\n    const pt = new Ammo.btVector3(tmpVec3.x, tmpVec3.y, tmpVec3.z);\n    shape.addPoint(pt);\n  }\n  return shape;\n}\n\n\nfunction createCollisionMeshFromPolyMesh(polyMesh, store, id) {\n  // try to get already-triangulated mesh from ThreeJS, otherwise create new triangulation to use\n  const threeMesh = store.getTranslator().getThreeObject(id);\n  let triMesh = null;\n  if (threeMesh && threeMesh.userData && threeMesh.userData.triangulation) {\n    triMesh = threeMesh.userData.triangulation.mesh;\n  }\n  if (!triMesh) {\n    triMesh = triangulateMesh(polyMesh);\n  }\n\n  const verts = triMesh.positions.values;\n  const indices = triMesh.positions.faceValueIndices;\n\n  const mesh = new Ammo.btTriangleMesh(true, true);\n\n  const tmpVec3a = new THREE.Vector3();\n  const tmpVec3b = new THREE.Vector3();\n  const tmpVec3c = new THREE.Vector3();\n  for (let i = 0; i < indices.length; i+=3) {\n    verts.getAt(i, tmpVec3a);\n    verts.getAt(i+1, tmpVec3b);\n    verts.getAt(i+2, tmpVec3c);\n    const ptA = new Ammo.btVector3(tmpVec3a.x, tmpVec3a.y, tmpVec3a.z);\n    const ptB = new Ammo.btVector3(tmpVec3b.x, tmpVec3b.y, tmpVec3b.z);\n    const ptC = new Ammo.btVector3(tmpVec3c.x, tmpVec3c.y, tmpVec3c.z);\n\n    mesh.addTriangle(ptA, ptB, ptC, false);\n  }\n\n  const shape = new Ammo.btBvhTriangleMeshShape(mesh, true, true);\n  return shape;\n}\n\n\nfunction createBoundingBoxShapeFromNode(nodeID, bbox) {\n  const halfExtents = new Ammo.btVector3((bbox.max.x - bbox.min.x) / 2, (bbox.max.y - bbox.min.y) / 2, (bbox.max.z - bbox.min.z) / 2);\n  return new Ammo.btBoxShape(halfExtents);\n}\n\n\n/*\n * Creates the Dynamics World, and initializes the Kinematic and Dynamic Bodies\n */\nexport function initPhysics(store) {\n  const kinematicBodies = {};\n  const dynamicBodies = {};\n\n  function createBodyWithProps(props, id) {\n    let isKinematic = false;\n    let isStatic = false;\n    if (props.motionType === 'Kinematic') isKinematic = true;\n    if (props.motionType === 'Static') isStatic = true;\n\n    let colShape = null;\n    let shapeLocalTransform = null;\n\n    const worldTransformV2 = getWorldTransform(store, id);\n    worldTransformV2.decompose(translation, rotation, scale);\n\n    const shapeType = props.collisionShape;\n\n    if (shapeType === 'Mesh') {\n      const polyMesh = get(store, { id, evalPlug: 'PolyMesh', property: 'mesh' });\n      if (polyMesh) {\n        colShape = createCollisionMeshFromPolyMesh(polyMesh, store, id);\n        colShape.setLocalScaling(new Ammo.btVector3(scale.x, scale.y, scale.z));\n      }\n    }\n    else if (shapeType === 'Box') {\n      const bbox = api.scene.getNodeBoundingBox(id);\n      colShape = createBoundingBoxShapeFromNode(id, bbox);\n      const bbCenter = new THREE.Vector3((bbox.max.x + bbox.min.x) / 2, (bbox.max.y + bbox.min.y) / 2, (bbox.max.z + bbox.min.z) / 2);\n      shapeLocalTransform = new THREE.Matrix4().getInverse(worldTransformV2, true);\n      shapeLocalTransform.multiply(new THREE.Matrix4().makeTranslation(bbCenter.x, bbCenter.y, bbCenter.z));\n      // bounding box already uses scaling?\n    }\n    else { // 'Convex'\n      const polyMesh = get(store, { id, evalPlug: 'PolyMesh', property: 'mesh' });\n      if (polyMesh) {\n        colShape = createConvexHullFromPolyMesh(polyMesh);\n        // convex hull is created from base geometry, so still need to scale appropriately\n        colShape.setLocalScaling(new Ammo.btVector3(scale.x, scale.y, scale.z));\n        // colShape.setMargin(0.01);\n      }\n    }\n\n    if (!colShape) {\n      const nodeName = get(store, { id, property: 'name' });\n      console.warn(`Could not create collision shape for '${nodeName}', defaulting to a unit sphere`);\n      colShape = new Ammo.btSphereShape(1);\n    }\n\n    // some shapes need custom offset compensation relative to the node's transform to be positioned/oriented correctly\n    if (shapeLocalTransform) {\n      worldTransformV2.multiply(shapeLocalTransform);\n    }\n\n    worldTransformV2.decompose(translation, rotation, scale);\n\n    const startTransform = new Ammo.btTransform();\n    startTransform.setIdentity();\n    startTransform.setOrigin(new Ammo.btVector3(translation.x, translation.y, translation.z));\n    startTransform.setRotation(new Ammo.btQuaternion(rotation.x, rotation.y, rotation.z, rotation.w));\n\n    const mass = (isKinematic || isStatic) ? 0 : props.mass;\n    const isDynamic = (mass !== 0);\n    const localInertia = new Ammo.btVector3(0, 0, 0);\n    if (isDynamic) {\n      colShape.calculateLocalInertia(mass, localInertia);\n    }\n\n    const myMotionState = new Ammo.btDefaultMotionState(startTransform);\n    const rbInfo = new Ammo.btRigidBodyConstructionInfo(mass, myMotionState, colShape, localInertia);\n    rbInfo.m_linearDamping = props.linearDamping;\n    rbInfo.m_angularDamping = props.angularDamping;\n    rbInfo.m_friction = props.friction;\n    rbInfo.m_rollingFriction = props.rollingFriction;\n    rbInfo.m_linearSleepingThreshold = props.linearSleepingThreshold;\n    rbInfo.m_angularSleepingThreshold = props.angularSleepingThreshold;\n    rbInfo.m_restitution = props.restitution;\n    const body = new Ammo.btRigidBody(rbInfo);\n\n    if (isKinematic) {\n      body.setCollisionFlags(body.getCollisionFlags() | CONSTANTS.BODYFLAG_KINEMATIC_OBJECT);\n      body.setActivationState(CONSTANTS.BODYSTATE_DISABLE_DEACTIVATION);\n    }\n\n    dynamicsWorld.addRigidBody(body);\n    if (isKinematic) kinematicBodies[id] = { body, shapeLocalTransform };\n    else if (!isStatic) dynamicBodies[id] = { body, shapeLocalTransform };\n    // don't need to do process any updates with static bodies after they are added to the world\n  }\n\n  const dynamicsWorld = initWorld(store);\n\n  const physicsNodes = getAll(store, { plug: 'Properties', properties: { name: 'RigidBodyProperties' } });\n\n  mapObjIndexed(createBodyWithProps, physicsNodes);\n\n  return { dynamicsWorld, kinematicBodies, dynamicBodies };\n}\n\n\n// Where do we want to perform this cleanup in the context of the V2 player?\nfunction cleanupPhysics() {\n  // Delete objects we created through |new|. We just do a few of them here, but you should do them all if you are not shutting down ammo.js\n  // we'll free the objects in reversed order as they were created via 'new' to avoid the 'dead' object links\n  // Ammo.destroy(dynamicsWorld);\n  // Ammo.destroy(solver);\n  // Ammo.destroy(overlappingPairCache);\n  // Ammo.destroy(dispatcher);\n  // Ammo.destroy(collisionConfiguration);\n}\n\n\nconst internalSimulationInterval = 1/60;\nconst maxSubsteps = 4;\n\nexport function updatePhysics(store, delta, globalTime, dynamicsWorld, dynamicBodies, kinematicBodies) {\n  // run simulation step\n  // see http://bulletphysics.org/mediawiki-1.5.8/index.php/Stepping_The_World for param details\n  // (actual deltaT in seconds, max # substeps, fixed minimum internal timestep)\n  dynamicsWorld.stepSimulation(delta/1000, maxSubsteps, internalSimulationInterval);\n\n  const trans = new Ammo.btTransform();\n  let rotationPhysics = new Ammo.btQuaternion();\n  const translationPhysics = new Ammo.btVector3();\n  const threeQuat = new THREE.Quaternion();\n  const euler = new THREE.Euler();\n\n  // process kinematic bodies\n  Object.keys(kinematicBodies).forEach((id) => {\n    const body = kinematicBodies[id].body;\n    const worldTransformV2 = getWorldTransform(store, id);\n\n    if (kinematicBodies[id].shapeLocalTransform) {\n      worldTransformV2.premultiply(kinematicBodies[id].shapeLocalTransform);\n    }\n\n    worldTransformV2.decompose(translation, rotation, scale);\n\n    const motionState = body.getMotionState();\n    const worldTransformPhysics = body.getWorldTransform();\n\n    translationPhysics.setX(translation.x);\n    translationPhysics.setY(translation.y);\n    translationPhysics.setZ(translation.z);\n\n    rotationPhysics.setX(rotation.x);\n    rotationPhysics.setY(rotation.y);\n    rotationPhysics.setZ(rotation.z);\n    rotationPhysics.setW(rotation.w);\n\n    worldTransformPhysics.setOrigin(translationPhysics);\n    worldTransformPhysics.setRotation(rotationPhysics);\n    motionState.setWorldTransform(worldTransformPhysics);\n  });\n\n  // process dynamic bodies\n  Object.keys(dynamicBodies).forEach((id) => {\n    const body = dynamicBodies[id].body;\n    body.getMotionState().getWorldTransform(trans);\n    store.dispatch(set({ id, plug: 'Transform', property: 'translation' },\n      [trans.getOrigin().x(), trans.getOrigin().y(), trans.getOrigin().z()]));\n\n    rotationPhysics = trans.getRotation();\n    rotation.set(rotationPhysics.x(), rotationPhysics.y(), rotationPhysics.z(), rotationPhysics.w());\n    euler.setFromQuaternion(rotation, 'ZYX');\n\n    store.dispatch(set({ id, plug: 'Transform', property: 'rotation' },\n      [THREE.Math.RAD2DEG * euler.x, THREE.Math.RAD2DEG * euler.y, THREE.Math.RAD2DEG * euler.z]));\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/utils/physics.js","\n// Adapted from:\n// https://github.com/playcanvas/engine/blob/18bdc36d108031beca3fbfab948feb911eea2159/src/framework/components/rigid-body/constants.js\n\n// Copyright (c) 2011-2017 PlayCanvas Ltd.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\nconst CONSTANTS = {\n  // types\n  BODYTYPE_STATIC: 'Static',\n  BODYTYPE_DYNAMIC: 'Dynamic',\n  BODYTYPE_KINEMATIC: 'Kinematic',\n\n  // Collision flags\n  BODYFLAG_STATIC_OBJECT: 1,\n  BODYFLAG_KINEMATIC_OBJECT: 2,\n  BODYFLAG_NORESPONSE_OBJECT: 4,\n\n  // Activation states\n  BODYSTATE_ACTIVE_TAG: 1,\n  BODYSTATE_ISLAND_SLEEPING: 2,\n  BODYSTATE_WANTS_DEACTIVATION: 3,\n  BODYSTATE_DISABLE_DEACTIVATION: 4,\n  BODYSTATE_DISABLE_SIMULATION: 5,\n\n  // groups\n  BODYGROUP_NONE: 0,\n  BODYGROUP_DEFAULT: 1,\n  BODYGROUP_DYNAMIC: 1,\n  BODYGROUP_STATIC: 2,\n  BODYGROUP_KINEMATIC: 4,\n  BODYGROUP_ENGINE_1: 8,\n  BODYGROUP_TRIGGER: 16,\n  BODYGROUP_ENGINE_2: 32,\n  BODYGROUP_ENGINE_3: 64,\n  BODYGROUP_USER_1: 128,\n  BODYGROUP_USER_2: 256,\n  BODYGROUP_USER_3: 512,\n  BODYGROUP_USER_4: 1024,\n  BODYGROUP_USER_5: 2048,\n  BODYGROUP_USER_6: 4096,\n  BODYGROUP_USER_7: 8192,\n  BODYGROUP_USER_8: 16384,\n\n  // masks\n  BODYMASK_NONE: 0,\n  BODYMASK_ALL: 65535,\n  BODYMASK_STATIC: 2,\n  BODYMASK_NOT_STATIC: 65535 ^ 2,\n  BODYMASK_NOT_STATIC_KINEMATIC: 65535 ^ (2 | 4),\n}\n\nexport default CONSTANTS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/utils/physicsConstants.js","import PolyMap from '../model/PolyMap';\nimport ScalarArrayView from '../../generic/container/ScalarArrayView';\nimport SimpleFanTriangulation from '../algorithm/SimpleFanTriangulation';\nimport applyFunctionToPolyMap from './applyFunctionToPolyMap';\n\nexport default function triangulateMesh(polyMesh) {\n\n  function triangulateMap(polyMap, polyMapName, additionalArguments) {\n    const newFaceRangeOffsets = additionalArguments.newFaceRangeOffsets;\n    const triangulation = additionalArguments.triangulation;\n\n    const result = new ScalarArrayView(triangulation.numTriangles * 3);\n    triangulation.translateIndices(polyMap.faceValueIndices, result);\n    const newFaceValueIndices = result.data;\n\n    return new PolyMap({\n      faceRangeOffsets: newFaceRangeOffsets,\n      faceValueIndices: newFaceValueIndices,\n      values: polyMap.values,\n    });\n  };\n\n  const triangulation = new SimpleFanTriangulation(polyMesh);\n\n  const newFaceRangeOffsets = new Uint32Array(triangulation.numTriangles + 1);\n  for (let i = 1; i < newFaceRangeOffsets.length; i++) {\n    newFaceRangeOffsets[i] = newFaceRangeOffsets[i - 1] + 3;\n  }\n\n  const args = { newFaceRangeOffsets, triangulation };\n  return applyFunctionToPolyMap(polyMesh, triangulateMap, args).topologyChanged();\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyMesh/geometric/operator/triangulateMesh.js","import { Map } from 'immutable';\nimport createReducer from './utils/createReducer';\nimport { CLEAR_SCENE } from './actionTypes';\n\nconst SET_ANNOTATION_PROPERTIES = 'SET_ANNOTATION_PROPERTIES';\nconst USE_CUSTOM_ANNOTATION_FUNCTION = 'USE_CUSTOM_ANNOTATION_FUNCTION';\n\n/**\n * Annotations\n *\n * @module annotations\n * @public\n *\n */\n\nconst initialState = Map({\n  customAnnotationFn: null,\n});\n\nconst reducer = createReducer(initialState, {\n  [SET_ANNOTATION_PROPERTIES](state, { id, attrs }) {\n    let props = state.get('id') || Map();\n    return state.set(id, props.merge(attrs));\n  },\n\n  [USE_CUSTOM_ANNOTATION_FUNCTION](state, annotationFn) {\n    return state.set('customAnnotationFn', annotationFn);\n  },\n\n  [CLEAR_SCENE](state) {\n    return Map({ customAnnotationFn: state.get('customAnnotationFn') });\n  },\n});\n\nexport function setAnnotationProperties(id, attrs) {\n  return { type: SET_ANNOTATION_PROPERTIES, payload: { id, attrs } };\n};\n\n/**\n * Open annotation node in the player.\n * @param {String} id - id of the annotation node.\n * @public\n */\nexport function openAnnotation(id) {\n  return { type: SET_ANNOTATION_PROPERTIES, payload: { id, attrs: { pinned: true, open: true } } };\n};\n\n/**\n * Close annotation node.\n * @param {String} id - id of the annotation node.\n * @public\n */\nexport function closeAnnotation(id) {\n  return { type: SET_ANNOTATION_PROPERTIES, payload: { id, attrs: { pinned: false, open: false } } };\n};\n\n/**\n * Use custom annotations. Set a custom function that will be called for every\n * annotation on every scene update. The arguments passed to this function\n * will be the [annotation object](global.html#Annotation), and the div that\n * any annotations may be created under. This div has `pointer-events` set\n * to none so that the scene below it will receive all mouse/touch events.\n * If you wish to handle events in your annotations, make sure to set `pointer-events`.\n *\n * @public\n * @param {Function} fn The function to be called for every annotation update.\n */\nexport function useCustomAnnotationFunction(fn) {\n  return { type: USE_CUSTOM_ANNOTATION_FUNCTION, payload: fn };\n};\n\nexport function getCustomAnnotationFunction(store) {\n  return store.getIn(['annotations', 'customAnnotationFn']);\n};\n\nconst publicApi = {\n  reducer,\n  actions: {\n    setAnnotationProperties, openAnnotation, closeAnnotation,\n    useCustomAnnotationFunction,\n  },\n  selectors: { getCustomAnnotationFunction },\n};\n\nexport default publicApi;\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/annotations.js","import * as THREE from 'three';\nimport { fromJS, Map, List } from 'immutable';\nimport createReducer from './utils/createReducer';\nimport { get, getWorldTransform, set, find } from './scene';\nimport { queueAnimation } from './animation';\nimport { touch, virtualCameraId, vrCameraId, virtualTargetId, merge } from './sceneGraph';\nimport updateCameraLookAtTarget from '../translators/utils/updateCameraLookAtTarget';\nimport calculateBoundingBox from '../translators/utils/calculateBoundingBox';\nimport { initCamera } from '../translators/camera';\nimport setMatrixOnNode from '../translators/utils/setMatrixOnNode';\nimport decompose from '../translators/utils/decompose';\nimport getTargetWorldMatrix from '../translators/utils/getTargetWorldMatrix';\nimport { addCommand, deactivateCommand, removeCommand, updateCommand } from './commands';\n\nexport const RENDER_MODES = {\n  normal: 'normal',\n  vr: 'vr',\n  lenticular: 'lenticular',\n};\n\n/**\n * This module supports the UI for the player.\n *\n * @module player\n * @public\n */\n\nexport const manipulators = {\n  orbit: 'orbit',\n  pan: 'pan',\n  zoom: 'zoom',\n  nodeRotate: 'nodeRotate',\n  nodeMove: 'nodeMove',\n  nodeScale: 'nodeScale',\n};\n\nconst USE_MANIPULATOR = 'USE_MANIPULATOR';\nconst SET_CAMERA = 'SET_CAMERA';\nconst SET_PREV_CAMERA = 'SET_PREV_CAMERA';\nconst SET_CAMERA_ATTRS = 'SET_CAMERA_ATTRS';\nconst SET_CAMERA_POSITION = 'SET_CAMERA_POSITION';\nconst SET_RECT = 'SET_RECT';\nconst DISPLAY_THUMBNAIL = 'DISPLAY_THUMBNAIL';\nconst SET_ACTIVE_COLOR = 'SET_ACTIVE_COLOR';\nconst SET_HOVER_COLOR = 'SET_HOVER_COLOR';\nconst SET_PLAYER_ELEMENT = 'SET_PLAYER_ELEMENT';\nconst REQUEST_FULL_SCREEN = 'REQUEST_FULL_SCREEN';\nconst EXIT_FULL_SCREEN = 'EXIT_FULL_SCREEN';\nconst SET_FULL_SCREEN = 'SET_FULL_SCREEN';\nconst SET_RENDER_MODE = 'SET_RENDER_MODE';\n\nconst REQUEST_NORMAL_MODE = 'REQUEST_NORMAL_MODE';\nconst REQUEST_LENTICULAR_MODE = 'REQUEST_LENTICULAR_MODE';\nconst SET_DEVICE_TRACKING = 'SET_DEVICE_TRACKING';\nconst SET_BACKGROUND_COLOR = 'SET_BACKGROUND_COLOR';\nconst REQUEST_STEREO_MODE = 'REQUEST_STEREO_MODE';\nconst REQUEST_PARALLAX_MODE = 'REQUEST_PARALLAX_MODE';\nconst EXIT_STEREOPARALLAX_MODE = 'EXIT_STEREOPARALLAX_MODE';\nconst SET_CONSTRAIN_CAMERA_RADIUS = 'SET_CONSTRAIN_CAMERA_RADIUS';\nconst SET_THREE_SCENE = 'SET_THREE_SCENE';\n\nconst initialState = Map({\n  activeColor: '#ffc85f',\n  hoverColor: '#C08618',\n  fullscreenBackgroundColor: '#FFF',\n  activeManipulator: manipulators.orbit,\n  fullScreen: false,\n  renderingMode: RENDER_MODES.normal,\n  deviceTracking: false,\n  camera: Map({\n    polarAngle: null, azimuthAngle: null, boundingRadius: null,\n  }),\n  rect: Map({ width: 400, height: 300 }),\n  initialCameraWorldMatrix: null,\n  initialTargetWorldMatrix: null,\n  cameraWorldMatrix: null,\n  displayThumbnail: true,\n  playerElement: null,\n  canvasElement: null,\n  activeCamera: virtualCameraId,\n  vrCamera: vrCameraId,\n  threeScene: null,\n  prevCamera: null,\n  orientationHandler: null,\n  constrainCameraRadius: null,\n});\n\nconst reducer = createReducer(initialState, {\n  [USE_MANIPULATOR](state, manipulator) {\n    return state.set('activeManipulator', manipulator);\n  },\n\n  [SET_CAMERA](state, { id, prevCameraId }) {\n    return state.set('activeCamera', id).set('prevCamera', prevCameraId);\n  },\n\n  [SET_CAMERA_ATTRS](state, attrs) {\n    return state.mergeIn(['camera'], attrs);\n  },\n\n  [SET_RECT](state, rect) {\n    return state.set('rect', rect);\n  },\n\n  [SET_CAMERA_POSITION](state, attrs) {\n    return state.merge(attrs);\n  },\n\n  [SET_PLAYER_ELEMENT](state,  { playerEl, canvasEl }) {\n    return state.set('playerElement', playerEl).set('canvasElement', canvasEl);\n  },\n\n  [DISPLAY_THUMBNAIL](state, display) {\n    return state.set('displayThumbnail', !!display);\n  },\n\n  [SET_ACTIVE_COLOR](state, color) {\n    return state.set('activeColor', color);\n  },\n\n  [SET_HOVER_COLOR](state, color) {\n    return state.set('hoverColor', color);\n  },\n\n  [SET_BACKGROUND_COLOR](state, color) {\n    return state.set('fullscreenBackgroundColor', color);\n  },\n\n  [REQUEST_FULL_SCREEN](state) {\n    return state.set('fullScreen', true);\n  },\n\n  [EXIT_FULL_SCREEN](state) {\n    return state.set('fullScreen', false);\n  },\n\n  [SET_FULL_SCREEN](state, fullScreen) {\n    return state.set('fullScreen', fullScreen);\n  },\n\n  [SET_RENDER_MODE](state, mode) {\n    return state.set('renderingMode', mode);\n  },\n\n  [REQUEST_LENTICULAR_MODE](state, { trackDevice, cameraId }) {\n    return state.merge({\n      renderingMode: 'lenticular',\n      deviceTracking: trackDevice,\n      prevCamera: cameraId,\n    });\n  },\n\n  [REQUEST_NORMAL_MODE](state) {\n    return state.merge({\n      renderingMode: 'normal',\n      deviceTracking: false,\n    });\n  },\n\n  [SET_DEVICE_TRACKING](state, deviceTracking) {\n    return state.set('deviceTracking', deviceTracking);\n  },\n\n  [SET_CONSTRAIN_CAMERA_RADIUS](state, radius) {\n    return state.set('constrainCameraRadius', radius);\n  },\n\n  [SET_THREE_SCENE](state, { scene, camera }) {\n    return state.set('threeScene', scene).set('threeCamera', camera);\n  },\n});\n\nexport function useManipulator(manipulator) {\n  return { type: USE_MANIPULATOR, payload: manipulator };\n}\n\nexport function getActiveManipulator(store) {\n  return store.getIn(['player', 'activeManipulator']);\n}\n\n\n/**\n * Add a tool (See {@tutorial sdk-Tools})\n *\n * @public\n * @param {Tool} Tool\n * @param {String} name provide a name for the tool to allow removing it.\n * @returns {Promise}\n *\n */\nexport function addTool(tool, name) {\n  return addCommand({ tool, enabled: true }, name);\n}\n\n/**\n * Remove a tool (See {@tutorial sdk-Tools})\n *\n * @public\n * @param {String} name The name of the tool to remove\n * @returns {Promise}\n */\nexport function removeTool(name) {\n  return removeCommand(name);\n}\n\nexport function showTool(name) {\n  return updateCommand(name, { display: { playerTools: true } });\n}\n\nexport function hideTool(name) {\n  return updateCommand(name, { display: { playerTools: false } });\n}\n\nexport function updateToolOptions(name, options) {\n  return { type: UPDATE_COMMAND_OPTIONS, payload: { name, options } };\n}\n\nexport function getRect(store) {\n  return store.getIn(['player', 'rect']);\n}\n\nexport function setRect(rect) {\n  return { type: SET_RECT, payload: rect };\n}\n\nexport function setCameraAttrs(attrs) {\n  return { type: SET_CAMERA_ATTRS, payload: attrs };\n}\n\nexport function getCameraAttrs(store) {\n  return store.getIn(['player', 'camera']);\n}\n\n/**\n * Returns the world matrix of the active camera\n */\nexport function getCameraWorldTransform(store) {\n  return getWorldTransform(store, store.getIn(['player', 'activeCamera']));\n}\n\n/**\n * This sets the scene to use the camera.\n */\nexport function useCamera(id) {\n  return (store) => {\n    // store.dispatch(setCamera(id, getCamera(store)));\n    return store.dispatch(set({ scene: true, plug: 'Player', property: 'camera' }, id));\n  };\n}\n\nexport function useVrCamera(switchToVR) {\n  return (store) => {\n    if (switchToVR) {\n      const activeCamera = store.getIn(['player', 'activeCamera']);\n      store.dispatch(setCamera(vrCameraId, activeCamera));\n    } else {\n      const prevCamera = store.getIn(['player', 'prevCamera']) || virtualCameraId;\n      store.dispatch(setCamera(prevCamera, null));\n    }\n  };\n}\n\n/**\n * Sets the active camera for the scene\n * @private\n */\nexport function setCamera(id, prevCameraId) {\n  return (store) => {\n    const target = getTargetWorldMatrix(store, prevCameraId);\n    const oldCamData = get(store, { id: prevCameraId, evalPlug: 'Camera' });\n    const oldCameraTransform = get(store, { id: prevCameraId, evalPlug: 'Transform' });\n    if (oldCameraTransform && !oldCameraTransform.target) {\n      oldCamData.targetWorldMatrix = target;\n    }\n\n    const newCamData = get(store, { id, evalPlug: 'Camera' });\n    if (newCamData.targetWorldMatrix) {\n      store.dispatch(merge([virtualTargetId, 'Transform', 0], decompose(newCamData.targetWorldMatrix)));\n      newCamData.targetWorldMatrix = null;\n    }\n\n    store.dispatch({ type: SET_CAMERA, payload: { id, prevCameraId } });\n  };\n}\n\n/**\n * @private\n */\nexport function setThreeScene(scene, camera) {\n  return { type: SET_THREE_SCENE, payload: { scene, camera } };\n}\n\nexport function getThreeScene(store) {\n  return store.getIn(['player', 'threeScene']);\n}\n\nexport function getThreeCamera(store) {\n  return store.getIn(['player', 'threeCamera']);\n}\n\nexport function getBoundingBox(store) {\n  const threeScene = getThreeScene(store);\n  return calculateBoundingBox(threeScene);\n}\n\n/**\n * Returns the current active camera\n * @public\n */\nexport function getCamera(store) {\n  return store.getIn(['player', 'activeCamera']);\n}\n\nexport function getTools(store) {\n  return store.getIn(['player', 'tools']);\n}\n\nexport function setCameraPosition(attrs) {\n  return { type: SET_CAMERA_POSITION, payload: attrs };\n}\n\nexport function getInitialCameraPosition(store) {\n  return {\n    initialCameraWorldMatrix: store.getIn(['player', 'initialCameraWorldMatrix']),\n    initialTargetWorldMatrix: store.getIn(['player', 'initialTargetWorldMatrix']),\n  };\n}\n\n/**\n *\n * Enable fullscreen mode.\n * @public\n *\n */\nexport function requestFullscreen() {\n  return (store) => {\n    const playerEl = store.getIn(['player', 'playerElement']);\n    ['requestFullscreen', 'webkitRequestFullscreen', 'mozRequestFullScreen', 'msRequestFullscreen'].forEach(function (fn) {\n      if (playerEl[fn]) return playerEl[fn]();\n    });\n\n    store.dispatch({ type: REQUEST_FULL_SCREEN });\n  };\n}\n\n/**\n * Exit fullscreen mode\n * @public\n */\nexport function exitFullscreen() {\n  return (store) => {\n    ['exitFullscreen', 'webkitExitFullscreen', 'mozCancelFullScreen', 'msExitFullscreen'].forEach(function (fn) {\n      if (document[fn]) return document[fn]();\n    });\n\n    return store.dispatch({ type: EXIT_FULL_SCREEN });\n  };\n};\n\n/**\n * Toggle fullscreen mode\n * @public\n *\n */\nexport function toggleFullscreen() {\n  return (store) => {\n    return store.dispatch(isFullscreen(store) ? exitFullscreen() : requestFullscreen());\n  };\n};\n\n/**\n * Check whether were in fullscreen mode.\n * @public\n *\n */\nexport function isFullscreen(store) {\n  return store.getIn(['player', 'fullScreen']);\n};\n\n/**\n * Set the value of fullscreen (set on an event handler, if the native\n * browser control is used to escape full screen mode.\n */\nexport function setFullscreen(fullScreen) {\n  return (store) => {\n    if (isFullscreen(store) !== fullScreen) {\n      store.dispatch({ type: SET_FULL_SCREEN, payload: fullScreen });\n    }\n\n    if (!fullScreen && isVRMode(store)) {\n      store.dispatch(deactivateCommand('vrMode'));\n    }\n  };\n};\n\nexport function getRenderingMode(store) {\n  return store.getIn(['player', 'renderingMode']);\n}\n\n/**\n * @public\n *\n */\nexport function isNormalRenderingMode(store) {\n  return (store.getIn(['player', 'renderingMode']) === RENDER_MODES.normal);\n};\n\n/**\n * Check whether we are in VR mode.\n * @public\n *\n */\nexport function isVRMode(store) {\n  return (store.getIn(['player', 'renderingMode']) === RENDER_MODES.vr);\n};\n\n/**\n * Check whether we are in Lenticular rendering mode.\n * @public\n */\nexport function isLenticularMode(store) {\n  return (store.getIn(['player', 'renderingMode']) === RENDER_MODES.lenticular);\n};\n\nexport function activateTool(toolName) {\n  return (store) => {\n    const tool = store.getIn(['player', 'tools', toolName]);\n    if (!tool) return;\n    if (tool.get('action')) return tool.get('action')(store);\n    const isActive = _isToolActive(store, tool);\n    if (tool.get('activate') && !isActive) return tool.get('activate')(store);\n    if (tool.get('deactivate') && isActive) return tool.get('deactivate')(store);\n    return store.dispatch(useManipulator(toolName));\n  };\n}\n\nfunction _isToolActive(store, tool) {\n  if (tool.get('isActive')) return tool.get('isActive')(store);\n  return store.getIn(['player', 'activeManipulator']) === tool.get('name');\n}\n\nexport function isToolActive(store, toolName) {\n  const tool = store.getIn(['player', 'tools', toolName]);\n  return tool && _isToolActive(store, tool);\n}\n\nexport function getActiveTools(store) {\n  return store.getIn(['player', 'tools']).filter((tool) => _isToolActive(store, tool));\n}\n\nexport function requestLenticularMode({ trackDevice }) {\n  return (store) => {\n    store.dispatch(requestFullscreen());\n    const cameraId = getCamera(store);\n    store.dispatch({ type: REQUEST_LENTICULAR_MODE, payload: { trackDevice, cameraId } });\n  };\n};\n\nexport function requestNormalMode() {\n  return { type: REQUEST_NORMAL_MODE };\n};\n\nexport function getPrevCamera(store) {\n  return store.getIn(['player', 'prevCamera']);\n}\n\nexport function setRenderMode(mode) {\n  if (!RENDER_MODES[mode]) throw new Error(`Invalid Render Mode: ${mode}`);\n  return { type: SET_RENDER_MODE, payload: mode };\n}\n\nexport function toggleLenticularMode() {\n  return (store) => {\n    store.dispatch(isLenticularMode(store) ?  requestNormalMode() : requestLenticularMode({}));\n  };\n};\n\nexport function enableDeviceTracking() {\n  return { type: SET_DEVICE_TRACKING, payload: true };\n};\n\nexport function disableDeviceTracking() {\n  return { type: SET_DEVICE_TRACKING, payload: false };\n};\n\nexport function toggleDeviceTracking() {\n  return (store) => {\n    console.log('toggle device tracking', !isDeviceTracking(store));\n    store.dispatch(isDeviceTracking(store) ?  disableDeviceTracking() : enableDeviceTracking());\n  };\n};\n\nexport function isDeviceTracking(store) {\n  return store.getIn(['player', 'deviceTracking']);\n};\n\n\n/**\n * Store the rendered player element\n */\nexport function setPlayerElement(playerEl, canvasEl) {\n  return { type: SET_PLAYER_ELEMENT, payload: { playerEl, canvasEl } };\n};\n\n/**\n * Set the active color and timeline color to be used for the player css.\n *\n * @public\n * @param {Color} color a valid css color (ex. '#ff0000'}.\n * @returns {Promise}\n *\n */\nexport function setActiveColor(color) {\n  return { type: SET_ACTIVE_COLOR, payload: color };\n};\n\n/**\n * Set the hover color to be used for the player css.\n *\n * @public\n * @param {Color} color a valid css color (ex. '#ff0000'}.\n * @returns {Promise}\n *\n */\nexport function setHoverColor(color) {\n  return { type: SET_HOVER_COLOR, payload: color };\n};\n\n/**\n * Set the fullscreen background color to be used for the player css.\n *\n * @public\n * @param {Color} color a valid css color (ex. '#ff0000'}.\n * @returns {Promise}\n *\n */\nexport function setFullscreenBGColor(color) {\n  return { type: SET_BACKGROUND_COLOR, payload: color };\n};\n\n/**\n * Return the active color.\n *\n * @public\n */\nexport function getActiveColor(store) {\n  return store.getIn(['player', 'activeColor']);\n};\n\n/**\n * Return the hover color.\n *\n * @public\n */\nexport function getHoverColor(store) {\n  return store.getIn(['player', 'hoverColor']);\n};\n\n/**\n * Return the fullscreen background color.\n *\n * @public\n */\nexport function getFullscreenBGColor(store) {\n  return store.getIn(['player', 'fullscreenBackgroundColor']);\n};\n\nfunction slerpTween(startMatrix, endMatrix) {\n  const startPosition = new THREE.Vector3();\n  const startQuaternion = new THREE.Quaternion();\n  const scale = new THREE.Vector3(1, 1, 1);\n  startMatrix.decompose(startPosition, startQuaternion, scale);\n\n  const endPosition = new THREE.Vector3();\n  const endQuaternion = new THREE.Quaternion();\n  endMatrix.decompose(endPosition, endQuaternion, scale);\n\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n  scale.set(1, 1, 1);\n  const matrix = new THREE.Matrix4();\n\n  return function (time, start, end, duration) {\n    position.lerpVectors(startPosition, endPosition, time / duration);\n    THREE.Quaternion.slerp(startQuaternion, endQuaternion, quaternion, time / duration);\n    matrix.compose(position, quaternion, scale);\n    return matrix;\n  };\n};\n\n/**\n * Animate the camera to the position of another.\n *\n * @public\n * @param {String} id - the id of the camera to move to.\n * @param {Number} duration - length of the animation (ms), default 300.\n * @returns {Promise}\n */\nexport function animateCameraTo(id, duration) {\n  return (store) => {\n    const cameraId = getCamera(store);\n    if (!cameraId || !id) return;\n\n    let prep = Promise.resolve();\n\n    // if camera is targeted, temporarily disable targeting during animation\n    const camTarget = find(store, { id: cameraId, plug: 'Transform', property: 'target' });\n    let targetingDisabled = false;\n    if (camTarget && get(store, { id: cameraId, plug: 'Camera', property: 'targeted' })) {\n      const target = get(store, camTarget);\n      if (target) {\n        prep = store.dispatch(set({ id: cameraId, plug: 'Camera', property: 'targeted' }, false));\n        targetingDisabled = true;\n      }\n    }\n\n    return prep.then(() => {\n      const currentCameraTransform = getWorldTransform(store, cameraId);\n      const newCameraTransform = initCamera(store, false, id);\n      const actualDuration = duration || 300;\n\n      return new Promise((resolve, reject) => {\n        store.dispatch(queueAnimation({\n          autoplay: true,\n          name: 'Move Camera',\n          iterations: 1,\n          tracks: [{\n            path: { id: cameraId, evalPlug: 'Transform' },\n            duration: actualDuration,\n            value: newCameraTransform,\n            startValue: currentCameraTransform,\n            tween: slerpTween(currentCameraTransform, newCameraTransform),\n            set: (_path, to) => {\n              setMatrixOnNode(store, cameraId, to);\n            },\n          },],\n          onEnd: () => {\n            resolve(store.dispatch(useCamera(id)).then(() => {\n              // if camera was targeted, re-enable targeting now that animation is over\n              return targetingDisabled ? store.dispatch(set({ id: cameraId, plug: 'Camera', property: 'targeted' }, true)) : null;\n            }));\n          },\n        }));\n      });\n    });\n  };\n};\n\n\n/**\n * Trigger a resize event. If you manually resize the player's dom element,\n * use this to force the player to rerender with the updated size.\n *\n * @public\n */\nexport function resize() {\n  return (store) => {\n    const translator = store.getTranslator();\n    if (translator) translator.resize();\n  };\n};\n\n/**\n * Given a manipulator event, return the list of node ids at that position\n *\n * @public\n * @param {Event} event generated by the manipulator interface. (See {@tutorial sdk-Tools})\n * @returns {Array} list of node ids found.\n *\n * @example\n *\n * api.player.addTool({\n *   click: (ev) => {\n *     var nodes = api.player.filterNodesFromPosition(ev);\n *     console.log('Found: ', nodes.map((id) => api.scene.get({id: id, property: 'name'})));\n *   }\n * }, 'FindNode');\n *\n */\nexport function filterNodesFromPosition(store, event) {\n  const translator = store.getTranslator();\n  if (!translator || !translator.raycastSelect) return null;\n  const x = event.clientX / (event.rect.width / 2) - 1;\n  const y = -(event.clientY / (event.rect.height / 2) - 1);\n  const hits = translator.raycastSelect({ x, y });\n  return hits.map((hit) => hit.id);\n};\n\n/**\n* Will constrain the target of the camera to remain inside the bounding sphere of the scene.\n* The camera will not be allowed to enter the bounding sphere of the scene nor leave  bounding sphere defined by arguments\n*\n* @public\n* @param {Number} radius distance around the center of the scene that defineds outer bounding sphere, setting radius to null disables bounding spheres\n*/\nexport function setCameraRadiusConstraint(radius) {\n  return (store) => {\n    store.dispatch({ type: SET_CONSTRAIN_CAMERA_RADIUS, payload: radius });\n    const cameraId = getCamera(store);\n    if (!cameraId) return;\n\n    // Store the radius constraint in the camera data, and touch the cameraNode\n    // to rerender\n    const cameraData = get(store, { id:  cameraId, evalPlug: 'Camera' });\n    if (cameraData) {\n      if (!cameraData.radiusConstraint || cameraData.radiusConstraint.radius !== radius) {\n        cameraData.newRadiusConstraint = radius;\n      }\n    }\n\n    store.dispatch(touch(cameraId));\n  };\n}\n\nexport function getCanvasElement(store) {\n  return store.getIn(['player', 'canvasElement']);\n}\n\nexport function getCameraRadiusConstraint(store) {\n  return store.getIn(['player', 'constrainCameraRadius']);\n};\n\n/**\n * Turn thumbnail display on or off\n * @public\n * @param {Boolean} display - Display thumbnail (default true)\n */\nexport function displayThumbnail(display) {\n  return { type: DISPLAY_THUMBNAIL, payload: display };\n};\n\nexport function shouldDisplayThumbnail(store) {\n  return store.getIn(['player', 'displayThumbnail']);\n};\n\nconst publicApi = {\n  reducer,\n  actions: { addTool, removeTool, showTool, hideTool, useManipulator,\n    setCameraAttrs, useCamera, setCameraPosition, animateCameraTo, resize,\n    displayThumbnail, setActiveColor, requestFullscreen, exitFullscreen, setFullscreen,\n    toggleFullscreen, setHoverColor, requestLenticularMode,\n    enableDeviceTracking, disableDeviceTracking, toggleDeviceTracking,\n    requestNormalMode, setFullscreenBGColor,\n    setCameraRadiusConstraint, updateToolOptions,\n  },\n  selectors: { getCamera, getCameraAttrs, getInitialCameraPosition, getCameraWorldTransform,\n    getActiveColor, isFullscreen, isVRMode, isLenticularMode, getFullscreenBGColor,\n    isDeviceTracking, shouldDisplayThumbnail, filterNodesFromPosition,\n    getThreeScene, getThreeCamera,\n  },\n};\nexport default publicApi;\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/player.js","import * as THREE from 'three';\n\nconst targetPosition = new THREE.Vector3();\nconst cameraPosition = new THREE.Vector3();\nconst targetUp = new THREE.Vector3(0, 1, 1);\nconst lookAtMatrix = new THREE.Matrix4();\nconst lookAtPosition = new THREE.Vector3();\nconst lookAtScale = new THREE.Vector3();\nconst lookAtRotation = new THREE.Quaternion();\nconst cameraScale = new THREE.Vector3();\nconst cameraRotation = new THREE.Quaternion();\n\nexport default function updateCameraLookAtTarget(cameraWorldMatrix, targetWorldMatrix, upPosition) {\n  // console.trace('navigator.updateCameraLookAtTarget');\n  cameraPosition.setFromMatrixPosition(cameraWorldMatrix);\n  targetPosition.setFromMatrixPosition(targetWorldMatrix);\n  // var te = targetWorldMatrix.elements;\n  //targetUp.set(0, 1, 0); // .applyMatrix4( targetWorldMatrix );\n  // console.log( \"targetUp\", JSON.stringify( targetUp ) );\n  //console.log(upPosition);\n  lookAtMatrix.makeTranslation(cameraPosition.x, cameraPosition.y, cameraPosition.z);\n  lookAtMatrix.lookAt(cameraPosition, targetPosition, upPosition || targetUp);\n  lookAtMatrix.decompose(lookAtPosition, lookAtRotation, lookAtScale);\n\n  cameraWorldMatrix.decompose(cameraPosition, cameraRotation, cameraScale);\n  cameraWorldMatrix.compose(cameraPosition, lookAtRotation, cameraScale);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/updateCameraLookAtTarget.js","import * as THREE from 'three';\n\nexport default function calculateBoundingBox(object) {\n  const box = new THREE.Box3();\n  const result = new THREE.Box3();\n\n  let objectsRoot = object;\n  object.children.forEach((child)=> {\n    if (child.type === 'Object3D' && child.name === 'Objects') objectsRoot = child;\n  });\n\n  result.makeEmpty();\n\n  object.updateMatrixWorld(true);\n\n  objectsRoot.traverse((node) => {\n    if (!node.visible) return;\n    if (!node.geometry) return;\n\n    const geometry = node.geometry;\n\n    if (geometry.boundingBox === null) {\n      geometry.computeBoundingBox();\n    }\n\n    if (geometry.boundingBox.isEmpty() === false) {\n      box.copy(geometry.boundingBox);\n      node.matrix.compose(node.position, node.quaternion, node.scale);\n      node.updateMatrixWorld(true);\n      box.applyMatrix4(node.matrixWorld);\n      result.union(box);\n    }\n  });\n\n  return result;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/calculateBoundingBox.js","import * as THREE from 'three';\nimport { get, getWorldTransform } from '../modules/scene';\nimport getTargetWorldMatrix from './utils/getTargetWorldMatrix';\nimport updateCameraLookAtTarget from './utils/updateCameraLookAtTarget';\nimport { set } from '../modules/scene';\nimport { getBoundingBox, getCameraRadiusConstraint, getCamera, getCameraAttrs, setRect, getRect } from '../modules/player';\nimport { get as sceneGet, merge, virtualCameraId, virtualTargetId } from '../modules/sceneGraph';\nimport clamp from './utils/clamp';\nimport setMatrixOnNode from './utils/setMatrixOnNode';\nimport { updateSphericalRotation } from './tools/orbit';\nimport { updateZoom } from './tools/zoom';\n\nconst { degToRad, radToDeg } = THREE.Math;\nconst { tan, cos, atan, acos, min, max, pow, PI, sqrt } = Math;\n\n// Temporary variables for intermediate calculations\nconst t_cameraPosition = new THREE.Vector3();\nconst t_oldTargetPosition = new THREE.Vector3();\nconst t_targetPosition = new THREE.Vector3();\nconst t_sphericalCamera = new THREE.Spherical();\nconst t_sphericalTarget = new THREE.Spherical();\nconst t_invTargetWorldMatrix = new THREE.Matrix4();\nconst t_invPivotMatrix = new THREE.Matrix4();\nconst t_changeQuaternion = new THREE.Quaternion();\n\nexport function resizeCamera(store, cameraId, rect) {\n  const aspectRatio = rect.x / rect.y;\n  store.dispatch(setRect(rect));\n  const name = sceneGet(store, [cameraId, 'name']);\n  if (name) store.dispatch(set({ id: cameraId, plug: 'Camera', property: 'aspectRatio' }, aspectRatio));\n}\n\nexport function updateLookatTarget(store, cameraId, transformData, cameraData) {\n  const playerData = get(store, { scene: true, evalPlug: 'Player' });\n  const cameraWorldMatrix = getWorldTransform(store, cameraId);\n  const targetWorldMatrix = getTargetWorldMatrix(store, cameraId);\n\n  if (playerData.orbitMode === 'trackball') {\n    t_cameraPosition.setFromMatrixPosition(cameraWorldMatrix);\n    t_oldTargetPosition.set(0,0,-1).transformDirection(cameraWorldMatrix);\n    t_targetPosition.setFromMatrixPosition(targetWorldMatrix).sub(t_cameraPosition).normalize();\n\n    t_changeQuaternion.setFromUnitVectors(t_targetPosition, t_oldTargetPosition);\n    cameraData.upPosition.applyQuaternion(t_changeQuaternion);\n  }\n\n  t_targetPosition.setFromMatrixPosition(targetWorldMatrix);\n  cameraData.pivotMatrix.setPosition(t_targetPosition.sub(cameraData.offset));\n\n  updateCameraLookAtTarget(cameraWorldMatrix, targetWorldMatrix, cameraData.upPosition);\n  return cameraWorldMatrix;\n}\n\nexport function initCamera(store, dispatch, fromCameraId, toCameraId, fromRect) {\n  const toId = toCameraId || virtualCameraId;\n  const fromId = fromCameraId || virtualCameraId;\n  const boundingBox = getBoundingBox(store);\n  const rect = fromRect || getRect(store);\n  const cameraWorldMatrix = getWorldTransform(store, fromId);\n  const targetWorldMatrix = getTargetWorldMatrix(store, fromId);\n  const cameraPosition = new THREE.Vector3().setFromMatrixPosition(cameraWorldMatrix);\n\n  resizeCamera(store, toId, rect);\n\n  const playerData = get(store, { scene: true, evalPlug: 'Player' });\n  const fromCameraData = get(store, { id: fromId, evalPlug: 'Camera' });\n  const toCameraData = fromId === toId ? fromCameraData : get(store, { id: toId, evalPlug: 'Camera' });\n\n  const pivotMatrix = targetWorldMatrix.clone();\n  const pivotPosition = new THREE.Vector3().setFromMatrixPosition(pivotMatrix);\n  cameraPosition.setFromMatrixPosition(cameraWorldMatrix).sub(pivotPosition);\n\n  const upPosition = new THREE.Vector3(0, 1, 0);\n  if (playerData.orbitMode === 'trackball') {\n    upPosition.transformDirection(cameraWorldMatrix);\n\n    const normal = new THREE.Vector3().copy(cameraPosition).normalize();\n    const cameraViewPlane = new THREE.Plane(normal, 0);\n    upPosition.copy(cameraViewPlane.projectPoint(upPosition).normalize());\n  }\n\n  const pivY = pivotMatrix.elements[13];\n  if (pivY + cameraPosition.length() < 0 && playerData.constraintCameraY) {\n    cameraPosition.normalize().multiplyScalar(pivY);\n  }\n\n  cameraWorldMatrix.setPosition(cameraPosition.add(pivotPosition));\n\n  toCameraData.upPosition = upPosition;\n  toCameraData.pivotMatrix = pivotMatrix;\n  toCameraData.offset = new THREE.Vector3(0, 0, 0);\n\n  adjustAngleAndRadius(store, fromId, cameraWorldMatrix, targetWorldMatrix, fromCameraData, boundingBox);\n\n  if (playerData.constraintCameraY) updateSphericalRotation(store, toId, cameraWorldMatrix, targetWorldMatrix, new THREE.Vector2(0, 0));\n\n  const radiusConstraint = getCameraRadiusConstraint(store);\n  if (radiusConstraint) {\n    initCameraRadiusConstraint(store, toId, toCameraData, radiusConstraint, cameraWorldMatrix, targetWorldMatrix);\n  }\n\n  updateCameraLookAtTarget(cameraWorldMatrix, targetWorldMatrix, upPosition);\n  if (dispatch) setMatrixOnNode(store, toId, cameraWorldMatrix);\n  return cameraWorldMatrix;\n}\n\nexport function initCameraRadiusConstraint(store, cameraId, cameraData, outerRadius, initCameraWorldMatrix, initTargetWorldMatrix) {\n  const boundingBox = getBoundingBox(store);\n  const minBoundingSphere = new THREE.Sphere();\n  const cameraWorldMatrix = initCameraWorldMatrix || getWorldTransform(store, cameraId);\n  const targetWorldMatrix = initTargetWorldMatrix || getTargetWorldMatrix(store, cameraId);\n  const playerData = get(store, { scene: true, evalPlug: 'Player' });\n\n  boundingBox.getBoundingSphere(minBoundingSphere);\n  if (outerRadius <= minBoundingSphere.radius) {\n    return;\n  }\n\n  const maxBoundingSphere = new THREE.Sphere(minBoundingSphere.center, outerRadius);\n\n  t_targetPosition.setFromMatrixPosition(targetWorldMatrix);\n  t_cameraPosition.setFromMatrixPosition(cameraWorldMatrix);\n  const targetToCamera = new THREE.Vector3().subVectors(t_cameraPosition, t_targetPosition);\n\n  const thirdVector = new THREE.Vector3().crossVectors(targetToCamera, cameraData.upPosition).normalize();\n  const newTargetPosition = minBoundingSphere.clampPoint(t_targetPosition);\n  const newCameraPosition = maxBoundingSphere.clampPoint(t_cameraPosition);\n  cameraWorldMatrix.setPosition(newCameraPosition);\n  targetWorldMatrix.setPosition(newTargetPosition);\n\n  if (playerData.orbitMode === 'trackball') {\n    const newTargetToCamera = new THREE.Vector3().subVectors(newCameraPosition, newTargetPosition);\n    cameraData.upPosition.crossVectors(thirdVector, newTargetToCamera).normalize();\n  }\n\n  cameraData.radiusConstraint = { outerRadius, maxBoundingSphere, minBoundingSphere };\n  cameraData.newRadiusConstraint = null;\n  updateZoom(store, 0, cameraId, cameraWorldMatrix);\n\n  if (!initCameraWorldMatrix) setMatrixOnNode(store, cameraId, cameraWorldMatrix);\n}\n\n/*\n * Set the camera angle and radius.\n */\nfunction adjustAngleAndRadius(store, cameraId, cameraWorldMatrix, targetWorldMatrix, cameraData, boundingBox) {\n  let  { azimuthAngle, polarAngle, boundingRadius } = getCameraAttrs(store).toJS();\n  const initialMinPolarAngle = 0;\n  const initialMaxPolarAngle = PI;\n  let minPolarAngle = 0;\n  let maxPolarAngle = PI;\n\n  if (cameraId === virtualCameraId) {\n    // Use defaults for the virtual camera only\n    if (azimuthAngle == null) azimuthAngle = 45;\n    if (polarAngle == null) polarAngle = 20;\n    if (boundingRadius == null) boundingRadius = 1;\n  }\n\n  if (azimuthAngle == null && polarAngle == null) {\n    return;\n  }\n\n  t_invTargetWorldMatrix.getInverse(targetWorldMatrix, true);\n  // world to relative\n  t_cameraPosition.setFromMatrixPosition(cameraWorldMatrix).applyMatrix4(t_invTargetWorldMatrix);\n\n  t_sphericalCamera.setFromVector3(t_cameraPosition);\n  t_sphericalCamera.theta = degToRad(azimuthAngle);\n  t_sphericalCamera.phi = degToRad(90 - polarAngle);\n\n  minPolarAngle = max(minPolarAngle || 0, initialMinPolarAngle); // radians\n  maxPolarAngle = min(maxPolarAngle || PI, initialMaxPolarAngle); // radians\n\n  t_sphericalCamera.phi = clamp(t_sphericalCamera.phi, minPolarAngle, maxPolarAngle);\n\n  if (boundingRadius != null) {\n    const fixRadius = boundingRadius * boundingBox.getBoundingSphere().radius;\n    t_sphericalCamera.radius = (fixRadius <= 0 ? 1 : fixRadius) / tan(degToRad(cameraData.fieldOfView * 0.5));\n    t_sphericalCamera.radius = (fixRadius <= 0 || fixRadius === Infinity ? 1 : fixRadius) / tan(degToRad(cameraData.fieldOfView * 0.5));\n  }\n\n  t_sphericalCamera.makeSafe();\n\n  t_cameraPosition.setFromSpherical(t_sphericalCamera);\n  t_sphericalCamera.setFromVector3(t_cameraPosition);\n\n  // relative to world\n  t_cameraPosition.applyMatrix4(targetWorldMatrix);\n  cameraWorldMatrix.setPosition(t_cameraPosition);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/camera.js","import { getWorldTransform, get } from '../../modules/scene';\nimport { virtualTargetId } from '../../modules/sceneGraph';\nimport * as THREE from 'three';\n\nconst position = new THREE.Vector3();\nconst rotation = new THREE.Quaternion();\nconst scale = new THREE.Vector3();\n/**\n * If the Camera has a look at attached, return that, otherwise the\n * virtual target transform\n * @returns {Matrix4}\n */\nexport default function getTargetWorldMatrix(store, cameraId, initCameraTransform) {\n  const cameraTransform = initCameraTransform ||  get(store, { id: cameraId, evalPlug: 'Transform' });\n  const cameraData = get(store, { id: cameraId, evalPlug: 'Camera' });\n  if (cameraTransform && cameraTransform.target) {\n    const lookAtTarget = getWorldTransform(store, cameraTransform.target.nodeId);\n    const offset = cameraData.offset;\n    lookAtTarget.decompose(position, rotation, scale);\n    return !offset ? lookAtTarget : lookAtTarget.compose(position.add(offset), rotation, scale);\n  } else {\n    return getWorldTransform(store, virtualTargetId);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/getTargetWorldMatrix.js","\nexport default function clamp(value, min, max) {\n  return Math.max(Math.min(value, max), min);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/clamp.js","import { merge } from '../../modules/sceneGraph';\nimport decompose from './decompose';\n\nexport default function setMatrixOnNode(store, nodeId, matrix4) {\n  store.dispatch(merge([nodeId, 'Transform', 0], decompose(matrix4)));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/setMatrixOnNode.js","import * as THREE from 'three';\n\nexport default function decompose(matrix4) {\n  const translation = new THREE.Vector3();\n  const rotQuat = new THREE.Quaternion();\n  const scale = new THREE.Vector3();\n  matrix4.decompose(translation, rotQuat, scale);\n  const rotation = new THREE.Vector3().copy(new THREE.Euler().setFromQuaternion(rotQuat, 'ZYX'));\n  rotation.multiplyScalar(180 / Math.PI); // convert to degrees\n  return { translation, rotation };\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/decompose.js","import * as THREE from 'three';\nconst { tan, cos, atan, acos, min, max, pow, PI, sqrt } = Math;\nimport clamp from '../utils/clamp';\nimport decompose from '../utils/decompose';\nimport { getCamera, getCameraWorldTransform, getRect } from '../../modules/player';\nimport { get, getWorldTransform } from '../../modules/scene';\nimport { merge } from '../../modules/sceneGraph';\nimport updateCameraLookAtTarget from '../utils/updateCameraLookAtTarget';\nimport getTargetWorldMatrix from '../utils/getTargetWorldMatrix';\nimport { virtualTargetId } from '../../modules/sceneGraph';\n\nexport function updateSphericalRotation(store, cameraId, cameraWorldMatrix, targetWorldMatrix, mouseDelta) {\n  const playerData = get(store, { scene: true, evalPlug: 'Player' });\n  const cameraData = get(store, { id:  cameraId, evalPlug: 'Camera' });\n\n  const rect = getRect(store);\n\n  const updateFns = { trackball: trackballUpdate, firstPerson: firstPersonUpdate };\n  const updateFn = updateFns[playerData.orbitMode] || gyroscopeUpdate;\n  updateFn(store, playerData, cameraId, cameraData, targetWorldMatrix, cameraWorldMatrix, rect, mouseDelta);\n}\n\nexport default function orbit(store, translator) {\n  return {\n    label: 'Orbit',\n    active: true,\n    enabled: true,\n\n    display: {\n      playerTools: true,\n    },\n    options: {},\n\n    tool: {\n      drag: function (ev) {\n        if (ev.which !== 1 || !(this.active || ev.metaKey)) return false;\n\n        return {\n          momentum: true,\n\n          handle: function ({ deltaX, deltaY }) {\n            const cameraId = getCamera(store);\n            const cameraWorldMatrix = getCameraWorldTransform(store);\n            const targetWorldMatrix = getTargetWorldMatrix(store, cameraId);\n\n            updateSphericalRotation(store, cameraId, cameraWorldMatrix, targetWorldMatrix, new THREE.Vector2(deltaX, deltaY));\n            store.dispatch(merge([cameraId, 'Transform', 0], decompose(cameraWorldMatrix)));\n\n            if (!get(store, { id: cameraId, evalPlug: 'Transform' }).target) {\n              store.dispatch(merge([virtualTargetId, 'Transform', 0], decompose(targetWorldMatrix)));\n            }\n          },\n        };\n      },\n    },\n  };\n}\n\nconst cameraPosition = new THREE.Vector3();\nconst targetPosition = new THREE.Vector3();\nconst sphericalCamera = new THREE.Spherical();\nconst sphericalTarget = new THREE.Spherical();\nconst invTargetWorldMatrix = new THREE.Matrix4();\nconst invPivotMatrix = new THREE.Matrix4();\n\n// changes cameraWorldMatrix by rotating by delta\nfunction gyroscopeUpdate(store, playerData, cameraId, cameraData, targetWorldMatrix, cameraWorldMatrix, rect, { x, y }) {\n\n  //to target space\n  targetPosition.setFromMatrixPosition(targetWorldMatrix);\n  cameraPosition.setFromMatrixPosition(cameraWorldMatrix).sub(targetPosition);\n\n  let cameraSpherical = new THREE.Spherical().setFromVector3(cameraPosition);\n\n  let azimuthalAngle = 2 * PI * (-x / rect.x);\n  cameraSpherical.theta += azimuthalAngle;\n\n  let polarAngle = 2 * PI * (-y / rect.y);\n  cameraSpherical.phi += polarAngle;\n  let maxPolarAngle;\n  if (targetPosition.y / cameraPosition.length() <= 1) {\n    maxPolarAngle = playerData.constraintCameraY ? acos(-targetPosition.y / cameraPosition.length()) : PI;\n  } else {\n    maxPolarAngle = PI;\n  }\n\n  cameraSpherical.phi = clamp(cameraSpherical.phi, 0, maxPolarAngle);\n\n  cameraSpherical.makeSafe();\n  cameraPosition.setFromSpherical(cameraSpherical).add(targetPosition);\n\n  if (cameraData.radiusConstraint) {\n    const { maxBoundingSphere, minBoundingSphere } = cameraData.radiusConstraint;\n    const camToTarg = new THREE.Vector3().subVectors(targetPosition, cameraPosition);\n    if (minBoundingSphere.containsPoint(cameraPosition)) {\n      const backwardRay = new THREE.Ray(cameraPosition, camToTarg.multiplyScalar(-1));\n      const newPosition = backwardRay.intersectSphere(minBoundingSphere).addScaledVector(camToTarg, __BOUNDING_BUFFER__);\n      cameraPosition.copy(newPosition);\n    } else if (!maxBoundingSphere.containsPoint(cameraPosition)) {\n      const forwardRay = new THREE.Ray(cameraPosition, camToTarg);\n      const newPosition = forwardRay.intersectSphere(maxBoundingSphere).addScaledVector(camToTarg, __BOUNDING_BUFFER__);\n      cameraPosition.copy(newPosition);\n    } else {}\n  }\n\n  cameraWorldMatrix.setPosition(cameraPosition);\n\n  // update orientation\n  updateCameraLookAtTarget(cameraWorldMatrix, targetWorldMatrix, cameraData.upPosition);\n}\n\n// changes cameraWorldMatrix by rotating by delta\nfunction trackballUpdate(store, playerData, cameraId, cameraData, targetWorldMatrix, cameraWorldMatrix, rect, { x, y }) {\n  const radius = min(rect.x, rect.y);\n\n  const pivotMatrix = cameraData.pivotMatrix;\n  const pivotPosition = new THREE.Vector3().setFromMatrixPosition(pivotMatrix);\n\n  let relativeDelta = new THREE.Vector3().set(-2 * x / radius, 2 * y / radius, 0);\n  if (relativeDelta.length() > 1) relativeDelta.normalize();\n  if (relativeDelta.x === 0 && relativeDelta.y === 0) return;\n  let delta = relativeDelta.length();\n\n  //world to relative pivot space\n  relativeDelta.transformDirection(cameraWorldMatrix).multiplyScalar(delta);\n  cameraPosition.setFromMatrixPosition(cameraWorldMatrix).sub(pivotPosition);\n  targetPosition.setFromMatrixPosition(targetWorldMatrix).sub(pivotPosition);\n  //upPosition.transformDirection(invPivotMatrix);\n  let camNorm = new THREE.Vector3().copy(cameraPosition).normalize();\n  //create rotational Quaternion\n  const scaleFactor = sqrt(1 - relativeDelta.lengthSq());\n  relativeDelta.addScaledVector(camNorm, scaleFactor).normalize();\n\n  let rotationalAxis = new THREE.Vector3().crossVectors(camNorm, relativeDelta).normalize();\n  let rotationalAngle = camNorm.angleTo(relativeDelta);\n  let rotationalQuaternion = new THREE.Quaternion().setFromAxisAngle(rotationalAxis, rotationalAngle);\n\n\n  //pivot relative to world space\n  cameraPosition.applyQuaternion(rotationalQuaternion).add(pivotPosition);\n  targetPosition.applyQuaternion(rotationalQuaternion).add(pivotPosition);\n  cameraData.upPosition.applyQuaternion(rotationalQuaternion);//.transformDirection(pivotMatrix);\n  cameraData.offset.applyQuaternion(rotationalQuaternion);\n\n  //bounding box constraining\n  if (cameraData.radiusConstraint) {\n    const { maxBoundingSphere, minBoundingSphere } = cameraData.radiusConstraint;\n    const camToTarg = new THREE.Vector3().subVectors(targetPosition, cameraPosition);\n\n    if (minBoundingSphere.containsPoint(cameraPosition)) {\n      const backwardRay = new THREE.Ray(cameraPosition,\n        new THREE.Vector3().copy(camToTarg).multiplyScalar(-1));\n\n      const newPosition = backwardRay.intersectSphere(minBoundingSphere)\n        .addScaledVector(camToTarg, -__BOUNDING_BUFFER__);\n\n      cameraPosition.copy(newPosition);\n    } else if (!maxBoundingSphere.containsPoint(cameraPosition)) {\n      const forwardRay = new THREE.Ray(cameraPosition, camToTarg);\n\n      const newPosition = forwardRay.intersectSphere(maxBoundingSphere)\n        .addScaledVector(camToTarg, __BOUNDING_BUFFER__);\n\n      cameraPosition.copy(newPosition);\n    } else {}\n\n    if (!minBoundingSphere.containsPoint(targetPosition)) {\n      const thirdVector = new THREE.Vector3().crossVectors(camToTarg, cameraData.upPosition);\n      const newPosition = minBoundingSphere.clampPoint(targetPosition);\n\n      const posChange = new THREE.Vector3().subVectors(newPosition, targetPosition);\n      newPosition.addScaledVector(posChange, __BOUNDING_BUFFER__);\n\n      cameraData.upPosition.crossVectors(thirdVector,\n        camToTarg.subVectors(newPosition, cameraPosition)).normalize();\n      targetPosition.copy(newPosition);\n    }\n  }\n\n  cameraWorldMatrix.setPosition(cameraPosition);\n  targetWorldMatrix.setPosition(targetPosition);\n\n  updateCameraLookAtTarget(cameraWorldMatrix, targetWorldMatrix, cameraData.upPosition);\n}\n\nfunction firstPersonUpdate(store, playerData, cameraId, cameraData, targetWorldMatrix, cameraWorldMatrix, rect, { x, y }) {\n  cameraPosition.setFromMatrixPosition(cameraWorldMatrix);\n  targetPosition.setFromMatrixPosition(targetWorldMatrix).sub(cameraPosition);\n\n  let targetSpherical = new THREE.Spherical().setFromVector3(targetPosition);\n\n  let azimuthalAngle = 2 * PI * (-x / rect.x);\n  targetSpherical.theta += azimuthalAngle;\n\n  let polarAngle = 2 * PI * (y / rect.y);\n  targetSpherical.phi += polarAngle;\n\n  targetSpherical.makeSafe();\n  targetPosition.setFromSpherical(targetSpherical).add(cameraPosition);\n\n  targetWorldMatrix.setPosition(targetPosition);\n\n  updateCameraLookAtTarget(cameraWorldMatrix, targetWorldMatrix, cameraData.upPosition);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/orbit.js","import * as THREE from 'three';\nconst { tan, cos, atan, acos, min, max, pow, PI, sqrt } = Math;\nimport clamp from '../utils/clamp';\nimport decompose from '../utils/decompose';\nimport { getCamera, getCameraWorldTransform, getRect } from '../../modules/player';\nimport { get, getWorldTransform } from '../../modules/scene';\nimport { merge, virtualTargetId } from '../../modules/sceneGraph';\nimport updateCameraLookAtTarget from '../utils/updateCameraLookAtTarget';\nimport getTargetWorldMatrix from '../utils/getTargetWorldMatrix';\n\nconst EPS = 0.000001;\nconst cameraPosition = new THREE.Vector3();\nconst targetPosition = new THREE.Vector3();\nconst targetToCamera = new THREE.Vector3();\n\nexport default function zoom(store, translator) {\n  function zoomBy({ delta, deltaX, deltaY }) {\n    const d = delta !== undefined ? delta : ((deltaX / 30) + (-deltaY / 30));\n    const cameraId = getCamera(store);\n    const cameraWorldMatrix = getWorldTransform(store, cameraId);\n    updateZoom(store, -d, cameraId, cameraWorldMatrix);\n    store.dispatch(merge([cameraId, 'Transform', 0], decompose(cameraWorldMatrix)));\n  }\n\n  return {\n    label: 'Zoom',\n    enabled: true,\n    display: {\n      playerTools: true,\n    },\n    options: {},\n\n    tool: {\n      drag: function (ev) {\n        if (!this.active && !ev.ctrlKey) return false;\n\n        return {\n          momentum: true,\n          handle: function (ev) {\n            const newEv = { delta: ev.delta !== undefined ? ev.delta : ((ev.deltaX / 30) + (-ev.deltaY / 30)) };\n            zoomBy(newEv);\n          },\n        };\n      },\n\n      pinch: function (ev) {\n        zoomBy(ev);\n      },\n\n      scroll: function (ev) {\n        zoomBy(ev);\n      },\n    },\n  };\n}\n\nexport function updateZoom(store, mouseDelta, cameraId, cameraWorldMatrix) {\n  const cameraData = get(store, { id:  cameraId, evalPlug: 'Camera' });\n  const playerData = get(store, { scene: true, evalPlug: 'Player' });\n  const targetWorldMatrix = getTargetWorldMatrix(store, cameraId);\n  const rect = getRect(store);\n\n  const deltaZoom = mouseDelta / rect.y;\n  const decayZoomFactor = pow(2, deltaZoom * 100);  // this ensures the zoom has consistent speed no matter the size\n\n  cameraPosition.setFromMatrixPosition(cameraWorldMatrix);\n  targetPosition.setFromMatrixPosition(targetWorldMatrix);\n\n  targetToCamera.copy(cameraPosition).sub(targetPosition);\n  const targetToCameraDistance = max(targetToCamera.length(), EPS);\n  let newTargetToCameraDistance = targetToCameraDistance * decayZoomFactor;\n\n  if (cameraData.radiusConstraint) {\n    const { maxBoundingSphere, minBoundingSphere } = cameraData.radiusConstraint;\n    const camToTargetBackward = new THREE.Vector3().copy(targetToCamera).normalize();\n    const camToTargetForward = new THREE.Vector3().copy(camToTargetBackward).multiplyScalar(-1);\n\n    const forwardRay = new THREE.Ray(cameraPosition, camToTargetForward);\n    const backwardRay = new THREE.Ray(cameraPosition, camToTargetBackward);\n\n    let lowerBound = new THREE.Vector3(), upperBound = new THREE.Vector3();\n\n    forwardRay.intersectSphere(minBoundingSphere, lowerBound);\n    backwardRay.intersectSphere(maxBoundingSphere, upperBound);\n\n    const minZoom = lowerBound.sub(targetPosition).length();\n    const maxZoom = upperBound.sub(targetPosition).length();\n\n    newTargetToCameraDistance = clamp(newTargetToCameraDistance, minZoom + __BOUNDING_BUFFER__, maxZoom - __BOUNDING_BUFFER__);\n  }\n\n  targetToCamera.multiplyScalar(newTargetToCameraDistance / targetToCameraDistance);\n  cameraPosition.copy(targetPosition).add(targetToCamera);\n  if (cameraPosition.y < 0 && playerData.constraintCameraY && playerData.orbitMode !== 'trackball') {\n    const thirdVector = new THREE.Vector3().crossVectors(targetToCamera, cameraData.upPosition).normalize();\n    cameraPosition.y = 0;\n    targetToCamera.copy(cameraPosition).sub(targetPosition);\n  }\n\n  cameraWorldMatrix.setPosition(cameraPosition);\n\n  updateCameraLookAtTarget(cameraWorldMatrix, targetWorldMatrix, cameraData.upPosition);\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/zoom.js","import { List, Map } from 'immutable';\nimport { reduce } from 'ramda';\nimport createReducer from './utils/createReducer';\nimport { useManipulator } from './player';\nimport { ActionTypes } from '../store/createStore';\n\nexport const MOUSE_CONTROLS = ['orbit', 'pan', 'zoom'];\n\n/**\n * This module manages commands and tools of the player\n *\n * @module commands\n * @public\n */\n\nconst ADD_COMMAND = 'ADD_COMMAND';\nconst REMOVE_COMMAND = 'REMOVE_COMMAND';\nconst UPDATE_COMMAND = 'UPDATE_COMMAND';\nconst FAIL_COMMAND = 'FAIL_COMMAND';\nconst FINISH_COMMAND = 'FINISH_COMMAND';\nconst RUN_COMMAND = 'RUN_COMMAND';\nconst UPDATE_COMMAND_OPTIONS = 'UPDATE_COMMAND_OPTIONS;';\n\nconst defaultCommand = {\n  enabled: true,\n  display: {},\n  options: {},\n\n  isEnabled: (store, command) => command.enabled,\n  isVisible: (store, command) => command.display,\n\n  command: null,\n  widget: null,\n};\n\nfunction makeCommand(state, command) {\n  return state.set(command.name, command);\n}\n\nfunction newInitialState() {\n  return Map({\n    all: {},\n    allCommands: List(),\n    tools: List(),\n    activeCommand: null,\n  });\n}\n\nfunction initCommand(attrs, name) {\n  const cmd = Object.assign({}, defaultCommand, attrs, { name });\n  if (cmd.display === true) cmd.display = { playerTools: true };\n  return cmd;\n}\n\nconst reducer = createReducer({}, {\n  [ActionTypes.INIT](state) {\n    return newInitialState();\n  },\n\n  [ADD_COMMAND](state, { command, name }) {\n    const cmd = initCommand(command, name);\n    const commands = state.get('all');\n    commands[name] = cmd;\n    let newState = state.updateIn(['allCommands'], List(), list => list.push(name));\n    if (cmd.tool) newState = newState.updateIn(['tools'], List(), list => list.push(name));\n    return newState;\n  },\n\n  [REMOVE_COMMAND](state, commandName) {\n    const commands = state.get('all');\n    delete commands[commandName];\n    const idx = state.getIn(['tools']).indexOf(commandName);\n    const idx2 = state.getIn(['allCommands']).indexOf(commandName);\n    return state.deleteIn(['tools', idx]).deleteIn(['allCommands', idx2]);\n    // FIXME: remove from commands/widgets\n  },\n  // [RUN_COMMAND](state, commandName) {\n  //   return state.setIn(['commands', commandName, 'running'], true);\n  // },\n  // [FINISH_COMMAND](state, commandName) {\n  //   return state.setIn(['commands', commandName, 'running'], false);\n  // },\n  // [FAIL_COMMAND](state, commandName) {\n  //   return state.setIn(['commands', commandName, 'running'], false);\n  // },\n  [UPDATE_COMMAND](state, { name, opts }) {\n    const command = state.get('all')[name];\n    if (command) Object.assign(command, opts);\n    return state;\n  },\n\n  [UPDATE_COMMAND_OPTIONS](state, { name, opts }) {\n    const command = state.get('all')[name];\n    if (command) Object.assign(command.options, opts);\n    return state;\n  },\n});\n\n/**\n * Add a command\n *\n * @public\n * @param {Command} command Command to be added\n * @param {String} name provide a name for the tool to allow removing it.\n * @returns {Promise}\n *\n */\nexport function addCommand(command, name) {\n  return { type: ADD_COMMAND, payload: { command, name } };\n}\n\n/**\n * Remove a command\n *\n * @public\n * @param {String} name The name of the command to remove\n * @returns {Promise}\n */\nexport function removeCommand(commandName) {\n  return { type: REMOVE_COMMAND, payload: commandName };\n}\n\n/**\n * Updates Atributes of Command\n *\n * @public\n * @param {String} name The name of the command to be updated\n * @param {Object} opts Attributes to set in the command\n * @returns {Promise}\n *\n */\nexport function updateCommand(name, opts) {\n  return { type: UPDATE_COMMAND, payload: { name, opts } };\n}\n\n/**\n * Updates Options object of Command\n *\n * @public\n * @param {String} name The name of the command to be updated\n * @param {Object} opts Options to be set in the command\n * @returns {Promise}\n *\n */\nexport function setCommandOptions(name, opts) {\n  return { type: UPDATE_COMMAND_OPTIONS, payload: { name, opts } };\n}\n\nexport function getTools(store) {\n  return store.getIn(['commands', 'tools']);\n}\n\nexport function getCommands(store, displayLocation) {\n  const commands = store.getIn(['commands', 'all']);\n  return !displayLocation ? commands : reduce((cmds, key) => {\n    const cmd = commands[key];\n    if (cmd.enabled && cmd.display[displayLocation]) cmds[key] = cmd;\n    return cmds;\n  }, {}, Object.keys(commands));\n}\n\nfunction _isCommandActive(store, command) {\n  if (command.active) return true;\n  if (command.isActive) return command.isActive(store);\n  return false;\n}\n\nexport function isCommandActive(store, commandName) {\n  const command = store.getIn(['commands', 'all'])[commandName];\n  return command && _isCommandActive(store, command);\n}\n\nexport function getActiveCommandsWithWidgets(store) {\n  const commands = getCommands(store);\n  const result = {};\n  Object.values(commands).forEach((command) => {\n    if (command.widget && _isCommandActive(store, command)) result[command.name] = command;\n  });\n  return result;\n}\n\nexport function activateCommand(commandName) {\n  return (store) => {\n    const tools = getTools(store);\n    const commands = getCommands(store);\n    const command = commands[commandName];\n\n    if (command.activate) {\n      if (!_isCommandActive(store, command)) {\n        command.activate();\n        store.dispatch(updateCommand(commandName, { active: true }));\n      }\n    } else {\n      tools.forEach((toolName) => {\n        const command = commands[toolName];\n        if (command.active && command.name !== commandName) {\n          store.dispatch(updateCommand(command.name, { active: false }));\n        }\n\n        if (command.name === commandName) {\n          store.dispatch(updateCommand(command.name, { active: true }));\n        }\n      });\n    }\n  };\n}\n\nexport function deactivateCommand(commandName) {\n  return (store) => {\n    const commands = getCommands(store);\n    const command = commands[commandName];\n    if (!command) return;\n\n    if (command.active) store.dispatch(updateCommand(command.name, { active: false }));\n    if (command.deactivate) command.deactivate.call(command);\n  };\n}\n\n/**\n * Executes, Activates/Deactivates, or makes Command Active\n *\n * @public\n * @param {String} commandName The name of the command to be run\n * @returns {Promise}\n *\n */\nexport function runCommand(commandName) {\n  return (store) => {\n    const command = store.getIn(['commands', 'all'])[commandName];\n    if (!command || !command.enabled) return;\n\n    if (command.execute) return command.execute(store);\n    const isActive =  _isCommandActive(store, command);\n    if (command.deactivate && isActive) return store.dispatch(deactivateCommand(commandName));\n    return store.dispatch(activateCommand(commandName));\n  };\n}\n\n/**\n * Updates multiple commands with given Attributes\n *\n * @public\n * @param {String} commandList The name of the command to be run\n * @params {Object} attrs Attributes to be set in the command\n * @returns {Promise}\n *\n */\nexport function updateCommands(commandList, attrs) {\n  return (store) => {\n    commandList.forEach((name) => {\n      store.dispatch(updateCommand(name, attrs));\n    });\n  };\n}\n\n/**\n * Return a Map with the command commands.\n *\n * @private\n */\n// export function getcommands(store) {\n//   return store.get(['commands']).map((command) => command.get('command'));\n// }\n\nconst publicApi = {\n  reducer,\n  actions: { activateCommand, addCommand, deactivateCommand, runCommand, setCommandOptions, updateCommand, updateCommands, removeCommand },\n  selectors: { },\n};\n\nexport default publicApi;\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/commands.js","module.exports = { \"default\": require(\"core-js/library/fn/object/values\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/values.js\n// module id = 305\n// module chunks = 0 1 2","require('../../modules/es7.object.values');\nmodule.exports = require('../../modules/_core').Object.values;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/object/values.js\n// module id = 306\n// module chunks = 0 1 2","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export')\n  , $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it){\n    return $values(it);\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es7.object.values.js\n// module id = 307\n// module chunks = 0 1 2","var getKeys   = require('./_object-keys')\n  , toIObject = require('./_to-iobject')\n  , isEnum    = require('./_object-pie').f;\nmodule.exports = function(isEntries){\n  return function(it){\n    var O      = toIObject(it)\n      , keys   = getKeys(O)\n      , length = keys.length\n      , i      = 0\n      , result = []\n      , key;\n    while(length > i)if(isEnum.call(O, key = keys[i++])){\n      result.push(isEntries ? [key, O[key]] : O[key]);\n    } return result;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_object-to-array.js\n// module id = 308\n// module chunks = 0 1 2","import { Map } from 'immutable';\nimport createReducer from './utils/createReducer';\nimport rsvp from 'rsvp';\n\n/**\n * Plugins: loading, running\n *\n * @module plugins\n * @private\n */\n\nconst SET_API = 'SET_API';\nconst LOAD_PLUGIN = 'LOAD_PLUGIN';\nconst LOADING_PLUGIN = 'LOADING_PLUGIN';\nconst LOADED_PLUGIN = 'LOADED_PLUGIN';\nconst SET_PLUGIN = 'SET_PLUGIN';\nconst LOADING_PLUGIN_ERROR = 'LOADING_PLUGIN_ERROR';\n\nconst initialState = Map({\n  api: null,\n  plugins: Map(),\n  loading: Map(),\n});\n\nconst reducer = createReducer(initialState, {\n  [SET_API](state, api) {\n    return state.set('api', api);\n  },\n\n  [LOADING_PLUGIN](state, name) {\n    return state.setIn(['loading', name], true);\n  },\n\n  [LOADED_PLUGIN](state, name, { action }) {\n    return state.setIn(['loading', name], false);\n  },\n\n  [SET_PLUGIN](state, { name, plugin }) {\n    return state.setIn(['plugins', name], plugin);\n  },\n});\n\nfunction initPlugin(store, name, response) {\n  try {\n    function buildPluginFn(content) {\n      const fn = new Function('api', content || '');\n      return fn(store.getIn(['plugins', 'api']));\n    }\n\n    const { content, loadFromServer, url } = response;\n    if (!loadFromServer)  return Promise.resolve(buildPluginFn(content));\n\n    console.log('Load plugin from server', url);\n    return new rsvp.Promise((resolve, reject) => {\n      store.callApi({\n        types: [LOADING_PLUGIN, LOADED_PLUGIN, LOADING_PLUGIN_ERROR],\n        url,\n        payload: name,\n        queryKey: 'PLUGINexternal' + name,\n        contentType: 'external',\n      }).then((content) => {\n        resolve(buildPluginFn(content));\n      }).catch(function (e) {\n        console.log('Error loading external plugin!', url);\n        resolve({});\n      });\n    });\n  } catch (e) {\n    console.log('error', e);\n  }\n};\n\nfunction loadPlugin(name) {\n  return (store) => {\n    const sceneId = store.getIn(['sceneIO', 'id']);\n    if (!sceneId) return Promise.reject('No scene attached');\n\n    const api = store.getIn(['plugins', 'api']);\n    if (api && api[name]) return Promise.resolve(api[name]);\n\n    return store.callApi({\n      types: [LOADING_PLUGIN, LOADED_PLUGIN, LOADING_PLUGIN_ERROR],\n      url: `${__APIROOT__}/scenes/${sceneId}/plugins/${name}`,\n      payload: name,\n      queryKey: 'PLUGIN' + name,\n    }).then((response) => {\n      return initPlugin(store, name, response).then(function (plugin) {\n        store.dispatch({ type: SET_PLUGIN, payload: { name, plugin } });\n        return plugin;\n      });\n    });\n  };\n}\n\nexport function get(store, name) {\n  const plugin = store.getIn(['plugins', 'plugins', name]);\n  return plugin ? Promise.resolve(plugin) : store.dispatch(loadPlugin(name));\n}\n\nexport function setApi(api) {\n  return { type: SET_API, payload: api };\n}\n\n/**\n * Returns a function that will run the setup command\n */\nexport function getSetupCommand(store, cmd, data) {\n  try {\n    function err(msg) {\n      console.log(`Error getting plugin: ${pluginName}`);\n      return Promise.resolve(true);\n    }\n\n    const [pluginName, command] = cmd.split('/');\n    const setupData = typeof data === 'string' ? JSON.parse(data) : data;\n    return function () {\n      return get(store, pluginName).then(function (plugin) {\n        if (!plugin) return err(`Error getting plugin: ${pluginName}`);\n        if (!plugin[command]) return err(`Unknown command: ${command} for plugin: ${pluginName}`);\n        if (typeof plugin[command] !== 'function') return err(`Command: ${command} in plugin: ${pluginName} is not a function`);\n\n        if (Array.isArray(setupData)) {\n          return Promise.resolve(plugin[command].apply(plugin, setupData));\n        } else {\n          return Promise.resolve(plugin[command](setupData));\n        }\n      });\n    };\n  } catch (e) {\n    return function () { console.error(e); };\n  }\n}\n\nconst publicApi = {\n  reducer,\n  actions: { loadPlugin },\n  selectors: { get, getSetupCommand },\n};\n\nexport default publicApi;\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/plugins.js","import { get, getAll, filter, find, set as sceneSet, setAll, clone as sceneClone } from './scene';\nimport { fetch as fetchScene } from './sceneIO';\nimport { openAnnotation as open, closeAnnotation as close } from './annotations';\n\n//export availableActions = {\n//  show: { args: [{key: 'name', type: 'String'}], description: 'Show nodes' },\n//  hide: { args: [{key: 'name', type: 'String'}], description: 'Hide nodes' },\n//};\n\nexport function show({ name }, { from }) {\n  return (store) => {\n    return setAll(store, { from, name, plug: 'Properties', property: 'visible' }, true);\n  };\n}\n\nexport function hide({ name }, { from }) {\n  return (store) => {\n    return setAll(store, { from, name, plug: 'Properties', property: 'visible' }, false);\n  };\n}\n\n/**\n * setMaterial will assign a `materialName`, `to` a node. It will optionally `clone`\n * the material, and optionally fetch `fromSceneId`.\n *\n * @param {Object} attrs\n * @param {String} attrs.to\n * @param {String} attrs.materialName\n * @param {String} [attrs.fromSceneId]\n * @param {Boolean} [attrs.clone]\n * @param {Object} options\n * @param {String} [options.from] Optionally, a `from` base query to use to resolve the node\n */\nexport function setMaterial({ to, materialName, fromSceneId, clone }, { from }) {\n  return (store) => {\n    return (fromSceneId ? store.dispatch(fetchScene(fromSceneId)) : Promise.resolve(true)).then(function () {\n      const matId = find(store, {\n        from: (fromSceneId ? { id: fromSceneId } : null),\n        name: materialName,\n      });\n      (clone && matId ? store.dispatch(sceneClone([matId])) : Promise.resolve({ [matId]: matId })).then(function (cloned) {\n        var path = find(store, { from, name: to, plug: 'Material', property: 'reference' });\n        return store.dispatch(setAll({ from, name: to, plug: 'Material', property: 'reference' }, cloned[matId]));\n      });\n    });\n  };\n}\n\n/**\n * mate a `parentNode` to `targetNode`: Will align the transform of the `parentNode` to\n * that of `targetNode`. Set `translationOnly` to only set translation (must be previously aligned).\n *\n * @param {Object} attrs\n * @param {String} attrs.parentNode name of the node to move\n * @param {String} attrs.targetNode name of the target node\n * @param {Boolean} [attrs.translationOnly] change translation only, not complete transform.\n * @param {Object} options\n * @param {String} [options.from] Optionally, a `from` base query to use to resolve the parent node\n *\n */\nexport function mate({ parentNode, targetNode, translationOnly }, { from }) {\n  return (store) => {\n    var targetTranslation = get(store, { name: targetNode, evalPlug: 'Transform', property: 'translation' });\n    var parentTranslation = get(store, { from, name: parentNode, evalPlug: 'Transform', property: 'translation' });\n\n    if (targetTranslation && parentTranslation) {\n      const diff = targetTranslation.clone().sub(parentTranslation);\n      //console.log('diff?', parentNode, parentTranslation, 'to', targetNode, targetTranslation);\n      //console.log('set', get(store, {id: from.id, property: 'name'}), diff);\n      return store.dispatch(sceneSet({ id: from.id, plug: 'Transform', property: 'translation' }, diff));\n    }\n\n    return Promise.resolve(true);\n  };\n}\n\nexport function setImage(query, reference) {\n  return (store) => {\n    const ref = scene.find(reference);\n    if (!ref) return Promise.resolve(true);\n    return setAll(store, { name: query, plug: 'Material', property: 'baseMap' }, ref);\n  };\n}\n\nexport function setDefaultColor(query, value) {\n  return (store) => {\n    return setAll({ name: query, plug: 'Material', property: 'defaultColor' }, value);\n  };\n}\n\nexport function moveCamera(query, value) {\n  return (store) => {\n    const duration = Number(value) || 500;\n    var camera = scene.find(query);\n    if (camera) return animateCameraTo(camera, duration);\n    return Promise.resolve(true);\n  };\n}\n\nexport function openAnnotation(query) {\n  return (store) => {\n    return Promise.all(filter(query).map((path) => open(store, path)));\n  };\n}\n\nexport function closeAnnotation(query) {\n  return (store) => {\n    return Promise.all(filter(query).map((path) => close(store, path)));\n  };\n}\n\nexport function set(query, value) {\n  return (store) => {\n    return setAll(store, query, value);\n  };\n}\n\nconst publicApi = {\n  actions: { show, hide, mate, setMaterial, setImage, setDefaultColor, moveCamera,\n    openAnnotation, closeAnnotation, set, },\n  selectors: { },\n};\n\nexport default publicApi;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/configuration.js","import { Map, List } from 'immutable';\nimport createReducer from './utils/createReducer';\nimport { DELETE_NODE, CLEAR_SCENE } from './actionTypes';\n\nconst SELECT_NODE = 'SELECT_NODE';\nconst DESELECT_ALL = 'DESELECT_ALL';\nconst SET_HIGHLIGHTING = 'SET_HIGHLIGHTING';\n\n/**\n * Controls selection\n *\n * @module selection\n * @public\n */\n\nconst initialState = Map({\n  nodes: List(),\n  highlightNodes: false,\n});\n\nconst reducer = createReducer(initialState, {\n  [SELECT_NODE](state, nodeId) {\n    const nodes = state.get('nodes');\n    return state.set('nodes', !nodes.includes(nodeId) ? nodes.clear().push(nodeId) : nodes);\n  },\n\n  [DELETE_NODE](state, nodeId) {\n    let idx = state.get('nodes').indexOf(nodeId);\n    return idx === -1 ? state : state.deleteIn(['nodes', idx]);\n  },\n\n  [CLEAR_SCENE](state) {\n    return state.set('nodes', state.get('nodes').clear());\n  },\n\n  [DESELECT_ALL](state) {\n    return state.set('nodes', state.get('nodes').clear());\n  },\n\n  [SET_HIGHLIGHTING](state, highlight) {\n    return state.set('highlightNodes', highlight);\n  },\n});\n\nexport function selectNode(nodeId) {\n  return { type: SELECT_NODE, payload: nodeId };\n};\n\nexport function isSelected(store, nodeId) {\n  return store.getIn(['selection', 'nodes']).includes(nodeId);\n};\n\nexport function lastSelectedNode(store) {\n  return store.getIn(['selection', 'nodes']).last();\n};\n\nexport function getSelectedNodes(store) {\n  return store.getIn(['selection', 'nodes']).toArray();\n};\n\nexport function deselectAll() {\n  return { type: DESELECT_ALL };\n};\n\nexport function setHighlighting(highlight) {\n  return { type: SET_HIGHLIGHTING, payload: highlight };\n};\n\nexport function isHighlighting(store) {\n  return store.getIn(['selection', 'highlightNodes']);\n}\n\nconst publicApi = {\n  reducer,\n  actions: { selectNode, deselectAll, setHighlighting },\n  selectors: { isSelected, lastSelectedNode },\n};\nexport default publicApi;\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/selection.js","import makeAllOperators from './makeAllOperators';\n\nimport minimal from './minimal';\n\nexport default minimal;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/index.js","import { is, Record, Map } from 'immutable';\nimport { curry, map, mapObjIndexed, pick, pickBy } from 'ramda';\nimport schemaTypes from './schemaTypes';\n\nexport default function makeAllOperators(hierarchy, { withNone }) {\n  let records = mapObjIndexed((ops, plug) => {\n    return mapObjIndexed((op, name) => {\n      return makeOperator(plug, op, name);\n    }, ops);\n  }, hierarchy);\n  if (withNone) records.None = { NoOp: makeOperator('None', { schema: {} }, 'NoOp') };\n  return records;\n};\n\n// export const Operator = Record({type: '', name: '', attributes: null});\n\nfunction makeOperator(plug, op, name) {\n  let props = map((info, key) => {\n    if (schemaTypes[info.type]) return Object.assign({ type: info.type, schema: info }, schemaTypes[info.type](info));\n    return {\n      set: (v) => v,\n      get: (v) => v,\n    };\n  }, op.schema);\n\n  let keys = Object.keys(props);\n\n  let defaults = map((prop, key) => prop.defaultValue, props);\n  defaults.type = name;\n  defaults.name = name;\n\n  let references = pickBy((prop, key) => prop.isReference, props);\n  let fileReferences = pickBy((prop, key) => prop.isFileReference, props);\n\n  let Operator = class R extends Record(defaults, plug + name) {\n    static keys() {\n      return keys;\n    }\n\n    keys() {\n      return keys;\n    }\n\n    getProperties() {\n      return props;\n    }\n\n    getReferences() {\n      return Map(pickBy((v) => !!v, mapObjIndexed((schema, key) => {\n        return this.get(key);\n      }, references)));\n    }\n\n    getFileReferences() {\n      return Map(pickBy((v) => !!v, mapObjIndexed((schema, key) => {\n        return this.get(key);\n      }, fileReferences)));\n    }\n\n    typeOf(key) {\n      return op.schema[key] && op.schema[key].type;\n    }\n\n    set(key, val) {\n      const newVal = props[key] ? props[key].set(val) : val;\n      return super.set(key, newVal);\n    }\n\n    export() {\n      const op = mapObjIndexed((prop, key) => {\n        const v = this.get(key);\n        return fileReferences[key] || references[key] ? (v ? v.get('id') : null) : v;\n      }, props);\n      op.name = name;\n      op.primitive = plug;\n      return op;\n    }\n\n    doUpdate(operator, primitive, sceneId) {\n      const result = op.update ? op.update.call(op, operator, primitive, sceneId) :\n        operator.mergeInto(operator, primitive);\n      if (!result) {\n        console.error('Operator not returning its result: ', name, op);\n      }\n\n      return result || Map();\n    }\n  };\n  return Operator;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/makeAllOperators.js","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/classCallCheck.js\n// module id = 314\n// module chunks = 0 1 2","\"use strict\";\n\nexports.__esModule = true;\n\nvar _defineProperty = require(\"../core-js/object/define-property\");\n\nvar _defineProperty2 = _interopRequireDefault(_defineProperty);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      (0, _defineProperty2.default)(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/createClass.js\n// module id = 315\n// module chunks = 0 1 2","\"use strict\";\n\nexports.__esModule = true;\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && ((typeof call === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(call)) === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/possibleConstructorReturn.js\n// module id = 316\n// module chunks = 0 1 2","\"use strict\";\n\nexports.__esModule = true;\n\nvar _getPrototypeOf = require(\"../core-js/object/get-prototype-of\");\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _getOwnPropertyDescriptor = require(\"../core-js/object/get-own-property-descriptor\");\n\nvar _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = (0, _getOwnPropertyDescriptor2.default)(object, property);\n\n  if (desc === undefined) {\n    var parent = (0, _getPrototypeOf2.default)(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/get.js\n// module id = 317\n// module chunks = 0 1 2","module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/get-own-property-descriptor.js\n// module id = 318\n// module chunks = 0 1 2","require('../../modules/es6.object.get-own-property-descriptor');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function getOwnPropertyDescriptor(it, key){\n  return $Object.getOwnPropertyDescriptor(it, key);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/object/get-own-property-descriptor.js\n// module id = 319\n// module chunks = 0 1 2","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject                 = require('./_to-iobject')\n  , $getOwnPropertyDescriptor = require('./_object-gopd').f;\n\nrequire('./_object-sap')('getOwnPropertyDescriptor', function(){\n  return function getOwnPropertyDescriptor(it, key){\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.object.get-own-property-descriptor.js\n// module id = 320\n// module chunks = 0 1 2","\"use strict\";\n\nexports.__esModule = true;\n\nvar _setPrototypeOf = require(\"../core-js/object/set-prototype-of\");\n\nvar _setPrototypeOf2 = _interopRequireDefault(_setPrototypeOf);\n\nvar _create = require(\"../core-js/object/create\");\n\nvar _create2 = _interopRequireDefault(_create);\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(superClass)));\n  }\n\n  subClass.prototype = (0, _create2.default)(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf2.default ? (0, _setPrototypeOf2.default)(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/inherits.js\n// module id = 321\n// module chunks = 0 1 2","module.exports = { \"default\": require(\"core-js/library/fn/object/set-prototype-of\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/set-prototype-of.js\n// module id = 322\n// module chunks = 0 1 2","require('../../modules/es6.object.set-prototype-of');\nmodule.exports = require('../../modules/_core').Object.setPrototypeOf;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/fn/object/set-prototype-of.js\n// module id = 323\n// module chunks = 0 1 2","// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = require('./_export');\n$export($export.S, 'Object', {setPrototypeOf: require('./_set-proto').set});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/es6.object.set-prototype-of.js\n// module id = 324\n// module chunks = 0 1 2","// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar isObject = require('./_is-object')\n  , anObject = require('./_an-object');\nvar check = function(O, proto){\n  anObject(O);\n  if(!isObject(proto) && proto !== null)throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function(test, buggy, set){\n      try {\n        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch(e){ buggy = true; }\n      return function setPrototypeOf(O, proto){\n        check(O, proto);\n        if(buggy)O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/~/core-js/library/modules/_set-proto.js\n// module id = 325\n// module chunks = 0 1 2","import makeAllOperators from './makeAllOperators';\nimport Annotation from './Annotation';\nimport BinMesh from './BinMesh';\nimport Camera from './Camera';\nimport Environment from './Environment';\nimport Image from './Image';\nimport Light from './Light';\nimport Material from './Material';\nimport Player from './Player';\nimport PolyMesh from './PolyMesh';\nimport Properties from './Properties';\nimport Transform from './Transform';\n\nconst NoOp = { schema: {} };\n\nconst Bone = { Bone: NoOp };\nconst Null = { Null: NoOp };\nconst Pass = { Pass: NoOp };\nconst Mixer = { Action: NoOp, Mixer: NoOp };\nconst Renderer = { 'vray/create': NoOp, WebGLRenderer: NoOp };\nconst Timeline = { Timeline: NoOp };\nconst GeneralRenderer = { GeneralRenderer: NoOp };\nconst Viewport = { Viewport: NoOp };\n\nconst records = makeAllOperators({\n  Annotation, BinMesh, Bone, Camera, Environment, GeneralRenderer, Light, Material,\n  Mixer, Null, Pass, Player, PolyMesh, Properties,\n  Renderer, Timeline, Transform, Image, Viewport,\n}, { withNone: true });\n\nexport default records;\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/minimal.js","import { Record } from 'immutable';\n\nexport const FileReference = Record({ id: '' }, 'FileReference');\nexport const NodeReference = Record({ id: '' }, 'NodeReference');\nexport const PlugReference = Record({ id: '', plug: '' }, 'PlugReference');\nexport const OperatorReference = Record({ id: '', plug: '', index: 0 }, 'OperatorReference');\n\nexport const Vec2 = Record({ x: 0, y: 0 }, 'Vec2');\nexport const Vec3 = Record({ x: 0, y: 0, z: 0 }, 'Vec3');\nexport const Color = Record({ r: 0, g: 0, b: 0 }, 'Color');\n\nexport default {\n  FileReference, NodeReference, PlugReference, OperatorReference,\n  Vec2, Vec3, Color,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/operators/primitives.js","import { chain, values } from 'ramda';\nimport createReducer from './createReducer';\nimport applyMiddleware from './applyMiddleware';\nimport createStore from './createStore';\n\nexport default function buildStore(reducers, operatorRecords, primitives, middleware) {\n  const reducer = createReducer(reducers, operatorRecords);\n  const records = chain(values, values(operatorRecords)).concat(values(primitives));\n  const store = createStore(reducer, applyMiddleware(...middleware));\n  store.addRecords(records);\n  return store;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/index.js","import { Map, is } from 'immutable';\nimport { chain, reduce, values } from 'ramda';\n\nexport default function(reducers, operatorRecords) {\n  let keys = Object.keys(reducers);\n\n  let defaultState = reduce((state, key) => {\n    return state.set(key, reducers[key]());\n  }, Map(), keys);\n\n  return function reducer(state = defaultState, action, createEvent) {\n    return reduce((state, key) => {\n      let previousStateForKey = state.get(key);\n      let nextStateForKey = reducers[key](previousStateForKey, action, state, createEvent);\n      if (__DEV__) {\n        if (!nextStateForKey) {\n          throw new Error(`Reducer: ${key} failed to return state`);\n        }\n      }\n\n      return is(previousStateForKey, nextStateForKey) ? state : state.set(key, nextStateForKey);\n    }, state, keys);\n  };\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/createReducer.js","import { compose } from 'ramda';\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\nexport default function applyMiddleware(...middlewares) {\n  return (createStore) => (reducer, initialState, enhancer) => {\n    var store = createStore(reducer, initialState, enhancer);\n    let { dispatch } = store;\n    var chain = [];\n\n    var middlewareAPI = {\n      get: store.get,\n      getIn: store.getIn,\n      getState: store.getState,\n      getTranslator: store.getTranslator,\n      getDerived: store.getDerived,\n      dispatch: (action) => dispatch(action),\n      read: store.read,\n      write: store.write,\n      hasApi: store.hasApi,\n      callApi: store.callApi,\n      logPageView: store.logPageView,\n    };\n\n    chain = middlewares.map(middleware => middleware(middlewareAPI));\n    dispatch = compose(...chain)(store.dispatch);\n\n    return Object.assign({}, store, { dispatch });\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/applyMiddleware.js","import { map } from 'ramda';\n\nfunction bindActionCreators(dispatch, actionCreators) {\n  return map((actionCreator) => {\n    return (...args) => dispatch(actionCreator(...args));\n  }, actionCreators);\n};\n\nfunction bindSelectors(store, selectors) {\n  return map((selector) => {\n    return (...args) => selector(store, ...args);\n  }, selectors);\n};\n\n/**\n * Iterate over modules,\n */\nexport default function bindActionCreatorsAndSelectors(store, modules) {\n  return map((module) => {\n    return Object.assign({},\n      bindActionCreators(store.dispatch, module.actions),\n      bindSelectors(store, module.selectors)\n    );\n  }, modules);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/bindActionCreatorsAndSelectors.js","let headerFont = '-apple-system,\".SFNSDisplay-Bold\",\"Helvetica Neue\",\"Roboto\",\"Segoe UI\",sans-serif';\nlet bodyFont = \"'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', Verdana, Tahoma, sans-serif\";\nlet colors = {\n  gray: '#999',\n  black: '#333',\n  lightBg: '#eee',\n  border: '#ccc',\n  white: '#fff',\n};\n\nexport default {\n  root: {\n    height: '100%',\n    fontSize: '14px',\n    fontFamily: bodyFont,\n    position: 'absolute',\n    top: 0, left: 0, right: 0, bottom: 0,\n  },\n  absoluteMaxCentered: {\n    position: 'absolute',\n    top: 0, left: 0, right: 0, bottom: 0,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    display: 'flex',\n    flex: '0 0 auto',\n    justifyContent: 'center',\n    margin: '0',\n    backgroundColor: colors.lightBg,\n    fontFamily: headerFont,\n  },\n  mainRow: {\n    display: 'flex',\n    flex: '1 1 100px',\n    justifyContent: 'center',\n  },\n  commandsRow: {\n    flex: '0 0 auto',\n  },\n  statsRow: {\n    flex: '0 0 auto',\n    backgroundColor: colors.gray,\n    color: colors.lightBg,\n    padding: '5px',\n  },\n  player: {\n    position: 'relative',\n    top: 0, left: 0, right: 0, bottom: 0,\n    height: '100%',\n    width: '100%',\n  },\n  maxRow: {\n    flex: '1 1 auto',\n  },\n  leftCol: {\n    flex: '1 1 200px',\n    maxWidth: '300px',\n    overflow: 'scroll',\n  },\n  centerCol: {\n    flex: '2 2 500px',\n    border: '1px solid ' + colors.border,\n  },\n  rightCol: {\n    flex: '1 1 200px',\n    maxWidth: '300px',\n    overflow: 'scroll',\n  },\n  footer: {\n    flex: '0 0 auto',\n    padding: '5px',\n    backgroundColor: colors.lightBg,\n    margin: '0',\n  },\n  explorerSelected: {\n    backgroundColor: colors.gray,\n  },\n  explorerNotSelected: {\n    backgroundColor: colors.white,\n    cursor: 'pointer',\n  },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/styles.js","import h from 'snabbdom/h';\nimport { map } from 'ramda';\nimport styles from './styles';\nimport { getErrors } from '../modules/sceneIO';\n\nexport default function error(store) {\n  return h('div', { key: 'error', style: styles.absoluteMaxCentered }, [\n    h('div', { style: { flex: '0 0 100%' } }, getErrors(store).map((err) => {\n      return h('h2', err);\n    }).toArray()),\n  ]);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/error.js","import h from 'snabbdom/h';\nimport styles from './styles';\nimport { isSceneLoaded, isSceneRendered, loadingProgress, numErrors } from '../modules/sceneIO';\n\nvar stats = statsReporter();\n\nfunction statsReporter() {\n  var pageLoadTime, toRenderedTime;\n  if (typeof performace === 'undefined') return function () {};\n\n  return function (store, pct) {\n    if (pageLoadTime && toRenderedTime) return;\n    if (!pageLoadTime) pageLoadTime = new Date().getTime() - performance.timing.navigationStart;\n    if (pct < 1) return;\n    toRenderedTime = new Date().getTime() - performance.timing.navigationStart;\n    console.log(`Page loaded in ${pageLoadTime}ms and rendered in ${toRenderedTime}ms`);\n  };\n};\n\n//\nvar spinnerColor = '#646766';\n\nvar circleDiv = {\n  flex: '0 0 25%',\n};\n\nvar r = 90;\nvar PIR2 = Math.PI * r * 2;\n\nvar outer = {\n  r, cx: 100, cy: 100,\n  fill: 'transparent',\n  'stroke-dasharray': PIR2,\n  'stroke-dashoffset': 0,\n  'stroke-width': '1em',\n  stroke: '#eee',\n};\nvar inner = {\n  r, cx: 100, cy: 100,\n  fill: 'transparent',\n  stroke: spinnerColor,\n  transition: 'stroke-dashoffset 1s linear',\n  'stroke-width': '1em',\n  'stroke-dashoffset': PIR2,\n  'stroke-dasharray': PIR2,\n};\nvar svg = {\n  height: '100%',\n  width: '100%',\n  viewport: '0 0 100 100',\n  viewBox: '0 0 200 200',\n};\n\nexport default function progress(store) {\n  const pct = loadingProgress(store);\n  const degrees = PIR2 * (1 - pct);\n  stats(store, pct);\n\n  return h('div', { style: { ...styles.absoluteMaxCentered, backgroundColor: 'transparent', boxSizing: 'border-box' } }, [\n    h('div', { style: circleDiv }, [\n      h('svg', { attrs: svg }, [\n        h('circle', { attrs: outer }),\n        h('circle', { props: { id: 'bar' }, attrs: { ...inner, 'stroke-dashoffset': degrees } }),\n      ]),\n    ]),\n  ]);\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/progress.js","\"use strict\";\n\nexports.__esModule = true;\n\nvar _assign = require(\"../core-js/object/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _assign2.default || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/extends.js\n// module id = 345\n// module chunks = 0 1 2","import h from 'snabbdom/h';\nimport { filter, map } from 'ramda';\nimport annotation, { getAnnotationProperties } from './annotation';\nimport { isSceneRendered } from '../modules/sceneIO';\nimport { getCustomAnnotationFunction } from '../modules/annotations';\n\nconst attachTranslator = function (store, translator) {\n  return (info) => {\n    translator.attach(info.elm);\n\n    function onResize() {\n      translator.resize();\n    }\n\n    window.addEventListener('resize', onResize);\n  };\n};\n\nfunction ignoreRightClick(ev) {\n  ev.preventDefault();\n};\n\nexport default function canvas(store) {\n  const translator = store.getTranslator();\n  const rendered = isSceneRendered(store);\n\n  translator.update();\n\n  const annotationFn = getCustomAnnotationFunction(store);\n\n  const annotations = filter((a) => !!a, map((obj) => getAnnotationProperties(store, obj),\n      Object.values(translator.getAnnotations())));\n\n  function callCustomAnnotationFn(vnode) {\n    annotations.forEach((annotation) => annotationFn(annotation, vnode.elm));\n  }\n\n  const children = annotationFn ? [h('div.annotations', {\n    style: { position: 'absolute', top: 0, left: 0, right: 0, bottom: 0, pointerEvents: 'none' },\n    hook: {\n      insert: callCustomAnnotationFn,\n      update: callCustomAnnotationFn,\n    },\n  }),] : map(annotation(store), annotations);\n\n  return h('div', {\n    style: { position: 'relative', display: (rendered ? 'block' : 'none') },\n    on: { contextmenu: ignoreRightClick },\n    hook: { insert: attachTranslator(store, translator) },\n  }, children);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/canvas.js","import h from 'snabbdom/h';\nimport { map, filter } from 'ramda';\nimport { Map } from 'immutable';\nimport { getRect } from '../modules/player';\nimport { setAnnotationProperties } from '../modules/annotations';\n\nlet imgStyle = { cursor: 'pointer' };\n\nconst initialAnnotationState = Map({ open: false, pinned: false });\n\nconst bs = '5px solid #333';\nconst bi = '5px solid transparent';\n\nconst arrowCss = {\n  position: 'absolute',\n  display: 'inline-block',\n  borderTop: bi, borderLeft: bi, borderRight: bi, borderBottom: bi,\n  height: 0,\n  width: 0,\n  top: '', bottom: '', right: '', left: '',\n};\n\nconst arrows = {\n  tl: { ...arrowCss, ...{ borderRight: bs, top: '12px', left: '-10px', marginTop: '-5px' } },\n  bl: { ...arrowCss, ...{ borderRight: bs, bottom: '8px', left: '-10px', marginTop: '-5px' } },\n  tr:  { ...arrowCss, ...{ borderLeft: bs, top: '12px', right: '-10px', marginTop: '-5px' } },\n  br:  { ...arrowCss, ...{ borderLeft: bs, bottom: '8px', right: '-10px', marginTop: '-5px' } },\n};\n\nconst popupCss = { position: 'absolute', textAlign: 'left',\n  left: '', top: '', bottom: '', right: '',\n  transition: 'opacity 0.3s ease-out', webkitTransition: 'opacity 0.3s ease-out',\n  fontFamily: 'sans-serif', delayed: { opacity: 1 }, remove: { opacity: 0 },\n};\n\nconst popupCsses = {\n  tl:  { ...popupCss, ...{ left: '30px', top: '0' } },\n  bl:  { ...popupCss, ...{ left: '30px', bottom: '0' } },\n  tr:   { ...popupCss, ...{ right: '30px', top: '0' } },\n  br:  { ...popupCss, ...{ right: '30px', bottom: '0' } },\n};\n\nexport function getAnnotationProperties(store, data) {\n  const rect = getRect(store);\n  const { position, normal, alpha } = data.position(store);\n  if (!position) return false;\n\n  const left = rect.width * position.x;\n  const bottom = rect.height * position.y;\n  const visible = !(left <  0 || left > rect.width - 24 || bottom < 0 || bottom > rect.height - 24) && data.visible;\n\n  return {\n    ...data.annotation,\n    id: data.id,\n    alpha,\n    normal,\n    position,\n    top: rect.height - bottom,\n    right: rect.width - left,\n    bottom,\n    left,\n    visible,\n  };\n};\n\nexport default function(store) {\n  const rect = getRect(store);\n  const compact = filter((n) => n);\n\n  return function (annotation) {\n    const { id, text, left, bottom, visible, position, normal, alpha } = annotation; //data.position(store);\n    if (position === undefined) return h('span');\n\n    const state = store.getIn(['annotations', id]) || Map({ open: annotation.open, pinned: annotation.open });\n    const open = state.get('open');\n    const pinned = state.get('pinned');\n\n    let tb = position.y > 0.5 ? 't' : 'b';\n    let lr = position.x < 0.6 ? 'l' : 'r';\n    let side = [tb, lr].join('');\n\n    function click(ev) {\n      ev.preventDefault();\n      store.dispatch(setAnnotationProperties(id, {\n        open: (!pinned ? true : !open),\n        pinned: !pinned,\n      }));\n    }\n\n    function mouseover(ev) {\n      if (!pinned) store.dispatch(setAnnotationProperties(id, { open: true }));\n    }\n\n    function mouseout(ev) {\n      if (!pinned) store.dispatch(setAnnotationProperties(id, { open: false }));\n    };\n\n    let children = [h('img', { style: { cursor: 'pointer' }, props: {\n      width: 24,\n      height: 24,\n      src: `${__URLROOT__}/img/annotation-${open ? 'open' : 'closed'}.svg`,\n    }, }),];\n\n    if (open) {\n      const textCss = {\n        fontSize: '12px', padding: '10px', color: '#fff', backgroundColor: '#000',\n        borderRadius: '3px', opacity: '0.8', cursor: 'pointer', lineHeight: 1.3,\n        width: text.length > 10 ? (text.length > 50 ? '200px' : '150px') : '100px',\n      };\n\n      children.push(h('div', { style: popupCsses[side] }, compact([\n        lr === 'l' && h('div', { key: side, style: arrows[side] }),\n        h('div', { key: 'text', style: textCss, on: { click } }, text),\n        lr === 'r' && h('div', { key: side, style: arrows[side] }),\n      ])));\n    }\n\n    return h('div', {\n      key: id,\n      style: {\n        visibility: visible ? 'visible' : 'hidden',\n        opacity: alpha,\n        position: 'absolute',\n        left: `${Math.round(left)}px`,\n        bottom: `${Math.round(bottom)}px`,\n      },\n      on: { click, mouseover, mouseout },\n    }, children);\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/annotation.js","import h from 'snabbdom/h';\nimport { filter, map, reduce } from 'ramda';\nimport * as svgIcons from './icons';\nimport { getActiveColor, getCanvasElement, getHoverColor, } from '../modules/player';\nimport { getCommands, isCommandActive, runCommand, } from '../modules/commands';\nimport timeline from './timeline';\n\nconst isTouch = __BROWSER__ && (!!('ontouchstart' in window) || window.navigator.msMaxTouchPoints > 0);\n\nexport function hoverStyle(store) {\n  const hoverColor = getHoverColor(store);\n\n  const hoverStyle = isTouch ? '' : `\ndiv.claraplayer ul.tools li:not(.active):hover svg path {\n  fill: ${hoverColor};\n}\n`;\n  return h('style', { props: { innerHTML: hoverStyle } });\n}\n\nexport default function manipulatorTools(store) {\n  const tools = getCommands(store, 'playerTools');\n  const activeColor = getActiveColor(store);\n\n  function click(what) {\n    return (ev) => {\n      store.dispatch(runCommand(what));\n      const canvas = getCanvasElement(store);\n      if (canvas) canvas.focus();\n    };\n  }\n\n  let toolChildren = [\n    hoverStyle(store),\n\n    h('ul.tools', { style: {\n      position: 'relative',\n      bottom: 0,\n      left: 0,\n      listStyleType: 'none',\n      padding: '0 5px',\n      margin: 0,\n      zIndex: 2147483647,\n    }, }, [svgIcons.glowFilter()].concat(map((key) => {\n      const command = tools[key];\n      const active = command.isActive ? command.isActive(store) : command.active;\n      const label = command.active && command.activeLabel ? command.activeLabel : command.label;\n      const svgIcon = svgIcons[command.options.icon || key];\n      const iconChildren = [];\n\n      if (typeof svgIcon === 'function') {\n        iconChildren.push(svgIcon({ width: 34, height: 34, title: label }, { active, activeColor }));\n      }  else {\n        iconChildren.push(h('span', { style: { color: active ? activeColor : '#fff' } }, label));\n      }\n\n      return h('li' + (active ? '.active' : ''), {\n        attrs: { title: label },\n        on: { click: click(key) },\n        style: {\n          cursor: 'pointer',\n          float: 'left',\n          borderRadius: '5px',\n          padding: '5px',\n          boxSizing: 'border-box',\n        },\n      }, iconChildren);\n    }, Object.keys(tools)))),\n  ];\n\n  const tLine = timeline(store);\n  if (tLine) toolChildren.push(tLine);\n\n  return h('span', { style: {\n    position: 'absolute',\n    left: '5px',\n    right: '5px',\n    bottom: '5px',\n    display: 'flex',\n    flexWrap: 'nowrap',\n    height: '54px',\n  }, }, toolChildren);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/manipulatorTools.js","import h from 'snabbdom/h';\n\nconst filter = 'url(#glowfilter)';\nconst activeColor = '#ffc85f';\nconst blurColor = '#000';\nconst color = '#fff';\nconst padding = '0';\nconst boxSizing = 'border-box';\nconst viewBox = '-300 -300 1624 1624';\nconst panViewBox = '-150 -150 812 812';\n\nexport function glowFilter() {\n  return h('svg', { attrs: { width: 0, height: 0 } }, [\n    h('filter', { attrs: { id: 'glowfilter' } }, [\n      h('feGaussianBlur', { attrs: { in: 'SourceAlpha', stdDeviation: 50, result: 'blur' } }),\n      h('feOffset', { attrs: { in: 'blur', dx: 0, dy: 0, result: 'offsetBlur' } }),\n      h('feFlood', { attrs: { 'flood-color': blurColor, 'flood-opacity': 1, result: 'offsetColor' } }),\n      h('feComposite', { attrs: { in: 'offsetColor', in2: 'offsetBlur', operator: 'in', result: 'offsetBlurComposed' } }),\n      h('feMerge', [\n        h('feMergeNode', { attrs: { in: 'offsetBlurComposed' } }),\n        h('feMergeNode', { attrs: { in: 'SourceGraphic' } }),\n      ]),\n    ]),\n  ]);\n}\n\n// icomoon free svg icons\n\nexport function home(attrs, options) {\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding, boxSizing } }, [\n    //blurFilter('homefilter'),\n    h('path', { attrs: { fill: color, filter, d: 'M1024 608l-192-192v-288h-128v160l-192-192-512 512v32h128v320h320v-192h128v192h320v-320h128z' } }),\n  ]);\n};\n\nexport function orbit(attrs, options) {\n  var fill = options.active ? options.activeColor : color;\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding, boxSizing } }, [\n    h('path', { attrs: { fill, filter, d: 'M1024 384h-384l143.53-143.53c-72.53-72.526-168.96-112.47-271.53-112.47s-199 39.944-271.53 112.47c-72.526 72.53-112.47 168.96-112.47 271.53s39.944 199 112.47 271.53c72.53 72.526 168.96 112.47 271.53 112.47s199-39.944 271.528-112.472c6.056-6.054 11.86-12.292 17.456-18.668l96.32 84.282c-93.846 107.166-231.664 174.858-385.304 174.858-282.77 0-512-229.23-512-512s229.23-512 512-512c141.386 0 269.368 57.326 362.016 149.984l149.984-149.984v384z' } }),\n  ]);\n}\n\nexport function pan(attrs, options) {\n  var fill = options.active ? options.activeColor : color;\n  return h('svg', { attrs: { viewBox: panViewBox, ...attrs }, style: { padding, boxSizing } }, [\n    h('g', { attrs: { transform: 'matrix(0.49680763,0.49680763,-0.49680763,0.49680763,255.01217,2.6223229)' } }, [\n      h('path', { attrs: { fill, filter, d: 'M -0.49680099,-1.4900844 -0.49680795,206.9137 79.659562,126.75733 207.90699,255.00476 79.657586,383.25416 -0.49680795,303.09977 l 4.41e-6,208.40379 208.40379354,0 -80.15637,-80.15637 128.2494,-128.2494 c 43.4197,43.41971 90.25956,90.25956 128.2494,128.2494 l -80.15637,80.15637 208.4038,0 0,-208.40379 -80.1544,80.15439 -128.2494,-128.2494 c 42.74914,-42.74914 85.49828,-85.49828 128.24743,-128.24743 l 80.15637,80.15637 -10e-6,-208.4037813 -208.40379,-1e-5 80.1544,80.1543943 C 341.4983,121.41344 298.74916,164.16259 256.00002,206.91173 L 127.75259,78.664303 207.90699,-1.4900913 Z' } }),\n    ]),\n  ]);\n}\n\n// paths for diagonal arrows\n//h('path', { attrs: { fill, filter, d: \"M1024 0h-416l160 160-192 192 96 96 192-192 160 160z\"} }),\n//h('path', { attrs: { fill, filter, d: \"M1024 1024v-416l-160 160-192-192-96 96 192 192-160 160z\" } }),\n//h('path', { attrs: { fill, filter, d: \"M0 1024h416l-160-160 192-192-96-96-192 192-160-160z\" } }),\n//h('path', { attrs: { fill, filter, d: \"M0 0v416l160-160 192 192 96-96-192-192 160-160z\" } }),\n\nexport function zoom(attrs, options) {\n  var fill = options.active ? options.activeColor : color;\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding, boxSizing } }, [\n    h('path', { attrs: { fill, filter, d: 'M992.262 871.396l-242.552-206.294c-25.074-22.566-51.89-32.926-73.552-31.926 57.256-67.068 91.842-154.078 91.842-249.176 0-212.078-171.922-384-384-384-212.076 0-384 171.922-384 384s171.922 384 384 384c95.098 0 182.108-34.586 249.176-91.844-1 21.662 9.36 48.478 31.926 73.552l206.294 242.552c35.322 39.246 93.022 42.554 128.22 7.356s31.892-92.898-7.354-128.22zM384 640c-141.384 0-256-114.616-256-256s114.616-256 256-256 256 114.616 256 256-114.614 256-256 256z' } }),\n  ]);\n}\n\nexport function fullscreen(attrs, options) {\n  const fill = options.active ? options.activeColor : color;\n\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding: boxSizing } }, [\n    options.active\n      ? h('path', { attrs: { fill, filter, d: 'M448 576v416l-160-160-192 192-96-96 192-192-160-160zM1024 96l-192 192 160 160h-416v-416l160 160 192-192z' } })\n      : h('path', { attrs: { fill, filter, d: 'M1024 0v416l-160-160-192 192-96-96 192-192-160-160zM448 672l-192 192 160 160h-416v-416l160 160 192-192z' } }),\n  ]);\n}\n\nexport function vrMode(attrs, options) {\n  const fill = options.active ? options.activeColor : color;\n\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding: boxSizing } }, [\n    h('path', { attrs: { fill, filter, d: 'M884.907 256h-748.373c-27.733 0-51.2 24.32-51.2 54.187v446.293c0 29.867 23.467 54.187 52.48 54.187h203.52c23.040 0 42.667-13.653 49.493-33.707l59.307-148.053c10.24-24.747 34.133-42.24 61.867-42.24s51.627 17.493 61.867 42.24l59.307 148.053c8.107 20.053 26.453 33.707 47.36 33.707h204.373c30.293 0 53.76-24.32 53.76-54.187v-446.293c0-29.867-23.467-54.187-53.76-54.187zM308.053 622.080c-52.053 0-94.72-43.947-94.72-97.707 0-55.040 42.667-97.707 94.72-97.707s94.293 42.667 94.293 97.707c0 53.76-42.24 97.707-94.293 97.707zM715.947 622.080c-52.053 0-94.293-43.947-94.293-97.707s42.24-97.707 94.293-97.707c52.053 0 94.72 43.947 94.72 97.707s-42.667 97.707-94.72 97.707z' } }),\n  ]);\n}\n\nexport function lenticularMode(attrs, options) {\n  const fill = options.active ? options.activeColor : color;\n\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding: boxSizing } }, [\n    options.active\n      ? h('path', { attrs: { fill, filter, d: 'M317.143 762.857l44.571-80.571q-49.714-36-77.714-90.857t-28-116q0-69.143 34.857-128.571-130.857 66.857-217.714 201.714 95.429 147.429 244 214.286zM539.429 329.143q0-11.429-8-19.429t-19.429-8q-71.429 0-122.571 51.143t-51.143 122.571q0 11.429 8 19.429t19.429 8 19.429-8 8-19.429q0-49.143 34.857-84t84-34.857q11.429 0 19.429-8t8-19.429zM746.857 220q0 4-0.571 5.143-60 107.429-180 323.429t-180.571 324l-28 50.857q-5.714 9.143-16 9.143-6.857 0-76.571-40-9.143-5.714-9.143-16 0-6.857 25.143-49.714-81.714-37.143-150.571-98.857t-119.143-140q-11.429-17.714-11.429-39.429t11.429-39.429q87.429-134.286 217.143-212t283.429-77.714q50.857 0 102.857 9.714l30.857-55.429q5.714-9.143 16-9.143 2.857 0 10.286 3.429t17.714 8.857 18.857 10.571 18 10.571 11.143 6.571q9.143 5.714 9.143 15.429zM768 475.429q0 79.429-45.143 144.857t-119.429 94l160-286.857q4.571 25.714 4.571 48zM1024 548.571q0 20-11.429 39.429-22.286 36.571-62.286 82.857-85.714 98.286-198.571 152.571t-239.714 54.286l42.286-75.429q121.143-10.286 224.286-78.286t172.286-175.429q-65.714-102.286-161.143-168l36-64q54.286 36.571 104.286 87.429t82.571 105.143q11.429 19.429 11.429 39.429z' } })\n      : h('path', { attrs: { fill, filter, d: 'M950.857 548.571q-86.857-134.857-217.714-201.714 34.857 59.429 34.857 128.571 0 105.714-75.143 180.857t-180.857 75.143-180.857-75.143-75.143-180.857q0-69.143 34.857-128.571-130.857 66.857-217.714 201.714 76 117.143 190.571 186.571t248.286 69.429 248.286-69.429 190.571-186.571zM539.429 329.143q0-11.429-8-19.429t-19.429-8q-71.429 0-122.571 51.143t-51.143 122.571q0 11.429 8 19.429t19.429 8 19.429-8 8-19.429q0-49.143 34.857-84t84-34.857q11.429 0 19.429-8t8-19.429zM1024 548.571q0 19.429-11.429 39.429-80 131.429-215.143 210.571t-285.429 79.143-285.429-79.429-215.143-210.286q-11.429-20-11.429-39.429t11.429-39.429q80-130.857 215.143-210.286t285.429-79.429 285.429 79.429 215.143 210.286q11.429 20 11.429 39.429z' } }),\n  ]);\n}\n\n//export function enableParallaxmode(attrs, options) {\n//  const fill = options.active ? options.activeColor : color;\n\n//  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding: boxSizing }}, [\n//    h('path', { attrs: { fill, filter, d: \"M494.464 96.192l-427.584 184.224 428 182.784 432.416-183.2-432.832-183.808zM512 486.208v441.6l415.84-197.408v-420.832l-415.84 176.64zM64.16 730.4l417.248 197.408v-441.6l-417.248-176.64v420.832z\" } }),\n//  ]);\n//}\n\n//export function disableParallaxmode(attrs, options) {\n//  const fill = '#000';\n\n//  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding: boxSizing }}, [\n//    h('path', { attrs: { fill, filter, d: \"M494.464 96.192l-427.584 184.224 428 182.784 432.416-183.2-432.832-183.808zM512 486.208v441.6l415.84-197.408v-420.832l-415.84 176.64zM64.16 730.4l417.248 197.408v-441.6l-417.248-176.64v420.832z\" } }),\n//  ]);\n//}\n//\nexport function deviceTracking(attrs, options) {\n  const fill = options.active ? options.activeColor : color;\n\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding: boxSizing } }, [\n    h('path', { attrs: { fill, filter, d: 'M395 37.2c-24.2 1.4-50.2 3.6-57.8 4.8-28.2 4.4-60.2 22.8-77.4 44.4-7.8 9.8-23.4 39-21.6 40.4 1.2 1 26.4 9.2 26.6 8.6 0.2-0.2 3.2-6.4 7-13.8 11.6-23.6 38.8-44 65.4-49.6 9.2-1.8 59.8-6 74.4-6h6.4v85.6l-16.4 1.2c-9.2 0.6-38.2 2-64.6 3.2-52.8 2.4-92.6 6.4-108 11-13 3.8-24.6 11.4-31.4 20.8-5 7-15.6 38.6-21.6 64l-2.6 10.6-8.2-1.2c-4.4-0.8-11.4-1.8-15.2-2.4l-7-1.2-17.6 88.4c-12.8 63.6-17 89-15.4 90 1.2 0.8 8.4 2.4 15.8 3.8l13.4 2.4-1.8 13.4c-1 7.4-1.8 31-2 52.4-0.2 34.6 0.2 40.4 4 51.4 15.2 45.6 59.8 72 133 78.6 24 2.2 25.2 2.2 42.6-3 62.8-18.2 121.4-24.2 219-22.4 79 1.6 130.2 8 175.6 22.4 15 4.8 17 5 38.6 3.2 73.4-6.2 118.6-32.2 134.8-77.2 4.6-13.2 6.4-64.6 3.2-95.2-1.4-12.2-2-22.6-1.6-23s6.8-2 14.2-3.6c7.4-1.4 13.8-3.2 14.4-3.6 0.4-0.6-7-40.4-16.8-88.8l-17.6-87.8-5.8 0.2c-3.4 0-10.2 0.8-15.2 1.6l-9.2 1.6-6.2-25c-9-35.4-13.2-45.8-22.2-54-8.8-8-30-18.4-43.6-21.6-15.4-3.4-63.8-7.4-120-10.2l-52.6-2.4v-85.6l5.6 1.2c3 0.6 18 1.6 33.4 2.2 15.4 0.8 34 2.6 41.6 4 28.2 5.8 54.4 26 67 51.6 3.8 7.6 7.8 13.2 9 12.8 1.4-0.4 7.2-2.4 13-4.2 5.6-2 10.4-4.6 10.4-6 0-1.6-3.4-9.4-7.4-17.4-10.6-21.4-32.6-43-54.4-53.6-9.2-4.4-23-9.4-31-11-38.2-8.2-203.8-11.6-296.2-6zM592 186c68.4 3.2 106 9 132.2 20.2 12 5.2 16.8 11.8 34.2 46.8 37.6 75 76.8 210.6 72.6 250.6-0.8 7.4-2.6 15.6-4 18.6-3.6 6.8-18.4 20.2-32.4 29.2-12.4 7.8-61.8 32-76.6 37.4-8.6 3-8.8 3-4-0.4 49.6-35 63.4-45.6 76.6-58.4 17.8-17.6 17.4-16 12.4-56-4.8-39-20-94.8-40.4-149-11-29.4-36.4-82.4-42.4-88.4-7.4-7.8-43.2-16.4-86.2-20.6-34.4-3.4-158.2-4.8-206.8-2.2-60.4 3.2-89.4 7.4-112.2 16.4-12 4.6-16.8 11.6-33.6 49.8-38 86.6-61.4 172.2-61.4 224.4v15.4l13.2 13.2c12.8 12.6 43.4 35.6 67.4 50.4 6.2 4 11.2 7.6 10.6 8-1.2 1.4-40.4-15-62.8-26.2-24.8-12.4-45-26.6-49-34.6-1.6-3-4-15.6-5.4-27.6-2.2-20-2-24.2 1.8-46.4 8-46.4 22.4-94.6 45.6-153.6 13.4-34 32-73 40.2-84.2 7.8-10.6 21.2-17 46.4-22.4 19.2-4.2 70.6-10 98-11 38.6-1.6 127.2-1.2 166 0.6zM194 656.8c0 6.4 6 33 10 45.2 21.6 63.6 98.4 169.8 171 236.8 28 25.8 44 37.4 60.8 44.2 25.2 10.4 69 15 103.6 11.2 52.2-6 69.8-16 125.6-71 90-89.2 156-193 163.8-257.8l1.4-11.4h-30.2v7.6c0 19.8-18 63.4-41.8 101.4-38 60.2-102 134.8-150 174.8-25.4 21-49.8 28.2-96.2 28.2-41.2 0-63.6-5.4-85.6-20.4-15.8-10.8-56-49.2-79-75.6-73.4-83.8-117.8-157.2-124.4-205.6l-1.4-10.4h-13.8c-10.6 0-13.8 0.6-13.8 2.8zM407.2 770.6c-1.8 7.4-3.2 13.6-3.2 14.2 0 1.6 28 7.4 55 11.4 43.2 6.4 79.6 4.6 136-6.2 12.2-2.4 22.2-4.6 22.6-5 0.4-0.2-1-6.6-2.8-14l-3.4-13.4-7.2 1c-4 0.6-17.6 3.2-30.2 5.6-33.6 6.6-93.2 6.6-126 0.2-12.6-2.6-26.2-5.2-30.2-5.8l-7.2-1-3.4 13z' } }),\n  ]);\n}\n\nexport function nodeRotate(attrs, options) {\n  const fill = options.active ? options.activeColor : color;\n\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding: boxSizing } }, [\n    h('path', { attrs: { fill, filter, d: 'M1024 384h-384l143.53-143.53c-72.53-72.526-168.96-112.47-271.53-112.47s-199 39.944-271.53 112.47c-72.526 72.53-112.47 168.96-112.47 271.53s39.944 199 112.47 271.53c72.53 72.526 168.96 112.47 271.53 112.47s199-39.944 271.528-112.472c6.056-6.054 11.86-12.292 17.456-18.668l96.32 84.282c-93.846 107.166-231.664 174.858-385.304 174.858-282.77 0-512-229.23-512-512s229.23-512 512-512c141.386 0 269.368 57.326 362.016 149.984l149.984-149.984v384z' } }),\n    h('path', { attrs: { fill, filter, d: 'M512 250l262 262-262 262-262-262z' } }),\n  ]);\n}\n\nexport function nodeMove(attrs, options) {\n  const fill = options.active ? options.activeColor : color;\n  return h('svg', { attrs: { viewBox: panViewBox, ...attrs }, style: { padding, boxSizing } }, [\n    h('g', { attrs: { transform: 'matrix(0.49680763,0.49680763,-0.49680763,0.49680763,255.01217,2.6223229)' } }, [\n      h('path', { attrs: { fill, filter, d: 'M -0.49680099,-1.4900844 -0.49680795,206.9137 79.659562,126.75733 207.90699,255.00476 79.657586,383.25416 -0.49680795,303.09977 l 4.41e-6,208.40379 208.40379354,0 -80.15637,-80.15637 128.2494,-128.2494 c 43.4197,43.41971 90.25956,90.25956 128.2494,128.2494 l -80.15637,80.15637 208.4038,0 0,-208.40379 -80.1544,80.15439 -128.2494,-128.2494 c 42.74914,-42.74914 85.49828,-85.49828 128.24743,-128.24743 l 80.15637,80.15637 -10e-6,-208.4037813 -208.40379,-1e-5 80.1544,80.1543943 C 341.4983,121.41344 298.74916,164.16259 256.00002,206.91173 L 127.75259,78.664303 207.90699,-1.4900913 Z' } }),\n      h('path', { attrs: { fill, filter, d: 'M256 0l256 256-256 256-256-256z' } }),\n    ]),\n  ]);\n}\n\nexport function nodeScale(attrs, options) {\n  const fill = options.active ? options.activeColor : color;\n\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding, boxSizing } }, [\n    h('path', { attrs: { fill, filter, d: 'M992.262 871.396l-242.552-206.294c-25.074-22.566-51.89-32.926-73.552-31.926 57.256-67.068 91.842-154.078 91.842-249.176 0-212.078-171.922-384-384-384-212.076 0-384 171.922-384 384s171.922 384 384 384c95.098 0 182.108-34.586 249.176-91.844-1 21.662 9.36 48.478 31.926 73.552l206.294 242.552c35.322 39.246 93.022 42.554 128.22 7.356s31.892-92.898-7.354-128.22zM384 640c-141.384 0-256-114.616-256-256s114.616-256 256-256 256 114.616 256 256-114.614 256-256 256z' } }),\n    h('path', { attrs: { fill, filter, d: 'M375 181l200 200-200 200-200-200z' } }),\n  ]);\n}\n\nexport function pause(attrs, options) {\n  const fill = options.active ? options.activeColor : color;\n\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding, boxSizing } }, [\n    h('path', { attrs: { fill, filter, d: 'M64 0h384v1024h-384z' } }),\n    h('path', { attrs: { fill, filter, d: 'M576 0h384v1024h-384z' } }),\n  ]);\n}\n\nexport function play(attrs, options) {\n  const fill = options.active ? options.activeColor : color;\n\n  return h('svg', { attrs: { viewBox, ...attrs }, style: { padding, boxSizing } }, [\n    h('path', { attrs: { fill, filter, d: 'M138 0L1024 512L138 1024z' } }),\n  ]);\n}\n\nexport function select(attrs, options) {\n  const fill = options.active ? options.activeColor : '#000'; // FIXME white default not displayed?\n  return h('svg', { attrs: { viewBox: '0 0 32 32', ...attrs }, style: { padding, boxSizing } }, [\n    h('path', { attrs: { fill, filter, d: 'M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM16 28c-6.627 0-12-5.373-12-12s5.373-12 12-12c6.627 0 12 5.373 12 12s-5.373 12-12 12zM10 16c0-3.314 2.686-6 6-6s6 2.686 6 6c0 3.314-2.686 6-6 6s-6-2.686-6-6z' } }),\n  ]);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/icons.js","import h from 'snabbdom/h';\nimport { play, pause } from './icons';\nimport marker from './marker';\nimport { getActiveColor, getHoverColor } from '../modules/player';\nimport { isPlaying, getTime, startPlaying, stopPlaying, getTimelineAnimation, setTime } from '../modules/animation';\n\nlet dragHandler = null;\nlet timeoutHandler = null;\nlet visible = false;\n\nexport default function timeline(store) {\n  const timelineStyle = {\n    flex: '1 1 auto',\n    position: 'relative',\n    bottom: 0,\n    right: 0,\n    borderRadius: '5px',\n    padding: '0 20px',\n  };\n\n  const rulerStyle = {\n    boxSizing: 'border-box',\n    backgroundColor: 'rgba(0, 0, 0, 0.2)',\n    border: '1px solid #ccc',\n    position: 'relative',\n    top: '17px',\n    left: '56px',\n    height: '10px',\n    width: 'calc(100% - 55px)',\n    cursor: 'pointer',\n  };\n\n  const activeColor = getActiveColor(store);\n  const hoverColor = getHoverColor(store);\n  const iconAttrs = { width: 34, height: 34, title: 'play' };\n  const iconOptions = { active: false, activeColor };\n\n  const timeAnimation = getTimelineAnimation(store);\n  if (!timeAnimation) return null;\n  const startTime = timeAnimation.start;\n  const duration = timeAnimation.duration / Math.abs(timeAnimation.playSpeed);\n  const played = Math.max(Math.min((getTime(store) - startTime) / duration, 1), 0) * 100;\n\n  const playedStyle = {\n    backgroundColor: activeColor,\n    width: 'calc(' + played + '% - 2px)',\n    height: '6px',\n    position: 'absolute',\n    left: '1px',\n    top: '1px',\n    cursor: 'pointer',\n  };\n\n  const buttonStyle = {\n    position: 'relative',\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    top: '-5px',\n    cursor: 'pointer',\n  };\n\n  const hoverStyle = `\n    div.claraplayer div div svg:hover path {\n    fill: ${hoverColor};\n  }`;\n\n  function createHandleDrag({ width, left }, touch) {\n    return (ev) => {\n      visible = true;\n      if (timeoutHandler) {\n        window.clearTimeout(timeoutHandler);\n      }\n\n      timeoutHandler = window.setTimeout(function () {\n        visible = false;\n        store.dispatch({ type: 'POKE' });\n      }, 2000);\n\n      const evX = touch ? ev.touches[0].pageX : ev.pageX;\n      const percentTime = Math.max(Math.min((evX - left) / width, 1), 0);\n      const time = (percentTime) * duration + startTime;\n      store.dispatch(setTime(time));\n    };\n  }\n\n  function handleClick(ev) {\n    //console.log(ev.target.parentNode);\n    visible = true;\n    if (timeoutHandler) {\n      window.clearTimeout(timeoutHandler);\n    }\n\n    timeoutHandler = window.setTimeout(function () {\n      visible = false;\n      store.dispatch({ type: 'POKE' });\n    }, 2000);\n\n    if (dragHandler !== null) {\n      window.removeEventListener('mousemove', dragHandler);\n      window.removeEventListener('mouseup', endDrag);\n      window.removeEventListener('touchmove', dragHandler);\n      window.removeEventListener('touchend', endDrag);\n    }\n\n    const touch = !!ev.touches;\n    const evX = touch ? ev.touches[0].clientX : ev.clientX;\n\n    let rectElement = ev.target.className === 'ruler' ? ev.target : ev.target.parentNode;\n    const rect = rectElement.getBoundingClientRect();\n\n    const time = ((evX - rect.left) / rect.width) * duration + startTime;\n    store.dispatch(setTime(time));\n\n    dragHandler = createHandleDrag(rect, touch);\n    if (!touch) {\n      window.addEventListener('mousemove', dragHandler);\n      window.addEventListener('mouseup', endDrag);\n    } else {\n      window.addEventListener('touchmove', dragHandler);\n      window.addEventListener('touchend', endDrag);\n    }\n  }\n\n  function endDrag(ev) {\n    window.removeEventListener('mousemove', dragHandler);\n    window.removeEventListener('mouseup', endDrag);\n    window.removeEventListener('touchmove', dragHandler);\n    window.removeEventListener('touchend', endDrag);\n    dragHandler = null;\n  }\n\n  const icon = isPlaying(store) ? pause(iconAttrs, iconOptions) : play(iconAttrs, iconOptions);\n  const clickAction = isPlaying(store) ? () => store.dispatch(stopPlaying()) : () => store.dispatch(startPlaying());\n\n  return h('div', { style: timelineStyle }, [\n    h('style', { props: { innerHTML: hoverStyle } }),\n    h('div.ruler', { style: rulerStyle, on: { mousedown: handleClick, touchstart: handleClick } }, [\n      h('div.played', { style: playedStyle }),\n      marker(store, played, duration, visible),\n    ]),\n    h('div', { style: buttonStyle, on: { click: clickAction } }, [icon]),\n  ]);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/timeline.js","import h from 'snabbdom/h';\n\nexport default function marker(store, percentPlayed, duration, visible) {\n\n  const markerStyle = {\n    width: '0',\n    height: '100%',\n    position: 'absolute',\n    left: percentPlayed + '%',\n    top: '0',\n    pointerEvents: 'auto',\n    cursor: 'pointer',\n  };\n\n  let toolTipStyle = {\n    boxSizing: 'border-box',\n    position: 'absolute',\n    zIndex: '1070',\n    display: 'block',\n    visibility: 'visible',\n    fontSize: '12px',\n    fontWeight: 'normal',\n    lineHeight: '1.4',\n    top: '-32px',\n    left: '-25px',\n    width: '50px',\n    height: '22px',\n    marginTop: '-3px',\n    padding: '5px 0',\n    opacity: '1',\n  };\n  if (!visible) {\n    toolTipStyle.opacity = '0';\n    toolTipStyle.transition = 'opacity 0.15s linear';\n  }\n\n  const innerStyle = {\n    maxWidth: '200px',\n    padding: '3px 8px',\n    color: '#ffffff',\n    textAlign: 'center',\n    textDecoration: 'none',\n    backgroundColor: '#000000',\n    borderRadius: '4px',\n    boxShadow: '#000 0 0 5px',\n    margin: '0 auto',\n    userSelect: 'none',\n    WebkitUserSelect: 'none',\n    MozUserSelect: 'none',\n  };\n\n  const arrowStyle = {\n    boxSizing: 'border-box',\n    position: 'absolute',\n    width: '0',\n    height: '0',\n    bottom: '-10px',\n    left: '50%',\n    marginLeft: '-5px',\n    borderWidth: '5px 5px 0',\n    borderTopColor: '#000000',\n    borderRightColor: 'transparent',\n    borderBottomColor: 'transparent',\n    borderLeftColor: 'transparent',\n    borderStyle: 'solid',\n  };\n\n  function stopEvent(ev) {\n    ev.stopPropagation();\n  }\n\n  return h('div.marker', { style: markerStyle, on: { mousedown: stopEvent, touchstart: stopEvent } }, [\n    h('div.tooltip', { style: toolTipStyle }, [\n      h('div.tooltip-arrow', { style: arrowStyle }),\n      h('div.tooltip-inner', { style: innerStyle }, (duration * percentPlayed / 100000).toFixed(1)),\n    ]),\n  ]);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/marker.js","import orbit from './orbit';\nimport pan from './pan';\nimport zoom from './zoom';\nimport nodeMove from './nodeMove';\nimport nodeRotate from './nodeRotate';\nimport nodeScale from './nodeScale';\nimport select from './select';\nimport fullscreen from './fullscreen';\nimport home from './home';\nimport vrMode from './vrMode';\nimport firstPersonMode from './firstPersonMode';\n\nconst tools = {\n  orbit,\n  pan,\n  zoom,\n  home,\n  nodeMove,\n  nodeRotate,\n  nodeScale,\n  select,\n  fullscreen,\n  vrMode,\n  firstPersonMode,\n};\n\nexport default tools;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/index.js","import * as THREE from 'three';\nconst { tan, cos, atan, acos, min, max, pow, PI, sqrt } = Math;\nimport decompose from '../utils/decompose';\nimport { getCamera, getCameraWorldTransform, getRect } from '../../modules/player';\nimport { get, getWorldTransform } from '../../modules/scene';\nimport { merge, virtualTargetId } from '../../modules/sceneGraph';\nimport updateCameraLookAtTarget from '../utils/updateCameraLookAtTarget';\nimport getProjectionMatrix from '../utils/getProjectionMatrix';\nimport getTargetWorldMatrix from '../utils/getTargetWorldMatrix';\n\nconst cameraProjectMatrix = new THREE.Matrix4();\nconst cameraUnprojectMatrix = new THREE.Matrix4();\nconst ndcReferencePoint = new THREE.Vector3();\nconst worldRelative = new THREE.Vector3();\nconst deltaReferencePoint = new THREE.Vector3();\nconst referencePoint = new THREE.Vector3();\nconst translationMatrix = new THREE.Matrix4();\n\nconst cameraPosition = new THREE.Vector3();\nconst targetPosition = new THREE.Vector3();\nconst offset = new THREE.Vector3();\n\nexport default function pan(store, translator) {\n  function move({ deltaX, deltaY }) {\n    updatePan(store, new THREE.Vector2(deltaX, deltaY));\n  }\n\n  return {\n    label: 'Pan',\n    enabled: true,\n    display: {\n      playerTools: true,\n    },\n    options: {},\n\n    tool: {\n      drag: function (ev) {\n        if (!this.active && ev.which !== 2 && ev.which !== 3 && !ev.shiftKey) return false;\n\n        return {\n          momentum: true,\n          handle: function (ev) {\n            move(ev);\n          },\n        };\n      },\n\n      swipe: function (ev) {\n        move(ev);\n      },\n    },\n  };\n}\n\nfunction updatePan(store, mouseDelta) {\n  const cameraId = getCamera(store);\n  const cameraData = get(store, { id:  cameraId, evalPlug: 'Camera' });\n  const playerData = get(store, { scene: true, evalPlug: 'Player' });\n  const targetWorldMatrix = getTargetWorldMatrix(store, cameraId);\n  const cameraWorldMatrix = getWorldTransform(store, cameraId);\n  const rect = getRect(store);\n\n  var projectionMatrix = getProjectionMatrix(get(store, { id: cameraId, evalPlug: 'Camera' }));\n  var relativeDelta = new THREE.Vector2().copy(mouseDelta).divide(rect).multiplyScalar(2.0);\n  relativeDelta.x *= -1;\n\n  const invCameraWorldMatrix = new THREE.Matrix4().getInverse(cameraWorldMatrix, true);\n  cameraProjectMatrix.copy(projectionMatrix).multiply(invCameraWorldMatrix);\n\n  ndcReferencePoint.setFromMatrixPosition(targetWorldMatrix).applyMatrix4(cameraProjectMatrix);\n  cameraUnprojectMatrix.getInverse(cameraProjectMatrix, true);\n\n  referencePoint.set(0, 0, ndcReferencePoint.z).applyMatrix4(cameraUnprojectMatrix);\n  deltaReferencePoint.set(relativeDelta.x, relativeDelta.y, ndcReferencePoint.z).applyMatrix4(cameraUnprojectMatrix);\n\n  // ensure that NDC has the same layout as mouseDelta coordinate space\n  worldRelative.copy(deltaReferencePoint).sub(referencePoint);\n\n  //bounding box constraining\n  if (cameraData.radiusConstraint && worldRelative.length() > 0) {\n    const { maxBoundingSphere, minBoundingSphere } = cameraData.radiusConstraint;\n    cameraPosition.setFromMatrixPosition(cameraWorldMatrix);\n    targetPosition.setFromMatrixPosition(targetWorldMatrix);\n\n    const directionNorm = new THREE.Vector3().copy(worldRelative).normalize();\n    const camRay = new THREE.Ray(cameraPosition, directionNorm);\n    const targRay = new THREE.Ray(targetPosition, directionNorm);\n\n    const targHit = targRay.intersectSphere(minBoundingSphere).sub(targetPosition).length() - __BOUNDING_BUFFER__;\n\n    let inCamHit = camRay.intersectSphere(minBoundingSphere);\n    if (inCamHit) inCamHit = inCamHit.sub(cameraPosition).length() - __BOUNDING_BUFFER__;\n    else inCamHit = Infinity;\n\n    const outCamHit = camRay.intersectSphere(maxBoundingSphere).sub(cameraPosition).length() - __BOUNDING_BUFFER__;\n\n    const moveLength = Math.min(worldRelative.length(), targHit, inCamHit, outCamHit);\n    worldRelative.normalize().multiplyScalar(moveLength);\n  }\n\n  translationMatrix.makeTranslation(worldRelative.x, worldRelative.y, worldRelative.z);\n  offset.addVectors(cameraData.offset, worldRelative);\n  cameraData.offset = offset;\n\n  targetWorldMatrix.multiplyMatrices(translationMatrix, targetWorldMatrix);\n  cameraWorldMatrix.multiplyMatrices(translationMatrix, cameraWorldMatrix);\n\n  if (playerData.constraintCameraY && playerData.orbitMode !== 'trackball') {\n    cameraPosition.setFromMatrixPosition(cameraWorldMatrix);\n    targetPosition.setFromMatrixPosition(targetWorldMatrix);\n\n    if (cameraPosition.y < 0) {\n      targetPosition.y -= cameraPosition.y;\n      cameraPosition.y = 0;\n    }\n\n    targetWorldMatrix.setPosition(targetPosition);\n    cameraWorldMatrix.setPosition(cameraPosition);\n  }\n\n  updateCameraLookAtTarget(cameraWorldMatrix, targetWorldMatrix, cameraData.upPosition);\n\n  store.dispatch(merge([cameraId, 'Transform', 0], decompose(cameraWorldMatrix)));\n  store.dispatch(merge([virtualTargetId, 'Transform', 0], decompose(targetWorldMatrix)));\n  //store.dispatch(merge([cameraId, 'Camera', 0], {offset}));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/pan.js","import * as THREE from 'three';\n\nexport default function getProjectionMatrix(cameraData) {\n  const projectionMatrix = new THREE.Matrix4();\n  if (cameraData.projection === 'Orthographic') {\n    const size = /* this.computeCameraSize(true) ||*/ { width: 1, height: 1 };\n    projectionMatrix.makeOrthographic(-size.width, size.width, -size.height,\n        size.height, cameraData.nearClip, cameraData.farClip);\n  } else {\n    // const filmSizeVec = new THREE.Vector2(cameraData.get('filmSize'),\n    //     cameraData.get('filmSize') * cameraData.get('aspectRatio'));\n    //  console.log(navigator.getProjectionMatrix:, data.fieldOfView, data.aspectRatio);\n\n    const ymax = cameraData.nearClip * Math.tan( THREE.Math.DEG2RAD * cameraData.fieldOfView * 0.5 );\n    const ymin = - ymax;\n    const xmin = ymin * cameraData.aspectRatio;\n    const xmax = ymax * cameraData.aspectRatio;\n\n    return projectionMatrix.makePerspective( xmin, xmax, ymax, ymin, cameraData.nearClip, cameraData.farClip );\n\n  }\n\n  return projectionMatrix;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/getProjectionMatrix.js","import * as THREE from 'three';\nimport getProjectionMatrix from '../utils/getProjectionMatrix';\nimport { getCamera, getCameraWorldTransform, getRect, getThreeCamera } from '../../modules/player';\nimport { find, get, getWorldTransform, set, filter } from '../../modules/scene';\nimport { getSelectedNodes } from '../../modules/selection';\nimport { drawMoveGizmo, highlightAxis, getViewScale } from './gizmos';\nimport getProjectedPoint from './utils/getProjectedPoint';\nconst { PI, sin } = Math;\n\nconst invCameraWorldMatrix = new THREE.Matrix4();\nconst cameraProjectMatrix = new THREE.Matrix4();\nconst cameraUnprojectMatrix = new THREE.Matrix4();\nconst inverseParent = new THREE.Matrix4();\nconst referencePoint = new THREE.Vector3();\nconst deltaReferencePoint = new THREE.Vector3();\n\n//const defaultOptions = {\n//  displayGizmo: true,\n//  useXAxis: true,\n//  useYAxis: true,\n//  useZAxis: true,\n//  defaultPlane: { x: 0, y: 0 },\n//}\n\n//updateTool('nodeMove', { displayGizmo: false });\n\nexport default function nodeMove(store, translator) {\n  let activeAxis = false;\n\n  return {\n    label: 'Move Node',\n    enabled: true,\n    display: {\n      playerTools: false,\n    },\n\n    options: {\n      displayGizmo: true,\n      mode: 'free',\n      plane: {\n        normal: { x: 0, y: 1, z: 0 },\n        constant: 0,\n      },\n    },\n\n    tool: {\n      hover: function (ev) {\n        if (!this.active) return;\n        activeAxis = highlightAxis(translator, ev, activeAxis);\n      },\n\n      drag: function (ev) {\n        if (ev.which !== 1 || !this.active || ev.metaKey) return false;\n        const self = this;\n        return {\n          momentum: !activeAxis,\n          handle: function (ev) {\n            switch (self.options.mode) {\n              case 'plane':\n                moveNodeOnPlane(store, ev.deltaX, ev.deltaY, self.options.plane);\n                break;\n              case 'objects':\n                moveNodeOnObjects(store, ev.clientX, ev.clientY, self.options.objects);\n                break;\n              default:\n                moveNodeFree(store, ev.deltaX, ev.deltaY, activeAxis);\n                break;\n            }\n          },\n        };\n      },\n    },\n\n    widget: {\n      draw: function (manipulatorsObject) {\n        manipulatorsObject.add(drawMoveGizmo());\n        const scale = getViewScale(store);\n        manipulatorsObject.scale.set(scale, scale, scale);\n      },\n\n      position: function (manipulatorsObject) {\n        const selectedNodes = getSelectedNodes(store);\n        if (!selectedNodes.length) {\n          manipulatorsObject.visible = false;\n          return;\n        }\n\n        manipulatorsObject.visible = true;\n        const manipId = selectedNodes[0];\n        const worldTransform = getWorldTransform(store, manipId);\n        const position = new THREE.Vector3();\n        position.setFromMatrixPosition(worldTransform);\n        manipulatorsObject.position.set(position.x, position.y, position.z);\n        //manipulatorsObject.scale.set(2,2,2);\n        const scale = getViewScale(store);\n        manipulatorsObject.scale.set(scale, scale, scale);\n      },\n    },\n  };\n}\n\nfunction moveNodeFree(store, x, y, restrictToAxis) {\n  const selectedNodes = getSelectedNodes(store);\n  if (!selectedNodes.length) return;\n  const manipId = selectedNodes[0];\n\n  const cameraWorldMatrix = getCameraWorldTransform(store);\n  const nodeMatrix = getWorldTransform(store, manipId);\n  if (!nodeMatrix) return;\n\n  const parentMatrix = getWorldTransform(store, find(store, { id: manipId, parent: true }));\n  const nodePosition = new THREE.Vector3().setFromMatrixPosition(nodeMatrix);\n  deltaReferencePoint.copy(getProjectedPoint(store, manipId, x, y));\n\n  if (restrictToAxis) {\n    const projVector = new THREE.Vector3(0, 0, 0);\n    projVector[restrictToAxis] = 1;\n\n    const targToCam = new THREE.Vector3().setFromMatrixPosition(cameraWorldMatrix).sub(nodePosition);\n    const origin = new THREE.Vector3(0, 0, 0);\n    const plane = new THREE.Plane().setFromCoplanarPoints(targToCam, projVector, origin);\n    deltaReferencePoint.projectOnPlane(plane.normal);\n\n    const camToMove = new THREE.Vector3().subVectors(deltaReferencePoint, targToCam);\n    deltaReferencePoint.projectOnVector(projVector).normalize();\n    const alpha = targToCam.angleTo(deltaReferencePoint);\n    const beta = PI - targToCam.angleTo(camToMove);\n    const gamma = PI - alpha - beta;\n    const axis = targToCam.length() * sin(beta) / sin(gamma);\n    deltaReferencePoint.multiplyScalar(axis);\n  }\n\n  nodePosition.add(deltaReferencePoint);\n\n  nodeMatrix.setPosition(nodePosition);\n  if (parentMatrix) nodeMatrix.premultiply(inverseParent.getInverse(parentMatrix));\n\n  nodePosition.setFromMatrixPosition(nodeMatrix);\n\n  // FIXME: Restrict to axis:\n  //if (restrictToAxis) console.log('restrict to axis: ', restrictToAxis);\n\n  store.dispatch(set({ id: manipId, plug: 'Transform', property: 'translation' }, nodePosition));\n}\n\nconst upVector = new THREE.Vector3(0, 1, 0);\n\nconst stripParentTransform = function () {\n  const newLocalTransform = new THREE.Matrix4();\n  const invParentTransform = new THREE.Matrix4();\n\n  return (store, nodeId, position, quaternion, scale) => {\n    newLocalTransform.compose(position, quaternion, scale);\n\n    const parentId = find(store, { id: nodeId, parent: true });\n    const parentTransform = getWorldTransform(store, parentId);\n    if (parentTransform) {\n      invParentTransform.getInverse(parentTransform, true);\n      newLocalTransform.premultiply(invParentTransform);\n      newLocalTransform.decompose(position, quaternion, scale);\n    }\n  };\n}();\n\nconst setNodePosition = function () {\n  const scale = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n  const euler = new THREE.Euler();\n\n  return (store, nodeId, position) => {\n    const scaleNode = get(store, { id: nodeId, plug: 'Transform', property: 'scale' });\n    const rotateNode = get(store, { id: nodeId, plug: 'Transform', property: 'rotation' });\n    const rotateOrder = get(store, { id: nodeId, plug: 'Transform', property: 'rotateOrder' });\n    scale.set(scaleNode.x, scaleNode.y, scaleNode.z);\n    euler.set(rotateNode, rotateOrder);\n    quaternion.setFromEuler(euler);\n\n    stripParentTransform(store, nodeId, position, quaternion, scale);\n\n\n    //store.dispatch(set({id:nodeId, plug:'Transform', property:'rotation'}, newEuler.toVector3().multiplyScalar(180/Math.PI)));\n    store.dispatch(set({ id: nodeId, plug: 'Transform', property: 'translation' }, position));\n  };\n}();\n\nconst getNodeNdc = function () {\n  const oldPosition = new THREE.Vector3();\n  const inverseCameraMatrix = new THREE.Matrix4();\n\n  return (store, nodeId) => {\n    oldPosition.setFromMatrixPosition(getWorldTransform(store, nodeId));\n    const camera = getThreeCamera(store);\n    inverseCameraMatrix.getInverse(camera.matrix, true).premultiply(camera.projectionMatrix);\n    oldPosition.applyMatrix4(inverseCameraMatrix);\n    return oldPosition;\n  };\n}();\n\nconst moveNodeOnObjects = function () {\n  const newQuaternion = new THREE.Quaternion();\n\n  return (store, x, y, objects) => {\n    const rect = getRect(store);\n    const nodeId = getSelectedNodes(store)[0];\n    if (!nodeId) return;\n\n    const ndc = { x: 2 * x / rect.width - 1, y: -2 * y / rect.height + 1 };\n    const hits = store.getTranslator().raycastSelect(ndc);\n    const nodeChildren = filter(store, { from: { id: nodeId } });\n    const nodeHit = hits.find((hit)=> {\n      const foundIndex = objects.findIndex((id)=> {\n        return id === hit.id && id !== nodeId && nodeChildren.indexOf(id) < 0;\n      });\n      return foundIndex >= 0;\n    });\n\n    if (!nodeHit) return;\n\n    let newPosition = nodeHit.data[0].point;\n\n    setNodePosition(store, nodeId, newPosition);\n  };\n}();\n\nconst moveNodeOnPlane = function () {\n  const newPosition = new THREE.Vector3();\n  const newQuaternion = new THREE.Quaternion();\n  const moveOnPlane = new THREE.Plane();\n  const moveOnNormal = new THREE.Vector3();\n\n  return (store, x, y, plane) => {\n    const rect = getRect(store);\n    const nodeId = getSelectedNodes(store)[0];\n    if (!nodeId) return;\n    const oldNdc = getNodeNdc(store, nodeId);\n\n    //const plane = store.getIn(['selection', 'collisionPlane']);\n    const normal = plane.normal;\n\n    moveOnNormal.set(normal.x, normal.y, normal.z);\n    moveOnPlane.set(moveOnNormal, plane.constant);\n\n    const ndc = { x: oldNdc.x + 2 * x / rect.width, y: oldNdc.y - 2 * y / rect.height };\n    const ray = store.getTranslator().getCameraMouseRay(ndc).ray;\n    if (!ray.intersectsPlane(moveOnPlane)) return;\n    ray.intersectPlane(moveOnPlane, newPosition);\n\n    store.dispatch(set({ id: nodeId }));\n    setNodePosition(store, nodeId, newPosition);\n  };\n}();\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/nodeMove.js","import * as THREE from 'three';\nimport { getRect, getThreeCamera } from '../../modules/player';\nimport { getSelectedNodes } from '../../modules/selection';\nimport { getWorldTransform } from '../../modules/scene';\n\nconst axisColors = { x: 0xff0000, y: 0x00ff00, z: 0x0000ff };\n\nconst materials = {\n  x: new THREE.MeshStandardMaterial({ color: axisColors.x, depthTest: false }),\n  y: new THREE.MeshStandardMaterial({ color: axisColors.y, depthTest: false }),\n  z: new THREE.MeshStandardMaterial({ color: axisColors.z, depthTest: false }),\n};\n\nconst lineRadius = 0.02;\n\nfunction cancelAxis(axis) {\n  materials[axis].color = new THREE.Color(axisColors[axis]);\n  materials[axis].needsUpdate = true;\n}\n\nfunction resetMaterials() {\n  ['x', 'y', 'z'].forEach(cancelAxis);\n}\n\nexport function getViewScale(store) {\n  const viewRect = getRect(store);\n  const posObj = new THREE.Vector3().copy(\n    (viewRect.height < viewRect.width) ? { x: 0, y: 0.4, z: 0 } : { x: 0.4, y: 0, z: 0 }\n  );\n\n  const node = getSelectedNodes(store)[0];\n  if (!node) return 0;\n  const nodePosition = new THREE.Vector3().setFromMatrixPosition(getWorldTransform(store, node));\n\n  const camera = getThreeCamera(store);\n  const cameraPosition = new THREE.Vector3().setFromMatrixPosition(camera.matrix);\n\n  const inverseProjectionMatrix = new THREE.Matrix4().getInverse(camera.projectionMatrix, true);\n  const referencePoint = new THREE.Vector3().copy(nodePosition)\n    .applyMatrix4(camera.matrixWorldInverse).applyMatrix4(camera.projectionMatrix);\n  referencePoint.add(posObj).applyMatrix4(inverseProjectionMatrix).applyMatrix4(camera.matrix);\n\n  const scale = referencePoint.sub(nodePosition).length();\n  return scale;\n}\n\nexport function drawMoveGizmo() {\n  resetMaterials();\n  const coneRadius = 0.08;\n  const cone = new THREE.ConeGeometry(coneRadius, 0.25, 25);\n  const yArrow = new THREE.CylinderGeometry(lineRadius, lineRadius, 2, 32);\n  const cone2 = cone.clone();\n  cone.translate(0, 1, 0);\n  cone2.rotateX(Math.PI);\n  cone2.translate(0, -1, 0);\n  yArrow.merge(cone);\n  yArrow.merge(cone2);\n\n  const zArrow = yArrow.clone();\n  const xArrow = yArrow.clone();\n\n  const yMesh = new THREE.Mesh(yArrow, materials.y);\n  yMesh.axis = 'y';\n\n  zArrow.rotateX(Math.PI / 2);\n  const zMesh = new THREE.Mesh(zArrow, materials.z);\n  zMesh.axis = 'z';\n\n  xArrow.rotateZ(Math.PI / 2);\n  const xMesh = new THREE.Mesh(xArrow, materials.x);\n  xMesh.axis = 'x';\n\n  const moveGizmo = new THREE.Object3D();\n  moveGizmo.add(xMesh);\n  moveGizmo.add(yMesh);\n  moveGizmo.add(zMesh);\n\n  return moveGizmo;\n};\n\nexport function drawRotateGizmo() {\n  resetMaterials();\n  var xRotation = new THREE.TorusGeometry(1, lineRadius, 16, 100);\n  const yRotation = xRotation.clone();\n  const zRotation = xRotation.clone();\n\n  xRotation.rotateY(Math.PI / 2);\n  yRotation.rotateX(Math.PI / 2);\n\n  const rotateGizmo = new THREE.Object3D();\n  const xMesh = new THREE.Mesh(xRotation, materials.x);\n  xMesh.axis = 'x';\n  const yMesh = new THREE.Mesh(yRotation, materials.y);\n  yMesh.axis = 'y';\n  const zMesh = new THREE.Mesh(zRotation, materials.z);\n  zMesh.axis = 'z';\n  rotateGizmo.add(xMesh);\n  rotateGizmo.add(yMesh);\n  rotateGizmo.add(zMesh);\n\n  return rotateGizmo;\n};\n\nexport function drawScaleGizmo() {\n  resetMaterials();\n  const boxWidth = 0.2;\n  const box = new THREE.BoxGeometry(boxWidth, boxWidth, boxWidth);\n  const yArrow = new THREE.CylinderGeometry(lineRadius, lineRadius, 1, 32);\n  yArrow.translate(0, 0.5, 0);\n  //const box2 = box.clone();\n  box.translate(0, 1, 0);\n  //box2.rotateX(Math.PI);\n  //box2.translate(0, -1, 0);\n  yArrow.merge(box);\n  //yArrow.merge(box2);\n\n  const zArrow = yArrow.clone();\n  const xArrow = yArrow.clone();\n\n  const yMesh = new THREE.Mesh(yArrow, materials.y);\n  yMesh.axis = 'y';\n\n  zArrow.rotateX(Math.PI / 2);\n  const zMesh = new THREE.Mesh(zArrow, materials.z);\n  zMesh.axis = 'z';\n\n  xArrow.rotateZ(-Math.PI / 2);\n  const xMesh = new THREE.Mesh(xArrow, materials.x);\n  xMesh.axis = 'x';\n\n  const scaleGizmo = new THREE.Object3D();\n  scaleGizmo.add(xMesh);\n  scaleGizmo.add(yMesh);\n  scaleGizmo.add(zMesh);\n\n  return scaleGizmo;\n};\n\nexport function highlightAxis(translator, ev, activeAxis) {\n  let axis = null;\n  const x = ev.clientX / (ev.rect.width / 2) - 1;\n  const y = -(ev.clientY / (ev.rect.height / 2) - 1);\n  const hits = translator.raycastSelect({ x, y }, 'Widgets');\n\n  if (hits && hits[0] && hits[0].node && hits[0].node.axis) {\n    if (activeAxis) cancelAxis(activeAxis);\n    axis = hits[0].node.axis;\n    materials[axis].color = new THREE.Color(1, 1, 0);\n    materials[axis].needsUpdate = true;\n    translator.postTranslate('normal', true);\n  } else if (activeAxis) {\n    cancelAxis(activeAxis);\n    translator.postTranslate('normal', true);\n  }\n\n  return axis;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/gizmos.js","import * as THREE from 'three';\nimport getProjectionMatrix from '../../utils/getProjectionMatrix';\nimport { getCamera, getCameraWorldTransform, getRect } from '../../../modules/player';\nimport { find, get, getWorldTransform, set } from '../../../modules/scene';\n\nconst invCameraWorldMatrix = new THREE.Matrix4();\nconst cameraProjectMatrix = new THREE.Matrix4();\nconst cameraUnprojectMatrix = new THREE.Matrix4();\n\nconst nodePosition = new THREE.Vector3();\nconst referencePoint = new THREE.Vector3();\nconst relativeDelta = new THREE.Vector2();\nconst deltaReferencePoint = new THREE.Vector3();\n\nexport default function getProjectedPoint(store, nodeId, x, y) {\n  const cameraId = getCamera(store);\n  const cameraWorldMatrix = getCameraWorldTransform(store);\n  var projectionMatrix = getProjectionMatrix(get(store, { id: cameraId, evalPlug: 'Camera' }));\n  invCameraWorldMatrix.getInverse(cameraWorldMatrix, true);\n  cameraProjectMatrix.copy(projectionMatrix).multiply(invCameraWorldMatrix);\n\n  const nodeMatrix = getWorldTransform(store, nodeId);\n  if (!nodeMatrix) return;\n\n  const rect = getRect(store);\n  const parentMatrix = getWorldTransform(store, find(store, { id: nodeId, parent: true }));\n  nodePosition.setFromMatrixPosition(nodeMatrix);\n  relativeDelta.set(x, -y).divide(rect).multiplyScalar(2.0);\n\n  referencePoint.copy(nodePosition).applyMatrix4(cameraProjectMatrix);\n  referencePoint.x = 0;\n  referencePoint.y = 0;\n  deltaReferencePoint.set(relativeDelta.x, relativeDelta.y, referencePoint.z);\n\n  cameraUnprojectMatrix.getInverse(cameraProjectMatrix, true);\n  referencePoint.applyMatrix4(cameraUnprojectMatrix);\n  deltaReferencePoint.applyMatrix4(cameraUnprojectMatrix).sub(referencePoint);\n\n  return deltaReferencePoint;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/utils/getProjectedPoint.js","import * as THREE from 'three';\nimport { getCamera, getCameraWorldTransform, getRect } from '../../modules/player';\nimport { find, get, getWorldTransform, set } from '../../modules/scene';\nimport { getSelectedNodes } from '../../modules/selection';\nimport { drawRotateGizmo, highlightAxis, getViewScale } from './gizmos';\nimport getBoundingRadius from './utils/getBoundingRadius';\nconst { min, PI, sqrt } = Math;\n\nconst parentInvMatrix = new THREE.Matrix4();\nconst nodeRotationQuaternion = new THREE.Quaternion();\nconst nodePosition = new THREE.Vector3();\nconst nodeScale = new THREE.Vector3();\nconst nodeRotationEuler = new THREE.Euler();\nconst cameraPosition = new THREE.Vector3();\n\nexport default function nodeRotate(store, translator) {\n  let activeAxis = false;\n\n  return {\n    label: 'Rotate Node',\n    enabled: true,\n    display: {\n      playerTools: false,\n    },\n    options: {},\n\n    tool: {\n      hover: function (ev) {\n        if (!this.active) return;\n        activeAxis = highlightAxis(translator, ev, activeAxis);\n      },\n\n      drag: function (ev) {\n        if (ev.which !== 1 || !this.active || ev.metaKey) return false;\n\n        return {\n          momentum: !activeAxis,\n          handle: function (ev) {\n            rotateNode(store, ev.deltaX, ev.deltaY, activeAxis);\n          },\n        };\n      },\n    },\n\n    widget: {\n      draw: function (manipulatorsObject) {\n        manipulatorsObject.add(drawRotateGizmo());\n        const scale = getViewScale(store);\n        manipulatorsObject.scale.set(scale, scale, scale);\n      },\n\n      position: function (manipulatorsObject) {\n        const selectedNodes = getSelectedNodes(store);\n        if (!selectedNodes.length) {\n          manipulatorsObject.visible = false;\n          return;\n        }\n\n        manipulatorsObject.visible = true;\n        const manipId = selectedNodes[0];\n        const worldTransform = getWorldTransform(store, manipId);\n        const position = new THREE.Vector3();\n        position.setFromMatrixPosition(worldTransform);\n        manipulatorsObject.position.set(position.x, position.y, position.z);\n\n        const scale = getViewScale(store);\n        manipulatorsObject.scale.set(scale, scale, scale);\n      },\n    },\n  };\n}\n\nfunction rotateNode(store, x, y, restrictToAxis) {\n  const rect = getRect(store);\n  const selectedNodes = getSelectedNodes(store);\n  if (!selectedNodes.length) return;\n  const manipId = selectedNodes[0];\n  const nodeTransform = getWorldTransform(store, manipId);\n  if (!nodeTransform) return;\n\n  const cameraWorldMatrix = getCameraWorldTransform(store);\n  nodeTransform.decompose(nodePosition, nodeRotationQuaternion, nodeScale);\n  cameraPosition.setFromMatrixPosition(cameraWorldMatrix);\n\n  const radius = getBoundingRadius(store, manipId);\n\n  let relativeDelta = new THREE.Vector3().set(2 * x / rect.x / radius, -2 * y / rect.y / radius, 0);\n\n  if (relativeDelta.length() > 1) relativeDelta.normalize();\n  else if (relativeDelta.length() === 0) return;\n\n  let delta = relativeDelta.length();\n  relativeDelta.transformDirection(cameraWorldMatrix).multiplyScalar(delta);\n\n  const objNormal = new THREE.Vector3().subVectors(cameraPosition, nodePosition).normalize();\n\n  if (restrictToAxis) {\n    const projVector = new THREE.Vector3(0, 0, 0);\n    projVector[restrictToAxis] = 1;\n    relativeDelta.projectOnPlane(projVector);\n    objNormal.projectOnPlane(projVector);\n  }\n\n  const scaleFactor = sqrt(1 - relativeDelta.lengthSq());\n  relativeDelta.addScaledVector(objNormal, scaleFactor).normalize();\n  const modifyQuaternion = new THREE.Quaternion().setFromUnitVectors(objNormal, relativeDelta);\n  nodeRotationQuaternion.premultiply(modifyQuaternion);\n\n  nodeTransform.compose(nodePosition, nodeRotationQuaternion, nodeScale);\n  const parentMatrix = getWorldTransform(store, find(store, { id: manipId, parent: true }));\n  if (parentMatrix) {\n    parentInvMatrix.getInverse(parentMatrix, true);\n    nodeTransform.premultiply(parentInvMatrix);\n  }\n\n  nodeTransform.decompose(nodePosition, nodeRotationQuaternion, nodeScale);\n\n  // FIXME: resrictToAxis\n  // console.log('restrictToAxis: ', restrictToAxis);\n\n  nodeRotationEuler.setFromQuaternion(nodeRotationQuaternion, 'ZYX');\n  store.dispatch(set({ id: manipId, plug: 'Transform', property: 'rotation' }, nodeRotationEuler.toVector3().multiplyScalar(180 / PI)));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/nodeRotate.js","import * as THREE from 'three';\nimport { getWorldTransform } from '../../../modules/scene';\nimport { getThreeCamera } from '../../../modules/player';\n\nconst cameraPosition = new THREE.Vector3();\nconst nodePosition = new THREE.Vector3();\nconst boundingVector = new THREE.Vector3();\nconst boundingSphere = new THREE.Sphere();\n\nexport default function getBoundingRadius(store, nodeId) {\n  const camera = getThreeCamera(store);\n  const nodeTransform = getWorldTransform(store, nodeId);\n  cameraPosition.setFromMatrixPosition(camera.matrix);\n\n  const boundingRadius = store.getTranslator().getNodeBoundingBox(nodeId).getBoundingSphere(boundingSphere).radius;\n  boundingVector.subVectors(cameraPosition, nodePosition);\n  boundingVector.z = -boundingVector.length();\n  boundingVector.y = boundingRadius;\n  boundingVector.x = 0;\n\n  boundingVector.applyMatrix4(camera.projectionMatrix);\n  boundingVector.z = 0;\n  return boundingVector.length();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/utils/getBoundingRadius.js","import * as THREE from 'three';\nimport { getRect, getCameraWorldTransform } from '../../modules/player';\nimport { get, getWorldTransform, set } from '../../modules/scene';\nimport { getSelectedNodes } from '../../modules/selection';\nimport { drawScaleGizmo, highlightAxis, getViewScale } from './gizmos';\nimport getProjectedPoint from './utils/getProjectedPoint';\nimport getBoundingRadius from './utils/getBoundingRadius';\nconst { max, pow, PI, sin, min, sqrt } = Math;\n\nconst EPS = 0.000001;\n\nexport default function nodeScale(store, translator) {\n  let activeAxis = false;\n\n  return {\n    label: 'Scale Node',\n    enabled: true,\n    display: {\n      playerTools: false,\n    },\n    options: {},\n\n    tool: {\n      hover: function (ev) {\n        if (!this.active) return;\n\n        activeAxis = highlightAxis(translator, ev, activeAxis);\n      },\n\n      drag: function (ev) {\n        if (ev.which !== 1 || !this.active || ev.metaKey) return false;\n\n        return {\n          momentum: !activeAxis,\n          handle: function (ev) {\n            scaleNode(store, ev, activeAxis);\n          },\n        };\n      },\n    },\n\n    widget: {\n      draw: function (manipulatorsObject) {\n        manipulatorsObject.add(drawScaleGizmo());\n        const scale = getViewScale(store);\n        manipulatorsObject.scale.set(scale, scale, scale);\n      },\n\n      position: function (manipulatorsObject) {\n        const selectedNodes = getSelectedNodes(store);\n        if (!selectedNodes.length) {\n          manipulatorsObject.visible = false;\n          return;\n        }\n\n        manipulatorsObject.visible = true;\n        const manipId = selectedNodes[0];\n        const worldTransform = getWorldTransform(store, manipId);\n        const position = new THREE.Vector3();\n        position.setFromMatrixPosition(worldTransform);\n        manipulatorsObject.position.set(position.x, position.y, position.z);\n\n        const scale = getViewScale(store);\n        manipulatorsObject.scale.set(scale, scale, scale);\n      },\n    },\n  };\n}\n\nfunction scaleNode(store, ev, restrictToAxis) {\n  const rect = getRect(store);\n  const selectedNodes = getSelectedNodes(store);\n  if (!selectedNodes.length) return;\n  const id = selectedNodes[0];\n\n  const nodeGraphScale = get(store, { id, plug: 'Transform', property: 'scale' });\n  if (!nodeGraphScale) return;\n  const radius = max(getBoundingRadius(store, id), EPS) || EPS;\n\n  const delta = ev.delta || (ev.deltaX / 30) - (ev.deltaY / 30);\n  const deltaZoom = max(min(2 * delta / rect.y / radius, 0.001), -0.001);\n  const decayZoomFactor = pow(2, deltaZoom * 100);\n\n  const nodeMatrix = getWorldTransform(store, id);\n  const nodePosition = new THREE.Vector3().setFromMatrixPosition(nodeMatrix);\n  const nodeScale = new THREE.Vector3().copy(nodeGraphScale);\n  const cameraWorldMatrix = getCameraWorldTransform(store);\n\n  if (!restrictToAxis) {\n    const oldScale = max(nodeScale.length(), EPS);\n    nodeScale.setLength(oldScale * decayZoomFactor);\n  } else {\n    const projVector = new THREE.Vector3(0, 0, 0);\n    projVector[restrictToAxis] = 1;\n    const projectedMouse = getProjectedPoint(store, id, ev.deltaX, ev.deltaY);\n    projectedMouse.projectOnVector(projVector);\n\n    const targToCam = new THREE.Vector3().setFromMatrixPosition(cameraWorldMatrix).sub(nodePosition);\n    const origin = new THREE.Vector3(0, 0, 0);\n    const plane = new THREE.Plane().setFromCoplanarPoints(targToCam, projVector, origin);\n    projectedMouse.projectOnPlane(plane.normal);\n\n    const camToMove = new THREE.Vector3().subVectors(projectedMouse, targToCam);\n    projectedMouse.projectOnVector(projVector).normalize();\n    const alpha = targToCam.angleTo(projectedMouse);\n    const beta = PI - targToCam.angleTo(camToMove);\n    const gamma = PI - alpha - beta;\n    const axis = targToCam.length() * sin(beta) / sin(gamma);\n    projectedMouse.multiplyScalar(axis);\n\n    projVector.set(1, 1, 1);\n\n    projVector[restrictToAxis] = 1 + 2 * projectedMouse[restrictToAxis] / nodeScale[restrictToAxis];\n    nodeScale.multiply(projVector);\n  }\n\n  // FIXME: restrict axis\n  //console.log('scaleToAxis', restrictToAxis);\n  store.dispatch(set({ id, plug: 'Transform', property: 'scale' }, nodeScale));\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/nodeScale.js","import { filterNodesFromPosition } from '../../modules/player';\nimport { selectNode } from '../../modules/selection';\n\nexport default function select(store, translator) {\n  return {\n    label: 'Select',\n    enabled: true,\n    display: {\n      playerTools: false,\n    },\n    options: {},\n\n    tool: {\n      click: function (ev) {\n        const nodes = filterNodesFromPosition(store, ev);\n        if (nodes.length) store.dispatch(selectNode(nodes[0]));\n      },\n\n      drag: function (ev) {\n        if (ev.which !== 1 || !this.active) return false;\n\n        return {\n          momentum: false,\n\n          handle: function (ev) {\n            //console.log('drag select', ev.deltaX, ev.deltaY);\n          },\n        };\n      },\n    },\n  };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/select.js","import { isFullscreen, setFullscreen } from '../../modules/player';\n\nexport default function fullscreen(store, translator) {\n  return {\n    enabled: true,\n    display: true,\n    options: {},\n\n    isActive: isFullscreen,\n\n    activate: () => {\n      const playerEl = store.getIn(['player', 'playerElement']);\n      ['requestFullscreen', 'webkitRequestFullscreen', 'mozRequestFullScreen', 'msRequestFullscreen'].forEach(function (fn) {\n        if (playerEl[fn]) return playerEl[fn]();\n      });\n\n      store.dispatch(setFullscreen(true));\n    },\n\n    deactivate: () => {\n      ['exitFullscreen', 'webkitExitFullscreen', 'mozCancelFullScreen', 'msExitFullscreen'].forEach(function (fn) {\n        if (document[fn]) return document[fn]();\n      });\n\n      store.dispatch(setFullscreen(false));\n    },\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/fullscreen.js","import { get } from '../../modules/scene';\nimport { initCamera } from '../camera';\n\nexport default function home(store, translator) {\n  return {\n    label: 'Home',\n    enabled: true,\n    display: {\n      playerTools: true,\n    },\n    options: {},\n\n    execute: () => {\n      const playerData = get(store, { scene: true, evalPlug: 'Player' });\n      initCamera(store, true, playerData && playerData.camera);\n    },\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/home.js","import * as THREE from 'three';\nimport 'webvr-polyfill';\nimport '../utils/vrEffect'; // Extend three with VREffect\nimport '../utils/viveController';\nimport '../utils/objLoader';\nimport '../utils/reticle';\n\nimport { disableDeviceTracking, enableDeviceTracking,\n  getCamera, getPrevCamera, isVRMode, RENDER_MODES,\n  setRenderMode, useCamera, useVrCamera, } from '../../modules/player';\nimport { MOUSE_CONTROLS, updateCommands, updateCommand, activateCommand, deactivateCommand, setCommandOptions, getCommands } from '../../modules/commands';\nimport decompose from '../utils/decompose';\nimport VRControls from '../utils/vrControls'; // extend three with VRControls\nimport getTargetWorldMatrix from '../utils/getTargetWorldMatrix';\nimport { merge, vrCameraId, get, virtualTargetId } from '../../modules/sceneGraph';\nimport { get as sceneGet, set as sceneSet } from '../../modules/scene';\n\nexport default function (store, translator) {\n  let vrEffect, vrDisplay, vrReticle, vrFloor, vrControls, hasExternalDisplay,\n    controller1, controller2, viveHandler, mobileNavHandler, threeVrCamera, prevMoveMode;\n\n  const scene = translator.scene;\n  const camera = translator.camera;\n\n  let vrCapable = false;\n  if (__BROWSER__) {\n    window.navigator.getVRDisplays().then((displays)=> {\n      if (!displays.length) return;\n      vrCapable = displays[0].capabilities.canPresent;\n      store.dispatch(updateCommand('vrMode', { enabled: vrCapable }));\n    });\n  }\n\n  function viveNavHandle(manipulatorsObject) {\n    return (ev) => {\n      console.log('viveNavHandle', !!vrReticle.armObject);\n      if (!vrReticle.armObject) return;\n\n      var pos = vrReticle.getReticlePosition().clone();\n      pos.y = 0;\n      var vrdpPos = threeVrCamera.position.clone();\n      var offset = pos.addScaledVector(vrControls.offset, 2).sub(vrdpPos);\n      offset.y = 0;\n      vrControls.setOffset(offset);\n    };\n  }\n\n  function navHandle(manipulatorsObject) {\n    return (ev) => {\n      if (!vrReticle.armObject) return;\n\n      const cameraId = getCamera(store);\n      var pos = vrReticle.getReticlePosition().clone();\n      pos.y = 0;\n      manipulatorsObject.position.add(pos);\n      manipulatorsObject.updateMatrix();\n\n      const newCameraPosition = new THREE.Matrix4().setPosition(manipulatorsObject.position);\n      newCameraPosition.elements[13] = 1.6;\n      store.dispatch(merge([cameraId, 'Transform', 0], decompose(newCameraPosition)));\n    };\n  }\n\n  return {\n    label: 'VR mode',\n    activeLabel: 'Exit VR Mode',\n\n    enabled: vrCapable,\n    display: {\n      playerTools: true,\n    },\n    options: {\n      planeEnabled: true,\n    },\n\n    isActive: isVRMode,\n\n    widget: {\n      draw: function (manipulatorsObject) {\n        const cbgeometry = new THREE.PlaneGeometry(20, 20, 1, 1);\n        const mat = new THREE.MeshBasicMaterial({ color: 0x666666 });\n        mat.transparent = !this.options.planeEnabled;\n        mat.opacity = this.options.planeEnabled ? 1.0 : 0.0;\n        vrFloor = new THREE.Mesh(cbgeometry, mat);\n        vrFloor.rotation.x = -Math.PI * 0.5;\n\n        vrReticle = new THREE.Reticle(camera);\n        vrReticle.addCollider(vrFloor);\n\n        manipulatorsObject.add(vrReticle.armObject);\n        manipulatorsObject.add(vrReticle.dot);\n        manipulatorsObject.add(vrFloor);\n\n        // This floor grid is __UGLY__!\n        // manipulatorsObject.add(floorGrid());\n\n        if (!hasExternalDisplay) {\n          //scene.add(camera);\n          mobileNavHandler = navHandle(manipulatorsObject);\n          window.addEventListener('touchend', mobileNavHandler);\n        } else {\n          //------Add vive controllers-----------\n          controller1 = new THREE.ViveController(0);\n          controller1.standingMatrix = vrControls.getStandingMatrix();\n\n          manipulatorsObject.add(controller1);\n\n          controller2 = new THREE.ViveController(1);\n          controller2.standingMatrix = vrControls.getStandingMatrix();\n\n          manipulatorsObject.add(controller2);\n\n          var loader = new THREE.OBJLoader();\n          loader.setPath('models/');\n          loader.load('vr_controller_vive_1_5.obj', (object) => {\n            var loader = new THREE.TextureLoader();\n            loader.setPath('models/');\n\n            var controller = object.children[0];\n            var material = new THREE.MeshBasicMaterial();\n            material.map = loader.load('onepointfive_texture.png');\n            material.specularMap = loader.load('onepointfive_spec.png');\n            controller.material = material;\n\n            controller1.add(object.clone());\n            controller2.add(object.clone());\n          });\n          viveHandler = viveNavHandle(manipulatorsObject);\n          window.addEventListener('thumbpadup', viveHandler);\n        }\n      },\n\n      remove: function (manipulatorsObject) {\n        if (!hasExternalDisplay) {\n          scene.remove(camera);\n          window.removeEventListener('touchend', mobileNavHandler);\n        } else {\n          window.removeEventListener('thumbpadup', viveHandler);\n        }\n      },\n\n      position: function (manipulatorsObject) {\n        if (vrControls) {\n          vrControls.update();\n          manipulatorsObject.position.copy(vrControls.offset);\n        }\n\n        if (threeVrCamera) {\n          threeVrCamera.updateMatrix();\n          matchToCamera(store, threeVrCamera);\n        }\n\n        vrReticle.update(manipulatorsObject);\n        if (hasExternalDisplay && controller1 && controller2) {\n          controller1.update();\n          controller2.update();\n        }\n\n        manipulatorsObject.updateMatrix();\n      },\n    },\n\n    activate: () => {\n      const translator = store.getTranslator();\n      return window.navigator.getVRDisplays().then(function (displays) {\n        if (displays.length <= 0) throw new Error('No VR Displays');\n\n        if (displays.length > 0) {\n          vrDisplay = displays[0];\n          vrEffect = new THREE.VREffect(translator.renderer, vrDisplay);\n          translator.externals.vrEffect = vrEffect;\n\n          hasExternalDisplay = vrDisplay.capabilities.hasExternalDisplay;\n          if (!vrDisplay.capabilities.canPresent) return;\n\n          store.dispatch(useVrCamera(true));\n          // If we have external display, then use vive controls?\n          return vrEffect.requestPresent().then(() => {\n            store.dispatch(activateCommand('firstPersonMode'));\n            prevMoveMode = getCommands(store).firstPersonMode.options.movementMode;\n            store.dispatch(setCommandOptions('firstPersonMode', { movementMode: 'plane' }));\n\n            threeVrCamera = translator.camera.clone();\n            vrControls = new VRControls(threeVrCamera);\n            translator.externals.vrControls = vrControls;\n            if (hasExternalDisplay) vrControls.standing = true;\n            vrControls.resetPose(); // zero orientation controls\n\n            store.dispatch(setRenderMode(RENDER_MODES.vr));\n            store.dispatch(updateCommands(MOUSE_CONTROLS, { enabled: false }));\n\n            store.setRequestAnimationFrame(vrDisplay.requestAnimationFrame, vrDisplay);\n\n            return vrDisplay;\n\n          }).catch((err) => {\n            console.log('Error Activating VR');\n            throw err;\n          });\n        }\n      });\n    },\n\n    deactivate: () => {\n      const translator = store.getTranslator();\n\n      vrEffect.exitPresent();\n      store.setRequestAnimationFrame();\n\n      store.dispatch(deactivateCommand('firstPersonMode'));\n      store.dispatch(setCommandOptions('firstPersonMode', { movementMode: prevMoveMode }));\n\n      store.dispatch(setRenderMode(RENDER_MODES.normal));\n      store.dispatch(updateCommands(MOUSE_CONTROLS, { enabled: true }));\n      store.dispatch(useVrCamera(false));\n\n      vrDisplay = null;\n\n      /*const prevCameraId = getPrevCamera(store);\n      if (prevCameraId) store.dispatch(useCamera(prevCameraId));*/\n\n      if (!hasExternalDisplay) {\n        //scene.remove(camera);\n        window.removeEventListener('touchend', navHandle);\n      } else {\n        controller1 = null;\n        controller2 = null;\n        //scene.position.set(0, 0, 0);\n        //vrElements.position.set(0, 0, 0);\n        window.removeEventListener('thumbpadup', viveHandler);\n      }\n\n      vrControls.standing = false;\n      vrReticle.removeCollider(vrFloor);\n      translator.renderer.setScissorTest(false);\n      //vrElements.children = [];\n      //scene.remove(vrElements);\n    },\n  };\n}\n\nfunction floorGrid() {\n  // Materials\n  var mat = new THREE.LineBasicMaterial({ color: 0xffffff, linewidth: 10 });\n\n  let lineGeometry = new THREE.BufferGeometry();\n  let positions = new Float32Array(80 * 2 * 3);\n\n  for (let x = -10, i = 0; x < 10; x += 0.5, i++) {\n    positions[i * 6 + 0] = x;\n    positions[i * 6 + 1] = 0;\n    positions[i * 6 + 2] = -10;\n    positions[i * 6 + 3 + 0] = x;\n    positions[i * 6 + 3 + 1] = 0;\n    positions[i * 6 + 3 + 2] = 10;\n  }\n\n  for (let z = -10, i = 40; z < 10; z += 0.5, i++) {\n    positions[i * 6 + 0] = -10;\n    positions[i * 6 + 1] = 0;\n    positions[i * 6 + 2] = z;\n    positions[i * 6 + 3 + 0] = 10;\n    positions[i * 6 + 3 + 1] = 0;\n    positions[i * 6 + 3 + 2] = z;\n  }\n\n  lineGeometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));\n\n  let mesh = new THREE.LineSegments(lineGeometry, mat);\n  mesh.mode = THREE.LineSegments;\n\n  return mesh;\n}\n\nfunction matchToCamera(store, threeCamera) {\n  const cameraId = getCamera(store);\n  const targetWorldMatrix = getTargetWorldMatrix(store);\n  const targetPosition = new THREE.Vector3().setFromMatrixPosition(targetWorldMatrix);\n\n  const length = targetPosition.sub(threeCamera.position).length();\n  targetPosition.set(0, 0, -length).applyQuaternion(threeCamera.quaternion).add(threeCamera.position);\n  const upPosition = new THREE.Vector3(0, 1, 0).applyQuaternion(threeCamera.quaternion);\n\n  targetWorldMatrix.setPosition(targetPosition);\n  const camData = sceneGet(store, { id: cameraId, evalPlug: 'Camera' });\n  camData.upPosition = upPosition;\n  store.dispatch(merge([cameraId, 'Transform', 0], decompose(threeCamera.matrix.clone())));\n  if (!sceneGet(store, { id: cameraId, evalPlug: 'Transform' }).target) {\n    store.dispatch(merge([virtualTargetId, 'Transform', 0], decompose(targetWorldMatrix)));\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/vrMode.js","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n'use strict';\n/* eslint-disable no-unused-vars */\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (e) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (Object.getOwnPropertySymbols) {\n\t\t\tsymbols = Object.getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],2:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar Util = _dereq_('./util.js');\nvar WakeLock = _dereq_('./wakelock.js');\n\n// Start at a higher number to reduce chance of conflict.\nvar nextDisplayId = 1000;\nvar hasShowDeprecationWarning = false;\n\nvar defaultLeftBounds = [0, 0, 0.5, 1];\nvar defaultRightBounds = [0.5, 0, 0.5, 1];\n\n/**\n * The base class for all VR frame data.\n */\n\nfunction VRFrameData() {\n  this.leftProjectionMatrix = new Float32Array(16);\n  this.leftViewMatrix = new Float32Array(16);\n  this.rightProjectionMatrix = new Float32Array(16);\n  this.rightViewMatrix = new Float32Array(16);\n  this.pose = null;\n};\n\n/**\n * The base class for all VR displays.\n */\nfunction VRDisplay() {\n  this.isPolyfilled = true;\n  this.displayId = nextDisplayId++;\n  this.displayName = 'webvr-polyfill displayName';\n\n  this.depthNear = 0.01;\n  this.depthFar = 10000.0;\n\n  this.isConnected = true;\n  this.isPresenting = false;\n  this.capabilities = {\n    hasPosition: false,\n    hasOrientation: false,\n    hasExternalDisplay: false,\n    canPresent: false,\n    maxLayers: 1\n  };\n  this.stageParameters = null;\n\n  // \"Private\" members.\n  this.waitingForPresent_ = false;\n  this.layer_ = null;\n\n  this.fullscreenElement_ = null;\n  this.fullscreenWrapper_ = null;\n  this.fullscreenElementCachedStyle_ = null;\n\n  this.fullscreenEventTarget_ = null;\n  this.fullscreenChangeHandler_ = null;\n  this.fullscreenErrorHandler_ = null;\n\n  this.wakelock_ = new WakeLock();\n}\n\nVRDisplay.prototype.getFrameData = function(frameData) {\n  // TODO: Technically this should retain it's value for the duration of a frame\n  // but I doubt that's practical to do in javascript.\n  return Util.frameDataFromPose(frameData, this.getPose(), this);\n};\n\nVRDisplay.prototype.getPose = function() {\n  // TODO: Technically this should retain it's value for the duration of a frame\n  // but I doubt that's practical to do in javascript.\n  return this.getImmediatePose();\n};\n\nVRDisplay.prototype.requestAnimationFrame = function(callback) {\n  return window.requestAnimationFrame(callback);\n};\n\nVRDisplay.prototype.cancelAnimationFrame = function(id) {\n  return window.cancelAnimationFrame(id);\n};\n\nVRDisplay.prototype.wrapForFullscreen = function(element) {\n  // Don't wrap in iOS.\n  if (Util.isIOS()) {\n    return element;\n  }\n  if (!this.fullscreenWrapper_) {\n    this.fullscreenWrapper_ = document.createElement('div');\n    var cssProperties = [\n      'height: ' + Math.min(screen.height, screen.width) + 'px !important',\n      'top: 0 !important',\n      'left: 0 !important',\n      'right: 0 !important',\n      'border: 0',\n      'margin: 0',\n      'padding: 0',\n      'z-index: 999999 !important',\n      'position: fixed',\n    ];\n    this.fullscreenWrapper_.setAttribute('style', cssProperties.join('; ') + ';');\n    this.fullscreenWrapper_.classList.add('webvr-polyfill-fullscreen-wrapper');\n  }\n\n  if (this.fullscreenElement_ == element) {\n    return this.fullscreenWrapper_;\n  }\n\n  // Remove any previously applied wrappers\n  this.removeFullscreenWrapper();\n\n  this.fullscreenElement_ = element;\n  var parent = this.fullscreenElement_.parentElement;\n  parent.insertBefore(this.fullscreenWrapper_, this.fullscreenElement_);\n  parent.removeChild(this.fullscreenElement_);\n  this.fullscreenWrapper_.insertBefore(this.fullscreenElement_, this.fullscreenWrapper_.firstChild);\n  this.fullscreenElementCachedStyle_ = this.fullscreenElement_.getAttribute('style');\n\n  var self = this;\n  function applyFullscreenElementStyle() {\n    if (!self.fullscreenElement_) {\n      return;\n    }\n\n    var cssProperties = [\n      'position: absolute',\n      'top: 0',\n      'left: 0',\n      'width: ' + Math.max(screen.width, screen.height) + 'px',\n      'height: ' + Math.min(screen.height, screen.width) + 'px',\n      'border: 0',\n      'margin: 0',\n      'padding: 0',\n    ];\n    self.fullscreenElement_.setAttribute('style', cssProperties.join('; ') + ';');\n  }\n\n  applyFullscreenElementStyle();\n\n  return this.fullscreenWrapper_;\n};\n\nVRDisplay.prototype.removeFullscreenWrapper = function() {\n  if (!this.fullscreenElement_) {\n    return;\n  }\n\n  var element = this.fullscreenElement_;\n  if (this.fullscreenElementCachedStyle_) {\n    element.setAttribute('style', this.fullscreenElementCachedStyle_);\n  } else {\n    element.removeAttribute('style');\n  }\n  this.fullscreenElement_ = null;\n  this.fullscreenElementCachedStyle_ = null;\n\n  var parent = this.fullscreenWrapper_.parentElement;\n  this.fullscreenWrapper_.removeChild(element);\n  parent.insertBefore(element, this.fullscreenWrapper_);\n  parent.removeChild(this.fullscreenWrapper_);\n\n  return element;\n};\n\nVRDisplay.prototype.requestPresent = function(layers) {\n  var wasPresenting = this.isPresenting;\n  var self = this;\n\n  if (!(layers instanceof Array)) {\n    if (!hasShowDeprecationWarning) {\n      console.warn(\"Using a deprecated form of requestPresent. Should pass in an array of VRLayers.\");\n      hasShowDeprecationWarning = true;\n    }\n    layers = [layers];\n  }\n\n  return new Promise(function(resolve, reject) {\n    if (!self.capabilities.canPresent) {\n      reject(new Error('VRDisplay is not capable of presenting.'));\n      return;\n    }\n\n    if (layers.length == 0 || layers.length > self.capabilities.maxLayers) {\n      reject(new Error('Invalid number of layers.'));\n      return;\n    }\n\n    var incomingLayer = layers[0];\n    if (!incomingLayer.source) {\n      /*\n      todo: figure out the correct behavior if the source is not provided.\n      see https://github.com/w3c/webvr/issues/58\n      */\n      resolve();\n      return;\n    }\n\n    var leftBounds = incomingLayer.leftBounds || defaultLeftBounds;\n    var rightBounds = incomingLayer.rightBounds || defaultRightBounds;\n    if (wasPresenting) {\n      // Already presenting, just changing configuration\n      var layer = self.layer_;\n      if (layer.source !== incomingLayer.source) {\n        layer.source = incomingLayer.source;\n      }\n\n      for (var i = 0; i < 4; i++) {\n        if (layer.leftBounds[i] !== leftBounds[i]) {\n          layer.leftBounds[i] = leftBounds[i];\n        }\n        if (layer.rightBounds[i] !== rightBounds[i]) {\n          layer.rightBounds[i] = rightBounds[i];\n        }\n      }\n\n      resolve();\n      return;\n    }\n\n    // Was not already presenting.\n    self.layer_ = {\n      predistorted: incomingLayer.predistorted,\n      source: incomingLayer.source,\n      leftBounds: leftBounds.slice(0),\n      rightBounds: rightBounds.slice(0)\n    };\n\n    self.waitingForPresent_ = false;\n    if (self.layer_ && self.layer_.source) {\n      var fullscreenElement = self.wrapForFullscreen(self.layer_.source);\n\n      function onFullscreenChange() {\n        var actualFullscreenElement = Util.getFullscreenElement();\n\n        self.isPresenting = (fullscreenElement === actualFullscreenElement);\n        if (self.isPresenting) {\n          if (screen.orientation && screen.orientation.lock) {\n            screen.orientation.lock('landscape-primary').catch(function(error){\n                    console.error('screen.orientation.lock() failed due to', error.message)\n            });\n          }\n          self.waitingForPresent_ = false;\n          self.beginPresent_();\n          resolve();\n        } else {\n          if (screen.orientation && screen.orientation.unlock) {\n            screen.orientation.unlock();\n          }\n          self.removeFullscreenWrapper();\n          self.wakelock_.release();\n          self.endPresent_();\n          self.removeFullscreenListeners_();\n        }\n        self.fireVRDisplayPresentChange_();\n      }\n      function onFullscreenError() {\n        if (!self.waitingForPresent_) {\n          return;\n        }\n\n        self.removeFullscreenWrapper();\n        self.removeFullscreenListeners_();\n\n        self.wakelock_.release();\n        self.waitingForPresent_ = false;\n        self.isPresenting = false;\n\n        reject(new Error('Unable to present.'));\n      }\n\n      self.addFullscreenListeners_(fullscreenElement,\n          onFullscreenChange, onFullscreenError);\n\n      if (Util.requestFullscreen(fullscreenElement)) {\n        self.wakelock_.request();\n        self.waitingForPresent_ = true;\n      } else if (Util.isIOS()) {\n        // *sigh* Just fake it.\n        self.wakelock_.request();\n        self.isPresenting = true;\n        self.beginPresent_();\n        self.fireVRDisplayPresentChange_();\n        resolve();\n      }\n    }\n\n    if (!self.waitingForPresent_ && !Util.isIOS()) {\n      Util.exitFullscreen();\n      reject(new Error('Unable to present.'));\n    }\n  });\n};\n\nVRDisplay.prototype.exitPresent = function() {\n  var wasPresenting = this.isPresenting;\n  var self = this;\n  this.isPresenting = false;\n  this.layer_ = null;\n  this.wakelock_.release();\n\n  return new Promise(function(resolve, reject) {\n    if (wasPresenting) {\n      if (!Util.exitFullscreen() && Util.isIOS()) {\n        self.endPresent_();\n        self.fireVRDisplayPresentChange_();\n      }\n\n      resolve();\n    } else {\n      reject(new Error('Was not presenting to VRDisplay.'));\n    }\n  });\n};\n\nVRDisplay.prototype.getLayers = function() {\n  if (this.layer_) {\n    return [this.layer_];\n  }\n  return [];\n};\n\nVRDisplay.prototype.fireVRDisplayPresentChange_ = function() {\n  var event = new CustomEvent('vrdisplaypresentchange', {detail: {display: this}});\n  window.dispatchEvent(event);\n};\n\nVRDisplay.prototype.addFullscreenListeners_ = function(element, changeHandler, errorHandler) {\n  this.removeFullscreenListeners_();\n\n  this.fullscreenEventTarget_ = element;\n  this.fullscreenChangeHandler_ = changeHandler;\n  this.fullscreenErrorHandler_ = errorHandler;\n\n  if (changeHandler) {\n    if (document.fullscreenEnabled) {\n      element.addEventListener('fullscreenchange', changeHandler, false);\n    } else if (document.webkitFullscreenEnabled) {\n      element.addEventListener('webkitfullscreenchange', changeHandler, false);\n    } else if (document.mozFullScreenEnabled) {\n      document.addEventListener('mozfullscreenchange', changeHandler, false);\n    } else if (document.msFullscreenEnabled) {\n      element.addEventListener('msfullscreenchange', changeHandler, false);\n    }\n  }\n\n  if (errorHandler) {\n    if (document.fullscreenEnabled) {\n      element.addEventListener('fullscreenerror', errorHandler, false);\n    } else if (document.webkitFullscreenEnabled) {\n      element.addEventListener('webkitfullscreenerror', errorHandler, false);\n    } else if (document.mozFullScreenEnabled) {\n      document.addEventListener('mozfullscreenerror', errorHandler, false);\n    } else if (document.msFullscreenEnabled) {\n      element.addEventListener('msfullscreenerror', errorHandler, false);\n    }\n  }\n};\n\nVRDisplay.prototype.removeFullscreenListeners_ = function() {\n  if (!this.fullscreenEventTarget_)\n    return;\n\n  var element = this.fullscreenEventTarget_;\n\n  if (this.fullscreenChangeHandler_) {\n    var changeHandler = this.fullscreenChangeHandler_;\n    element.removeEventListener('fullscreenchange', changeHandler, false);\n    element.removeEventListener('webkitfullscreenchange', changeHandler, false);\n    document.removeEventListener('mozfullscreenchange', changeHandler, false);\n    element.removeEventListener('msfullscreenchange', changeHandler, false);\n  }\n\n  if (this.fullscreenErrorHandler_) {\n    var errorHandler = this.fullscreenErrorHandler_;\n    element.removeEventListener('fullscreenerror', errorHandler, false);\n    element.removeEventListener('webkitfullscreenerror', errorHandler, false);\n    document.removeEventListener('mozfullscreenerror', errorHandler, false);\n    element.removeEventListener('msfullscreenerror', errorHandler, false);\n  }\n\n  this.fullscreenEventTarget_ = null;\n  this.fullscreenChangeHandler_ = null;\n  this.fullscreenErrorHandler_ = null;\n};\n\nVRDisplay.prototype.beginPresent_ = function() {\n  // Override to add custom behavior when presentation begins.\n};\n\nVRDisplay.prototype.endPresent_ = function() {\n  // Override to add custom behavior when presentation ends.\n};\n\nVRDisplay.prototype.submitFrame = function(pose) {\n  // Override to add custom behavior for frame submission.\n};\n\nVRDisplay.prototype.getEyeParameters = function(whichEye) {\n  // Override to return accurate eye parameters if canPresent is true.\n  return null;\n};\n\n/*\n * Deprecated classes\n */\n\n/**\n * The base class for all VR devices. (Deprecated)\n */\nfunction VRDevice() {\n  this.isPolyfilled = true;\n  this.hardwareUnitId = 'webvr-polyfill hardwareUnitId';\n  this.deviceId = 'webvr-polyfill deviceId';\n  this.deviceName = 'webvr-polyfill deviceName';\n}\n\n/**\n * The base class for all VR HMD devices. (Deprecated)\n */\nfunction HMDVRDevice() {\n}\nHMDVRDevice.prototype = new VRDevice();\n\n/**\n * The base class for all VR position sensor devices. (Deprecated)\n */\nfunction PositionSensorVRDevice() {\n}\nPositionSensorVRDevice.prototype = new VRDevice();\n\nmodule.exports.VRFrameData = VRFrameData;\nmodule.exports.VRDisplay = VRDisplay;\nmodule.exports.VRDevice = VRDevice;\nmodule.exports.HMDVRDevice = HMDVRDevice;\nmodule.exports.PositionSensorVRDevice = PositionSensorVRDevice;\n\n},{\"./util.js\":22,\"./wakelock.js\":24}],3:[function(_dereq_,module,exports){\n/*\n * Copyright 2016 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar CardboardUI = _dereq_('./cardboard-ui.js');\nvar Util = _dereq_('./util.js');\nvar WGLUPreserveGLState = _dereq_('./deps/wglu-preserve-state.js');\n\nvar distortionVS = [\n  'attribute vec2 position;',\n  'attribute vec3 texCoord;',\n\n  'varying vec2 vTexCoord;',\n\n  'uniform vec4 viewportOffsetScale[2];',\n\n  'void main() {',\n  '  vec4 viewport = viewportOffsetScale[int(texCoord.z)];',\n  '  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;',\n  '  gl_Position = vec4( position, 1.0, 1.0 );',\n  '}',\n].join('\\n');\n\nvar distortionFS = [\n  'precision mediump float;',\n  'uniform sampler2D diffuse;',\n\n  'varying vec2 vTexCoord;',\n\n  'void main() {',\n  '  gl_FragColor = texture2D(diffuse, vTexCoord);',\n  '}',\n].join('\\n');\n\n/**\n * A mesh-based distorter.\n */\nfunction CardboardDistorter(gl) {\n  this.gl = gl;\n  this.ctxAttribs = gl.getContextAttributes();\n\n  this.meshWidth = 20;\n  this.meshHeight = 20;\n\n  this.bufferScale = WebVRConfig.BUFFER_SCALE;\n\n  this.bufferWidth = gl.drawingBufferWidth;\n  this.bufferHeight = gl.drawingBufferHeight;\n\n  // Patching support\n  this.realBindFramebuffer = gl.bindFramebuffer;\n  this.realEnable = gl.enable;\n  this.realDisable = gl.disable;\n  this.realColorMask = gl.colorMask;\n  this.realClearColor = gl.clearColor;\n  this.realViewport = gl.viewport;\n\n  if (!Util.isIOS()) {\n    this.realCanvasWidth = Object.getOwnPropertyDescriptor(gl.canvas.__proto__, 'width');\n    this.realCanvasHeight = Object.getOwnPropertyDescriptor(gl.canvas.__proto__, 'height');\n  }\n\n  this.isPatched = false;\n\n  // State tracking\n  this.lastBoundFramebuffer = null;\n  this.cullFace = false;\n  this.depthTest = false;\n  this.blend = false;\n  this.scissorTest = false;\n  this.stencilTest = false;\n  this.viewport = [0, 0, 0, 0];\n  this.colorMask = [true, true, true, true];\n  this.clearColor = [0, 0, 0, 0];\n\n  this.attribs = {\n    position: 0,\n    texCoord: 1\n  };\n  this.program = Util.linkProgram(gl, distortionVS, distortionFS, this.attribs);\n  this.uniforms = Util.getProgramUniforms(gl, this.program);\n\n  this.viewportOffsetScale = new Float32Array(8);\n  this.setTextureBounds();\n\n  this.vertexBuffer = gl.createBuffer();\n  this.indexBuffer = gl.createBuffer();\n  this.indexCount = 0;\n\n  this.renderTarget = gl.createTexture();\n  this.framebuffer = gl.createFramebuffer();\n\n  this.depthStencilBuffer = null;\n  this.depthBuffer = null;\n  this.stencilBuffer = null;\n\n  if (this.ctxAttribs.depth && this.ctxAttribs.stencil) {\n    this.depthStencilBuffer = gl.createRenderbuffer();\n  } else if (this.ctxAttribs.depth) {\n    this.depthBuffer = gl.createRenderbuffer();\n  } else if (this.ctxAttribs.stencil) {\n    this.stencilBuffer = gl.createRenderbuffer();\n  }\n\n  this.patch();\n\n  this.onResize();\n\n  if (!WebVRConfig.CARDBOARD_UI_DISABLED) {\n    this.cardboardUI = new CardboardUI(gl);\n  }\n};\n\n/**\n * Tears down all the resources created by the distorter and removes any\n * patches.\n */\nCardboardDistorter.prototype.destroy = function() {\n  var gl = this.gl;\n\n  this.unpatch();\n\n  gl.deleteProgram(this.program);\n  gl.deleteBuffer(this.vertexBuffer);\n  gl.deleteBuffer(this.indexBuffer);\n  gl.deleteTexture(this.renderTarget);\n  gl.deleteFramebuffer(this.framebuffer);\n  if (this.depthStencilBuffer) {\n    gl.deleteRenderbuffer(this.depthStencilBuffer);\n  }\n  if (this.depthBuffer) {\n    gl.deleteRenderbuffer(this.depthBuffer);\n  }\n  if (this.stencilBuffer) {\n    gl.deleteRenderbuffer(this.stencilBuffer);\n  }\n\n  if (this.cardboardUI) {\n    this.cardboardUI.destroy();\n  }\n};\n\n\n/**\n * Resizes the backbuffer to match the canvas width and height.\n */\nCardboardDistorter.prototype.onResize = function() {\n  var gl = this.gl;\n  var self = this;\n\n  var glState = [\n    gl.RENDERBUFFER_BINDING,\n    gl.TEXTURE_BINDING_2D, gl.TEXTURE0\n  ];\n\n  WGLUPreserveGLState(gl, glState, function(gl) {\n    // Bind real backbuffer and clear it once. We don't need to clear it again\n    // after that because we're overwriting the same area every frame.\n    self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, null);\n\n    // Put things in a good state\n    if (self.scissorTest) { self.realDisable.call(gl, gl.SCISSOR_TEST); }\n    self.realColorMask.call(gl, true, true, true, true);\n    self.realViewport.call(gl, 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    self.realClearColor.call(gl, 0, 0, 0, 1);\n\n    gl.clear(gl.COLOR_BUFFER_BIT);\n\n    // Now bind and resize the fake backbuffer\n    self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, self.framebuffer);\n\n    gl.bindTexture(gl.TEXTURE_2D, self.renderTarget);\n    gl.texImage2D(gl.TEXTURE_2D, 0, self.ctxAttribs.alpha ? gl.RGBA : gl.RGB,\n        self.bufferWidth, self.bufferHeight, 0,\n        self.ctxAttribs.alpha ? gl.RGBA : gl.RGB, gl.UNSIGNED_BYTE, null);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, self.renderTarget, 0);\n\n    if (self.ctxAttribs.depth && self.ctxAttribs.stencil) {\n      gl.bindRenderbuffer(gl.RENDERBUFFER, self.depthStencilBuffer);\n      gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL,\n          self.bufferWidth, self.bufferHeight);\n      gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT,\n          gl.RENDERBUFFER, self.depthStencilBuffer);\n    } else if (self.ctxAttribs.depth) {\n      gl.bindRenderbuffer(gl.RENDERBUFFER, self.depthBuffer);\n      gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16,\n          self.bufferWidth, self.bufferHeight);\n      gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT,\n          gl.RENDERBUFFER, self.depthBuffer);\n    } else if (self.ctxAttribs.stencil) {\n      gl.bindRenderbuffer(gl.RENDERBUFFER, self.stencilBuffer);\n      gl.renderbufferStorage(gl.RENDERBUFFER, gl.STENCIL_INDEX8,\n          self.bufferWidth, self.bufferHeight);\n      gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.STENCIL_ATTACHMENT,\n          gl.RENDERBUFFER, self.stencilBuffer);\n    }\n\n    if (!gl.checkFramebufferStatus(gl.FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE) {\n      console.error('Framebuffer incomplete!');\n    }\n\n    self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, self.lastBoundFramebuffer);\n\n    if (self.scissorTest) { self.realEnable.call(gl, gl.SCISSOR_TEST); }\n\n    self.realColorMask.apply(gl, self.colorMask);\n    self.realViewport.apply(gl, self.viewport);\n    self.realClearColor.apply(gl, self.clearColor);\n  });\n\n  if (this.cardboardUI) {\n    this.cardboardUI.onResize();\n  }\n};\n\nCardboardDistorter.prototype.patch = function() {\n  if (this.isPatched) {\n    return;\n  }\n\n  var self = this;\n  var canvas = this.gl.canvas;\n  var gl = this.gl;\n\n  if (!Util.isIOS()) {\n    canvas.width = Util.getScreenWidth() * this.bufferScale;\n    canvas.height = Util.getScreenHeight() * this.bufferScale;\n\n    Object.defineProperty(canvas, 'width', {\n      configurable: true,\n      enumerable: true,\n      get: function() {\n        return self.bufferWidth;\n      },\n      set: function(value) {\n        self.bufferWidth = value;\n        self.realCanvasWidth.set.call(canvas, value);\n        self.onResize();\n      }\n    });\n\n    Object.defineProperty(canvas, 'height', {\n      configurable: true,\n      enumerable: true,\n      get: function() {\n        return self.bufferHeight;\n      },\n      set: function(value) {\n        self.bufferHeight = value;\n        self.realCanvasHeight.set.call(canvas, value);\n        self.onResize();\n      }\n    });\n  }\n\n  this.lastBoundFramebuffer = gl.getParameter(gl.FRAMEBUFFER_BINDING);\n\n  if (this.lastBoundFramebuffer == null) {\n    this.lastBoundFramebuffer = this.framebuffer;\n    this.gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n  }\n\n  this.gl.bindFramebuffer = function(target, framebuffer) {\n    self.lastBoundFramebuffer = framebuffer ? framebuffer : self.framebuffer;\n    // Silently make calls to bind the default framebuffer bind ours instead.\n    self.realBindFramebuffer.call(gl, target, self.lastBoundFramebuffer);\n  };\n\n  this.cullFace = gl.getParameter(gl.CULL_FACE);\n  this.depthTest = gl.getParameter(gl.DEPTH_TEST);\n  this.blend = gl.getParameter(gl.BLEND);\n  this.scissorTest = gl.getParameter(gl.SCISSOR_TEST);\n  this.stencilTest = gl.getParameter(gl.STENCIL_TEST);\n\n  gl.enable = function(pname) {\n    switch (pname) {\n      case gl.CULL_FACE: self.cullFace = true; break;\n      case gl.DEPTH_TEST: self.depthTest = true; break;\n      case gl.BLEND: self.blend = true; break;\n      case gl.SCISSOR_TEST: self.scissorTest = true; break;\n      case gl.STENCIL_TEST: self.stencilTest = true; break;\n    }\n    self.realEnable.call(gl, pname);\n  };\n\n  gl.disable = function(pname) {\n    switch (pname) {\n      case gl.CULL_FACE: self.cullFace = false; break;\n      case gl.DEPTH_TEST: self.depthTest = false; break;\n      case gl.BLEND: self.blend = false; break;\n      case gl.SCISSOR_TEST: self.scissorTest = false; break;\n      case gl.STENCIL_TEST: self.stencilTest = false; break;\n    }\n    self.realDisable.call(gl, pname);\n  };\n\n  this.colorMask = gl.getParameter(gl.COLOR_WRITEMASK);\n  gl.colorMask = function(r, g, b, a) {\n    self.colorMask[0] = r;\n    self.colorMask[1] = g;\n    self.colorMask[2] = b;\n    self.colorMask[3] = a;\n    self.realColorMask.call(gl, r, g, b, a);\n  };\n\n  this.clearColor = gl.getParameter(gl.COLOR_CLEAR_VALUE);\n  gl.clearColor = function(r, g, b, a) {\n    self.clearColor[0] = r;\n    self.clearColor[1] = g;\n    self.clearColor[2] = b;\n    self.clearColor[3] = a;\n    self.realClearColor.call(gl, r, g, b, a);\n  };\n\n  this.viewport = gl.getParameter(gl.VIEWPORT);\n  gl.viewport = function(x, y, w, h) {\n    self.viewport[0] = x;\n    self.viewport[1] = y;\n    self.viewport[2] = w;\n    self.viewport[3] = h;\n    self.realViewport.call(gl, x, y, w, h);\n  };\n\n  this.isPatched = true;\n  Util.safariCssSizeWorkaround(canvas);\n};\n\nCardboardDistorter.prototype.unpatch = function() {\n  if (!this.isPatched) {\n    return;\n  }\n\n  var gl = this.gl;\n  var canvas = this.gl.canvas;\n\n  if (!Util.isIOS()) {\n    Object.defineProperty(canvas, 'width', this.realCanvasWidth);\n    Object.defineProperty(canvas, 'height', this.realCanvasHeight);\n  }\n  canvas.width = this.bufferWidth;\n  canvas.height = this.bufferHeight;\n\n  gl.bindFramebuffer = this.realBindFramebuffer;\n  gl.enable = this.realEnable;\n  gl.disable = this.realDisable;\n  gl.colorMask = this.realColorMask;\n  gl.clearColor = this.realClearColor;\n  gl.viewport = this.realViewport;\n\n  // Check to see if our fake backbuffer is bound and bind the real backbuffer\n  // if that's the case.\n  if (this.lastBoundFramebuffer == this.framebuffer) {\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  }\n\n  this.isPatched = false;\n\n  setTimeout(function() {\n    Util.safariCssSizeWorkaround(canvas);\n  }, 1);\n};\n\nCardboardDistorter.prototype.setTextureBounds = function(leftBounds, rightBounds) {\n  if (!leftBounds) {\n    leftBounds = [0, 0, 0.5, 1];\n  }\n\n  if (!rightBounds) {\n    rightBounds = [0.5, 0, 0.5, 1];\n  }\n\n  // Left eye\n  this.viewportOffsetScale[0] = leftBounds[0]; // X\n  this.viewportOffsetScale[1] = leftBounds[1]; // Y\n  this.viewportOffsetScale[2] = leftBounds[2]; // Width\n  this.viewportOffsetScale[3] = leftBounds[3]; // Height\n\n  // Right eye\n  this.viewportOffsetScale[4] = rightBounds[0]; // X\n  this.viewportOffsetScale[5] = rightBounds[1]; // Y\n  this.viewportOffsetScale[6] = rightBounds[2]; // Width\n  this.viewportOffsetScale[7] = rightBounds[3]; // Height\n};\n\n/**\n * Performs distortion pass on the injected backbuffer, rendering it to the real\n * backbuffer.\n */\nCardboardDistorter.prototype.submitFrame = function() {\n  var gl = this.gl;\n  var self = this;\n\n  var glState = [];\n\n  if (!WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS) {\n    glState.push(\n      gl.CURRENT_PROGRAM,\n      gl.ARRAY_BUFFER_BINDING,\n      gl.ELEMENT_ARRAY_BUFFER_BINDING,\n      gl.TEXTURE_BINDING_2D, gl.TEXTURE0\n    );\n  }\n\n  WGLUPreserveGLState(gl, glState, function(gl) {\n    // Bind the real default framebuffer\n    self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, null);\n\n    // Make sure the GL state is in a good place\n    if (self.cullFace) { self.realDisable.call(gl, gl.CULL_FACE); }\n    if (self.depthTest) { self.realDisable.call(gl, gl.DEPTH_TEST); }\n    if (self.blend) { self.realDisable.call(gl, gl.BLEND); }\n    if (self.scissorTest) { self.realDisable.call(gl, gl.SCISSOR_TEST); }\n    if (self.stencilTest) { self.realDisable.call(gl, gl.STENCIL_TEST); }\n    self.realColorMask.call(gl, true, true, true, true);\n    self.realViewport.call(gl, 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n    // If the backbuffer has an alpha channel clear every frame so the page\n    // doesn't show through.\n    if (self.ctxAttribs.alpha || Util.isIOS()) {\n      self.realClearColor.call(gl, 0, 0, 0, 1);\n      gl.clear(gl.COLOR_BUFFER_BIT);\n    }\n\n    // Bind distortion program and mesh\n    gl.useProgram(self.program);\n\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, self.indexBuffer);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, self.vertexBuffer);\n    gl.enableVertexAttribArray(self.attribs.position);\n    gl.enableVertexAttribArray(self.attribs.texCoord);\n    gl.vertexAttribPointer(self.attribs.position, 2, gl.FLOAT, false, 20, 0);\n    gl.vertexAttribPointer(self.attribs.texCoord, 3, gl.FLOAT, false, 20, 8);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.uniform1i(self.uniforms.diffuse, 0);\n    gl.bindTexture(gl.TEXTURE_2D, self.renderTarget);\n\n    gl.uniform4fv(self.uniforms.viewportOffsetScale, self.viewportOffsetScale);\n\n    // Draws both eyes\n    gl.drawElements(gl.TRIANGLES, self.indexCount, gl.UNSIGNED_SHORT, 0);\n\n    if (self.cardboardUI) {\n      self.cardboardUI.renderNoState();\n    }\n\n    // Bind the fake default framebuffer again\n    self.realBindFramebuffer.call(self.gl, gl.FRAMEBUFFER, self.framebuffer);\n\n    // If preserveDrawingBuffer == false clear the framebuffer\n    if (!self.ctxAttribs.preserveDrawingBuffer) {\n      self.realClearColor.call(gl, 0, 0, 0, 0);\n      gl.clear(gl.COLOR_BUFFER_BIT);\n    }\n\n    if (!WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS) {\n      self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, self.lastBoundFramebuffer);\n    }\n\n    // Restore state\n    if (self.cullFace) { self.realEnable.call(gl, gl.CULL_FACE); }\n    if (self.depthTest) { self.realEnable.call(gl, gl.DEPTH_TEST); }\n    if (self.blend) { self.realEnable.call(gl, gl.BLEND); }\n    if (self.scissorTest) { self.realEnable.call(gl, gl.SCISSOR_TEST); }\n    if (self.stencilTest) { self.realEnable.call(gl, gl.STENCIL_TEST); }\n\n    self.realColorMask.apply(gl, self.colorMask);\n    self.realViewport.apply(gl, self.viewport);\n    if (self.ctxAttribs.alpha || !self.ctxAttribs.preserveDrawingBuffer) {\n      self.realClearColor.apply(gl, self.clearColor);\n    }\n  });\n\n  // Workaround for the fact that Safari doesn't allow us to patch the canvas\n  // width and height correctly. After each submit frame check to see what the\n  // real backbuffer size has been set to and resize the fake backbuffer size\n  // to match.\n  if (Util.isIOS()) {\n    var canvas = gl.canvas;\n    if (canvas.width != self.bufferWidth || canvas.height != self.bufferHeight) {\n      self.bufferWidth = canvas.width;\n      self.bufferHeight = canvas.height;\n      self.onResize();\n    }\n  }\n};\n\n/**\n * Call when the deviceInfo has changed. At this point we need\n * to re-calculate the distortion mesh.\n */\nCardboardDistorter.prototype.updateDeviceInfo = function(deviceInfo) {\n  var gl = this.gl;\n  var self = this;\n\n  var glState = [gl.ARRAY_BUFFER_BINDING, gl.ELEMENT_ARRAY_BUFFER_BINDING];\n  WGLUPreserveGLState(gl, glState, function(gl) {\n    var vertices = self.computeMeshVertices_(self.meshWidth, self.meshHeight, deviceInfo);\n    gl.bindBuffer(gl.ARRAY_BUFFER, self.vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n\n    // Indices don't change based on device parameters, so only compute once.\n    if (!self.indexCount) {\n      var indices = self.computeMeshIndices_(self.meshWidth, self.meshHeight);\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, self.indexBuffer);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indices, gl.STATIC_DRAW);\n      self.indexCount = indices.length;\n    }\n  });\n};\n\n/**\n * Build the distortion mesh vertices.\n * Based on code from the Unity cardboard plugin.\n */\nCardboardDistorter.prototype.computeMeshVertices_ = function(width, height, deviceInfo) {\n  var vertices = new Float32Array(2 * width * height * 5);\n\n  var lensFrustum = deviceInfo.getLeftEyeVisibleTanAngles();\n  var noLensFrustum = deviceInfo.getLeftEyeNoLensTanAngles();\n  var viewport = deviceInfo.getLeftEyeVisibleScreenRect(noLensFrustum);\n  var vidx = 0;\n  var iidx = 0;\n  for (var e = 0; e < 2; e++) {\n    for (var j = 0; j < height; j++) {\n      for (var i = 0; i < width; i++, vidx++) {\n        var u = i / (width - 1);\n        var v = j / (height - 1);\n\n        // Grid points regularly spaced in StreoScreen, and barrel distorted in\n        // the mesh.\n        var s = u;\n        var t = v;\n        var x = Util.lerp(lensFrustum[0], lensFrustum[2], u);\n        var y = Util.lerp(lensFrustum[3], lensFrustum[1], v);\n        var d = Math.sqrt(x * x + y * y);\n        var r = deviceInfo.distortion.distortInverse(d);\n        var p = x * r / d;\n        var q = y * r / d;\n        u = (p - noLensFrustum[0]) / (noLensFrustum[2] - noLensFrustum[0]);\n        v = (q - noLensFrustum[3]) / (noLensFrustum[1] - noLensFrustum[3]);\n\n        // Convert u,v to mesh screen coordinates.\n        var aspect = deviceInfo.device.widthMeters / deviceInfo.device.heightMeters;\n\n        // FIXME: The original Unity plugin multiplied U by the aspect ratio\n        // and didn't multiply either value by 2, but that seems to get it\n        // really close to correct looking for me. I hate this kind of \"Don't\n        // know why it works\" code though, and wold love a more logical\n        // explanation of what needs to happen here.\n        u = (viewport.x + u * viewport.width - 0.5) * 2.0; //* aspect;\n        v = (viewport.y + v * viewport.height - 0.5) * 2.0;\n\n        vertices[(vidx * 5) + 0] = u; // position.x\n        vertices[(vidx * 5) + 1] = v; // position.y\n        vertices[(vidx * 5) + 2] = s; // texCoord.x\n        vertices[(vidx * 5) + 3] = t; // texCoord.y\n        vertices[(vidx * 5) + 4] = e; // texCoord.z (viewport index)\n      }\n    }\n    var w = lensFrustum[2] - lensFrustum[0];\n    lensFrustum[0] = -(w + lensFrustum[0]);\n    lensFrustum[2] = w - lensFrustum[2];\n    w = noLensFrustum[2] - noLensFrustum[0];\n    noLensFrustum[0] = -(w + noLensFrustum[0]);\n    noLensFrustum[2] = w - noLensFrustum[2];\n    viewport.x = 1 - (viewport.x + viewport.width);\n  }\n  return vertices;\n}\n\n/**\n * Build the distortion mesh indices.\n * Based on code from the Unity cardboard plugin.\n */\nCardboardDistorter.prototype.computeMeshIndices_ = function(width, height) {\n  var indices = new Uint16Array(2 * (width - 1) * (height - 1) * 6);\n  var halfwidth = width / 2;\n  var halfheight = height / 2;\n  var vidx = 0;\n  var iidx = 0;\n  for (var e = 0; e < 2; e++) {\n    for (var j = 0; j < height; j++) {\n      for (var i = 0; i < width; i++, vidx++) {\n        if (i == 0 || j == 0)\n          continue;\n        // Build a quad.  Lower right and upper left quadrants have quads with\n        // the triangle diagonal flipped to get the vignette to interpolate\n        // correctly.\n        if ((i <= halfwidth) == (j <= halfheight)) {\n          // Quad diagonal lower left to upper right.\n          indices[iidx++] = vidx;\n          indices[iidx++] = vidx - width - 1;\n          indices[iidx++] = vidx - width;\n          indices[iidx++] = vidx - width - 1;\n          indices[iidx++] = vidx;\n          indices[iidx++] = vidx - 1;\n        } else {\n          // Quad diagonal upper left to lower right.\n          indices[iidx++] = vidx - 1;\n          indices[iidx++] = vidx - width;\n          indices[iidx++] = vidx;\n          indices[iidx++] = vidx - width;\n          indices[iidx++] = vidx - 1;\n          indices[iidx++] = vidx - width - 1;\n        }\n      }\n    }\n  }\n  return indices;\n};\n\nCardboardDistorter.prototype.getOwnPropertyDescriptor_ = function(proto, attrName) {\n  var descriptor = Object.getOwnPropertyDescriptor(proto, attrName);\n  // In some cases (ahem... Safari), the descriptor returns undefined get and\n  // set fields. In this case, we need to create a synthetic property\n  // descriptor. This works around some of the issues in\n  // https://github.com/borismus/webvr-polyfill/issues/46\n  if (descriptor.get === undefined || descriptor.set === undefined) {\n    descriptor.configurable = true;\n    descriptor.enumerable = true;\n    descriptor.get = function() {\n      return this.getAttribute(attrName);\n    };\n    descriptor.set = function(val) {\n      this.setAttribute(attrName, val);\n    };\n  }\n  return descriptor;\n};\n\nmodule.exports = CardboardDistorter;\n\n},{\"./cardboard-ui.js\":4,\"./deps/wglu-preserve-state.js\":6,\"./util.js\":22}],4:[function(_dereq_,module,exports){\n/*\n * Copyright 2016 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar Util = _dereq_('./util.js');\nvar WGLUPreserveGLState = _dereq_('./deps/wglu-preserve-state.js');\n\nvar uiVS = [\n  'attribute vec2 position;',\n\n  'uniform mat4 projectionMat;',\n\n  'void main() {',\n  '  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );',\n  '}',\n].join('\\n');\n\nvar uiFS = [\n  'precision mediump float;',\n\n  'uniform vec4 color;',\n\n  'void main() {',\n  '  gl_FragColor = color;',\n  '}',\n].join('\\n');\n\nvar DEG2RAD = Math.PI/180.0;\n\n// The gear has 6 identical sections, each spanning 60 degrees.\nvar kAnglePerGearSection = 60;\n\n// Half-angle of the span of the outer rim.\nvar kOuterRimEndAngle = 12;\n\n// Angle between the middle of the outer rim and the start of the inner rim.\nvar kInnerRimBeginAngle = 20;\n\n// Distance from center to outer rim, normalized so that the entire model\n// fits in a [-1, 1] x [-1, 1] square.\nvar kOuterRadius = 1;\n\n// Distance from center to depressed rim, in model units.\nvar kMiddleRadius = 0.75;\n\n// Radius of the inner hollow circle, in model units.\nvar kInnerRadius = 0.3125;\n\n// Center line thickness in DP.\nvar kCenterLineThicknessDp = 4;\n\n// Button width in DP.\nvar kButtonWidthDp = 28;\n\n// Factor to scale the touch area that responds to the touch.\nvar kTouchSlopFactor = 1.5;\n\nvar Angles = [\n  0, kOuterRimEndAngle, kInnerRimBeginAngle,\n  kAnglePerGearSection - kInnerRimBeginAngle,\n  kAnglePerGearSection - kOuterRimEndAngle\n];\n\n/**\n * Renders the alignment line and \"options\" gear. It is assumed that the canvas\n * this is rendered into covers the entire screen (or close to it.)\n */\nfunction CardboardUI(gl) {\n  this.gl = gl;\n\n  this.attribs = {\n    position: 0\n  };\n  this.program = Util.linkProgram(gl, uiVS, uiFS, this.attribs);\n  this.uniforms = Util.getProgramUniforms(gl, this.program);\n\n  this.vertexBuffer = gl.createBuffer();\n  this.gearOffset = 0;\n  this.gearVertexCount = 0;\n  this.arrowOffset = 0;\n  this.arrowVertexCount = 0;\n\n  this.projMat = new Float32Array(16);\n\n  this.listener = null;\n\n  this.onResize();\n};\n\n/**\n * Tears down all the resources created by the UI renderer.\n */\nCardboardUI.prototype.destroy = function() {\n  var gl = this.gl;\n\n  if (this.listener) {\n    gl.canvas.removeEventListener('click', this.listener, false);\n  }\n\n  gl.deleteProgram(this.program);\n  gl.deleteBuffer(this.vertexBuffer);\n};\n\n/**\n * Adds a listener to clicks on the gear and back icons\n */\nCardboardUI.prototype.listen = function(optionsCallback, backCallback) {\n  var canvas = this.gl.canvas;\n  this.listener = function(event) {\n    var midline = canvas.clientWidth / 2;\n    var buttonSize = kButtonWidthDp * kTouchSlopFactor;\n    // Check to see if the user clicked on (or around) the gear icon\n    if (event.clientX > midline - buttonSize &&\n        event.clientX < midline + buttonSize &&\n        event.clientY > canvas.clientHeight - buttonSize) {\n      optionsCallback(event);\n    }\n    // Check to see if the user clicked on (or around) the back icon\n    else if (event.clientX < buttonSize && event.clientY < buttonSize) {\n      backCallback(event);\n    }\n  };\n  canvas.addEventListener('click', this.listener, false);\n};\n\n/**\n * Builds the UI mesh.\n */\nCardboardUI.prototype.onResize = function() {\n  var gl = this.gl;\n  var self = this;\n\n  var glState = [\n    gl.ARRAY_BUFFER_BINDING\n  ];\n\n  WGLUPreserveGLState(gl, glState, function(gl) {\n    var vertices = [];\n\n    var midline = gl.drawingBufferWidth / 2;\n\n    // Assumes your canvas width and height is scaled proportionately.\n    // TODO(smus): The following causes buttons to become huge on iOS, but seems\n    // like the right thing to do. For now, added a hack. But really, investigate why.\n    var dps = (gl.drawingBufferWidth / (screen.width * window.devicePixelRatio));\n    if (!Util.isIOS()) {\n      dps *= window.devicePixelRatio;\n    }\n\n    var lineWidth = kCenterLineThicknessDp * dps / 2;\n    var buttonSize = kButtonWidthDp * kTouchSlopFactor * dps;\n    var buttonScale = kButtonWidthDp * dps / 2;\n    var buttonBorder = ((kButtonWidthDp * kTouchSlopFactor) - kButtonWidthDp) * dps;\n\n    // Build centerline\n    vertices.push(midline - lineWidth, buttonSize);\n    vertices.push(midline - lineWidth, gl.drawingBufferHeight);\n    vertices.push(midline + lineWidth, buttonSize);\n    vertices.push(midline + lineWidth, gl.drawingBufferHeight);\n\n    // Build gear\n    self.gearOffset = (vertices.length / 2);\n\n    function addGearSegment(theta, r) {\n      var angle = (90 - theta) * DEG2RAD;\n      var x = Math.cos(angle);\n      var y = Math.sin(angle);\n      vertices.push(kInnerRadius * x * buttonScale + midline, kInnerRadius * y * buttonScale + buttonScale);\n      vertices.push(r * x * buttonScale + midline, r * y * buttonScale + buttonScale);\n    }\n\n    for (var i = 0; i <= 6; i++) {\n      var segmentTheta = i * kAnglePerGearSection;\n\n      addGearSegment(segmentTheta, kOuterRadius);\n      addGearSegment(segmentTheta + kOuterRimEndAngle, kOuterRadius);\n      addGearSegment(segmentTheta + kInnerRimBeginAngle, kMiddleRadius);\n      addGearSegment(segmentTheta + (kAnglePerGearSection - kInnerRimBeginAngle), kMiddleRadius);\n      addGearSegment(segmentTheta + (kAnglePerGearSection - kOuterRimEndAngle), kOuterRadius);\n    }\n\n    self.gearVertexCount = (vertices.length / 2) - self.gearOffset;\n\n    // Build back arrow\n    self.arrowOffset = (vertices.length / 2);\n\n    function addArrowVertex(x, y) {\n      vertices.push(buttonBorder + x, gl.drawingBufferHeight - buttonBorder - y);\n    }\n\n    var angledLineWidth = lineWidth / Math.sin(45 * DEG2RAD);\n\n    addArrowVertex(0, buttonScale);\n    addArrowVertex(buttonScale, 0);\n    addArrowVertex(buttonScale + angledLineWidth, angledLineWidth);\n    addArrowVertex(angledLineWidth, buttonScale + angledLineWidth);\n\n    addArrowVertex(angledLineWidth, buttonScale - angledLineWidth);\n    addArrowVertex(0, buttonScale);\n    addArrowVertex(buttonScale, buttonScale * 2);\n    addArrowVertex(buttonScale + angledLineWidth, (buttonScale * 2) - angledLineWidth);\n\n    addArrowVertex(angledLineWidth, buttonScale - angledLineWidth);\n    addArrowVertex(0, buttonScale);\n\n    addArrowVertex(angledLineWidth, buttonScale - lineWidth);\n    addArrowVertex(kButtonWidthDp * dps, buttonScale - lineWidth);\n    addArrowVertex(angledLineWidth, buttonScale + lineWidth);\n    addArrowVertex(kButtonWidthDp * dps, buttonScale + lineWidth);\n\n    self.arrowVertexCount = (vertices.length / 2) - self.arrowOffset;\n\n    // Buffer data\n    gl.bindBuffer(gl.ARRAY_BUFFER, self.vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\n  });\n};\n\n/**\n * Performs distortion pass on the injected backbuffer, rendering it to the real\n * backbuffer.\n */\nCardboardUI.prototype.render = function() {\n  var gl = this.gl;\n  var self = this;\n\n  var glState = [\n    gl.CULL_FACE,\n    gl.DEPTH_TEST,\n    gl.BLEND,\n    gl.SCISSOR_TEST,\n    gl.STENCIL_TEST,\n    gl.COLOR_WRITEMASK,\n    gl.VIEWPORT,\n\n    gl.CURRENT_PROGRAM,\n    gl.ARRAY_BUFFER_BINDING\n  ];\n\n  WGLUPreserveGLState(gl, glState, function(gl) {\n    // Make sure the GL state is in a good place\n    gl.disable(gl.CULL_FACE);\n    gl.disable(gl.DEPTH_TEST);\n    gl.disable(gl.BLEND);\n    gl.disable(gl.SCISSOR_TEST);\n    gl.disable(gl.STENCIL_TEST);\n    gl.colorMask(true, true, true, true);\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n    self.renderNoState();\n  });\n};\n\nCardboardUI.prototype.renderNoState = function() {\n  var gl = this.gl;\n\n  // Bind distortion program and mesh\n  gl.useProgram(this.program);\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n  gl.enableVertexAttribArray(this.attribs.position);\n  gl.vertexAttribPointer(this.attribs.position, 2, gl.FLOAT, false, 8, 0);\n\n  gl.uniform4f(this.uniforms.color, 1.0, 1.0, 1.0, 1.0);\n\n  Util.orthoMatrix(this.projMat, 0, gl.drawingBufferWidth, 0, gl.drawingBufferHeight, 0.1, 1024.0);\n  gl.uniformMatrix4fv(this.uniforms.projectionMat, false, this.projMat);\n\n  // Draws UI element\n  gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n  gl.drawArrays(gl.TRIANGLE_STRIP, this.gearOffset, this.gearVertexCount);\n  gl.drawArrays(gl.TRIANGLE_STRIP, this.arrowOffset, this.arrowVertexCount);\n};\n\nmodule.exports = CardboardUI;\n\n},{\"./deps/wglu-preserve-state.js\":6,\"./util.js\":22}],5:[function(_dereq_,module,exports){\n/*\n * Copyright 2016 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar CardboardDistorter = _dereq_('./cardboard-distorter.js');\nvar CardboardUI = _dereq_('./cardboard-ui.js');\nvar DeviceInfo = _dereq_('./device-info.js');\nvar Dpdb = _dereq_('./dpdb/dpdb.js');\nvar FusionPoseSensor = _dereq_('./sensor-fusion/fusion-pose-sensor.js');\nvar RotateInstructions = _dereq_('./rotate-instructions.js');\nvar ViewerSelector = _dereq_('./viewer-selector.js');\nvar VRDisplay = _dereq_('./base.js').VRDisplay;\nvar Util = _dereq_('./util.js');\n\nvar Eye = {\n  LEFT: 'left',\n  RIGHT: 'right'\n};\n\n/**\n * VRDisplay based on mobile device parameters and DeviceMotion APIs.\n */\nfunction CardboardVRDisplay() {\n  this.displayName = 'Cardboard VRDisplay (webvr-polyfill)';\n\n  this.capabilities.hasOrientation = true;\n  this.capabilities.canPresent = true;\n\n  // \"Private\" members.\n  this.bufferScale_ = WebVRConfig.BUFFER_SCALE;\n  this.poseSensor_ = new FusionPoseSensor();\n  this.distorter_ = null;\n  this.cardboardUI_ = null;\n\n  this.dpdb_ = new Dpdb(true, this.onDeviceParamsUpdated_.bind(this));\n  this.deviceInfo_ = new DeviceInfo(this.dpdb_.getDeviceParams());\n\n  this.viewerSelector_ = new ViewerSelector();\n  this.viewerSelector_.on('change', this.onViewerChanged_.bind(this));\n\n  // Set the correct initial viewer.\n  this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer());\n\n  if (!WebVRConfig.ROTATE_INSTRUCTIONS_DISABLED) {\n    this.rotateInstructions_ = new RotateInstructions();\n  }\n\n  if (Util.isIOS()) {\n    // Listen for resize events to workaround this awful Safari bug.\n    window.addEventListener('resize', this.onResize_.bind(this));\n  }\n}\nCardboardVRDisplay.prototype = new VRDisplay();\n\nCardboardVRDisplay.prototype.getImmediatePose = function() {\n  return {\n    position: this.poseSensor_.getPosition(),\n    orientation: this.poseSensor_.getOrientation(),\n    linearVelocity: null,\n    linearAcceleration: null,\n    angularVelocity: null,\n    angularAcceleration: null\n  };\n};\n\nCardboardVRDisplay.prototype.resetPose = function() {\n  this.poseSensor_.resetPose();\n};\n\nCardboardVRDisplay.prototype.getEyeParameters = function(whichEye) {\n  var offset = [this.deviceInfo_.viewer.interLensDistance * 0.5, 0.0, 0.0];\n  var fieldOfView;\n\n  // TODO: FoV can be a little expensive to compute. Cache when device params change.\n  if (whichEye == Eye.LEFT) {\n    offset[0] *= -1.0;\n    fieldOfView = this.deviceInfo_.getFieldOfViewLeftEye();\n  } else if (whichEye == Eye.RIGHT) {\n    fieldOfView = this.deviceInfo_.getFieldOfViewRightEye();\n  } else {\n    console.error('Invalid eye provided: %s', whichEye);\n    return null;\n  }\n\n  return {\n    fieldOfView: fieldOfView,\n    offset: offset,\n    // TODO: Should be able to provide better values than these.\n    renderWidth: this.deviceInfo_.device.width * 0.5 * this.bufferScale_,\n    renderHeight: this.deviceInfo_.device.height * this.bufferScale_,\n  };\n};\n\nCardboardVRDisplay.prototype.onDeviceParamsUpdated_ = function(newParams) {\n  console.log('DPDB reported that device params were updated.');\n  this.deviceInfo_.updateDeviceParams(newParams);\n\n  if (this.distorter_) {\n    this.distorter_.updateDeviceInfo(this.deviceInfo_);\n  }\n};\n\nCardboardVRDisplay.prototype.updateBounds_ = function () {\n  if (this.layer_ && this.distorter_ && (this.layer_.leftBounds || this.layer_.rightBounds)) {\n    this.distorter_.setTextureBounds(this.layer_.leftBounds, this.layer_.rightBounds);\n  }\n};\n\nCardboardVRDisplay.prototype.beginPresent_ = function() {\n  var gl = this.layer_.source.getContext('webgl');\n  if (!gl)\n    gl = this.layer_.source.getContext('experimental-webgl');\n  if (!gl)\n    gl = this.layer_.source.getContext('webgl2');\n\n  if (!gl)\n    return; // Can't do distortion without a WebGL context.\n\n  // Provides a way to opt out of distortion\n  if (this.layer_.predistorted) {\n    if (!WebVRConfig.CARDBOARD_UI_DISABLED) {\n      gl.canvas.width = Util.getScreenWidth() * this.bufferScale_;\n      gl.canvas.height = Util.getScreenHeight() * this.bufferScale_;\n      this.cardboardUI_ = new CardboardUI(gl);\n    }\n  } else {\n    // Create a new distorter for the target context\n    this.distorter_ = new CardboardDistorter(gl);\n    this.distorter_.updateDeviceInfo(this.deviceInfo_);\n    this.cardboardUI_ = this.distorter_.cardboardUI;\n  }\n\n  if (this.cardboardUI_) {\n    this.cardboardUI_.listen(function(e) {\n      // Options clicked.\n      this.viewerSelector_.show(this.layer_.source.parentElement);\n      e.stopPropagation();\n      e.preventDefault();\n    }.bind(this), function(e) {\n      // Back clicked.\n      this.exitPresent();\n      e.stopPropagation();\n      e.preventDefault();\n    }.bind(this));\n  }\n\n  if (this.rotateInstructions_) {\n    if (Util.isLandscapeMode() && Util.isMobile()) {\n      // In landscape mode, temporarily show the \"put into Cardboard\"\n      // interstitial. Otherwise, do the default thing.\n      this.rotateInstructions_.showTemporarily(3000, this.layer_.source.parentElement);\n    } else {\n      this.rotateInstructions_.update();\n    }\n  }\n\n  // Listen for orientation change events in order to show interstitial.\n  this.orientationHandler = this.onOrientationChange_.bind(this);\n  window.addEventListener('orientationchange', this.orientationHandler);\n\n  // Listen for present display change events in order to update distorter dimensions\n  this.vrdisplaypresentchangeHandler = this.updateBounds_.bind(this);\n  window.addEventListener('vrdisplaypresentchange', this.vrdisplaypresentchangeHandler);\n\n  // Fire this event initially, to give geometry-distortion clients the chance\n  // to do something custom.\n  this.fireVRDisplayDeviceParamsChange_();\n};\n\nCardboardVRDisplay.prototype.endPresent_ = function() {\n  if (this.distorter_) {\n    this.distorter_.destroy();\n    this.distorter_ = null;\n  }\n  if (this.cardboardUI_) {\n    this.cardboardUI_.destroy();\n    this.cardboardUI_ = null;\n  }\n\n  if (this.rotateInstructions_) {\n    this.rotateInstructions_.hide();\n  }\n  this.viewerSelector_.hide();\n\n  window.removeEventListener('orientationchange', this.orientationHandler);\n  window.removeEventListener('vrdisplaypresentchange', this.vrdisplaypresentchangeHandler);\n};\n\nCardboardVRDisplay.prototype.submitFrame = function(pose) {\n  if (this.distorter_) {\n    this.distorter_.submitFrame();\n  } else if (this.cardboardUI_ && this.layer_) {\n    // Hack for predistorted: true.\n    var canvas = this.layer_.source.getContext('webgl').canvas;\n    if (canvas.width != this.lastWidth || canvas.height != this.lastHeight) {\n      this.cardboardUI_.onResize();\n    }\n    this.lastWidth = canvas.width;\n    this.lastHeight = canvas.height;\n\n    // Render the Cardboard UI.\n    this.cardboardUI_.render();\n  }\n};\n\nCardboardVRDisplay.prototype.onOrientationChange_ = function(e) {\n  console.log('onOrientationChange_');\n\n  // Hide the viewer selector.\n  this.viewerSelector_.hide();\n\n  // Update the rotate instructions.\n  if (this.rotateInstructions_) {\n    this.rotateInstructions_.update();\n  }\n\n  this.onResize_();\n};\n\nCardboardVRDisplay.prototype.onResize_ = function(e) {\n  if (this.layer_) {\n    var gl = this.layer_.source.getContext('webgl');\n    // Size the CSS canvas.\n    // Added padding on right and bottom because iPhone 5 will not\n    // hide the URL bar unless content is bigger than the screen.\n    // This will not be visible as long as the container element (e.g. body)\n    // is set to 'overflow: hidden'.\n    var cssProperties = [\n      'position: absolute',\n      'top: 0',\n      'left: 0',\n      'width: ' + Math.max(screen.width, screen.height) + 'px',\n      'height: ' + Math.min(screen.height, screen.width) + 'px',\n      'border: 0',\n      'margin: 0',\n      'padding: 0 10px 10px 0',\n    ];\n    gl.canvas.setAttribute('style', cssProperties.join('; ') + ';');\n\n    Util.safariCssSizeWorkaround(gl.canvas);\n  }\n};\n\nCardboardVRDisplay.prototype.onViewerChanged_ = function(viewer) {\n  this.deviceInfo_.setViewer(viewer);\n\n  if (this.distorter_) {\n    // Update the distortion appropriately.\n    this.distorter_.updateDeviceInfo(this.deviceInfo_);\n  }\n\n  // Fire a new event containing viewer and device parameters for clients that\n  // want to implement their own geometry-based distortion.\n  this.fireVRDisplayDeviceParamsChange_();\n};\n\nCardboardVRDisplay.prototype.fireVRDisplayDeviceParamsChange_ = function() {\n  var event = new CustomEvent('vrdisplaydeviceparamschange', {\n    detail: {\n      vrdisplay: this,\n      deviceInfo: this.deviceInfo_,\n    }\n  });\n  window.dispatchEvent(event);\n};\n\nmodule.exports = CardboardVRDisplay;\n\n},{\"./base.js\":2,\"./cardboard-distorter.js\":3,\"./cardboard-ui.js\":4,\"./device-info.js\":7,\"./dpdb/dpdb.js\":11,\"./rotate-instructions.js\":16,\"./sensor-fusion/fusion-pose-sensor.js\":18,\"./util.js\":22,\"./viewer-selector.js\":23}],6:[function(_dereq_,module,exports){\n/*\nCopyright (c) 2016, Brandon Jones.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n*/\n\n/*\nCaches specified GL state, runs a callback, and restores the cached state when\ndone.\n\nExample usage:\n\nvar savedState = [\n  gl.ARRAY_BUFFER_BINDING,\n\n  // TEXTURE_BINDING_2D or _CUBE_MAP must always be followed by the texure unit.\n  gl.TEXTURE_BINDING_2D, gl.TEXTURE0,\n\n  gl.CLEAR_COLOR,\n];\n// After this call the array buffer, texture unit 0, active texture, and clear\n// color will be restored. The viewport will remain changed, however, because\n// gl.VIEWPORT was not included in the savedState list.\nWGLUPreserveGLState(gl, savedState, function(gl) {\n  gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, ....);\n\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texImage2D(gl.TEXTURE_2D, ...);\n\n  gl.clearColor(1, 0, 0, 1);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n});\n\nNote that this is not intended to be fast. Managing state in your own code to\navoid redundant state setting and querying will always be faster. This function\nis most useful for cases where you may not have full control over the WebGL\ncalls being made, such as tooling or effect injectors.\n*/\n\nfunction WGLUPreserveGLState(gl, bindings, callback) {\n  if (!bindings) {\n    callback(gl);\n    return;\n  }\n\n  var boundValues = [];\n\n  var activeTexture = null;\n  for (var i = 0; i < bindings.length; ++i) {\n    var binding = bindings[i];\n    switch (binding) {\n      case gl.TEXTURE_BINDING_2D:\n      case gl.TEXTURE_BINDING_CUBE_MAP:\n        var textureUnit = bindings[++i];\n        if (textureUnit < gl.TEXTURE0 || textureUnit > gl.TEXTURE31) {\n          console.error(\"TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit\");\n          boundValues.push(null, null);\n          break;\n        }\n        if (!activeTexture) {\n          activeTexture = gl.getParameter(gl.ACTIVE_TEXTURE);\n        }\n        gl.activeTexture(textureUnit);\n        boundValues.push(gl.getParameter(binding), null);\n        break;\n      case gl.ACTIVE_TEXTURE:\n        activeTexture = gl.getParameter(gl.ACTIVE_TEXTURE);\n        boundValues.push(null);\n        break;\n      default:\n        boundValues.push(gl.getParameter(binding));\n        break;\n    }\n  }\n\n  callback(gl);\n\n  for (var i = 0; i < bindings.length; ++i) {\n    var binding = bindings[i];\n    var boundValue = boundValues[i];\n    switch (binding) {\n      case gl.ACTIVE_TEXTURE:\n        break; // Ignore this binding, since we special-case it to happen last.\n      case gl.ARRAY_BUFFER_BINDING:\n        gl.bindBuffer(gl.ARRAY_BUFFER, boundValue);\n        break;\n      case gl.COLOR_CLEAR_VALUE:\n        gl.clearColor(boundValue[0], boundValue[1], boundValue[2], boundValue[3]);\n        break;\n      case gl.COLOR_WRITEMASK:\n        gl.colorMask(boundValue[0], boundValue[1], boundValue[2], boundValue[3]);\n        break;\n      case gl.CURRENT_PROGRAM:\n        gl.useProgram(boundValue);\n        break;\n      case gl.ELEMENT_ARRAY_BUFFER_BINDING:\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, boundValue);\n        break;\n      case gl.FRAMEBUFFER_BINDING:\n        gl.bindFramebuffer(gl.FRAMEBUFFER, boundValue);\n        break;\n      case gl.RENDERBUFFER_BINDING:\n        gl.bindRenderbuffer(gl.RENDERBUFFER, boundValue);\n        break;\n      case gl.TEXTURE_BINDING_2D:\n        var textureUnit = bindings[++i];\n        if (textureUnit < gl.TEXTURE0 || textureUnit > gl.TEXTURE31)\n          break;\n        gl.activeTexture(textureUnit);\n        gl.bindTexture(gl.TEXTURE_2D, boundValue);\n        break;\n      case gl.TEXTURE_BINDING_CUBE_MAP:\n        var textureUnit = bindings[++i];\n        if (textureUnit < gl.TEXTURE0 || textureUnit > gl.TEXTURE31)\n          break;\n        gl.activeTexture(textureUnit);\n        gl.bindTexture(gl.TEXTURE_CUBE_MAP, boundValue);\n        break;\n      case gl.VIEWPORT:\n        gl.viewport(boundValue[0], boundValue[1], boundValue[2], boundValue[3]);\n        break;\n      case gl.BLEND:\n      case gl.CULL_FACE:\n      case gl.DEPTH_TEST:\n      case gl.SCISSOR_TEST:\n      case gl.STENCIL_TEST:\n        if (boundValue) {\n          gl.enable(binding);\n        } else {\n          gl.disable(binding);\n        }\n        break;\n      default:\n        console.log(\"No GL restore behavior for 0x\" + binding.toString(16));\n        break;\n    }\n\n    if (activeTexture) {\n      gl.activeTexture(activeTexture);\n    }\n  }\n}\n\nmodule.exports = WGLUPreserveGLState;\n},{}],7:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar Distortion = _dereq_('./distortion/distortion.js');\nvar MathUtil = _dereq_('./math-util.js');\nvar Util = _dereq_('./util.js');\n\nfunction Device(params) {\n  this.width = params.width || Util.getScreenWidth();\n  this.height = params.height || Util.getScreenHeight();\n  this.widthMeters = params.widthMeters;\n  this.heightMeters = params.heightMeters;\n  this.bevelMeters = params.bevelMeters;\n}\n\n\n// Fallback Android device (based on Nexus 5 measurements) for use when\n// we can't recognize an Android device.\nvar DEFAULT_ANDROID = new Device({\n  widthMeters: 0.110,\n  heightMeters: 0.062,\n  bevelMeters: 0.004\n});\n\n// Fallback iOS device (based on iPhone6) for use when\n// we can't recognize an Android device.\nvar DEFAULT_IOS = new Device({\n  widthMeters: 0.1038,\n  heightMeters: 0.0584,\n  bevelMeters: 0.004\n});\n\n\nvar Viewers = {\n  CardboardV1: new CardboardViewer({\n    id: 'CardboardV1',\n    label: 'Cardboard I/O 2014',\n    fov: 40,\n    interLensDistance: 0.060,\n    baselineLensDistance: 0.035,\n    screenLensDistance: 0.042,\n    distortionCoefficients: [0.441, 0.156],\n    inverseCoefficients: [-0.4410035, 0.42756155, -0.4804439, 0.5460139,\n      -0.58821183, 0.5733938, -0.48303202, 0.33299083, -0.17573841,\n      0.0651772, -0.01488963, 0.001559834]\n  }),\n  CardboardV2: new CardboardViewer({\n    id: 'CardboardV2',\n    label: 'Cardboard I/O 2015',\n    fov: 60,\n    interLensDistance: 0.064,\n    baselineLensDistance: 0.035,\n    screenLensDistance: 0.039,\n    distortionCoefficients: [0.34, 0.55],\n    inverseCoefficients: [-0.33836704, -0.18162185, 0.862655, -1.2462051,\n      1.0560602, -0.58208317, 0.21609078, -0.05444823, 0.009177956,\n      -9.904169E-4, 6.183535E-5, -1.6981803E-6]\n  })\n};\n\n\nvar DEFAULT_LEFT_CENTER = {x: 0.5, y: 0.5};\nvar DEFAULT_RIGHT_CENTER = {x: 0.5, y: 0.5};\n\n/**\n * Manages information about the device and the viewer.\n *\n * deviceParams indicates the parameters of the device to use (generally\n * obtained from dpdb.getDeviceParams()). Can be null to mean no device\n * params were found.\n */\nfunction DeviceInfo(deviceParams) {\n  this.viewer = Viewers.CardboardV2;\n  this.updateDeviceParams(deviceParams);\n  this.distortion = new Distortion(this.viewer.distortionCoefficients);\n}\n\nDeviceInfo.prototype.updateDeviceParams = function(deviceParams) {\n  this.device = this.determineDevice_(deviceParams) || this.device;\n};\n\nDeviceInfo.prototype.getDevice = function() {\n  return this.device;\n};\n\nDeviceInfo.prototype.setViewer = function(viewer) {\n  this.viewer = viewer;\n  this.distortion = new Distortion(this.viewer.distortionCoefficients);\n};\n\nDeviceInfo.prototype.determineDevice_ = function(deviceParams) {\n  if (!deviceParams) {\n    // No parameters, so use a default.\n    if (Util.isIOS()) {\n      console.warn('Using fallback iOS device measurements.');\n      return DEFAULT_IOS;\n    } else {\n      console.warn('Using fallback Android device measurements.');\n      return DEFAULT_ANDROID;\n    }\n  }\n\n  // Compute device screen dimensions based on deviceParams.\n  var METERS_PER_INCH = 0.0254;\n  var metersPerPixelX = METERS_PER_INCH / deviceParams.xdpi;\n  var metersPerPixelY = METERS_PER_INCH / deviceParams.ydpi;\n  var width = Util.getScreenWidth();\n  var height = Util.getScreenHeight();\n  return new Device({\n    widthMeters: metersPerPixelX * width,\n    heightMeters: metersPerPixelY * height,\n    bevelMeters: deviceParams.bevelMm * 0.001,\n  });\n};\n\n/**\n * Calculates field of view for the left eye.\n */\nDeviceInfo.prototype.getDistortedFieldOfViewLeftEye = function() {\n  var viewer = this.viewer;\n  var device = this.device;\n  var distortion = this.distortion;\n\n  // Device.height and device.width for device in portrait mode, so transpose.\n  var eyeToScreenDistance = viewer.screenLensDistance;\n\n  var outerDist = (device.widthMeters - viewer.interLensDistance) / 2;\n  var innerDist = viewer.interLensDistance / 2;\n  var bottomDist = viewer.baselineLensDistance - device.bevelMeters;\n  var topDist = device.heightMeters - bottomDist;\n\n  var outerAngle = MathUtil.radToDeg * Math.atan(\n      distortion.distort(outerDist / eyeToScreenDistance));\n  var innerAngle = MathUtil.radToDeg * Math.atan(\n      distortion.distort(innerDist / eyeToScreenDistance));\n  var bottomAngle = MathUtil.radToDeg * Math.atan(\n      distortion.distort(bottomDist / eyeToScreenDistance));\n  var topAngle = MathUtil.radToDeg * Math.atan(\n      distortion.distort(topDist / eyeToScreenDistance));\n\n  return {\n    leftDegrees: Math.min(outerAngle, viewer.fov),\n    rightDegrees: Math.min(innerAngle, viewer.fov),\n    downDegrees: Math.min(bottomAngle, viewer.fov),\n    upDegrees: Math.min(topAngle, viewer.fov)\n  };\n};\n\n/**\n * Calculates the tan-angles from the maximum FOV for the left eye for the\n * current device and screen parameters.\n */\nDeviceInfo.prototype.getLeftEyeVisibleTanAngles = function() {\n  var viewer = this.viewer;\n  var device = this.device;\n  var distortion = this.distortion;\n\n  // Tan-angles from the max FOV.\n  var fovLeft = Math.tan(-MathUtil.degToRad * viewer.fov);\n  var fovTop = Math.tan(MathUtil.degToRad * viewer.fov);\n  var fovRight = Math.tan(MathUtil.degToRad * viewer.fov);\n  var fovBottom = Math.tan(-MathUtil.degToRad * viewer.fov);\n  // Viewport size.\n  var halfWidth = device.widthMeters / 4;\n  var halfHeight = device.heightMeters / 2;\n  // Viewport center, measured from left lens position.\n  var verticalLensOffset = (viewer.baselineLensDistance - device.bevelMeters - halfHeight);\n  var centerX = viewer.interLensDistance / 2 - halfWidth;\n  var centerY = -verticalLensOffset;\n  var centerZ = viewer.screenLensDistance;\n  // Tan-angles of the viewport edges, as seen through the lens.\n  var screenLeft = distortion.distort((centerX - halfWidth) / centerZ);\n  var screenTop = distortion.distort((centerY + halfHeight) / centerZ);\n  var screenRight = distortion.distort((centerX + halfWidth) / centerZ);\n  var screenBottom = distortion.distort((centerY - halfHeight) / centerZ);\n  // Compare the two sets of tan-angles and take the value closer to zero on each side.\n  var result = new Float32Array(4);\n  result[0] = Math.max(fovLeft, screenLeft);\n  result[1] = Math.min(fovTop, screenTop);\n  result[2] = Math.min(fovRight, screenRight);\n  result[3] = Math.max(fovBottom, screenBottom);\n  return result;\n};\n\n/**\n * Calculates the tan-angles from the maximum FOV for the left eye for the\n * current device and screen parameters, assuming no lenses.\n */\nDeviceInfo.prototype.getLeftEyeNoLensTanAngles = function() {\n  var viewer = this.viewer;\n  var device = this.device;\n  var distortion = this.distortion;\n\n  var result = new Float32Array(4);\n  // Tan-angles from the max FOV.\n  var fovLeft = distortion.distortInverse(Math.tan(-MathUtil.degToRad * viewer.fov));\n  var fovTop = distortion.distortInverse(Math.tan(MathUtil.degToRad * viewer.fov));\n  var fovRight = distortion.distortInverse(Math.tan(MathUtil.degToRad * viewer.fov));\n  var fovBottom = distortion.distortInverse(Math.tan(-MathUtil.degToRad * viewer.fov));\n  // Viewport size.\n  var halfWidth = device.widthMeters / 4;\n  var halfHeight = device.heightMeters / 2;\n  // Viewport center, measured from left lens position.\n  var verticalLensOffset = (viewer.baselineLensDistance - device.bevelMeters - halfHeight);\n  var centerX = viewer.interLensDistance / 2 - halfWidth;\n  var centerY = -verticalLensOffset;\n  var centerZ = viewer.screenLensDistance;\n  // Tan-angles of the viewport edges, as seen through the lens.\n  var screenLeft = (centerX - halfWidth) / centerZ;\n  var screenTop = (centerY + halfHeight) / centerZ;\n  var screenRight = (centerX + halfWidth) / centerZ;\n  var screenBottom = (centerY - halfHeight) / centerZ;\n  // Compare the two sets of tan-angles and take the value closer to zero on each side.\n  result[0] = Math.max(fovLeft, screenLeft);\n  result[1] = Math.min(fovTop, screenTop);\n  result[2] = Math.min(fovRight, screenRight);\n  result[3] = Math.max(fovBottom, screenBottom);\n  return result;\n};\n\n/**\n * Calculates the screen rectangle visible from the left eye for the\n * current device and screen parameters.\n */\nDeviceInfo.prototype.getLeftEyeVisibleScreenRect = function(undistortedFrustum) {\n  var viewer = this.viewer;\n  var device = this.device;\n\n  var dist = viewer.screenLensDistance;\n  var eyeX = (device.widthMeters - viewer.interLensDistance) / 2;\n  var eyeY = viewer.baselineLensDistance - device.bevelMeters;\n  var left = (undistortedFrustum[0] * dist + eyeX) / device.widthMeters;\n  var top = (undistortedFrustum[1] * dist + eyeY) / device.heightMeters;\n  var right = (undistortedFrustum[2] * dist + eyeX) / device.widthMeters;\n  var bottom = (undistortedFrustum[3] * dist + eyeY) / device.heightMeters;\n  return {\n    x: left,\n    y: bottom,\n    width: right - left,\n    height: top - bottom\n  };\n};\n\nDeviceInfo.prototype.getFieldOfViewLeftEye = function(opt_isUndistorted) {\n  return opt_isUndistorted ? this.getUndistortedFieldOfViewLeftEye() :\n      this.getDistortedFieldOfViewLeftEye();\n};\n\nDeviceInfo.prototype.getFieldOfViewRightEye = function(opt_isUndistorted) {\n  var fov = this.getFieldOfViewLeftEye(opt_isUndistorted);\n  return {\n    leftDegrees: fov.rightDegrees,\n    rightDegrees: fov.leftDegrees,\n    upDegrees: fov.upDegrees,\n    downDegrees: fov.downDegrees\n  };\n};\n\n/**\n * Calculates undistorted field of view for the left eye.\n */\nDeviceInfo.prototype.getUndistortedFieldOfViewLeftEye = function() {\n  var p = this.getUndistortedParams_();\n\n  return {\n    leftDegrees: MathUtil.radToDeg * Math.atan(p.outerDist),\n    rightDegrees: MathUtil.radToDeg * Math.atan(p.innerDist),\n    downDegrees: MathUtil.radToDeg * Math.atan(p.bottomDist),\n    upDegrees: MathUtil.radToDeg * Math.atan(p.topDist)\n  };\n};\n\nDeviceInfo.prototype.getUndistortedViewportLeftEye = function() {\n  var p = this.getUndistortedParams_();\n  var viewer = this.viewer;\n  var device = this.device;\n\n  // Distances stored in local variables are in tan-angle units unless otherwise\n  // noted.\n  var eyeToScreenDistance = viewer.screenLensDistance;\n  var screenWidth = device.widthMeters / eyeToScreenDistance;\n  var screenHeight = device.heightMeters / eyeToScreenDistance;\n  var xPxPerTanAngle = device.width / screenWidth;\n  var yPxPerTanAngle = device.height / screenHeight;\n\n  var x = Math.round((p.eyePosX - p.outerDist) * xPxPerTanAngle);\n  var y = Math.round((p.eyePosY - p.bottomDist) * yPxPerTanAngle);\n  return {\n    x: x,\n    y: y,\n    width: Math.round((p.eyePosX + p.innerDist) * xPxPerTanAngle) - x,\n    height: Math.round((p.eyePosY + p.topDist) * yPxPerTanAngle) - y\n  };\n};\n\nDeviceInfo.prototype.getUndistortedParams_ = function() {\n  var viewer = this.viewer;\n  var device = this.device;\n  var distortion = this.distortion;\n\n  // Most of these variables in tan-angle units.\n  var eyeToScreenDistance = viewer.screenLensDistance;\n  var halfLensDistance = viewer.interLensDistance / 2 / eyeToScreenDistance;\n  var screenWidth = device.widthMeters / eyeToScreenDistance;\n  var screenHeight = device.heightMeters / eyeToScreenDistance;\n\n  var eyePosX = screenWidth / 2 - halfLensDistance;\n  var eyePosY = (viewer.baselineLensDistance - device.bevelMeters) / eyeToScreenDistance;\n\n  var maxFov = viewer.fov;\n  var viewerMax = distortion.distortInverse(Math.tan(MathUtil.degToRad * maxFov));\n  var outerDist = Math.min(eyePosX, viewerMax);\n  var innerDist = Math.min(halfLensDistance, viewerMax);\n  var bottomDist = Math.min(eyePosY, viewerMax);\n  var topDist = Math.min(screenHeight - eyePosY, viewerMax);\n\n  return {\n    outerDist: outerDist,\n    innerDist: innerDist,\n    topDist: topDist,\n    bottomDist: bottomDist,\n    eyePosX: eyePosX,\n    eyePosY: eyePosY\n  };\n};\n\n\nfunction CardboardViewer(params) {\n  // A machine readable ID.\n  this.id = params.id;\n  // A human readable label.\n  this.label = params.label;\n\n  // Field of view in degrees (per side).\n  this.fov = params.fov;\n\n  // Distance between lens centers in meters.\n  this.interLensDistance = params.interLensDistance;\n  // Distance between viewer baseline and lens center in meters.\n  this.baselineLensDistance = params.baselineLensDistance;\n  // Screen-to-lens distance in meters.\n  this.screenLensDistance = params.screenLensDistance;\n\n  // Distortion coefficients.\n  this.distortionCoefficients = params.distortionCoefficients;\n  // Inverse distortion coefficients.\n  // TODO: Calculate these from distortionCoefficients in the future.\n  this.inverseCoefficients = params.inverseCoefficients;\n}\n\n// Export viewer information.\nDeviceInfo.Viewers = Viewers;\nmodule.exports = DeviceInfo;\n\n},{\"./distortion/distortion.js\":9,\"./math-util.js\":14,\"./util.js\":22}],8:[function(_dereq_,module,exports){\n/*\n * Copyright 2016 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar VRDisplay = _dereq_('./base.js').VRDisplay;\nvar HMDVRDevice = _dereq_('./base.js').HMDVRDevice;\nvar PositionSensorVRDevice = _dereq_('./base.js').PositionSensorVRDevice;\n\n/**\n * Wraps a VRDisplay and exposes it as a HMDVRDevice\n */\nfunction VRDisplayHMDDevice(display) {\n  this.display = display;\n\n  this.hardwareUnitId = display.displayId;\n  this.deviceId = 'webvr-polyfill:HMD:' + display.displayId;\n  this.deviceName = display.displayName + ' (HMD)';\n}\nVRDisplayHMDDevice.prototype = new HMDVRDevice();\n\nVRDisplayHMDDevice.prototype.getEyeParameters = function(whichEye) {\n  var eyeParameters = this.display.getEyeParameters(whichEye);\n\n  return {\n    currentFieldOfView: eyeParameters.fieldOfView,\n    maximumFieldOfView: eyeParameters.fieldOfView,\n    minimumFieldOfView: eyeParameters.fieldOfView,\n    recommendedFieldOfView: eyeParameters.fieldOfView,\n    eyeTranslation: { x: eyeParameters.offset[0], y: eyeParameters.offset[1], z: eyeParameters.offset[2] },\n    renderRect: {\n      x: (whichEye == 'right') ? eyeParameters.renderWidth : 0,\n      y: 0,\n      width: eyeParameters.renderWidth,\n      height: eyeParameters.renderHeight\n    }\n  };\n};\n\nVRDisplayHMDDevice.prototype.setFieldOfView =\n    function(opt_fovLeft, opt_fovRight, opt_zNear, opt_zFar) {\n  // Not supported. getEyeParameters reports that the min, max, and recommended\n  // FoV is all the same, so no adjustment can be made.\n};\n\n// TODO: Need to hook requestFullscreen to see if a wrapped VRDisplay was passed\n// in as an option. If so we should prevent the default fullscreen behavior and\n// call VRDisplay.requestPresent instead.\n\n/**\n * Wraps a VRDisplay and exposes it as a PositionSensorVRDevice\n */\nfunction VRDisplayPositionSensorDevice(display) {\n  this.display = display;\n\n  this.hardwareUnitId = display.displayId;\n  this.deviceId = 'webvr-polyfill:PositionSensor: ' + display.displayId;\n  this.deviceName = display.displayName + ' (PositionSensor)';\n}\nVRDisplayPositionSensorDevice.prototype = new PositionSensorVRDevice();\n\nVRDisplayPositionSensorDevice.prototype.getState = function() {\n  var pose = this.display.getPose();\n  return {\n    position: pose.position ? { x: pose.position[0], y: pose.position[1], z: pose.position[2] } : null,\n    orientation: pose.orientation ? { x: pose.orientation[0], y: pose.orientation[1], z: pose.orientation[2], w: pose.orientation[3] } : null,\n    linearVelocity: null,\n    linearAcceleration: null,\n    angularVelocity: null,\n    angularAcceleration: null\n  };\n};\n\nVRDisplayPositionSensorDevice.prototype.resetState = function() {\n  return this.positionDevice.resetPose();\n};\n\n\nmodule.exports.VRDisplayHMDDevice = VRDisplayHMDDevice;\nmodule.exports.VRDisplayPositionSensorDevice = VRDisplayPositionSensorDevice;\n\n\n},{\"./base.js\":2}],9:[function(_dereq_,module,exports){\n/**\n * TODO(smus): Implement coefficient inversion.\n */\nfunction Distortion(coefficients) {\n  this.coefficients = coefficients;\n}\n\n/**\n * Calculates the inverse distortion for a radius.\n * </p><p>\n * Allows to compute the original undistorted radius from a distorted one.\n * See also getApproximateInverseDistortion() for a faster but potentially\n * less accurate method.\n *\n * @param {Number} radius Distorted radius from the lens center in tan-angle units.\n * @return {Number} The undistorted radius in tan-angle units.\n */\nDistortion.prototype.distortInverse = function(radius) {\n  // Secant method.\n  var r0 = 0;\n  var r1 = 1;\n  var dr0 = radius - this.distort(r0);\n  while (Math.abs(r1 - r0) > 0.0001 /** 0.1mm */) {\n    var dr1 = radius - this.distort(r1);\n    var r2 = r1 - dr1 * ((r1 - r0) / (dr1 - dr0));\n    r0 = r1;\n    r1 = r2;\n    dr0 = dr1;\n  }\n  return r1;\n};\n\n/**\n * Distorts a radius by its distortion factor from the center of the lenses.\n *\n * @param {Number} radius Radius from the lens center in tan-angle units.\n * @return {Number} The distorted radius in tan-angle units.\n */\nDistortion.prototype.distort = function(radius) {\n  var r2 = radius * radius;\n  var ret = 0;\n  for (var i = 0; i < this.coefficients.length; i++) {\n    ret = r2 * (ret + this.coefficients[i]);\n  }\n  return (ret + 1) * radius;\n};\n\n// Functions below roughly ported from\n// https://github.com/googlesamples/cardboard-unity/blob/master/Cardboard/Scripts/CardboardProfile.cs#L412\n\n// Solves a small linear equation via destructive gaussian\n// elimination and back substitution.  This isn't generic numeric\n// code, it's just a quick hack to work with the generally\n// well-behaved symmetric matrices for least-squares fitting.\n// Not intended for reuse.\n//\n// @param a Input positive definite symmetrical matrix. Destroyed\n//     during calculation.\n// @param y Input right-hand-side values. Destroyed during calculation.\n// @return Resulting x value vector.\n//\nDistortion.prototype.solveLinear_ = function(a, y) {\n  var n = a.length;\n\n  // Gaussian elimination (no row exchange) to triangular matrix.\n  // The input matrix is a A^T A product which should be a positive\n  // definite symmetrical matrix, and if I remember my linear\n  // algebra right this implies that the pivots will be nonzero and\n  // calculations sufficiently accurate without needing row\n  // exchange.\n  for (var j = 0; j < n - 1; ++j) {\n    for (var k = j + 1; k < n; ++k) {\n      var p = a[j][k] / a[j][j];\n      for (var i = j + 1; i < n; ++i) {\n        a[i][k] -= p * a[i][j];\n      }\n      y[k] -= p * y[j];\n    }\n  }\n  // From this point on, only the matrix elements a[j][i] with i>=j are\n  // valid. The elimination doesn't fill in eliminated 0 values.\n\n  var x = new Array(n);\n\n  // Back substitution.\n  for (var j = n - 1; j >= 0; --j) {\n    var v = y[j];\n    for (var i = j + 1; i < n; ++i) {\n      v -= a[i][j] * x[i];\n    }\n    x[j] = v / a[j][j];\n  }\n\n  return x;\n};\n\n// Solves a least-squares matrix equation.  Given the equation A * x = y, calculate the\n// least-square fit x = inverse(A * transpose(A)) * transpose(A) * y.  The way this works\n// is that, while A is typically not a square matrix (and hence not invertible), A * transpose(A)\n// is always square.  That is:\n//   A * x = y\n//   transpose(A) * (A * x) = transpose(A) * y   <- multiply both sides by transpose(A)\n//   (transpose(A) * A) * x = transpose(A) * y   <- associativity\n//   x = inverse(transpose(A) * A) * transpose(A) * y  <- solve for x\n// Matrix A's row count (first index) must match y's value count.  A's column count (second index)\n// determines the length of the result vector x.\nDistortion.prototype.solveLeastSquares_ = function(matA, vecY) {\n  var i, j, k, sum;\n  var numSamples = matA.length;\n  var numCoefficients = matA[0].length;\n  if (numSamples != vecY.Length) {\n    throw new Error(\"Matrix / vector dimension mismatch\");\n  }\n\n  // Calculate transpose(A) * A\n  var matATA = new Array(numCoefficients);\n  for (k = 0; k < numCoefficients; ++k) {\n    matATA[k] = new Array(numCoefficients);\n    for (j = 0; j < numCoefficients; ++j) {\n      sum = 0;\n      for (i = 0; i < numSamples; ++i) {\n        sum += matA[j][i] * matA[k][i];\n      }\n      matATA[k][j] = sum;\n    }\n  }\n\n  // Calculate transpose(A) * y\n  var vecATY = new Array(numCoefficients);\n  for (j = 0; j < numCoefficients; ++j) {\n    sum = 0;\n    for (i = 0; i < numSamples; ++i) {\n      sum += matA[j][i] * vecY[i];\n    }\n    vecATY[j] = sum;\n  }\n\n  // Now solve (A * transpose(A)) * x = transpose(A) * y.\n  return this.solveLinear_(matATA, vecATY);\n};\n\n/// Calculates an approximate inverse to the given radial distortion parameters.\nDistortion.prototype.approximateInverse = function(maxRadius, numSamples) {\n  maxRadius = maxRadius || 1;\n  numSamples = numSamples || 100;\n  var numCoefficients = 6;\n  var i, j;\n\n  // R + K1*R^3 + K2*R^5 = r, with R = rp = distort(r)\n  // Repeating for numSamples:\n  //   [ R0^3, R0^5 ] * [ K1 ] = [ r0 - R0 ]\n  //   [ R1^3, R1^5 ]   [ K2 ]   [ r1 - R1 ]\n  //   [ R2^3, R2^5 ]            [ r2 - R2 ]\n  //   [ etc... ]                [ etc... ]\n  // That is:\n  //   matA * [K1, K2] = y\n  // Solve:\n  //   [K1, K2] = inverse(transpose(matA) * matA) * transpose(matA) * y\n  var matA = new Array(numCoefficients);\n  for (j = 0; j < numCoefficients; ++j) {\n    matA[j] = new Array(numSamples);\n  }\n  var vecY = new Array(numSamples);\n\n  for (i = 0; i < numSamples; ++i) {\n    var r = maxRadius * (i + 1) / numSamples;\n    var rp = this.distort(r);\n    var v = rp;\n    for (j = 0; j < numCoefficients; ++j) {\n      v *= rp * rp;\n      matA[j][i] = v;\n    }\n    vecY[i] = r - rp;\n  }\n\n  var inverseCoefficients = this.solveLeastSquares_(matA, vecY);\n\n  return new Distortion(inverseCoefficients);\n};\n\nmodule.exports = Distortion;\n\n},{}],10:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * DPDB cache.\n */\nvar DPDB_CACHE = {\n  \"format\": 1,\n  \"last_updated\": \"2016-01-20T00:18:35Z\",\n  \"devices\": [\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"asus/*/Nexus 7/*\" },\n      { \"ua\": \"Nexus 7\" }\n    ],\n    \"dpi\": [ 320.8, 323.0 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"asus/*/ASUS_Z00AD/*\" },\n      { \"ua\": \"ASUS_Z00AD\" }\n    ],\n    \"dpi\": [ 403.0, 404.6 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"HTC/*/HTC6435LVW/*\" },\n      { \"ua\": \"HTC6435LVW\" }\n    ],\n    \"dpi\": [ 449.7, 443.3 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"HTC/*/HTC One XL/*\" },\n      { \"ua\": \"HTC One XL\" }\n    ],\n    \"dpi\": [ 315.3, 314.6 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"htc/*/Nexus 9/*\" },\n      { \"ua\": \"Nexus 9\" }\n    ],\n    \"dpi\": 289.0,\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"HTC/*/HTC One M9/*\" },\n      { \"ua\": \"HTC One M9\" }\n    ],\n    \"dpi\": [ 442.5, 443.3 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"HTC/*/HTC One_M8/*\" },\n      { \"ua\": \"HTC One_M8\" }\n    ],\n    \"dpi\": [ 449.7, 447.4 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"HTC/*/HTC One/*\" },\n      { \"ua\": \"HTC One\" }\n    ],\n    \"dpi\": 472.8,\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"Huawei/*/Nexus 6P/*\" },\n      { \"ua\": \"Nexus 6P\" }\n    ],\n    \"dpi\": [ 515.1, 518.0 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/Nexus 5X/*\" },\n      { \"ua\": \"Nexus 5X\" }\n    ],\n    \"dpi\": [ 422.0, 419.9 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/LGMS345/*\" },\n      { \"ua\": \"LGMS345\" }\n    ],\n    \"dpi\": [ 221.7, 219.1 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/LG-D800/*\" },\n      { \"ua\": \"LG-D800\" }\n    ],\n    \"dpi\": [ 422.0, 424.1 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/LG-D850/*\" },\n      { \"ua\": \"LG-D850\" }\n    ],\n    \"dpi\": [ 537.9, 541.9 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/VS985 4G/*\" },\n      { \"ua\": \"VS985 4G\" }\n    ],\n    \"dpi\": [ 537.9, 535.6 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/Nexus 5/*\" },\n      { \"ua\": \"Nexus 5 \" }\n    ],\n    \"dpi\": [ 442.4, 444.8 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/Nexus 4/*\" },\n      { \"ua\": \"Nexus 4\" }\n    ],\n    \"dpi\": [ 319.8, 318.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/LG-P769/*\" },\n      { \"ua\": \"LG-P769\" }\n    ],\n    \"dpi\": [ 240.6, 247.5 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/LGMS323/*\" },\n      { \"ua\": \"LGMS323\" }\n    ],\n    \"dpi\": [ 206.6, 204.6 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"LGE/*/LGLS996/*\" },\n      { \"ua\": \"LGLS996\" }\n    ],\n    \"dpi\": [ 403.4, 401.5 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"Micromax/*/4560MMX/*\" },\n      { \"ua\": \"4560MMX\" }\n    ],\n    \"dpi\": [ 240.0, 219.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"Micromax/*/A250/*\" },\n      { \"ua\": \"Micromax A250\" }\n    ],\n    \"dpi\": [ 480.0, 446.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"Micromax/*/Micromax AQ4501/*\" },\n      { \"ua\": \"Micromax AQ4501\" }\n    ],\n    \"dpi\": 240.0,\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/DROID RAZR/*\" },\n      { \"ua\": \"DROID RAZR\" }\n    ],\n    \"dpi\": [ 368.1, 256.7 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT830C/*\" },\n      { \"ua\": \"XT830C\" }\n    ],\n    \"dpi\": [ 254.0, 255.9 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1021/*\" },\n      { \"ua\": \"XT1021\" }\n    ],\n    \"dpi\": [ 254.0, 256.7 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1023/*\" },\n      { \"ua\": \"XT1023\" }\n    ],\n    \"dpi\": [ 254.0, 256.7 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1028/*\" },\n      { \"ua\": \"XT1028\" }\n    ],\n    \"dpi\": [ 326.6, 327.6 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1034/*\" },\n      { \"ua\": \"XT1034\" }\n    ],\n    \"dpi\": [ 326.6, 328.4 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1053/*\" },\n      { \"ua\": \"XT1053\" }\n    ],\n    \"dpi\": [ 315.3, 316.1 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1562/*\" },\n      { \"ua\": \"XT1562\" }\n    ],\n    \"dpi\": [ 403.4, 402.7 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/Nexus 6/*\" },\n      { \"ua\": \"Nexus 6 \" }\n    ],\n    \"dpi\": [ 494.3, 489.7 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1063/*\" },\n      { \"ua\": \"XT1063\" }\n    ],\n    \"dpi\": [ 295.0, 296.6 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1064/*\" },\n      { \"ua\": \"XT1064\" }\n    ],\n    \"dpi\": [ 295.0, 295.6 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1092/*\" },\n      { \"ua\": \"XT1092\" }\n    ],\n    \"dpi\": [ 422.0, 424.1 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"motorola/*/XT1095/*\" },\n      { \"ua\": \"XT1095\" }\n    ],\n    \"dpi\": [ 422.0, 423.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"OnePlus/*/A0001/*\" },\n      { \"ua\": \"A0001\" }\n    ],\n    \"dpi\": [ 403.4, 401.0 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"OnePlus/*/ONE E1005/*\" },\n      { \"ua\": \"ONE E1005\" }\n    ],\n    \"dpi\": [ 442.4, 441.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"OnePlus/*/ONE A2005/*\" },\n      { \"ua\": \"ONE A2005\" }\n    ],\n    \"dpi\": [ 391.9, 405.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"OPPO/*/X909/*\" },\n      { \"ua\": \"X909\" }\n    ],\n    \"dpi\": [ 442.4, 444.1 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/GT-I9082/*\" },\n      { \"ua\": \"GT-I9082\" }\n    ],\n    \"dpi\": [ 184.7, 185.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G360P/*\" },\n      { \"ua\": \"SM-G360P\" }\n    ],\n    \"dpi\": [ 196.7, 205.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/Nexus S/*\" },\n      { \"ua\": \"Nexus S\" }\n    ],\n    \"dpi\": [ 234.5, 229.8 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/GT-I9300/*\" },\n      { \"ua\": \"GT-I9300\" }\n    ],\n    \"dpi\": [ 304.8, 303.9 ],\n    \"bw\": 5,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-T230NU/*\" },\n      { \"ua\": \"SM-T230NU\" }\n    ],\n    \"dpi\": 216.0,\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SGH-T399/*\" },\n      { \"ua\": \"SGH-T399\" }\n    ],\n    \"dpi\": [ 217.7, 231.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-N9005/*\" },\n      { \"ua\": \"SM-N9005\" }\n    ],\n    \"dpi\": [ 386.4, 387.0 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SAMSUNG-SM-N900A/*\" },\n      { \"ua\": \"SAMSUNG-SM-N900A\" }\n    ],\n    \"dpi\": [ 386.4, 387.7 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/GT-I9500/*\" },\n      { \"ua\": \"GT-I9500\" }\n    ],\n    \"dpi\": [ 442.5, 443.3 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/GT-I9505/*\" },\n      { \"ua\": \"GT-I9505\" }\n    ],\n    \"dpi\": 439.4,\n    \"bw\": 4,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G900F/*\" },\n      { \"ua\": \"SM-G900F\" }\n    ],\n    \"dpi\": [ 415.6, 431.6 ],\n    \"bw\": 5,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G900M/*\" },\n      { \"ua\": \"SM-G900M\" }\n    ],\n    \"dpi\": [ 415.6, 431.6 ],\n    \"bw\": 5,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G800F/*\" },\n      { \"ua\": \"SM-G800F\" }\n    ],\n    \"dpi\": 326.8,\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G906S/*\" },\n      { \"ua\": \"SM-G906S\" }\n    ],\n    \"dpi\": [ 562.7, 572.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/GT-I9300/*\" },\n      { \"ua\": \"GT-I9300\" }\n    ],\n    \"dpi\": [ 306.7, 304.8 ],\n    \"bw\": 5,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-T535/*\" },\n      { \"ua\": \"SM-T535\" }\n    ],\n    \"dpi\": [ 142.6, 136.4 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-N920C/*\" },\n      { \"ua\": \"SM-N920C\" }\n    ],\n    \"dpi\": [ 515.1, 518.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/GT-I9300I/*\" },\n      { \"ua\": \"GT-I9300I\" }\n    ],\n    \"dpi\": [ 304.8, 305.8 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/GT-I9195/*\" },\n      { \"ua\": \"GT-I9195\" }\n    ],\n    \"dpi\": [ 249.4, 256.7 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SPH-L520/*\" },\n      { \"ua\": \"SPH-L520\" }\n    ],\n    \"dpi\": [ 249.4, 255.9 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SAMSUNG-SGH-I717/*\" },\n      { \"ua\": \"SAMSUNG-SGH-I717\" }\n    ],\n    \"dpi\": 285.8,\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SPH-D710/*\" },\n      { \"ua\": \"SPH-D710\" }\n    ],\n    \"dpi\": [ 217.7, 204.2 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/GT-N7100/*\" },\n      { \"ua\": \"GT-N7100\" }\n    ],\n    \"dpi\": 265.1,\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SCH-I605/*\" },\n      { \"ua\": \"SCH-I605\" }\n    ],\n    \"dpi\": 265.1,\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/Galaxy Nexus/*\" },\n      { \"ua\": \"Galaxy Nexus\" }\n    ],\n    \"dpi\": [ 315.3, 314.2 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-N910H/*\" },\n      { \"ua\": \"SM-N910H\" }\n    ],\n    \"dpi\": [ 515.1, 518.0 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-N910C/*\" },\n      { \"ua\": \"SM-N910C\" }\n    ],\n    \"dpi\": [ 515.2, 520.2 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G130M/*\" },\n      { \"ua\": \"SM-G130M\" }\n    ],\n    \"dpi\": [ 165.9, 164.8 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G928I/*\" },\n      { \"ua\": \"SM-G928I\" }\n    ],\n    \"dpi\": [ 515.1, 518.4 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G920F/*\" },\n      { \"ua\": \"SM-G920F\" }\n    ],\n    \"dpi\": 580.6,\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G920P/*\" },\n      { \"ua\": \"SM-G920P\" }\n    ],\n    \"dpi\": [ 522.5, 577.0 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G925F/*\" },\n      { \"ua\": \"SM-G925F\" }\n    ],\n    \"dpi\": 580.6,\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"samsung/*/SM-G925V/*\" },\n      { \"ua\": \"SM-G925V\" }\n    ],\n    \"dpi\": [ 522.5, 576.6 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"Sony/*/C6903/*\" },\n      { \"ua\": \"C6903\" }\n    ],\n    \"dpi\": [ 442.5, 443.3 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"Sony/*/D6653/*\" },\n      { \"ua\": \"D6653\" }\n    ],\n    \"dpi\": [ 428.6, 427.6 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"Sony/*/E6653/*\" },\n      { \"ua\": \"E6653\" }\n    ],\n    \"dpi\": [ 428.6, 425.7 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"Sony/*/E6853/*\" },\n      { \"ua\": \"E6853\" }\n    ],\n    \"dpi\": [ 403.4, 401.9 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"Sony/*/SGP321/*\" },\n      { \"ua\": \"SGP321\" }\n    ],\n    \"dpi\": [ 224.7, 224.1 ],\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"TCT/*/ALCATEL ONE TOUCH Fierce/*\" },\n      { \"ua\": \"ALCATEL ONE TOUCH Fierce\" }\n    ],\n    \"dpi\": [ 240.0, 247.5 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"THL/*/thl 5000/*\" },\n      { \"ua\": \"thl 5000\" }\n    ],\n    \"dpi\": [ 480.0, 443.3 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"android\",\n    \"rules\": [\n      { \"mdmh\": \"ZTE/*/ZTE Blade L2/*\" },\n      { \"ua\": \"ZTE Blade L2\" }\n    ],\n    \"dpi\": 240.0,\n    \"bw\": 3,\n    \"ac\": 500\n  },\n\n  {\n    \"type\": \"ios\",\n    \"rules\": [ { \"res\": [ 640, 960 ] } ],\n    \"dpi\": [ 325.1, 328.4 ],\n    \"bw\": 4,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"ios\",\n    \"rules\": [ { \"res\": [ 640, 960 ] } ],\n    \"dpi\": [ 325.1, 328.4 ],\n    \"bw\": 4,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"ios\",\n    \"rules\": [ { \"res\": [ 640, 1136 ] } ],\n    \"dpi\": [ 317.1, 320.2 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"ios\",\n    \"rules\": [ { \"res\": [ 640, 1136 ] } ],\n    \"dpi\": [ 317.1, 320.2 ],\n    \"bw\": 3,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"ios\",\n    \"rules\": [ { \"res\": [ 750, 1334 ] } ],\n    \"dpi\": 326.4,\n    \"bw\": 4,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"ios\",\n    \"rules\": [ { \"res\": [ 750, 1334 ] } ],\n    \"dpi\": 326.4,\n    \"bw\": 4,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"ios\",\n    \"rules\": [ { \"res\": [ 1242, 2208 ] } ],\n    \"dpi\": [ 453.6, 458.4 ],\n    \"bw\": 4,\n    \"ac\": 1000\n  },\n\n  {\n    \"type\": \"ios\",\n    \"rules\": [ { \"res\": [ 1242, 2208 ] } ],\n    \"dpi\": [ 453.6, 458.4 ],\n    \"bw\": 4,\n    \"ac\": 1000\n  }\n]};\n\nmodule.exports = DPDB_CACHE;\n\n},{}],11:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Offline cache of the DPDB, to be used until we load the online one (and\n// as a fallback in case we can't load the online one).\nvar DPDB_CACHE = _dereq_('./dpdb-cache.js');\nvar Util = _dereq_('../util.js');\n\n// Online DPDB URL.\nvar ONLINE_DPDB_URL = 'https://storage.googleapis.com/cardboard-dpdb/dpdb.json';\n\n/**\n * Calculates device parameters based on the DPDB (Device Parameter Database).\n * Initially, uses the cached DPDB values.\n *\n * If fetchOnline == true, then this object tries to fetch the online version\n * of the DPDB and updates the device info if a better match is found.\n * Calls the onDeviceParamsUpdated callback when there is an update to the\n * device information.\n */\nfunction Dpdb(fetchOnline, onDeviceParamsUpdated) {\n  // Start with the offline DPDB cache while we are loading the real one.\n  this.dpdb = DPDB_CACHE;\n\n  // Calculate device params based on the offline version of the DPDB.\n  this.recalculateDeviceParams_();\n\n  // XHR to fetch online DPDB file, if requested.\n  if (fetchOnline) {\n    // Set the callback.\n    this.onDeviceParamsUpdated = onDeviceParamsUpdated;\n\n    console.log('Fetching DPDB...');\n    var xhr = new XMLHttpRequest();\n    var obj = this;\n    xhr.open('GET', ONLINE_DPDB_URL, true);\n    xhr.addEventListener('load', function() {\n      obj.loading = false;\n      if (xhr.status >= 200 && xhr.status <= 299) {\n        // Success.\n        console.log('Successfully loaded online DPDB.');\n        obj.dpdb = JSON.parse(xhr.response);\n        obj.recalculateDeviceParams_();\n      } else {\n        // Error loading the DPDB.\n        console.error('Error loading online DPDB!');\n      }\n    });\n    xhr.send();\n  }\n}\n\n// Returns the current device parameters.\nDpdb.prototype.getDeviceParams = function() {\n  return this.deviceParams;\n};\n\n// Recalculates this device's parameters based on the DPDB.\nDpdb.prototype.recalculateDeviceParams_ = function() {\n  console.log('Recalculating device params.');\n  var newDeviceParams = this.calcDeviceParams_();\n  console.log('New device parameters:');\n  console.log(newDeviceParams);\n  if (newDeviceParams) {\n    this.deviceParams = newDeviceParams;\n    // Invoke callback, if it is set.\n    if (this.onDeviceParamsUpdated) {\n      this.onDeviceParamsUpdated(this.deviceParams);\n    }\n  } else {\n    console.error('Failed to recalculate device parameters.');\n  }\n};\n\n// Returns a DeviceParams object that represents the best guess as to this\n// device's parameters. Can return null if the device does not match any\n// known devices.\nDpdb.prototype.calcDeviceParams_ = function() {\n  var db = this.dpdb; // shorthand\n  if (!db) {\n    console.error('DPDB not available.');\n    return null;\n  }\n  if (db.format != 1) {\n    console.error('DPDB has unexpected format version.');\n    return null;\n  }\n  if (!db.devices || !db.devices.length) {\n    console.error('DPDB does not have a devices section.');\n    return null;\n  }\n\n  // Get the actual user agent and screen dimensions in pixels.\n  var userAgent = navigator.userAgent || navigator.vendor || window.opera;\n  var width = Util.getScreenWidth();\n  var height = Util.getScreenHeight();\n  console.log('User agent: ' + userAgent);\n  console.log('Pixel width: ' + width);\n  console.log('Pixel height: ' + height);\n\n  if (!db.devices) {\n    console.error('DPDB has no devices section.');\n    return null;\n  }\n\n  for (var i = 0; i < db.devices.length; i++) {\n    var device = db.devices[i];\n    if (!device.rules) {\n      console.warn('Device[' + i + '] has no rules section.');\n      continue;\n    }\n\n    if (device.type != 'ios' && device.type != 'android') {\n      console.warn('Device[' + i + '] has invalid type.');\n      continue;\n    }\n\n    // See if this device is of the appropriate type.\n    if (Util.isIOS() != (device.type == 'ios')) continue;\n\n    // See if this device matches any of the rules:\n    var matched = false;\n    for (var j = 0; j < device.rules.length; j++) {\n      var rule = device.rules[j];\n      if (this.matchRule_(rule, userAgent, width, height)) {\n        console.log('Rule matched:');\n        console.log(rule);\n        matched = true;\n        break;\n      }\n    }\n    if (!matched) continue;\n\n    // device.dpi might be an array of [ xdpi, ydpi] or just a scalar.\n    var xdpi = device.dpi[0] || device.dpi;\n    var ydpi = device.dpi[1] || device.dpi;\n\n    return new DeviceParams({ xdpi: xdpi, ydpi: ydpi, bevelMm: device.bw });\n  }\n\n  console.warn('No DPDB device match.');\n  return null;\n};\n\nDpdb.prototype.matchRule_ = function(rule, ua, screenWidth, screenHeight) {\n  // We can only match 'ua' and 'res' rules, not other types like 'mdmh'\n  // (which are meant for native platforms).\n  if (!rule.ua && !rule.res) return false;\n\n  // If our user agent string doesn't contain the indicated user agent string,\n  // the match fails.\n  if (rule.ua && ua.indexOf(rule.ua) < 0) return false;\n\n  // If the rule specifies screen dimensions that don't correspond to ours,\n  // the match fails.\n  if (rule.res) {\n    if (!rule.res[0] || !rule.res[1]) return false;\n    var resX = rule.res[0];\n    var resY = rule.res[1];\n    // Compare min and max so as to make the order not matter, i.e., it should\n    // be true that 640x480 == 480x640.\n    if (Math.min(screenWidth, screenHeight) != Math.min(resX, resY) ||\n        (Math.max(screenWidth, screenHeight) != Math.max(resX, resY))) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction DeviceParams(params) {\n  this.xdpi = params.xdpi;\n  this.ydpi = params.ydpi;\n  this.bevelMm = params.bevelMm;\n}\n\nmodule.exports = Dpdb;\n},{\"../util.js\":22,\"./dpdb-cache.js\":10}],12:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nfunction Emitter() {\n  this.callbacks = {};\n}\n\nEmitter.prototype.emit = function(eventName) {\n  var callbacks = this.callbacks[eventName];\n  if (!callbacks) {\n    //console.log('No valid callback specified.');\n    return;\n  }\n  var args = [].slice.call(arguments);\n  // Eliminate the first param (the callback).\n  args.shift();\n  for (var i = 0; i < callbacks.length; i++) {\n    callbacks[i].apply(this, args);\n  }\n};\n\nEmitter.prototype.on = function(eventName, callback) {\n  if (eventName in this.callbacks) {\n    this.callbacks[eventName].push(callback);\n  } else {\n    this.callbacks[eventName] = [callback];\n  }\n};\n\nmodule.exports = Emitter;\n\n},{}],13:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar Util = _dereq_('./util.js');\nvar WebVRPolyfill = _dereq_('./webvr-polyfill.js').WebVRPolyfill;\n\n// Initialize a WebVRConfig just in case.\nwindow.WebVRConfig = Util.extend({\n  // Forces availability of VR mode, even for non-mobile devices.\n  FORCE_ENABLE_VR: false,\n\n  // Complementary filter coefficient. 0 for accelerometer, 1 for gyro.\n  K_FILTER: 0.98,\n\n  // How far into the future to predict during fast motion (in seconds).\n  PREDICTION_TIME_S: 0.040,\n\n  // Flag to enable touch panner. In case you have your own touch controls.\n  TOUCH_PANNER_DISABLED: true,\n\n  // Flag to disabled the UI in VR Mode.\n  CARDBOARD_UI_DISABLED: false, // Default: false\n\n  // Flag to disable the instructions to rotate your device.\n  ROTATE_INSTRUCTIONS_DISABLED: false, // Default: false.\n\n  // Enable yaw panning only, disabling roll and pitch. This can be useful\n  // for panoramas with nothing interesting above or below.\n  YAW_ONLY: false,\n\n  // To disable keyboard and mouse controls, if you want to use your own\n  // implementation.\n  MOUSE_KEYBOARD_CONTROLS_DISABLED: false,\n\n  // Prevent the polyfill from initializing immediately. Requires the app\n  // to call InitializeWebVRPolyfill() before it can be used.\n  DEFER_INITIALIZATION: false,\n\n  // Enable the deprecated version of the API (navigator.getVRDevices).\n  ENABLE_DEPRECATED_API: false,\n\n  // Scales the recommended buffer size reported by WebVR, which can improve\n  // performance.\n  // UPDATE(2016-05-03): Setting this to 0.5 by default since 1.0 does not\n  // perform well on many mobile devices.\n  BUFFER_SCALE: 0.5,\n\n  // Allow VRDisplay.submitFrame to change gl bindings, which is more\n  // efficient if the application code will re-bind its resources on the\n  // next frame anyway. This has been seen to cause rendering glitches with\n  // THREE.js.\n  // Dirty bindings include: gl.FRAMEBUFFER_BINDING, gl.CURRENT_PROGRAM,\n  // gl.ARRAY_BUFFER_BINDING, gl.ELEMENT_ARRAY_BUFFER_BINDING,\n  // and gl.TEXTURE_BINDING_2D for texture unit 0.\n  DIRTY_SUBMIT_FRAME_BINDINGS: false\n}, window.WebVRConfig);\n\nif (!window.WebVRConfig.DEFER_INITIALIZATION) {\n  new WebVRPolyfill();\n} else {\n  window.InitializeWebVRPolyfill = function() {\n    new WebVRPolyfill();\n  }\n}\n\n},{\"./util.js\":22,\"./webvr-polyfill.js\":25}],14:[function(_dereq_,module,exports){\n/*\n * Copyright 2016 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar MathUtil = window.MathUtil || {};\n\nMathUtil.degToRad = Math.PI / 180;\nMathUtil.radToDeg = 180 / Math.PI;\n\n// Some minimal math functionality borrowed from THREE.Math and stripped down\n// for the purposes of this library.\n\n\nMathUtil.Vector2 = function ( x, y ) {\n  this.x = x || 0;\n  this.y = y || 0;\n};\n\nMathUtil.Vector2.prototype = {\n  constructor: MathUtil.Vector2,\n\n  set: function ( x, y ) {\n    this.x = x;\n    this.y = y;\n\n    return this;\n  },\n\n  copy: function ( v ) {\n    this.x = v.x;\n    this.y = v.y;\n\n    return this;\n  },\n\n  subVectors: function ( a, b ) {\n    this.x = a.x - b.x;\n    this.y = a.y - b.y;\n\n    return this;\n  },\n};\n\nMathUtil.Vector3 = function ( x, y, z ) {\n  this.x = x || 0;\n  this.y = y || 0;\n  this.z = z || 0;\n};\n\nMathUtil.Vector3.prototype = {\n  constructor: MathUtil.Vector3,\n\n  set: function ( x, y, z ) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n\n    return this;\n  },\n\n  copy: function ( v ) {\n    this.x = v.x;\n    this.y = v.y;\n    this.z = v.z;\n\n    return this;\n  },\n\n  length: function () {\n    return Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n  },\n\n  normalize: function () {\n    var scalar = this.length();\n\n    if ( scalar !== 0 ) {\n      var invScalar = 1 / scalar;\n\n      this.multiplyScalar(invScalar);\n    } else {\n      this.x = 0;\n      this.y = 0;\n      this.z = 0;\n    }\n\n    return this;\n  },\n\n  multiplyScalar: function ( scalar ) {\n    this.x *= scalar;\n    this.y *= scalar;\n    this.z *= scalar;\n  },\n\n  applyQuaternion: function ( q ) {\n    var x = this.x;\n    var y = this.y;\n    var z = this.z;\n\n    var qx = q.x;\n    var qy = q.y;\n    var qz = q.z;\n    var qw = q.w;\n\n    // calculate quat * vector\n    var ix =  qw * x + qy * z - qz * y;\n    var iy =  qw * y + qz * x - qx * z;\n    var iz =  qw * z + qx * y - qy * x;\n    var iw = - qx * x - qy * y - qz * z;\n\n    // calculate result * inverse quat\n    this.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\n    this.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\n    this.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\n\n    return this;\n  },\n\n  dot: function ( v ) {\n    return this.x * v.x + this.y * v.y + this.z * v.z;\n  },\n\n  crossVectors: function ( a, b ) {\n    var ax = a.x, ay = a.y, az = a.z;\n    var bx = b.x, by = b.y, bz = b.z;\n\n    this.x = ay * bz - az * by;\n    this.y = az * bx - ax * bz;\n    this.z = ax * by - ay * bx;\n\n    return this;\n  },\n};\n\nMathUtil.Quaternion = function ( x, y, z, w ) {\n  this.x = x || 0;\n  this.y = y || 0;\n  this.z = z || 0;\n  this.w = ( w !== undefined ) ? w : 1;\n};\n\nMathUtil.Quaternion.prototype = {\n  constructor: MathUtil.Quaternion,\n\n  set: function ( x, y, z, w ) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    this.w = w;\n\n    return this;\n  },\n\n  copy: function ( quaternion ) {\n    this.x = quaternion.x;\n    this.y = quaternion.y;\n    this.z = quaternion.z;\n    this.w = quaternion.w;\n\n    return this;\n  },\n\n  setFromEulerXYZ: function( x, y, z ) {\n    var c1 = Math.cos( x / 2 );\n    var c2 = Math.cos( y / 2 );\n    var c3 = Math.cos( z / 2 );\n    var s1 = Math.sin( x / 2 );\n    var s2 = Math.sin( y / 2 );\n    var s3 = Math.sin( z / 2 );\n\n    this.x = s1 * c2 * c3 + c1 * s2 * s3;\n    this.y = c1 * s2 * c3 - s1 * c2 * s3;\n    this.z = c1 * c2 * s3 + s1 * s2 * c3;\n    this.w = c1 * c2 * c3 - s1 * s2 * s3;\n\n    return this;\n  },\n\n  setFromEulerYXZ: function( x, y, z ) {\n    var c1 = Math.cos( x / 2 );\n    var c2 = Math.cos( y / 2 );\n    var c3 = Math.cos( z / 2 );\n    var s1 = Math.sin( x / 2 );\n    var s2 = Math.sin( y / 2 );\n    var s3 = Math.sin( z / 2 );\n\n    this.x = s1 * c2 * c3 + c1 * s2 * s3;\n    this.y = c1 * s2 * c3 - s1 * c2 * s3;\n    this.z = c1 * c2 * s3 - s1 * s2 * c3;\n    this.w = c1 * c2 * c3 + s1 * s2 * s3;\n\n    return this;\n  },\n\n  setFromAxisAngle: function ( axis, angle ) {\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n    // assumes axis is normalized\n\n    var halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n    this.x = axis.x * s;\n    this.y = axis.y * s;\n    this.z = axis.z * s;\n    this.w = Math.cos( halfAngle );\n\n    return this;\n  },\n\n  multiply: function ( q ) {\n    return this.multiplyQuaternions( this, q );\n  },\n\n  multiplyQuaternions: function ( a, b ) {\n    // from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n    var qax = a.x, qay = a.y, qaz = a.z, qaw = a.w;\n    var qbx = b.x, qby = b.y, qbz = b.z, qbw = b.w;\n\n    this.x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n    this.y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n    this.z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n    this.w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n    return this;\n  },\n\n  inverse: function () {\n    this.x *= -1;\n    this.y *= -1;\n    this.z *= -1;\n\n    this.normalize();\n\n    return this;\n  },\n\n  normalize: function () {\n    var l = Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n    if ( l === 0 ) {\n      this.x = 0;\n      this.y = 0;\n      this.z = 0;\n      this.w = 1;\n    } else {\n      l = 1 / l;\n\n      this.x = this.x * l;\n      this.y = this.y * l;\n      this.z = this.z * l;\n      this.w = this.w * l;\n    }\n\n    return this;\n  },\n\n  slerp: function ( qb, t ) {\n    if ( t === 0 ) return this;\n    if ( t === 1 ) return this.copy( qb );\n\n    var x = this.x, y = this.y, z = this.z, w = this.w;\n\n    // http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n    var cosHalfTheta = w * qb.w + x * qb.x + y * qb.y + z * qb.z;\n\n    if ( cosHalfTheta < 0 ) {\n      this.w = - qb.w;\n      this.x = - qb.x;\n      this.y = - qb.y;\n      this.z = - qb.z;\n\n      cosHalfTheta = - cosHalfTheta;\n    } else {\n      this.copy( qb );\n    }\n\n    if ( cosHalfTheta >= 1.0 ) {\n      this.w = w;\n      this.x = x;\n      this.y = y;\n      this.z = z;\n\n      return this;\n    }\n\n    var halfTheta = Math.acos( cosHalfTheta );\n    var sinHalfTheta = Math.sqrt( 1.0 - cosHalfTheta * cosHalfTheta );\n\n    if ( Math.abs( sinHalfTheta ) < 0.001 ) {\n      this.w = 0.5 * ( w + this.w );\n      this.x = 0.5 * ( x + this.x );\n      this.y = 0.5 * ( y + this.y );\n      this.z = 0.5 * ( z + this.z );\n\n      return this;\n    }\n\n    var ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n    ratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n    this.w = ( w * ratioA + this.w * ratioB );\n    this.x = ( x * ratioA + this.x * ratioB );\n    this.y = ( y * ratioA + this.y * ratioB );\n    this.z = ( z * ratioA + this.z * ratioB );\n\n    return this;\n  },\n\n  setFromUnitVectors: function () {\n    // http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\n    // assumes direction vectors vFrom and vTo are normalized\n\n    var v1, r;\n    var EPS = 0.000001;\n\n    return function ( vFrom, vTo ) {\n      if ( v1 === undefined ) v1 = new MathUtil.Vector3();\n\n      r = vFrom.dot( vTo ) + 1;\n\n      if ( r < EPS ) {\n        r = 0;\n\n        if ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n          v1.set( - vFrom.y, vFrom.x, 0 );\n        } else {\n          v1.set( 0, - vFrom.z, vFrom.y );\n        }\n      } else {\n        v1.crossVectors( vFrom, vTo );\n      }\n\n      this.x = v1.x;\n      this.y = v1.y;\n      this.z = v1.z;\n      this.w = r;\n\n      this.normalize();\n\n      return this;\n    }\n  }(),\n};\n\nmodule.exports = MathUtil;\n\n},{}],15:[function(_dereq_,module,exports){\n/*\n * Copyright 2016 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar VRDisplay = _dereq_('./base.js').VRDisplay;\nvar MathUtil = _dereq_('./math-util.js');\nvar Util = _dereq_('./util.js');\n\n// How much to rotate per key stroke.\nvar KEY_SPEED = 0.15;\nvar KEY_ANIMATION_DURATION = 80;\n\n// How much to rotate for mouse events.\nvar MOUSE_SPEED_X = 0.5;\nvar MOUSE_SPEED_Y = 0.3;\n\n/**\n * VRDisplay based on mouse and keyboard input. Designed for desktops/laptops\n * where orientation events aren't supported. Cannot present.\n */\nfunction MouseKeyboardVRDisplay() {\n  this.displayName = 'Mouse and Keyboard VRDisplay (webvr-polyfill)';\n\n  this.capabilities.hasOrientation = true;\n\n  // Attach to mouse and keyboard events.\n  window.addEventListener('keydown', this.onKeyDown_.bind(this));\n  window.addEventListener('mousemove', this.onMouseMove_.bind(this));\n  window.addEventListener('mousedown', this.onMouseDown_.bind(this));\n  window.addEventListener('mouseup', this.onMouseUp_.bind(this));\n\n  // \"Private\" members.\n  this.phi_ = 0;\n  this.theta_ = 0;\n\n  // Variables for keyboard-based rotation animation.\n  this.targetAngle_ = null;\n  this.angleAnimation_ = null;\n\n  // State variables for calculations.\n  this.orientation_ = new MathUtil.Quaternion();\n\n  // Variables for mouse-based rotation.\n  this.rotateStart_ = new MathUtil.Vector2();\n  this.rotateEnd_ = new MathUtil.Vector2();\n  this.rotateDelta_ = new MathUtil.Vector2();\n  this.isDragging_ = false;\n\n  this.orientationOut_ = new Float32Array(4);\n}\nMouseKeyboardVRDisplay.prototype = new VRDisplay();\n\nMouseKeyboardVRDisplay.prototype.getImmediatePose = function() {\n  this.orientation_.setFromEulerYXZ(this.phi_, this.theta_, 0);\n\n  this.orientationOut_[0] = this.orientation_.x;\n  this.orientationOut_[1] = this.orientation_.y;\n  this.orientationOut_[2] = this.orientation_.z;\n  this.orientationOut_[3] = this.orientation_.w;\n\n  return {\n    position: null,\n    orientation: this.orientationOut_,\n    linearVelocity: null,\n    linearAcceleration: null,\n    angularVelocity: null,\n    angularAcceleration: null\n  };\n};\n\nMouseKeyboardVRDisplay.prototype.onKeyDown_ = function(e) {\n  // Track WASD and arrow keys.\n  if (e.keyCode == 38) { // Up key.\n    this.animatePhi_(this.phi_ + KEY_SPEED);\n  } else if (e.keyCode == 39) { // Right key.\n    this.animateTheta_(this.theta_ - KEY_SPEED);\n  } else if (e.keyCode == 40) { // Down key.\n    this.animatePhi_(this.phi_ - KEY_SPEED);\n  } else if (e.keyCode == 37) { // Left key.\n    this.animateTheta_(this.theta_ + KEY_SPEED);\n  }\n};\n\nMouseKeyboardVRDisplay.prototype.animateTheta_ = function(targetAngle) {\n  this.animateKeyTransitions_('theta_', targetAngle);\n};\n\nMouseKeyboardVRDisplay.prototype.animatePhi_ = function(targetAngle) {\n  // Prevent looking too far up or down.\n  targetAngle = Util.clamp(targetAngle, -Math.PI/2, Math.PI/2);\n  this.animateKeyTransitions_('phi_', targetAngle);\n};\n\n/**\n * Start an animation to transition an angle from one value to another.\n */\nMouseKeyboardVRDisplay.prototype.animateKeyTransitions_ = function(angleName, targetAngle) {\n  // If an animation is currently running, cancel it.\n  if (this.angleAnimation_) {\n    cancelAnimationFrame(this.angleAnimation_);\n  }\n  var startAngle = this[angleName];\n  var startTime = new Date();\n  // Set up an interval timer to perform the animation.\n  this.angleAnimation_ = requestAnimationFrame(function animate() {\n    // Once we're finished the animation, we're done.\n    var elapsed = new Date() - startTime;\n    if (elapsed >= KEY_ANIMATION_DURATION) {\n      this[angleName] = targetAngle;\n      cancelAnimationFrame(this.angleAnimation_);\n      return;\n    }\n    // loop with requestAnimationFrame\n    this.angleAnimation_ = requestAnimationFrame(animate.bind(this))\n    // Linearly interpolate the angle some amount.\n    var percent = elapsed / KEY_ANIMATION_DURATION;\n    this[angleName] = startAngle + (targetAngle - startAngle) * percent;\n  }.bind(this));\n};\n\nMouseKeyboardVRDisplay.prototype.onMouseDown_ = function(e) {\n  this.rotateStart_.set(e.clientX, e.clientY);\n  this.isDragging_ = true;\n};\n\n// Very similar to https://gist.github.com/mrflix/8351020\nMouseKeyboardVRDisplay.prototype.onMouseMove_ = function(e) {\n  if (!this.isDragging_ && !this.isPointerLocked_()) {\n    return;\n  }\n  // Support pointer lock API.\n  if (this.isPointerLocked_()) {\n    var movementX = e.movementX || e.mozMovementX || 0;\n    var movementY = e.movementY || e.mozMovementY || 0;\n    this.rotateEnd_.set(this.rotateStart_.x - movementX, this.rotateStart_.y - movementY);\n  } else {\n    this.rotateEnd_.set(e.clientX, e.clientY);\n  }\n  // Calculate how much we moved in mouse space.\n  this.rotateDelta_.subVectors(this.rotateEnd_, this.rotateStart_);\n  this.rotateStart_.copy(this.rotateEnd_);\n\n  // Keep track of the cumulative euler angles.\n  this.phi_ += 2 * Math.PI * this.rotateDelta_.y / screen.height * MOUSE_SPEED_Y;\n  this.theta_ += 2 * Math.PI * this.rotateDelta_.x / screen.width * MOUSE_SPEED_X;\n\n  // Prevent looking too far up or down.\n  this.phi_ = Util.clamp(this.phi_, -Math.PI/2, Math.PI/2);\n};\n\nMouseKeyboardVRDisplay.prototype.onMouseUp_ = function(e) {\n  this.isDragging_ = false;\n};\n\nMouseKeyboardVRDisplay.prototype.isPointerLocked_ = function() {\n  var el = document.pointerLockElement || document.mozPointerLockElement ||\n      document.webkitPointerLockElement;\n  return el !== undefined;\n};\n\nMouseKeyboardVRDisplay.prototype.resetPose = function() {\n  this.phi_ = 0;\n  this.theta_ = 0;\n};\n\nmodule.exports = MouseKeyboardVRDisplay;\n\n},{\"./base.js\":2,\"./math-util.js\":14,\"./util.js\":22}],16:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar Util = _dereq_('./util.js');\n\nfunction RotateInstructions() {\n  this.loadIcon_();\n\n  var overlay = document.createElement('div');\n  var s = overlay.style;\n  s.position = 'fixed';\n  s.top = 0;\n  s.right = 0;\n  s.bottom = 0;\n  s.left = 0;\n  s.backgroundColor = 'gray';\n  s.fontFamily = 'sans-serif';\n  // Force this to be above the fullscreen canvas, which is at zIndex: 999999.\n  s.zIndex = 1000000;\n\n  var img = document.createElement('img');\n  img.src = this.icon;\n  var s = img.style;\n  s.marginLeft = '25%';\n  s.marginTop = '25%';\n  s.width = '50%';\n  overlay.appendChild(img);\n\n  var text = document.createElement('div');\n  var s = text.style;\n  s.textAlign = 'center';\n  s.fontSize = '16px';\n  s.lineHeight = '24px';\n  s.margin = '24px 25%';\n  s.width = '50%';\n  text.innerHTML = 'Place your phone into your Cardboard viewer.';\n  overlay.appendChild(text);\n\n  var snackbar = document.createElement('div');\n  var s = snackbar.style;\n  s.backgroundColor = '#CFD8DC';\n  s.position = 'fixed';\n  s.bottom = 0;\n  s.width = '100%';\n  s.height = '48px';\n  s.padding = '14px 24px';\n  s.boxSizing = 'border-box';\n  s.color = '#656A6B';\n  overlay.appendChild(snackbar);\n\n  var snackbarText = document.createElement('div');\n  snackbarText.style.float = 'left';\n  snackbarText.innerHTML = 'No Cardboard viewer?';\n\n  var snackbarButton = document.createElement('a');\n  snackbarButton.href = 'https://www.google.com/get/cardboard/get-cardboard/';\n  snackbarButton.innerHTML = 'get one';\n  snackbarButton.target = '_blank';\n  var s = snackbarButton.style;\n  s.float = 'right';\n  s.fontWeight = 600;\n  s.textTransform = 'uppercase';\n  s.borderLeft = '1px solid gray';\n  s.paddingLeft = '24px';\n  s.textDecoration = 'none';\n  s.color = '#656A6B';\n\n  snackbar.appendChild(snackbarText);\n  snackbar.appendChild(snackbarButton);\n\n  this.overlay = overlay;\n  this.text = text;\n\n  this.hide();\n}\n\nRotateInstructions.prototype.show = function(parent) {\n  if (!parent && !this.overlay.parentElement) {\n    document.body.appendChild(this.overlay);\n  } else if (parent) {\n    if (this.overlay.parentElement && this.overlay.parentElement != parent)\n      this.overlay.parentElement.removeChild(this.overlay);\n\n    parent.appendChild(this.overlay);\n  }\n\n  this.overlay.style.display = 'block';\n\n  var img = this.overlay.querySelector('img');\n  var s = img.style;\n\n  if (Util.isLandscapeMode()) {\n    s.width = '20%';\n    s.marginLeft = '40%';\n    s.marginTop = '3%';\n  } else {\n    s.width = '50%';\n    s.marginLeft = '25%';\n    s.marginTop = '25%';\n  }\n};\n\nRotateInstructions.prototype.hide = function() {\n  this.overlay.style.display = 'none';\n};\n\nRotateInstructions.prototype.showTemporarily = function(ms, parent) {\n  this.show(parent);\n  this.timer = setTimeout(this.hide.bind(this), ms);\n};\n\nRotateInstructions.prototype.disableShowTemporarily = function() {\n  clearTimeout(this.timer);\n};\n\nRotateInstructions.prototype.update = function() {\n  this.disableShowTemporarily();\n  // In portrait VR mode, tell the user to rotate to landscape. Otherwise, hide\n  // the instructions.\n  if (!Util.isLandscapeMode() && Util.isMobile()) {\n    this.show();\n  } else {\n    this.hide();\n  }\n};\n\nRotateInstructions.prototype.loadIcon_ = function() {\n  // Encoded asset_src/rotate-instructions.svg\n  this.icon = Util.base64('image/svg+xml', 'PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjE5OHB4IiBoZWlnaHQ9IjI0MHB4IiB2aWV3Qm94PSIwIDAgMTk4IDI0MCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDMuMy4zICgxMjA4MSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+dHJhbnNpdGlvbjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHNrZXRjaDp0eXBlPSJNU1BhZ2UiPgogICAgICAgIDxnIGlkPSJ0cmFuc2l0aW9uIiBza2V0Y2g6dHlwZT0iTVNBcnRib2FyZEdyb3VwIj4KICAgICAgICAgICAgPGcgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTQtKy1JbXBvcnRlZC1MYXllcnMtQ29weS0rLUltcG9ydGVkLUxheWVycy1Db3B5LTItQ29weSIgc2tldGNoOnR5cGU9Ik1TTGF5ZXJHcm91cCI+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHktNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDEwNy4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjYyNSwyLjUyNyBDMTQ5LjYyNSwyLjUyNyAxNTUuODA1LDYuMDk2IDE1Ni4zNjIsNi40MTggTDE1Ni4zNjIsNy4zMDQgQzE1Ni4zNjIsNy40ODEgMTU2LjM3NSw3LjY2NCAxNTYuNCw3Ljg1MyBDMTU2LjQxLDcuOTM0IDE1Ni40Miw4LjAxNSAxNTYuNDI3LDguMDk1IEMxNTYuNTY3LDkuNTEgMTU3LjQwMSwxMS4wOTMgMTU4LjUzMiwxMi4wOTQgTDE2NC4yNTIsMTcuMTU2IEwxNjQuMzMzLDE3LjA2NiBDMTY0LjMzMywxNy4wNjYgMTY4LjcxNSwxNC41MzYgMTY5LjU2OCwxNC4wNDIgQzE3MS4wMjUsMTQuODgzIDE5NS41MzgsMjkuMDM1IDE5NS41MzgsMjkuMDM1IEwxOTUuNTM4LDgzLjAzNiBDMTk1LjUzOCw4My44MDcgMTk1LjE1Miw4NC4yNTMgMTk0LjU5LDg0LjI1MyBDMTk0LjM1Nyw4NC4yNTMgMTk0LjA5NSw4NC4xNzcgMTkzLjgxOCw4NC4wMTcgTDE2OS44NTEsNzAuMTc5IEwxNjkuODM3LDcwLjIwMyBMMTQyLjUxNSw4NS45NzggTDE0MS42NjUsODQuNjU1IEMxMzYuOTM0LDgzLjEyNiAxMzEuOTE3LDgxLjkxNSAxMjYuNzE0LDgxLjA0NSBDMTI2LjcwOSw4MS4wNiAxMjYuNzA3LDgxLjA2OSAxMjYuNzA3LDgxLjA2OSBMMTIxLjY0LDk4LjAzIEwxMTMuNzQ5LDEwMi41ODYgTDExMy43MTIsMTAyLjUyMyBMMTEzLjcxMiwxMzAuMTEzIEMxMTMuNzEyLDEzMC44ODUgMTEzLjMyNiwxMzEuMzMgMTEyLjc2NCwxMzEuMzMgQzExMi41MzIsMTMxLjMzIDExMi4yNjksMTMxLjI1NCAxMTEuOTkyLDEzMS4wOTQgTDY5LjUxOSwxMDYuNTcyIEM2OC41NjksMTA2LjAyMyA2Ny43OTksMTA0LjY5NSA2Ny43OTksMTAzLjYwNSBMNjcuNzk5LDEwMi41NyBMNjcuNzc4LDEwMi42MTcgQzY3LjI3LDEwMi4zOTMgNjYuNjQ4LDEwMi4yNDkgNjUuOTYyLDEwMi4yMTggQzY1Ljg3NSwxMDIuMjE0IDY1Ljc4OCwxMDIuMjEyIDY1LjcwMSwxMDIuMjEyIEM2NS42MDYsMTAyLjIxMiA2NS41MTEsMTAyLjIxNSA2NS40MTYsMTAyLjIxOSBDNjUuMTk1LDEwMi4yMjkgNjQuOTc0LDEwMi4yMzUgNjQuNzU0LDEwMi4yMzUgQzY0LjMzMSwxMDIuMjM1IDYzLjkxMSwxMDIuMjE2IDYzLjQ5OCwxMDIuMTc4IEM2MS44NDMsMTAyLjAyNSA2MC4yOTgsMTAxLjU3OCA1OS4wOTQsMTAwLjg4MiBMMTIuNTE4LDczLjk5MiBMMTIuNTIzLDc0LjAwNCBMMi4yNDUsNTUuMjU0IEMxLjI0NCw1My40MjcgMi4wMDQsNTEuMDM4IDMuOTQzLDQ5LjkxOCBMNTkuOTU0LDE3LjU3MyBDNjAuNjI2LDE3LjE4NSA2MS4zNSwxNy4wMDEgNjIuMDUzLDE3LjAwMSBDNjMuMzc5LDE3LjAwMSA2NC42MjUsMTcuNjYgNjUuMjgsMTguODU0IEw2NS4yODUsMTguODUxIEw2NS41MTIsMTkuMjY0IEw2NS41MDYsMTkuMjY4IEM2NS45MDksMjAuMDAzIDY2LjQwNSwyMC42OCA2Ni45ODMsMjEuMjg2IEw2Ny4yNiwyMS41NTYgQzY5LjE3NCwyMy40MDYgNzEuNzI4LDI0LjM1NyA3NC4zNzMsMjQuMzU3IEM3Ni4zMjIsMjQuMzU3IDc4LjMyMSwyMy44NCA4MC4xNDgsMjIuNzg1IEM4MC4xNjEsMjIuNzg1IDg3LjQ2NywxOC41NjYgODcuNDY3LDE4LjU2NiBDODguMTM5LDE4LjE3OCA4OC44NjMsMTcuOTk0IDg5LjU2NiwxNy45OTQgQzkwLjg5MiwxNy45OTQgOTIuMTM4LDE4LjY1MiA5Mi43OTIsMTkuODQ3IEw5Ni4wNDIsMjUuNzc1IEw5Ni4wNjQsMjUuNzU3IEwxMDIuODQ5LDI5LjY3NCBMMTAyLjc0NCwyOS40OTIgTDE0OS42MjUsMi41MjcgTTE0OS42MjUsMC44OTIgQzE0OS4zNDMsMC44OTIgMTQ5LjA2MiwwLjk2NSAxNDguODEsMS4xMSBMMTAyLjY0MSwyNy42NjYgTDk3LjIzMSwyNC41NDIgTDk0LjIyNiwxOS4wNjEgQzkzLjMxMywxNy4zOTQgOTEuNTI3LDE2LjM1OSA4OS41NjYsMTYuMzU4IEM4OC41NTUsMTYuMzU4IDg3LjU0NiwxNi42MzIgODYuNjQ5LDE3LjE1IEM4My44NzgsMTguNzUgNzkuNjg3LDIxLjE2OSA3OS4zNzQsMjEuMzQ1IEM3OS4zNTksMjEuMzUzIDc5LjM0NSwyMS4zNjEgNzkuMzMsMjEuMzY5IEM3Ny43OTgsMjIuMjU0IDc2LjA4NCwyMi43MjIgNzQuMzczLDIyLjcyMiBDNzIuMDgxLDIyLjcyMiA2OS45NTksMjEuODkgNjguMzk3LDIwLjM4IEw2OC4xNDUsMjAuMTM1IEM2Ny43MDYsMTkuNjcyIDY3LjMyMywxOS4xNTYgNjcuMDA2LDE4LjYwMSBDNjYuOTg4LDE4LjU1OSA2Ni45NjgsMTguNTE5IDY2Ljk0NiwxOC40NzkgTDY2LjcxOSwxOC4wNjUgQzY2LjY5LDE4LjAxMiA2Ni42NTgsMTcuOTYgNjYuNjI0LDE3LjkxMSBDNjUuNjg2LDE2LjMzNyA2My45NTEsMTUuMzY2IDYyLjA1MywxNS4zNjYgQzYxLjA0MiwxNS4zNjYgNjAuMDMzLDE1LjY0IDU5LjEzNiwxNi4xNTggTDMuMTI1LDQ4LjUwMiBDMC40MjYsNTAuMDYxIC0wLjYxMyw1My40NDIgMC44MTEsNTYuMDQgTDExLjA4OSw3NC43OSBDMTEuMjY2LDc1LjExMyAxMS41MzcsNzUuMzUzIDExLjg1LDc1LjQ5NCBMNTguMjc2LDEwMi4yOTggQzU5LjY3OSwxMDMuMTA4IDYxLjQzMywxMDMuNjMgNjMuMzQ4LDEwMy44MDYgQzYzLjgxMiwxMDMuODQ4IDY0LjI4NSwxMDMuODcgNjQuNzU0LDEwMy44NyBDNjUsMTAzLjg3IDY1LjI0OSwxMDMuODY0IDY1LjQ5NCwxMDMuODUyIEM2NS41NjMsMTAzLjg0OSA2NS42MzIsMTAzLjg0NyA2NS43MDEsMTAzLjg0NyBDNjUuNzY0LDEwMy44NDcgNjUuODI4LDEwMy44NDkgNjUuODksMTAzLjg1MiBDNjUuOTg2LDEwMy44NTYgNjYuMDgsMTAzLjg2MyA2Ni4xNzMsMTAzLjg3NCBDNjYuMjgyLDEwNS40NjcgNjcuMzMyLDEwNy4xOTcgNjguNzAyLDEwNy45ODggTDExMS4xNzQsMTMyLjUxIEMxMTEuNjk4LDEzMi44MTIgMTEyLjIzMiwxMzIuOTY1IDExMi43NjQsMTMyLjk2NSBDMTE0LjI2MSwxMzIuOTY1IDExNS4zNDcsMTMxLjc2NSAxMTUuMzQ3LDEzMC4xMTMgTDExNS4zNDcsMTAzLjU1MSBMMTIyLjQ1OCw5OS40NDYgQzEyMi44MTksOTkuMjM3IDEyMy4wODcsOTguODk4IDEyMy4yMDcsOTguNDk4IEwxMjcuODY1LDgyLjkwNSBDMTMyLjI3OSw4My43MDIgMTM2LjU1Nyw4NC43NTMgMTQwLjYwNyw4Ni4wMzMgTDE0MS4xNCw4Ni44NjIgQzE0MS40NTEsODcuMzQ2IDE0MS45NzcsODcuNjEzIDE0Mi41MTYsODcuNjEzIEMxNDIuNzk0LDg3LjYxMyAxNDMuMDc2LDg3LjU0MiAxNDMuMzMzLDg3LjM5MyBMMTY5Ljg2NSw3Mi4wNzYgTDE5Myw4NS40MzMgQzE5My41MjMsODUuNzM1IDE5NC4wNTgsODUuODg4IDE5NC41OSw4NS44ODggQzE5Ni4wODcsODUuODg4IDE5Ny4xNzMsODQuNjg5IDE5Ny4xNzMsODMuMDM2IEwxOTcuMTczLDI5LjAzNSBDMTk3LjE3MywyOC40NTEgMTk2Ljg2MSwyNy45MTEgMTk2LjM1NSwyNy42MTkgQzE5Ni4zNTUsMjcuNjE5IDE3MS44NDMsMTMuNDY3IDE3MC4zODUsMTIuNjI2IEMxNzAuMTMyLDEyLjQ4IDE2OS44NSwxMi40MDcgMTY5LjU2OCwxMi40MDcgQzE2OS4yODUsMTIuNDA3IDE2OS4wMDIsMTIuNDgxIDE2OC43NDksMTIuNjI3IEMxNjguMTQzLDEyLjk3OCAxNjUuNzU2LDE0LjM1NyAxNjQuNDI0LDE1LjEyNSBMMTU5LjYxNSwxMC44NyBDMTU4Ljc5NiwxMC4xNDUgMTU4LjE1NCw4LjkzNyAxNTguMDU0LDcuOTM0IEMxNTguMDQ1LDcuODM3IDE1OC4wMzQsNy43MzkgMTU4LjAyMSw3LjY0IEMxNTguMDA1LDcuNTIzIDE1Ny45OTgsNy40MSAxNTcuOTk4LDcuMzA0IEwxNTcuOTk4LDYuNDE4IEMxNTcuOTk4LDUuODM0IDE1Ny42ODYsNS4yOTUgMTU3LjE4MSw1LjAwMiBDMTU2LjYyNCw0LjY4IDE1MC40NDIsMS4xMTEgMTUwLjQ0MiwxLjExMSBDMTUwLjE4OSwwLjk2NSAxNDkuOTA3LDAuODkyIDE0OS42MjUsMC44OTIiIGlkPSJGaWxsLTEiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTYuMDI3LDI1LjYzNiBMMTQyLjYwMyw1Mi41MjcgQzE0My44MDcsNTMuMjIyIDE0NC41ODIsNTQuMTE0IDE0NC44NDUsNTUuMDY4IEwxNDQuODM1LDU1LjA3NSBMNjMuNDYxLDEwMi4wNTcgTDYzLjQ2LDEwMi4wNTcgQzYxLjgwNiwxMDEuOTA1IDYwLjI2MSwxMDEuNDU3IDU5LjA1NywxMDAuNzYyIEwxMi40ODEsNzMuODcxIEw5Ni4wMjcsMjUuNjM2IiBpZD0iRmlsbC0yIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYzLjQ2MSwxMDIuMTc0IEM2My40NTMsMTAyLjE3NCA2My40NDYsMTAyLjE3NCA2My40MzksMTAyLjE3MiBDNjEuNzQ2LDEwMi4wMTYgNjAuMjExLDEwMS41NjMgNTguOTk4LDEwMC44NjMgTDEyLjQyMiw3My45NzMgQzEyLjM4Niw3My45NTIgMTIuMzY0LDczLjkxNCAxMi4zNjQsNzMuODcxIEMxMi4zNjQsNzMuODMgMTIuMzg2LDczLjc5MSAxMi40MjIsNzMuNzcgTDk1Ljk2OCwyNS41MzUgQzk2LjAwNCwyNS41MTQgOTYuMDQ5LDI1LjUxNCA5Ni4wODUsMjUuNTM1IEwxNDIuNjYxLDUyLjQyNiBDMTQzLjg4OCw1My4xMzQgMTQ0LjY4Miw1NC4wMzggMTQ0Ljk1Nyw1NS4wMzcgQzE0NC45Nyw1NS4wODMgMTQ0Ljk1Myw1NS4xMzMgMTQ0LjkxNSw1NS4xNjEgQzE0NC45MTEsNTUuMTY1IDE0NC44OTgsNTUuMTc0IDE0NC44OTQsNTUuMTc3IEw2My41MTksMTAyLjE1OCBDNjMuNTAxLDEwMi4xNjkgNjMuNDgxLDEwMi4xNzQgNjMuNDYxLDEwMi4xNzQgTDYzLjQ2MSwxMDIuMTc0IFogTTEyLjcxNCw3My44NzEgTDU5LjExNSwxMDAuNjYxIEM2MC4yOTMsMTAxLjM0MSA2MS43ODYsMTAxLjc4MiA2My40MzUsMTAxLjkzNyBMMTQ0LjcwNyw1NS4wMTUgQzE0NC40MjgsNTQuMTA4IDE0My42ODIsNTMuMjg1IDE0Mi41NDQsNTIuNjI4IEw5Ni4wMjcsMjUuNzcxIEwxMi43MTQsNzMuODcxIEwxMi43MTQsNzMuODcxIFoiIGlkPSJGaWxsLTMiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ4LjMyNyw1OC40NzEgQzE0OC4xNDUsNTguNDggMTQ3Ljk2Miw1OC40OCAxNDcuNzgxLDU4LjQ3MiBDMTQ1Ljg4Nyw1OC4zODkgMTQ0LjQ3OSw1Ny40MzQgMTQ0LjYzNiw1Ni4zNCBDMTQ0LjY4OSw1NS45NjcgMTQ0LjY2NCw1NS41OTcgMTQ0LjU2NCw1NS4yMzUgTDYzLjQ2MSwxMDIuMDU3IEM2NC4wODksMTAyLjExNSA2NC43MzMsMTAyLjEzIDY1LjM3OSwxMDIuMDk5IEM2NS41NjEsMTAyLjA5IDY1Ljc0MywxMDIuMDkgNjUuOTI1LDEwMi4wOTggQzY3LjgxOSwxMDIuMTgxIDY5LjIyNywxMDMuMTM2IDY5LjA3LDEwNC4yMyBMMTQ4LjMyNyw1OC40NzEiIGlkPSJGaWxsLTQiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNjkuMDcsMTA0LjM0NyBDNjkuMDQ4LDEwNC4zNDcgNjkuMDI1LDEwNC4zNCA2OS4wMDUsMTA0LjMyNyBDNjguOTY4LDEwNC4zMDEgNjguOTQ4LDEwNC4yNTcgNjguOTU1LDEwNC4yMTMgQzY5LDEwMy44OTYgNjguODk4LDEwMy41NzYgNjguNjU4LDEwMy4yODggQzY4LjE1MywxMDIuNjc4IDY3LjEwMywxMDIuMjY2IDY1LjkyLDEwMi4yMTQgQzY1Ljc0MiwxMDIuMjA2IDY1LjU2MywxMDIuMjA3IDY1LjM4NSwxMDIuMjE1IEM2NC43NDIsMTAyLjI0NiA2NC4wODcsMTAyLjIzMiA2My40NSwxMDIuMTc0IEM2My4zOTksMTAyLjE2OSA2My4zNTgsMTAyLjEzMiA2My4zNDcsMTAyLjA4MiBDNjMuMzM2LDEwMi4wMzMgNjMuMzU4LDEwMS45ODEgNjMuNDAyLDEwMS45NTYgTDE0NC41MDYsNTUuMTM0IEMxNDQuNTM3LDU1LjExNiAxNDQuNTc1LDU1LjExMyAxNDQuNjA5LDU1LjEyNyBDMTQ0LjY0Miw1NS4xNDEgMTQ0LjY2OCw1NS4xNyAxNDQuNjc3LDU1LjIwNCBDMTQ0Ljc4MSw1NS41ODUgMTQ0LjgwNiw1NS45NzIgMTQ0Ljc1MSw1Ni4zNTcgQzE0NC43MDYsNTYuNjczIDE0NC44MDgsNTYuOTk0IDE0NS4wNDcsNTcuMjgyIEMxNDUuNTUzLDU3Ljg5MiAxNDYuNjAyLDU4LjMwMyAxNDcuNzg2LDU4LjM1NSBDMTQ3Ljk2NCw1OC4zNjMgMTQ4LjE0Myw1OC4zNjMgMTQ4LjMyMSw1OC4zNTQgQzE0OC4zNzcsNTguMzUyIDE0OC40MjQsNTguMzg3IDE0OC40MzksNTguNDM4IEMxNDguNDU0LDU4LjQ5IDE0OC40MzIsNTguNTQ1IDE0OC4zODUsNTguNTcyIEw2OS4xMjksMTA0LjMzMSBDNjkuMTExLDEwNC4zNDIgNjkuMDksMTA0LjM0NyA2OS4wNywxMDQuMzQ3IEw2OS4wNywxMDQuMzQ3IFogTTY1LjY2NSwxMDEuOTc1IEM2NS43NTQsMTAxLjk3NSA2NS44NDIsMTAxLjk3NyA2NS45MywxMDEuOTgxIEM2Ny4xOTYsMTAyLjAzNyA2OC4yODMsMTAyLjQ2OSA2OC44MzgsMTAzLjEzOSBDNjkuMDY1LDEwMy40MTMgNjkuMTg4LDEwMy43MTQgNjkuMTk4LDEwNC4wMjEgTDE0Ny44ODMsNTguNTkyIEMxNDcuODQ3LDU4LjU5MiAxNDcuODExLDU4LjU5MSAxNDcuNzc2LDU4LjU4OSBDMTQ2LjUwOSw1OC41MzMgMTQ1LjQyMiw1OC4xIDE0NC44NjcsNTcuNDMxIEMxNDQuNTg1LDU3LjA5MSAxNDQuNDY1LDU2LjcwNyAxNDQuNTIsNTYuMzI0IEMxNDQuNTYzLDU2LjAyMSAxNDQuNTUyLDU1LjcxNiAxNDQuNDg4LDU1LjQxNCBMNjMuODQ2LDEwMS45NyBDNjQuMzUzLDEwMi4wMDIgNjQuODY3LDEwMi4wMDYgNjUuMzc0LDEwMS45ODIgQzY1LjQ3MSwxMDEuOTc3IDY1LjU2OCwxMDEuOTc1IDY1LjY2NSwxMDEuOTc1IEw2NS42NjUsMTAxLjk3NSBaIiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTIuMjA4LDU1LjEzNCBDMS4yMDcsNTMuMzA3IDEuOTY3LDUwLjkxNyAzLjkwNiw0OS43OTcgTDU5LjkxNywxNy40NTMgQzYxLjg1NiwxNi4zMzMgNjQuMjQxLDE2LjkwNyA2NS4yNDMsMTguNzM0IEw2NS40NzUsMTkuMTQ0IEM2NS44NzIsMTkuODgyIDY2LjM2OCwyMC41NiA2Ni45NDUsMjEuMTY1IEw2Ny4yMjMsMjEuNDM1IEM3MC41NDgsMjQuNjQ5IDc1LjgwNiwyNS4xNTEgODAuMTExLDIyLjY2NSBMODcuNDMsMTguNDQ1IEM4OS4zNywxNy4zMjYgOTEuNzU0LDE3Ljg5OSA5Mi43NTUsMTkuNzI3IEw5Ni4wMDUsMjUuNjU1IEwxMi40ODYsNzMuODg0IEwyLjIwOCw1NS4xMzQgWiIgaWQ9IkZpbGwtNiIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi40ODYsNzQuMDAxIEMxMi40NzYsNzQuMDAxIDEyLjQ2NSw3My45OTkgMTIuNDU1LDczLjk5NiBDMTIuNDI0LDczLjk4OCAxMi4zOTksNzMuOTY3IDEyLjM4NCw3My45NCBMMi4xMDYsNTUuMTkgQzEuMDc1LDUzLjMxIDEuODU3LDUwLjg0NSAzLjg0OCw0OS42OTYgTDU5Ljg1OCwxNy4zNTIgQzYwLjUyNSwxNi45NjcgNjEuMjcxLDE2Ljc2NCA2Mi4wMTYsMTYuNzY0IEM2My40MzEsMTYuNzY0IDY0LjY2NiwxNy40NjYgNjUuMzI3LDE4LjY0NiBDNjUuMzM3LDE4LjY1NCA2NS4zNDUsMTguNjYzIDY1LjM1MSwxOC42NzQgTDY1LjU3OCwxOS4wODggQzY1LjU4NCwxOS4xIDY1LjU4OSwxOS4xMTIgNjUuNTkxLDE5LjEyNiBDNjUuOTg1LDE5LjgzOCA2Ni40NjksMjAuNDk3IDY3LjAzLDIxLjA4NSBMNjcuMzA1LDIxLjM1MSBDNjkuMTUxLDIzLjEzNyA3MS42NDksMjQuMTIgNzQuMzM2LDI0LjEyIEM3Ni4zMTMsMjQuMTIgNzguMjksMjMuNTgyIDgwLjA1MywyMi41NjMgQzgwLjA2NCwyMi41NTcgODAuMDc2LDIyLjU1MyA4MC4wODgsMjIuNTUgTDg3LjM3MiwxOC4zNDQgQzg4LjAzOCwxNy45NTkgODguNzg0LDE3Ljc1NiA4OS41MjksMTcuNzU2IEM5MC45NTYsMTcuNzU2IDkyLjIwMSwxOC40NzIgOTIuODU4LDE5LjY3IEw5Ni4xMDcsMjUuNTk5IEM5Ni4xMzgsMjUuNjU0IDk2LjExOCwyNS43MjQgOTYuMDYzLDI1Ljc1NiBMMTIuNTQ1LDczLjk4NSBDMTIuNTI2LDczLjk5NiAxMi41MDYsNzQuMDAxIDEyLjQ4Niw3NC4wMDEgTDEyLjQ4Niw3NC4wMDEgWiBNNjIuMDE2LDE2Ljk5NyBDNjEuMzEyLDE2Ljk5NyA2MC42MDYsMTcuMTkgNTkuOTc1LDE3LjU1NCBMMy45NjUsNDkuODk5IEMyLjA4Myw1MC45ODUgMS4zNDEsNTMuMzA4IDIuMzEsNTUuMDc4IEwxMi41MzEsNzMuNzIzIEw5NS44NDgsMjUuNjExIEw5Mi42NTMsMTkuNzgyIEM5Mi4wMzgsMTguNjYgOTAuODcsMTcuOTkgODkuNTI5LDE3Ljk5IEM4OC44MjUsMTcuOTkgODguMTE5LDE4LjE4MiA4Ny40ODksMTguNTQ3IEw4MC4xNzIsMjIuNzcyIEM4MC4xNjEsMjIuNzc4IDgwLjE0OSwyMi43ODIgODAuMTM3LDIyLjc4NSBDNzguMzQ2LDIzLjgxMSA3Ni4zNDEsMjQuMzU0IDc0LjMzNiwyNC4zNTQgQzcxLjU4OCwyNC4zNTQgNjkuMDMzLDIzLjM0NyA2Ny4xNDIsMjEuNTE5IEw2Ni44NjQsMjEuMjQ5IEM2Ni4yNzcsMjAuNjM0IDY1Ljc3NCwxOS45NDcgNjUuMzY3LDE5LjIwMyBDNjUuMzYsMTkuMTkyIDY1LjM1NiwxOS4xNzkgNjUuMzU0LDE5LjE2NiBMNjUuMTYzLDE4LjgxOSBDNjUuMTU0LDE4LjgxMSA2NS4xNDYsMTguODAxIDY1LjE0LDE4Ljc5IEM2NC41MjUsMTcuNjY3IDYzLjM1NywxNi45OTcgNjIuMDE2LDE2Ljk5NyBMNjIuMDE2LDE2Ljk5NyBaIiBpZD0iRmlsbC03IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTQyLjQzNCw0OC44MDggTDQyLjQzNCw0OC44MDggQzM5LjkyNCw0OC44MDcgMzcuNzM3LDQ3LjU1IDM2LjU4Miw0NS40NDMgQzM0Ljc3MSw0Mi4xMzkgMzYuMTQ0LDM3LjgwOSAzOS42NDEsMzUuNzg5IEw1MS45MzIsMjguNjkxIEM1My4xMDMsMjguMDE1IDU0LjQxMywyNy42NTggNTUuNzIxLDI3LjY1OCBDNTguMjMxLDI3LjY1OCA2MC40MTgsMjguOTE2IDYxLjU3MywzMS4wMjMgQzYzLjM4NCwzNC4zMjcgNjIuMDEyLDM4LjY1NyA1OC41MTQsNDAuNjc3IEw0Ni4yMjMsNDcuNzc1IEM0NS4wNTMsNDguNDUgNDMuNzQyLDQ4LjgwOCA0Mi40MzQsNDguODA4IEw0Mi40MzQsNDguODA4IFogTTU1LjcyMSwyOC4xMjUgQzU0LjQ5NSwyOC4xMjUgNTMuMjY1LDI4LjQ2MSA1Mi4xNjYsMjkuMDk2IEwzOS44NzUsMzYuMTk0IEMzNi41OTYsMzguMDg3IDM1LjMwMiw0Mi4xMzYgMzYuOTkyLDQ1LjIxOCBDMzguMDYzLDQ3LjE3MyA0MC4wOTgsNDguMzQgNDIuNDM0LDQ4LjM0IEM0My42NjEsNDguMzQgNDQuODksNDguMDA1IDQ1Ljk5LDQ3LjM3IEw1OC4yODEsNDAuMjcyIEM2MS41NiwzOC4zNzkgNjIuODUzLDM0LjMzIDYxLjE2NCwzMS4yNDggQzYwLjA5MiwyOS4yOTMgNTguMDU4LDI4LjEyNSA1NS43MjEsMjguMTI1IEw1NS43MjEsMjguMTI1IFoiIGlkPSJGaWxsLTgiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjU4OCwyLjQwNyBDMTQ5LjU4OCwyLjQwNyAxNTUuNzY4LDUuOTc1IDE1Ni4zMjUsNi4yOTcgTDE1Ni4zMjUsNy4xODQgQzE1Ni4zMjUsNy4zNiAxNTYuMzM4LDcuNTQ0IDE1Ni4zNjIsNy43MzMgQzE1Ni4zNzMsNy44MTQgMTU2LjM4Miw3Ljg5NCAxNTYuMzksNy45NzUgQzE1Ni41Myw5LjM5IDE1Ny4zNjMsMTAuOTczIDE1OC40OTUsMTEuOTc0IEwxNjUuODkxLDE4LjUxOSBDMTY2LjA2OCwxOC42NzUgMTY2LjI0OSwxOC44MTQgMTY2LjQzMiwxOC45MzQgQzE2OC4wMTEsMTkuOTc0IDE2OS4zODIsMTkuNCAxNjkuNDk0LDE3LjY1MiBDMTY5LjU0MywxNi44NjggMTY5LjU1MSwxNi4wNTcgMTY5LjUxNywxNS4yMjMgTDE2OS41MTQsMTUuMDYzIEwxNjkuNTE0LDEzLjkxMiBDMTcwLjc4LDE0LjY0MiAxOTUuNTAxLDI4LjkxNSAxOTUuNTAxLDI4LjkxNSBMMTk1LjUwMSw4Mi45MTUgQzE5NS41MDEsODQuMDA1IDE5NC43MzEsODQuNDQ1IDE5My43ODEsODMuODk3IEwxNTEuMzA4LDU5LjM3NCBDMTUwLjM1OCw1OC44MjYgMTQ5LjU4OCw1Ny40OTcgMTQ5LjU4OCw1Ni40MDggTDE0OS41ODgsMjIuMzc1IiBpZD0iRmlsbC05IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE5NC41NTMsODQuMjUgQzE5NC4yOTYsODQuMjUgMTk0LjAxMyw4NC4xNjUgMTkzLjcyMiw4My45OTcgTDE1MS4yNSw1OS40NzYgQzE1MC4yNjksNTguOTA5IDE0OS40NzEsNTcuNTMzIDE0OS40NzEsNTYuNDA4IEwxNDkuNDcxLDIyLjM3NSBMMTQ5LjcwNSwyMi4zNzUgTDE0OS43MDUsNTYuNDA4IEMxNDkuNzA1LDU3LjQ1OSAxNTAuNDUsNTguNzQ0IDE1MS4zNjYsNTkuMjc0IEwxOTMuODM5LDgzLjc5NSBDMTk0LjI2Myw4NC4wNCAxOTQuNjU1LDg0LjA4MyAxOTQuOTQyLDgzLjkxNyBDMTk1LjIyNyw4My43NTMgMTk1LjM4NCw4My4zOTcgMTk1LjM4NCw4Mi45MTUgTDE5NS4zODQsMjguOTgyIEMxOTQuMTAyLDI4LjI0MiAxNzIuMTA0LDE1LjU0MiAxNjkuNjMxLDE0LjExNCBMMTY5LjYzNCwxNS4yMiBDMTY5LjY2OCwxNi4wNTIgMTY5LjY2LDE2Ljg3NCAxNjkuNjEsMTcuNjU5IEMxNjkuNTU2LDE4LjUwMyAxNjkuMjE0LDE5LjEyMyAxNjguNjQ3LDE5LjQwNSBDMTY4LjAyOCwxOS43MTQgMTY3LjE5NywxOS41NzggMTY2LjM2NywxOS4wMzIgQzE2Ni4xODEsMTguOTA5IDE2NS45OTUsMTguNzY2IDE2NS44MTQsMTguNjA2IEwxNTguNDE3LDEyLjA2MiBDMTU3LjI1OSwxMS4wMzYgMTU2LjQxOCw5LjQzNyAxNTYuMjc0LDcuOTg2IEMxNTYuMjY2LDcuOTA3IDE1Ni4yNTcsNy44MjcgMTU2LjI0Nyw3Ljc0OCBDMTU2LjIyMSw3LjU1NSAxNTYuMjA5LDcuMzY1IDE1Ni4yMDksNy4xODQgTDE1Ni4yMDksNi4zNjQgQzE1NS4zNzUsNS44ODMgMTQ5LjUyOSwyLjUwOCAxNDkuNTI5LDIuNTA4IEwxNDkuNjQ2LDIuMzA2IEMxNDkuNjQ2LDIuMzA2IDE1NS44MjcsNS44NzQgMTU2LjM4NCw2LjE5NiBMMTU2LjQ0Miw2LjIzIEwxNTYuNDQyLDcuMTg0IEMxNTYuNDQyLDcuMzU1IDE1Ni40NTQsNy41MzUgMTU2LjQ3OCw3LjcxNyBDMTU2LjQ4OSw3LjggMTU2LjQ5OSw3Ljg4MiAxNTYuNTA3LDcuOTYzIEMxNTYuNjQ1LDkuMzU4IDE1Ny40NTUsMTAuODk4IDE1OC41NzIsMTEuODg2IEwxNjUuOTY5LDE4LjQzMSBDMTY2LjE0MiwxOC41ODQgMTY2LjMxOSwxOC43MiAxNjYuNDk2LDE4LjgzNyBDMTY3LjI1NCwxOS4zMzYgMTY4LDE5LjQ2NyAxNjguNTQzLDE5LjE5NiBDMTY5LjAzMywxOC45NTMgMTY5LjMyOSwxOC40MDEgMTY5LjM3NywxNy42NDUgQzE2OS40MjcsMTYuODY3IDE2OS40MzQsMTYuMDU0IDE2OS40MDEsMTUuMjI4IEwxNjkuMzk3LDE1LjA2NSBMMTY5LjM5NywxMy43MSBMMTY5LjU3MiwxMy44MSBDMTcwLjgzOSwxNC41NDEgMTk1LjU1OSwyOC44MTQgMTk1LjU1OSwyOC44MTQgTDE5NS42MTgsMjguODQ3IEwxOTUuNjE4LDgyLjkxNSBDMTk1LjYxOCw4My40ODQgMTk1LjQyLDgzLjkxMSAxOTUuMDU5LDg0LjExOSBDMTk0LjkwOCw4NC4yMDYgMTk0LjczNyw4NC4yNSAxOTQuNTUzLDg0LjI1IiBpZD0iRmlsbC0xMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDUuNjg1LDU2LjE2MSBMMTY5LjgsNzAuMDgzIEwxNDMuODIyLDg1LjA4MSBMMTQyLjM2LDg0Ljc3NCBDMTM1LjgyNiw4Mi42MDQgMTI4LjczMiw4MS4wNDYgMTIxLjM0MSw4MC4xNTggQzExNi45NzYsNzkuNjM0IDExMi42NzgsODEuMjU0IDExMS43NDMsODMuNzc4IEMxMTEuNTA2LDg0LjQxNCAxMTEuNTAzLDg1LjA3MSAxMTEuNzMyLDg1LjcwNiBDMTEzLjI3LDg5Ljk3MyAxMTUuOTY4LDk0LjA2OSAxMTkuNzI3LDk3Ljg0MSBMMTIwLjI1OSw5OC42ODYgQzEyMC4yNiw5OC42ODUgOTQuMjgyLDExMy42ODMgOTQuMjgyLDExMy42ODMgTDcwLjE2Nyw5OS43NjEgTDE0NS42ODUsNTYuMTYxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik05NC4yODIsMTEzLjgxOCBMOTQuMjIzLDExMy43ODUgTDY5LjkzMyw5OS43NjEgTDcwLjEwOCw5OS42NiBMMTQ1LjY4NSw1Ni4wMjYgTDE0NS43NDMsNTYuMDU5IEwxNzAuMDMzLDcwLjA4MyBMMTQzLjg0Miw4NS4yMDUgTDE0My43OTcsODUuMTk1IEMxNDMuNzcyLDg1LjE5IDE0Mi4zMzYsODQuODg4IDE0Mi4zMzYsODQuODg4IEMxMzUuNzg3LDgyLjcxNCAxMjguNzIzLDgxLjE2MyAxMjEuMzI3LDgwLjI3NCBDMTIwLjc4OCw4MC4yMDkgMTIwLjIzNiw4MC4xNzcgMTE5LjY4OSw4MC4xNzcgQzExNS45MzEsODAuMTc3IDExMi42MzUsODEuNzA4IDExMS44NTIsODMuODE5IEMxMTEuNjI0LDg0LjQzMiAxMTEuNjIxLDg1LjA1MyAxMTEuODQyLDg1LjY2NyBDMTEzLjM3Nyw4OS45MjUgMTE2LjA1OCw5My45OTMgMTE5LjgxLDk3Ljc1OCBMMTE5LjgyNiw5Ny43NzkgTDEyMC4zNTIsOTguNjE0IEMxMjAuMzU0LDk4LjYxNyAxMjAuMzU2LDk4LjYyIDEyMC4zNTgsOTguNjI0IEwxMjAuNDIyLDk4LjcyNiBMMTIwLjMxNyw5OC43ODcgQzEyMC4yNjQsOTguODE4IDk0LjU5OSwxMTMuNjM1IDk0LjM0LDExMy43ODUgTDk0LjI4MiwxMTMuODE4IEw5NC4yODIsMTEzLjgxOCBaIE03MC40MDEsOTkuNzYxIEw5NC4yODIsMTEzLjU0OSBMMTE5LjA4NCw5OS4yMjkgQzExOS42Myw5OC45MTQgMTE5LjkzLDk4Ljc0IDEyMC4xMDEsOTguNjU0IEwxMTkuNjM1LDk3LjkxNCBDMTE1Ljg2NCw5NC4xMjcgMTEzLjE2OCw5MC4wMzMgMTExLjYyMiw4NS43NDYgQzExMS4zODIsODUuMDc5IDExMS4zODYsODQuNDA0IDExMS42MzMsODMuNzM4IEMxMTIuNDQ4LDgxLjUzOSAxMTUuODM2LDc5Ljk0MyAxMTkuNjg5LDc5Ljk0MyBDMTIwLjI0Niw3OS45NDMgMTIwLjgwNiw3OS45NzYgMTIxLjM1NSw4MC4wNDIgQzEyOC43NjcsODAuOTMzIDEzNS44NDYsODIuNDg3IDE0Mi4zOTYsODQuNjYzIEMxNDMuMjMyLDg0LjgzOCAxNDMuNjExLDg0LjkxNyAxNDMuNzg2LDg0Ljk2NyBMMTY5LjU2Niw3MC4wODMgTDE0NS42ODUsNTYuMjk1IEw3MC40MDEsOTkuNzYxIEw3MC40MDEsOTkuNzYxIFoiIGlkPSJGaWxsLTEyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2Ny4yMywxOC45NzkgTDE2Ny4yMyw2OS44NSBMMTM5LjkwOSw4NS42MjMgTDEzMy40NDgsNzEuNDU2IEMxMzIuNTM4LDY5LjQ2IDEzMC4wMiw2OS43MTggMTI3LjgyNCw3Mi4wMyBDMTI2Ljc2OSw3My4xNCAxMjUuOTMxLDc0LjU4NSAxMjUuNDk0LDc2LjA0OCBMMTE5LjAzNCw5Ny42NzYgTDkxLjcxMiwxMTMuNDUgTDkxLjcxMiw2Mi41NzkgTDE2Ny4yMywxOC45NzkiIGlkPSJGaWxsLTEzIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTkxLjcxMiwxMTMuNTY3IEM5MS42OTIsMTEzLjU2NyA5MS42NzIsMTEzLjU2MSA5MS42NTMsMTEzLjU1MSBDOTEuNjE4LDExMy41MyA5MS41OTUsMTEzLjQ5MiA5MS41OTUsMTEzLjQ1IEw5MS41OTUsNjIuNTc5IEM5MS41OTUsNjIuNTM3IDkxLjYxOCw2Mi40OTkgOTEuNjUzLDYyLjQ3OCBMMTY3LjE3MiwxOC44NzggQzE2Ny4yMDgsMTguODU3IDE2Ny4yNTIsMTguODU3IDE2Ny4yODgsMTguODc4IEMxNjcuMzI0LDE4Ljg5OSAxNjcuMzQ3LDE4LjkzNyAxNjcuMzQ3LDE4Ljk3OSBMMTY3LjM0Nyw2OS44NSBDMTY3LjM0Nyw2OS44OTEgMTY3LjMyNCw2OS45MyAxNjcuMjg4LDY5Ljk1IEwxMzkuOTY3LDg1LjcyNSBDMTM5LjkzOSw4NS43NDEgMTM5LjkwNSw4NS43NDUgMTM5Ljg3Myw4NS43MzUgQzEzOS44NDIsODUuNzI1IDEzOS44MTYsODUuNzAyIDEzOS44MDIsODUuNjcyIEwxMzMuMzQyLDcxLjUwNCBDMTMyLjk2Nyw3MC42ODIgMTMyLjI4LDcwLjIyOSAxMzEuNDA4LDcwLjIyOSBDMTMwLjMxOSw3MC4yMjkgMTI5LjA0NCw3MC45MTUgMTI3LjkwOCw3Mi4xMSBDMTI2Ljg3NCw3My4yIDEyNi4wMzQsNzQuNjQ3IDEyNS42MDYsNzYuMDgyIEwxMTkuMTQ2LDk3LjcwOSBDMTE5LjEzNyw5Ny43MzggMTE5LjExOCw5Ny43NjIgMTE5LjA5Miw5Ny43NzcgTDkxLjc3LDExMy41NTEgQzkxLjc1MiwxMTMuNTYxIDkxLjczMiwxMTMuNTY3IDkxLjcxMiwxMTMuNTY3IEw5MS43MTIsMTEzLjU2NyBaIE05MS44MjksNjIuNjQ3IEw5MS44MjksMTEzLjI0OCBMMTE4LjkzNSw5Ny41OTggTDEyNS4zODIsNzYuMDE1IEMxMjUuODI3LDc0LjUyNSAxMjYuNjY0LDczLjA4MSAxMjcuNzM5LDcxLjk1IEMxMjguOTE5LDcwLjcwOCAxMzAuMjU2LDY5Ljk5NiAxMzEuNDA4LDY5Ljk5NiBDMTMyLjM3Nyw2OS45OTYgMTMzLjEzOSw3MC40OTcgMTMzLjU1NCw3MS40MDcgTDEzOS45NjEsODUuNDU4IEwxNjcuMTEzLDY5Ljc4MiBMMTY3LjExMywxOS4xODEgTDkxLjgyOSw2Mi42NDcgTDkxLjgyOSw2Mi42NDcgWiIgaWQ9IkZpbGwtMTQiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTY4LjU0MywxOS4yMTMgTDE2OC41NDMsNzAuMDgzIEwxNDEuMjIxLDg1Ljg1NyBMMTM0Ljc2MSw3MS42ODkgQzEzMy44NTEsNjkuNjk0IDEzMS4zMzMsNjkuOTUxIDEyOS4xMzcsNzIuMjYzIEMxMjguMDgyLDczLjM3NCAxMjcuMjQ0LDc0LjgxOSAxMjYuODA3LDc2LjI4MiBMMTIwLjM0Niw5Ny45MDkgTDkzLjAyNSwxMTMuNjgzIEw5My4wMjUsNjIuODEzIEwxNjguNTQzLDE5LjIxMyIgaWQ9IkZpbGwtMTUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTMuMDI1LDExMy44IEM5My4wMDUsMTEzLjggOTIuOTg0LDExMy43OTUgOTIuOTY2LDExMy43ODUgQzkyLjkzMSwxMTMuNzY0IDkyLjkwOCwxMTMuNzI1IDkyLjkwOCwxMTMuNjg0IEw5Mi45MDgsNjIuODEzIEM5Mi45MDgsNjIuNzcxIDkyLjkzMSw2Mi43MzMgOTIuOTY2LDYyLjcxMiBMMTY4LjQ4NCwxOS4xMTIgQzE2OC41MiwxOS4wOSAxNjguNTY1LDE5LjA5IDE2OC42MDEsMTkuMTEyIEMxNjguNjM3LDE5LjEzMiAxNjguNjYsMTkuMTcxIDE2OC42NiwxOS4yMTIgTDE2OC42Niw3MC4wODMgQzE2OC42Niw3MC4xMjUgMTY4LjYzNyw3MC4xNjQgMTY4LjYwMSw3MC4xODQgTDE0MS4yOCw4NS45NTggQzE0MS4yNTEsODUuOTc1IDE0MS4yMTcsODUuOTc5IDE0MS4xODYsODUuOTY4IEMxNDEuMTU0LDg1Ljk1OCAxNDEuMTI5LDg1LjkzNiAxNDEuMTE1LDg1LjkwNiBMMTM0LjY1NSw3MS43MzggQzEzNC4yOCw3MC45MTUgMTMzLjU5Myw3MC40NjMgMTMyLjcyLDcwLjQ2MyBDMTMxLjYzMiw3MC40NjMgMTMwLjM1Nyw3MS4xNDggMTI5LjIyMSw3Mi4zNDQgQzEyOC4xODYsNzMuNDMzIDEyNy4zNDcsNzQuODgxIDEyNi45MTksNzYuMzE1IEwxMjAuNDU4LDk3Ljk0MyBDMTIwLjQ1LDk3Ljk3MiAxMjAuNDMxLDk3Ljk5NiAxMjAuNDA1LDk4LjAxIEw5My4wODMsMTEzLjc4NSBDOTMuMDY1LDExMy43OTUgOTMuMDQ1LDExMy44IDkzLjAyNSwxMTMuOCBMOTMuMDI1LDExMy44IFogTTkzLjE0Miw2Mi44ODEgTDkzLjE0MiwxMTMuNDgxIEwxMjAuMjQ4LDk3LjgzMiBMMTI2LjY5NSw3Ni4yNDggQzEyNy4xNCw3NC43NTggMTI3Ljk3Nyw3My4zMTUgMTI5LjA1Miw3Mi4xODMgQzEzMC4yMzEsNzAuOTQyIDEzMS41NjgsNzAuMjI5IDEzMi43Miw3MC4yMjkgQzEzMy42ODksNzAuMjI5IDEzNC40NTIsNzAuNzMxIDEzNC44NjcsNzEuNjQxIEwxNDEuMjc0LDg1LjY5MiBMMTY4LjQyNiw3MC4wMTYgTDE2OC40MjYsMTkuNDE1IEw5My4xNDIsNjIuODgxIEw5My4xNDIsNjIuODgxIFoiIGlkPSJGaWxsLTE2IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS44LDcwLjA4MyBMMTQyLjQ3OCw4NS44NTcgTDEzNi4wMTgsNzEuNjg5IEMxMzUuMTA4LDY5LjY5NCAxMzIuNTksNjkuOTUxIDEzMC4zOTMsNzIuMjYzIEMxMjkuMzM5LDczLjM3NCAxMjguNSw3NC44MTkgMTI4LjA2NCw3Ni4yODIgTDEyMS42MDMsOTcuOTA5IEw5NC4yODIsMTEzLjY4MyBMOTQuMjgyLDYyLjgxMyBMMTY5LjgsMTkuMjEzIEwxNjkuOCw3MC4wODMgWiIgaWQ9IkZpbGwtMTciIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTQuMjgyLDExMy45MTcgQzk0LjI0MSwxMTMuOTE3IDk0LjIwMSwxMTMuOTA3IDk0LjE2NSwxMTMuODg2IEM5NC4wOTMsMTEzLjg0NSA5NC4wNDgsMTEzLjc2NyA5NC4wNDgsMTEzLjY4NCBMOTQuMDQ4LDYyLjgxMyBDOTQuMDQ4LDYyLjczIDk0LjA5Myw2Mi42NTIgOTQuMTY1LDYyLjYxMSBMMTY5LjY4MywxOS4wMSBDMTY5Ljc1NSwxOC45NjkgMTY5Ljg0NCwxOC45NjkgMTY5LjkxNywxOS4wMSBDMTY5Ljk4OSwxOS4wNTIgMTcwLjAzMywxOS4xMjkgMTcwLjAzMywxOS4yMTIgTDE3MC4wMzMsNzAuMDgzIEMxNzAuMDMzLDcwLjE2NiAxNjkuOTg5LDcwLjI0NCAxNjkuOTE3LDcwLjI4NSBMMTQyLjU5NSw4Ni4wNiBDMTQyLjUzOCw4Ni4wOTIgMTQyLjQ2OSw4Ni4xIDE0Mi40MDcsODYuMDggQzE0Mi4zNDQsODYuMDYgMTQyLjI5Myw4Ni4wMTQgMTQyLjI2Niw4NS45NTQgTDEzNS44MDUsNzEuNzg2IEMxMzUuNDQ1LDcwLjk5NyAxMzQuODEzLDcwLjU4IDEzMy45NzcsNzAuNTggQzEzMi45MjEsNzAuNTggMTMxLjY3Niw3MS4yNTIgMTMwLjU2Miw3Mi40MjQgQzEyOS41NCw3My41MDEgMTI4LjcxMSw3NC45MzEgMTI4LjI4Nyw3Ni4zNDggTDEyMS44MjcsOTcuOTc2IEMxMjEuODEsOTguMDM0IDEyMS43NzEsOTguMDgyIDEyMS43Miw5OC4xMTIgTDk0LjM5OCwxMTMuODg2IEM5NC4zNjIsMTEzLjkwNyA5NC4zMjIsMTEzLjkxNyA5NC4yODIsMTEzLjkxNyBMOTQuMjgyLDExMy45MTcgWiBNOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDExMy4yNzkgTDEyMS40MDYsOTcuNzU0IEwxMjcuODQsNzYuMjE1IEMxMjguMjksNzQuNzA4IDEyOS4xMzcsNzMuMjQ3IDEzMC4yMjQsNzIuMTAzIEMxMzEuNDI1LDcwLjgzOCAxMzIuNzkzLDcwLjExMiAxMzMuOTc3LDcwLjExMiBDMTM0Ljk5NSw3MC4xMTIgMTM1Ljc5NSw3MC42MzggMTM2LjIzLDcxLjU5MiBMMTQyLjU4NCw4NS41MjYgTDE2OS41NjYsNjkuOTQ4IEwxNjkuNTY2LDE5LjYxNyBMOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDYyLjk0OCBaIiBpZD0iRmlsbC0xOCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMDkuODk0LDkyLjk0MyBMMTA5Ljg5NCw5Mi45NDMgQzEwOC4xMiw5Mi45NDMgMTA2LjY1Myw5Mi4yMTggMTA1LjY1LDkwLjgyMyBDMTA1LjU4Myw5MC43MzEgMTA1LjU5Myw5MC42MSAxMDUuNjczLDkwLjUyOSBDMTA1Ljc1Myw5MC40NDggMTA1Ljg4LDkwLjQ0IDEwNS45NzQsOTAuNTA2IEMxMDYuNzU0LDkxLjA1MyAxMDcuNjc5LDkxLjMzMyAxMDguNzI0LDkxLjMzMyBDMTEwLjA0Nyw5MS4zMzMgMTExLjQ3OCw5MC44OTQgMTEyLjk4LDkwLjAyNyBDMTE4LjI5MSw4Ni45NiAxMjIuNjExLDc5LjUwOSAxMjIuNjExLDczLjQxNiBDMTIyLjYxMSw3MS40ODkgMTIyLjE2OSw2OS44NTYgMTIxLjMzMyw2OC42OTIgQzEyMS4yNjYsNjguNiAxMjEuMjc2LDY4LjQ3MyAxMjEuMzU2LDY4LjM5MiBDMTIxLjQzNiw2OC4zMTEgMTIxLjU2Myw2OC4yOTkgMTIxLjY1Niw2OC4zNjUgQzEyMy4zMjcsNjkuNTM3IDEyNC4yNDcsNzEuNzQ2IDEyNC4yNDcsNzQuNTg0IEMxMjQuMjQ3LDgwLjgyNiAxMTkuODIxLDg4LjQ0NyAxMTQuMzgyLDkxLjU4NyBDMTEyLjgwOCw5Mi40OTUgMTExLjI5OCw5Mi45NDMgMTA5Ljg5NCw5Mi45NDMgTDEwOS44OTQsOTIuOTQzIFogTTEwNi45MjUsOTEuNDAxIEMxMDcuNzM4LDkyLjA1MiAxMDguNzQ1LDkyLjI3OCAxMDkuODkzLDkyLjI3OCBMMTA5Ljg5NCw5Mi4yNzggQzExMS4yMTUsOTIuMjc4IDExMi42NDcsOTEuOTUxIDExNC4xNDgsOTEuMDg0IEMxMTkuNDU5LDg4LjAxNyAxMjMuNzgsODAuNjIxIDEyMy43OCw3NC41MjggQzEyMy43OCw3Mi41NDkgMTIzLjMxNyw3MC45MjkgMTIyLjQ1NCw2OS43NjcgQzEyMi44NjUsNzAuODAyIDEyMy4wNzksNzIuMDQyIDEyMy4wNzksNzMuNDAyIEMxMjMuMDc5LDc5LjY0NSAxMTguNjUzLDg3LjI4NSAxMTMuMjE0LDkwLjQyNSBDMTExLjY0LDkxLjMzNCAxMTAuMTMsOTEuNzQyIDEwOC43MjQsOTEuNzQyIEMxMDguMDgzLDkxLjc0MiAxMDcuNDgxLDkxLjU5MyAxMDYuOTI1LDkxLjQwMSBMMTA2LjkyNSw5MS40MDEgWiIgaWQ9IkZpbGwtMTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjA5Nyw5MC4yMyBDMTE4LjQ4MSw4Ny4xMjIgMTIyLjg0NSw3OS41OTQgMTIyLjg0NSw3My40MTYgQzEyMi44NDUsNzEuMzY1IDEyMi4zNjIsNjkuNzI0IDEyMS41MjIsNjguNTU2IEMxMTkuNzM4LDY3LjMwNCAxMTcuMTQ4LDY3LjM2MiAxMTQuMjY1LDY5LjAyNiBDMTA4Ljg4MSw3Mi4xMzQgMTA0LjUxNyw3OS42NjIgMTA0LjUxNyw4NS44NCBDMTA0LjUxNyw4Ny44OTEgMTA1LDg5LjUzMiAxMDUuODQsOTAuNyBDMTA3LjYyNCw5MS45NTIgMTEwLjIxNCw5MS44OTQgMTEzLjA5Nyw5MC4yMyIgaWQ9IkZpbGwtMjAiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTA4LjcyNCw5MS42MTQgTDEwOC43MjQsOTEuNjE0IEMxMDcuNTgyLDkxLjYxNCAxMDYuNTY2LDkxLjQwMSAxMDUuNzA1LDkwLjc5NyBDMTA1LjY4NCw5MC43ODMgMTA1LjY2NSw5MC44MTEgMTA1LjY1LDkwLjc5IEMxMDQuNzU2LDg5LjU0NiAxMDQuMjgzLDg3Ljg0MiAxMDQuMjgzLDg1LjgxNyBDMTA0LjI4Myw3OS41NzUgMTA4LjcwOSw3MS45NTMgMTE0LjE0OCw2OC44MTIgQzExNS43MjIsNjcuOTA0IDExNy4yMzIsNjcuNDQ5IDExOC42MzgsNjcuNDQ5IEMxMTkuNzgsNjcuNDQ5IDEyMC43OTYsNjcuNzU4IDEyMS42NTYsNjguMzYyIEMxMjEuNjc4LDY4LjM3NyAxMjEuNjk3LDY4LjM5NyAxMjEuNzEyLDY4LjQxOCBDMTIyLjYwNiw2OS42NjIgMTIzLjA3OSw3MS4zOSAxMjMuMDc5LDczLjQxNSBDMTIzLjA3OSw3OS42NTggMTE4LjY1Myw4Ny4xOTggMTEzLjIxNCw5MC4zMzggQzExMS42NCw5MS4yNDcgMTEwLjEzLDkxLjYxNCAxMDguNzI0LDkxLjYxNCBMMTA4LjcyNCw5MS42MTQgWiBNMTA2LjAwNiw5MC41MDUgQzEwNi43OCw5MS4wMzcgMTA3LjY5NCw5MS4yODEgMTA4LjcyNCw5MS4yODEgQzExMC4wNDcsOTEuMjgxIDExMS40NzgsOTAuODY4IDExMi45OCw5MC4wMDEgQzExOC4yOTEsODYuOTM1IDEyMi42MTEsNzkuNDk2IDEyMi42MTEsNzMuNDAzIEMxMjIuNjExLDcxLjQ5NCAxMjIuMTc3LDY5Ljg4IDEyMS4zNTYsNjguNzE4IEMxMjAuNTgyLDY4LjE4NSAxMTkuNjY4LDY3LjkxOSAxMTguNjM4LDY3LjkxOSBDMTE3LjMxNSw2Ny45MTkgMTE1Ljg4Myw2OC4zNiAxMTQuMzgyLDY5LjIyNyBDMTA5LjA3MSw3Mi4yOTMgMTA0Ljc1MSw3OS43MzMgMTA0Ljc1MSw4NS44MjYgQzEwNC43NTEsODcuNzM1IDEwNS4xODUsODkuMzQzIDEwNi4wMDYsOTAuNTA1IEwxMDYuMDA2LDkwLjUwNSBaIiBpZD0iRmlsbC0yMSIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDkuMzE4LDcuMjYyIEwxMzkuMzM0LDE2LjE0IEwxNTUuMjI3LDI3LjE3MSBMMTYwLjgxNiwyMS4wNTkgTDE0OS4zMTgsNy4yNjIiIGlkPSJGaWxsLTIyIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS42NzYsMTMuODQgTDE1OS45MjgsMTkuNDY3IEMxNTYuMjg2LDIxLjU3IDE1MC40LDIxLjU4IDE0Ni43ODEsMTkuNDkxIEMxNDMuMTYxLDE3LjQwMiAxNDMuMTgsMTQuMDAzIDE0Ni44MjIsMTEuOSBMMTU2LjMxNyw2LjI5MiBMMTQ5LjU4OCwyLjQwNyBMNjcuNzUyLDQ5LjQ3OCBMMTEzLjY3NSw3NS45OTIgTDExNi43NTYsNzQuMjEzIEMxMTcuMzg3LDczLjg0OCAxMTcuNjI1LDczLjMxNSAxMTcuMzc0LDcyLjgyMyBDMTE1LjAxNyw2OC4xOTEgMTE0Ljc4MSw2My4yNzcgMTE2LjY5MSw1OC41NjEgQzEyMi4zMjksNDQuNjQxIDE0MS4yLDMzLjc0NiAxNjUuMzA5LDMwLjQ5MSBDMTczLjQ3OCwyOS4zODggMTgxLjk4OSwyOS41MjQgMTkwLjAxMywzMC44ODUgQzE5MC44NjUsMzEuMDMgMTkxLjc4OSwzMC44OTMgMTkyLjQyLDMwLjUyOCBMMTk1LjUwMSwyOC43NSBMMTY5LjY3NiwxMy44NCIgaWQ9IkZpbGwtMjMiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3Ni40NTkgQzExMy41OTQsNzYuNDU5IDExMy41MTQsNzYuNDM4IDExMy40NDIsNzYuMzk3IEw2Ny41MTgsNDkuODgyIEM2Ny4zNzQsNDkuNzk5IDY3LjI4NCw0OS42NDUgNjcuMjg1LDQ5LjQ3OCBDNjcuMjg1LDQ5LjMxMSA2Ny4zNzQsNDkuMTU3IDY3LjUxOSw0OS4wNzMgTDE0OS4zNTUsMi4wMDIgQzE0OS40OTksMS45MTkgMTQ5LjY3NywxLjkxOSAxNDkuODIxLDIuMDAyIEwxNTYuNTUsNS44ODcgQzE1Ni43NzQsNi4wMTcgMTU2Ljg1LDYuMzAyIDE1Ni43MjIsNi41MjYgQzE1Ni41OTIsNi43NDkgMTU2LjMwNyw2LjgyNiAxNTYuMDgzLDYuNjk2IEwxNDkuNTg3LDIuOTQ2IEw2OC42ODcsNDkuNDc5IEwxMTMuNjc1LDc1LjQ1MiBMMTE2LjUyMyw3My44MDggQzExNi43MTUsNzMuNjk3IDExNy4xNDMsNzMuMzk5IDExNi45NTgsNzMuMDM1IEMxMTQuNTQyLDY4LjI4NyAxMTQuMyw2My4yMjEgMTE2LjI1OCw1OC4zODUgQzExOS4wNjQsNTEuNDU4IDEyNS4xNDMsNDUuMTQzIDEzMy44NCw0MC4xMjIgQzE0Mi40OTcsMzUuMTI0IDE1My4zNTgsMzEuNjMzIDE2NS4yNDcsMzAuMDI4IEMxNzMuNDQ1LDI4LjkyMSAxODIuMDM3LDI5LjA1OCAxOTAuMDkxLDMwLjQyNSBDMTkwLjgzLDMwLjU1IDE5MS42NTIsMzAuNDMyIDE5Mi4xODYsMzAuMTI0IEwxOTQuNTY3LDI4Ljc1IEwxNjkuNDQyLDE0LjI0NCBDMTY5LjIxOSwxNC4xMTUgMTY5LjE0MiwxMy44MjkgMTY5LjI3MSwxMy42MDYgQzE2OS40LDEzLjM4MiAxNjkuNjg1LDEzLjMwNiAxNjkuOTA5LDEzLjQzNSBMMTk1LjczNCwyOC4zNDUgQzE5NS44NzksMjguNDI4IDE5NS45NjgsMjguNTgzIDE5NS45NjgsMjguNzUgQzE5NS45NjgsMjguOTE2IDE5NS44NzksMjkuMDcxIDE5NS43MzQsMjkuMTU0IEwxOTIuNjUzLDMwLjkzMyBDMTkxLjkzMiwzMS4zNSAxOTAuODksMzEuNTA4IDE4OS45MzUsMzEuMzQ2IEMxODEuOTcyLDI5Ljk5NSAxNzMuNDc4LDI5Ljg2IDE2NS4zNzIsMzAuOTU0IEMxNTMuNjAyLDMyLjU0MyAxNDIuODYsMzUuOTkzIDEzNC4zMDcsNDAuOTMxIEMxMjUuNzkzLDQ1Ljg0NyAxMTkuODUxLDUyLjAwNCAxMTcuMTI0LDU4LjczNiBDMTE1LjI3LDYzLjMxNCAxMTUuNTAxLDY4LjExMiAxMTcuNzksNzIuNjExIEMxMTguMTYsNzMuMzM2IDExNy44NDUsNzQuMTI0IDExNi45OSw3NC42MTcgTDExMy45MDksNzYuMzk3IEMxMTMuODM2LDc2LjQzOCAxMTMuNzU2LDc2LjQ1OSAxMTMuNjc1LDc2LjQ1OSIgaWQ9IkZpbGwtMjQiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUzLjMxNiwyMS4yNzkgQzE1MC45MDMsMjEuMjc5IDE0OC40OTUsMjAuNzUxIDE0Ni42NjQsMTkuNjkzIEMxNDQuODQ2LDE4LjY0NCAxNDMuODQ0LDE3LjIzMiAxNDMuODQ0LDE1LjcxOCBDMTQzLjg0NCwxNC4xOTEgMTQ0Ljg2LDEyLjc2MyAxNDYuNzA1LDExLjY5OCBMMTU2LjE5OCw2LjA5MSBDMTU2LjMwOSw2LjAyNSAxNTYuNDUyLDYuMDYyIDE1Ni41MTgsNi4xNzMgQzE1Ni41ODMsNi4yODQgMTU2LjU0Nyw2LjQyNyAxNTYuNDM2LDYuNDkzIEwxNDYuOTQsMTIuMTAyIEMxNDUuMjQ0LDEzLjA4MSAxNDQuMzEyLDE0LjM2NSAxNDQuMzEyLDE1LjcxOCBDMTQ0LjMxMiwxNy4wNTggMTQ1LjIzLDE4LjMyNiAxNDYuODk3LDE5LjI4OSBDMTUwLjQ0NiwyMS4zMzggMTU2LjI0LDIxLjMyNyAxNTkuODExLDE5LjI2NSBMMTY5LjU1OSwxMy42MzcgQzE2OS42NywxMy41NzMgMTY5LjgxMywxMy42MTEgMTY5Ljg3OCwxMy43MjMgQzE2OS45NDMsMTMuODM0IDE2OS45MDQsMTMuOTc3IDE2OS43OTMsMTQuMDQyIEwxNjAuMDQ1LDE5LjY3IEMxNTguMTg3LDIwLjc0MiAxNTUuNzQ5LDIxLjI3OSAxNTMuMzE2LDIxLjI3OSIgaWQ9IkZpbGwtMjUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3NS45OTIgTDY3Ljc2Miw0OS40ODQiIGlkPSJGaWxsLTI2IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMy42NzUsNzYuMzQyIEMxMTMuNjE1LDc2LjM0MiAxMTMuNTU1LDc2LjMyNyAxMTMuNSw3Ni4yOTUgTDY3LjU4Nyw0OS43ODcgQzY3LjQxOSw0OS42OSA2Ny4zNjIsNDkuNDc2IDY3LjQ1OSw0OS4zMDkgQzY3LjU1Niw0OS4xNDEgNjcuNzcsNDkuMDgzIDY3LjkzNyw0OS4xOCBMMTEzLjg1LDc1LjY4OCBDMTE0LjAxOCw3NS43ODUgMTE0LjA3NSw3NiAxMTMuOTc4LDc2LjE2NyBDMTEzLjkxNCw3Ni4yNzkgMTEzLjc5Niw3Ni4zNDIgMTEzLjY3NSw3Ni4zNDIiIGlkPSJGaWxsLTI3IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY3Ljc2Miw0OS40ODQgTDY3Ljc2MiwxMDMuNDg1IEM2Ny43NjIsMTA0LjU3NSA2OC41MzIsMTA1LjkwMyA2OS40ODIsMTA2LjQ1MiBMMTExLjk1NSwxMzAuOTczIEMxMTIuOTA1LDEzMS41MjIgMTEzLjY3NSwxMzEuMDgzIDExMy42NzUsMTI5Ljk5MyBMMTEzLjY3NSw3NS45OTIiIGlkPSJGaWxsLTI4IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMi43MjcsMTMxLjU2MSBDMTEyLjQzLDEzMS41NjEgMTEyLjEwNywxMzEuNDY2IDExMS43OCwxMzEuMjc2IEw2OS4zMDcsMTA2Ljc1NSBDNjguMjQ0LDEwNi4xNDIgNjcuNDEyLDEwNC43MDUgNjcuNDEyLDEwMy40ODUgTDY3LjQxMiw0OS40ODQgQzY3LjQxMiw0OS4yOSA2Ny41NjksNDkuMTM0IDY3Ljc2Miw0OS4xMzQgQzY3Ljk1Niw0OS4xMzQgNjguMTEzLDQ5LjI5IDY4LjExMyw0OS40ODQgTDY4LjExMywxMDMuNDg1IEM2OC4xMTMsMTA0LjQ0NSA2OC44MiwxMDUuNjY1IDY5LjY1NywxMDYuMTQ4IEwxMTIuMTMsMTMwLjY3IEMxMTIuNDc0LDEzMC44NjggMTEyLjc5MSwxMzAuOTEzIDExMywxMzAuNzkyIEMxMTMuMjA2LDEzMC42NzMgMTEzLjMyNSwxMzAuMzgxIDExMy4zMjUsMTI5Ljk5MyBMMTEzLjMyNSw3NS45OTIgQzExMy4zMjUsNzUuNzk4IDExMy40ODIsNzUuNjQxIDExMy42NzUsNzUuNjQxIEMxMTMuODY5LDc1LjY0MSAxMTQuMDI1LDc1Ljc5OCAxMTQuMDI1LDc1Ljk5MiBMMTE0LjAyNSwxMjkuOTkzIEMxMTQuMDI1LDEzMC42NDggMTEzLjc4NiwxMzEuMTQ3IDExMy4zNSwxMzEuMzk5IEMxMTMuMTYyLDEzMS41MDcgMTEyLjk1MiwxMzEuNTYxIDExMi43MjcsMTMxLjU2MSIgaWQ9IkZpbGwtMjkiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEyLjg2LDQwLjUxMiBDMTEyLjg2LDQwLjUxMiAxMTIuODYsNDAuNTEyIDExMi44NTksNDAuNTEyIEMxMTAuNTQxLDQwLjUxMiAxMDguMzYsMzkuOTkgMTA2LjcxNywzOS4wNDEgQzEwNS4wMTIsMzguMDU3IDEwNC4wNzQsMzYuNzI2IDEwNC4wNzQsMzUuMjkyIEMxMDQuMDc0LDMzLjg0NyAxMDUuMDI2LDMyLjUwMSAxMDYuNzU0LDMxLjUwNCBMMTE4Ljc5NSwyNC41NTEgQzEyMC40NjMsMjMuNTg5IDEyMi42NjksMjMuMDU4IDEyNS4wMDcsMjMuMDU4IEMxMjcuMzI1LDIzLjA1OCAxMjkuNTA2LDIzLjU4MSAxMzEuMTUsMjQuNTMgQzEzMi44NTQsMjUuNTE0IDEzMy43OTMsMjYuODQ1IDEzMy43OTMsMjguMjc4IEMxMzMuNzkzLDI5LjcyNCAxMzIuODQxLDMxLjA2OSAxMzEuMTEzLDMyLjA2NyBMMTE5LjA3MSwzOS4wMTkgQzExNy40MDMsMzkuOTgyIDExNS4xOTcsNDAuNTEyIDExMi44Niw0MC41MTIgTDExMi44Niw0MC41MTIgWiBNMTI1LjAwNywyMy43NTkgQzEyMi43OSwyMy43NTkgMTIwLjcwOSwyNC4yNTYgMTE5LjE0NiwyNS4xNTggTDEwNy4xMDQsMzIuMTEgQzEwNS42MDIsMzIuOTc4IDEwNC43NzQsMzQuMTA4IDEwNC43NzQsMzUuMjkyIEMxMDQuNzc0LDM2LjQ2NSAxMDUuNTg5LDM3LjU4MSAxMDcuMDY3LDM4LjQzNCBDMTA4LjYwNSwzOS4zMjMgMTEwLjY2MywzOS44MTIgMTEyLjg1OSwzOS44MTIgTDExMi44NiwzOS44MTIgQzExNS4wNzYsMzkuODEyIDExNy4xNTgsMzkuMzE1IDExOC43MjEsMzguNDEzIEwxMzAuNzYyLDMxLjQ2IEMxMzIuMjY0LDMwLjU5MyAxMzMuMDkyLDI5LjQ2MyAxMzMuMDkyLDI4LjI3OCBDMTMzLjA5MiwyNy4xMDYgMTMyLjI3OCwyNS45OSAxMzAuOCwyNS4xMzYgQzEyOS4yNjEsMjQuMjQ4IDEyNy4yMDQsMjMuNzU5IDEyNS4wMDcsMjMuNzU5IEwxMjUuMDA3LDIzLjc1OSBaIiBpZD0iRmlsbC0zMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNjUuNjMsMTYuMjE5IEwxNTkuODk2LDE5LjUzIEMxNTYuNzI5LDIxLjM1OCAxNTEuNjEsMjEuMzY3IDE0OC40NjMsMTkuNTUgQzE0NS4zMTYsMTcuNzMzIDE0NS4zMzIsMTQuNzc4IDE0OC40OTksMTIuOTQ5IEwxNTQuMjMzLDkuNjM5IEwxNjUuNjMsMTYuMjE5IiBpZD0iRmlsbC0zMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNTQuMjMzLDEwLjQ0OCBMMTY0LjIyOCwxNi4yMTkgTDE1OS41NDYsMTguOTIzIEMxNTguMTEyLDE5Ljc1IDE1Ni4xOTQsMjAuMjA2IDE1NC4xNDcsMjAuMjA2IEMxNTIuMTE4LDIwLjIwNiAxNTAuMjI0LDE5Ljc1NyAxNDguODE0LDE4Ljk0MyBDMTQ3LjUyNCwxOC4xOTkgMTQ2LjgxNCwxNy4yNDkgMTQ2LjgxNCwxNi4yNjkgQzE0Ni44MTQsMTUuMjc4IDE0Ny41MzcsMTQuMzE0IDE0OC44NSwxMy41NTYgTDE1NC4yMzMsMTAuNDQ4IE0xNTQuMjMzLDkuNjM5IEwxNDguNDk5LDEyLjk0OSBDMTQ1LjMzMiwxNC43NzggMTQ1LjMxNiwxNy43MzMgMTQ4LjQ2MywxOS41NSBDMTUwLjAzMSwyMC40NTUgMTUyLjA4NiwyMC45MDcgMTU0LjE0NywyMC45MDcgQzE1Ni4yMjQsMjAuOTA3IDE1OC4zMDYsMjAuNDQ3IDE1OS44OTYsMTkuNTMgTDE2NS42MywxNi4yMTkgTDE1NC4yMzMsOS42MzkiIGlkPSJGaWxsLTMyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NS40NDUsNzIuNjY3IEwxNDUuNDQ1LDcyLjY2NyBDMTQzLjY3Miw3Mi42NjcgMTQyLjIwNCw3MS44MTcgMTQxLjIwMiw3MC40MjIgQzE0MS4xMzUsNzAuMzMgMTQxLjE0NSw3MC4xNDcgMTQxLjIyNSw3MC4wNjYgQzE0MS4zMDUsNjkuOTg1IDE0MS40MzIsNjkuOTQ2IDE0MS41MjUsNzAuMDExIEMxNDIuMzA2LDcwLjU1OSAxNDMuMjMxLDcwLjgyMyAxNDQuMjc2LDcwLjgyMiBDMTQ1LjU5OCw3MC44MjIgMTQ3LjAzLDcwLjM3NiAxNDguNTMyLDY5LjUwOSBDMTUzLjg0Miw2Ni40NDMgMTU4LjE2Myw1OC45ODcgMTU4LjE2Myw1Mi44OTQgQzE1OC4xNjMsNTAuOTY3IDE1Ny43MjEsNDkuMzMyIDE1Ni44ODQsNDguMTY4IEMxNTYuODE4LDQ4LjA3NiAxNTYuODI4LDQ3Ljk0OCAxNTYuOTA4LDQ3Ljg2NyBDMTU2Ljk4OCw0Ny43ODYgMTU3LjExNCw0Ny43NzQgMTU3LjIwOCw0Ny44NCBDMTU4Ljg3OCw0OS4wMTIgMTU5Ljc5OCw1MS4yMiAxNTkuNzk4LDU0LjA1OSBDMTU5Ljc5OCw2MC4zMDEgMTU1LjM3Myw2OC4wNDYgMTQ5LjkzMyw3MS4xODYgQzE0OC4zNiw3Mi4wOTQgMTQ2Ljg1LDcyLjY2NyAxNDUuNDQ1LDcyLjY2NyBMMTQ1LjQ0NSw3Mi42NjcgWiBNMTQyLjQ3Niw3MSBDMTQzLjI5LDcxLjY1MSAxNDQuMjk2LDcyLjAwMiAxNDUuNDQ1LDcyLjAwMiBDMTQ2Ljc2Nyw3Mi4wMDIgMTQ4LjE5OCw3MS41NSAxNDkuNyw3MC42ODIgQzE1NS4wMSw2Ny42MTcgMTU5LjMzMSw2MC4xNTkgMTU5LjMzMSw1NC4wNjUgQzE1OS4zMzEsNTIuMDg1IDE1OC44NjgsNTAuNDM1IDE1OC4wMDYsNDkuMjcyIEMxNTguNDE3LDUwLjMwNyAxNTguNjMsNTEuNTMyIDE1OC42Myw1Mi44OTIgQzE1OC42Myw1OS4xMzQgMTU0LjIwNSw2Ni43NjcgMTQ4Ljc2NSw2OS45MDcgQzE0Ny4xOTIsNzAuODE2IDE0NS42ODEsNzEuMjgzIDE0NC4yNzYsNzEuMjgzIEMxNDMuNjM0LDcxLjI4MyAxNDMuMDMzLDcxLjE5MiAxNDIuNDc2LDcxIEwxNDIuNDc2LDcxIFoiIGlkPSJGaWxsLTMzIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0OC42NDgsNjkuNzA0IEMxNTQuMDMyLDY2LjU5NiAxNTguMzk2LDU5LjA2OCAxNTguMzk2LDUyLjg5MSBDMTU4LjM5Niw1MC44MzkgMTU3LjkxMyw0OS4xOTggMTU3LjA3NCw0OC4wMyBDMTU1LjI4OSw0Ni43NzggMTUyLjY5OSw0Ni44MzYgMTQ5LjgxNiw0OC41MDEgQzE0NC40MzMsNTEuNjA5IDE0MC4wNjgsNTkuMTM3IDE0MC4wNjgsNjUuMzE0IEMxNDAuMDY4LDY3LjM2NSAxNDAuNTUyLDY5LjAwNiAxNDEuMzkxLDcwLjE3NCBDMTQzLjE3Niw3MS40MjcgMTQ1Ljc2NSw3MS4zNjkgMTQ4LjY0OCw2OS43MDQiIGlkPSJGaWxsLTM0IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NC4yNzYsNzEuMjc2IEwxNDQuMjc2LDcxLjI3NiBDMTQzLjEzMyw3MS4yNzYgMTQyLjExOCw3MC45NjkgMTQxLjI1Nyw3MC4zNjUgQzE0MS4yMzYsNzAuMzUxIDE0MS4yMTcsNzAuMzMyIDE0MS4yMDIsNzAuMzExIEMxNDAuMzA3LDY5LjA2NyAxMzkuODM1LDY3LjMzOSAxMzkuODM1LDY1LjMxNCBDMTM5LjgzNSw1OS4wNzMgMTQ0LjI2LDUxLjQzOSAxNDkuNyw0OC4yOTggQzE1MS4yNzMsNDcuMzkgMTUyLjc4NCw0Ni45MjkgMTU0LjE4OSw0Ni45MjkgQzE1NS4zMzIsNDYuOTI5IDE1Ni4zNDcsNDcuMjM2IDE1Ny4yMDgsNDcuODM5IEMxNTcuMjI5LDQ3Ljg1NCAxNTcuMjQ4LDQ3Ljg3MyAxNTcuMjYzLDQ3Ljg5NCBDMTU4LjE1Nyw0OS4xMzggMTU4LjYzLDUwLjg2NSAxNTguNjMsNTIuODkxIEMxNTguNjMsNTkuMTMyIDE1NC4yMDUsNjYuNzY2IDE0OC43NjUsNjkuOTA3IEMxNDcuMTkyLDcwLjgxNSAxNDUuNjgxLDcxLjI3NiAxNDQuMjc2LDcxLjI3NiBMMTQ0LjI3Niw3MS4yNzYgWiBNMTQxLjU1OCw3MC4xMDQgQzE0Mi4zMzEsNzAuNjM3IDE0My4yNDUsNzEuMDA1IDE0NC4yNzYsNzEuMDA1IEMxNDUuNTk4LDcxLjAwNSAxNDcuMDMsNzAuNDY3IDE0OC41MzIsNjkuNiBDMTUzLjg0Miw2Ni41MzQgMTU4LjE2Myw1OS4wMzMgMTU4LjE2Myw1Mi45MzkgQzE1OC4xNjMsNTEuMDMxIDE1Ny43MjksNDkuMzg1IDE1Ni45MDcsNDguMjIzIEMxNTYuMTMzLDQ3LjY5MSAxNTUuMjE5LDQ3LjQwOSAxNTQuMTg5LDQ3LjQwOSBDMTUyLjg2Nyw0Ny40MDkgMTUxLjQzNSw0Ny44NDIgMTQ5LjkzMyw0OC43MDkgQzE0NC42MjMsNTEuNzc1IDE0MC4zMDIsNTkuMjczIDE0MC4zMDIsNjUuMzY2IEMxNDAuMzAyLDY3LjI3NiAxNDAuNzM2LDY4Ljk0MiAxNDEuNTU4LDcwLjEwNCBMMTQxLjU1OCw3MC4xMDQgWiIgaWQ9IkZpbGwtMzUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUwLjcyLDY1LjM2MSBMMTUwLjM1Nyw2NS4wNjYgQzE1MS4xNDcsNjQuMDkyIDE1MS44NjksNjMuMDQgMTUyLjUwNSw2MS45MzggQzE1My4zMTMsNjAuNTM5IDE1My45NzgsNTkuMDY3IDE1NC40ODIsNTcuNTYzIEwxNTQuOTI1LDU3LjcxMiBDMTU0LjQxMiw1OS4yNDUgMTUzLjczMyw2MC43NDUgMTUyLjkxLDYyLjE3MiBDMTUyLjI2Miw2My4yOTUgMTUxLjUyNSw2NC4zNjggMTUwLjcyLDY1LjM2MSIgaWQ9IkZpbGwtMzYiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE1LjkxNyw4NC41MTQgTDExNS41NTQsODQuMjIgQzExNi4zNDQsODMuMjQ1IDExNy4wNjYsODIuMTk0IDExNy43MDIsODEuMDkyIEMxMTguNTEsNzkuNjkyIDExOS4xNzUsNzguMjIgMTE5LjY3OCw3Ni43MTcgTDEyMC4xMjEsNzYuODY1IEMxMTkuNjA4LDc4LjM5OCAxMTguOTMsNzkuODk5IDExOC4xMDYsODEuMzI2IEMxMTcuNDU4LDgyLjQ0OCAxMTYuNzIyLDgzLjUyMSAxMTUuOTE3LDg0LjUxNCIgaWQ9IkZpbGwtMzciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE0LDEzMC40NzYgTDExNCwxMzAuMDA4IEwxMTQsNzYuMDUyIEwxMTQsNzUuNTg0IEwxMTQsNzYuMDUyIEwxMTQsMTMwLjAwOCBMMTE0LDEzMC40NzYiIGlkPSJGaWxsLTM4IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYyLjAwMDAwMCwgMC4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTkuODIyLDM3LjQ3NCBDMTkuODM5LDM3LjMzOSAxOS43NDcsMzcuMTk0IDE5LjU1NSwzNy4wODIgQzE5LjIyOCwzNi44OTQgMTguNzI5LDM2Ljg3MiAxOC40NDYsMzcuMDM3IEwxMi40MzQsNDAuNTA4IEMxMi4zMDMsNDAuNTg0IDEyLjI0LDQwLjY4NiAxMi4yNDMsNDAuNzkzIEMxMi4yNDUsNDAuOTI1IDEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQxLjM3MSBMMTIuMjQ1LDQxLjQxNCBMMTIuMjM4LDQxLjU0MiBDOC4xNDgsNDMuODg3IDUuNjQ3LDQ1LjMyMSA1LjY0Nyw0NS4zMjEgQzUuNjQ2LDQ1LjMyMSAzLjU3LDQ2LjM2NyAyLjg2LDUwLjUxMyBDMi44Niw1MC41MTMgMS45NDgsNTcuNDc0IDEuOTYyLDcwLjI1OCBDMS45NzcsODIuODI4IDIuNTY4LDg3LjMyOCAzLjEyOSw5MS42MDkgQzMuMzQ5LDkzLjI5MyA2LjEzLDkzLjczNCA2LjEzLDkzLjczNCBDNi40NjEsOTMuNzc0IDYuODI4LDkzLjcwNyA3LjIxLDkzLjQ4NiBMODIuNDgzLDQ5LjkzNSBDODQuMjkxLDQ4Ljg2NiA4NS4xNSw0Ni4yMTYgODUuNTM5LDQzLjY1MSBDODYuNzUyLDM1LjY2MSA4Ny4yMTQsMTAuNjczIDg1LjI2NCwzLjc3MyBDODUuMDY4LDMuMDggODQuNzU0LDIuNjkgODQuMzk2LDIuNDkxIEw4Mi4zMSwxLjcwMSBDODEuNTgzLDEuNzI5IDgwLjg5NCwyLjE2OCA4MC43NzYsMi4yMzYgQzgwLjYzNiwyLjMxNyA0MS44MDcsMjQuNTg1IDIwLjAzMiwzNy4wNzIgTDE5LjgyMiwzNy40NzQiIGlkPSJGaWxsLTEiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNODIuMzExLDEuNzAxIEw4NC4zOTYsMi40OTEgQzg0Ljc1NCwyLjY5IDg1LjA2OCwzLjA4IDg1LjI2NCwzLjc3MyBDODcuMjEzLDEwLjY3MyA4Ni43NTEsMzUuNjYgODUuNTM5LDQzLjY1MSBDODUuMTQ5LDQ2LjIxNiA4NC4yOSw0OC44NjYgODIuNDgzLDQ5LjkzNSBMNy4yMSw5My40ODYgQzYuODk3LDkzLjY2NyA2LjU5NSw5My43NDQgNi4zMTQsOTMuNzQ0IEw2LjEzMSw5My43MzMgQzYuMTMxLDkzLjczNCAzLjM0OSw5My4yOTMgMy4xMjgsOTEuNjA5IEMyLjU2OCw4Ny4zMjcgMS45NzcsODIuODI4IDEuOTYzLDcwLjI1OCBDMS45NDgsNTcuNDc0IDIuODYsNTAuNTEzIDIuODYsNTAuNTEzIEMzLjU3LDQ2LjM2NyA1LjY0Nyw0NS4zMjEgNS42NDcsNDUuMzIxIEM1LjY0Nyw0NS4zMjEgOC4xNDgsNDMuODg3IDEyLjIzOCw0MS41NDIgTDEyLjI0NSw0MS40MTQgTDEyLjI0NSw0MS4zNzEgQzEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQwLjkyNSAxMi4yNDMsNDAuNzkzIEMxMi4yNCw0MC42ODYgMTIuMzAyLDQwLjU4MyAxMi40MzQsNDAuNTA4IEwxOC40NDYsMzcuMDM2IEMxOC41NzQsMzYuOTYyIDE4Ljc0NiwzNi45MjYgMTguOTI3LDM2LjkyNiBDMTkuMTQ1LDM2LjkyNiAxOS4zNzYsMzYuOTc5IDE5LjU1NCwzNy4wODIgQzE5Ljc0NywzNy4xOTQgMTkuODM5LDM3LjM0IDE5LjgyMiwzNy40NzQgTDIwLjAzMywzNy4wNzIgQzQxLjgwNiwyNC41ODUgODAuNjM2LDIuMzE4IDgwLjc3NywyLjIzNiBDODAuODk0LDIuMTY4IDgxLjU4MywxLjcyOSA4Mi4zMTEsMS43MDEgTTgyLjMxMSwwLjcwNCBMODIuMjcyLDAuNzA1IEM4MS42NTQsMC43MjggODAuOTg5LDAuOTQ5IDgwLjI5OCwxLjM2MSBMODAuMjc3LDEuMzczIEM4MC4xMjksMS40NTggNTkuNzY4LDEzLjEzNSAxOS43NTgsMzYuMDc5IEMxOS41LDM1Ljk4MSAxOS4yMTQsMzUuOTI5IDE4LjkyNywzNS45MjkgQzE4LjU2MiwzNS45MjkgMTguMjIzLDM2LjAxMyAxNy45NDcsMzYuMTczIEwxMS45MzUsMzkuNjQ0IEMxMS40OTMsMzkuODk5IDExLjIzNiw0MC4zMzQgMTEuMjQ2LDQwLjgxIEwxMS4yNDcsNDAuOTYgTDUuMTY3LDQ0LjQ0NyBDNC43OTQsNDQuNjQ2IDIuNjI1LDQ1Ljk3OCAxLjg3Nyw1MC4zNDUgTDEuODcxLDUwLjM4NCBDMS44NjIsNTAuNDU0IDAuOTUxLDU3LjU1NyAwLjk2NSw3MC4yNTkgQzAuOTc5LDgyLjg3OSAxLjU2OCw4Ny4zNzUgMi4xMzcsOTEuNzI0IEwyLjEzOSw5MS43MzkgQzIuNDQ3LDk0LjA5NCA1LjYxNCw5NC42NjIgNS45NzUsOTQuNzE5IEw2LjAwOSw5NC43MjMgQzYuMTEsOTQuNzM2IDYuMjEzLDk0Ljc0MiA2LjMxNCw5NC43NDIgQzYuNzksOTQuNzQyIDcuMjYsOTQuNjEgNy43MSw5NC4zNSBMODIuOTgzLDUwLjc5OCBDODQuNzk0LDQ5LjcyNyA4NS45ODIsNDcuMzc1IDg2LjUyNSw0My44MDEgQzg3LjcxMSwzNS45ODcgODguMjU5LDEwLjcwNSA4Ni4yMjQsMy41MDIgQzg1Ljk3MSwyLjYwOSA4NS41MiwxLjk3NSA4NC44ODEsMS42MiBMODQuNzQ5LDEuNTU4IEw4Mi42NjQsMC43NjkgQzgyLjU1MSwwLjcyNSA4Mi40MzEsMC43MDQgODIuMzExLDAuNzA0IiBpZD0iRmlsbC0yIiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY2LjI2NywxMS41NjUgTDY3Ljc2MiwxMS45OTkgTDExLjQyMyw0NC4zMjUiIGlkPSJGaWxsLTMiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMjAyLDkwLjU0NSBDMTIuMDI5LDkwLjU0NSAxMS44NjIsOTAuNDU1IDExLjc2OSw5MC4yOTUgQzExLjYzMiw5MC4wNTcgMTEuNzEzLDg5Ljc1MiAxMS45NTIsODkuNjE0IEwzMC4zODksNzguOTY5IEMzMC42MjgsNzguODMxIDMwLjkzMyw3OC45MTMgMzEuMDcxLDc5LjE1MiBDMzEuMjA4LDc5LjM5IDMxLjEyNyw3OS42OTYgMzAuODg4LDc5LjgzMyBMMTIuNDUxLDkwLjQ3OCBMMTIuMjAyLDkwLjU0NSIgaWQ9IkZpbGwtNCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy43NjQsNDIuNjU0IEwxMy42NTYsNDIuNTkyIEwxMy43MDIsNDIuNDIxIEwxOC44MzcsMzkuNDU3IEwxOS4wMDcsMzkuNTAyIEwxOC45NjIsMzkuNjczIEwxMy44MjcsNDIuNjM3IEwxMy43NjQsNDIuNjU0IiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTguNTIsOTAuMzc1IEw4LjUyLDQ2LjQyMSBMOC41ODMsNDYuMzg1IEw3NS44NCw3LjU1NCBMNzUuODQsNTEuNTA4IEw3NS43NzgsNTEuNTQ0IEw4LjUyLDkwLjM3NSBMOC41Miw5MC4zNzUgWiBNOC43Nyw0Ni41NjQgTDguNzcsODkuOTQ0IEw3NS41OTEsNTEuMzY1IEw3NS41OTEsNy45ODUgTDguNzcsNDYuNTY0IEw4Ljc3LDQ2LjU2NCBaIiBpZD0iRmlsbC02IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTI0Ljk4Niw4My4xODIgQzI0Ljc1Niw4My4zMzEgMjQuMzc0LDgzLjU2NiAyNC4xMzcsODMuNzA1IEwxMi42MzIsOTAuNDA2IEMxMi4zOTUsOTAuNTQ1IDEyLjQyNiw5MC42NTggMTIuNyw5MC42NTggTDEzLjI2NSw5MC42NTggQzEzLjU0LDkwLjY1OCAxMy45NTgsOTAuNTQ1IDE0LjE5NSw5MC40MDYgTDI1LjcsODMuNzA1IEMyNS45MzcsODMuNTY2IDI2LjEyOCw4My40NTIgMjYuMTI1LDgzLjQ0OSBDMjYuMTIyLDgzLjQ0NyAyNi4xMTksODMuMjIgMjYuMTE5LDgyLjk0NiBDMjYuMTE5LDgyLjY3MiAyNS45MzEsODIuNTY5IDI1LjcwMSw4Mi43MTkgTDI0Ljk4Niw4My4xODIiIGlkPSJGaWxsLTciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTMuMjY2LDkwLjc4MiBMMTIuNyw5MC43ODIgQzEyLjUsOTAuNzgyIDEyLjM4NCw5MC43MjYgMTIuMzU0LDkwLjYxNiBDMTIuMzI0LDkwLjUwNiAxMi4zOTcsOTAuMzk5IDEyLjU2OSw5MC4yOTkgTDI0LjA3NCw4My41OTcgQzI0LjMxLDgzLjQ1OSAyNC42ODksODMuMjI2IDI0LjkxOCw4My4wNzggTDI1LjYzMyw4Mi42MTQgQzI1LjcyMyw4Mi41NTUgMjUuODEzLDgyLjUyNSAyNS44OTksODIuNTI1IEMyNi4wNzEsODIuNTI1IDI2LjI0NCw4Mi42NTUgMjYuMjQ0LDgyLjk0NiBDMjYuMjQ0LDgzLjE2IDI2LjI0NSw4My4zMDkgMjYuMjQ3LDgzLjM4MyBMMjYuMjUzLDgzLjM4NyBMMjYuMjQ5LDgzLjQ1NiBDMjYuMjQ2LDgzLjUzMSAyNi4yNDYsODMuNTMxIDI1Ljc2Myw4My44MTIgTDE0LjI1OCw5MC41MTQgQzE0LDkwLjY2NSAxMy41NjQsOTAuNzgyIDEzLjI2Niw5MC43ODIgTDEzLjI2Niw5MC43ODIgWiBNMTIuNjY2LDkwLjUzMiBMMTIuNyw5MC41MzMgTDEzLjI2Niw5MC41MzMgQzEzLjUxOCw5MC41MzMgMTMuOTE1LDkwLjQyNSAxNC4xMzIsOTAuMjk5IEwyNS42MzcsODMuNTk3IEMyNS44MDUsODMuNDk5IDI1LjkzMSw4My40MjQgMjUuOTk4LDgzLjM4MyBDMjUuOTk0LDgzLjI5OSAyNS45OTQsODMuMTY1IDI1Ljk5NCw4Mi45NDYgTDI1Ljg5OSw4Mi43NzUgTDI1Ljc2OCw4Mi44MjQgTDI1LjA1NCw4My4yODcgQzI0LjgyMiw4My40MzcgMjQuNDM4LDgzLjY3MyAyNC4yLDgzLjgxMiBMMTIuNjk1LDkwLjUxNCBMMTIuNjY2LDkwLjUzMiBMMTIuNjY2LDkwLjUzMiBaIiBpZD0iRmlsbC04IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEzLjI2Niw4OS44NzEgTDEyLjcsODkuODcxIEMxMi41LDg5Ljg3MSAxMi4zODQsODkuODE1IDEyLjM1NCw4OS43MDUgQzEyLjMyNCw4OS41OTUgMTIuMzk3LDg5LjQ4OCAxMi41NjksODkuMzg4IEwyNC4wNzQsODIuNjg2IEMyNC4zMzIsODIuNTM1IDI0Ljc2OCw4Mi40MTggMjUuMDY3LDgyLjQxOCBMMjUuNjMyLDgyLjQxOCBDMjUuODMyLDgyLjQxOCAyNS45NDgsODIuNDc0IDI1Ljk3OCw4Mi41ODQgQzI2LjAwOCw4Mi42OTQgMjUuOTM1LDgyLjgwMSAyNS43NjMsODIuOTAxIEwxNC4yNTgsODkuNjAzIEMxNCw4OS43NTQgMTMuNTY0LDg5Ljg3MSAxMy4yNjYsODkuODcxIEwxMy4yNjYsODkuODcxIFogTTEyLjY2Niw4OS42MjEgTDEyLjcsODkuNjIyIEwxMy4yNjYsODkuNjIyIEMxMy41MTgsODkuNjIyIDEzLjkxNSw4OS41MTUgMTQuMTMyLDg5LjM4OCBMMjUuNjM3LDgyLjY4NiBMMjUuNjY3LDgyLjY2OCBMMjUuNjMyLDgyLjY2NyBMMjUuMDY3LDgyLjY2NyBDMjQuODE1LDgyLjY2NyAyNC40MTgsODIuNzc1IDI0LjIsODIuOTAxIEwxMi42OTUsODkuNjAzIEwxMi42NjYsODkuNjIxIEwxMi42NjYsODkuNjIxIFoiIGlkPSJGaWxsLTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMzcsOTAuODAxIEwxMi4zNyw4OS41NTQgTDEyLjM3LDkwLjgwMSIgaWQ9IkZpbGwtMTAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi4xMyw5My45MDEgQzUuMzc5LDkzLjgwOCA0LjgxNiw5My4xNjQgNC42OTEsOTIuNTI1IEMzLjg2LDg4LjI4NyAzLjU0LDgzLjc0MyAzLjUyNiw3MS4xNzMgQzMuNTExLDU4LjM4OSA0LjQyMyw1MS40MjggNC40MjMsNTEuNDI4IEM1LjEzNCw0Ny4yODIgNy4yMSw0Ni4yMzYgNy4yMSw0Ni4yMzYgQzcuMjEsNDYuMjM2IDgxLjY2NywzLjI1IDgyLjA2OSwzLjAxNyBDODIuMjkyLDIuODg4IDg0LjU1NiwxLjQzMyA4NS4yNjQsMy45NCBDODcuMjE0LDEwLjg0IDg2Ljc1MiwzNS44MjcgODUuNTM5LDQzLjgxOCBDODUuMTUsNDYuMzgzIDg0LjI5MSw0OS4wMzMgODIuNDgzLDUwLjEwMSBMNy4yMSw5My42NTMgQzYuODI4LDkzLjg3NCA2LjQ2MSw5My45NDEgNi4xMyw5My45MDEgQzYuMTMsOTMuOTAxIDMuMzQ5LDkzLjQ2IDMuMTI5LDkxLjc3NiBDMi41NjgsODcuNDk1IDEuOTc3LDgyLjk5NSAxLjk2Miw3MC40MjUgQzEuOTQ4LDU3LjY0MSAyLjg2LDUwLjY4IDIuODYsNTAuNjggQzMuNTcsNDYuNTM0IDUuNjQ3LDQ1LjQ4OSA1LjY0Nyw0NS40ODkgQzUuNjQ2LDQ1LjQ4OSA4LjA2NSw0NC4wOTIgMTIuMjQ1LDQxLjY3OSBMMTMuMTE2LDQxLjU2IEwxOS43MTUsMzcuNzMgTDE5Ljc2MSwzNy4yNjkgTDYuMTMsOTMuOTAxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjMxNyw5NC4xNjEgTDYuMTAyLDk0LjE0OCBMNi4xMDEsOTQuMTQ4IEw1Ljg1Nyw5NC4xMDEgQzUuMTM4LDkzLjk0NSAzLjA4NSw5My4zNjUgMi44ODEsOTEuODA5IEMyLjMxMyw4Ny40NjkgMS43MjcsODIuOTk2IDEuNzEzLDcwLjQyNSBDMS42OTksNTcuNzcxIDIuNjA0LDUwLjcxOCAyLjYxMyw1MC42NDggQzMuMzM4LDQ2LjQxNyA1LjQ0NSw0NS4zMSA1LjUzNSw0NS4yNjYgTDEyLjE2Myw0MS40MzkgTDEzLjAzMyw0MS4zMiBMMTkuNDc5LDM3LjU3OCBMMTkuNTEzLDM3LjI0NCBDMTkuNTI2LDM3LjEwNyAxOS42NDcsMzcuMDA4IDE5Ljc4NiwzNy4wMjEgQzE5LjkyMiwzNy4wMzQgMjAuMDIzLDM3LjE1NiAyMC4wMDksMzcuMjkzIEwxOS45NSwzNy44ODIgTDEzLjE5OCw0MS44MDEgTDEyLjMyOCw0MS45MTkgTDUuNzcyLDQ1LjcwNCBDNS43NDEsNDUuNzIgMy43ODIsNDYuNzcyIDMuMTA2LDUwLjcyMiBDMy4wOTksNTAuNzgyIDIuMTk4LDU3LjgwOCAyLjIxMiw3MC40MjQgQzIuMjI2LDgyLjk2MyAyLjgwOSw4Ny40MiAzLjM3Myw5MS43MjkgQzMuNDY0LDkyLjQyIDQuMDYyLDkyLjg4MyA0LjY4Miw5My4xODEgQzQuNTY2LDkyLjk4NCA0LjQ4Niw5Mi43NzYgNC40NDYsOTIuNTcyIEMzLjY2NSw4OC41ODggMy4yOTEsODQuMzcgMy4yNzYsNzEuMTczIEMzLjI2Miw1OC41MiA0LjE2Nyw1MS40NjYgNC4xNzYsNTEuMzk2IEM0LjkwMSw0Ny4xNjUgNy4wMDgsNDYuMDU5IDcuMDk4LDQ2LjAxNCBDNy4wOTQsNDYuMDE1IDgxLjU0MiwzLjAzNCA4MS45NDQsMi44MDIgTDgxLjk3MiwyLjc4NSBDODIuODc2LDIuMjQ3IDgzLjY5MiwyLjA5NyA4NC4zMzIsMi4zNTIgQzg0Ljg4NywyLjU3MyA4NS4yODEsMy4wODUgODUuNTA0LDMuODcyIEM4Ny41MTgsMTEgODYuOTY0LDM2LjA5MSA4NS43ODUsNDMuODU1IEM4NS4yNzgsNDcuMTk2IDg0LjIxLDQ5LjM3IDgyLjYxLDUwLjMxNyBMNy4zMzUsOTMuODY5IEM2Ljk5OSw5NC4wNjMgNi42NTgsOTQuMTYxIDYuMzE3LDk0LjE2MSBMNi4zMTcsOTQuMTYxIFogTTYuMTcsOTMuNjU0IEM2LjQ2Myw5My42OSA2Ljc3NCw5My42MTcgNy4wODUsOTMuNDM3IEw4Mi4zNTgsNDkuODg2IEM4NC4xODEsNDguODA4IDg0Ljk2LDQ1Ljk3MSA4NS4yOTIsNDMuNzggQzg2LjQ2NiwzNi4wNDkgODcuMDIzLDExLjA4NSA4NS4wMjQsNC4wMDggQzg0Ljg0NiwzLjM3NyA4NC41NTEsMi45NzYgODQuMTQ4LDIuODE2IEM4My42NjQsMi42MjMgODIuOTgyLDIuNzY0IDgyLjIyNywzLjIxMyBMODIuMTkzLDMuMjM0IEM4MS43OTEsMy40NjYgNy4zMzUsNDYuNDUyIDcuMzM1LDQ2LjQ1MiBDNy4zMDQsNDYuNDY5IDUuMzQ2LDQ3LjUyMSA0LjY2OSw1MS40NzEgQzQuNjYyLDUxLjUzIDMuNzYxLDU4LjU1NiAzLjc3NSw3MS4xNzMgQzMuNzksODQuMzI4IDQuMTYxLDg4LjUyNCA0LjkzNiw5Mi40NzYgQzUuMDI2LDkyLjkzNyA1LjQxMiw5My40NTkgNS45NzMsOTMuNjE1IEM2LjA4Nyw5My42NCA2LjE1OCw5My42NTIgNi4xNjksOTMuNjU0IEw2LjE3LDkzLjY1NCBMNi4xNyw5My42NTQgWiIgaWQ9IkZpbGwtMTIiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4zMTcsNjguOTgyIEM3LjgwNiw2OC43MDEgOC4yMDIsNjguOTI2IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNi44MjksNzEuMjk0IDYuNDMzLDcxLjA2OSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIiBpZD0iRmlsbC0xMyIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjkyLDcxLjEzMyBDNi42MzEsNzEuMTMzIDYuNDMzLDcwLjkwNSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIEM3LjQ2LDY4LjkgNy41OTUsNjguODYxIDcuNzE0LDY4Ljg2MSBDOC4wMDMsNjguODYxIDguMjAyLDY5LjA5IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNy4xNzQsNzEuMDk0IDcuMDM5LDcxLjEzMyA2LjkyLDcxLjEzMyBNNy43MTQsNjguNjc0IEM3LjU1Nyw2OC42NzQgNy4zOTIsNjguNzIzIDcuMjI0LDY4LjgyMSBDNi42NzYsNjkuMTM4IDYuMjQ2LDY5Ljg3OSA2LjI0Niw3MC41MDggQzYuMjQ2LDcwLjk5NCA2LjUxNyw3MS4zMiA2LjkyLDcxLjMyIEM3LjA3OCw3MS4zMiA3LjI0Myw3MS4yNzEgNy40MTEsNzEuMTc0IEM3Ljk1OSw3MC44NTcgOC4zODksNzAuMTE3IDguMzg5LDY5LjQ4NyBDOC4zODksNjkuMDAxIDguMTE3LDY4LjY3NCA3LjcxNCw2OC42NzQiIGlkPSJGaWxsLTE0IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYuOTIsNzAuOTQ3IEM2LjY0OSw3MC45NDcgNi42MjEsNzAuNjQgNi42MjEsNzAuNTA4IEM2LjYyMSw3MC4wMTcgNi45ODIsNjkuMzkyIDcuNDExLDY5LjE0NSBDNy41MjEsNjkuMDgyIDcuNjI1LDY5LjA0OSA3LjcxNCw2OS4wNDkgQzcuOTg2LDY5LjA0OSA4LjAxNSw2OS4zNTUgOC4wMTUsNjkuNDg3IEM4LjAxNSw2OS45NzggNy42NTIsNzAuNjAzIDcuMjI0LDcwLjg1MSBDNy4xMTUsNzAuOTE0IDcuMDEsNzAuOTQ3IDYuOTIsNzAuOTQ3IE03LjcxNCw2OC44NjEgQzcuNTk1LDY4Ljg2MSA3LjQ2LDY4LjkgNy4zMTcsNjguOTgyIEM2LjgyOSw2OS4yNjUgNi40MzMsNjkuOTQ4IDYuNDMzLDcwLjUwOCBDNi40MzMsNzAuOTA1IDYuNjMxLDcxLjEzMyA2LjkyLDcxLjEzMyBDNy4wMzksNzEuMTMzIDcuMTc0LDcxLjA5NCA3LjMxNyw3MS4wMTIgQzcuODA2LDcwLjczIDguMjAyLDcwLjA0NyA4LjIwMiw2OS40ODcgQzguMjAyLDY5LjA5IDguMDAzLDY4Ljg2MSA3LjcxNCw2OC44NjEiIGlkPSJGaWxsLTE1IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTcuNDQ0LDg1LjM1IEM3LjcwOCw4NS4xOTggNy45MjEsODUuMzE5IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuOTI1IDcuNzA4LDg2LjI5MiA3LjQ0NCw4Ni40NDQgQzcuMTgxLDg2LjU5NyA2Ljk2Nyw4Ni40NzUgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IiBpZD0iRmlsbC0xNiIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik03LjIzLDg2LjUxIEM3LjA3NCw4Ni41MSA2Ljk2Nyw4Ni4zODcgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IEM3LjUyMSw4NS4zMDUgNy41OTQsODUuMjg0IDcuNjU4LDg1LjI4NCBDNy44MTQsODUuMjg0IDcuOTIxLDg1LjQwOCA3LjkyMSw4NS42MjIgQzcuOTIxLDg1LjkyNSA3LjcwOCw4Ni4yOTIgNy40NDQsODYuNDQ0IEM3LjM2Nyw4Ni40ODkgNy4yOTQsODYuNTEgNy4yMyw4Ni41MSBNNy42NTgsODUuMDk4IEM3LjU1OCw4NS4wOTggNy40NTUsODUuMTI3IDcuMzUxLDg1LjE4OCBDNy4wMzEsODUuMzczIDYuNzgxLDg1LjgwNiA2Ljc4MSw4Ni4xNzMgQzYuNzgxLDg2LjQ4MiA2Ljk2Niw4Ni42OTcgNy4yMyw4Ni42OTcgQzcuMzMsODYuNjk3IDcuNDMzLDg2LjY2NiA3LjUzOCw4Ni42MDcgQzcuODU4LDg2LjQyMiA4LjEwOCw4NS45ODkgOC4xMDgsODUuNjIyIEM4LjEwOCw4NS4zMTMgNy45MjMsODUuMDk4IDcuNjU4LDg1LjA5OCIgaWQ9IkZpbGwtMTciIGZpbGw9IiM4MDk3QTIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4yMyw4Ni4zMjIgTDcuMTU0LDg2LjE3MyBDNy4xNTQsODUuOTM4IDcuMzMzLDg1LjYyOSA3LjUzOCw4NS41MTIgTDcuNjU4LDg1LjQ3MSBMNy43MzQsODUuNjIyIEM3LjczNCw4NS44NTYgNy41NTUsODYuMTY0IDcuMzUxLDg2LjI4MiBMNy4yMyw4Ni4zMjIgTTcuNjU4LDg1LjI4NCBDNy41OTQsODUuMjg0IDcuNTIxLDg1LjMwNSA3LjQ0NCw4NS4zNSBDNy4xODEsODUuNTAyIDYuOTY3LDg1Ljg3MSA2Ljk2Nyw4Ni4xNzMgQzYuOTY3LDg2LjM4NyA3LjA3NCw4Ni41MSA3LjIzLDg2LjUxIEM3LjI5NCw4Ni41MSA3LjM2Nyw4Ni40ODkgNy40NDQsODYuNDQ0IEM3LjcwOCw4Ni4yOTIgNy45MjEsODUuOTI1IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuNDA4IDcuODE0LDg1LjI4NCA3LjY1OCw4NS4yODQiIGlkPSJGaWxsLTE4IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTc3LjI3OCw3Ljc2OSBMNzcuMjc4LDUxLjQzNiBMMTAuMjA4LDkwLjE2IEwxMC4yMDgsNDYuNDkzIEw3Ny4yNzgsNy43NjkiIGlkPSJGaWxsLTE5IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEwLjA4Myw5MC4zNzUgTDEwLjA4Myw0Ni40MjEgTDEwLjE0Niw0Ni4zODUgTDc3LjQwMyw3LjU1NCBMNzcuNDAzLDUxLjUwOCBMNzcuMzQxLDUxLjU0NCBMMTAuMDgzLDkwLjM3NSBMMTAuMDgzLDkwLjM3NSBaIE0xMC4zMzMsNDYuNTY0IEwxMC4zMzMsODkuOTQ0IEw3Ny4xNTQsNTEuMzY1IEw3Ny4xNTQsNy45ODUgTDEwLjMzMyw0Ni41NjQgTDEwLjMzMyw0Ni41NjQgWiIgaWQ9IkZpbGwtMjAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMjUuNzM3LDg4LjY0NyBMMTE4LjA5OCw5MS45ODEgTDExOC4wOTgsODQgTDEwNi42MzksODguNzEzIEwxMDYuNjM5LDk2Ljk4MiBMOTksMTAwLjMxNSBMMTEyLjM2OSwxMDMuOTYxIEwxMjUuNzM3LDg4LjY0NyIgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTIiIGZpbGw9IiM0NTVBNjQiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+');\n};\n\nmodule.exports = RotateInstructions;\n\n},{\"./util.js\":22}],17:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar SensorSample = _dereq_('./sensor-sample.js');\nvar MathUtil = _dereq_('../math-util.js');\nvar Util = _dereq_('../util.js');\n\nvar DEBUG = false;\n\n/**\n * An implementation of a simple complementary filter, which fuses gyroscope and\n * accelerometer data from the 'devicemotion' event.\n *\n * Accelerometer data is very noisy, but stable over the long term.\n * Gyroscope data is smooth, but tends to drift over the long term.\n *\n * This fusion is relatively simple:\n * 1. Get orientation estimates from accelerometer by applying a low-pass filter\n *    on that data.\n * 2. Get orientation estimates from gyroscope by integrating over time.\n * 3. Combine the two estimates, weighing (1) in the long term, but (2) for the\n *    short term.\n */\nfunction ComplementaryFilter(kFilter) {\n  this.kFilter = kFilter;\n\n  // Raw sensor measurements.\n  this.currentAccelMeasurement = new SensorSample();\n  this.currentGyroMeasurement = new SensorSample();\n  this.previousGyroMeasurement = new SensorSample();\n\n  // Set default look direction to be in the correct direction.\n  if (Util.isIOS()) {\n    this.filterQ = new MathUtil.Quaternion(-1, 0, 0, 1);\n  } else {\n    this.filterQ = new MathUtil.Quaternion(1, 0, 0, 1);\n  }\n  this.previousFilterQ = new MathUtil.Quaternion();\n  this.previousFilterQ.copy(this.filterQ);\n\n  // Orientation based on the accelerometer.\n  this.accelQ = new MathUtil.Quaternion();\n  // Whether or not the orientation has been initialized.\n  this.isOrientationInitialized = false;\n  // Running estimate of gravity based on the current orientation.\n  this.estimatedGravity = new MathUtil.Vector3();\n  // Measured gravity based on accelerometer.\n  this.measuredGravity = new MathUtil.Vector3();\n\n  // Debug only quaternion of gyro-based orientation.\n  this.gyroIntegralQ = new MathUtil.Quaternion();\n}\n\nComplementaryFilter.prototype.addAccelMeasurement = function(vector, timestampS) {\n  this.currentAccelMeasurement.set(vector, timestampS);\n};\n\nComplementaryFilter.prototype.addGyroMeasurement = function(vector, timestampS) {\n  this.currentGyroMeasurement.set(vector, timestampS);\n\n  var deltaT = timestampS - this.previousGyroMeasurement.timestampS;\n  if (Util.isTimestampDeltaValid(deltaT)) {\n    this.run_();\n  }\n\n  this.previousGyroMeasurement.copy(this.currentGyroMeasurement);\n};\n\nComplementaryFilter.prototype.run_ = function() {\n\n  if (!this.isOrientationInitialized) {\n    this.accelQ = this.accelToQuaternion_(this.currentAccelMeasurement.sample);\n    this.previousFilterQ.copy(this.accelQ);\n    this.isOrientationInitialized = true;\n    return;\n  }\n\n  var deltaT = this.currentGyroMeasurement.timestampS -\n      this.previousGyroMeasurement.timestampS;\n\n  // Convert gyro rotation vector to a quaternion delta.\n  var gyroDeltaQ = this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample, deltaT);\n  this.gyroIntegralQ.multiply(gyroDeltaQ);\n\n  // filter_1 = K * (filter_0 + gyro * dT) + (1 - K) * accel.\n  this.filterQ.copy(this.previousFilterQ);\n  this.filterQ.multiply(gyroDeltaQ);\n\n  // Calculate the delta between the current estimated gravity and the real\n  // gravity vector from accelerometer.\n  var invFilterQ = new MathUtil.Quaternion();\n  invFilterQ.copy(this.filterQ);\n  invFilterQ.inverse();\n\n  this.estimatedGravity.set(0, 0, -1);\n  this.estimatedGravity.applyQuaternion(invFilterQ);\n  this.estimatedGravity.normalize();\n\n  this.measuredGravity.copy(this.currentAccelMeasurement.sample);\n  this.measuredGravity.normalize();\n\n  // Compare estimated gravity with measured gravity, get the delta quaternion\n  // between the two.\n  var deltaQ = new MathUtil.Quaternion();\n  deltaQ.setFromUnitVectors(this.estimatedGravity, this.measuredGravity);\n  deltaQ.inverse();\n\n  if (DEBUG) {\n    console.log('Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)',\n                MathUtil.radToDeg * Util.getQuaternionAngle(deltaQ),\n                (this.estimatedGravity.x).toFixed(1),\n                (this.estimatedGravity.y).toFixed(1),\n                (this.estimatedGravity.z).toFixed(1),\n                (this.measuredGravity.x).toFixed(1),\n                (this.measuredGravity.y).toFixed(1),\n                (this.measuredGravity.z).toFixed(1));\n  }\n\n  // Calculate the SLERP target: current orientation plus the measured-estimated\n  // quaternion delta.\n  var targetQ = new MathUtil.Quaternion();\n  targetQ.copy(this.filterQ);\n  targetQ.multiply(deltaQ);\n\n  // SLERP factor: 0 is pure gyro, 1 is pure accel.\n  this.filterQ.slerp(targetQ, 1 - this.kFilter);\n\n  this.previousFilterQ.copy(this.filterQ);\n};\n\nComplementaryFilter.prototype.getOrientation = function() {\n  return this.filterQ;\n};\n\nComplementaryFilter.prototype.accelToQuaternion_ = function(accel) {\n  var normAccel = new MathUtil.Vector3();\n  normAccel.copy(accel);\n  normAccel.normalize();\n  var quat = new MathUtil.Quaternion();\n  quat.setFromUnitVectors(new MathUtil.Vector3(0, 0, -1), normAccel);\n  quat.inverse();\n  return quat;\n};\n\nComplementaryFilter.prototype.gyroToQuaternionDelta_ = function(gyro, dt) {\n  // Extract axis and angle from the gyroscope data.\n  var quat = new MathUtil.Quaternion();\n  var axis = new MathUtil.Vector3();\n  axis.copy(gyro);\n  axis.normalize();\n  quat.setFromAxisAngle(axis, gyro.length() * dt);\n  return quat;\n};\n\n\nmodule.exports = ComplementaryFilter;\n\n},{\"../math-util.js\":14,\"../util.js\":22,\"./sensor-sample.js\":20}],18:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar ComplementaryFilter = _dereq_('./complementary-filter.js');\nvar PosePredictor = _dereq_('./pose-predictor.js');\nvar TouchPanner = _dereq_('../touch-panner.js');\nvar MathUtil = _dereq_('../math-util.js');\nvar Util = _dereq_('../util.js');\n\n/**\n * The pose sensor, implemented using DeviceMotion APIs.\n */\nfunction FusionPoseSensor() {\n  this.deviceId = 'webvr-polyfill:fused';\n  this.deviceName = 'VR Position Device (webvr-polyfill:fused)';\n\n  this.accelerometer = new MathUtil.Vector3();\n  this.gyroscope = new MathUtil.Vector3();\n\n  window.addEventListener('devicemotion', this.onDeviceMotionChange_.bind(this));\n  window.addEventListener('orientationchange', this.onScreenOrientationChange_.bind(this));\n\n  this.filter = new ComplementaryFilter(WebVRConfig.K_FILTER);\n  this.posePredictor = new PosePredictor(WebVRConfig.PREDICTION_TIME_S);\n  this.touchPanner = new TouchPanner();\n\n  this.filterToWorldQ = new MathUtil.Quaternion();\n\n  // Set the filter to world transform, depending on OS.\n  if (Util.isIOS()) {\n    this.filterToWorldQ.setFromAxisAngle(new MathUtil.Vector3(1, 0, 0), Math.PI / 2);\n  } else {\n    this.filterToWorldQ.setFromAxisAngle(new MathUtil.Vector3(1, 0, 0), -Math.PI / 2);\n  }\n\n  this.inverseWorldToScreenQ = new MathUtil.Quaternion();\n  this.worldToScreenQ = new MathUtil.Quaternion();\n  this.originalPoseAdjustQ = new MathUtil.Quaternion();\n  this.originalPoseAdjustQ.setFromAxisAngle(new MathUtil.Vector3(0, 0, 1),\n                                           -window.orientation * Math.PI / 180);\n\n  this.setScreenTransform_();\n  // Adjust this filter for being in landscape mode.\n  if (Util.isLandscapeMode()) {\n    this.filterToWorldQ.multiply(this.inverseWorldToScreenQ);\n  }\n\n  // Keep track of a reset transform for resetSensor.\n  this.resetQ = new MathUtil.Quaternion();\n\n  this.isFirefoxAndroid = Util.isFirefoxAndroid();\n  this.isIOS = Util.isIOS();\n\n  this.orientationOut_ = new Float32Array(4);\n}\n\nFusionPoseSensor.prototype.getPosition = function() {\n  // This PoseSensor doesn't support position\n  return null;\n};\n\nFusionPoseSensor.prototype.getOrientation = function() {\n  // Convert from filter space to the the same system used by the\n  // deviceorientation event.\n  var orientation = this.filter.getOrientation();\n\n  // Predict orientation.\n  this.predictedQ = this.posePredictor.getPrediction(orientation, this.gyroscope, this.previousTimestampS);\n\n  // Convert to THREE coordinate system: -Z forward, Y up, X right.\n  var out = new MathUtil.Quaternion();\n  out.copy(this.filterToWorldQ);\n  out.multiply(this.resetQ);\n  if (!WebVRConfig.TOUCH_PANNER_DISABLED) {\n    out.multiply(this.touchPanner.getOrientation());\n  }\n  out.multiply(this.predictedQ);\n  out.multiply(this.worldToScreenQ);\n\n  // Handle the yaw-only case.\n  if (WebVRConfig.YAW_ONLY) {\n    // Make a quaternion that only turns around the Y-axis.\n    out.x = 0;\n    out.z = 0;\n    out.normalize();\n  }\n\n  this.orientationOut_[0] = out.x;\n  this.orientationOut_[1] = out.y;\n  this.orientationOut_[2] = out.z;\n  this.orientationOut_[3] = out.w;\n  return this.orientationOut_;\n};\n\nFusionPoseSensor.prototype.resetPose = function() {\n  // Reduce to inverted yaw-only.\n  this.resetQ.copy(this.filter.getOrientation());\n  this.resetQ.x = 0;\n  this.resetQ.y = 0;\n  this.resetQ.z *= -1;\n  this.resetQ.normalize();\n\n  // Take into account extra transformations in landscape mode.\n  if (Util.isLandscapeMode()) {\n    this.resetQ.multiply(this.inverseWorldToScreenQ);\n  }\n\n  // Take into account original pose.\n  this.resetQ.multiply(this.originalPoseAdjustQ);\n\n  if (!WebVRConfig.TOUCH_PANNER_DISABLED) {\n    this.touchPanner.resetSensor();\n  }\n};\n\nFusionPoseSensor.prototype.onDeviceMotionChange_ = function(deviceMotion) {\n  var accGravity = deviceMotion.accelerationIncludingGravity;\n  var rotRate = deviceMotion.rotationRate;\n  var timestampS = deviceMotion.timeStamp / 1000;\n\n  // Firefox Android timeStamp returns one thousandth of a millisecond.\n  if (this.isFirefoxAndroid) {\n    timestampS /= 1000;\n  }\n\n  var deltaS = timestampS - this.previousTimestampS;\n  if (deltaS <= Util.MIN_TIMESTEP || deltaS > Util.MAX_TIMESTEP) {\n    console.warn('Invalid timestamps detected. Time step between successive ' +\n                 'gyroscope sensor samples is very small or not monotonic');\n    this.previousTimestampS = timestampS;\n    return;\n  }\n  this.accelerometer.set(-accGravity.x, -accGravity.y, -accGravity.z);\n  this.gyroscope.set(rotRate.alpha, rotRate.beta, rotRate.gamma);\n\n  // With iOS and Firefox Android, rotationRate is reported in degrees,\n  // so we first convert to radians.\n  if (this.isIOS || this.isFirefoxAndroid) {\n    this.gyroscope.multiplyScalar(Math.PI / 180);\n  }\n\n  this.filter.addAccelMeasurement(this.accelerometer, timestampS);\n  this.filter.addGyroMeasurement(this.gyroscope, timestampS);\n\n  this.previousTimestampS = timestampS;\n};\n\nFusionPoseSensor.prototype.onScreenOrientationChange_ =\n    function(screenOrientation) {\n  this.setScreenTransform_();\n};\n\nFusionPoseSensor.prototype.setScreenTransform_ = function() {\n  this.worldToScreenQ.set(0, 0, 0, 1);\n  switch (window.orientation) {\n    case 0:\n      break;\n    case 90:\n      this.worldToScreenQ.setFromAxisAngle(new MathUtil.Vector3(0, 0, 1), -Math.PI / 2);\n      break;\n    case -90:\n      this.worldToScreenQ.setFromAxisAngle(new MathUtil.Vector3(0, 0, 1), Math.PI / 2);\n      break;\n    case 180:\n      // TODO.\n      break;\n  }\n  this.inverseWorldToScreenQ.copy(this.worldToScreenQ);\n  this.inverseWorldToScreenQ.inverse();\n};\n\nmodule.exports = FusionPoseSensor;\n\n},{\"../math-util.js\":14,\"../touch-panner.js\":21,\"../util.js\":22,\"./complementary-filter.js\":17,\"./pose-predictor.js\":19}],19:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar MathUtil = _dereq_('../math-util.js');\nvar DEBUG = false;\n\n/**\n * Given an orientation and the gyroscope data, predicts the future orientation\n * of the head. This makes rendering appear faster.\n *\n * Also see: http://msl.cs.uiuc.edu/~lavalle/papers/LavYerKatAnt14.pdf\n *\n * @param {Number} predictionTimeS time from head movement to the appearance of\n * the corresponding image.\n */\nfunction PosePredictor(predictionTimeS) {\n  this.predictionTimeS = predictionTimeS;\n\n  // The quaternion corresponding to the previous state.\n  this.previousQ = new MathUtil.Quaternion();\n  // Previous time a prediction occurred.\n  this.previousTimestampS = null;\n\n  // The delta quaternion that adjusts the current pose.\n  this.deltaQ = new MathUtil.Quaternion();\n  // The output quaternion.\n  this.outQ = new MathUtil.Quaternion();\n}\n\nPosePredictor.prototype.getPrediction = function(currentQ, gyro, timestampS) {\n  if (!this.previousTimestampS) {\n    this.previousQ.copy(currentQ);\n    this.previousTimestampS = timestampS;\n    return currentQ;\n  }\n\n  // Calculate axis and angle based on gyroscope rotation rate data.\n  var axis = new MathUtil.Vector3();\n  axis.copy(gyro);\n  axis.normalize();\n\n  var angularSpeed = gyro.length();\n\n  // If we're rotating slowly, don't do prediction.\n  if (angularSpeed < MathUtil.degToRad * 20) {\n    if (DEBUG) {\n      console.log('Moving slowly, at %s deg/s: no prediction',\n                  (MathUtil.radToDeg * angularSpeed).toFixed(1));\n    }\n    this.outQ.copy(currentQ);\n    this.previousQ.copy(currentQ);\n    return this.outQ;\n  }\n\n  // Get the predicted angle based on the time delta and latency.\n  var deltaT = timestampS - this.previousTimestampS;\n  var predictAngle = angularSpeed * this.predictionTimeS;\n\n  this.deltaQ.setFromAxisAngle(axis, predictAngle);\n  this.outQ.copy(this.previousQ);\n  this.outQ.multiply(this.deltaQ);\n\n  this.previousQ.copy(currentQ);\n  this.previousTimestampS = timestampS;\n\n  return this.outQ;\n};\n\n\nmodule.exports = PosePredictor;\n\n},{\"../math-util.js\":14}],20:[function(_dereq_,module,exports){\nfunction SensorSample(sample, timestampS) {\n  this.set(sample, timestampS);\n};\n\nSensorSample.prototype.set = function(sample, timestampS) {\n  this.sample = sample;\n  this.timestampS = timestampS;\n};\n\nSensorSample.prototype.copy = function(sensorSample) {\n  this.set(sensorSample.sample, sensorSample.timestampS);\n};\n\nmodule.exports = SensorSample;\n\n},{}],21:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar MathUtil = _dereq_('./math-util.js');\nvar Util = _dereq_('./util.js');\n\nvar ROTATE_SPEED = 0.5;\n/**\n * Provides a quaternion responsible for pre-panning the scene before further\n * transformations due to device sensors.\n */\nfunction TouchPanner() {\n  window.addEventListener('touchstart', this.onTouchStart_.bind(this));\n  window.addEventListener('touchmove', this.onTouchMove_.bind(this));\n  window.addEventListener('touchend', this.onTouchEnd_.bind(this));\n\n  this.isTouching = false;\n  this.rotateStart = new MathUtil.Vector2();\n  this.rotateEnd = new MathUtil.Vector2();\n  this.rotateDelta = new MathUtil.Vector2();\n\n  this.theta = 0;\n  this.orientation = new MathUtil.Quaternion();\n}\n\nTouchPanner.prototype.getOrientation = function() {\n  this.orientation.setFromEulerXYZ(0, 0, this.theta);\n  return this.orientation;\n};\n\nTouchPanner.prototype.resetSensor = function() {\n  this.theta = 0;\n};\n\nTouchPanner.prototype.onTouchStart_ = function(e) {\n  // Only respond if there is exactly one touch.\n  if (e.touches.length != 1) {\n    return;\n  }\n  this.rotateStart.set(e.touches[0].pageX, e.touches[0].pageY);\n  this.isTouching = true;\n};\n\nTouchPanner.prototype.onTouchMove_ = function(e) {\n  if (!this.isTouching) {\n    return;\n  }\n  this.rotateEnd.set(e.touches[0].pageX, e.touches[0].pageY);\n  this.rotateDelta.subVectors(this.rotateEnd, this.rotateStart);\n  this.rotateStart.copy(this.rotateEnd);\n\n  // On iOS, direction is inverted.\n  if (Util.isIOS()) {\n    this.rotateDelta.x *= -1;\n  }\n\n  var element = document.body;\n  this.theta += 2 * Math.PI * this.rotateDelta.x / element.clientWidth * ROTATE_SPEED;\n};\n\nTouchPanner.prototype.onTouchEnd_ = function(e) {\n  this.isTouching = false;\n};\n\nmodule.exports = TouchPanner;\n\n},{\"./math-util.js\":14,\"./util.js\":22}],22:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar objectAssign = _dereq_('object-assign');\n\nvar Util = window.Util || {};\n\nUtil.MIN_TIMESTEP = 0.001;\nUtil.MAX_TIMESTEP = 1;\n\nUtil.base64 = function(mimeType, base64) {\n  return 'data:' + mimeType + ';base64,' + base64;\n};\n\nUtil.clamp = function(value, min, max) {\n  return Math.min(Math.max(min, value), max);\n};\n\nUtil.lerp = function(a, b, t) {\n  return a + ((b - a) * t);\n};\n\nUtil.isIOS = (function() {\n  var isIOS = /iPad|iPhone|iPod/.test(navigator.platform);\n  return function() {\n    return isIOS;\n  };\n})();\n\nUtil.isSafari = (function() {\n  var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n  return function() {\n    return isSafari;\n  };\n})();\n\nUtil.isFirefoxAndroid = (function() {\n  var isFirefoxAndroid = navigator.userAgent.indexOf('Firefox') !== -1 &&\n      navigator.userAgent.indexOf('Android') !== -1;\n  return function() {\n    return isFirefoxAndroid;\n  };\n})();\n\nUtil.isLandscapeMode = function() {\n  return (window.orientation == 90 || window.orientation == -90);\n};\n\n// Helper method to validate the time steps of sensor timestamps.\nUtil.isTimestampDeltaValid = function(timestampDeltaS) {\n  if (isNaN(timestampDeltaS)) {\n    return false;\n  }\n  if (timestampDeltaS <= Util.MIN_TIMESTEP) {\n    return false;\n  }\n  if (timestampDeltaS > Util.MAX_TIMESTEP) {\n    return false;\n  }\n  return true;\n};\n\nUtil.getScreenWidth = function() {\n  return Math.max(window.screen.width, window.screen.height) *\n      window.devicePixelRatio;\n};\n\nUtil.getScreenHeight = function() {\n  return Math.min(window.screen.width, window.screen.height) *\n      window.devicePixelRatio;\n};\n\nUtil.requestFullscreen = function(element) {\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  } else if (element.mozRequestFullScreen) {\n    element.mozRequestFullScreen();\n  } else if (element.msRequestFullscreen) {\n    element.msRequestFullscreen();\n  } else {\n    return false;\n  }\n\n  return true;\n};\n\nUtil.exitFullscreen = function() {\n  if (document.exitFullscreen) {\n    document.exitFullscreen();\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen();\n  } else if (document.mozCancelFullScreen) {\n    document.mozCancelFullScreen();\n  } else if (document.msExitFullscreen) {\n    document.msExitFullscreen();\n  } else {\n    return false;\n  }\n\n  return true;\n};\n\nUtil.getFullscreenElement = function() {\n  return document.fullscreenElement ||\n      document.webkitFullscreenElement ||\n      document.mozFullScreenElement ||\n      document.msFullscreenElement;\n};\n\nUtil.linkProgram = function(gl, vertexSource, fragmentSource, attribLocationMap) {\n  // No error checking for brevity.\n  var vertexShader = gl.createShader(gl.VERTEX_SHADER);\n  gl.shaderSource(vertexShader, vertexSource);\n  gl.compileShader(vertexShader);\n\n  var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n  gl.shaderSource(fragmentShader, fragmentSource);\n  gl.compileShader(fragmentShader);\n\n  var program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n\n  for (var attribName in attribLocationMap)\n    gl.bindAttribLocation(program, attribLocationMap[attribName], attribName);\n\n  gl.linkProgram(program);\n\n  gl.deleteShader(vertexShader);\n  gl.deleteShader(fragmentShader);\n\n  return program;\n};\n\nUtil.getProgramUniforms = function(gl, program) {\n  var uniforms = {};\n  var uniformCount = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n  var uniformName = '';\n  for (var i = 0; i < uniformCount; i++) {\n    var uniformInfo = gl.getActiveUniform(program, i);\n    uniformName = uniformInfo.name.replace('[0]', '');\n    uniforms[uniformName] = gl.getUniformLocation(program, uniformName);\n  }\n  return uniforms;\n};\n\nUtil.orthoMatrix = function (out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right),\n      bt = 1 / (bottom - top),\n      nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n};\n\nUtil.isMobile = function() {\n  var check = false;\n  (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);\n  return check;\n};\n\nUtil.extend = objectAssign;\n\nUtil.safariCssSizeWorkaround = function(canvas) {\n  // TODO(smus): Remove this workaround when Safari for iOS is fixed.\n  // iOS only workaround (for https://bugs.webkit.org/show_bug.cgi?id=152556).\n  //\n  // \"To the last I grapple with thee;\n  //  from hell's heart I stab at thee;\n  //  for hate's sake I spit my last breath at thee.\"\n  // -- Moby Dick, by Herman Melville\n  if (Util.isIOS()) {\n    var width = canvas.style.width;\n    var height = canvas.style.height;\n    canvas.style.width = (parseInt(width) + 1) + 'px';\n    canvas.style.height = (parseInt(height)) + 'px';\n    console.log('Resetting width to...', width);\n    setTimeout(function() {\n      console.log('Done. Width is now', width);\n      canvas.style.width = width;\n      canvas.style.height = height;\n    }, 100);\n  }\n\n  // Debug only.\n  window.Util = Util;\n  window.canvas = canvas;\n};\n\nUtil.frameDataFromPose = (function() {\n  var piOver180 = Math.PI / 180.0;\n  var rad45 = Math.PI * 0.25;\n\n  // Borrowed from glMatrix.\n  function mat4_perspectiveFromFieldOfView(out, fov, near, far) {\n    var upTan = Math.tan(fov ? (fov.upDegrees * piOver180) : rad45),\n    downTan = Math.tan(fov ? (fov.downDegrees * piOver180) : rad45),\n    leftTan = Math.tan(fov ? (fov.leftDegrees * piOver180) : rad45),\n    rightTan = Math.tan(fov ? (fov.rightDegrees * piOver180) : rad45),\n    xScale = 2.0 / (leftTan + rightTan),\n    yScale = 2.0 / (upTan + downTan);\n\n    out[0] = xScale;\n    out[1] = 0.0;\n    out[2] = 0.0;\n    out[3] = 0.0;\n    out[4] = 0.0;\n    out[5] = yScale;\n    out[6] = 0.0;\n    out[7] = 0.0;\n    out[8] = -((leftTan - rightTan) * xScale * 0.5);\n    out[9] = ((upTan - downTan) * yScale * 0.5);\n    out[10] = far / (near - far);\n    out[11] = -1.0;\n    out[12] = 0.0;\n    out[13] = 0.0;\n    out[14] = (far * near) / (near - far);\n    out[15] = 0.0;\n    return out;\n  }\n\n  function mat4_fromRotationTranslation(out, q, v) {\n    // Quaternion math\n    var x = q[0], y = q[1], z = q[2], w = q[3],\n        x2 = x + x,\n        y2 = y + y,\n        z2 = z + z,\n\n        xx = x * x2,\n        xy = x * y2,\n        xz = x * z2,\n        yy = y * y2,\n        yz = y * z2,\n        zz = z * z2,\n        wx = w * x2,\n        wy = w * y2,\n        wz = w * z2;\n\n    out[0] = 1 - (yy + zz);\n    out[1] = xy + wz;\n    out[2] = xz - wy;\n    out[3] = 0;\n    out[4] = xy - wz;\n    out[5] = 1 - (xx + zz);\n    out[6] = yz + wx;\n    out[7] = 0;\n    out[8] = xz + wy;\n    out[9] = yz - wx;\n    out[10] = 1 - (xx + yy);\n    out[11] = 0;\n    out[12] = v[0];\n    out[13] = v[1];\n    out[14] = v[2];\n    out[15] = 1;\n\n    return out;\n  };\n\n  function mat4_translate(out, a, v) {\n    var x = v[0], y = v[1], z = v[2],\n        a00, a01, a02, a03,\n        a10, a11, a12, a13,\n        a20, a21, a22, a23;\n\n    if (a === out) {\n      out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n      out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n      out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n      out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n    } else {\n      a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\n      a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\n      a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\n\n      out[0] = a00; out[1] = a01; out[2] = a02; out[3] = a03;\n      out[4] = a10; out[5] = a11; out[6] = a12; out[7] = a13;\n      out[8] = a20; out[9] = a21; out[10] = a22; out[11] = a23;\n\n      out[12] = a00 * x + a10 * y + a20 * z + a[12];\n      out[13] = a01 * x + a11 * y + a21 * z + a[13];\n      out[14] = a02 * x + a12 * y + a22 * z + a[14];\n      out[15] = a03 * x + a13 * y + a23 * z + a[15];\n    }\n\n    return out;\n  };\n\n  mat4_invert = function(out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n\n        // Calculate the determinant\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) {\n      return null;\n    }\n    det = 1.0 / det;\n\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n\n    return out;\n  };\n\n  var defaultOrientation = new Float32Array([0, 0, 0, 1]);\n  var defaultPosition = new Float32Array([0, 0, 0]);\n\n  function updateEyeMatrices(projection, view, pose, parameters, vrDisplay) {\n    mat4_perspectiveFromFieldOfView(projection, parameters ? parameters.fieldOfView : null, vrDisplay.depthNear, vrDisplay.depthFar);\n\n    var orientation = pose.orientation || defaultOrientation;\n    var position = pose.position || defaultPosition;\n\n    mat4_fromRotationTranslation(view, orientation, position);\n    if (parameters)\n      mat4_translate(view, view, parameters.offset);\n    mat4_invert(view, view);\n  }\n\n  return function(frameData, pose, vrDisplay) {\n    if (!frameData || !pose)\n      return false;\n\n    frameData.pose = pose;\n    frameData.timestamp = pose.timestamp;\n\n    updateEyeMatrices(\n        frameData.leftProjectionMatrix, frameData.leftViewMatrix,\n        pose, vrDisplay.getEyeParameters(\"left\"), vrDisplay);\n    updateEyeMatrices(\n        frameData.rightProjectionMatrix, frameData.rightViewMatrix,\n        pose, vrDisplay.getEyeParameters(\"right\"), vrDisplay);\n\n    return true;\n  };\n})();\n\nmodule.exports = Util;\n\n},{\"object-assign\":1}],23:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar Emitter = _dereq_('./emitter.js');\nvar Util = _dereq_('./util.js');\nvar DeviceInfo = _dereq_('./device-info.js');\n\nvar DEFAULT_VIEWER = 'CardboardV1';\nvar VIEWER_KEY = 'WEBVR_CARDBOARD_VIEWER';\nvar CLASS_NAME = 'webvr-polyfill-viewer-selector';\n\n/**\n * Creates a viewer selector with the options specified. Supports being shown\n * and hidden. Generates events when viewer parameters change. Also supports\n * saving the currently selected index in localStorage.\n */\nfunction ViewerSelector() {\n  // Try to load the selected key from local storage. If none exists, use the\n  // default key.\n  try {\n    this.selectedKey = localStorage.getItem(VIEWER_KEY) || DEFAULT_VIEWER;\n  } catch (error) {\n    console.error('Failed to load viewer profile: %s', error);\n  }\n  this.dialog = this.createDialog_(DeviceInfo.Viewers);\n  this.root = null;\n}\nViewerSelector.prototype = new Emitter();\n\nViewerSelector.prototype.show = function(root) {\n  this.root = root;\n\n  root.appendChild(this.dialog);\n  //console.log('ViewerSelector.show');\n\n  // Ensure the currently selected item is checked.\n  var selected = this.dialog.querySelector('#' + this.selectedKey);\n  selected.checked = true;\n\n  // Show the UI.\n  this.dialog.style.display = 'block';\n};\n\nViewerSelector.prototype.hide = function() {\n  if (this.root && this.root.contains(this.dialog)) {\n    this.root.removeChild(this.dialog);\n  }\n  //console.log('ViewerSelector.hide');\n  this.dialog.style.display = 'none';\n};\n\nViewerSelector.prototype.getCurrentViewer = function() {\n  return DeviceInfo.Viewers[this.selectedKey];\n};\n\nViewerSelector.prototype.getSelectedKey_ = function() {\n  var input = this.dialog.querySelector('input[name=field]:checked');\n  if (input) {\n    return input.id;\n  }\n  return null;\n};\n\nViewerSelector.prototype.onSave_ = function() {\n  this.selectedKey = this.getSelectedKey_();\n  if (!this.selectedKey || !DeviceInfo.Viewers[this.selectedKey]) {\n    console.error('ViewerSelector.onSave_: this should never happen!');\n    return;\n  }\n\n  this.emit('change', DeviceInfo.Viewers[this.selectedKey]);\n\n  // Attempt to save the viewer profile, but fails in private mode.\n  try {\n    localStorage.setItem(VIEWER_KEY, this.selectedKey);\n  } catch(error) {\n    console.error('Failed to save viewer profile: %s', error);\n  }\n  this.hide();\n};\n\n/**\n * Creates the dialog.\n */\nViewerSelector.prototype.createDialog_ = function(options) {\n  var container = document.createElement('div');\n  container.classList.add(CLASS_NAME);\n  container.style.display = 'none';\n  // Create an overlay that dims the background, and which goes away when you\n  // tap it.\n  var overlay = document.createElement('div');\n  var s = overlay.style;\n  s.position = 'fixed';\n  s.left = 0;\n  s.top = 0;\n  s.width = '100%';\n  s.height = '100%';\n  s.background = 'rgba(0, 0, 0, 0.3)';\n  overlay.addEventListener('click', this.hide.bind(this));\n\n  var width = 280;\n  var dialog = document.createElement('div');\n  var s = dialog.style;\n  s.boxSizing = 'border-box';\n  s.position = 'fixed';\n  s.top = '24px';\n  s.left = '50%';\n  s.marginLeft = (-width/2) + 'px';\n  s.width = width + 'px';\n  s.padding = '24px';\n  s.overflow = 'hidden';\n  s.background = '#fafafa';\n  s.fontFamily = \"'Roboto', sans-serif\";\n  s.boxShadow = '0px 5px 20px #666';\n\n  dialog.appendChild(this.createH1_('Select your viewer'));\n  for (var id in options) {\n    dialog.appendChild(this.createChoice_(id, options[id].label));\n  }\n  dialog.appendChild(this.createButton_('Save', this.onSave_.bind(this)));\n\n  container.appendChild(overlay);\n  container.appendChild(dialog);\n\n  return container;\n};\n\nViewerSelector.prototype.createH1_ = function(name) {\n  var h1 = document.createElement('h1');\n  var s = h1.style;\n  s.color = 'black';\n  s.fontSize = '20px';\n  s.fontWeight = 'bold';\n  s.marginTop = 0;\n  s.marginBottom = '24px';\n  h1.innerHTML = name;\n  return h1;\n};\n\nViewerSelector.prototype.createChoice_ = function(id, name) {\n  /*\n  <div class=\"choice\">\n  <input id=\"v1\" type=\"radio\" name=\"field\" value=\"v1\">\n  <label for=\"v1\">Cardboard V1</label>\n  </div>\n  */\n  var div = document.createElement('div');\n  div.style.marginTop = '8px';\n  div.style.color = 'black';\n\n  var input = document.createElement('input');\n  input.style.fontSize = '30px';\n  input.setAttribute('id', id);\n  input.setAttribute('type', 'radio');\n  input.setAttribute('value', id);\n  input.setAttribute('name', 'field');\n\n  var label = document.createElement('label');\n  label.style.marginLeft = '4px';\n  label.setAttribute('for', id);\n  label.innerHTML = name;\n\n  div.appendChild(input);\n  div.appendChild(label);\n\n  return div;\n};\n\nViewerSelector.prototype.createButton_ = function(label, onclick) {\n  var button = document.createElement('button');\n  button.innerHTML = label;\n  var s = button.style;\n  s.float = 'right';\n  s.textTransform = 'uppercase';\n  s.color = '#1094f7';\n  s.fontSize = '14px';\n  s.letterSpacing = 0;\n  s.border = 0;\n  s.background = 'none';\n  s.marginTop = '16px';\n\n  button.addEventListener('click', onclick);\n\n  return button;\n};\n\nmodule.exports = ViewerSelector;\n\n},{\"./device-info.js\":7,\"./emitter.js\":12,\"./util.js\":22}],24:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar Util = _dereq_('./util.js');\n\n/**\n * Android and iOS compatible wakelock implementation.\n *\n * Refactored thanks to dkovalev@.\n */\nfunction AndroidWakeLock() {\n  var video = document.createElement('video');\n\n  video.addEventListener('ended', function() {\n    video.play();\n  });\n\n  this.request = function() {\n    if (video.paused) {\n      // Base64 version of videos_src/no-sleep-120s.mp4.\n      video.src = Util.base64('video/mp4', 'AAAAGGZ0eXBpc29tAAAAAG1wNDFhdmMxAAAIA21vb3YAAABsbXZoZAAAAADSa9v60mvb+gABX5AAlw/gAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAdkdHJhawAAAFx0a2hkAAAAAdJr2/rSa9v6AAAAAQAAAAAAlw/gAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAQAAAAHAAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAJcP4AAAAAAAAQAAAAAG3G1kaWEAAAAgbWRoZAAAAADSa9v60mvb+gAPQkAGjneAFccAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAABodtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAZHc3RibAAAAJdzdHNkAAAAAAAAAAEAAACHYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAMABwASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADFhdmNDAWQAC//hABlnZAALrNlfllw4QAAAAwBAAAADAKPFCmWAAQAFaOvssiwAAAAYc3R0cwAAAAAAAAABAAAAbgAPQkAAAAAUc3RzcwAAAAAAAAABAAAAAQAAA4BjdHRzAAAAAAAAAG4AAAABAD0JAAAAAAEAehIAAAAAAQA9CQAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEALcbAAAAAHHN0c2MAAAAAAAAAAQAAAAEAAABuAAAAAQAAAcxzdHN6AAAAAAAAAAAAAABuAAADCQAAABgAAAAOAAAADgAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAM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');\n      video.play();\n    }\n  };\n\n  this.release = function() {\n    video.pause();\n    video.src = '';\n  };\n}\n\nfunction iOSWakeLock() {\n  var timer = null;\n\n  this.request = function() {\n    if (!timer) {\n      timer = setInterval(function() {\n        window.location = window.location;\n        setTimeout(window.stop, 0);\n      }, 30000);\n    }\n  }\n\n  this.release = function() {\n    if (timer) {\n      clearInterval(timer);\n      timer = null;\n    }\n  }\n}\n\n\nfunction getWakeLock() {\n  var userAgent = navigator.userAgent || navigator.vendor || window.opera;\n  if (userAgent.match(/iPhone/i) || userAgent.match(/iPod/i)) {\n    return iOSWakeLock;\n  } else {\n    return AndroidWakeLock;\n  }\n}\n\nmodule.exports = getWakeLock();\n},{\"./util.js\":22}],25:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar Util = _dereq_('./util.js');\nvar CardboardVRDisplay = _dereq_('./cardboard-vr-display.js');\nvar MouseKeyboardVRDisplay = _dereq_('./mouse-keyboard-vr-display.js');\n// Uncomment to add positional tracking via webcam.\n//var WebcamPositionSensorVRDevice = require('./webcam-position-sensor-vr-device.js');\nvar VRDisplay = _dereq_('./base.js').VRDisplay;\nvar VRFrameData = _dereq_('./base.js').VRFrameData;\nvar HMDVRDevice = _dereq_('./base.js').HMDVRDevice;\nvar PositionSensorVRDevice = _dereq_('./base.js').PositionSensorVRDevice;\nvar VRDisplayHMDDevice = _dereq_('./display-wrappers.js').VRDisplayHMDDevice;\nvar VRDisplayPositionSensorDevice = _dereq_('./display-wrappers.js').VRDisplayPositionSensorDevice;\n\nfunction WebVRPolyfill() {\n  this.displays = [];\n  this.devices = []; // For deprecated objects\n  this.devicesPopulated = false;\n  this.nativeWebVRAvailable = this.isWebVRAvailable();\n  this.nativeLegacyWebVRAvailable = this.isDeprecatedWebVRAvailable();\n\n  if (!this.nativeLegacyWebVRAvailable) {\n    if (!this.nativeWebVRAvailable) {\n      this.enablePolyfill();\n    }\n    if (WebVRConfig.ENABLE_DEPRECATED_API) {\n      this.enableDeprecatedPolyfill();\n    }\n  }\n\n  // Put a shim in place to update the API to 1.1 if needed.\n  InstallWebVRSpecShim();\n}\n\nWebVRPolyfill.prototype.isWebVRAvailable = function() {\n  return ('getVRDisplays' in navigator);\n};\n\nWebVRPolyfill.prototype.isDeprecatedWebVRAvailable = function() {\n  return ('getVRDevices' in navigator) || ('mozGetVRDevices' in navigator);\n};\n\nWebVRPolyfill.prototype.populateDevices = function() {\n  if (this.devicesPopulated) {\n    return;\n  }\n\n  // Initialize our virtual VR devices.\n  var vrDisplay = null;\n\n  // Add a Cardboard VRDisplay on compatible mobile devices\n  if (this.isCardboardCompatible()) {\n    vrDisplay = new CardboardVRDisplay();\n    this.displays.push(vrDisplay);\n\n    // For backwards compatibility\n    if (WebVRConfig.ENABLE_DEPRECATED_API) {\n      this.devices.push(new VRDisplayHMDDevice(vrDisplay));\n      this.devices.push(new VRDisplayPositionSensorDevice(vrDisplay));\n    }\n  }\n\n  // Add a Mouse and Keyboard driven VRDisplay for desktops/laptops\n  if (!this.isMobile() && !WebVRConfig.MOUSE_KEYBOARD_CONTROLS_DISABLED) {\n    vrDisplay = new MouseKeyboardVRDisplay();\n    this.displays.push(vrDisplay);\n\n    // For backwards compatibility\n    if (WebVRConfig.ENABLE_DEPRECATED_API) {\n      this.devices.push(new VRDisplayHMDDevice(vrDisplay));\n      this.devices.push(new VRDisplayPositionSensorDevice(vrDisplay));\n    }\n  }\n\n  // Uncomment to add positional tracking via webcam.\n  //if (!this.isMobile() && WebVRConfig.ENABLE_DEPRECATED_API) {\n  //  positionDevice = new WebcamPositionSensorVRDevice();\n  //  this.devices.push(positionDevice);\n  //}\n\n  this.devicesPopulated = true;\n};\n\nWebVRPolyfill.prototype.enablePolyfill = function() {\n  // Provide navigator.getVRDisplays.\n  navigator.getVRDisplays = this.getVRDisplays.bind(this);\n\n  // Provide the VRDisplay object.\n  window.VRDisplay = VRDisplay;\n\n  // Provide navigator.vrEnabled.\n  var self = this;\n  Object.defineProperty(navigator, 'vrEnabled', {\n    get: function () {\n      return self.isCardboardCompatible() &&\n        (document.fullscreenEnabled ||\n          document.mozFullScreenEnabled ||\n          document.webkitFullscreenEnabled ||\n          false);\n    }\n  });\n\n  // Provide the VRFrameData object.\n  window.VRFrameData = VRFrameData;\n};\n\nWebVRPolyfill.prototype.enableDeprecatedPolyfill = function() {\n  // Provide navigator.getVRDevices.\n  navigator.getVRDevices = this.getVRDevices.bind(this);\n\n  // Provide the CardboardHMDVRDevice and PositionSensorVRDevice objects.\n  window.HMDVRDevice = HMDVRDevice;\n  window.PositionSensorVRDevice = PositionSensorVRDevice;\n};\n\nWebVRPolyfill.prototype.getVRDisplays = function() {\n  this.populateDevices();\n  var displays = this.displays;\n  return new Promise(function(resolve, reject) {\n    try {\n      resolve(displays);\n    } catch (e) {\n      reject(e);\n    }\n  });\n};\n\nWebVRPolyfill.prototype.getVRDevices = function() {\n  console.warn('getVRDevices is deprecated. Please update your code to use getVRDisplays instead.');\n  var self = this;\n  return new Promise(function(resolve, reject) {\n    try {\n      if (!self.devicesPopulated) {\n        if (self.nativeWebVRAvailable) {\n          return navigator.getVRDisplays(function(displays) {\n            for (var i = 0; i < displays.length; ++i) {\n              self.devices.push(new VRDisplayHMDDevice(displays[i]));\n              self.devices.push(new VRDisplayPositionSensorDevice(displays[i]));\n            }\n            self.devicesPopulated = true;\n            resolve(self.devices);\n          }, reject);\n        }\n\n        if (self.nativeLegacyWebVRAvailable) {\n          return (navigator.getVRDDevices || navigator.mozGetVRDevices)(function(devices) {\n            for (var i = 0; i < devices.length; ++i) {\n              if (devices[i] instanceof HMDVRDevice) {\n                self.devices.push(devices[i]);\n              }\n              if (devices[i] instanceof PositionSensorVRDevice) {\n                self.devices.push(devices[i]);\n              }\n            }\n            self.devicesPopulated = true;\n            resolve(self.devices);\n          }, reject);\n        }\n      }\n\n      self.populateDevices();\n      resolve(self.devices);\n    } catch (e) {\n      reject(e);\n    }\n  });\n};\n\n/**\n * Determine if a device is mobile.\n */\nWebVRPolyfill.prototype.isMobile = function() {\n  return /Android/i.test(navigator.userAgent) ||\n      /iPhone|iPad|iPod/i.test(navigator.userAgent);\n};\n\nWebVRPolyfill.prototype.isCardboardCompatible = function() {\n  // For now, support all iOS and Android devices.\n  // Also enable the WebVRConfig.FORCE_VR flag for debugging.\n  return this.isMobile() || WebVRConfig.FORCE_ENABLE_VR;\n};\n\n// Installs a shim that updates a WebVR 1.0 spec implementation to WebVR 1.1\nfunction InstallWebVRSpecShim() {\n  if ('VRDisplay' in window && !('VRFrameData' in window)) {\n    // Provide the VRFrameData object.\n    window.VRFrameData = VRFrameData;\n\n    // A lot of Chrome builds don't have depthNear and depthFar, even\n    // though they're in the WebVR 1.0 spec. Patch them in if they're not present.\n    if(!('depthNear' in window.VRDisplay.prototype)) {\n      window.VRDisplay.prototype.depthNear = 0.01;\n    }\n\n    if(!('depthFar' in window.VRDisplay.prototype)) {\n      window.VRDisplay.prototype.depthFar = 10000.0;\n    }\n\n    window.VRDisplay.prototype.getFrameData = function(frameData) {\n      return Util.frameDataFromPose(frameData, this.getPose(), this);\n    }\n  }\n};\n\nmodule.exports.WebVRPolyfill = WebVRPolyfill;\n\n},{\"./base.js\":2,\"./cardboard-vr-display.js\":5,\"./display-wrappers.js\":8,\"./mouse-keyboard-vr-display.js\":15,\"./util.js\":22}]},{},[13]);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webvr-polyfill/build/webvr-polyfill.js\n// module id = 367\n// module chunks = 0 1 2","import * as THREE from 'three';\nimport 'webvr-polyfill';\n/**\n * @author dmarcos / https://github.com/dmarcos\n * @author mrdoob / http://mrdoob.com\n *\n * WebVR Spec: http://mozvr.github.io/webvr-spec/webvr.html\n *\n * Firefox: http://mozvr.com/downloads/\n * Chromium: https://drive.google.com/folderview?id=0BzudLt22BqGRbW9WTHMtOWMzNjQ&usp=sharing#list\n *\n */\n\nTHREE.VREffect = function ( renderer, vrDisplay, onError ) {\n\n\tvar isWebVR1 = true;\n\n\tvar eyeTranslationL = new THREE.Vector3();\n\tvar eyeTranslationR = new THREE.Vector3();\n\tvar renderRectL, renderRectR;\n\tvar eyeFOVL, eyeFOVR;\n\n\n\tthis.isPresenting = false;\n\tthis.scale = 1;\n\n\tvar scope = this;\n\n\tvar rendererSize = renderer.getSize();\n\tvar rendererPixelRatio = renderer.getPixelRatio();\n\n\tthis.getVRDisplay = function () {\n\n\t\treturn vrDisplay;\n\n\t};\n\n\tthis.setSize = function ( width, height ) {\n\n\t\trendererSize = { width: width, height: height };\n\n\t\tif ( scope.isPresenting ) {\n\n\t\t\tvar eyeParamsL = vrDisplay.getEyeParameters( 'left' );\n\t\t\trenderer.setPixelRatio( 1 );\n\n\t\t\tif ( isWebVR1 ) {\n\n\t\t\t\trenderer.setSize( eyeParamsL.renderWidth * 2, eyeParamsL.renderHeight, false );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setSize( eyeParamsL.renderRect.width * 2, eyeParamsL.renderRect.height, false );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\trenderer.setPixelRatio( rendererPixelRatio );\n\t\t\trenderer.setSize( width, height );\n\n\t\t}\n\n\t};\n\n\t// fullscreen\n\n\tvar canvas = renderer.domElement;\n\tvar requestFullscreen;\n\tvar exitFullscreen;\n\tvar fullscreenElement;\n\tvar leftBounds = [ 0.0, 0.0, 0.5, 1.0 ];\n\tvar rightBounds = [ 0.5, 0.0, 0.5, 1.0 ];\n\n\tfunction onFullscreenChange () {\n\t\tvar wasPresenting = scope.isPresenting;\n\t\tscope.isPresenting = vrDisplay !== undefined && ( vrDisplay.isPresenting || ( ! isWebVR1 && document[ fullscreenElement ] instanceof window.HTMLElement ) );\n\n\t\tif ( scope.isPresenting ) {\n\n\t\t\tvar eyeParamsL = vrDisplay.getEyeParameters( 'left' );\n\t\t\tvar eyeWidth, eyeHeight;\n\n\t\t\tif ( isWebVR1 ) {\n\n\t\t\t\teyeWidth = eyeParamsL.renderWidth;\n\t\t\t\teyeHeight = eyeParamsL.renderHeight;\n\n\t\t\t\tif ( vrDisplay.getLayers ) {\n\n\t\t\t\t\tvar layers = vrDisplay.getLayers();\n\t\t\t\t\tif (layers.length) {\n\n\t\t\t\t\t\tleftBounds = layers[0].leftBounds || [ 0.0, 0.0, 0.5, 1.0 ];\n\t\t\t\t\t\trightBounds = layers[0].rightBounds || [ 0.5, 0.0, 0.5, 1.0 ];\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\teyeWidth = eyeParamsL.renderRect.width;\n\t\t\t\teyeHeight = eyeParamsL.renderRect.height;\n\n\t\t\t}\n\n\t\t\tif ( !wasPresenting ) {\n\n\t\t\t\trendererPixelRatio = renderer.getPixelRatio();\n\t\t\t\trendererSize = renderer.getSize();\n\n\t\t\t\trenderer.setPixelRatio( 1 );\n\t\t\t\trenderer.setSize( eyeWidth * 2, eyeHeight, false );\n\n\t\t\t}\n\n\t\t} else if ( wasPresenting ) {\n\n\t\t\trenderer.setPixelRatio( rendererPixelRatio );\n\t\t\trenderer.setSize( rendererSize.width, rendererSize.height );\n\n\t\t}\n\n\t}\n\n\tif ( canvas.requestFullscreen ) {\n\n\t\trequestFullscreen = 'requestFullscreen';\n\t\tfullscreenElement = 'fullscreenElement';\n\t\texitFullscreen = 'exitFullscreen';\n\t\tdocument.addEventListener( 'fullscreenchange', onFullscreenChange, false );\n\n\t} else if ( canvas.mozRequestFullScreen ) {\n\n\t\trequestFullscreen = 'mozRequestFullScreen';\n\t\tfullscreenElement = 'mozFullScreenElement';\n\t\texitFullscreen = 'mozCancelFullScreen';\n\t\tdocument.addEventListener( 'mozfullscreenchange', onFullscreenChange, false );\n\n\t} else {\n\n\t\trequestFullscreen = 'webkitRequestFullscreen';\n\t\tfullscreenElement = 'webkitFullscreenElement';\n\t\texitFullscreen = 'webkitExitFullscreen';\n\t\tdocument.addEventListener( 'webkitfullscreenchange', onFullscreenChange, false );\n\n\t}\n\n\twindow.addEventListener( 'vrdisplaypresentchange', onFullscreenChange, false );\n\n\tthis.setFullScreen = function ( boolean ) {\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tif ( vrDisplay === undefined ) {\n\n\t\t\t\treject( new Error( 'No VR hardware found.' ) );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( scope.isPresenting === boolean ) {\n\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( isWebVR1 ) {\n\n\t\t\t\tif ( boolean ) {\n\n\t\t\t\t\tresolve( vrDisplay.requestPresent( [ { source: canvas } ] ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tresolve( vrDisplay.exitPresent() );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( canvas[ requestFullscreen ] ) {\n\n\t\t\t\t\tcanvas[ boolean ? requestFullscreen : exitFullscreen ]( { vrDisplay: vrDisplay } );\n\t\t\t\t\tresolve();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'No compatible requestFullscreen method found.' );\n\t\t\t\t\treject( new Error( 'No compatible requestFullscreen method found.' ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t};\n\n\tthis.requestPresent = function () {\n\n\t\treturn this.setFullScreen( true );\n\n\t};\n\n\tthis.exitPresent = function () {\n\n\t\treturn this.setFullScreen( false );\n\n\t};\n\n\tthis.requestAnimationFrame = function ( f ) {\n\n\t\tif ( isWebVR1 && vrDisplay !== undefined ) {\n\n\t\t\treturn vrDisplay.requestAnimationFrame( f );\n\n\t\t} else {\n\n\t\t\treturn window.requestAnimationFrame( f );\n\n\t\t}\n\n\t};\n\n\tthis.cancelAnimationFrame = function ( h ) {\n\n\t\tif ( isWebVR1 && vrDisplay !== undefined ) {\n\n\t\t\tvrDisplay.cancelAnimationFrame( h );\n\n\t\t} else {\n\n\t\t\twindow.cancelAnimationFrame( h );\n\n\t\t}\n\n\t};\n\n\tthis.submitFrame = function () {\n\n\t\tif ( isWebVR1 && vrDisplay !== undefined && scope.isPresenting ) {\n\n\t\t\tvrDisplay.submitFrame();\n\n\t\t}\n\n\t};\n\n\tthis.autoSubmitFrame = true;\n\n\t// render\n\n\tvar cameraL = new THREE.PerspectiveCamera();\n\tcameraL.layers.enable( 1 );\n\n\tvar cameraR = new THREE.PerspectiveCamera();\n\tcameraR.layers.enable( 2 );\n\n\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\n\n\t\tif ( vrDisplay && scope.isPresenting ) {\n\n\t\t\tvar autoUpdate = scene.autoUpdate;\n\n\t\t\tif ( autoUpdate ) {\n\n\t\t\t\tscene.updateMatrixWorld();\n\t\t\t\tscene.autoUpdate = false;\n\n\t\t\t}\n\n\t\t\tvar eyeParamsL = vrDisplay.getEyeParameters( 'left' );\n\t\t\tvar eyeParamsR = vrDisplay.getEyeParameters( 'right' );\n\n\t\t\tif ( isWebVR1 ) {\n\n\t\t\t\teyeTranslationL.fromArray( eyeParamsL.offset );\n\t\t\t\teyeTranslationR.fromArray( eyeParamsR.offset );\n\t\t\t\teyeFOVL = eyeParamsL.fieldOfView;\n\t\t\t\teyeFOVR = eyeParamsR.fieldOfView;\n\n\t\t\t} else {\n\n\t\t\t\teyeTranslationL.copy( eyeParamsL.eyeTranslation );\n\t\t\t\teyeTranslationR.copy( eyeParamsR.eyeTranslation );\n\t\t\t\teyeFOVL = eyeParamsL.recommendedFieldOfView;\n\t\t\t\teyeFOVR = eyeParamsR.recommendedFieldOfView;\n\n\t\t\t}\n\n\t\t\tif ( Array.isArray( scene ) ) {\n\n\t\t\t\tconsole.warn( 'THREE.VREffect.render() no longer supports arrays. Use object.layers instead.' );\n\t\t\t\tscene = scene[ 0 ];\n\n\t\t\t}\n\n\t\t\t// When rendering we don't care what the recommended size is, only what the actual size\n\t\t\t// of the backbuffer is.\n\t\t\tvar size = renderer.getSize();\n\t\t\trenderRectL = {\n\t\t\t\tx: Math.round( size.width * leftBounds[ 0 ] ),\n\t\t\t\ty: Math.round( size.height * leftBounds[ 1 ] ),\n\t\t\t\twidth: Math.round( size.width * leftBounds[ 2 ] ),\n\t\t\t\theight:  Math.round(size.height * leftBounds[ 3 ] )\n\t\t\t};\n\t\t\trenderRectR = {\n\t\t\t\tx: Math.round( size.width * rightBounds[ 0 ] ),\n\t\t\t\ty: Math.round( size.height * rightBounds[ 1 ] ),\n\t\t\t\twidth: Math.round( size.width * rightBounds[ 2 ] ),\n\t\t\t\theight:  Math.round(size.height * rightBounds[ 3 ] )\n\t\t\t};\n\n\t\t\tif (renderTarget) {\n\n\t\t\t\trenderer.setRenderTarget(renderTarget);\n\t\t\t\trenderTarget.scissorTest = true;\n\n\t\t\t} else  {\n\n\t\t\t\trenderer.setScissorTest( true );\n\n\t\t\t}\n\n\t\t\tif ( renderer.autoClear || forceClear ) renderer.clear();\n\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\t\tcameraL.projectionMatrix = fovToProjection( eyeFOVL, true, camera.near, camera.far );\n\t\t\tcameraR.projectionMatrix = fovToProjection( eyeFOVR, true, camera.near, camera.far );\n\n\t\t\tcamera.matrixWorld.decompose( cameraL.position, cameraL.quaternion, cameraL.scale );\n\t\t\tcamera.matrixWorld.decompose( cameraR.position, cameraR.quaternion, cameraR.scale );\n\n\t\t\tvar scale = this.scale;\n\t\t\tcameraL.translateOnAxis( eyeTranslationL, scale );\n\t\t\tcameraR.translateOnAxis( eyeTranslationR, scale );\n\n\n\t\t\t// render left eye\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\trenderTarget.viewport.set(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n\t\t\t\trenderTarget.scissor.set(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setViewport( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\t\t\t\trenderer.setScissor( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\n\t\t\t}\n\t\t\trenderer.render( scene, cameraL, renderTarget, forceClear );\n\n\t\t\t// render right eye\n\t\t\tif (renderTarget) {\n\n\t\t\t\trenderTarget.viewport.set(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n  \t\t\t\trenderTarget.scissor.set(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setViewport( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\t\t\t\trenderer.setScissor( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\n\t\t\t}\n\t\t\trenderer.render( scene, cameraR, renderTarget, forceClear );\n\n\t\t\tif (renderTarget) {\n\n\t\t\t\trenderTarget.viewport.set( 0, 0, size.width, size.height );\n\t\t\t\trenderTarget.scissor.set( 0, 0, size.width, size.height );\n\t\t\t\trenderTarget.scissorTest = false;\n\t\t\t\trenderer.setRenderTarget( null );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setScissorTest( false );\n\n\t\t\t}\n\n\t\t\tif ( autoUpdate ) {\n\n\t\t\t\tscene.autoUpdate = true;\n\n\t\t\t}\n\n\t\t\tif ( scope.autoSubmitFrame ) {\n\n\t\t\t\tscope.submitFrame();\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Regular render mode if not HMD\n\n\t\trenderer.render( scene, camera, renderTarget, forceClear );\n\n\t};\n\n\t//\n\n\tfunction fovToNDCScaleOffset( fov ) {\n\n\t\tvar pxscale = 2.0 / ( fov.leftTan + fov.rightTan );\n\t\tvar pxoffset = ( fov.leftTan - fov.rightTan ) * pxscale * 0.5;\n\t\tvar pyscale = 2.0 / ( fov.upTan + fov.downTan );\n\t\tvar pyoffset = ( fov.upTan - fov.downTan ) * pyscale * 0.5;\n\t\treturn { scale: [ pxscale, pyscale ], offset: [ pxoffset, pyoffset ] };\n\n\t}\n\n\tfunction fovPortToProjection( fov, rightHanded, zNear, zFar ) {\n\n\t\trightHanded = rightHanded === undefined ? true : rightHanded;\n\t\tzNear = zNear === undefined ? 0.01 : zNear;\n\t\tzFar = zFar === undefined ? 10000.0 : zFar;\n\n\t\tvar handednessScale = rightHanded ? - 1.0 : 1.0;\n\n\t\t// start with an identity matrix\n\t\tvar mobj = new THREE.Matrix4();\n\t\tvar m = mobj.elements;\n\n\t\t// and with scale/offset info for normalized device coords\n\t\tvar scaleAndOffset = fovToNDCScaleOffset( fov );\n\n\t\t// X result, map clip edges to [-w,+w]\n\t\tm[ 0 * 4 + 0 ] = scaleAndOffset.scale[ 0 ];\n\t\tm[ 0 * 4 + 1 ] = 0.0;\n\t\tm[ 0 * 4 + 2 ] = scaleAndOffset.offset[ 0 ] * handednessScale;\n\t\tm[ 0 * 4 + 3 ] = 0.0;\n\n\t\t// Y result, map clip edges to [-w,+w]\n\t\t// Y offset is negated because this proj matrix transforms from world coords with Y=up,\n\t\t// but the NDC scaling has Y=down (thanks D3D?)\n\t\tm[ 1 * 4 + 0 ] = 0.0;\n\t\tm[ 1 * 4 + 1 ] = scaleAndOffset.scale[ 1 ];\n\t\tm[ 1 * 4 + 2 ] = - scaleAndOffset.offset[ 1 ] * handednessScale;\n\t\tm[ 1 * 4 + 3 ] = 0.0;\n\n\t\t// Z result (up to the app)\n\t\tm[ 2 * 4 + 0 ] = 0.0;\n\t\tm[ 2 * 4 + 1 ] = 0.0;\n\t\tm[ 2 * 4 + 2 ] = zFar / ( zNear - zFar ) * - handednessScale;\n\t\tm[ 2 * 4 + 3 ] = ( zFar * zNear ) / ( zNear - zFar );\n\n\t\t// W result (= Z in)\n\t\tm[ 3 * 4 + 0 ] = 0.0;\n\t\tm[ 3 * 4 + 1 ] = 0.0;\n\t\tm[ 3 * 4 + 2 ] = handednessScale;\n\t\tm[ 3 * 4 + 3 ] = 0.0;\n\n\t\tmobj.transpose();\n\n\t\treturn mobj;\n\n\t}\n\n\tfunction fovToProjection( fov, rightHanded, zNear, zFar ) {\n\n\t\tvar DEG2RAD = Math.PI / 180.0;\n\n\t\tvar fovPort = {\n\t\t\tupTan: Math.tan( fov.upDegrees * DEG2RAD ),\n\t\t\tdownTan: Math.tan( fov.downDegrees * DEG2RAD ),\n\t\t\tleftTan: Math.tan( fov.leftDegrees * DEG2RAD ),\n\t\t\trightTan: Math.tan( fov.rightDegrees * DEG2RAD )\n\t\t};\n\n\t\treturn fovPortToProjection( fovPort, rightHanded, zNear, zFar );\n\n\t}\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/vrEffect.js","import * as THREE from 'three';\n/**\n * @author mrdoob / http://mrdoob.com\n * @author stewdio / http://stewd.io\n */\n\nTHREE.ViveController = function ( id ) {\n\n\tTHREE.Object3D.call( this );\n\n\tvar scope = this;\n\tvar gamepad;\n\n\tvar axes = [ 0, 0 ];\n\tvar thumbpadIsPressed = false;\n\tvar triggerIsPressed = false;\n\tvar gripsArePressed = false;\n\tvar menuIsPressed = false;\n\n\tfunction findGamepad( id ) {\n\n\t\t// Iterate across gamepads as Vive Controllers may not be\n\t\t// in position 0 and 1.\n\n\t\tvar gamepads = navigator.getGamepads();\n\n\t\tfor ( var i = 0, j = 0; i < 4; i ++ ) {\n\n\t\t\tvar gamepad = gamepads[ i ];\n\n\t\t\tif ( gamepad && gamepad.id === 'OpenVR Gamepad' ) {\n\n\t\t\t\tif ( j === id ) return gamepad;\n\n\t\t\t\tj ++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tthis.matrixAutoUpdate = false;\n\tthis.standingMatrix = new THREE.Matrix4();\n\n\tthis.getGamepad = function () {\n\n\t\treturn gamepad;\n\n\t};\n\n\tthis.getButtonState = function ( button ) {\n\n\t\tif ( button === 'thumbpad' ) return thumbpadIsPressed;\n\t\tif ( button === 'trigger' ) return triggerIsPressed;\n\t\tif ( button === 'grips' ) return gripsArePressed;\n\t\tif ( button === 'menu' ) return menuIsPressed;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tgamepad = findGamepad( id );\n\n\t\tif ( gamepad !== undefined && gamepad.pose.position !== null && gamepad.pose.orientation !== null ) {\n\n\t\t\t//  Position and orientation.\n\n\t\t\tvar pose = gamepad.pose;\n\n\t\t\tscope.position.fromArray( pose.position );\n\t\t\tscope.quaternion.fromArray( pose.orientation );\n\t\t\tscope.matrix.compose( scope.position, scope.quaternion, scope.scale );\n\t\t\tscope.matrix.multiplyMatrices( scope.standingMatrix, scope.matrix );\n\t\t\tscope.matrixWorldNeedsUpdate = true;\n\t\t\tscope.visible = true;\n\n\t\t\t//  Thumbpad and Buttons.\n\n\t\t\tif ( axes[ 0 ] !== gamepad.axes[ 0 ] || axes[ 1 ] !== gamepad.axes[ 1 ] ) {\n\n\t\t\t\taxes[ 0 ] = gamepad.axes[ 0 ]; //  X axis: -1 = Left, +1 = Right.\n\t\t\t\taxes[ 1 ] = gamepad.axes[ 1 ]; //  Y axis: -1 = Bottom, +1 = Top.\n\t\t\t\tscope.dispatchEvent( { type: 'axischanged', axes: axes } );\n\n\t\t\t}\n\n\t\t\tif ( thumbpadIsPressed !== gamepad.buttons[ 0 ].pressed ) {\n\n\t\t\t\tthumbpadIsPressed = gamepad.buttons[ 0 ].pressed;\n\t\t\t\tvar event = new Event( thumbpadIsPressed ? 'thumbpaddown' : 'thumbpadup');\n\t\t\t\t//window.dispatchEvent( { type: thumbpadIsPressed ? 'thumbpaddown' : 'thumbpadup' } );\n\t\t\t\twindow.dispatchEvent(event);\n\t\t\t}\n\n\t\t\tif ( triggerIsPressed !== gamepad.buttons[ 1 ].pressed ) {\n\n\t\t\t\ttriggerIsPressed = gamepad.buttons[ 1 ].pressed;\n\t\t\t\t//scope.dispatchEvent( { type: triggerIsPressed ? 'triggerdown' : 'triggerup' } );\n\t\t\t\tvar event = new Event( triggerIsPressed ? 'triggerdown' : 'triggerup');\n\t\t\t\twindow.dispatchEvent(event);\n\n\t\t\t}\n\n\t\t\tif ( gripsArePressed !== gamepad.buttons[ 2 ].pressed ) {\n\n\t\t\t\tgripsArePressed = gamepad.buttons[ 2 ].pressed;\n\t\t\t\t//scope.dispatchEvent( { type: gripsArePressed ? 'gripsdown' : 'gripsup' } );\n\t\t\t\tvar event = new Event( gripsArePressed ? 'gripsdown' : 'gripsup');\n\t\t\t\twindow.dispatchEvent(event);\n\n\t\t\t}\n\n\t\t\tif ( menuIsPressed !== gamepad.buttons[ 3 ].pressed ) {\n\n\t\t\t\tmenuIsPressed = gamepad.buttons[ 3 ].pressed;\n\t\t\t\t//scope.dispatchEvent( { type: menuIsPressed ? 'menudown' : 'menuup' } );\n\t\t\t\tvar event = new Event( menuIsPressed ? 'menudown' : 'menuup' );\n\t\t\t\twindow.dispatchEvent(event);\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tscope.visible = false;\n\n\t\t}\n\n\t};\n\n};\n\nTHREE.ViveController.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.ViveController.prototype.constructor = THREE.ViveController;\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/viveController.js","import * as THREE from 'three';\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.OBJLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n\tthis.materials = null;\n\n\tthis.regexp = {\n\t\t// v float float float\n\t\tvertex_pattern           : /^v\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/,\n\t\t// vn float float float\n\t\tnormal_pattern           : /^vn\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/,\n\t\t// vt float float\n\t\tuv_pattern               : /^vt\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/,\n\t\t// f vertex vertex vertex\n\t\tface_vertex              : /^f\\s+(-?\\d+)\\s+(-?\\d+)\\s+(-?\\d+)(?:\\s+(-?\\d+))?/,\n\t\t// f vertex/uv vertex/uv vertex/uv\n\t\tface_vertex_uv           : /^f\\s+(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)(?:\\s+(-?\\d+)\\/(-?\\d+))?/,\n\t\t// f vertex/uv/normal vertex/uv/normal vertex/uv/normal\n\t\tface_vertex_uv_normal    : /^f\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)(?:\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+))?/,\n\t\t// f vertex//normal vertex//normal vertex//normal\n\t\tface_vertex_normal       : /^f\\s+(-?\\d+)\\/\\/(-?\\d+)\\s+(-?\\d+)\\/\\/(-?\\d+)\\s+(-?\\d+)\\/\\/(-?\\d+)(?:\\s+(-?\\d+)\\/\\/(-?\\d+))?/,\n\t\t// o object_name | g group_name\n\t\tobject_pattern           : /^[og]\\s*(.+)?/,\n\t\t// s boolean\n\t\tsmoothing_pattern        : /^s\\s+(\\d+|on|off)/,\n\t\t// mtllib file_reference\n\t\tmaterial_library_pattern : /^mtllib /,\n\t\t// usemtl material_name\n\t\tmaterial_use_pattern     : /^usemtl /\n\t};\n\n};\n\nTHREE.OBJLoader.prototype = {\n\n\tconstructor: THREE.OBJLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tonLoad( scope.parse( text ) );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\tsetPath: function ( value ) {\n\n\t\tthis.path = value;\n\n\t},\n\n\tsetMaterials: function ( materials ) {\n\n\t\tthis.materials = materials;\n\n\t},\n\n\t_createParserState : function () {\n\n\t\tvar state = {\n\t\t\tobjects  : [],\n\t\t\tobject   : {},\n\n\t\t\tvertices : [],\n\t\t\tnormals  : [],\n\t\t\tuvs      : [],\n\n\t\t\tmaterialLibraries : [],\n\n\t\t\tstartObject: function ( name, fromDeclaration ) {\n\n\t\t\t\t// If the current object (initial from reset) is not from a g/o declaration in the parsed\n\t\t\t\t// file. We need to use it for the first parsed g/o to keep things in sync.\n\t\t\t\tif ( this.object && this.object.fromDeclaration === false ) {\n\n\t\t\t\t\tthis.object.name = name;\n\t\t\t\t\tthis.object.fromDeclaration = ( fromDeclaration !== false );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\t\tthis.object._finalize();\n\n\t\t\t\t}\n\n\t\t\t\tvar previousMaterial = ( this.object && typeof this.object.currentMaterial === 'function' ? this.object.currentMaterial() : undefined );\n\n\t\t\t\tthis.object = {\n\t\t\t\t\tname : name || '',\n\t\t\t\t\tfromDeclaration : ( fromDeclaration !== false ),\n\n\t\t\t\t\tgeometry : {\n\t\t\t\t\t\tvertices : [],\n\t\t\t\t\t\tnormals  : [],\n\t\t\t\t\t\tuvs      : []\n\t\t\t\t\t},\n\t\t\t\t\tmaterials : [],\n\t\t\t\t\tsmooth : true,\n\n\t\t\t\t\tstartMaterial : function( name, libraries ) {\n\n\t\t\t\t\t\tvar previous = this._finalize( false );\n\n\t\t\t\t\t\t// New usemtl declaration overwrites an inherited material, except if faces were declared\n\t\t\t\t\t\t// after the material, then it must be preserved for proper MultiMaterial continuation.\n\t\t\t\t\t\tif ( previous && ( previous.inherited || previous.groupCount <= 0 ) ) {\n\n\t\t\t\t\t\t\tthis.materials.splice( previous.index, 1 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar material = {\n\t\t\t\t\t\t\tindex      : this.materials.length,\n\t\t\t\t\t\t\tname       : name || '',\n\t\t\t\t\t\t\tmtllib     : ( Array.isArray( libraries ) && libraries.length > 0 ? libraries[ libraries.length - 1 ] : '' ),\n\t\t\t\t\t\t\tsmooth     : ( previous !== undefined ? previous.smooth : this.smooth ),\n\t\t\t\t\t\t\tgroupStart : ( previous !== undefined ? previous.groupEnd : 0 ),\n\t\t\t\t\t\t\tgroupEnd   : -1,\n\t\t\t\t\t\t\tgroupCount : -1,\n\t\t\t\t\t\t\tinherited  : false,\n\n\t\t\t\t\t\t\tclone : function( index ) {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tindex      : ( typeof index === 'number' ? index : this.index ),\n\t\t\t\t\t\t\t\t\tname       : this.name,\n\t\t\t\t\t\t\t\t\tmtllib     : this.mtllib,\n\t\t\t\t\t\t\t\t\tsmooth     : this.smooth,\n\t\t\t\t\t\t\t\t\tgroupStart : this.groupEnd,\n\t\t\t\t\t\t\t\t\tgroupEnd   : -1,\n\t\t\t\t\t\t\t\t\tgroupCount : -1,\n\t\t\t\t\t\t\t\t\tinherited  : false\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tthis.materials.push( material );\n\n\t\t\t\t\t\treturn material;\n\n\t\t\t\t\t},\n\n\t\t\t\t\tcurrentMaterial : function() {\n\n\t\t\t\t\t\tif ( this.materials.length > 0 ) {\n\t\t\t\t\t\t\treturn this.materials[ this.materials.length - 1 ];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn undefined;\n\n\t\t\t\t\t},\n\n\t\t\t\t\t_finalize : function( end ) {\n\n\t\t\t\t\t\tvar lastMultiMaterial = this.currentMaterial();\n\t\t\t\t\t\tif ( lastMultiMaterial && lastMultiMaterial.groupEnd === -1 ) {\n\n\t\t\t\t\t\t\tlastMultiMaterial.groupEnd = this.geometry.vertices.length / 3;\n\t\t\t\t\t\t\tlastMultiMaterial.groupCount = lastMultiMaterial.groupEnd - lastMultiMaterial.groupStart;\n\t\t\t\t\t\t\tlastMultiMaterial.inherited = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Guarantee at least one empty material, this makes the creation later more straight forward.\n\t\t\t\t\t\tif ( end !== false && this.materials.length === 0 ) {\n\t\t\t\t\t\t\tthis.materials.push({\n\t\t\t\t\t\t\t\tname   : '',\n\t\t\t\t\t\t\t\tsmooth : this.smooth\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn lastMultiMaterial;\n\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t// Inherit previous objects material.\n\t\t\t\t// Spec tells us that a declared material must be set to all objects until a new material is declared.\n\t\t\t\t// If a usemtl declaration is encountered while this new object is being parsed, it will\n\t\t\t\t// overwrite the inherited material. Exception being that there was already face declarations\n\t\t\t\t// to the inherited material, then it will be preserved for proper MultiMaterial continuation.\n\n\t\t\t\tif ( previousMaterial && previousMaterial.name && typeof previousMaterial.clone === \"function\" ) {\n\n\t\t\t\t\tvar declared = previousMaterial.clone( 0 );\n\t\t\t\t\tdeclared.inherited = true;\n\t\t\t\t\tthis.object.materials.push( declared );\n\n\t\t\t\t}\n\n\t\t\t\tthis.objects.push( this.object );\n\n\t\t\t},\n\n\t\t\tfinalize : function() {\n\n\t\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\t\tthis.object._finalize();\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tparseVertexIndex: function ( value, len ) {\n\n\t\t\t\tvar index = parseInt( value, 10 );\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t\t},\n\n\t\t\tparseNormalIndex: function ( value, len ) {\n\n\t\t\t\tvar index = parseInt( value, 10 );\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t\t},\n\n\t\t\tparseUVIndex: function ( value, len ) {\n\n\t\t\t\tvar index = parseInt( value, 10 );\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 2 ) * 2;\n\n\t\t\t},\n\n\t\t\taddVertex: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.vertices;\n\t\t\t\tvar dst = this.object.geometry.vertices;\n\n\t\t\t\tdst.push( src[ a + 0 ] );\n\t\t\t\tdst.push( src[ a + 1 ] );\n\t\t\t\tdst.push( src[ a + 2 ] );\n\t\t\t\tdst.push( src[ b + 0 ] );\n\t\t\t\tdst.push( src[ b + 1 ] );\n\t\t\t\tdst.push( src[ b + 2 ] );\n\t\t\t\tdst.push( src[ c + 0 ] );\n\t\t\t\tdst.push( src[ c + 1 ] );\n\t\t\t\tdst.push( src[ c + 2 ] );\n\n\t\t\t},\n\n\t\t\taddVertexLine: function ( a ) {\n\n\t\t\t\tvar src = this.vertices;\n\t\t\t\tvar dst = this.object.geometry.vertices;\n\n\t\t\t\tdst.push( src[ a + 0 ] );\n\t\t\t\tdst.push( src[ a + 1 ] );\n\t\t\t\tdst.push( src[ a + 2 ] );\n\n\t\t\t},\n\n\t\t\taddNormal : function ( a, b, c ) {\n\n\t\t\t\tvar src = this.normals;\n\t\t\t\tvar dst = this.object.geometry.normals;\n\n\t\t\t\tdst.push( src[ a + 0 ] );\n\t\t\t\tdst.push( src[ a + 1 ] );\n\t\t\t\tdst.push( src[ a + 2 ] );\n\t\t\t\tdst.push( src[ b + 0 ] );\n\t\t\t\tdst.push( src[ b + 1 ] );\n\t\t\t\tdst.push( src[ b + 2 ] );\n\t\t\t\tdst.push( src[ c + 0 ] );\n\t\t\t\tdst.push( src[ c + 1 ] );\n\t\t\t\tdst.push( src[ c + 2 ] );\n\n\t\t\t},\n\n\t\t\taddUV: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.uvs;\n\t\t\t\tvar dst = this.object.geometry.uvs;\n\n\t\t\t\tdst.push( src[ a + 0 ] );\n\t\t\t\tdst.push( src[ a + 1 ] );\n\t\t\t\tdst.push( src[ b + 0 ] );\n\t\t\t\tdst.push( src[ b + 1 ] );\n\t\t\t\tdst.push( src[ c + 0 ] );\n\t\t\t\tdst.push( src[ c + 1 ] );\n\n\t\t\t},\n\n\t\t\taddUVLine: function ( a ) {\n\n\t\t\t\tvar src = this.uvs;\n\t\t\t\tvar dst = this.object.geometry.uvs;\n\n\t\t\t\tdst.push( src[ a + 0 ] );\n\t\t\t\tdst.push( src[ a + 1 ] );\n\n\t\t\t},\n\n\t\t\taddFace: function ( a, b, c, d, ua, ub, uc, ud, na, nb, nc, nd ) {\n\n\t\t\t\tvar vLen = this.vertices.length;\n\n\t\t\t\tvar ia = this.parseVertexIndex( a, vLen );\n\t\t\t\tvar ib = this.parseVertexIndex( b, vLen );\n\t\t\t\tvar ic = this.parseVertexIndex( c, vLen );\n\t\t\t\tvar id;\n\n\t\t\t\tif ( d === undefined ) {\n\n\t\t\t\t\tthis.addVertex( ia, ib, ic );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tid = this.parseVertexIndex( d, vLen );\n\n\t\t\t\t\tthis.addVertex( ia, ib, id );\n\t\t\t\t\tthis.addVertex( ib, ic, id );\n\n\t\t\t\t}\n\n\t\t\t\tif ( ua !== undefined ) {\n\n\t\t\t\t\tvar uvLen = this.uvs.length;\n\n\t\t\t\t\tia = this.parseUVIndex( ua, uvLen );\n\t\t\t\t\tib = this.parseUVIndex( ub, uvLen );\n\t\t\t\t\tic = this.parseUVIndex( uc, uvLen );\n\n\t\t\t\t\tif ( d === undefined ) {\n\n\t\t\t\t\t\tthis.addUV( ia, ib, ic );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tid = this.parseUVIndex( ud, uvLen );\n\n\t\t\t\t\t\tthis.addUV( ia, ib, id );\n\t\t\t\t\t\tthis.addUV( ib, ic, id );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( na !== undefined ) {\n\n\t\t\t\t\t// Normals are many times the same. If so, skip function call and parseInt.\n\t\t\t\t\tvar nLen = this.normals.length;\n\t\t\t\t\tia = this.parseNormalIndex( na, nLen );\n\n\t\t\t\t\tib = na === nb ? ia : this.parseNormalIndex( nb, nLen );\n\t\t\t\t\tic = na === nc ? ia : this.parseNormalIndex( nc, nLen );\n\n\t\t\t\t\tif ( d === undefined ) {\n\n\t\t\t\t\t\tthis.addNormal( ia, ib, ic );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tid = this.parseNormalIndex( nd, nLen );\n\n\t\t\t\t\t\tthis.addNormal( ia, ib, id );\n\t\t\t\t\t\tthis.addNormal( ib, ic, id );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\taddLineGeometry: function ( vertices, uvs ) {\n\n\t\t\t\tthis.object.geometry.type = 'Line';\n\n\t\t\t\tvar vLen = this.vertices.length;\n\t\t\t\tvar uvLen = this.uvs.length;\n\n\t\t\t\tfor ( var vi = 0, l = vertices.length; vi < l; vi ++ ) {\n\n\t\t\t\t\tthis.addVertexLine( this.parseVertexIndex( vertices[ vi ], vLen ) );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var uvi = 0, l = uvs.length; uvi < l; uvi ++ ) {\n\n\t\t\t\t\tthis.addUVLine( this.parseUVIndex( uvs[ uvi ], uvLen ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tstate.startObject( '', false );\n\n\t\treturn state;\n\n\t},\n\n\tparse: function ( text ) {\n\n\t\tconsole.time( 'OBJLoader' );\n\n\t\tvar state = this._createParserState();\n\n\t\tif ( text.indexOf( '\\r\\n' ) !== - 1 ) {\n\n\t\t\t// This is faster than String.split with regex that splits on both\n\t\t\ttext = text.replace( '\\r\\n', '\\n' );\n\n\t\t}\n\n\t\tvar lines = text.split( '\\n' );\n\t\tvar line = '', lineFirstChar = '', lineSecondChar = '';\n\t\tvar lineLength = 0;\n\t\tvar result = [];\n\n\t\t// Faster to just trim left side of the line. Use if available.\n\t\tvar trimLeft = ( typeof ''.trimLeft === 'function' );\n\n\t\tfor ( var i = 0, l = lines.length; i < l; i ++ ) {\n\n\t\t\tline = lines[ i ];\n\n\t\t\tline = trimLeft ? line.trimLeft() : line.trim();\n\n\t\t\tlineLength = line.length;\n\n\t\t\tif ( lineLength === 0 ) continue;\n\n\t\t\tlineFirstChar = line.charAt( 0 );\n\n\t\t\t// @todo invoke passed in handler if any\n\t\t\tif ( lineFirstChar === '#' ) continue;\n\n\t\t\tif ( lineFirstChar === 'v' ) {\n\n\t\t\t\tlineSecondChar = line.charAt( 1 );\n\n\t\t\t\tif ( lineSecondChar === ' ' && ( result = this.regexp.vertex_pattern.exec( line ) ) !== null ) {\n\n\t\t\t\t\t// 0                  1      2      3\n\t\t\t\t\t// [\"v 1.0 2.0 3.0\", \"1.0\", \"2.0\", \"3.0\"]\n\n\t\t\t\t\tstate.vertices.push(\n\t\t\t\t\t\tparseFloat( result[ 1 ] ),\n\t\t\t\t\t\tparseFloat( result[ 2 ] ),\n\t\t\t\t\t\tparseFloat( result[ 3 ] )\n\t\t\t\t\t);\n\n\t\t\t\t} else if ( lineSecondChar === 'n' && ( result = this.regexp.normal_pattern.exec( line ) ) !== null ) {\n\n\t\t\t\t\t// 0                   1      2      3\n\t\t\t\t\t// [\"vn 1.0 2.0 3.0\", \"1.0\", \"2.0\", \"3.0\"]\n\n\t\t\t\t\tstate.normals.push(\n\t\t\t\t\t\tparseFloat( result[ 1 ] ),\n\t\t\t\t\t\tparseFloat( result[ 2 ] ),\n\t\t\t\t\t\tparseFloat( result[ 3 ] )\n\t\t\t\t\t);\n\n\t\t\t\t} else if ( lineSecondChar === 't' && ( result = this.regexp.uv_pattern.exec( line ) ) !== null ) {\n\n\t\t\t\t\t// 0               1      2\n\t\t\t\t\t// [\"vt 0.1 0.2\", \"0.1\", \"0.2\"]\n\n\t\t\t\t\tstate.uvs.push(\n\t\t\t\t\t\tparseFloat( result[ 1 ] ),\n\t\t\t\t\t\tparseFloat( result[ 2 ] )\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( \"Unexpected vertex/normal/uv line: '\" + line  + \"'\" );\n\n\t\t\t\t}\n\n\t\t\t} else if ( lineFirstChar === \"f\" ) {\n\n\t\t\t\tif ( ( result = this.regexp.face_vertex_uv_normal.exec( line ) ) !== null ) {\n\n\t\t\t\t\t// f vertex/uv/normal vertex/uv/normal vertex/uv/normal\n\t\t\t\t\t// 0                        1    2    3    4    5    6    7    8    9   10         11         12\n\t\t\t\t\t// [\"f 1/1/1 2/2/2 3/3/3\", \"1\", \"1\", \"1\", \"2\", \"2\", \"2\", \"3\", \"3\", \"3\", undefined, undefined, undefined]\n\n\t\t\t\t\tstate.addFace(\n\t\t\t\t\t\tresult[ 1 ], result[ 4 ], result[ 7 ], result[ 10 ],\n\t\t\t\t\t\tresult[ 2 ], result[ 5 ], result[ 8 ], result[ 11 ],\n\t\t\t\t\t\tresult[ 3 ], result[ 6 ], result[ 9 ], result[ 12 ]\n\t\t\t\t\t);\n\n\t\t\t\t} else if ( ( result = this.regexp.face_vertex_uv.exec( line ) ) !== null ) {\n\n\t\t\t\t\t// f vertex/uv vertex/uv vertex/uv\n\t\t\t\t\t// 0                  1    2    3    4    5    6   7          8\n\t\t\t\t\t// [\"f 1/1 2/2 3/3\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", undefined, undefined]\n\n\t\t\t\t\tstate.addFace(\n\t\t\t\t\t\tresult[ 1 ], result[ 3 ], result[ 5 ], result[ 7 ],\n\t\t\t\t\t\tresult[ 2 ], result[ 4 ], result[ 6 ], result[ 8 ]\n\t\t\t\t\t);\n\n\t\t\t\t} else if ( ( result = this.regexp.face_vertex_normal.exec( line ) ) !== null ) {\n\n\t\t\t\t\t// f vertex//normal vertex//normal vertex//normal\n\t\t\t\t\t// 0                     1    2    3    4    5    6   7          8\n\t\t\t\t\t// [\"f 1//1 2//2 3//3\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", undefined, undefined]\n\n\t\t\t\t\tstate.addFace(\n\t\t\t\t\t\tresult[ 1 ], result[ 3 ], result[ 5 ], result[ 7 ],\n\t\t\t\t\t\tundefined, undefined, undefined, undefined,\n\t\t\t\t\t\tresult[ 2 ], result[ 4 ], result[ 6 ], result[ 8 ]\n\t\t\t\t\t);\n\n\t\t\t\t} else if ( ( result = this.regexp.face_vertex.exec( line ) ) !== null ) {\n\n\t\t\t\t\t// f vertex vertex vertex\n\t\t\t\t\t// 0            1    2    3   4\n\t\t\t\t\t// [\"f 1 2 3\", \"1\", \"2\", \"3\", undefined]\n\n\t\t\t\t\tstate.addFace(\n\t\t\t\t\t\tresult[ 1 ], result[ 2 ], result[ 3 ], result[ 4 ]\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( \"Unexpected face line: '\" + line  + \"'\" );\n\n\t\t\t\t}\n\n\t\t\t} else if ( lineFirstChar === \"l\" ) {\n\n\t\t\t\tvar lineParts = line.substring( 1 ).trim().split( \" \" );\n\t\t\t\tvar lineVertices = [], lineUVs = [];\n\n\t\t\t\tif ( line.indexOf( \"/\" ) === - 1 ) {\n\n\t\t\t\t\tlineVertices = lineParts;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfor ( var li = 0, llen = lineParts.length; li < llen; li ++ ) {\n\n\t\t\t\t\t\tvar parts = lineParts[ li ].split( \"/\" );\n\n\t\t\t\t\t\tif ( parts[ 0 ] !== \"\" ) lineVertices.push( parts[ 0 ] );\n\t\t\t\t\t\tif ( parts[ 1 ] !== \"\" ) lineUVs.push( parts[ 1 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tstate.addLineGeometry( lineVertices, lineUVs );\n\n\t\t\t} else if ( ( result = this.regexp.object_pattern.exec( line ) ) !== null ) {\n\n\t\t\t\t// o object_name\n\t\t\t\t// or\n\t\t\t\t// g group_name\n\n\t\t\t\tvar name = result[ 0 ].substr( 1 ).trim();\n\t\t\t\tstate.startObject( name );\n\n\t\t\t} else if ( this.regexp.material_use_pattern.test( line ) ) {\n\n\t\t\t\t// material\n\n\t\t\t\tstate.object.startMaterial( line.substring( 7 ).trim(), state.materialLibraries );\n\n\t\t\t} else if ( this.regexp.material_library_pattern.test( line ) ) {\n\n\t\t\t\t// mtl file\n\n\t\t\t\tstate.materialLibraries.push( line.substring( 7 ).trim() );\n\n\t\t\t} else if ( ( result = this.regexp.smoothing_pattern.exec( line ) ) !== null ) {\n\n\t\t\t\t// smooth shading\n\n\t\t\t\t// @todo Handle files that have varying smooth values for a set of faces inside one geometry,\n\t\t\t\t// but does not define a usemtl for each face set.\n\t\t\t\t// This should be detected and a dummy material created (later MultiMaterial and geometry groups).\n\t\t\t\t// This requires some care to not create extra material on each smooth value for \"normal\" obj files.\n\t\t\t\t// where explicit usemtl defines geometry groups.\n\t\t\t\t// Example asset: examples/models/obj/cerberus/Cerberus.obj\n\n\t\t\t\tvar value = result[ 1 ].trim().toLowerCase();\n\t\t\t\tstate.object.smooth = ( value === '1' || value === 'on' );\n\n\t\t\t\tvar material = state.object.currentMaterial();\n\t\t\t\tif ( material ) {\n\n\t\t\t\t\tmaterial.smooth = state.object.smooth;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// Handle null terminated files without exception\n\t\t\t\tif ( line === '\\0' ) continue;\n\n\t\t\t\tthrow new Error( \"Unexpected line: '\" + line  + \"'\" );\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.finalize();\n\n\t\tvar container = new THREE.Group();\n\t\tcontainer.materialLibraries = [].concat( state.materialLibraries );\n\n\t\tfor ( var i = 0, l = state.objects.length; i < l; i ++ ) {\n\n\t\t\tvar object = state.objects[ i ];\n\t\t\tvar geometry = object.geometry;\n\t\t\tvar materials = object.materials;\n\t\t\tvar isLine = ( geometry.type === 'Line' );\n\n\t\t\t// Skip o/g line declarations that did not follow with any faces\n\t\t\tif ( geometry.vertices.length === 0 ) continue;\n\n\t\t\tvar buffergeometry = new THREE.BufferGeometry();\n\n\t\t\tbuffergeometry.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( geometry.vertices ), 3 ) );\n\n\t\t\tif ( geometry.normals.length > 0 ) {\n\n\t\t\t\tbuffergeometry.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array( geometry.normals ), 3 ) );\n\n\t\t\t} else {\n\n\t\t\t\tbuffergeometry.computeVertexNormals();\n\n\t\t\t}\n\n\t\t\tif ( geometry.uvs.length > 0 ) {\n\n\t\t\t\tbuffergeometry.addAttribute( 'uv', new THREE.BufferAttribute( new Float32Array( geometry.uvs ), 2 ) );\n\n\t\t\t}\n\n\t\t\t// Create materials\n\n\t\t\tvar createdMaterials = [];\n\n\t\t\tfor ( var mi = 0, miLen = materials.length; mi < miLen ; mi++ ) {\n\n\t\t\t\tvar sourceMaterial = materials[mi];\n\t\t\t\tvar material = undefined;\n\n\t\t\t\tif ( this.materials !== null ) {\n\n\t\t\t\t\tmaterial = this.materials.create( sourceMaterial.name );\n\n\t\t\t\t\t// mtl etc. loaders probably can't create line materials correctly, copy properties to a line material.\n\t\t\t\t\tif ( isLine && material && ! ( material instanceof THREE.LineBasicMaterial ) ) {\n\n\t\t\t\t\t\tvar materialLine = new THREE.LineBasicMaterial();\n\t\t\t\t\t\tmaterialLine.copy( material );\n\t\t\t\t\t\tmaterial = materialLine;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! material ) {\n\n\t\t\t\t\tmaterial = ( ! isLine ? new THREE.MeshPhongMaterial() : new THREE.LineBasicMaterial() );\n\t\t\t\t\tmaterial.name = sourceMaterial.name;\n\n\t\t\t\t}\n\n\t\t\t\tmaterial.shading = sourceMaterial.smooth ? THREE.SmoothShading : THREE.FlatShading;\n\n\t\t\t\tcreatedMaterials.push(material);\n\n\t\t\t}\n\n\t\t\t// Create mesh\n\n\t\t\tvar mesh;\n\n\t\t\tif ( createdMaterials.length > 1 ) {\n\n\t\t\t\tfor ( var mi = 0, miLen = materials.length; mi < miLen ; mi++ ) {\n\n\t\t\t\t\tvar sourceMaterial = materials[mi];\n\t\t\t\t\tbuffergeometry.addGroup( sourceMaterial.groupStart, sourceMaterial.groupCount, mi );\n\n\t\t\t\t}\n\n\t\t\t\tvar multiMaterial = new THREE.MultiMaterial( createdMaterials );\n\t\t\t\tmesh = ( ! isLine ? new THREE.Mesh( buffergeometry, multiMaterial ) : new THREE.LineSegments( buffergeometry, multiMaterial ) );\n\n\t\t\t} else {\n\n\t\t\t\tmesh = ( ! isLine ? new THREE.Mesh( buffergeometry, createdMaterials[ 0 ] ) : new THREE.LineSegments( buffergeometry, createdMaterials[ 0 ] ) );\n\t\t\t}\n\n\t\t\tmesh.name = object.name;\n\n\t\t\tcontainer.add( mesh );\n\n\t\t}\n\n\t\tconsole.timeEnd( 'OBJLoader' );\n\n\t\treturn container;\n\n\t}\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/objLoader.js","import * as THREE from 'three';\n\nTHREE.Reticle = function(camera) {\n\n    var reticle = {};\n\n    reticle.armObject = null;\n    reticle.reticleObject = null;\n    reticle.dot = null;\n    reticle.intersection = null;\n    reticle.colliders = [];\n\n    const defaultMaterial = new THREE.MeshBasicMaterial({color: '#a9a9a9',transparent: true,opacity: 0 });\n    const hitMaterial = new THREE.MeshBasicMaterial({color: '#ff0000',transparent: true,opacity: 0.7 });\n\n    reticle.createDefaultObject = function(position, length, isDot) {\n        if (isDot) {\n            var defaultGeometry = new THREE.SphereGeometry(0.007, 32, length);\n        } else {\n            var defaultGeometry = new THREE.TorusGeometry( 0.2, 0.04, 16, 100 );\n        }\n        var defaultObject = new THREE.Mesh(defaultGeometry, defaultMaterial);\n        defaultObject.position.copy(position);\n        defaultObject.rotation.x = -Math.PI * 0.5;\n        return defaultObject;\n    };\n\n    reticle.init = function(camera) {\n        this.camera = camera;\n        this.armObject = new THREE.Object3D();\n        this.reticleObject = this.createDefaultObject(new THREE.Vector3(0, 0, -0.5), .01, false);\n        this.armObject.add(this.reticleObject);\n\n        this.dot = this.createDefaultObject(new THREE.Vector3(0, 0, -0.5), .01, true);\n        this.camera.add(this.armObject);\n        this.camera.add(this.dot);\n        this.startClock();\n    };\n\n    reticle.getReticlePosition = function() {\n        return reticle.reticleObject.position;\n    };\n\n    reticle.remvoeFromList = function(object_in, list_in) {\n        var index = list_in.indexOf(object_in);\n        if (index > -1) {\n            list_in.splice(index, 1);\n        }\n    };\n\n    reticle.addCollider = function(threeObject) {\n        this.colliders.push(threeObject);\n    };\n\n    reticle.removeCollider = function(threeObject) {\n        this.remvoeFromList(threeObject, reticle.colliders);\n    };\n\n    reticle.update = function(parent) {\n        var camDirection = new THREE.Vector3();\n        this.camera.getWorldDirection( camDirection );\n        var ray = new THREE.Raycaster(this.camera.position, camDirection);\n\n\n        var intersects = ray.intersectObjects(this.colliders);\n        if (intersects.length > 0) {\n            //save the new hit object and time\n            this.intersection = intersects[0];\n            this.reticleObject.position.copy(this.intersection.point);\n            if(parent) this.reticleObject.position.sub(parent.position);\n\n            this.reticleObject.material = hitMaterial;\n            this.dot.material.opacity = 0;\n\n        } else {\n            this.dot.material.opacity = 1;\n            this.reticleObject.material = defaultMaterial;\n        }\n    }\n\n    reticle.startClock = function() {\n        this.clock = new THREE.Clock(true);\n    }\n\n    reticle.init(camera);\n\n    return reticle;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/reticle.js","import * as THREE from 'three';\r\n/**\r\n * @author dmarcos / https://github.com/dmarcos\r\n * @author mrdoob / http://mrdoob.com\r\n */\r\n\r\nexport default function VRControls( object, onError ) {\r\n\r\n\tvar scope = this;\r\n\r\n\tvar vrDisplay, vrDisplays;\r\n\r\n\tvar standingMatrix = new THREE.Matrix4();\r\n\r\n\tfunction gotVRDisplays( displays ) {\r\n\r\n\t\tvrDisplays = displays;\r\n\r\n\t\tfor ( var i = 0; i < displays.length; i ++ ) {\r\n\r\n\t\t\tif ( ( 'VRDisplay' in window && displays[ i ] instanceof VRDisplay ) ||\r\n\t\t\t\t ( 'PositionSensorVRDevice' in window && displays[ i ] instanceof PositionSensorVRDevice ) ) {\r\n\r\n\t\t\t\tvrDisplay = displays[ i ];\r\n\t\t\t\tbreak;  // We keep the first we encounter\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( vrDisplay === undefined ) {\r\n\r\n\t\t\tif ( onError ) onError( 'VR input not available.' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tif ( navigator.getVRDisplays ) {\r\n\r\n\t\tnavigator.getVRDisplays().then( gotVRDisplays );\r\n\r\n\t} else if ( navigator.getVRDevices ) {\r\n\r\n\t\t// Deprecated API.\r\n\t\tnavigator.getVRDevices().then( gotVRDisplays );\r\n\r\n\t}\r\n\r\n\t// the Rift SDK returns the position in meters\r\n\t// this scale factor allows the user to define how meters\r\n\t// are converted to scene units.\r\n\r\n\tthis.scale = 1;\r\n\r\n\t// If true will use \"standing space\" coordinate system where y=0 is the\r\n\t// floor and x=0, z=0 is the center of the room.\r\n\tthis.standing = false;\r\n\r\n\t// Distance from the users eyes to the floor in meters. Used when\r\n\t// standing=true but the VRDisplay doesn't provide stageParameters.\r\n\tthis.userHeight = 1.6;\r\n\r\n\tthis.offset = new THREE.Vector3(0,0,0);\r\n\r\n\tthis.getVRDisplay = function () {\r\n\r\n\t\treturn vrDisplay;\r\n\r\n\t};\r\n\r\n\tthis.getVRDisplays = function () {\r\n\r\n\t\treturn vrDisplays;\r\n\r\n\t};\r\n\r\n\tthis.getStandingMatrix = function () {\r\n\r\n\t\treturn standingMatrix;\r\n\r\n\t};\r\n\r\n\tthis.update = function () {\r\n\r\n\t\tif ( vrDisplay ) {\r\n\r\n\t\t\tif ( vrDisplay.getPose ) {\r\n\r\n\t\t\t\tvar pose = vrDisplay.getPose();\r\n\t\t\t\tif ( pose.orientation !== null ) {\r\n\r\n\t\t\t\t\tobject.quaternion.fromArray( pose.orientation );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( pose.position !== null ) {\r\n\r\n\t\t\t\t\tobject.position.fromArray( pose.position );\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif(vrDisplay.capabilities.hasExternalDisplay) {\r\n\t\t\t\t\t\tobject.position.set( 0, 1.6, 1.5 );\r\n\t\t\t\t\t\tobject.quaternion.set(0, 0, 0, 1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Deprecated API.\r\n\t\t\t\tvar state = vrDisplay.getState();\r\n\r\n\t\t\t\tif ( state.orientation !== null ) {\r\n\r\n\t\t\t\t\tobject.quaternion.copy( state.orientation );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( state.position !== null ) {\r\n\r\n\t\t\t\t\tobject.position.copy( state.position );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t//object.position.set( 0, 0, 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.standing ) {\r\n\r\n\t\t\t\tif ( vrDisplay.stageParameters ) {\r\n\r\n\t\t\t\t\tobject.updateMatrix();\r\n\r\n\t\t\t\t\tstandingMatrix.fromArray( vrDisplay.stageParameters.sittingToStandingTransform );\r\n\t\t\t\t\tobject.applyMatrix( standingMatrix );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tobject.position.setY( object.position.y + this.userHeight );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.position.multiplyScalar( scope.scale );\r\n\t\t\tobject.position.add(this.offset);\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.resetPose = function () {\r\n\r\n\t\tif ( vrDisplay ) {\r\n\r\n\t\t\tif ( vrDisplay.resetPose !== undefined ) {\r\n\r\n\t\t\t\tvrDisplay.resetPose();\r\n\r\n\t\t\t} else if ( vrDisplay.resetSensor !== undefined ) {\r\n\r\n\t\t\t\t// Deprecated API.\r\n\t\t\t\tvrDisplay.resetSensor();\r\n\r\n\t\t\t} else if ( vrDisplay.zeroSensor !== undefined ) {\r\n\r\n\t\t\t\t// Really deprecated API.\r\n\t\t\t\tvrDisplay.zeroSensor();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.resetSensor = function () {\r\n\r\n\t\tconsole.warn( 'THREE.VRControls: .resetSensor() is now .resetPose().' );\r\n\t\tthis.resetPose();\r\n\r\n\t};\r\n\r\n\tthis.zeroSensor = function () {\r\n\r\n\t\tconsole.warn( 'THREE.VRControls: .zeroSensor() is now .resetPose().' );\r\n\t\tthis.resetPose();\r\n\r\n\t};\r\n\r\n\tthis.dispose = function () {\r\n\r\n\t\tvrDisplay = null;\r\n\r\n\t};\r\n\r\n\tthis.setOffset = function (v) {\r\n      this.offset.copy(v);\r\n\t}\r\n\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/vrControls.js","import * as THREE from 'three';\nconst { tan, cos, atan, acos, min, max, pow, PI, sqrt } = Math;\nimport { initCamera } from '../camera';\nimport decompose from '../utils/decompose';\nimport { getCamera, getCameraWorldTransform, getRect, } from '../../modules/player';\nimport { get, set } from '../../modules/scene';\nimport updateCameraLookAtTarget from '../utils/updateCameraLookAtTarget';\nimport getTargetWorldMatrix from '../utils/getTargetWorldMatrix';\nimport { merge, virtualTargetId } from '../../modules/sceneGraph';\n\nconst directionKeys = {\n  w: 'FORWARD',\n  a: 'LEFT',\n  s: 'BACKWARD',\n  d: 'RIGHT',\n  ArrowUp: 'FORWARD',\n  ArrowLeft: 'LEFT',\n  ArrowDown: 'BACKWARD',\n  ArrowRight: 'RIGHT',\n};\n\nconst directions = {\n  FORWARD: ['y', 1],\n  BACKWARD: ['y', -1],\n  LEFT: ['x', -1],\n  RIGHT: ['x', 1],\n};\n\nconst SPEED = 0.2;\nexport default function firstPersonMode(store, translator) {\n  let oldOrbitMode = '';\n  let velocity = new THREE.Vector3(0, 0, 0);\n  const axes = { x: 0, y: 0, z: 0 };\n\n  function setVelocity(axis, factor) {\n    axes[axis] += factor;\n    velocity = new THREE.Vector3(axes.x, axes.y, axes.z).normalize().multiplyScalar(SPEED);\n  }\n\n  return {\n    name: 'firstPersonMode',\n    active:  false,\n    enabled: true,\n    options: {\n      movementMode: 'fly',\n      keyboardEnabled: true,\n    },\n    display: {\n      playerTools: false,\n    },\n\n    heldKeys: [],\n\n    tool: {\n\n      keydown: function (ev) {\n        const direction = directionKeys[ev.key];\n        if (direction && this.active) {\n          this.heldKeys.push(ev.key);\n          const [axis, factor] = directions[direction];\n          setVelocity(axis, factor);\n        }\n      },\n\n      keyup: function (ev) {\n        const direction = directionKeys[ev.key];\n        if (direction && this.active) {\n          const idx = this.heldKeys.indexOf(ev.key);\n          this.heldKeys.splice(idx, 1);\n          const [axis, factor] = directions[direction];\n          setVelocity(axis, -factor);\n        }\n      },\n\n      keyheld: function (ev) {\n        const firstKey = this.heldKeys[0];\n        if (ev.key === firstKey && this.options.keyboardEnabled) {\n          const movement = firstPersonMovement(store, velocity, this.options.movementMode);\n          if (movement && translator.externals.vrControls) {\n            translator.externals.vrControls.offset.add(movement);\n          }\n        }\n      },\n    },\n\n    activate: function () {\n      oldOrbitMode = get(store, { scene: true, plug: 'Player', property: 'orbitMode' });\n      store.dispatch(set({ scene: true, plug: 'Player', property: 'orbitMode' }, 'firstPerson'));\n    },\n\n    deactivate: function () {\n      store.dispatch(set({ scene: true, plug: 'Player', property: 'orbitMode' }, oldOrbitMode));\n    },\n\n  };\n}\n\nconst UP_POSITION = new THREE.Vector3(0, 1, 0);\n\nfunction firstPersonMovement(store, direction, movementMode) {\n  const playerData = get(store, { scene: true, evalPlug: 'Player' });\n  const cameraId = getCamera(store);\n  const cameraWorldMatrix = getCameraWorldTransform(store);\n  const targetWorldMatrix = getTargetWorldMatrix(store, cameraId);\n  const cameraData = get(store, { id:  cameraId, evalPlug: 'Camera' });\n\n  if (targetWorldMatrix && cameraWorldMatrix && cameraData.upPosition) {\n    const cameraPosition = new THREE.Vector3();\n    const targetPosition = new THREE.Vector3();\n    cameraPosition.setFromMatrixPosition(cameraWorldMatrix);\n    targetPosition.setFromMatrixPosition(targetWorldMatrix);\n\n    let forward = new THREE.Vector3().subVectors(targetPosition, cameraPosition).normalize();\n    if (movementMode === 'plane') forward.projectOnPlane(UP_POSITION).normalize();\n\n    const right = new THREE.Vector3().crossVectors(forward, UP_POSITION).normalize();\n\n    const movement = new THREE.Vector3().addScaledVector(forward, direction.y).addScaledVector(right, direction.x);\n    if (movement.y < -cameraPosition.y && playerData.constraintCameraY) movement.y = -cameraPosition.y;\n\n    cameraPosition.add(movement);\n    targetPosition.add(movement);\n\n    cameraWorldMatrix.setPosition(cameraPosition);\n    targetWorldMatrix.setPosition(targetPosition);\n\n    updateCameraLookAtTarget(cameraWorldMatrix, targetWorldMatrix, cameraData.upPosition);\n\n    store.dispatch(merge([cameraId, 'Transform', 0], decompose(cameraWorldMatrix)));\n    if (!get(store, { id: cameraId, evalPlug: 'Transform' }).target) {\n      store.dispatch(merge([virtualTargetId, 'Transform', 0], decompose(targetWorldMatrix)));\n    }\n\n    return movement;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/tools/firstPersonMode.js","import * as THREE from 'three';\nimport { createTranslator } from './translator';\nimport { convertToPolyMesh, convertToCNSPolyMesh, checkGeometryCache, cacheGeometry } from './bingeom';\nimport { primitiveToMaterial, getCubeMapTexture, assignTexture, getTextureImage } from './materials';\nimport { polyMeshToBufferGeometry } from './polyMesh';\nimport { createLight, updateLight } from './light';\nimport { setMatrixOn } from './transform';\nimport { initCamera, initCameraRadiusConstraint, resizeCamera, updateLookatTarget } from './camera';\nimport { initManipulators } from './manipulators';\nimport setMatrixOnNode from './utils/setMatrixOnNode';\n\nimport { getScreenPositionNormalAlpha } from './annotation';\nimport { getSceneId, reportError } from '../modules/sceneIO';\nimport { initNode, replace, virtualCameraId, virtualTargetId } from '../modules/sceneGraph';\nimport { getWorldTransform } from '../modules/scene';\nimport { getRenderingMode, isDeviceTracking, RENDER_MODES, setPlayerElement, setThreeScene, getCamera } from '../modules/player';\nimport { getActiveCommandsWithWidgets, getTools, getCommands } from '../modules/commands';\nimport { getSelectedNodes, isHighlighting } from '../modules/selection';\n\nimport OutlinePass from './utils/outlinePass'; // FIXME should be OutlinePass.js\n\nimport calculateBoundingBox from './utils/calculateBoundingBox';\nimport FXAAShader from './utils/FXAAShader';\n\nimport ParallaxBarrierEffect from './utils/parallaxBarrierEffect'; // extend three with StereoEffect\nimport VRControls from './utils/vrControls';\n\nimport { ThreeExport } from '../polyMesh';\n\nconst BACKGROUND_STYLE_DEFAULT = 0;\nconst BACKGROUND_STYLE_COLOR = 1;\nconst BACKGROUND_STYLE_IMAGE = 2;\nconst BACKGROUND_STYLE_CUBEMAP = 3;\nconst BACKGROUND_STYLE_ENVIRONMENT = 4;\n\nfunction initTranslator(store, context, translator) {\n  let sceneGraph = store.get('sceneGraph');\n\n  const scene = new THREE.Scene();\n  const camera = new THREE.PerspectiveCamera(75, 4 / 3, 0.1, 1000);\n\n  const rendererAttrs = {\n    antialias: false,\n    precision: 'highp',\n    alpha: true,\n    preserveDrawingBuffer: true,\n  };\n  if (context) {\n    rendererAttrs.canvas = { style: {}, addEventListener: () => {} };\n    rendererAttrs.context = context;\n  }\n\n  let isIOS = false;\n  let isAndroid = false;\n  let isMSPhone = false;\n  let isMobile = false;\n\n  const renderer = new THREE.WebGLRenderer(rendererAttrs);\n  renderer.setClearColor(0xffffff);\n  renderer.autoResizeTextures = false;\n  renderer.gammaInput = true;\n  renderer.gammaOutput = true;\n  renderer.toneMapping = THREE.ReinhardToneMapping;\n  renderer.physicallyCorrectLights = true;\n  if (__BROWSER__) {\n    let pixelRatio = window.devicePixelRatio;\n    renderer.setPixelRatio(pixelRatio);\n    if( window.navigator ) {\n      let userAgent = window.navigator.userAgent;\n      isIOS = /iPad|iPhone|iPod/.test(userAgent);\n      isAndroid = /Android/i.test(userAgent);\n      isMSPhone = /IEMobile|Windows Phone|Lumia/i.test(userAgent)\n      isMobile = isIOS || isAndroid || isMSPhone || /Blackberry|webOS/i.test(userAgent);\n    }\n  }\n  renderer.isMobile = isMobile;\n\n  store.dispatch(setThreeScene(scene, camera, renderer));\n\n  let el = null;\n  let playerEl = null; // This is the parent element that we control (div.claraplayer)\n\n  const nodes = {};\n  let translated = {\n    // [ nodeId ]: { [PlugName]: _v }\n  };\n  const annotations = {};\n  const rect = new THREE.Vector2(400, 300);\n  let tools = [];\n  let interactionHandler = null;\n  let cameraId = virtualCameraId;     // The camera we want to move\n  let fromCameraId = virtualCameraId; // The camera we want to use to initialize camera position\n  let translatedCameraId = null;      // The camera that we initialized from\n  let pivotId = null;\n  let loaded = null;\n  let reflectiveFloorMaterial = null;\n  let reflectiveFloorMesh = null;\n\n  let vrControls;\n\n  const externals = {};\n\n  const translatorState = {};\n\n  function getContext() {\n    return renderer.getContext();\n  }\n\n  let selectedNodes = getSelectedNodes(store);\n\n  // use ssaa on the server\n  const serverRenderingMode = !!context;\n\n  const composer = new THREE.EffectComposer(renderer);\n\n  const clearPass = new THREE.ClearPass();\n  clearPass.enabled = true;\n  composer.addPass(clearPass);\n\n  const texturePass = new THREE.TexturePass();\n  texturePass.clear = false;\n  texturePass.enabled = false;\n  composer.addPass(texturePass);\n\n  const cubeTexturePass = new THREE.CubeTexturePass(scene, camera);\n  cubeTexturePass.clear = false;\n  cubeTexturePass.enabled = false;\n  composer.addPass(cubeTexturePass);\n\n  const ssaaRenderPass = new THREE.SSAARenderPass(scene, camera);\n  ssaaRenderPass.clear = false;\n  ssaaRenderPass.sampleLevel = serverRenderingMode ? 2 : 1;\n  ssaaRenderPass.unbiased = true;\n  ssaaRenderPass.enabled = true;\n  composer.addPass(ssaaRenderPass);\n\n  const renderPass = new THREE.RenderPass(scene, camera);//, null, 0xffffff);\n  //renderPass.clear = false;\n  //renderPass.enabled = false;\n  composer.addPass(renderPass);\n\n  const fullWidth = __BROWSER__ ? window.innerWidth : 400;\n  const fullHeight = __BROWSER__ ? window.innerHeight : 300;\n\n  const effectFXAA = new THREE.ShaderPass(FXAAShader);\n  effectFXAA.uniforms['resolution'].value.set(1 / fullWidth, 1 / fullHeight);\n  composer.addPass(effectFXAA);\n\n  const saoPass = new THREE.SAOPass(scene, camera);\n  saoPass.downSamplingRatio = serverRenderingMode ? 1 : 1; // fast enough if not full screen (I think.)\n  saoPass.intensity = 3;\n  saoPass.occlusionSphereWorldRadius = 2;\n  saoPass.blurEnabled = true;\n  //saoPass.outputOverride = \"default\";\n  saoPass.manualCompositing = false;\n  saoPass.blurKernelSize = ((saoPass.downSamplingRatio === 1) ? 6 : 6) + (serverRenderingMode ? 2 : 0);\n  saoPass.enabled = true;\n  if( ! isMobile ) {\n    composer.addPass(saoPass);\n  }\n\n  const dofPass = new THREE.DofPass(new THREE.Vector2(fullWidth, fullHeight), scene, camera);\n  composer.addPass(dofPass);\n\n  const bloomPass = new THREE.UnrealBloomPass(new THREE.Vector2(fullWidth, fullHeight), 1.5, 1, 1);\n  composer.addPass(bloomPass);\n\n  const outlinePass = new OutlinePass(new THREE.Vector2(fullWidth, fullHeight), scene, camera);\n  outlinePass.edgeStrength = 10;\n  outlinePass.edgeGlow = 0;\n  outlinePass.edgeThickness = 1;\n  outlinePass.pulsePeriod = 0;\n  outlinePass.visibleEdgeColor = new THREE.Color(0, 1, 0);\n  outlinePass.hiddenEdgeColor = new THREE.Color(0, 1, 0);\n  composer.addPass(outlinePass);\n\n  const copyPass = new THREE.ShaderPass(THREE.CopyShader);\n  copyPass.renderToScreen = true;\n  composer.addPass(copyPass);\n\n  const stereoEffect = new ParallaxBarrierEffect(renderer);\n\n  function resize(width, height) {\n    if (el) {\n      const elRect = el.parentNode.getBoundingClientRect();\n      width = elRect.width;\n      height = elRect.height;\n    }\n\n    if (width < 10 || height < 10) return;\n\n    rect.set(width, height);\n\n    resizeCamera(store, cameraId, rect);\n    renderer.setSize(rect.width, rect.height);\n\n    if( reflectiveFloorMaterial !== null ) {\n      reflectiveFloorMaterial.setSize( rect.width, rect.height );\n    }\n    const pixelRatio = renderer.getPixelRatio();\n    composer.setSize(rect.width * pixelRatio, rect.height * pixelRatio);\n\n    /*console.log( 'pixelDeviceRatio', pixelRatio );\n    console.log( 'renderer size', rect.width, rect.height );\n    console.log( 'composer size', rect.width * pixelRatio, rect.height * pixelRatio );\n    console.log( 'pixel size', rect.width * window.devicePixelRatio, rect.height * window.devicePixelRatio );*/\n\n    if (interactionHandler) interactionHandler.resize(rect);\n\n    if (height && height !== 0) {\n      camera.aspect = width / height;\n      camera.updateProjectionMatrix();\n    }\n\n    effectFXAA.uniforms['resolution'].value.set(1 / width, 1 / height);\n  }\n\n  /*\n   * Attach the renderer's canvas element to the DOM?.\n   */\n  function attach(element) {\n    el = element;\n    el.insertBefore(renderer.domElement, el.firstChild);\n    renderer.domElement.tabIndex = 1;\n\n    playerEl = el.parentElement;\n    store.dispatch(setPlayerElement(playerEl, renderer.domElement));\n    resize();\n  }\n\n  function orientHandle() {\n    console.log('orientHandle', !!vrControls);\n    if (vrControls) vrControls.update();\n    store.dispatch({ type: 'POKE' });\n  }\n\n  function deviceTrackingTransition(enabled) {\n    vrControls = enabled ? new VRControls(camera) : null;\n    window[enabled ? 'addEventListener' : 'removeEventListener']('deviceorientation', orientHandle);\n  }\n\n  function handleStateChanges() {\n    // TODO: only do this if the player has changed. Requires moving the cameraWorldMatrix\n    // out of the player state.\n    //\n\n    function stateChange(key, handler) {\n      const newState = store.getIn(['player', key]);\n      if (translatorState[key] !== newState) {\n        handler(newState, translatorState[key]);\n        translatorState[key] = newState;\n      }\n    }\n\n    if (__BROWSER__) stateChange('deviceTracking', deviceTrackingTransition);\n  }\n\n  function highlightSelection(rootNodeId) {\n    const node = rootNodeId && nodes[rootNodeId];\n    outlinePass.selectedObjects = node ? [node] : [];\n  }\n\n  /*\n   * After all nodes have been translated.\n   */\n  let renderDisplaySceneTimeout = null;\n  let lastRenderStartTime = -1;\n  let lastRenderDeltaTime = -1;\n\n  function updateRenderTime() {\n    const currentRenderStartTime = Date.now();\n    if (lastRenderStartTime > 0) {\n      lastRenderDeltaTime = currentRenderStartTime - lastRenderStartTime;\n    } else {\n      lastRenderDeltaTime = -1;\n    }\n\n    lastRenderStartTime = currentRenderStartTime;\n  }\n\n  function postTranslate() {\n    const renderingMode = getRenderingMode(store);\n\n    if (renderDisplaySceneTimeout) {\n      clearTimeout(renderDisplaySceneTimeout);\n    }\n\n    updateRenderTime();\n\n    const playerCameraId = getCamera(store);\n\n    // If we are switching the threejs camera, it should already be initialized\n    // (from VR controls, or previous camera, so just directly translate it)\n    if (cameraId !== playerCameraId) {\n      cameraId = playerCameraId;\n      fromCameraId = cameraId;\n      translatedCameraId = cameraId;\n      translate(cameraId, sceneGraph.evaluatedNodes[cameraId], sceneGraph.nodes[cameraId], true);\n    }\n\n    if (fromCameraId !== translatedCameraId) {\n      // Translate the new camera\n      translate(cameraId, sceneGraph.evaluatedNodes[cameraId], sceneGraph.nodes[cameraId], true);\n    }\n\n    handleStateChanges();\n\n    if (interactionHandler) {\n      updateTools();\n      updateWidgets();\n    }\n\n    selectedNodes = getSelectedNodes(store);\n    if (isHighlighting(store) && selectedNodes.length) {\n      highlightSelection(selectedNodes[0]);\n    } else {\n      highlightSelection(null);\n    }\n\n    if (reflectiveFloorMesh && reflectiveFloorMesh.data.reflectiveFloor) {\n     reflectiveFloorMaterial.distanceFade = reflectiveFloorMesh.data.reflectiveFloorFade;\n      reflectiveFloorMaterial.roughness = reflectiveFloorMesh.data.reflectiveFloorRoughness;\n      reflectiveFloorMaterial.metalness = reflectiveFloorMesh.data.reflectiveFloorMetallic;\n      reflectiveFloorMaterial.opacity = reflectiveFloorMesh.data.reflectiveFloorOpacity;\n      reflectiveFloorMaterial.fresnelStrength = reflectiveFloorMesh.data.reflectiveFloorFresnel;\n      reflectiveFloorMaterial.reflectivity = 0.5;\n\n      renderer.setClearColor(renderPass.clearColor, renderPass.clearAlpha);\n      reflectiveFloorMaterial.render(renderer, scene, camera, rect.width, rect.height);\n\n      //reflectiveFloorMesh.material = new THREE.MeshStandardMaterial({ emissive: 0xff00ff, emissiveMap: reflectiveFloorMaterial.material.uniforms.tReflection.value });\n    }\n    //renderer.setClearColor(renderPass.clearColor, renderPass.clearAlpha);\n\n    cubeTexturePass.camera = camera;\n    if (renderingMode === RENDER_MODES.normal) {\n      //renderer.autoClear = true;\n      renderer.setClearColor(0xffffff);\n      renderPass.enabled = false;\n      effectFXAA.enabled = false;\n      ssaaRenderPass.enabled = true;\n      //renderer.setClearAlpha(0.9);\n      composer.render();\n    } else if (renderingMode === RENDER_MODES.vr) {\n      renderPass.enabled = true;\n      effectFXAA.enabled = true;\n      ssaaRenderPass.enabled = false;\n      if (!externals.vrEffect) {\n        throw new Error('Expect vr mode to initialize vrEffect');\n      }\n\n      externals.vrEffect.render(scene, camera, null, true);\n    } else if (renderingMode === RENDER_MODES.lenticular) {\n      stereoEffect.render(scene, camera);\n    }\n\n    if (renderingMode === RENDER_MODES.normal) {\n      if (!serverRenderingMode || lastRenderDeltaTime > 0) {\n        renderDisplaySceneTimeout = setTimeout(function () {\n\n          updateRenderTime();\n\n          ssaaRenderPass.sampleLevel = 2;\n          composer.render();\n          ssaaRenderPass.sampleLevel = 1;\n\n          lastRenderStartTime = -1;\n          /*\n\n          renderDisplaySceneTimeout = setTimeout(function () {\n\n            updateRenderTime();\n\n            ssaaRenderPass.sampleLevel = 3;\n            composer.render();\n            ssaaRenderPass.sampleLevel = 1;\n          }, Math.max(lastRenderDeltaTime, 100) * 4);*/\n        }, Math.max(lastRenderDeltaTime, 100) * 4);\n      }\n    }\n  }\n\n  function updateTools() {\n    const commands = getCommands(store);\n    if (tools !== getTools(store)) {\n      tools = getTools(store);\n      interactionHandler.updateTools(tools.map((n) => commands[n]).toArray());\n    }\n  }\n\n  function initWidgets(command, name, rootName) {\n    nodes[rootName] = new THREE.Object3D();\n    nodes[rootName].name = name;\n    nodes.widgets.add(nodes[rootName]);\n    if (command.options.displayGizmo !== false) command.widget.draw.call(command, nodes[rootName]);\n  }\n\n  function removeWidgets(command, threeObject, name, rootName) {\n    const widget = command.widget;\n    if (widget && widget.remove) {\n      widget.remove.call(command, threeObject);\n    }\n\n    nodes.widgets.remove(threeObject);\n    delete nodes[rootName];\n  }\n\n  function updateWidgets() {\n    const commands = getCommands(store);\n    const activeCommandsWithWidgets = getActiveCommandsWithWidgets(store);\n\n    nodes.widgets.children.forEach((child) => {\n      if (!activeCommandsWithWidgets[child.name]) {\n        removeWidgets(commands[child.name], child, child.name, `widgetsRoot-${child.name}`);\n      }\n    });\n\n    Object.values(activeCommandsWithWidgets).forEach((command) => {\n      const { name, widget } = command;\n      const rootName = `widgetsRoot-${name}`;\n      if (!nodes[rootName]) initWidgets(command, name, rootName);\n      if (widget && widget.position) widget.position.call(command, nodes[rootName]);\n    });\n  }\n\n  /*\n   * Scene is loaded.\n   */\n  function onLoad() {\n    loaded = true;\n    const playerData = sceneGraph.evaluatedNodes[getSceneId(store)].Player;\n\n    if (!playerData.orbitTarget) {\n      const bbCenter = calculateBoundingBox(scene).getCenter();\n      if (isNaN(bbCenter.x) || isNaN(bbCenter.y) || isNaN(bbCenter.z)) bbCenter.set(0, 0, 0);\n      setMatrixOnNode(store, virtualTargetId, new THREE.Matrix4().makeTranslation(bbCenter.x, bbCenter.y, bbCenter.z));\n    }\n\n    if (!context) {\n      interactionHandler = initManipulators(store, this, renderer.domElement);\n      interactionHandler.resize(rect);\n    }\n\n    nodes.widgets = new THREE.Object3D();\n    nodes.widgets.name = 'Widgets';\n    scene.add(nodes.widgets);\n  }\n\n  function getAnnotations() {\n    return annotations;\n  }\n\n  function addToParent(id, node, obj, skipReplace) {\n    // console.log('Add toParent: ', node && node.get('parent'), obj);\n    const parentId = node && node.parent;\n    const parent = (parentId && nodes[parentId]) || scene;\n    obj.name = node.name; // eslint-disable-line no-param-reassign\n    obj.nodeId = id;\n\n    if (nodes[id]) {\n      if (skipReplace) return;\n\n      const children = [].concat(nodes[id].children);\n      for (let i = 0; i < children.length; i++) {\n        nodes[id].remove(children[i]);\n        obj.add(children[i]);\n      }\n\n      parent.remove(nodes[id]);\n      if (nodes[id].geometry) nodes[id].geometry.dispose();\n    }\n\n    nodes[id] = obj;\n    parent.add(nodes[id]);\n  }\n\n  const plugs = {\n    PolyMesh: (id, data, node, properties) => {\n      const visible = properties.visible;\n      const { mesh, previousMesh } = data;\n\n      //const collapseMaps = true;\n      const indexingMode = renderer.extensions.get('OES_element_index_uint') ? ThreeExport.CompactIndices : ThreeExport.NoIndices;\n      const interleaved = false;\n      const oldMesh = nodes[id];\n      const prevTriangulation = oldMesh && oldMesh.userData.triangulation;\n      const prevIndexing = oldMesh && oldMesh.userData.renderIndexing;\n      const prevValueMap = oldMesh && oldMesh.userData.valueMap;\n      const bufferInfo = mesh && ThreeExport.exportBufferGeometry(mesh, indexingMode, interleaved, null, previousMesh, prevTriangulation, prevIndexing, prevValueMap);\n\n      let geometry, triangulation, triangulationChanged, renderIndexing, valueMap;\n      if (bufferInfo) {\n        geometry = bufferInfo.geometry;\n        triangulation = bufferInfo.triangulation;\n        triangulationChanged = bufferInfo.triangulationChanged;\n        renderIndexing  = bufferInfo.renderIndexing;\n        valueMap = bufferInfo.valueMap;\n      }\n\n      let obj;\n\n      if (triangulationChanged || !oldMesh) {\n        obj = geometry && new THREE.Mesh(geometry, primitiveToMaterial(store));\n      } else {\n        obj = oldMesh;\n        if (geometry) {\n          obj.geometry.dispose();\n          obj.geometry = geometry;\n        }\n        //obj.material.dispose();\n        //obj.material = primitiveToMaterial(store);\n      }\n\n      if (obj) {\n        obj.visible = visible;\n        obj.userData.triangulation = triangulation;\n        obj.userData.renderIndexing = renderIndexing;\n        obj.userData.valueMap = valueMap;\n      }\n\n      addToParent(id, node, obj || new THREE.Object3D());\n    },\n\n    Light: (id, data, node) => {\n      let obj = nodes[id];\n      if (!obj) {\n        obj = createLight(data);\n        if (obj) addToParent(id, node, obj);\n      } else {\n        updateLight(data, obj);\n      }\n    },\n\n    Bone: (id, data, node) => {\n      if (!nodes[id]) addToParent(id, node, new THREE.Object3D());\n    },\n\n    Null: (id, data, node) => {\n      if (!nodes[id]) addToParent(id, node, new THREE.Object3D());\n    },\n\n    PrefetchMaterialNull: (id, data, node, properties) => {\n      if (loaded && properties.prefetch && !nodes[id]) {\n        //console.log('Add a node for prefetch of material: ', node.name);\n        addToParent(id, node, new THREE.Object3D());\n      }\n    },\n\n    Transform: (id, data, node) => {\n      if (!data || !data.transform) return;\n      if (nodes[id]) setMatrixOn(nodes[id], data.transform);\n    },\n\n    Material: (id, data) => {\n      if (!nodes[id]) return;\n      nodes[id].material = primitiveToMaterial(store, renderer, data, nodes[id].material);\n    },\n\n    Image: (id, data, node, properties) => {\n      if (loaded && properties.prefetch) getTextureImage(store, data);\n    },\n\n    Environment: (id, data) => {\n      const backgroundStyle = data.backgroundStyle;\n      clearPass.enabled = false;\n      cubeTexturePass.enabled = false;\n\n      switch (backgroundStyle) {\n\n        case BACKGROUND_STYLE_COLOR:\n          clearPass.enabled = true;\n          clearPass.clearColor = data.backgroundColor;\n          clearPass.clearAlpha = data.backgroundOpacity;\n          break;\n        case BACKGROUND_STYLE_IMAGE:\n          texturePass.enabled = true;\n          texturePass.map = assignTexture(store, renderer, data.background);\n          break;\n        case BACKGROUND_STYLE_CUBEMAP:\n        case BACKGROUND_STYLE_ENVIRONMENT: {\n\n          clearPass.enabled = true;\n          clearPass.clearColor = 0x000000;\n          clearPass.clearAlpha = 0.0;\n\n          cubeTexturePass.enabled = true;\n\n          let cubeMapNode;\n          let cubeMapBlurring;\n\n          if (backgroundStyle === BACKGROUND_STYLE_ENVIRONMENT) {\n            cubeMapNode = data.environmentMap;\n            if (cubeMapNode) {\n              cubeMapNode = cubeMapNode.specularCubeMap;\n            }\n\n            cubeMapBlurring = data.environmentMapBlurring;\n          } else {\n            cubeMapNode = data.cubeMap;\n            cubeMapBlurring = data.cubeMapBlurring;\n          }\n\n          if (cubeMapNode) {\n            cubeTexturePass.envMap = getCubeMapTexture(store, renderer, cubeMapNode, true);\n            cubeTexturePass.envMapIntensity = 1.0;\n            cubeTexturePass.opacity = data.backgroundOpacity;\n            cubeTexturePass.roughness = data.cubeMapBlurring;\n          } else {\n            cubeTexturePass.enabled = false;\n          }\n        }\n\n          break;\n\n        default:\n          clearPass.enabled = true;\n          clearPass.clearColor = new THREE.Color(1, 1, 1);\n          clearPass.clearAlpha = 0;\n          break;\n      }\n    },\n\n    Player: (id, data, node) => {\n      if (data.camera && data.camera !== fromCameraId && sceneGraph.nodes[data.camera]) {\n        const fromNode = sceneGraph.nodes[data.camera];\n        const cameraNode = sceneGraph.nodes[cameraId];\n        const copiedNode = initNode(fromNode);\n        const target = copiedNode.plugs.Transform.find((op) => op.target);\n        if (target) copiedNode.plugs.Camera[0].targeted = true;\n        store.dispatch(replace(cameraId, Object.assign(cameraNode, { plugs: copiedNode.plugs })));\n        fromCameraId = data.camera;\n      }\n\n      if (data.orbitTarget && data.orbitTarget !== pivotId) {\n        pivotId = data.orbitTarget;\n        // FIXME: remove scale here?\n        setMatrixOnNode(store, virtualTargetId, getWorldTransform(store, pivotId));\n      }\n\n      const styleToToneMapping = {\n        Linear: THREE.LinearToneMapping,\n        Reinhard: THREE.ReinhardToneMapping,\n        Cineon: THREE.CineonToneMapping,\n        Filmic: THREE.Uncharted2ToneMapping,\n      };\n\n      renderer.toneMapping = styleToToneMapping[data.toneMapStyle];\n      renderer.toneMappingExposure = data.toneMapExposureGain;\n      renderer.toneMappingWhitePoint = data.toneMapWhitePoint;\n      renderer.gammaInput = true;\n      renderer.gammaOutput = true;\n      renderer.autoClear = false;\n\n      saoPass.enabled = data.saoPass;\n      saoPass.intensity = data.saoIntensity;\n      saoPass.occlusionSphereWorldRadius = data.saoScale;\n\n      bloomPass.enabled = data.bloomPass;\n      bloomPass.threshold = data.bloomThreshold;\n      //bloomPass.smoothWidth = data.bloomBlendRange;//not exposed in three.js yet\n\n      dofPass.enabled = data.dofPass;\n      //dofPass.dofMaxBlur = data.dofMaxBlur; //not exposed in three.js yet\n\n      if (data.reflectiveFloor && ((!data.reflectiveFloorExcludeServer) || __BROWSER__)) {\n\n        if (!reflectiveFloorMaterial) {\n          const mirrorGeo = new THREE.PlaneBufferGeometry(1, 1);\n          reflectiveFloorMaterial = new THREE.GlossyMirror({ clipBias: 0.003, textureWidth: 1024, textureHeight: 1024, color: 0x777777, localMirrorNormal: new THREE.Vector3(0, 1, 0) });\n          reflectiveFloorMesh = new THREE.Mesh(mirrorGeo, reflectiveFloorMaterial.material);\n        }\n\n        reflectiveFloorMaterial.specularColor = new THREE.Color(0xffffff);\n\n        reflectiveFloorMesh.scale.x = data.reflectiveFloorWidth;\n        reflectiveFloorMesh.scale.y = data.reflectiveFloorWidth;\n        reflectiveFloorMesh.rotation.x = -Math.PI * 0.5;\n        reflectiveFloorMesh.position.y = data.reflectiveFloorHeight;\n\n        reflectiveFloorMesh.data = data;\n\n        if (!reflectiveFloorMesh.parent) {\n          scene.add(reflectiveFloorMesh);\n        }\n      } else {\n        if (reflectiveFloorMesh && reflectiveFloorMesh.parent) {\n          scene.remove(reflectiveFloorMesh);\n        }\n      }\n    },\n\n    CameraTransform: (id, data, node, Properties, nodeData) => {\n      if (id === cameraId && loaded) {\n        if (translatedCameraId !== fromCameraId || !nodeData.Camera.upPosition) {\n          initCamera(store, true, fromCameraId, id, rect);\n\n          translatedCameraId = fromCameraId;\n        }\n\n        const cameraData = nodeData.Camera;\n        const matrix = data.target && cameraData.targeted && cameraData.upPosition\n          ? updateLookatTarget(store, id, data, cameraData)\n          : data.transform;\n        setMatrixOn(camera, matrix);\n      }\n    },\n\n    Camera: (id, data, node) => {\n      if (id === cameraId && loaded) {\n        camera.fov = data.fieldOfView;\n        camera.aspect = data.aspectRatio;\n        camera.near = data.nearClip;\n        camera.far = data.farClip;\n\n        dofPass.focalDepth = data.focalDepthEnabled ? data.focalDepth : data.targetDistance;\n        camera.updateProjectionMatrix();\n      }\n\n      if (data.newRadiusConstraint) initCameraRadiusConstraint(store, id, data, data.newRadiusConstraint);\n    },\n\n    Annotation: (id, data, node, properties) => {\n      const calcDirection = data.directionMode === 'awayFromOrigin';\n      annotations[id] = {\n        id: id,\n        annotation: data,\n        position: getScreenPositionNormalAlpha(id, calcDirection, data.directionAxis, data.directionTarget),\n        visible: properties.visible,\n      };\n    },\n  };\n\n  plugs.BinMesh = plugs.PolyMesh;\n\n  const order = {\n    Scene: ['Player', 'Environment'],\n    BinMesh: ['BinMesh', 'Transform', 'Material'],\n    PolyMesh: ['PolyMesh', 'Transform', 'Material'],\n    Light: ['Light', 'Transform'],\n    Camera: [['Transform', 'CameraTransform'], 'Camera'],\n    Null: ['Null', 'Transform'],\n    Model: ['Null', 'Transform'],\n    Objects: ['Null'],\n    MaterialLibrary: ['Null'],\n    Material: ['PrefetchMaterialNull', 'Material'], // for prefetch of material\n    Image: ['Image'], // for prefetch of image\n    Renderers: [],\n    Passes: [],\n    Pass: [],\n    Renderer: [],\n    Bone: ['Bone', 'Transform'],\n    Annotation: ['Annotation'],\n  };\n\n  const forceDeps = {\n    // When the mesh has changed, we need to run material translator again\n    PolyMesh: { Material: true, Transform: true },\n    BinMesh: { Material: true, Transform: true },\n  };\n\n  /*\n   * Translate a node, either create or update\n   */\n  function translate(id, data, node, force) {\n    const type = node.type;\n    const processPlugs = order[type] || [];\n    if (!translated[id]) translated[id] = {};\n    let translateAnyway = {};\n    let plug;\n    let plugFunction;\n\n    //console.log('translate: ', type, node.name, translated[id]);\n    for (const nextPlug of processPlugs) {\n      [plug, plugFunction] = Array.isArray(nextPlug) ? nextPlug : [nextPlug, nextPlug];\n\n      let plugData = data[plug];\n      if (force || !plugData || plugData._v !== translated[id][plug] || translateAnyway[plug]) {\n        if (forceDeps[plug]) translateAnyway = forceDeps[plug];\n        //console.log(' - ', plug);\n        if (plugs[plugFunction]) {\n          plugs[plugFunction](id, plugData, node, data.Properties, data);\n          translated[id][plug] = plugData && plugData._v;\n        } else {\n          console.warn('Unknown plug translator for: ', plug, node.name);\n        }\n      }\n    }\n  }\n\n  /*\n   * Delete a node\n   */\n  function deleteNode(id) {\n    const obj = nodes[id];\n    const annoObj = annotations[id];\n\n    if (obj || annoObj) delete translated[id];\n\n    if (obj) {\n      delete nodes[id];\n      obj.parent.remove(obj);\n    } else if (annoObj) {\n      delete annotations[id];\n    }\n  }\n\n  function getNodeBoundingBox(id) {\n    return calculateBoundingBox(nodes[id]);\n  }\n\n  function getThreeObject(id) {\n    return nodes[id];\n  }\n\n  function getCameraMouseRay(ndc) {\n    const ray = new THREE.Raycaster();\n    ray.setFromCamera(ndc, camera);\n    return ray;\n  }\n\n  function raycastSelect(mousePosition, rootNode='Objects') {\n    let hits = [];\n    let selectedObjects = [];\n    const ray = getCameraMouseRay(mousePosition);\n    let objectsRoot = scene;\n    scene.children.forEach((child)=> {\n      if (child.type === 'Object3D' && child.name === rootNode) objectsRoot = child;\n    });\n\n    objectsRoot.traverse((node)=> {\n      if (!node.visible) return;\n      if (!node.geometry) return;\n\n      if (node.geometry.boundingBox === null) {\n        node.geometry.computeBoundingBox();\n      }\n\n      const geometry = node.geometry;\n\n      if (geometry.boundingBox.isEmpty() === false) {\n        node.matrix.compose(node.position, node.quaternion, node.scale);\n        node.updateMatrixWorld(true);\n        const inter = ray.intersectObject(node);\n        if (inter.length > 0) {\n          hits.push({ id: node.nodeId, node: node, data: inter });\n        }\n      }\n    });\n    hits.sort((a, b)=> {\n      return a.data[0].distance - b.data[0].distance;\n    });\n\n    return hits;\n  }\n\n  function getObjectRoot(nodeId) {\n    let id = null;\n\n    if (nodeId !== null) {\n      const rootNode = nodes[nodeId];\n      rootNode.traverse((node)=> {\n        if (node.name === 'Fbx_Root') {//Need to find the first child node of Import_Null\n          id = node.nodeId;\n        }\n      });\n    }\n\n    return id;\n  }\n\n  function toScreenPosition(rootNodeId) {\n    if (rootNodeId) {\n      const obj = nodes[rootNodeId];\n      if (obj) {\n        const vector = new THREE.Vector3();\n\n        const widthHalf = 0.5 * renderer.context.canvas.width;\n        const heightHalf = 0.5 * renderer.context.canvas.height;\n\n        obj.updateMatrixWorld();\n        const bbox = calculateBoundingBox(obj);\n        const height = bbox.max.y - bbox.min.y;\n        obj.updateMatrixWorld();\n        vector.setFromMatrixPosition(obj.matrixWorld);\n        vector.y += height;\n        vector.project(camera);\n\n        vector.x = (vector.x * widthHalf) + widthHalf;\n        vector.y = -(vector.y * heightHalf) + heightHalf;\n\n        return {\n          x: vector.x,\n          y: vector.y,\n        };\n      }\n    }\n  };\n\n  function reset() {\n    loaded = null;\n    cameraId = virtualCameraId;\n    fromCameraId = virtualCameraId;\n    translatedCameraId = null;\n    pivotId = null;\n    translated = {};\n  }\n\n  return {\n    attach,\n    resize,\n    translate,\n    deleteNode,\n    raycastSelect,\n    getCameraMouseRay,\n    getNodeBoundingBox,\n    getThreeObject,\n    toScreenPosition,\n    getObjectRoot,\n    postTranslate,\n    onLoad,\n    getAnnotations,\n    getContext,\n    reset,\n    scene,\n    camera,\n    renderer,\n    externals,\n  };\n}\n\nexport default function threeTranslator(store, context) {\n  return createTranslator(store, initTranslator, context);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/three.js","import { markPreloaded, markLoaded, isSceneLoaded, areAssetsLoaded, areAssetsPreloaded,\n  markRenderedScene, markRenderingScene, getSceneId, getScenePhase, SCENE_PHASES } from '../modules/sceneIO';\nimport { getEvalSceneGraph, virtualCameraId, vrCameraId, virtualTargetId, merge } from '../modules/sceneGraph';\nimport { incrementTime } from '../modules/animation';\n\nconst defaultNodeFilter = (n) => true;\n\nconst defaultFns = {\n  onLoad() {},\n\n  postTranslate() {},\n\n  handleStateChanges() {},\n};\n\nexport function createTranslator(store, initTranslator, context) {\n  let api = {};\n  let translator = initTranslator(store, context, api);\n  let nodeFilter = defaultNodeFilter;\n\n  let view = null;\n  let player = store.get('player');\n\n  let translatedSceneId;\n\n  let translatedVersion = null;\n  let translatedNodes = {};\n  let renderingMode = store.getIn(['player', 'renderingMode']);\n  let vrDisplay;\n\n  function translateNodes(sceneId) {\n    const sceneGraph = getEvalSceneGraph(store);\n\n    if (translatedVersion === sceneGraph._ev) return 0;\n\n    const newTranslatedNodes = {};\n\n    //console.log('translate from', translatedVersion, 'to', sceneGraph._ev); //, translatedNodes);\n\n    let numUpdated = 0;\n\n    function translateNode(id) {\n      const node = sceneGraph.nodes[id];\n      if (!node) return;\n      const result = sceneGraph.evaluatedNodes[id];\n      const translated = translatedNodes[id];\n\n      if (!translated || translated._v !== result._v || translated._ev !== result._ev) {\n        //console.log('translate: ', translatedNodes[id], {_v: result._v, _ev: result._ev}, node.name);\n        translator.translate(id, result, node);\n        numUpdated += 1;\n      }\n\n      newTranslatedNodes[id] = { _v: result._v, _ev: result._ev };\n\n      for (let childId of node.children) {\n        translateNode(childId);\n      }\n    }\n\n    translateNode(sceneId);\n\n    if (sceneGraph.nodes[virtualCameraId]) translateNode(virtualCameraId);\n    if (sceneGraph.nodes[vrCameraId]) translateNode(vrCameraId);\n\n    for (const id of Object.keys(translatedNodes)) {\n      if (!newTranslatedNodes[id]) {\n        translator.deleteNode(id);\n      }\n    }\n\n    translatedNodes = newTranslatedNodes;\n    translatedVersion = sceneGraph._ev;\n\n    return numUpdated;\n  }\n\n  function doUpdate() {\n  }\n\n  function reset() {\n    translator.reset();\n    for (const id of Object.keys(translatedNodes)) {\n      translator.deleteNode(id);\n    }\n\n    translatedVersion = null;\n    translatedNodes = {};\n  }\n\n  return Object.assign({}, defaultFns, translator, {\n    update: function (options={}) {\n      const sceneId = getSceneId(store);\n      const scenePhase = getScenePhase(store);\n      if (!sceneId) {\n        translatedSceneId = null;\n        return;\n      }\n\n      if (sceneId !== translatedSceneId || scenePhase < SCENE_PHASES.RENDERING) {\n        reset();\n        translatedSceneId = sceneId;\n      }\n\n      // console.log('translator do update');\n      const numUpdated = translateNodes(sceneId);\n      //console.log('numUpdated: ', numUpdated);\n      const rendering = scenePhase >= SCENE_PHASES.RENDERING;\n      const preloaded = scenePhase >= SCENE_PHASES.PRELOADING;\n      const loaded = scenePhase >= SCENE_PHASES.LOADED;\n      const rendered = scenePhase >= SCENE_PHASES.RENDERED;\n\n      //console.log('numUpdated', numUpdated, 'assetsLoaded', areAssetsLoaded(store), 'rendering', rendering, 'preloaded', preloaded, 'loaded', loaded);\n\n      if (!rendering && numUpdated) {\n        store.dispatch(markRenderingScene());\n      }\n\n      if (loaded && !rendered) {\n        store.dispatch(markRenderedScene());\n      }\n\n      if (!loaded && preloaded && areAssetsLoaded(store)) {\n        translator.onLoad();\n        store.dispatch(markLoaded());\n      }\n\n      if (!preloaded && areAssetsPreloaded(store)) {\n        store.dispatch(markPreloaded());\n      }\n\n      if (preloaded) translator.postTranslate();\n\n      store.dispatch(incrementTime());\n    },\n  });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/translator.js","import { all, curry, forEach, reduce, map, mapObjIndexed } from 'ramda';\nimport { getImageFromNode, fetchTextureImage } from './asset';\nimport * as THREE from 'three';\n\nlet textures = {};\nfunction checkTextureCache(id, image) {\n  const cachedImage = textures[id] &&  textures[id].image;\n\n  if (cachedImage && cachedImage._v === image._v) {\n    return textures[id].value;\n  }\n}\n\nfunction cacheTexture(id, image, value) {\n  if (textures[id]) {\n    textures[id].value.dispose();\n  }\n  textures[id] = { image, value };\n  return value;\n}\n\nexport function getCubeMapTexture(store, renderer, image, textureCubeOnly) {\n  const { maps, nodeId } = image;\n\n  const texture = checkTextureCache(nodeId, image);\n  if (texture) return texture;\n\n  let images = map(curry(getImageFromNode)(store), maps);\n  if (!all((img) => !!img, images)) {\n    //console.log( \"getCubeMapTexture early exit, as all images are not available.\");\n    return null;\n  }\n\n  let textureCube = new THREE.CubeTexture();\n  textureCube.images = images;\n\n  textureCube.flipY = false;\n  textureCube.needsUpdate = true;\n  if (maps[0].preferHDR) {\n\n    textureCube.encoding = maps[0].hdrEncoding;\n    textureCube.generateMipMaps = false;\n  }\n\n  if (textureCubeOnly) return cacheTexture(nodeId, image, textureCube);\n\n  //console.log( \"Creating PMREMGenerator()\");\n  const pmremGenerator = new THREE.PMREMGenerator(textureCube, renderer.isMobile ? 20 : 64 );\n  pmremGenerator.update(renderer);\n\n  pmremGenerator.cubeLods[0].texture.magFilter = THREE.LinearFilter;\n  pmremGenerator.cubeLods[0].texture.minFilter = THREE.LinearFilter;\n\n  //console.log( \"Creating PMREMCubeUVPacker()\");\n  const pmremCubeUVPacker = new THREE.PMREMCubeUVPacker(pmremGenerator.cubeLods);\n  pmremCubeUVPacker.update(renderer);\n\n  pmremCubeUVPacker.CubeUVRenderTarget.texture.magFilter = THREE.LinearFilter;\n  pmremCubeUVPacker.CubeUVRenderTarget.texture.minFilter = THREE.LinearFilter;\n\n  //console.log( \"PMREM Creation Done.\");\n\n  return cacheTexture(nodeId, image, pmremCubeUVPacker.CubeUVRenderTarget.texture);\n}\n\nexport function getTextureImage(store, image) {\n  if (!image) return null;\n  const nodeId = image.nodeId;\n\n  if (!checkTextureCache(nodeId, image)) {\n    if (image.maps) {\n      map(curry(getImageFromNode)(store), image.maps);\n    } else {\n      fetchTextureImage(store, image);\n    }\n  }\n}\n\n/*\n * Modifies the map being passed in.\n */\nexport function assignTexture(store, renderer, image, optionalThreemap, slot, node) {\n  if (!image) {\n    if (optionalThreemap) optionalThreemap.texture = null;\n    return null;\n  }\n\n  if (image.maps) {\n    return getCubeMapTexture(store, renderer, image, node);\n  }\n\n  const uvOptions = Object.assign({}, image);\n  const nodeId = image.nodeId;\n  let texture = checkTextureCache(nodeId, image);\n\n  if (!texture) {\n    texture = new THREE.Texture();\n    texture.meta = { nodeId: nodeId };\n    if (image.canvasOperations) {\n      texture.meta.source = 'canvas operator';\n      let ops = image.canvasOperations;\n\n      let canvas = document.createElement('canvas');\n      canvas.width = image.width;\n      canvas.height = image.height;\n      let context = canvas.getContext('2d');\n\n      let ok = ops.reduce((ok, op) => {\n        context.save();\n        let ret = ok && op(context, store);\n        context.restore();\n        return ret;\n      }, true);\n\n      if (ok) texture.image = canvas;\n    } else {\n      texture.meta.source = 'image fetch';\n      texture.image = fetchTextureImage(store, image);\n    }\n\n    if (!texture.image) {\n      if (optionalThreemap) optionalThreemap.texture = null;\n      return null;\n    }\n\n    texture.transparent = true;\n\n    const textureWraps = {\n      0: THREE.ClampToEdgeWrapping,\n      1: THREE.RepeatWrapping,\n      2: THREE.MirroredRepeatWrapping,\n    };\n\n    texture.wrapS = textureWraps[uvOptions.wrapU];\n    texture.wrapT = textureWraps[uvOptions.wrapV];\n\n    texture.generateMipMaps = uvOptions.generateMipMaps;\n    texture.anisotropy = texture.generateMipMaps ? 16 : 1;\n    texture.magFilter = uvOptions.magFilter;\n    texture.minFilter = uvOptions.minFilter;\n    texture.encoding = THREE.sRGBEncoding;\n\n    if ((THREE.Math.nearestPowerOfTwo(texture.image.width) !== texture.image.width) ||\n        (THREE.Math.nearestPowerOfTwo(texture.image.height) !== texture.image.height)) {\n      texture.wrapS = THREE.ClampToEdgeWrapping;\n      texture.wrapT = THREE.ClampToEdgeWrapping;\n      texture.generateMipMaps = false;\n      texture.anisotropy = 1;\n      texture.anisotropy = 1;\n      texture.magFilter = THREE.LinearFilter;\n      texture.minFilter = THREE.LinearFilter;\n    }\n\n    texture.needsUpdate = true;\n\n    cacheTexture(nodeId, image, texture);\n  };\n\n  if (!optionalThreemap) {\n    return texture;\n  }\n\n  optionalThreemap.texture = texture;\n\n  optionalThreemap.uvTransform = true;\n  optionalThreemap.uvOffset = new THREE.Vector2(uvOptions.uOffset, uvOptions.vOffset);\n  optionalThreemap.uvRepeat = new THREE.Vector2(uvOptions.uTile, uvOptions.vTile);\n\n  optionalThreemap.texelTransform = true;\n  optionalThreemap.texelInvert = uvOptions.invert;\n  optionalThreemap.texelScale = uvOptions.gain;\n  optionalThreemap.texelOffset = uvOptions.brightness;\n  //texture.gainPivot = uvOptions.gainPivot;\n  //texture.gain = uvOptions.gain;\n  //texture.brightness = uvOptions.brightness;\n\n  //console.log('texture with image', texture);\n  //textures[id] = texture;\n  return optionalThreemap;\n};\n\nconst initialStandardDefaults = {\n  side: 2,\n  emissive: { r: 0, g: 0, b: 0 },\n  ambient: { r: 0, g: 0, b: 0 },\n  vertexColors: 0,\n  opacity: 1,\n  transparent: false,\n  specular: { r: 1, g: 1, b: 1 },\n  normalScale: { x: 1, y: 1 },\n  envMap: null,\n  combine: 0,\n  color: { r: 0.1803921568627451, g: 0.4, b: 0.8274509803921568 },\n  metal: false,\n  gloss: false,\n  reflectivity: 1,\n  refractionRatio: 0.98,\n  shininess: 50,\n};\n\nexport function primitiveToMaterial(store, renderer, data, previousMaterial) {\n\n  let mat = {};\n\n  let material = previousMaterial && previousMaterial instanceof THREE.MeshPhysicalMaterial ?\n    previousMaterial : new THREE.MeshPhysicalMaterial({});\n\n  if (!data) return material;\n\n  if (data.type === \"MultiID\") {\n    let mats = [];\n    for(var i = 0; i < 30; i++) {\n      if(data['material'+i]) {\n        mats.push( primitiveToMaterial(store, renderer, data['material'+ i]) );\n      }\n      else {\n        var defaultColor = {defaultColor: data.defaultColor}\n        mats.push( primitiveToMaterial(store, renderer, defaultColor) );\n      }\n    }\n    material = new THREE.MultiMaterial(mats);\n    return material;\n  }\n  // TODO: vertexColors, blend/combine?\n  // FIXME: envMapScale??\n  if (data.defaultColor) {\n    material.color = data.defaultColor;\n    return material;\n  }\n\n  if (!data.baseColor) {\n    //console.log('Expected physical material, received: ', data.toJS());\n    if (data.diffuseColor) material.color = data.diffuseColor;\n    return material;\n  }\n\n  //side?\n  //\n  //name mapping\n  //three.js: clara.io\n  const propertyMap = {\n    color: 'baseColor',\n    //ambient: 'ambientColor2',\n    bumpScale: 'bumpFactor',\n    emissive: 'emissiveColor',\n    falloff: 'baseFalloff',\n    falloffColor: 'baseFalloffColor',\n    metalness: 'metallic',\n    roughness: 'roughness',\n    clearCoat: 'clearCoat',\n    clearCoatRoughness: 'clearCoatRoughness',\n    opacity: 'opacityFactor', // opacityMap and opacityColor are not supported in Three.js\n    falloffOpacity: 'opacityFalloffFactor',\n    //specular: 'specularColor',\n    //translucency: 'translucencyColor',\n    transparent: 'baseMapTransparent',\n  };\n\n  const keys = [\n    'depthTest', 'depthWrite',//,'roughness',\n  ];\n\n  // 'anisotropyMap','anisotropyRotationMap','--diffuseEnvMap','falloffMap', '+-metallicMap','+-opacityMap','reflectivityMap','specularMap','translucencyMap',\n  // '--ambient','falloff','falloffColor','specular','translucency'\n  //  'anisotropy','anisotropyRotation', 'clearCoat','clearCoatRoughness','+-metallic', 'translucencyNormalAlpha','translucencyNormalPower', 'translucencyViewAlpha','translucencyViewPower'\n\n  //name mapping\n  //three.js: clara.io\n  const imageMaps = {\n    map: 'baseMap',\n    bumpMap: 'bumpMap',\n    emissiveMap: 'emissiveMap',\n    lightMap: 'lightMap',\n    metalnessMap: 'metallicMap',\n    normalMap: 'normalMap',\n    alphaMap: 'opacityMap',\n    roughnessMap: 'roughnessMap',\n    falloffMap: 'baseFalloffMap',\n    falloffAlphaMap: 'opacityFalloffMap',\n  };\n\n  function updateTexture(image, slot) {\n    const map = assignTexture(store, renderer, image, material[slot] || new THREE.MaterialMap());\n    if (map && !material[slot]) material[slot] = map;\n  };\n\n  for (let image of Object.keys(imageMaps)) {\n    updateTexture(data[imageMaps[image]], image + 'Slot');\n  }\n\n  //must be after updateTexture\n  for (let to of Object.keys(propertyMap)) {\n    material[to] = data[propertyMap[to]];\n  }\n\n  for (let key of keys) {\n    material[key] = data[key];\n  }\n\n  if (data.emissiveScale) {\n    material.emissive = material.emissive.clone();\n    material.emissive.multiplyScalar(data.emissiveScale);\n  }\n\n  material.transparent = (material.opacity < 1.0) || !!data.opacityMap || data.baseMapTransparent || (data.opacityFalloffFactor < 1.0) || !!data.opacityFalloffMap;\n\n  const specular = data.specularColor;\n  material.reflectivity = (specular.r + specular.g + specular.b) * 0.33333;\n  material.clearCoat *= 0.25;\n  material.normalScale.x = ( data.normalRedFlip ? -1 : 1 ) * data.normalFactor;\n  material.normalScale.y = ( data.normalGreenFlip ? -1 : 1 ) * data.normalFactor;\n\n  material.blending = THREE.NormalBlending;\n  material.premultipliedAlpha = true;\n  material.side = THREE.DoubleSide;//( material.transparent ) ? THREE.DoubleSide : THREE.FrontSide; //temporary fix for steelcase\n\n  const envMap = data.environment && data.environment.environmentMap;\n  if (envMap) {\n    updateTexture(envMap.specularCubeMap, 'envMap');\n    material.envMapIntensity = ( envMap.intensity !== undefined ) ? envMap.intensity : 1.0;\n  }\n\n  //updateTexture(data.getIn(['envMap', 'specularCubeMap']), 'envMap');\n  material.needsUpdate = true;\n\n  //mat.envMapIntensity = 10;\n  //mat.diffuseEnvMap = getTexture(store,  data.getIn(['envMap', 'irradianceCubeMap']));\n  //console.log( 'mat', mat );\n  //const standardMaterial =  new THREE.MeshStandardMaterial(mat);\n  ////console.log( 'standardMaterial', standardMaterial );\n  //return standardMaterial;\n  return material;\n}\n\n\n//function multiIDMaterial(store, renderer, data, previousMaterial) {\n//  const materials = reduce((list, i) => {\n//    const mat = data.material${i};\n//    if (mat) list.push(primitiveToMaterial(store, renderer, mat));\n//    return list;\n//  }, [], [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]);\n\n//  return new THREE.MultiMaterial(materials);\n//};\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/materials.js","import * as THREE from 'three';\n\nfunction flattenBuffer(klass, elementBuffer, numElementsPerValue, indicesBuffer) {\n  var flattenedBuffer = new klass(indicesBuffer.length * numElementsPerValue);\n\n  var sourceIndex, destIndex;\n  for (var v = 0; v < indicesBuffer.length; v++) {\n    sourceIndex = indicesBuffer[v] * numElementsPerValue;\n    destIndex = v * numElementsPerValue;\n    for (var e = 0; e < numElementsPerValue; e++) {\n      flattenedBuffer[destIndex + e] = elementBuffer[sourceIndex + e];\n    }\n  }\n\n  return new THREE.BufferAttribute(flattenedBuffer, numElementsPerValue);\n}\n\nexport function polyMeshToBufferGeometry({ faces, positions, normalMap, uvs }) {\n  var geom = new THREE.BufferGeometry();\n\n  geom.addAttribute('position', flattenBuffer(Float32Array, positions, 3, faces));\n\n  if (normalMap) {\n    geom.addAttribute('normal', flattenBuffer(Float32Array, normalMap.values, 3, normalMap.faces)); //normalMap.faces.length));\n  }\n\n  if (uvs) {\n    var uvNames = Object.keys(uvs);\n    uvNames.sort();\n\n    // uv\n    if (uvNames.length >= 1) {\n      var uvMap = uvs[uvNames[0]];\n      geom.addAttribute('uv', flattenBuffer(Float32Array, uvMap.values, 2, uvMap.faces)); // uvMap.faces.length));\n    }\n\n    // uv2\n    if (uvNames.length >= 2) {\n      var uvMap = uvs[uvNames[1]];\n      geom.addAttribute('uv2', flattenBuffer(Float32Array, uvMap.values, 2, uvMap.faces)); //uvMap.faces.length));\n    }\n  }\n\n  return geom;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/polyMesh.js","import * as THREE from 'three';\n\nlet initialLightDefaults = {\n  castShadow: true,\n  color: { r: 1, g: 1, b: 1 },\n  intensity: 0.85,\n  lightType: 'DirectionalLight',\n  radius: 0,\n  shadowBias: 0,\n  shadowCameraSize: 1.7321,\n  shadowDarkness: 0.1,\n  shadowFarClip: 40,\n  shadowFrustumColor: { r: 1, g: 1, b: 1 },\n  shadowNearClip: 10,\n  shadowSize: 1024,\n  showShadowCamera: false,\n};\n\nexport function createLight(data, light) {\n  const type = data.lightType;\n  // Skip AreaLight without crashing for now\n  if (type === 'AreaLight') return;\n  if (!THREE[type]) throw new Error('Unknown light type: ' + type);\n  if (type === 'HemisphereLight') {\n    return new THREE[type](data.color.getHex(), data.gndColor.getHex(), data.intensity);\n  }\n\n  return new THREE[type](data.color.getHex(), data.intensity);\n}\n\nexport function updateLight(data, light) {\n  light.intensity = data.intensity;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/light.js","import * as THREE from 'three';\n\nconst rotationFactor = 3.14 / 180;\n\n// Set transalation, rotation, scale on Object3D\nfunction setTRS(object3d, t, r, s) {\n  object3d.position.set(t.x, t.y, t.z);\n  object3d.rotation.set(r.x, r.y, r.z, 'ZYX');\n  object3d.scale.set(s.x, s.y, s.z);\n};\n\nfunction setTRSDegrees(object3d, t, r, s) {\n  object3d.position.set(t.x, t.y, t.z);\n  object3d.rotation.set(r.x * rotationFactor, r.y * rotationFactor, r.z * rotationFactor, 'ZYX');\n  object3d.scale.set(s.x, s.y, s.z);\n};\n\n/* Apply matrix4 to threejs node.\n */\nexport function setMatrixOn(object3d, matrix4) {\n  let translation = new THREE.Vector3();\n  let rotQuat = new THREE.Quaternion();\n  let scale = new THREE.Vector3();\n  matrix4.decompose(translation, rotQuat, scale);\n  let rotation = new THREE.Vector3().copy(new THREE.Euler().setFromQuaternion(rotQuat, 'ZYX'));\n  setTRS(object3d, translation, rotation, scale);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/transform.js","import flyd from '../../vendor/flyd';\nimport { compose, curry, filter, forEach, map } from 'ramda';\n\nfunction mapStream(el, eventName, fn) {\n  let stream = flyd.stream();\n  el.addEventListener(eventName, stream);\n  return fn ? flyd.map(fn, stream) : stream;\n};\n\nfunction transduceStream(el, eventName, fn) {\n  let stream = flyd.stream();\n  el.addEventListener(eventName, stream);\n  return flyd.transduce(fn, stream);\n};\n\nfunction isSingleTouch(e) { return e.touches && e.touches.length === 1; };\n\nfunction isDoubleTouch(e) { return e.touches && e.touches.length === 2; };\n\nfunction addMomentum(toStream, endStream) {\n  let momentumStream = flyd.stream()(0);\n\n  let result = flyd.combine(function (to, momentum) {\n    return to.end() ? momentum() : to();\n  }, [toStream, momentumStream]);\n\n  let decay = 1;\n\n  flyd.on(function () {\n    const timer = every(1000 / 60);\n    const momentumStart = new Date();\n    const momentumDecay = 0.2;\n    if (!toStream()) {\n      return momentumStream.end(true);\n    }\n\n    const { deltaX, deltaY } = toStream();\n\n    flyd.map(function (i) {\n      if (decay <= 0.005) {\n        momentumStream.end(true);\n        timer.end(true);\n      } else {\n        decay = Math.exp(-(1 - momentumDecay) * 10 * (Date.now() - momentumStart) / 1000);\n        //console.log('decay: ', decay, deltaX, deltaY);\n        momentumStream({ deltaX: deltaX * decay, deltaY: deltaY * decay });\n      }\n    }, timer);\n  }, toStream.end);\n\n  return result;\n};\n\nexport function initManipulators(store, translator, el) {\n  let playerEl = el.parentNode.parentNode;\n  let offset = { x: 0, y: 0 };\n  let rect = { width: 0, height: 0 };\n  let commands = [];\n  let hasEvents = {};\n\n  let dragging = false;\n  let lastMousedown = false;\n\n  function resize(newRect) {\n    const playerRect = playerEl.getBoundingClientRect();\n    offset = {\n      x: playerRect.left,\n      y: playerRect.top,\n    };\n    rect = newRect;\n  }\n\n  function touchLastMove(ev) {\n    if (dragging) dragging.lastMove = new Date();\n    return ev;\n  }\n\n  function callTool(which, options={}) {\n    return function (ev) {\n      if (!hasEvents[which]) return;\n\n      var command, tool, result;\n\n      for (var i = commands.length - 1; i >= 0; i--) {\n        command = commands[i];\n        tool = command.tool;\n        if (!command.enabled || !tool[which]) continue;\n\n        result = tool[which].call(command, ev);\n\n        if (options.findFirst) {\n          if (result !== false) break;\n        } else if (!options.doAll) {\n          if (result === false) break;\n        }\n      }\n\n      return result;\n    };\n  };\n\n  function toCoords(ev) {\n    // Calling preventDefault on 'mousedown' prevents the 'mouseup' event from firing when inside\n    // an iframe. No reason to call preventDefault on these events, so don't.\n\n    return {\n      rect,\n      clientX: ev.clientX - offset.x,\n      clientY: ev.clientY - offset.y,\n      deltaX: ev.movementX,\n      deltaY: ev.movementY,\n      originalEvent: ev,\n      which: ev.which,\n      altKey: ev.altKey,\n      ctrlKey: ev.ctrlKey,\n      metaKey: ev.metaKey,\n      shiftKey: ev.shiftKey,\n    };\n  };\n\n  function toMouseEvent(e) {\n    if (!e.touches || !e.touches.length) return e;\n    e.preventDefault();\n    const elRect = e.srcElement.getBoundingClientRect();\n    return {\n      which: 1,\n      rect: rect,\n      clientX: e.touches[0].clientX - elRect.left,\n      clientY: e.touches[0].clientY - elRect.top,\n      originalEvent: e,\n    };\n  };\n\n  flyd.on(callTool('dragenter'), mapStream(el, 'dragenter'));\n  flyd.on(callTool('dragover'), mapStream(el, 'dragover'));\n  flyd.on(callTool('dragleave'), mapStream(el, 'dragleave'));\n  flyd.on(callTool('dblclick'), mapStream(el, 'dblclick'));\n\n  const keysdown = {};\n  flyd.on((kd) => {\n    if (!keysdown[kd.key]) {\n      callTool('keydown')(kd);\n      keysdown[kd.key] = setInterval(() => callTool('keyheld')(kd), 17);\n    }\n  }, mapStream(el, 'keydown'));\n\n  flyd.on((ku) => {\n    if (keysdown[ku.key]) {\n      clearInterval(keysdown[ku.key]);\n      delete keysdown[ku.key];\n    }\n\n    callTool('keyup')(ku);\n  }, mapStream(el, 'keyup'));\n\n  let clickStream = mapStream(el, 'click', toCoords);\n  let mousedownStream = mapStream(el, 'mousedown', toCoords);\n  let mousemoveStream = mapStream(el, 'mousemove', toCoords);\n  let mouseupStream = mapStream(window, 'mouseup', toCoords);\n  let moveStream = flyd.stream();\n  let dragStream = flyd.stream();\n\n  let touchstartStream = transduceStream(el, 'touchstart', compose(filter(isSingleTouch), map(toMouseEvent)));\n  let touchendStream = mapStream(el, 'touchend', toMouseEvent);\n\n  flyd.on((md) => {\n    md.originalEvent.target.focus();\n    callTool('mousedown')(md);\n    lastMousedown = { start: new Date(), event: md };\n\n    let tool = callTool('drag', { findFirst: true })(md);\n    if (!tool) return;\n\n    dragging = { lastMove: new Date() };\n\n    let clientX = null;\n    let clientY = null;\n\n    function toDeltaCoords(ev) {\n      ev.preventDefault();\n      let newEv = {\n        rect,\n        clientX: ev.clientX - offset.x,\n        clientY: ev.clientY - offset.y,\n        originalEvent: ev,\n        which: ev.which,\n        altKey: ev.altKey,\n        ctrlKey: ev.ctrlKey,\n        metaKey: ev.metaKey,\n        shiftKey: ev.shiftKey,\n      };\n      if (ev.movementX === undefined) {\n        newEv.deltaX = clientX === null ? 0 : ev.clientX - clientX;\n        newEv.deltaY = clientX === null ? 0 : ev.clientY - clientY;\n      } else {\n        newEv.deltaX = ev.movementX;\n        newEv.deltaY = ev.movementY;\n      }\n      clientX = ev.clientX;\n      clientY = ev.clientY;\n      return newEv;\n    }\n\n    moveStream = transduceStream(window, 'mousemove', compose(\n      map(touchLastMove), map(toDeltaCoords)\n    ));\n\n    dragStream.end(true);\n    dragStream = tool.momentum ? addMomentum(moveStream, mouseupStream) : moveStream;\n    dragStream.map(tool.handle);\n  }, mousedownStream);\n\n  flyd.on((ts) => {\n    callTool('mousedown')(ts);\n    lastMousedown = { start: new Date(), event: ts };\n\n    let tool = callTool('drag', { findFirst: true })(ts);\n    if (!tool) return;\n\n    dragging = { lastMove: new Date() };\n\n    let { clientX, clientY } = ts;\n\n    function toDelta(e) {\n      const newE = Object.assign(e, {\n        deltaX: e.clientX - clientX,\n        deltaY: e.clientY - clientY,\n      });\n      clientX = e.clientX;\n      clientY = e.clientY;\n      return newE;\n    };\n\n    moveStream = transduceStream(el, 'touchmove', compose(\n      filter(isSingleTouch), map(touchLastMove), map(toMouseEvent), map(toDelta)\n    ));\n\n    dragStream.end(true);\n    dragStream = tool.momentum ? addMomentum(moveStream, touchendStream) : moveStream;\n    dragStream.map(tool.handle);\n  }, touchstartStream);\n\n  let endingStream = flyd.merge(touchendStream, mouseupStream);\n\n  flyd.on((mu) => {\n    if (dragging) {\n      moveStream.end(true);\n      // End momentum if last mousemove event is gt 200ms from mouseup.\n      if (new Date() - dragging.lastMove > 200) {\n        dragStream.end(true);\n      }\n    }\n\n    //console.log('mu', new Date() - lastMousedown.start, lastMousedown.event, mu, muX, muY);\n\n    callTool('mouseup')(mu);\n\n    if (lastMousedown && new Date() - lastMousedown.start < 300) {\n      const muX = Math.abs(mu.clientX - lastMousedown.event.clientX);\n      const muY = Math.abs(mu.clientY - lastMousedown.event.clientY);\n\n      if (isNaN(muX)) {\n        callTool('click')(lastMousedown.event);\n      } else if (muX <= 5 && muY <= 5) {\n        callTool('click')(mu);\n      }\n    }\n\n    dragging = false;\n    lastMousedown = false;\n  }, endingStream);\n\n  flyd.on(callTool('hover'), flyd.transduce(filter(() => !dragging && hasEvents['hover']), mousemoveStream));\n\n  //flyd.map((scroll) => {\n  //  console.log('scroll?', scroll);\n  const scrollHandler = callTool('scroll');\n  mapStream(el, 'wheel', (ev) => {\n    if (hasEvents['scroll']) {\n      ev.preventDefault();\n      scrollHandler({\n        delta: -ev.deltaY / (ev.wheelDelta ? 200 : 10),\n        originalEvent: ev,\n      });\n    }\n  });\n\n  function extractTouches(e) {\n    e.preventDefault();\n    return {\n      a: { x: e.touches[0].clientX, y: e.touches[0].clientY },\n      b: { x: e.touches[1].clientX, y: e.touches[1].clientY },\n    };\n  };\n\n  let zoom = flatMap((ts) => {\n    let f = ts;\n    let moveStream = transduceStream(el, 'touchmove', compose(\n      filter(isDoubleTouch), map(extractTouches), map(function (g) {\n        var result = {\n          pinchX: (g.b.x - f.b.x) - (g.a.x - f.a.x),\n          pinchY: (f.a.y - g.a.y) - (f.b.y - g.b.y),\n          dragX: ((g.a.x - f.a.x) + (g.b.x - f.b.x)) / 2,\n          dragY: ((g.a.y - f.a.y) + (g.b.y - f.b.y)) / 2,\n          a: g.a, b: g.b,\n        };\n        f = g;\n        return result;\n      })\n    ));\n    flyd.endsOn(touchendStream, moveStream);\n    return moveStream;\n  }, transduceStream(el, 'touchstart', compose(\n\n    filter(isDoubleTouch), map(extractTouches)\n  )));\n\n  flyd.on((z) => {\n    const { pinchX, pinchY, dragX, dragY, a, b } = z;\n    if ((Math.abs(pinchX) + Math.abs(pinchY)) > (Math.abs(dragX) + Math.abs(dragY))) {\n      // pinch\n      callTool('pinch')({\n        deltaX: (a.x > b.x ? -pinchX : pinchX),\n        deltaY: (a.y > b.y ? pinchY : -pinchY),\n      });\n    } else {\n      // swipe\n      callTool('swipe')({ deltaX: dragX, deltaY: dragY });\n    }\n  }, zoom);\n\n  return {\n    resize,\n\n    updateTools: (newCommands) => {\n      commands = newCommands;\n      hasEvents = {};\n\n      forEach(function (command) {\n        Object.keys(command.tool).forEach((k) => hasEvents[k] = true);\n      }, commands);\n    },\n  };\n}\n\nfunction every(dur) {\n  var s = flyd.stream();\n  var target = Date.now();\n  function timer() {\n    if (s.end()) return;\n    var now = Date.now();\n    target += dur;\n    s(now);\n    setTimeout(timer, target - now);\n  }\n\n  timer();\n  return s;\n};\n\nfunction flatMap(f, s) {\n  return flyd.combine(function (s, own) {\n    flyd.map(own, f(s()));\n  }, [s]);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/manipulators.js","var curryN = require('ramda').curryN;\n\n'use strict';\n\nfunction isFunction(obj) {\n  return !!(obj && obj.constructor && obj.call && obj.apply);\n}\n\n// Globals\nvar toUpdate = [];\nvar inStream;\n\n// Library functions use self callback to accept (null, undefined) update triggers.\nfunction map(f, s) {\n  return combine(function(s, self) { self(f(s.val)); }, [s]);\n}\n\nfunction on(f, s) {\n  return combine(function(s) { f(s.val); }, [s]);\n}\n\nfunction boundMap(f) { return map(f, this); }\n\nvar scan = curryN(3, function(f, acc, s) {\n  var ns = combine(function(s, self) {\n    self(acc = f(acc, s.val));\n  }, [s]);\n  if (!ns.hasVal) ns(acc);\n  return ns;\n});\n\nvar merge = curryN(2, function(s1, s2) {\n  var s = immediate(combine(function(s1, s2, self, changed) {\n    if (changed[0]) {\n      self(changed[0]());\n    } else if (s1.hasVal) {\n      self(s1.val);\n    } else if (s2.hasVal) {\n      self(s2.val);\n    }\n  }, [s1, s2]));\n  endsOn(combine(function() {\n    return true;\n  }, [s1.end, s2.end]), s);\n  return s;\n});\n\nfunction ap(s2) {\n  var s1 = this;\n  return combine(function(s1, s2, self) { self(s1.val(s2.val)); }, [s1, s2]);\n}\n\nfunction initialDepsNotMet(stream) {\n  stream.depsMet = stream.deps.every(function(s) {\n    return s.hasVal;\n  });\n  return !stream.depsMet;\n}\n\nfunction updateStream(s) {\n  if ((s.depsMet !== true && initialDepsNotMet(s)) ||\n      (s.end !== undefined && s.end.val === true)) return;\n  if (inStream !== undefined) {\n    toUpdate.push(s);\n    return;\n  }\n  inStream = s;\n  if (s.depsChanged) s.fnArgs[s.fnArgs.length - 1] = s.depsChanged;\n  var returnVal = s.fn.apply(s.fn, s.fnArgs);\n  if (returnVal !== undefined) {\n    s(returnVal);\n  }\n  inStream = undefined;\n  if (s.depsChanged !== undefined) s.depsChanged = [];\n  s.shouldUpdate = false;\n  if (flushing === false) flushUpdate();\n}\n\nvar order = [];\nvar orderNextIdx = -1;\n\nfunction findDeps(s) {\n  var i, listeners = s.listeners;\n  if (s.queued === false) {\n    s.queued = true;\n    for (i = 0; i < listeners.length; ++i) {\n      findDeps(listeners[i]);\n    }\n    order[++orderNextIdx] = s;\n  }\n}\n\nfunction updateDeps(s) {\n  var i, o, list, listeners = s.listeners;\n  for (i = 0; i < listeners.length; ++i) {\n    list = listeners[i];\n    if (list.end === s) {\n      endStream(list);\n    } else {\n      if (list.depsChanged !== undefined) list.depsChanged.push(s);\n      list.shouldUpdate = true;\n      findDeps(list);\n    }\n  }\n  for (; orderNextIdx >= 0; --orderNextIdx) {\n    o = order[orderNextIdx];\n    if (o.shouldUpdate === true) updateStream(o);\n    o.queued = false;\n  }\n}\n\nvar flushing = false;\n\nfunction flushUpdate() {\n  flushing = true;\n  while (toUpdate.length > 0) {\n    var s = toUpdate.shift();\n    if (s.vals.length > 0) s.val = s.vals.shift();\n    updateDeps(s);\n  }\n  flushing = false;\n}\n\nfunction isStream(stream) {\n  return isFunction(stream) && 'hasVal' in stream;\n}\n\nfunction streamToString() {\n  return 'stream(' + this.val + ')';\n}\n\nfunction updateStreamValue(s, n) {\n  if (n !== undefined && n !== null && isFunction(n.then)) {\n    n.then(s);\n    return;\n  }\n  s.val = n;\n  s.hasVal = true;\n  if (inStream === undefined) {\n    flushing = true;\n    updateDeps(s);\n    if (toUpdate.length > 0) flushUpdate(); else flushing = false;\n  } else if (inStream === s) {\n    markListeners(s, s.listeners);\n  } else {\n    s.vals.push(n);\n    toUpdate.push(s);\n  }\n}\n\nfunction markListeners(s, lists) {\n  var i, list;\n  for (i = 0; i < lists.length; ++i) {\n    list = lists[i];\n    if (list.end !== s) {\n      if (list.depsChanged !== undefined) {\n        list.depsChanged.push(s);\n      }\n      list.shouldUpdate = true;\n    } else {\n      endStream(list);\n    }\n  }\n}\n\nfunction createStream() {\n  function s(n) {\n    return arguments.length > 0 ? (updateStreamValue(s, n), s)\n                                : s.val;\n  }\n  s.hasVal = false;\n  s.val = undefined;\n  s.vals = [];\n  s.listeners = [];\n  s.queued = false;\n  s.end = undefined;\n\n  s.map = boundMap;\n  s.ap = ap;\n  s.of = stream;\n  s.toString = streamToString;\n\n  return s;\n}\n\nfunction addListeners(deps, s) {\n  for (var i = 0; i < deps.length; ++i) {\n    deps[i].listeners.push(s);\n  }\n}\n\nfunction createDependentStream(deps, fn) {\n  var s = createStream();\n  s.fn = fn;\n  s.deps = deps;\n  s.depsMet = false;\n  s.depsChanged = deps.length > 0 ? [] : undefined;\n  s.shouldUpdate = false;\n  addListeners(deps, s);\n  return s;\n}\n\nfunction immediate(s) {\n  if (s.depsMet === false) {\n    s.depsMet = true;\n    updateStream(s);\n  }\n  return s;\n}\n\nfunction removeListener(s, listeners) {\n  var idx = listeners.indexOf(s);\n  listeners[idx] = listeners[listeners.length - 1];\n  listeners.length--;\n}\n\nfunction detachDeps(s) {\n  for (var i = 0; i < s.deps.length; ++i) {\n    removeListener(s, s.deps[i].listeners);\n  }\n  s.deps.length = 0;\n}\n\nfunction endStream(s) {\n  if (s.deps !== undefined) detachDeps(s);\n  if (s.end !== undefined) detachDeps(s.end);\n}\n\nfunction endsOn(endS, s) {\n  detachDeps(s.end);\n  endS.listeners.push(s.end);\n  s.end.deps.push(endS);\n  return s;\n}\n\nfunction trueFn() { return true; }\n\nfunction stream(initialValue) {\n  var endStream = createDependentStream([], trueFn);\n  var s = createStream();\n  s.end = endStream;\n  s.fnArgs = [];\n  endStream.listeners.push(s);\n  if (arguments.length > 0) s(initialValue);\n  return s;\n}\n\nfunction combine(fn, streams) {\n  var i, s, deps, depEndStreams;\n  var endStream = createDependentStream([], trueFn);\n  deps = []; depEndStreams = [];\n  for (i = 0; i < streams.length; ++i) {\n    if (streams[i] !== undefined) {\n      deps.push(streams[i]);\n      if (streams[i].end !== undefined) depEndStreams.push(streams[i].end);\n    }\n  }\n  s = createDependentStream(deps, fn);\n  s.depsChanged = [];\n  s.fnArgs = s.deps.concat([s, s.depsChanged]);\n  s.end = endStream;\n  endStream.listeners.push(s);\n  addListeners(depEndStreams, endStream);\n  endStream.deps = depEndStreams;\n  updateStream(s);\n  return s;\n}\n\nvar transduce = curryN(2, function(xform, source) {\n  xform = xform(new StreamTransformer());\n  return combine(function(source, self) {\n    var res = xform['@@transducer/step'](undefined, source.val);\n    if (res && res['@@transducer/reduced'] === true) {\n      self.end(true);\n      return res['@@transducer/value'];\n    } else {\n      return res;\n    }\n  }, [source]);\n});\n\nfunction StreamTransformer() { }\nStreamTransformer.prototype['@@transducer/init'] = function() { };\nStreamTransformer.prototype['@@transducer/result'] = function() { };\nStreamTransformer.prototype['@@transducer/step'] = function(s, v) { return v; };\n\nmodule.exports = {\n  stream: stream,\n  combine: curryN(2, combine),\n  isStream: isStream,\n  transduce: transduce,\n  merge: merge,\n  scan: scan,\n  endsOn: endsOn,\n  map: curryN(2, map),\n  on: curryN(2, on),\n  curryN: curryN,\n  immediate: immediate,\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./vendor/flyd.js\n// module id = 381\n// module chunks = 0 1 2","import * as THREE from 'three';\nimport { getWorldTransform, get } from '../modules/scene';\nimport { getCamera } from '../modules/player';\nimport getProjectionMatrix from './utils/getProjectionMatrix';\n\nfunction getScreenPositionNormal(nodeWorldMatrix, cameraWorldMatrix,\n    cameraProjection, localDirection) {\n\n  const cameraInverseWorldMatrix = new THREE.Matrix4().getInverse(cameraWorldMatrix);\n\n  const combinedCameraSpaceMatrix = new THREE.Matrix4().multiply(cameraInverseWorldMatrix).multiply(nodeWorldMatrix);\n  const combinedProjectionMatrix = new THREE.Matrix4().multiply(cameraProjection).multiply(cameraInverseWorldMatrix).multiply(nodeWorldMatrix);\n\n  const nodeLocalPosition = new THREE.Vector3(0, 0, 0);\n  const nodeLocalDirectionOffset = localDirection;\n\n  const nodeCameraPosition = nodeLocalPosition.clone()\n      .applyMatrix4(combinedCameraSpaceMatrix);\n  const nodeCameraDirectionOffset = nodeLocalDirectionOffset.clone()\n      .applyMatrix4(combinedCameraSpaceMatrix);\n\n  const nodeCameraNormal = new THREE.Vector3()\n      .subVectors(nodeCameraDirectionOffset, nodeCameraPosition).normalize();\n\n  const nodeScreenPosition = nodeLocalPosition.clone()\n      .applyMatrix4(combinedProjectionMatrix);\n  nodeScreenPosition.addScalar(1.0).multiplyScalar(0.5);\n\n  return {\n    position: nodeScreenPosition,\n    normal: nodeCameraNormal,\n  };\n}\n\nexport function getScreenPositionNormalAlpha(id, calcDirection, directionAxis, directionTarget) {\n  return (store) => {\n    const nodeWorldTransform = getWorldTransform(store, id);\n    const cameraId = getCamera(store);\n    const cameraPlug = get(store, { id: cameraId, evalPlug: 'Camera' });\n\n    const cameraWorldTransform = getWorldTransform(store, cameraId);\n    if (!cameraWorldTransform) return {};\n\n    const cameraProjection = getProjectionMatrix(cameraPlug);\n    const positionNormal = getScreenPositionNormal(nodeWorldTransform,\n        cameraWorldTransform, cameraProjection, getDirection(store, id, calcDirection, directionAxis, directionTarget));\n\n    const annotation = get(store, { id, evalPlug: 'Annotation' });\n\n    let alpha = 1.0;\n\n    // mis-spelled visibility property.\n    if (annotation.limitVisilibility) {\n      const visibilityAngle = Math.min(annotation.visibilityAngle * 0.5, 180);\n      const cameraWorldDirection = new THREE.Vector3(0, 0, -1);\n      const dotResult = cameraWorldDirection.dot(positionNormal.normal);\n    \n      const theta = THREE.Math.radToDeg(\n        Math.acos(cameraWorldDirection.dot(positionNormal.normal))\n      );\n \n      if (theta > visibilityAngle) {\n        alpha = 0.0;\n      } else if (theta > visibilityAngle * 0.75) {\n        alpha = (visibilityAngle - theta) / (visibilityAngle * 0.25); \n      }\n    }\n\n    return Object.assign({ alpha }, positionNormal);\n  };\n}\n\nfunction getDirection(store, id, calcDirection, directionAxis, directionTarget) {\n  var direction = null;\n  if( calcDirection ) {\n    let targetPosition = new THREE.Vector3(0, 0, 0);\n    if (directionTarget) {\n      targetPosition = new THREE.Vector3().setFromMatrixPosition(getWorldTransform(store, directionTarget));\n    }\n    const currentTransform = getWorldTransform(store, id);\n    const currentPosition = new THREE.Vector3().setFromMatrixPosition(currentTransform);\n    direction = targetPosition.clone().sub(currentPosition).normalize();\n    const inverseWorldMatrix = new THREE.Matrix4();\n    inverseWorldMatrix.getInverse(currentTransform);\n    direction.applyMatrix4(inverseWorldMatrix).normalize();\n  }\n  else {\n    direction = new THREE.Vector3();\n    direction[ directionAxis ] = -1;\n  }\n\n  return direction;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/annotation.js","import * as THREE from 'three';\n/**\n * @author spidersharma / http://eduperiment.com/\n */\n\nexport default function OutlinePass( resolution, scene, camera, selectedObjects ) {\n\n\tthis.renderScene = scene;\n\tthis.renderCamera = camera;\n\tthis.selectedObjects = selectedObjects !== undefined ? selectedObjects : [];\n\tthis.visibleEdgeColor = new THREE.Color(1, 1, 1);\n\tthis.hiddenEdgeColor = new THREE.Color(0.1, 0.04, 0.02);\n\tthis.edgeGlow = 0.0;\n\tthis.usePatternTexture = false;\n\tthis.edgeThickness = 1.0;\n\tthis.edgeStrength = 3.0;\n\tthis.downSampleRatio = 2;\n\tthis.pulsePeriod = 0;\n\n\tthis.BlurDirectionX = new THREE.Vector2( 1.0, 0.0 );\n\tthis.BlurDirectionY = new THREE.Vector2( 0.0, 1.0 );\n\n\tTHREE.Pass.call( this );\n\n\tthis.resolution = ( resolution !== undefined ) ? new THREE.Vector2(resolution.x, resolution.y) : new THREE.Vector2(256, 256);\n\n\tvar pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat };\n\n\tvar resx = Math.round(this.resolution.x/this.downSampleRatio);\n\tvar resy = Math.round(this.resolution.y/this.downSampleRatio);\n\n\tthis.maskBufferMaterial = new THREE.MeshBasicMaterial({color:0xffffff});\n\tthis.maskBufferMaterial.side = THREE.DoubleSide;\n\tthis.renderTargetMaskBuffer = new THREE.WebGLRenderTarget( this.resolution.x, this.resolution.y, pars );\n\tthis.renderTargetMaskBuffer.texture.generateMipmaps = false;\n\n\tthis.depthMaterial = new THREE.MeshDepthMaterial();\n\tthis.depthMaterial.side = THREE.DoubleSide;\n\tthis.depthMaterial.depthPacking = THREE.RGBADepthPacking;\n\tthis.depthMaterial.blending = THREE.NoBlending;\n\n\tthis.prepareMaskMaterial = this.getPrepareMaskMaterial();\n\tthis.prepareMaskMaterial.side = THREE.DoubleSide;\n\n\tthis.renderTargetDepthBuffer = new THREE.WebGLRenderTarget( this.resolution.x, this.resolution.y, pars );\n\tthis.renderTargetDepthBuffer.texture.generateMipmaps = false;\n\n\tthis.renderTargetMaskDownSampleBuffer = new THREE.WebGLRenderTarget( resx, resy, pars );\n\tthis.renderTargetMaskDownSampleBuffer.texture.generateMipmaps = false;\n\n\tthis.renderTargetBlurBuffer1 = new THREE.WebGLRenderTarget( resx, resy, pars );\n\tthis.renderTargetBlurBuffer1.texture.generateMipmaps = false;\n\tthis.renderTargetBlurBuffer2 = new THREE.WebGLRenderTarget( Math.round(resx/2), Math.round(resy/2), pars );\n\tthis.renderTargetBlurBuffer2.texture.generateMipmaps = false;\n\n\tthis.edgeDetectionMaterial = this.getEdgeDetectionMaterial();\n\tthis.renderTargetEdgeBuffer1 = new THREE.WebGLRenderTarget( resx, resy, pars );\n\tthis.renderTargetEdgeBuffer1.texture.generateMipmaps = false;\n\tthis.renderTargetEdgeBuffer2 = new THREE.WebGLRenderTarget( Math.round(resx/2), Math.round(resy/2), pars );\n\tthis.renderTargetEdgeBuffer2.texture.generateMipmaps = false;\n\n\tvar MAX_EDGE_THICKNESS = 4;\n\tvar MAX_EDGE_GLOW = 4;\n\n\tthis.separableBlurMaterial1 = this.getSeperableBlurMaterial(MAX_EDGE_THICKNESS);\n\tthis.separableBlurMaterial1.uniforms[ \"texSize\" ].value = new THREE.Vector2(resx, resy);\n\tthis.separableBlurMaterial1.uniforms[ \"kernelRadius\" ].value = 1;\n\tthis.separableBlurMaterial2 = this.getSeperableBlurMaterial(MAX_EDGE_GLOW);\n\tthis.separableBlurMaterial2.uniforms[ \"texSize\" ].value = new THREE.Vector2(Math.round(resx/2), Math.round(resy/2));\n\tthis.separableBlurMaterial2.uniforms[ \"kernelRadius\" ].value = MAX_EDGE_GLOW;\n\n\t// Overlay material\n\tthis.overlayMaterial = this.getOverlayMaterial();\n\n\t// copy material\n\tif ( THREE.CopyShader === undefined )\n\t\tconsole.error( \"THREE.OutlinePass relies on THREE.CopyShader\" );\n\n\tvar copyShader = THREE.CopyShader;\n\n\tthis.copyUniforms = THREE.UniformsUtils.clone( copyShader.uniforms );\n\tthis.copyUniforms[ \"opacity\" ].value = 1.0;\n\n\tthis.materialCopy = new THREE.ShaderMaterial( {\n\t\tuniforms: this.copyUniforms,\n\t\tvertexShader: copyShader.vertexShader,\n\t\tfragmentShader: copyShader.fragmentShader,\n\t\tblending: THREE.NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true\n\t} );\n\n\tthis.enabled = true;\n\tthis.needsSwap = false;\n\n\tthis.oldClearColor = new THREE.Color();\n\tthis.oldClearAlpha = 1;\n\n\tthis.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tthis.scene  = new THREE.Scene();\n\n\tthis.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );\n\tthis.scene.add( this.quad );\n\n\tthis.tempPulseColor1 = new THREE.Color();\n\tthis.tempPulseColor2 = new THREE.Color();\n\tthis.textureMatrix = new THREE.Matrix4();\n};\n\nOutlinePass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {\n\n\tconstructor: OutlinePass,\n\n\tdispose: function() {\n\t\tthis.renderTargetMaskBuffer.dispose();\n\t\tthis.renderTargetDepthBuffer.dispose();\n\t\tthis.renderTargetMaskDownSampleBuffer.dispose();\n\t\tthis.renderTargetBlurBuffer1.dispose();\n\t\tthis.renderTargetBlurBuffer2.dispose();\n\t\tthis.renderTargetEdgeBuffer1.dispose();\n\t\tthis.renderTargetEdgeBuffer2.dispose();\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tthis.renderTargetMaskBuffer.setSize(width, height );\n\n\t\tvar resx = Math.round(width/this.downSampleRatio);\n\t\tvar resy = Math.round(height/this.downSampleRatio);\n\t\tthis.renderTargetMaskDownSampleBuffer.setSize(resx, resy );\n\t\tthis.renderTargetBlurBuffer1.setSize(resx, resy );\n\t\tthis.renderTargetEdgeBuffer1.setSize(resx, resy );\n\t\tthis.separableBlurMaterial1.uniforms[ \"texSize\" ].value = new THREE.Vector2(resx, resy);\n\n\t  resx = Math.round(resx/2);\n\t  resy = Math.round(resy/2);\n\n\t\tthis.renderTargetBlurBuffer2.setSize(resx, resy );\n\t\tthis.renderTargetEdgeBuffer2.setSize(resx, resy );\n\n\t\tthis.separableBlurMaterial2.uniforms[ \"texSize\" ].value = new THREE.Vector2(resx, resy);\n\t},\n\n\tchangeVisibilityOfSelectedObjects: function( bVisible ) {\n\n\t\tvar gatherSelectedMeshesCallBack = function( object ) {\n\n\t\t\tif( object instanceof THREE.Mesh ) {\n\t\t\t\tvar visibility = object.visible;\n\t\t\t\tif( !bVisible || object.bVisible )\n\t\t\t\t\tobject.visible = bVisible;\n\t\t\t\tobject.bVisible = visibility;\n\t\t\t}\n\t\t}\n\n\t\tfor( var i=0; i<this.selectedObjects.length; i++ ) {\n\n\t\t\tvar selectedObject = this.selectedObjects[i];\n\n\t\t\tselectedObject.traverse( gatherSelectedMeshesCallBack );\n\t\t}\n\t},\n\n\tchangeVisibilityOfNonSelectedObjects: function( bVisible ) {\n\n\t\tvar selectedMeshes = [];\n\n\t\tvar gatherSelectedMeshesCallBack = function( object ) {\n\n\t\t\tif( object instanceof THREE.Mesh ) {\n\n\t\t\t\tselectedMeshes.push(object);\n\n\t\t\t}\n\t\t}\n\n\t\tfor( var i=0; i<this.selectedObjects.length; i++ ) {\n\n\t\t\tvar selectedObject = this.selectedObjects[i];\n\n\t\t\tselectedObject.traverse( gatherSelectedMeshesCallBack );\n\t\t}\n\n\t\tvar VisibilityChangeCallBack = function( object ) {\n\n\t\t\tif( object instanceof THREE.Mesh ) {\n\n\t\t\t\tvar bFound = false;\n\n\t\t\t\tfor( var i=0; i<selectedMeshes.length; i++ ) {\n\n\t\t\t\t\tvar selectedObjectId = selectedMeshes[i].id;\n\n\t\t\t\t\tif(selectedObjectId === object.id) {\n\t\t\t\t\t\tbFound = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tif(!bFound) {\n\t\t\t\t\tvar visibility = object.visible;\n\t\t\t\t\tif( !bVisible || object.bVisible )\n\t\t\t\t\t\tobject.visible = bVisible;\n\t\t\t\t\tobject.bVisible = visibility;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.renderScene.traverse( VisibilityChangeCallBack );\n\t},\n\n\tupdateTextureMatrix: function() {\n\n\t\tthis.textureMatrix.set( 0.5, 0.0, 0.0, 0.5,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t0.0, 0.0, 0.0, 1.0 );\n\t\tthis.textureMatrix.multiply( this.renderCamera.projectionMatrix );\n\t\tthis.textureMatrix.multiply( this.renderCamera.matrixWorldInverse );\n\n\t},\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {\n\n\t\tif(this.selectedObjects.length === 0 )\n\t\t\treturn;\n\n\t\tthis.oldClearColor.copy( renderer.getClearColor() );\n\t\tthis.oldClearAlpha = renderer.getClearAlpha();\n\t\tvar oldAutoClear = renderer.autoClear;\n\n\t\trenderer.autoClear = false;\n\n\t\tif ( maskActive ) renderer.context.disable( renderer.context.STENCIL_TEST );\n\n\t\trenderer.setClearColor( 0xffffff, 1 );\n\n\t\t// Make selected objects invisible\n\t\tthis.changeVisibilityOfSelectedObjects(false);\n\n\t\t// 1. Draw Non Selected objects in the depth buffer\n\t\tthis.renderScene.overrideMaterial = this.depthMaterial;\n\t\trenderer.render( this.renderScene, this.renderCamera, this.renderTargetDepthBuffer, true );\n\n\t\t// Make selected objects visible\n\t\tthis.changeVisibilityOfSelectedObjects(true);\n\n\t\t// Update Texture Matrix for Depth compare\n\t\tthis.updateTextureMatrix();\n\n\t\t// Make non selected objects invisible, and draw only the selected objects, by comparing the depth buffer of non selected objects\n\t\tthis.changeVisibilityOfNonSelectedObjects(false);\n\t\tthis.renderScene.overrideMaterial = this.prepareMaskMaterial;\n\t\tthis.prepareMaskMaterial.uniforms[ \"cameraNearFar\" ].value = new THREE.Vector2(this.renderCamera.near, this.renderCamera.far);\n\t\tthis.prepareMaskMaterial.uniforms[ \"depthTexture\" ].value = this.renderTargetDepthBuffer.texture;\n\t\tthis.prepareMaskMaterial.uniforms[ \"textureMatrix\" ].value = this.textureMatrix;\n\t\trenderer.render( this.renderScene, this.renderCamera, this.renderTargetMaskBuffer, true );\n\t\tthis.renderScene.overrideMaterial = null;\n\t\tthis.changeVisibilityOfNonSelectedObjects(true);\n\n\t\t// 2. Downsample to Half resolution\n\t\tthis.quad.material = this.materialCopy;\n\t\tthis.copyUniforms[ \"tDiffuse\" ].value = this.renderTargetMaskBuffer.texture;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetMaskDownSampleBuffer, true );\n\n\t\tthis.tempPulseColor1.copy( this.visibleEdgeColor );\n\t\tthis.tempPulseColor2.copy( this.hiddenEdgeColor );\n\t\tif( this.pulsePeriod > 0 ) {\n\t\t\tvar scalar = ( 1 + 0.25 ) / 2 + Math.cos( performance.now() * 0.01/ this.pulsePeriod ) * ( 1.0 - 0.25 )/2\n\t\t\tthis.tempPulseColor1.multiplyScalar( scalar );\n\t\t\tthis.tempPulseColor2.multiplyScalar( scalar );\n\t\t}\n\n\t\t// 3. Apply Edge Detection Pass\n\t\tthis.quad.material = this.edgeDetectionMaterial;\n\t\tthis.edgeDetectionMaterial.uniforms[ \"maskTexture\" ].value = this.renderTargetMaskDownSampleBuffer.texture;\n\t\tthis.edgeDetectionMaterial.uniforms[ \"texSize\" ].value = new THREE.Vector2(this.renderTargetMaskDownSampleBuffer.width, this.renderTargetMaskDownSampleBuffer.height);\n\t\tthis.edgeDetectionMaterial.uniforms[ \"visibleEdgeColor\" ].value = this.tempPulseColor1;\n\t\tthis.edgeDetectionMaterial.uniforms[ \"hiddenEdgeColor\" ].value = this.tempPulseColor2;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetEdgeBuffer1, true );\n\n\t\t// 4. Apply Blur on Half res\n\t\tthis.quad.material = this.separableBlurMaterial1;\n\t\tthis.separableBlurMaterial1.uniforms[ \"colorTexture\" ].value = this.renderTargetEdgeBuffer1.texture;\n\t\tthis.separableBlurMaterial1.uniforms[ \"direction\" ].value = this.BlurDirectionX;\n\t\tthis.separableBlurMaterial1.uniforms[ \"kernelRadius\" ].value = this.edgeThickness;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetBlurBuffer1, true );\n\t\tthis.separableBlurMaterial1.uniforms[ \"colorTexture\" ].value = this.renderTargetBlurBuffer1.texture;\n\t\tthis.separableBlurMaterial1.uniforms[ \"direction\" ].value = this.BlurDirectionY;\n\t\t//renderer.render( this.scene, this.camera, this.renderTargetEdgeBuffer1, false );\n\n\t\t// Apply Blur on quarter res\n\t\tthis.quad.material = this.separableBlurMaterial2;\n\t\tthis.separableBlurMaterial2.uniforms[ \"colorTexture\" ].value = this.renderTargetEdgeBuffer1.texture;\n\t\tthis.separableBlurMaterial2.uniforms[ \"direction\" ].value = this.BlurDirectionX;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetBlurBuffer2, true );\n\t\tthis.separableBlurMaterial2.uniforms[ \"colorTexture\" ].value = this.renderTargetBlurBuffer2.texture;\n\t\tthis.separableBlurMaterial2.uniforms[ \"direction\" ].value = this.BlurDirectionY;\n\t\trenderer.render( this.scene, this.camera, this.renderTargetEdgeBuffer2, true );\n\n\t\t// Blend it additively over the input texture\n\t\tthis.quad.material = this.overlayMaterial;\n\t\tthis.overlayMaterial.uniforms[ \"maskTexture\" ].value = this.renderTargetMaskBuffer.texture;\n\t\tthis.overlayMaterial.uniforms[ \"edgeTexture1\" ].value = this.renderTargetEdgeBuffer1.texture;\n\t\tthis.overlayMaterial.uniforms[ \"edgeTexture2\" ].value = this.renderTargetEdgeBuffer2.texture;\n\t\tthis.overlayMaterial.uniforms[ \"patternTexture\" ].value = this.patternTexture;\n\t\tthis.overlayMaterial.uniforms[ \"edgeStrength\" ].value = this.edgeStrength;\n\t\tthis.overlayMaterial.uniforms[ \"edgeGlow\" ].value = this.edgeGlow;\n\t\tthis.overlayMaterial.uniforms[ \"usePatternTexture\" ].value = this.usePatternTexture;\n\n\n\t\tif ( maskActive ) renderer.context.enable( renderer.context.STENCIL_TEST );\n\n\t\trenderer.render( this.scene, this.camera, this.renderToScreen ? null : readBuffer, false );\n\n\t\trenderer.setClearColor( this.oldClearColor, this.oldClearAlpha );\n\t\trenderer.autoClear = oldAutoClear;\n\t},\n\n\tgetPrepareMaskMaterial: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"depthTexture\": { value: null },\n\t\t\t\t\"cameraNearFar\": { value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"textureMatrix\" : { value: new THREE.Matrix4() }\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\\n\t\t\t\tvarying vec4 projTexCoord;\\\n\t\t\t\tvarying vec4 vPosition;\\\n\t\t\t\tuniform mat4 textureMatrix;\\\n\t\t\t\tvoid main() {\\\n\t\t\t\t\tvUv = uv;\\\n\t\t\t\t\tvPosition = modelViewMatrix * vec4( position, 1.0 );\\\n\t\t\t\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\\\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <packing>\\\n\t\t\t\tvarying vec2 vUv;\\\n\t\t\t\tvarying vec4 vPosition;\\\n\t\t\t\tvarying vec4 projTexCoord;\\\n\t\t\t\tuniform sampler2D depthTexture;\\\n\t\t\t\tuniform vec2 cameraNearFar;\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\\\n\t\t\t\t\tfloat viewZ = -perspectiveDepthToViewZ( depth, cameraNearFar.x, cameraNearFar.y );\\\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\\\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\\\n\t\t\t\t}\"\n\t\t} );\n\t},\n\n\tgetEdgeDetectionMaterial: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"maskTexture\": { value: null },\n\t\t\t\t\"texSize\": { value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"visibleEdgeColor\": { value: new THREE.Vector3( 1.0, 1.0, 1.0 ) },\n\t\t\t\t\"hiddenEdgeColor\":  { value: new THREE.Vector3( 1.0, 1.0, 1.0 ) },\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"varying vec2 vUv;\\\n\t\t\t\tuniform sampler2D maskTexture;\\\n\t\t\t\tuniform vec2 texSize;\\\n\t\t\t\tuniform vec3 visibleEdgeColor;\\\n\t\t\t\tuniform vec3 hiddenEdgeColor;\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\\\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\\\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\\\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\\\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\\\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\\\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\\\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\\\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\\\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\\\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\\\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\\\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\\\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\\\n\t\t\t\t}\"\n\t\t} );\n\t},\n\n\tgetSeperableBlurMaterial: function(maxRadius) {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tdefines: {\n\t\t\t\t\"MAX_RADIUS\" : maxRadius,\n\t\t\t},\n\n\t\t\tuniforms: {\n\t\t\t\t\"colorTexture\": { value: null },\n\t\t\t\t\"texSize\": \t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"direction\": { value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\"kernelRadius\": { value: 1.0 }\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"#include <common>\\\n\t\t\t\tvarying vec2 vUv;\\\n\t\t\t\tuniform sampler2D colorTexture;\\\n\t\t\t\tuniform vec2 texSize;\\\n\t\t\t\tuniform vec2 direction;\\\n\t\t\t\tuniform float kernelRadius;\\\n\t\t\t\t\\\n\t\t\t\tfloat gaussianPdf2(in float x, in float sigma) {\\\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\\\n\t\t\t\t}\\\n\t\t\t\tvoid main() {\\\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\\\n\t\t\t\t\tfloat weightSum = gaussianPdf2(0.0, kernelRadius);\\\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\\\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\\\n\t\t\t\t\tvec2 uvOffset = delta;\\\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\\\n\t\t\t\t\t\tfloat w = gaussianPdf2(uvOffset.x, kernelRadius);\\\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\\\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\\\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\\\n\t\t\t\t\t\tweightSum += (2.0 * w);\\\n\t\t\t\t\t\tuvOffset += delta;\\\n\t\t\t\t\t}\\\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\\\n\t\t\t\t}\"\n\t\t} );\n\t},\n\n\tgetOverlayMaterial: function() {\n\n\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\tuniforms: {\n\t\t\t\t\"maskTexture\": { value: null },\n\t\t\t\t\"edgeTexture1\": { value: null },\n\t\t\t\t\"edgeTexture2\": { value: null },\n\t\t\t\t\"patternTexture\": { value: null },\n\t\t\t\t\"edgeStrength\" : { value: 1.0 },\n\t\t\t\t\"edgeGlow\" : { value: 1.0 },\n\t\t\t\t\"usePatternTexture\" : { value: 0.0 }\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t}\",\n\n\t\t\tfragmentShader:\n\t\t\t\t\"varying vec2 vUv;\\\n\t\t\t\tuniform sampler2D maskTexture;\\\n\t\t\t\tuniform sampler2D edgeTexture1;\\\n\t\t\t\tuniform sampler2D edgeTexture2;\\\n\t\t\t\tuniform sampler2D patternTexture;\\\n\t\t\t\tuniform float edgeStrength;\\\n\t\t\t\tuniform float edgeGlow;\\\n\t\t\t\tuniform bool usePatternTexture;\\\n\t\t\t\t\\\n\t\t\t\tvoid main() {\\\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\\\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\\\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\\\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\\\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\\\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\\\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\\\n\t\t\t\t\tif(usePatternTexture)\\\n\t\t\t\t\t\tfinalColor += visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\\\n\t\t\t\t\tgl_FragColor = finalColor;\\\n\t\t\t\t}\",\n\n\t\t\t\tblending: THREE.AdditiveBlending,\n\t\t\t\tdepthTest: false,\n\t\t\t\tdepthWrite: false,\n\t\t\t\ttransparent: true\n\t\t} );\n\t}\n\n} );\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/outlinePass.js","import * as THREE from 'three';\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author davidedc / http://www.sketchpatch.net/\n *\n * NVIDIA FXAA by Timothy Lottes\n * http://timothylottes.blogspot.com/2011/06/fxaa3-source-released.html\n * - WebGL port by @supereggbert\n * http://www.glge.org/demos/fxaa/\n */\n\nconst FXAAShader = {\n\n\tuniforms: {\n\n\t\t\"tDiffuse\":   { value: null },\n\t\t\"resolution\": { value: new THREE.Vector2( 1 / 1024, 1 / 512 ) }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"void main() {\",\n\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\"uniform vec2 resolution;\",\n\n\t\t\"#define FXAA_REDUCE_MIN   (1.0/128.0)\",\n\t\t\"#define FXAA_REDUCE_MUL   (1.0/8.0)\",\n\t\t\"#define FXAA_SPAN_MAX     8.0\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec3 rgbNW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ).xyz;\",\n\t\t\t\"vec3 rgbNE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ).xyz;\",\n\t\t\t\"vec3 rgbSW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ).xyz;\",\n\t\t\t\"vec3 rgbSE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ).xyz;\",\n\t\t\t\"vec4 rgbaM  = texture2D( tDiffuse,  gl_FragCoord.xy  * resolution );\",\n\t\t\t\"vec3 rgbM  = rgbaM.xyz;\",\n\t\t\t\"vec3 luma = vec3( 0.299, 0.587, 0.114 );\",\n\n\t\t\t\"float lumaNW = dot( rgbNW, luma );\",\n\t\t\t\"float lumaNE = dot( rgbNE, luma );\",\n\t\t\t\"float lumaSW = dot( rgbSW, luma );\",\n\t\t\t\"float lumaSE = dot( rgbSE, luma );\",\n\t\t\t\"float lumaM  = dot( rgbM,  luma );\",\n\t\t\t\"float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );\",\n\t\t\t\"float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );\",\n\n\t\t\t\"vec2 dir;\",\n\t\t\t\"dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\",\n\t\t\t\"dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\",\n\n\t\t\t\"float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );\",\n\n\t\t\t\"float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );\",\n\t\t\t\"dir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),\",\n\t\t\t\t  \"max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\",\n\t\t\t\t\t\t\"dir * rcpDirMin)) * resolution;\",\n\t\t\t\"vec4 rgbA = (1.0/2.0) * (\",\n        \t\"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (1.0/3.0 - 0.5)) +\",\n\t\t\t\"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (2.0/3.0 - 0.5)));\",\n    \t\t\"vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (\",\n\t\t\t\"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (0.0/3.0 - 0.5)) +\",\n      \t\t\"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (3.0/3.0 - 0.5)));\",\n    \t\t\"float lumaB = dot(rgbB, vec4(luma, 0.0));\",\n\n\t\t\t\"if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) ) {\",\n\n\t\t\t\t\"gl_FragColor = rgbA;\",\n\n\t\t\t\"} else {\",\n\t\t\t\t\"gl_FragColor = rgbB;\",\n\n\t\t\t\"}\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\nexport default FXAAShader;\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/FXAAShader.js","import * as THREE from 'three';\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author marklundin / http://mark-lundin.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nexport default function ParallaxBarrierEffect(renderer) {\n\n  var _camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);\n\n  var _scene = new THREE.Scene();\n\n  var _stereo = new THREE.StereoCamera();\n\n  var _params = { minFilter: THREE.LinearFilter, magFilter: THREE.NearestFilter, format: THREE.RGBAFormat };\n\n  var _renderTargetL = new THREE.WebGLRenderTarget(512, 512, _params);\n  var _renderTargetR = new THREE.WebGLRenderTarget(512, 512, _params);\n\n  var _material = new THREE.ShaderMaterial({\n\n    uniforms: {\n\n      'mapLeft': { value: _renderTargetL.texture },\n      'mapRight': { value: _renderTargetR.texture },\n\n    },\n\n    vertexShader: [\n\n      'varying vec2 vUv;',\n\n      'void main() {',\n\n      ' vUv = vec2( uv.x, uv.y );',\n      ' gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n\n      '}',\n\n    ].join('\\n'),\n\n    fragmentShader: [\n\n      'uniform sampler2D mapLeft;',\n      'uniform sampler2D mapRight;',\n      'varying vec2 vUv;',\n\n      'void main() {',\n\n      ' vec2 uv = vUv;',\n\n      ' if ( ( mod( gl_FragCoord.x, 2.0 ) ) > 1.00 ) {',\n\n      '   gl_FragColor = texture2D( mapLeft, uv );',\n\n      ' } else {',\n\n      '   gl_FragColor = texture2D( mapRight, uv );',\n\n      ' }',\n\n      '}',\n\n    ].join('\\n'),\n\n  });\n\n  var mesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), _material);\n  _scene.add(mesh);\n\n  this.setSize = function (width, height) {\n\n    renderer.setSize(width, height);\n\n    var pixelRatio = renderer.getPixelRatio();\n\n    _renderTargetL.setSize(width * pixelRatio, height * pixelRatio);\n    _renderTargetR.setSize(width * pixelRatio, height * pixelRatio);\n\n  };\n\n  this.render = function (scene, camera) {\n\n    scene.updateMatrixWorld();\n\n    if (camera.parent === null) camera.updateMatrixWorld();\n\n    _stereo.update(camera);\n\n    renderer.render(scene, _stereo.cameraL, _renderTargetL, true);\n    renderer.render(scene, _stereo.cameraR, _renderTargetR, true);\n    renderer.render(_scene, _camera);\n\n  };\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/translators/utils/parallaxBarrierEffect.js","import { get, find } from './modules/scene';\nimport { queueAnimation, removeAnimation } from './modules/animation';\n\nexport function startAutoRotate(store) {\n  const player = get(store, { scene: true, evalPlug: 'Player' });\n  const id = player && player.autoRotateNode;\n\n  if (!player || !player.autoRotate || !id) return false;\n\n  const increment = player.autoRotateDirection === '+' ? 360 : -360;\n  const path = find(store, { id, plug: 'Transform', property: 'rotation' });\n  const rotation = get(store, { id, plug: 'Transform', property: 'rotation' });\n\n  if (path && rotation) {\n    store.dispatch(queueAnimation({\n      name: 'autoRotate',\n      autoplay: true,\n      iterations: Infinity,\n      easingDuration: 3000,\n      tracks: [{\n        path,\n        start: 0,\n        duration: player.autoRotateSpeed * 1000,\n        value: { x: rotation.x, y: rotation.y + increment, z: rotation.z },\n      },],\n    }));\n  }\n};\n\nexport function stopAutoRotate(store) {\n  store.dispatch(removeAnimation('autoRotate'));\n};\n\nexport function autoRotateTool(store) {\n  let startingTimeout;\n\n  const tool = {\n    start: (timeout=5000) => {\n      startingTimeout = setTimeout(() => {\n        startAutoRotate(store);\n      }, timeout);\n    },\n\n    stop: ()  => {\n      stopAutoRotate(store);\n      clearTimeout(startingTimeout);\n    },\n\n    mousedown: () => tool.stop(),\n    mouseup: () => tool.start(),\n  };\n\n  return {\n    enabled: true,\n    tool,\n  };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/autoRotate.js","import * as THREE from 'three';\nimport rollbar from 'rollbar-browser';\nimport immutable from 'immutable';\nimport 'es6-promise/auto';\nimport snabbdom from 'snabbdom';\nimport h from 'snabbdom/h';\nimport snabbdomClass from 'snabbdom/modules/class'; // makes it easy to toggle classes\nimport snabbdomProps from 'snabbdom/modules/props'; // for setting properties on DOM elements\nimport snabbdomAttrs from 'snabbdom/modules/attributes';\nimport snabbdomStyle from 'snabbdom/modules/style'; // handles styling on elements with support for animations\nimport snabbdomEvents from 'snabbdom/modules/eventlisteners'; // attaches event listeners\nimport eventEmitter from './utils/eventEmitter';\nimport ramda from 'ramda';\nconst { mapObjIndexed }  = ramda;\n\nimport callApi from './store/api';\n// import createLogger from 'redux-logger';\nimport clientMiddleware from './store/clientMiddleware';\n\nimport animation from './modules/animation';\nimport annotations from './modules/annotations';\nimport sceneGraph from './modules/sceneGraph';\nimport sceneIO from './modules/sceneIO';\nimport assets from './modules/assets';\nimport player from './modules/player';\nimport scene from './modules/scene';\nimport plugins, { setApi } from './modules/plugins';\nimport configuration from './modules/configuration';\nimport selection from './modules/selection';\nimport commands, { addCommand } from './modules/commands';\n\nimport operatorRecords from './operators';\nimport primitives from './operators/primitives';\n\nimport buildStore from './store';\nimport bindActionCreatorsAndSelectors from './store/bindActionCreatorsAndSelectors';\n\nimport playerView from './components/player';\n\nimport tools from './translators/tools';\nimport threeTranslator from './translators/three';\n\nimport { startAutoRotate, autoRotateTool } from './autoRotate';\n\nif (__BROWSER__) {\n  window.WebVRConfig.CARDBOARD_UI_DISABLED = true;\n  window.WebVRConfig.ROTATE_INSTRUCTIONS_DISABLED = true;\n  window.WebVRConfig.BUFFER_SCALE = 1.0;\n}\n\nconst reducers = {\n  animation: animation.reducer,\n  annotations: annotations.reducer,\n  assets: assets.reducer,\n  commands: commands.reducer,\n  sceneGraph: sceneGraph.reducer(operatorRecords),\n  sceneIO: sceneIO.reducer,\n  player: player.reducer,\n  plugins: plugins.reducer,\n  selection: selection.reducer,\n};\n\nconst patch = snabbdom.init([snabbdomClass, snabbdomProps, snabbdomAttrs, snabbdomStyle, snabbdomEvents]);\n\n// const middleware = [logger()];\n// const loggerMiddleware = createLogger({\n//   timestamp: true, duration: true, transformer: (state) => state.toJS()\n// });\nlet middleware = [clientMiddleware];\n// if (false) middleware.push(loggerMiddleware);\n\nconst deps = {\n  immutable,\n  patch,\n  h,\n  ramda,\n  THREE,\n};\n\n\n/**\n * The main function. This function initializes the player for a given DOM Node.\n *\n * @param {(String|DOMNode)} elOrId - the DOM Node or String id of a DOM Node.\n * @param {Object} options\n * @param {Function} options.callback - an optional initialization function that will be called (with api as argument) before the first render.\n * @returns {API} The clara playera API.\n * @public\n */\nfunction claraplayer(elOrId, opts) {\n  let initializationFn;\n  let options;\n  if (typeof opts === 'function') {\n    initializationFn = opts;\n    options = {};\n    console.warn('DEPRECATED: second argument to `claraplayer` should be an options object');\n  } else {\n    options = opts || {};\n    initializationFn = options.callback;\n  }\n\n  const Rollbar = __ROLLBAR_TOKEN__ && rollbar.init({\n    accessToken: __ROLLBAR_TOKEN__,\n    verbose: false,\n    captureUncaught: !options.devMode,\n    payload: {\n      environment: __ENV__,\n      context: 'playerv2',\n    },\n  });\n\n  const parentEl = typeof elOrId === 'string' ? document.getElementById(elOrId) : elOrId;\n  parentEl.appendChild(document.createElement('div'));\n  const rect = parentEl.getBoundingClientRect();\n  if (!rect.height) {\n    throw new Error('Player element must have a height');\n  }\n\n  const store = buildStore(reducers, operatorRecords, primitives, middleware);\n  if (Rollbar) store.useRollbar(Rollbar);\n  let dispatch = store.dispatch.bind(store);\n  const translator = threeTranslator(store);\n  store.setTranslator(translator);\n  store.setApi(callApi);\n\n  const actions = bindActionCreatorsAndSelectors(store, {\n    animation, annotations, assets, commands, configuration, scene, sceneIO, sceneGraph, player, plugins, selection,\n  });\n\n  let api = Object.assign({}, eventEmitter(), {\n    deps,\n    three: {\n      scene: translator.scene,\n      camera: translator.camera,\n    },\n    _store: store,\n  }, actions);\n  api.version = __VERSION__;\n\n  if (initializationFn) initializationFn(api);\n\n  const el = parentEl.children[0];\n  const parentStyle = window.getComputedStyle(parentEl, null);\n  const isFlex = parentStyle.display === 'flex';\n  const isRelative = parentStyle.position === 'relative';\n  let vnode = patch(el, playerView(store, { isFlex, isRelative, parentEl }));\n\n  store.subscribe(function (events) { //try {\n      vnode = patch(vnode, playerView(store, { isFlex, isRelative, parentEl }));\n      if (events.length) events.forEach((e) => { api.emit(e.type, ...e.args); });\n      api.emit('change');\n      //} catch (e) {\n      //  store.error(e);\n      //}\n    });\n\n  dispatch(setApi(api));\n\n  mapObjIndexed((tool, toolName) => {\n    dispatch(addCommand(typeof tool === 'function' ? tool(store, translator) : tool, toolName));\n  }, tools);\n\n  const autoRotateToolObj = autoRotateTool(store);\n  dispatch(addCommand(autoRotateToolObj, 'autoRotate'));\n\n  api.on('loaded', () => {\n    // TODO: zoom camera\n    autoRotateToolObj.tool.start(1000);\n  });\n\n  return api;\n};\n\nclaraplayer.deps = deps;\n\nclaraplayer.hasWebGL = function () {\n  const canvas = document.createElement('canvas');\n  return !!canvas.getContext('webgl') || !!canvas.getContext('experimental-webgl');\n};\n\nmodule.exports = claraplayer;\n\n\n\n// WEBPACK FOOTER //\n// ./src/player.js","// This file can be required in Browserify and Node.js for automatic polyfill\n// To use it:  require('es6-promise/auto');\n'use strict';\nmodule.exports = require('./').polyfill();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/es6-promise/auto.js\n// module id = 388\n// module chunks = 1 2","/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   4.0.5\n */\n\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (global.ES6Promise = factory());\n}(this, (function () { 'use strict';\n\nfunction objectOrFunction(x) {\n  return typeof x === 'function' || typeof x === 'object' && x !== null;\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\nvar _isArray = undefined;\nif (!Array.isArray) {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n} else {\n  _isArray = Array.isArray;\n}\n\nvar isArray = _isArray;\n\nvar len = 0;\nvar vertxNext = undefined;\nvar customSchedulerFn = undefined;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && ({}).toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var r = require;\n    var vertx = r('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = undefined;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof require === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var _arguments = arguments;\n\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n  if (_state) {\n    (function () {\n      var callback = _arguments[_state - 1];\n      asap(function () {\n        return invokeCallback(_state, child, callback, parent._result);\n      });\n    })();\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  _resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(16);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nvar GET_THEN_ERROR = new ErrorObject();\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction getThen(promise) {\n  try {\n    return promise.then;\n  } catch (error) {\n    GET_THEN_ERROR.error = error;\n    return GET_THEN_ERROR;\n  }\n}\n\nfunction tryThen(then, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        _resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      _reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      _reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    _reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return _resolve(promise, value);\n    }, function (reason) {\n      return _reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$) {\n  if (maybeThenable.constructor === promise.constructor && then$$ === then && maybeThenable.constructor.resolve === resolve) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$ === GET_THEN_ERROR) {\n      _reject(promise, GET_THEN_ERROR.error);\n    } else if (then$$ === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$)) {\n      handleForeignThenable(promise, maybeThenable, then$$);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction _resolve(promise, value) {\n  if (promise === value) {\n    _reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    handleMaybeThenable(promise, value, getThen(value));\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction _reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = undefined,\n      callback = undefined,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction ErrorObject() {\n  this.error = null;\n}\n\nvar TRY_CATCH_ERROR = new ErrorObject();\n\nfunction tryCatch(callback, detail) {\n  try {\n    return callback(detail);\n  } catch (e) {\n    TRY_CATCH_ERROR.error = e;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = undefined,\n      error = undefined,\n      succeeded = undefined,\n      failed = undefined;\n\n  if (hasCallback) {\n    value = tryCatch(callback, detail);\n\n    if (value === TRY_CATCH_ERROR) {\n      failed = true;\n      error = value.error;\n      value = null;\n    } else {\n      succeeded = true;\n    }\n\n    if (promise === value) {\n      _reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n      _resolve(promise, value);\n    } else if (failed) {\n      _reject(promise, error);\n    } else if (settled === FULFILLED) {\n      fulfill(promise, value);\n    } else if (settled === REJECTED) {\n      _reject(promise, value);\n    }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      _resolve(promise, value);\n    }, function rejectPromise(reason) {\n      _reject(promise, reason);\n    });\n  } catch (e) {\n    _reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction Enumerator(Constructor, input) {\n  this._instanceConstructor = Constructor;\n  this.promise = new Constructor(noop);\n\n  if (!this.promise[PROMISE_ID]) {\n    makePromise(this.promise);\n  }\n\n  if (isArray(input)) {\n    this._input = input;\n    this.length = input.length;\n    this._remaining = input.length;\n\n    this._result = new Array(this.length);\n\n    if (this.length === 0) {\n      fulfill(this.promise, this._result);\n    } else {\n      this.length = this.length || 0;\n      this._enumerate();\n      if (this._remaining === 0) {\n        fulfill(this.promise, this._result);\n      }\n    }\n  } else {\n    _reject(this.promise, validationError());\n  }\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n};\n\nEnumerator.prototype._enumerate = function () {\n  var length = this.length;\n  var _input = this._input;\n\n  for (var i = 0; this._state === PENDING && i < length; i++) {\n    this._eachEntry(_input[i], i);\n  }\n};\n\nEnumerator.prototype._eachEntry = function (entry, i) {\n  var c = this._instanceConstructor;\n  var resolve$$ = c.resolve;\n\n  if (resolve$$ === resolve) {\n    var _then = getThen(entry);\n\n    if (_then === then && entry._state !== PENDING) {\n      this._settledAt(entry._state, i, entry._result);\n    } else if (typeof _then !== 'function') {\n      this._remaining--;\n      this._result[i] = entry;\n    } else if (c === Promise) {\n      var promise = new c(noop);\n      handleMaybeThenable(promise, entry, _then);\n      this._willSettleAt(promise, i);\n    } else {\n      this._willSettleAt(new c(function (resolve$$) {\n        return resolve$$(entry);\n      }), i);\n    }\n  } else {\n    this._willSettleAt(resolve$$(entry), i);\n  }\n};\n\nEnumerator.prototype._settledAt = function (state, i, value) {\n  var promise = this.promise;\n\n  if (promise._state === PENDING) {\n    this._remaining--;\n\n    if (state === REJECTED) {\n      _reject(promise, value);\n    } else {\n      this._result[i] = value;\n    }\n  }\n\n  if (this._remaining === 0) {\n    fulfill(promise, this._result);\n  }\n};\n\nEnumerator.prototype._willSettleAt = function (promise, i) {\n  var enumerator = this;\n\n  subscribe(promise, undefined, function (value) {\n    return enumerator._settledAt(FULFILLED, i, value);\n  }, function (reason) {\n    return enumerator._settledAt(REJECTED, i, reason);\n  });\n};\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  _reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {function} resolver\n  Useful for tooling.\n  @constructor\n*/\nfunction Promise(resolver) {\n  this[PROMISE_ID] = nextId();\n  this._result = this._state = undefined;\n  this._subscribers = [];\n\n  if (noop !== resolver) {\n    typeof resolver !== 'function' && needsResolver();\n    this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n  }\n}\n\nPromise.all = all;\nPromise.race = race;\nPromise.resolve = resolve;\nPromise.reject = reject;\nPromise._setScheduler = setScheduler;\nPromise._setAsap = setAsap;\nPromise._asap = asap;\n\nPromise.prototype = {\n  constructor: Promise,\n\n  /**\n    The primary way of interacting with a promise is through its `then` method,\n    which registers callbacks to receive either a promise's eventual value or the\n    reason why the promise cannot be fulfilled.\n  \n    ```js\n    findUser().then(function(user){\n      // user is available\n    }, function(reason){\n      // user is unavailable, and you are given the reason why\n    });\n    ```\n  \n    Chaining\n    --------\n  \n    The return value of `then` is itself a promise.  This second, 'downstream'\n    promise is resolved with the return value of the first promise's fulfillment\n    or rejection handler, or rejected if the handler throws an exception.\n  \n    ```js\n    findUser().then(function (user) {\n      return user.name;\n    }, function (reason) {\n      return 'default name';\n    }).then(function (userName) {\n      // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n      // will be `'default name'`\n    });\n  \n    findUser().then(function (user) {\n      throw new Error('Found user, but still unhappy');\n    }, function (reason) {\n      throw new Error('`findUser` rejected and we're unhappy');\n    }).then(function (value) {\n      // never reached\n    }, function (reason) {\n      // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n      // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n    });\n    ```\n    If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n  \n    ```js\n    findUser().then(function (user) {\n      throw new PedagogicalException('Upstream error');\n    }).then(function (value) {\n      // never reached\n    }).then(function (value) {\n      // never reached\n    }, function (reason) {\n      // The `PedgagocialException` is propagated all the way down to here\n    });\n    ```\n  \n    Assimilation\n    ------------\n  \n    Sometimes the value you want to propagate to a downstream promise can only be\n    retrieved asynchronously. This can be achieved by returning a promise in the\n    fulfillment or rejection handler. The downstream promise will then be pending\n    until the returned promise is settled. This is called *assimilation*.\n  \n    ```js\n    findUser().then(function (user) {\n      return findCommentsByAuthor(user);\n    }).then(function (comments) {\n      // The user's comments are now available\n    });\n    ```\n  \n    If the assimliated promise rejects, then the downstream promise will also reject.\n  \n    ```js\n    findUser().then(function (user) {\n      return findCommentsByAuthor(user);\n    }).then(function (comments) {\n      // If `findCommentsByAuthor` fulfills, we'll have the value here\n    }, function (reason) {\n      // If `findCommentsByAuthor` rejects, we'll have the reason here\n    });\n    ```\n  \n    Simple Example\n    --------------\n  \n    Synchronous Example\n  \n    ```javascript\n    let result;\n  \n    try {\n      result = findResult();\n      // success\n    } catch(reason) {\n      // failure\n    }\n    ```\n  \n    Errback Example\n  \n    ```js\n    findResult(function(result, err){\n      if (err) {\n        // failure\n      } else {\n        // success\n      }\n    });\n    ```\n  \n    Promise Example;\n  \n    ```javascript\n    findResult().then(function(result){\n      // success\n    }, function(reason){\n      // failure\n    });\n    ```\n  \n    Advanced Example\n    --------------\n  \n    Synchronous Example\n  \n    ```javascript\n    let author, books;\n  \n    try {\n      author = findAuthor();\n      books  = findBooksByAuthor(author);\n      // success\n    } catch(reason) {\n      // failure\n    }\n    ```\n  \n    Errback Example\n  \n    ```js\n  \n    function foundBooks(books) {\n  \n    }\n  \n    function failure(reason) {\n  \n    }\n  \n    findAuthor(function(author, err){\n      if (err) {\n        failure(err);\n        // failure\n      } else {\n        try {\n          findBoooksByAuthor(author, function(books, err) {\n            if (err) {\n              failure(err);\n            } else {\n              try {\n                foundBooks(books);\n              } catch(reason) {\n                failure(reason);\n              }\n            }\n          });\n        } catch(error) {\n          failure(err);\n        }\n        // success\n      }\n    });\n    ```\n  \n    Promise Example;\n  \n    ```javascript\n    findAuthor().\n      then(findBooksByAuthor).\n      then(function(books){\n        // found books\n    }).catch(function(reason){\n      // something went wrong\n    });\n    ```\n  \n    @method then\n    @param {Function} onFulfilled\n    @param {Function} onRejected\n    Useful for tooling.\n    @return {Promise}\n  */\n  then: then,\n\n  /**\n    `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n    as the catch block of a try/catch statement.\n  \n    ```js\n    function findAuthor(){\n      throw new Error('couldn't find that author');\n    }\n  \n    // synchronous\n    try {\n      findAuthor();\n    } catch(reason) {\n      // something went wrong\n    }\n  \n    // async with promises\n    findAuthor().catch(function(reason){\n      // something went wrong\n    });\n    ```\n  \n    @method catch\n    @param {Function} onRejection\n    Useful for tooling.\n    @return {Promise}\n  */\n  'catch': function _catch(onRejection) {\n    return this.then(null, onRejection);\n  }\n};\n\nfunction polyfill() {\n    var local = undefined;\n\n    if (typeof global !== 'undefined') {\n        local = global;\n    } else if (typeof self !== 'undefined') {\n        local = self;\n    } else {\n        try {\n            local = Function('return this')();\n        } catch (e) {\n            throw new Error('polyfill failed because global object is unavailable in this environment');\n        }\n    }\n\n    var P = local.Promise;\n\n    if (P) {\n        var promiseToString = null;\n        try {\n            promiseToString = Object.prototype.toString.call(P.resolve());\n        } catch (e) {\n            // silently ignored\n        }\n\n        if (promiseToString === '[object Promise]' && !P.cast) {\n            return;\n        }\n    }\n\n    local.Promise = Promise;\n}\n\n// Strange compat..\nPromise.polyfill = polyfill;\nPromise.Promise = Promise;\n\nreturn Promise;\n\n})));\n//# sourceMappingURL=es6-promise.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/es6-promise/dist/es6-promise.js\n// module id = 389\n// module chunks = 1 2","import h from 'snabbdom/h';\nimport canvas from './canvas';\nimport styles from './styles';\nimport error from './error';\nimport manipulatorTools from './manipulatorTools';\nimport progress from './progress';\nimport { setPlayerElement, isFullscreen, setFullscreen,  shouldDisplayThumbnail } from '../modules/player';\nimport { isSceneLoaded, isSceneRendered, loadingProgress, numErrors } from '../modules/sceneIO';\n\nconst brokenThumbnails = {};\n\nexport default function player(store, { isFlex, isRelative, parentEl }) {\n  const rendered = isSceneRendered(store);\n\n  let sceneId = store.getIn(['sceneIO', 'id']);\n  const hideThumbnail = rendered || !sceneId || !shouldDisplayThumbnail(store);\n\n  const cssStyle = `\n  div.claraplayer canvas {\n    box-sizing: content-box;\n    -webkit-box-sizing: content-box;\n  }\n  div.claraplayer canvas:focus {\n    outline: none;\n  }\n`;\n  var children = [h('style', { props: { innerHTML: cssStyle } })];\n\n  const fullscreenBackgroundColor = store.getIn(['player', 'fullscreenBackgroundColor']);\n  const playerStyles =  Object.assign({}, styles.player, {\n    backgroundImage: hideThumbnail ? '' : `url(${__URLROOT__}/api/scenes/${sceneId}/v2thumbnail)`,\n    backgroundRepeat: 'no-repeat',\n    backgroundSize: 'auto 100%',\n    backgroundPosition: 'center',\n    position: (isFlex || isRelative) ? 'absolute' : 'relative',\n    boxSizing: 'border-box',\n    backgroundColor: isFullscreen(store) ?  fullscreenBackgroundColor : 'transparent',\n    overflow: 'hidden',\n  });\n\n  if (numErrors(store)) {\n    children.push(error(store));\n  } else {\n    children.push(canvas(store, 'player'));\n    if (rendered) children.push(manipulatorTools(store));\n    else children.push(progress(store));\n  }\n\n  return h('div.claraplayer', { style: playerStyles, hook: {\n    insert: attachFullscreenHandlers(store),\n  }, }, children);\n}\n\nfunction attachFullscreenHandlers(store) {\n  return () => {\n    [ // ['fullscreenChange', 'fullscreenElement'],\n      ['webkitfullscreenchange', 'webkitIsFullScreen'],\n      ['mozfullscreenchange', 'mozFullScreen'],\n      ['MSFullscreenChange', 'msFullscreenElement'],\n    ].forEach(function (info) {\n      document.addEventListener(info[0], () => {\n        //console.log('FULLSCREEN', info[0], !!document[info[1]]);\n        store.dispatch(setFullscreen(!!document[info[1]]));\n      });\n    });\n  };\n}\n\n\n/*function statsReporter() {\n  var pageLoadTime, toRenderedTime;\n  if (typeof performace === 'undefined') return function() {};\n\n  return function(store, pct) {\n    if (pageLoadTime && toRenderedTime) return;\n    if (!pageLoadTime) pageLoadTime = new Date().getTime() - performance.timing.navigationStart;\n    if (pct < 1) return;\n    toRenderedTime = new Date().getTime() - performance.timing.navigationStart;\n    console.log(`Page loaded in ${pageLoadTime}ms and rendered in ${toRenderedTime}ms`);\n  };\n};\n\n//\n//\nvar circleDiv = {\n  flex: '0 0 25%'\n};\n\nvar r = 90;\nvar PIR2 = Math.PI * r * 2;\n\nvar outer = {\n  r, cx: 100, cy: 100,\n  fill: 'transparent',\n  'stroke-dasharray': PIR2,\n  'stroke-dashoffset': 0,\n  'stroke-width': '1em',\n  stroke: '#eee'\n};\nvar inner = {\n  r, cx: 100, cy: 100,\n  fill: 'transparent',\n  stroke: colour,\n  transition: 'stroke-dashoffset 1s linear',\n  'stroke-width': '1em',\n  'stroke-dashoffset': PIR2,\n  'stroke-dasharray': PIR2\n};\nvar svg = {\n  height: '100%',\n  width: '100%',\n  viewport: '0 0 100 100',\n  viewBox: '0 0 200 200',\n};\n\nfunction progress(store, pct) {\n  var r = 90;\n  var degrees = PIR2*(1-pct);\n\n  return h('div', {style: {...styles.absoluteMaxCentered, backgroundColor: 'transparent', boxSizing: 'border-box' }}, [\n    h('div', {style: circleDiv}, [\n      h('svg', {attrs: svg}, [\n        h('circle', {attrs: outer}),\n        h('circle', {props: {id: 'bar'}, attrs: {...inner, 'stroke-dashoffset': degrees}}),\n      ])\n    ])\n  ]);\n};*/\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/player.js"],"sourceRoot":""}